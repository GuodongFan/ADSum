hey everyone , i 'm currently building a crud app and i opted for the built-in server that nextjs provides instead of integrating express and i 'm wondering how would i make sure that the data that my front-end is sending to my endpoints are valid ? right now i 'm thinking of doing the validation on the api page , is this a wise thing to do ? < code >
i have read in the docs that a custom express server disables automatic static optimization . after doing some research i was unfortunately still not able to find out whether this means that every page is server-side rendered . or to put it in a different way : is it possible to serve static pages with a custom server ? would appreciate any help to clarify my confusion . < code >
i am trying to use getstaticprops for the first time so i am doing a simple axios call using dummyapi.io , but it returns undefined . i even copied an example from this blog but it does n't seem to work ( check last code snippet at the bottom of the page ) . if i do the axios call inside useeffect , data is being returned . any pointers ? < code > import axios from 'api/client ' // defined baseurl and my api_id in headers const getusers = async ( ) = > await axios.get ( '/user ' ) .then ( res = > { data : res.data } ) const mycomponent = ( { data } ) = > { useeffect ( ( ) = > { console.log ( data ) // undefined } return ( ... ) } export const getstaticprops = async ( ) = > { const data = await getusers ( ) return { props : { data : data } } }
i created a blog post on next.js incremental static regeneration . i tried to compare pure ssr and ssg approaches and how these improvements takes things further . i also included a few demos inside the blog post to make things understandable . i you still did n't understand how next.js incremental static regeneration works , i assume this article helps . let me know , what i need to improve or what i should change etc . have a nice day ! < code >
what version of next.js are you using ? 10.0.5 ( also present in 9.x ) what version of node.js are you using ? 12.19.0 what browser are you using ? chrome what operating system are you using ? windows how are you deploying your application ? other describe the bug i 've added a custom webpack configuration to load svg images as react elements : then , i open the local website in the browser , convert svg jsx icons from react components embeded in a * .js file into separate * .svg files , and import those svgs from those new * .svg files . then , i refresh the page , but nothing has changed . then , i go and edit those new * .svg files to see if it 's stuck . and it is : no changes in the browser . i terminate the process via ctrl + c and restart it no changes . then i go to the .next folder and forcefully delete the cache folder , run the app , and now everything is updated . then i go to those * .svg files again to see if changes are hot reloaded they are n't . more no changes are ever applied even when refreshing the page , until i go and forcefully delete the cache folder again . looks like a caching bug . expected behavior svgs updating in real-time on the screen as they 're edited . to reproduce perhaps that 's even not reproducible . < code > webpack ( config ) { config.module.rules.push ( { test : /\.svg < cur > / , use : [ ' @ svgr/webpack ' ] } ) ; return config ; }
i am short of a beginner here , so i would like to ask if i can use the useswr ( ) hook with my graphql api built with apollo . i would not like to use the apollo client on the front-end , so i am interested in using relay modern . i have seen various articles and it says it also in the documentation that swr works great with graphql . has anyone done something similar in a project of yours ? what are your thoughts ? should i stick with useswr ( ) and graphql-request for a production website ? any thoughts , ideas and comments are really appreciated ! note : i will be using issg a lot , so i am not going to use only the default ssg that would fetch the data at build time . < code >
i do n't want to use css modules and global styles . example : < code > /components/ | - button/ | - button.scss | - button.js // button.js import react from 'react ' ; import './button.scss ' ; .... < button classname= '' button '' > < /button >
are there two different paths syntax based on whether fallback is true or false ? ex : { params : { id : 'post-1 ' } } syntax only works with fallback : true . while if fallback : false the syntax is simply a string such as '/posts/post-1 ' . the 9.3 blog post uses the differing syntax based on whether fallback is true/false : fallback : true < url > fallback : false < url > and the storyblok example follows this syntax too : < url > further , i 've found this to be true for me too ( and i 'm using all the latest packages ) , but it feels weird since the official docs do n't mention anything about the string syntax . can anyone shed light on this ? thanks ! < code >
hello , i was wondering what 's the point of using env in next.config.js via process.env instead of using something like ? < code > // anyfile.js import mq from `` media-queries '' console.log ( mq [ `` -- tablet-and-below '' ] ) // ( max-width : 1279px ) // { root } /media-queries.js const mq = { `` -- tablet-and-below '' : `` ( max-width : 1279px ) '' , `` -- desktop '' : `` ( min-width : 1280px ) '' , } export default mq
i 'm trying to get a very simple example to work with nextjs api route where i pass in query parameters in the link . however , the query parameters are not being passed and are undefined here 's my code : pages/index.tsx pages/api/hello.tsx the strange thing is , if i type < url > the query parameter is being passed and _.query == 'world ' any idea why this happens and how i can resolve this ? thank you ! < code > import link from `` next/link '' import react from `` react '' const query = ( ) = > { return ( < link href= { { pathname : `` api/hello '' , query : { text : `` world '' } , } } > link to api route < /link > ) } export default query import { nextapirequest , nextapiresponse } from `` next '' export default ( _ : nextapirequest , res : nextapiresponse ) = > { console.log ( `` received '' , _.query ) // logs as undefined const { text } = _.query res.status ( 200 ) .json ( { text : 'hello < cur > { text } ' } ) }
hi , so i have next js app with some dynamic pages e.g . /posts/ : id . when i naviagte from /post to /post/ : id using the link component , everything works well . the problem occurs when i refresh ( or go straight onto ) the /posts/ : id page . in the console i get 404 errors saying that _next/data/somthing.json could n't be found and the page immediately refreshes and again the same thing . sometimes the page keeps refreshing all the time but sometimes it stops after a few times and the errors disappear . this error does n't occur always - sometimes when i refresh everything is completely fine . any ideas what could be causing this ? is there any way i can ignore those 404s since even with them the page seems to be fully working ( hard to check tho cause it refreshes almost immediately ) . thanks ! < code >
hi ! this is more of an infrastructure question , so i do n't think there is a direct answer here . i have a next.js frontend which connects to an express.js api and uses mongodb + redis to store data . i now want to add a couple of stats that the app will collect and store in the database . let 's say i have a collection of games on the app , i want to collect+store things like the download count for each game , ratings for each game , and the number of pageviews for each game . the app heavily relies on isr and the stats do n't have to be updated instantly for all users . as long as the stats , let 's say the download count , gets incremented on the client 's side as soon as they download a game , and then every 15 mins ( or whenever a new deployment is triggered ) the download count will get updated to the actual , global download count . what would be the best way to implement this ? i need something that 's scalable easily , so i am not sure if mongodb is the way to go . is there any platform i could use to store data like this that allows for a large number of read/writes to the db without costing a lot ? what would be the best way to implement this without increasing the workload on the next.js/vercel side ? < code >
hi everyone , since a few days i 'm testing around with incremental site generation in next.js . this is my current scenario : next.js production build with incremental site generation prismic as headless cms in prismic i 'm creating from time to time new content which can be accessed by a dynamic route in next.js . if create a new content , a page is generated from next.js . so far , so good . the problem i 'm facing is when i delete content in prismic . then i want next.js to delete the generated page also . is there a way to do that ? thanks in advance for your help ! < code >
hi ! i am a totally noob on programming , so each steep was really hard . finally achieved to add analytics , adsense and pretty much everything , but automatic adsense adds works really bad sometimes . i searched and tried a lot of things , but did n't manage to make it work . how can i manage to make manual adsense code works on jsx so i can manually add it in some places when exporting it ? i guess must be something related to dangeroushtml stuff , but cant find a way to make it work : ( thanks , relam . < code >
hi , i 'm new to nextjs but i 'm working on a project for my university and would love some input ! i 'm in a situation where i server-side render a list of user project posts ( which in itself is a page ) . i did want to ssr that to improve seo and reduce calls to the firebase backend . however , the user would be able to edit this post . so technically , this would require their page to be rebuild . i was wondering how that was done , i 've searched some things online and came across cron job , where a rebuild could be scheduled by time . but i 'm looking for something that i can use that once the user edits his project ( through an edit form ) , their page would be rebuild . so not necessarily a timed build schedule . projects would n't be edited as often hence why i 'd prefer it if it were still ssr but just build again after an edit . is this possible ? < code >
correct me if i am wrong but getserversideprops is used to pre-render data on each render ? if i use the standard redis npm module in getserversideprops i get the error net.isip is not a function . from what i have researched this is due to the client trying to use the redis functions . i am trying to create an application to where session data is saved in a redis key based on a cookie token . based on the user id a database is called and renders data to the component . i can get the cookie token in getserversideprops but i i run client.get ( token ) i get the error net.isip is not a function at runtime . am i not using getserversideprops correctly or should i be using a different method / function ? i am new to the whole next.js world . i appreciate the help . next.js seams promissing and i am wanting to use it in more projects . < code >
hey guys ! i 'm working on nextjs auth . i do n't use nextauth library since i need some very custom things to be implemented ( wildcard domains etc ) . but i wanted to borrow one trick from nextauth . to be precise what is described there < url > nextauth allows to create pages/api/auth/ [ ... nextauth ] .js file and catch all requests to example.com/api/auth/ * . unfortunately i have n't figured out how it 's done and i 'm asking to help me to find out how can i create this kind of `` hook '' to control all requests made at a given subpath . thank you ! < code >
hello guys . i 've been doing a lot of testing with nextjs and i have a question . how can i pass a json data that i receive in my api ( webhook ) from an external service , to client side . i already have the json into serer side , i can display it in the console . what options do i have to pass it to the client side : save it to a database and then read it on the client . save it in local storage . save it as a cookie . could i pass it to my context with usecontext from the api file ? thank you < code >
describe the feature you 'd like to request when an event listener is added to the router using router.events.on , the only url info it is passed is the destination aspath . this makes it completely impossible to infer pathname or query parameters when as differs from href , but as far as i can tell there is no technical justification for this limitation . consider the following example : the output in the console is the following : we can see here that the router object has not been updated to hold the pathname , aspath , or query for the new route , and that the arguments passed to the callback function only communicate the aspath , not the pathname or the query parameters that will be applied . therefore , it is impossible to determine information like the query in the routechangestart event . describe the solution you 'd like i 'd like to see more information encoded in the arguments that are passed to the event listener function . describe alternatives you 've considered i 've considered using some kind of system outside of the router that duplicates router information , but this would make it really hard to track everything through history events like back/forward . < code > router.events.on ( 'routechangestart ' , ( ... args ) = > { console.log ( 'router.pathname ' , router.pathname ) ; console.log ( 'router.aspath ' , router.aspath ) ; console.log ( 'router.query ' , router.query ) ; console.log ( 'callback args ' , ... args ) ; } ) ; router.events.push ( '/my-path ? query=value ' , '/my-path ' ) ; router.pathname / router.aspath / router.query { } callback args /my-path { shallow : false }
i have a nextjs application with an expressjs backend , which is n't getting transpiled with babel . i 'm using node 14 , so i 'm able to use some of the new js features out of the box . i have a helper function that i initially wrote for the backend using commonjs with some new js features , and i 'm having some difficulty trying to make it re-usable from the frontend ( nextjs ) . here 's an example snippet of the error that i 'm seeing : would this require a custom .babelrc or webpack config ( or both ) to work correctly ? < code > you may need an appropriate loader to handle this file type , currently no loaders are configured to process this file . see < url > | | const obj = { } > console.log ( obj ? .foo ) |
feature request is your feature request related to a problem ? please describe . i need to whitelist domains in a 3rd party service , but whitelisting * .vercel.app is too insecure . i 'd like to whitelist * .mygroup.vercel.app for preview urls like project-git-my-branch.mygroup.vercel.app i also need to be able to pass the url to the third party service as part of the auth flow , but even when interacting with the project at project-git-my-branch.mygroup.vercel.app the vercel_url param is still set to project- * * * .vercel.app the problem is i can only access vercel_url which resolves to project- * * * .vercel.app and not the git branch based url describe the solution you 'd like another environment variable which represents the branch name version of the domain , e.g . vercel_static_url=project-git-my-branch.mygroup.vercel.app describe alternatives you 've considered using the git env variables and slugifying the branch ourselves , but it seems too fragile < code >
hi , i have import some css from 3rd parties in component , say import `` a.css '' and import `` b.css '' inside one component . after built i got /_next/static/css/some_numbering.chunk.css . but when i do pagespeed , it tells me the some_numbering.chunk.css should load first to show the right style . is there any way to preload the built css chunks ? < code >
hi there , i need to fetch data only once when i first run the app . like if i were to use getstaticprops in the _app.js file . i do n't want to use getinitialprops because it forces ssr site wide and i will be building to static files . is there seriously no built in way to do this ? i 've exhausted every google search < code >
describe the feature you 'd like to request is it possible to rate limit next build so that the next build process generates dynamic routes ( eg . /posts/ [ id ] ) at a max rate ( eg . 10 per sec ) describe the solution you 'd like eg . /pages/posts/ [ id ] .js has a getstaticprops that calls an external api to retrieve data for a page - this api should not be called more than x times per interval . describe alternatives you 've considered i have tried using bottleneck package to limit the number of times an api is called but it does n't seem to work because of async/await . < code >
hi , we 're using nextjs 10. we 'd like to find a way to be able to do both build time data fetching ( for simple config , such as internationalization or similar local static requirements ) and runtime rendering ( for more complex services hosted elsewhere that really need to be dynamic ) our typical use case is a blog page which embeds a search engine . but the need is very generic . initially , we had been using nextjs with prisma ( or even a simple json ) to store some content , works fine using getstaticprops . now we 're trying to also call a search engine ( in our case meilisearch ) via http calls , so we moved everything ( including the part on prisma ) to getserversideprops . locally it works fine . but when we deploy on vercel , we get an issue during deployment , probably because it does n't limit prisma to read-only access as was previously the case with getstaticprops . with prisma , it fails same with a json config file it does n't seem that we can use both getstaticprops ( for content in prisma or json ) and getserversideprops ( for meilisearch ) in the same page . it seems there are old discussions and issues related to this problem , but i have n't seen a clear answer . # 11424 # 7208 what is the suggested path forward ? or workaround ? thanks . < code >
i make a simple poc of applying css . my concern is why css is not applied on server ( which is successfully applied on client when i check on network tab ) . i added a css file this index.css . added link < link href= '' ./index.css '' key= '' oraclesbase '' rel= '' stylesheet '' / > on server i see this on client i see this . but when i add bootstrap in link tag it apply all css in server also why ? if i applied like this it add style in network why ? ? here is my whole code < url > < code > < link rel= '' stylesheet '' href= '' < url > integrity= '' sha384-bvyiisifek1dgmjrakycuhahrg32omucww7on3rydg4va+pmstsz/k68vbdejh4u '' crossorigin= '' anonymous '' / > a { color : red ; }
hi there , have used this wonderful framework many times with success , but i 've noticed a strange quirk . every now and then , i have a ( known ) error in my code that causes something to fail within the ssr tree . here 's a crude example : my confusion is thiswhen these crashes happen , i literally have to restart the entire process ; things do n't come back otherwise . i would n't bring this up but it 's kind of a pain to have to constantly be restarting the server . i am using pm2 to manage my processes , the failure occurs even when running this script directly : any ideas what might be causing this problem ? is cross-env creating an issue ? the ideal thing would be that , after i fix my errors , the app tries to recompileand i dont have to restart the entire process again . < code > 3|client | referenceerror : token is not defined 3|client | at next_with_apollo__webpack_imported_module_2___default.render ( webpack-internal : ///./src/withapollo/index.tsx:47:22 ) 3|client | at getclient ( /users/andrewmartin/code/health/health-web/ @ health/client/node_modules/next-with-apollo/lib/apollo.js:24:12 ) 3|client | at object.initapollo [ as default ] ( /users/andrewmartin/code/health/health-web/ @ health/client/node_modules/next-with-apollo/lib/apollo.js:11:16 ) 3|client | at /users/andrewmartin/code/health/health-web/ @ health/client/node_modules/next-with-apollo/lib/withapollo.js:105:54 3|client | at step ( /users/andrewmartin/code/health/health-web/ @ health/client/node_modules/next-with-apollo/lib/withapollo.js:44:23 ) `` dev '' : `` yarn prepare & & cross-env node_options= ' -- inspect=localhost:9230 ' next -p 4000 '' ,
i have a mdx file that i am just using as a playground for styling and trying out new things . i do not want it to be bundled in the production build . i have code in place that filters it out of being present in the ui however when i run yarn build the logs still show that it is being bundled . i am trying to remove a file or ignore it when building in production , but i am not having much luck in getting it to work . has anyone else tried to remove files from the production build at build time ? i thought just using the ignoreplugin would be the way to go but apparently not . < code > page size first load js / 776 b 1.05 mb /_app 0 b 1.05 mb /404 307 b 1.05 mb /about 1.62 kb 1.05 mb /blog 882 b 1.05 mb /blog/ [ ... slug ] 1.64 kb 1.05 mb /blog/2021/how-to-kill-processes-on-macos /blog/2021/looking-at-2021-with-2020-vision /blog/2021/road-map-for-my-website-blog /blog/post-style -- -- -- -- -- -- -- -- - > # still present in the production build + first load js shared by all 1.05 mb chunks/05d954cf.748edb.js 21.7 kb chunks/9f96d65d.e84e24.js 29.3 kb chunks/a2840a2f.ad71a5.js 16.6 kb chunks/a64a0152a6eb52644ba63c860cfab57259a770eb.6ab53a.js 847 kb chunks/commons.369017.js 14.7 kb chunks/d57d79ab.728809.js 60.9 kb chunks/framework.1b78ac.js 46.7 kb chunks/main.bfa6c5.js 6.25 kb chunks/pages/_app.b93d90.js 1.77 kb chunks/webpack.245f04.js 751 b css/c1cd22bd3c532c92b3b2.css 5.96 kb const { phase_production_build } = require ( 'next/constants ' ) module.exports = { reactstrictmode : true , webpack : ( config , { buildid , dev , isserver , defaultloaders , webpack } ) = > { if ( phase_production_build ) { config.plugins.push ( new webpack.ignoreplugin ( /data\/blog\/post-style.mdx/ ) ) } return config } , } ./data/blog/post-style.mdx # file to be removed from production build
hello , i have a project that uses next-translate , and the final build is exported to be served by external servers . my issue is the process to compile and export take a long time , total of 15 min or so ( calling next-translate & & next build & & next export -o ./build/out ) . i have only 6 top pages but have about 10 languages , i think the next-translate spit out a page per language so that is 60 pages total . it seems the compiler uses much memory and cpu and it can get out of memory sometimes ( i 've increased mem with node_options= -- max_old_space_size=8192 ) . my question , is there anything i could tweak to make this process more efficient , particularly if i can shorten the time it takes ? < code >
when serving example using serve out the static serving works fine . however , when uploaded to firebase hosting , the deep links do not work . for example , when clicking on < url > from the index page , the post gets loaded correctly . however , if we directly try to hit a link to < url > on main page , we get a 404. directly hitting < url > works . we do not want one method working in dev and one method working in final deployment . what is the correct way to configure the statically exported projects to work on hosting such as firebase ? or is it meant to work only on vercel platform ? i did various experiments with exportpathmap but none seemed to work so far . < code >
this might be a very basic question but since i 'm pretty new to nextjs , it 's blocking me for a while . i have defined a 404.js in /pages and it works fine when i type a random path in the search box and redirects me to that 404 page . the problem is that it is only working locally . when i deploy the project on the s3 bucket and try a random path , it redirects me to / and not to the 404 page . < code >
i am looking at using next.js for my next project , after some google searching i have yet to see a example of using next.js custom server with okta auth . i have seen a lot of examples for react and express . but since there is some abstraction using next.js i am wondering if these examples would still work . has anyone seen examples or articles they could point me to or have had experience with using next.js with okta ? < code >
describe the feature you 'd like to request file : next-server/lib/utils.d.ts replace nextapirequest.query string | string [ ] by just string describe the solution you 'd like describe alternatives you 've considered use an api middleware to format the string received from the request format the string value directly in the handler function like req.query.userids.split ( ' , ' ) overriding the req type as { nextapirequest & query : { [ key : string ] : string } } < code > export interface nextapirequest extends incomingmessage { / * * * object of 'query ' values from url * / query : { [ key : string ] : string ; } ; ... }
i 'm just getting started with next.js but really enjoying the experience so far so , thanks ! i 'm using next/head to set a default page title in my custom app , and then override that title in my pages . simple enough . however , i was wondering if there 's a sensible or recommended way to append my default/base title to the titles set by my pages , without having to share that default title data with every page . in django for example , the world i 'm coming from , i could call block.super inside my title block in a child template , which would bring in the value from the parent template , allowing prepending/appending etc . so the notional desired outcome might be : default title set in _app.js : my site title set by `` about '' page : about desired resulting value of < title > on `` about '' page : about | my site i know i could achieve this if i shared that default title string with my page , e.g . in a react context , but i 'm interested to hear if there 's a way to avoid that , since i want to do this on almost every page . if there 's a way to do it without each page needing access to the default title data , that would be great . any advice much appreciated . thanks for reading ! < code >
hi , i read the documentation thoroughly and i do n't really understand what 's going on with routing on my react-native-web app . when i use link like this : it loads the new page . what if i need to just change the route without loading the page like a spa ? setting shallow to true : does n't change anything . also , when i use router.push ( path ) , it changes the route without loading the page . what if i need to load the page completely ? < code > < link href= { path } shallow= { true } > < a > ... < /a > < /link > < link href= { path } > < a > ... < /a > < /link >
feature request is your feature request related to a problem ? please describe . when creating a typescript file for an api route , for example at path pages/api/users.ts , and starting next using node_options= ' -- inspect ' next dev , an applied breakpoint brings you to a generate typescript file instead of the file you are debugging . describe the solution you 'd like the debugger should bring me to the place where i placed the breakpoint . describe alternatives you 've considered considered writing a manual file called server.js to start api routes in debug mode when trying to debug an error instead , but i would need to remap the api calls to a separate port and change the configuration in the frontend files . additional context < code >
what version of next.js are you using ? 10.0.5 what version of node.js are you using ? 15.4.0 what browser are you using ? chrome what operating system are you using ? macos how are you deploying your application ? vercel describe the bug i have a local project and i can not get .env files to load . .env.local next_public_code=1234 example.js have also tried loading them into a node environment , with and without the 'next_public_ ' prefix and they are undefined . any ideas ? expected behavior i expected the .env variables to load . to reproduce .env.local next_public_code=1234 example.js i have a more complicated project then the example above , and noticed the issue when i began integrating authentication . however i have simplified it and run only the example above and the variable remains undefined . if i install dotenv via npm then i can create a .env file and load the variable successfully , however this introduces other errors . < code > const example = ( ) = > { return < h1 > my code is { process.env.next_public_code } < /h1 > } export default example ;
general recommendation for processing a pdf file in webpack keeps pointing me back to : < url > their documentation does n't really explain static generation , and next 's documentation does n't really explain file loading for pdfs . i 've cobbled the following together , but the pdf links do n't seem to work with next 's file system . anyone have a sense of where i 'm going wrong ? < code > // next.config.js const withplugins = require ( 'next-compose-plugins ' ) const withimages = require ( 'next-images ' ) const { phase_development_server , phase_production_build } = require ( 'next/constants ' ) const nextconfig = { webpack : ( config , options ) = > { config.module.rules.push ( { test : /\.pdf < cur > / , use : [ { loader : 'file-loader ' , options : { name : ' [ path ] [ name ] . [ ext ] ' , outputpath : 'pdfs ' } } ] } ) return config ; } } module.exports = withplugins ( [ [ withimages , { [ phase_development_server ] : ' < url > ' , [ phase_production_build ] : ' < url > ' } ] ] , nextconfig )
hi there , i could n't find any documentation on this . is this expected behaviour ? with trailingslash enabled , router.pathname does not include the trailing slash . thanks . < code >
hi , i understand that the new image component is ssr only . i have image processing as a requirement on my build and am not running express as a server , using nginx and cloudflare for static pages/assets . but i 'm still interested in optimizing and resizing images . should i just roll my own and process them on the save hook of the cms or is there another option i 'm overlooking ? thanks a lot ! < code >
nextjs image component is awesome and doing a great job . read many articles about how it performs well in the page load . but the rendered file is using base64 and not the actual image link . is n't this hurting my seo targeting google images . is there any option to overcome this ? ? or am i missing something ? < code >
hello , i was working on a nextjs project where i was asked to add an external script that dynamically creates nodes using vanilla js ( createelement , setattribute , etc. ) . i could n't help but notice that the global css imported at the top of my _app.js did not affect these dynamically created elements at all . i tried importing the css many different ways but could n't get the nodes to be repainted without modifying the external script and dynamically adding the styling there . does anyone know why exactly these nodes are n't repainted by the imported css and how to import them / configure next in a way where they are ? thank you ! p.s : script works and is imported in , tried importing css in too without luck < code >
maybe a stupid question considering how the next pages directory works - we 're planning on using a scss module file per page . can we locate these adjacent to the page they are associated with or would having the .scss file in the pages directory be an issue ? e.g . < code > /pages /profile index.tsx profile.module.scss
what version of next.js are you using ? 10.0.5 what version of node.js are you using ? 12.19.0 what browser are you using ? chrome what operating system are you using ? macos how are you deploying your application ? next build describe the bug adding a custom webpack : ( config ) = > to next.config.js is not working as it 's not invoked even though it 's reported here nextjs.org/docs/api-reference/next.config.js/custom-webpack-config i also tried with @ next/bundle-analyzer and it 's not working either as it 's setting webpack which is again not invoked . expected behavior to be able to specify custom webpack configuration to reproduce just folowing this < url > it wo n't work < code >
i 'm testing the experimental redirects feature with a few routes to replace an older redirect component that we use . during my initial test , i noticed that the query string is n't carried through to the destination . this causes my redirects to not work as intended if the user came from an older link which had specific filters as well as stripping query parameters consumed by our analytics like campaign , source , etc . is there a way to create a source and destination pattern which will carry all query params through without explicitly defining each query param in the pattern ? < code >
hi i found many subjects , requests related to that behaviour ( particularly this one # 18419 ) but never found an official answer from nextjs team the simple pattern of this request is to have a way to never fallback on / but always on / [ defaultlocale ] i have a classic example here < url > i would like to have [ en ] navigation forced with /en/ [ my-path ] instead of / [ my-path ] any insight to help us to go forward with that topic ? thanks ; ) < code >
not sure if this is related to next.js , but i am getting the following warning : however , doing so does not fix the warning . anybody else encountered something similar ? < code > browserslist : caniuse-lite is outdated . pleas run : npx browserslist @ latest -- update-db
feature request is your feature request related to a problem ? please describe . while using @ auth0/nextjs-auth0 we need to configure a redirecturi value ( as part of the oauth2 flow ) . currently it is fixed , which means the authenticated pages from pull requests ( automatically deployed using vercel for github ) can not be tested . workaround but as each pull request has one of its preview urls matching the following this pattern < url > , we were able to workaround this issue by adding in auth0 the following redirect uri pattern phofurl and using the following code to deduce the redirecturi in our next.js project : we consider this workaround to be a bit wobbly as not officially supported & as we rely on now_github_commit_ref which needs to be transformed to get the preview url . describe the solution you 'd like the preview url ending with . < project > .vercel.app is available as an environment variable ( something like vercel_preview_url ) during the deployment . < code > if ( process.env.now_github_commit_ref === 'master ' ) { baseredirecturi = getconfig ( ) .publicruntimeconfig.app_url ; } else { baseredirecturi = ' phofurl '- ' ) } .myproject.vercel.app ' }
hi , i have quite a large next.js project which is structured in a `` folder-by-feature '' , so a component has all related files close together , e.g . i would like to be consistent so inside page/ directory i would like to also have the same structure . but i found no way to exclude test files from being treated as a route . i searched lots of old issues but none of them has a decent solution , also non of the given workarounds works in next 10.x is there a 2021 solution for this approach ? or any plans to exclude test files from pages ? < code > about/ - about.js - about.module.css - about.test.js
i find that nextjs will auto add a meta element < meta name= '' viewport '' content= '' width=device-width '' > . are there any way to remove this meta element ? context as my project is not compatible with mobile view , i dont need the viewport meta element . then users can visit my site by zooming in at least . < code >
i cloned the next.js repo , installed dependencies , but could n't find package.json scripts or some other way of building the documentation website and serve it from localhost so i can see it offline . the /docs folder has a manifest.json but i 'm not sure if that 's a next.js website itself ( does n't look like it . ) i 'm new to next.js so this might be a bit obvious and i missed it . i appreciate any pointers . thank you ! < code >
the html export in next js does not seem to work with the usual routing . is there any way i can make it work . note : i am trying to run the application over file : // instead of http : // . < code >
my project is based on nextjs 9 custom server . custom server is express v4 . i upload files through the multipart form to the server into /public/static/ folder by multer . in production mode i always receive response with 404 code for get-requests to just uploaded files . after server restart i receive response with 200 code for all previously uploaded files and 404 code for new uploads only . this issue does not exist in developer mode . problem is not present only if server.js contained : const nextapp = nextjs ( { dev } ) ; and server launch command is : < cur > nodemonserver.js github project < code >
hello , i 'm trying to pass down some information that is fetched in the app component to some other components that are rendered . in the app level , the getinitialprops is something along these lines : then , i need to access a value inside data in several nested components to run their getstaticprops methods , too . i know this must be possible as everything here runs server-side , but i just could n't find anything remotely close to it in the documentation and everybody seems to be using contexts , but that kills server side rendering which is a must in my case . so how to pass data down to getstaticprops without the need to call fetcher.get ( ... ) again in every component that needs it ? < code > myapp.getinitialprops = async ( appcontext : appcontext ) = > { // this call is heavy ! const data = await fetcher.get ( '/get_data ' ) ; const appprops = await app.getinitialprops ( appcontext ) ; return { ... appprops , data } ; }
is there a way to do this without the rendering cost ? i 'm curious how robinhood does it , where if i go to robinhood.com , it brings me to their statically generated website , but if i was already logged in , i 'm being redirected to their main app page . < code >
hi , i 'm trying to render meta tags with next/head whilst using fallback : true in getstaticprops . is there any way to achieve this ? thanks < code >
i have an excel file words.xlsx in public directory . initially , during development mode , /public/words.xlsx worked fine but it failed in production mode saying that it ca n't read file.then , i read this and changed path to/words.xlsx but i am still receiving the same error in my function logs . how do i solve this ? do i have to upload file in aws and read it from there ? < code > [ error : enoent : no such file or directory , open '/words.xlsx ' ] { errno : -2 , code : 'enoent ' , syscall : 'open ' , path : '/words.xlsx ' } enoent : no such file or directory , open '/words.xlsx '
i have a component that i 'd like to make dynamic ( only render on the client ) . it appears to me that in order to do this i have to do one of the following have 2 files ( component file & another file to make this component dynamic ) use next/dynamic in the file that imports the component i want to be dynamic . both of these feel suboptimal to me . i 'd love to be able to define a dynamic component like this : is there any way to achieve this ? < code > import dynamic from 'next/dynamic ' const component = ( ) = > { // do stuff } export default dynamic ( component , { ssr : false } )
describe the feature you 'd like to request i would like to provide a url object for destination when performing a server-side redirect . < url > < url > describe the solution you 'd like describe alternatives you 've considered providing a string for destination . < code > return { redirect : { destination : { pathname : '/about ' , query : { name : 'test ' } , } } , }
@ leerob just linked < url > on twitter , and while looking at it , and having been checking out redwood , i started wondering if a router could be exposed without diminishing that it 's a zero configuration router . first , i think the example would look better as jsx . instead of : it could be : second , by putting it in pages/ i think it would be grouped with other similar things , and facilitate defining the api routes in a separate file - pages/api/_router.js third , it would be run through babel and have the export keyword instead of module.exports . editors would perhaps be easier to configure . i 'm curious why this would or would n't be a good idea . i 'm not sure . < code > module.exports = { async rewrites ( ) { return [ { source : '/about ' , destination : '/ ' , } , ] } , } import < router , rewrite > from 'next/router ' export default ( ) = > ( < router > < rewrite src= '' /about '' dest= '' / '' / > < /router > )
hi all ! please @ timneutkens can you check why is not possible to install v10.0.6-canary.7 . but older version v10.0.6-canary.6 works well . tested with yarn v2 error : < email > no candidates found thanks a lot ! < code >
running the following command rm -rf ./build & & npm run build & & y | gcloud app deploy -- project cyberpunk-2077 app.yaml get the following the directory [ build/cache/next-babel-loader ] has too many files i have to run with node 10 btw . because google flex environment does n't support min_instances properly ( slow demo 's for sales ) any ideas ? we 're stuck now . qa department supposed to be testing on monday 🙈 < code >
feature request i would like to encode json objects into url 's search parameters i was developing an endpoint to get items filtered and paginated from a collection in a database . the collection contains items type of invitation , which have attributes like `` createdby '' , `` createdat '' , `` invitedemailaddress '' and `` type '' . i wanted to encode following parameters inside the query string : page = 0 rowsperpage = 10 filter = { `` createdby '' : 1 , `` type '' : 2 } ( where 1 is a user id and type is an enum ) to encode filter object , separated its keys and encoded them as following : filter [ createdby ] = 1 filter [ type ] = 2 resulting url is the following , since encoding converts square brackets into % 5b and % 5d : < url > however , this results in the following query object in my api handler 's request part : { `` page '' : 0 , `` rowsperpage '' : 10 , `` filter [ createdby ] '' : 1 , `` filter [ type ] '' : 2 } seems that i ca n't embed objects in the url search params . desired behavior for these input page = 0 rowsperpage = 10 filter = { `` createdby '' : 1 , `` type '' : 2 } the following output in the query part is desired . { `` page '' : 0 , `` rowsperpage '' : 10 , `` filter '' : { `` createdby '' : 1 , `` type '' : 2 } } thanks in advance . < code >
feature request is your feature request related to a problem ? please describe . we 'd previously used the bundlesize package in ci in order to monitor the growth of our application and prevent accidental imports of test libs , etc . with the switch to the new chunking strategy , the hash-based names of the new chunks breaks this approach ( we previously just watched chunks/commons. * .js ) . but the new `` first load size '' data could easily replace this functionality , if it were easily accessible ( i 'm not super keen on redirecting and parsing stdout ) . describe the solution you 'd like would it be possible to add a configuration option to next.config that enabled also writing the size data to a json file such that it could be then analyzed by other tools ? describe alternatives you 've considered capturing and parsing the stdout of a yarn build command . < code >
hello , i would want to show styled components display name in classname . by default , i need to set up .babelrc . the configuration is shown below . but here is the question . how can i set up this configuration only for development ? thank you in advance for your reply . < code > { `` presets '' : [ `` next/babel '' ] , `` plugins '' : [ [ `` styled-components '' , { `` displayname '' : true , } ] ] }
hello , i 'm having a basic contact form it works fine with my localhost but when i try it on hosting or on the domain i cant handle the request it returns 405 every time i try to submit , i 've the following sendgrid email function on my api/email.js file , i 've made research but i was unable to solve that issue . and my post request is the following ; < code > const handleonsubmit = async e = > { e.preventdefault ( ) setstatus ( prevstatus = > ( { ... prevstatus , submitting : true } ) ) const res = await fetch ( '/api/email ' , { method : 'post ' , headers : { 'content-type ' : 'application/json ' } , body : json.stringify ( inputs ) } ) const text = await res.text ( ) handleresponse ( res.status , text ) } const sgmail = require ( ' @ sendgrid/mail ' ) export default async function ( req , res ) { sgmail.setapikey ( 'apikey ' ) const { email , name , message } = req.body const content = { to : ' < email > ' , from : ' < email > ' , subject : 'new message from - < cur > { email } ' , text : message , html : ' < p > < cur > { name } , < cur > { message } < /p > ' } try { await sgmail.send ( content ) res.status ( 200 ) .send ( 'message sent successfully . ' ) } catch ( error ) { console.log ( 'error ' , error ) res.status ( 400 ) .send ( 'message not sent . ' ) } }
we are facing 308 redirect issues with trailing slash at the end of each url . google bot crawls few ulrs with trailing slash even though we are not having any . please suggest me where to disable this to stop google crawling with slash at the end . thanks . < code >
hello ✋ i have a problem with source maps in my next js application . so i got an error : but when i am clicking on a source file it 's not the original source file , it 's the built source file , the ugly one . so is it my configuration which is wrong ? because i set up the nextjs app with the generator ... < code >
when i set assetprefix : `` < url > '' in next.config.js for css and js file , it show this request url : < url > for background image import in css url , like background : { image : url ( ' .. /public/images/img_cloud.png ' ) ; size : 1540px 800px ; repeat : no-repeat ; color : < cur > bgcolor ; position : center ; } ; the request look like this : request url : < url > but for font file imported in css , it show like this request url : < url > < code >
is there a good way to < link > an < image > in next ? doing this ☝️ seems to generate a few < div > s with styles on them within the anchor tag , and it feels wrong to wrap an anchor around a < div > . < code > < link href= '' / '' > < a > < image alt= '' logo '' src= '' /images/logo.svg '' width= { 132 } height= { 52 } / > < /a > < /link >
i would like to disign schema ( in mongodb ) for my app . it 's app in nextjs where is will be a page where is my tours default there will be sorted b topic and subtopic in page view for example topic : england - > subtopic a ) londyn b ) stonehenge topic : france - > subtopic a ) lyon , b ) calais c ) paris i wonder data it will be a embeded - > one object { topis : subtopics : [ { subtopic : .... } , { ... } ] } 2 ) or references { topics : [ { id : .... } ] } and { subtopics : [ { id : .... } ] } < code >
newer dev here - i 'm trying to use the image component and running into issues with the layout and objectfit properties . in this case , i 'm wanting to have a logo in the nav bar surrounded by a border , but can not seem to preserve the logo 's original height/width properties with the component . here are is my code for the native component that are working as desired along with an attached screenshot of the outcome . when i use the component , it requires either height and width , or layout=fill which warps the logo . i 'm starting this discussion because i can see this becoming an issue for other cases . i do n't want to always rely on using height and width in pixels because that does n't scale well or preserve aspect ratio . sometimes % , rem , vw , vh , etc . are necessary for setting width and then height being set by aspect ratio . any suggestions ? am i missing something ? is this a situation where i would n't want to use this image component and just use the default ? code : < code > < flex border= { '3px solid < cur > { colors.white50 } ' } height= { ' 2.5rem ' } padding= { '3px 6px ' } position= { 'relative ' } > < img alt= { 'logo ' } height= { '100 % ' } src= { '/assets/logo.png ' } / > < /flex >
hey there , i 'm involved in transitioning into nextjs but i need to do some incremental adoption . there 's a few utilities in next-server that i would like to use without the full overhead of nextjs right now . is there anyway to do this ? i noticed there 's a next-server package but has n't been published in a year . i 'm assuming there was a decision to keep it fully integrated into the `` next '' package . let me know if this is at all possible ! thank you . < code >
hey folks 👋 like many of you , i 'm a big fan of `` incremental static generation '' and use it wherever i can . however , i ran into issues when i wanted to update pages instantly ( for the current user , not the next ) i wrote up the solution here : < url > hope this helps anyone stuck in the same boat < code >
is there a way i nextjs can wait till my pupeteer instance is initialized before calling the route . ps : ♥️ this framework < code > let browser : puppeteer.browser = null ; async function loadpuppeteer ( ) { console.log ( `` initializing puppeteer '' ) ; browser = await puppeteer.launch ( ) ; browser.newpage ( ) ; console.log ( `` initialized '' ) ; } loadpuppeteer ( ) ; const getprices = async ( search ) = > { const page = await browser.newpage ( ) ; await page.goto ( ' < url > } & ref=nb_sb_noss_2 ' ) ; const res = await page.evaluate ( ( ) = > [ ... document.queryselectorall ( `` .a-size-medium.a-color-base.a-text-normal '' ) , ] .map ( ( e ) = > e.innerhtml ) ) ; return res ; } ; export default async ( req : nextapirequest , res : nextapiresponse ) = > { console.log ( req.query ) ; const prices = await getprices ( req.query.search ) ; res.json ( prices ) ; } ;
when i deploy my project , currently in preview here , on vercel i am getting 404 's in the console saying : also it seems to break my transitions going back and forth between about ( homepage ) and join , because of the 404 if i 'm correct these json files contain the data from the server . which does work because all content comes from a cms . notice : this only happens on the homepage and only on the deployment server . building the project locally gives me no problems . < code > /_next/data/1611146426682/en/index.json:1 failed to load resource : the server responded with a status of 404 ( ) /_next/data/1611146426682/nl/index.json:1 failed to load resource : the server responded with a status of 404 ( )
we have some static pages that get their data from the database . the problem is that if at build time , the database is not online , then the build fails . the point is that we want to dockerize our app and we ca n't add db connection to build our app while building the image . in the documentation , i saw that we can use fallback : true to postpone the build to run-time , but you can only use it on pages with dynamic routes . we have some pages without dynamic routes that read their data from the database . is there any workaround to solve this issue ? < code >
i am trying to get locale information from document context but req.url reports the url without the locale and no other properties on the document context seem to have it . i am doing static generation on all pages with getstaticprops . is this a known limitation , done by purpose or i am missing something ? the locale is available in the document instance through this.props.locale , but i am doing http requests in getinitialprops that need the locale information at that time . is there a way to achieve this ? the reason we need this is that we have static html that is fetched on the server , and should never be hydrated on the client < code >
when i register an event listener in the `` useeffect '' function and then remove it in the return statement , it removes this event listener after the route changes , which causes warnings about memory leaks in react . is there a solution to that ? example : edit : it removes the event listener as it should , i just had settimeout ( ) running that leaked over to the next page .. < code > useeffect ( ( ) = > { window.addeventlistener ( `` scroll '' , scrollfunction ) return ( ) = > { window.removeeventlistener ( `` scroll '' , scrollfunction ) // this event listener is removed after the new route loads } } , [ ] )
bug report describe the bug in my getserversideprops function , context.params is overwritten and the function reruns . when the page makes a request ( ex : /static/image.png ) stemming from < img src='/static/image.png ' / > the context.params in my getserversideprops are overwritten to { param1name : 'static ' , param2name : 'image.png ' } to reproduce reproduced here < url > expected behavior getserversideprops only runs once , and context.params remains the path parameters screenshots if applicable , add screenshots to help explain your problem . system information os : [ e.g . popos ] browser ( if applies ) [ e.g . chrome ] version of next.js : [ e.g . 9.3.5 ] version of node.js : [ e.g . 12.16.3 ] additional context add any other context about the problem here . < code >
hi , i want to keep common map component between my pages . so i have rendered map component inside _app.js file , default map will show all locations marker , but once i will select any particular location which will go to [ slug ] .js page , i want to pin only that marker on the map . how can i achieve it in next js < code >
i have a background-image : url ( ) in my css . it gets processed into something like url ( /_next/static/images/data-ca5b4b33bb115bdb9a3e699262772271.jpg ) so it goes through next.js . how to prefix it ? my site is running at localhost:3000/app so url ( /_next/static/images/data-ca5b4b33bb115bdb9a3e699262772271.jpg ) gives 404 . /app/_next/static/images/data-ca5b4b33bb115bdb9a3e699262772271.jpg works . tried setting basepath and assetprefix but it has no effect . next.js v10.0.3 < code >
i 'm trying to do some web scrapping with puppeteer and nextjs , but i 'm not having success deploying it . does anyone have success in it ? < code >
it appears as though rewrites for localized and dynamic pages might not work . here 's my next.config.js : when visiting /fr/produits/produit-1 , i get a 404 ( which is not desired ) . when i visit /fr/products/produit-1 i am able to view the page in the right locale , but this is not what i want since the slug is not fully translated . i 've even tried being more specific in my next.config.js , but this also does not work : fyi , my directory structure is as follows : note : this sounds similar to this open issue . < code > module.exports = { i18n : { locales : [ 'en ' , 'fr ' ] , defaultlocale : 'en ' , } , rewrites ( ) { return [ { source : '/fr/produits/ : slug ' , destination : '/fr/product/ : slug ' , locale : false } ] } } /pages /products [ slug ] .tsx module.exports = { i18n : { locales : [ 'en ' , 'fr ' ] , defaultlocale : 'en ' , } , rewrites ( ) { return [ { source : '/fr/produits/produit-1 ' , destination : '/fr/product/produit-1 ' , locale : false } ] } }
hy guys ! thanks in advance ! i 'm fairly new to next.js so i have been doing the tutorial but i have some trouble understanding the creation of dynamic pages . in there , it creates a /posts/ [ id ] .js file to make the layout of the different blog posts . here comes my doubt . in that file , it uses getstaticpaths to get all the possible ids to pregenerate html files of all those blog posts in build time , and prepopulate them via getstaticprops also at build time . does this mean that , if i upload new posts to the cms or whatever data fetching service i use , i will have to rebuild the app everysingle time ala gatsby if i host it in a server ? if so , is it better to use a single /post page and fetch the data via a param query ? < code >
describe the feature you 'd like to request in getstaticpaths , return ( pseudo-code ) paths = { params : { id : result.id , slug : result.slug } } then , in getstaticprops , you can query the firestore for the document id ( rather than fetching all documents and having to search the subfields for id await db.collection ( 'database ' ) .doc ( params.id ) then you can use the page 's slug for seo , but still have the granularity of specifically querying one document . describe the solution you 'd like just an extension of what 's already there . describe alternatives you 've considered the only alternative i 've seen is passing the [ slug ] ( in this case ) and then having to re-query every document in the database to check the subfield . this is my first issue post , so please let me know if anything needs changing . i apologize for my ignorance . < code >
we have a very simple page with only one page and it uses : getserversideprops to render the page server side . we do n't use next/link or next/router but in our prometheus log we see some request towards : _next/data/ < string random > /index.json did this surprise us and we do n't know how to give us an answer ? why do we have these requests if we do n't have a client side routing ? < code >
hi all , i seem to run into a problem where i 'm trying to configure incremental adoptation like so : however i 'm also using returning fallback : 'blocking ' in one of my pages ' getstaticpaths . the problem is that the rewrite is happening before it tries to render . so even though a url is valid but not yet rendered , nextjs rewrites the url anyway . i wonder if i 'm doing something unintended or if this is how it 's supposed to be ? < code > // next.config.js module.exports = { async rewrites ( ) { return [ // we need to define a no-op rewrite to trigger checking // all pages/static files before we attempt proxying { source : '/ : path * ' , destination : '/ : path * ' , } , { source : '/ : path * ' , destination : ' < url > } , ] } , }
i have a submenu that shows up when i hover on some of the menu items in the header . if i move the mouse outside the main menu or the submenu , it hides . however , if i click on some component in the submenu it loads the new page but the submenu does n't hide . how can i force the hide event when i navigate to another page ? < code >
this is my next.config.js file . is this the proper way to set cache-control headers inside next.config.js for all of my /pages ? this does work locally but not in deployments . < code > const withplugins = require ( 'next-compose-plugins ' ) const withbundleanalyzer = require ( ' @ next/bundle-analyzer ' ) ( { enabled : process.env.analyze === 'true ' , } ) module.exports = withplugins ( [ [ withbundleanalyzer ( { } ) ] , { async headers ( ) { return [ { source : '/ : pages * ' , headers : [ { key : 'cache-control ' , value : 'private , max-age=180 , must-revalidate ' , } , { key : ' x-test-header ' , value : 'this is a test ' , } , ] , } , ] } , } , ] )
whenever using : i need to fetch data from an external source in getstaticprops . before this data is fetched , [ [ ... slug ] ] returns an empty object as pageprops . in my _app i create a loader until this object is not empty anymore . it all works fine , but if i look at my page source , i see the loader in the html , and not the actual content . anyone know how i can fix this ? < code > pages/some-path/ [ [ ... slug ] ] .tsx
i 'm connecting my nextjs to a cms via api , and i 'm trying to make all the words in next translatable , thanks next for delivering the internationalized routing feature . my issue is related to the words endpoint , i have a huge json file of words , i do n't want to fetch it every time when i request a page , i want to fetch it once and update it every day for example , what is the best approach to do this in next ? thanks in advance . < code >
hi , i 've got a page called service.js , so i also have an auto-route like /services i want that page to be accessible from /servizi so i opened my next.config.js file and wrote : works fine , except that now that resource is reachable both from /servizi and /services . what i 'd like though , is that the resource would be accessible only from /servizi . how to ? < code > module.exports = { async rewrites ( ) { return [ { source : '/servizi ' , destination : '/services ' , } , ] } , }
i want to stop build progress if new one started does n't work < code > const proc = child_process.exec ( 'npm run export ' ) proc.kill ( ) [ 2021.01.19 17:14:14 ] info - generating static pages ( 0/33 ) [ 2021.01.19 17:14:15 ] info - generating static pages ( 16/33 ) [ 2021.01.19 17:14:18 ] info - generating static pages ( 16/33 ) [ 2021.01.19 17:14:18 ] info - generating static pages ( 24/33 ) [ 2021.01.19 17:14:19 ] info - generating static pages ( 8/33 ) [ 2021.01.19 17:14:21 ] info - generating static pages ( 24/33 ) [ 2021.01.19 17:14:22 ] info - generating static pages ( 33/33 )
by default , the service launched by next.js will read the contents of the .next file for rendering . what if i want to be able to select different files for rendering under certain conditions before reading the file for rendering ? for example , the.next file is read by default when the service is started , and then the.next_other file is read for rendering by changing a variable when the service is restarted . < code >
hi , i have a little question , i need to access to the header of request for getting user agent of my user and i 'm wondering if there is a way to do it with static pages ? i know that i can access to it if i use ssr but i want to do it in the static way . does i need to wait for window object loaded with an event listener ? any recommandations ? thanks in advance < code >
hi , i was wondering : is there a way/option to temporarily avoid getting minified html ? so that when you view source ( instead of console ) you 'll see pretty indented html ? < code >
what version of next.js are you using ? 10.0.5 what version of node.js are you using ? 14.15.4 what browser are you using ? chrome canary what operating system are you using ? macos big sur how are you deploying your application ? vercel describe the bug in the doc , it is said that `` in next.js , you can add global css files by importing them from pages/_app.js . you can not import global css anywhere else . '' with the `` /styles/globals.css '' this is indeed the case - it will emit an error . but i can import `` tailwindcss/tailwind.css '' in a layout.js component . should n't `` tailwindcss/tailwind.css '' also be considered global css and only importable in _app.js component ? expected behavior emit an error when importing `` tailwindcss/tailwind.css '' in places other than _app.js . to reproduce import `` tailwindcss/tailwind.css '' in any places . scaffold a next.js app set up tailwindcss import `` tailwindcss/tailwind.css '' in any component other than _app.js < code >
the following error is thrown every few deployments on vercel . although it says `` the origin closed the connection. `` it successfully resumes static page generation for other routes immediately thereafter . the client and server are threaded via a wpgraphql endpoint . the wp-specific specs = a linux wp instance ft bitnami and automatiic on aws lightsail . i configured an ssl certificate for a custom domain to wrap the instance in a cloudfront cdn . i came across the alpha release of this next-aws-cloudfront package but it seems to be serverless-specific : `` compat layer between next.js serverless page and cloudfront = > lambda @ edge . '' i asked a senior aws engineer about this particular issue a couple weeks ago and he was a bit stumped too . any suggestions would be greatly appreciated . would the aws-sdk be the best bet to resolve this ? repository < code >
i understand that the pages folder can be placed in src . however , when using the global stylesheet , it does not apply to root/src/pages/_app.js and forces the root/pages/_app.js . why does n't the global stylesheet also support putting it in the root/src/pages/_app.js ? if global stylesheet is too old to support properly , please let me know which method to use . < code >
hi all , i am developing a pwa and need to install a service worker . i am doing that inside 'useeffect ' in app.js as below and i have sw.js inside 'public ' folder . chrome is throwing me this error a bad http response code ( 404 ) was received when fetching the script . this is working in my local but not in server ( hosted in heroku ) i am able to access manifest.json in public folder . < code >
hi , i am trying to use image component where src of image is the s3 url , its working locally giving 404 in production . i have mentioned domain in a file called next.config.js < code > module.exports = { images : { domains : [ 'sy-media-store.s3-us-west-2.amazonaws.com ' ] , } , } < image classname= '' banner-image '' width= { 1024 } height= { 309 } src= '' < url > alt= '' cover image '' layout= '' responsive '' / >
hi , i have a url that in one of the url segments , has two colons as part of an id that is received from an incoming link . it looks like this : /some/1234🔤def/thing after updating from 10.0.1 to 10.0.5 , the colons started being encoded when issuing push.replace ( ) . the issue comes from one of the core changes in the release : ensure path encoding is handled consistently for prerendered pages : # 19135 specifically , this one : < url > the urls are now encoded as /some/1234 % 3aabc % 3adef/thing which is not something i desired to do . is there a workaround or option to avoid this ? < code >
hey guys , a frustrating issue which i tried to solve for two weeks without success , hopefully someone can shade a light here . i am trying to embed a jquery range slider into nextjs so that when a user finish sliding it should update the querystring using router.push . nothing fancy - it works good . the problem begins when there is some other query string parameters . it seems like the router.query is empty whenever the slider onfinish event is called . you can find simple playground to reproduce the problem here to reproduce : click the checkbox - it will populate a query string called `` oled '' then slide with the slider - it will update it 's own query string `` battery_power '' and will delete the `` oled '' querystring the expected behaviour is to update the querystring instead of override it . appreciate any help here . < code >
if you go to this website and run a lighthouse test , under the performance report you can see the following suggestions for improvement : the 2 main areas of concern for me are : 1. remove unused javascript in the screenshot below , it suggests me to use react.lazy ( ) for code splitting , but nextjs already does route based code-splitting . does this mean i need to lazy load the components that i am using in every specific page ? 2. remove unused css i understand that i need to purge the unused css , but how can i do that in nextjs ? in this project , i am using bootstrap so solutions specific to that would be really helpful < code >
let 's assume a web page that contains maybe a public part , part only for registered users and a part only for admin users . in most cases it is ok that the client bundles containing all the react stuff etc . is ok to be freely available for the public and only registered users part . but how to prevent that the bundles which contain all the client-side logic , react components etc . for the admin views could be freely downloaded and examined ? of course the apis must be protected but maybe getting an idea how the views look like or some other internal things would also require access restrictions . < code >
i am looking for best pratices using next.js : in which use cases should i use swr ? what are the pro and cons depending on each use case ? in which use cases should i use getstaticprops ? what are the pro and cons depending on each use case ? in which use cases should i combine swr and getstaticprops ? what are the pro and cons depending on each use case ? a synoptic matrix would be a great thing , but maybe i am asking too much ! : ) thanks ! < code >
i have a use case that i need to be able to run the application without using a server , cdn or npm , it needs to simply be html files and a js file that can be imported into the index.html file so the app can be ran from a folder on an os . e.g clicking on index.html will load the site . is it possible to output a build with all of the js in one file and import it into the index.html page ? i 've been looking at the custom webpack config but ca n't work out what would need to be changed to make this work . is it even possible ? < code >
i use ssg ( nextjs v9.5 ) on firebase hosting , and configuring fallback : true with revalidate:1. but ca n't revalidate files , so that these errors happend . ssg is nice solution , so i want to use revalidate on firebase . i would like to know how to get around these . thanks . < code >
in my project i have some amp pages with some functionality after using `` export const config = { amp : true } '' , no functionality is working . can anyone help me with this ? < code >
now i have my pages under /pages with the two methods getstaticpaths and getstaticprops . all is ok. due to business model i need to have the pages under a npm package . something like this : pages/home.tsx mypackage how can i replicate this behaviour ? < code > import { inithome } from `` mypackage '' export default inithome ( someparamshere ) ; // here the home component + getstaticprops + getstaticpaths export inithome = ( ) = > { return < home > < /home > }
i 'm using isr to create a site let users post contents . the following is my code . when the user visits pages not exist , my site responds with 404 not found as i expected . however when the user visits deleted pages , my site returns their cache . so i want to delete them . is there any way ? < code > export const getstaticprops : getstaticprops < props > = async ( { params } ) = > { const res = await invokequerywithapikey ( getproblem , { authorusername : params.username || `` , problemslug : params.problemslug || `` , } ) if ( res.user === null || res.user.problem === null ) { return { notfound : true , } } return { props : { user : res.user , } , revalidate : 1 , } } export const getstaticpaths : getstaticpaths = async ( ) = > ( { paths : [ ] , fallback : 'blocking ' , } )
the problem i 'm having is hydrating the user data from local storage on app reload/page refresh . in my project , i am using nextjs for frontend , and for support libraries , i am using redux-toolkit for redux management across the application . the user can log in , and in that case , i store the isloggedin boolean in local storage and in the redux state . depending on the isloggedin boolean value i change the navbar component styles ( the navbar is included directly in _app.tsx ) . when the user refreshes any page the isloggedin boolean is not loaded into the redux state but is present in local storage . how can i update my redux state too whenever a full page refresh is done ? ps : i feel that i might need to put a useeffect somewhere which updates my redux store , in a create react app project this could have been done in the app.js file but where can a similar thing be done in nextjs ? i am also aware of the app.getinitialprops in _app.tsx but i also do n't wan na loose the benefits of static page optimisation . < code >
describe the feature you 'd like to request hello , i 'm not sure if this is a bug or more a feature . i would like to pre-generate some pages from a cms system , including the index page . at the same time , for all not generated pages i would need dedicated page logic . describe the solution you 'd like i prepared a example repo : < url > my expectation is that i see following content : < url > - > [ static ] .js - > not working < url > - > [ static ] .js - > works < url > - > [ ... index ] .js - > not working < url > - > [ ... index ] .js - > works describe alternatives you 've considered currently i duplicate the logic ( via imports from [ static ] .js ) inside an index.js and [ static ] .js page , but this is not that nice . < code >
hi , i 'm a student at a university having previous experience with react , but not yet with nextjs ! for a current uni assignment , i 'm very interested in using nextjs because of the many benefits it has . however , i 'd like to have some input from someone with more experience , since i 'm not sure if nextjs in my current project is a good idea to use or not . so in short , i 'm making a react webapp with those features : authentication system users can create a project ( will have its own detail page ) users can comment on each others project users can like projects basically , the content of the website changes a lot , and i 'm not sure if nextjs would be ideal since i assume that content would have to be server-side rendered every time , which i 'm not sure is good in this case . it 's a lot of dynamic content from users across the platform , so the database would change a lot . in theory , the project pages could be ssr , but since people can like and comment , it 's not really a static webpage that i need . could someone share their experience or knowledge on this topic ? really curious to learn more ! < code >
just been doing some cleanup on a nextjs app with typescript . i 've been refactoring default exports from components and also applied the same treatment to /pages/ * . when i removed default exports from /pages/ * i started getting this error : < url > i was wondering why export default is a necessary in /pages/ * and not in components . why am i removing export default ? i 'm using typescript so i 'm trying to align with ts benefits . more info here < url > sample for the above error sample without the error < code > export const post : functioncomponent < tpostprops > = ( { post } ) = > ( < layout home= { false } > ... < /layout > ) ; export const getstaticpaths : getstaticpaths = async ( ) = > { ... } ; export const getstaticprops : getstaticprops = async ( { params } ) = > { ... } ; const post : functioncomponent < tpostprops > = ( { post } ) = > ( < layout home= { false } > ... < /layout > ) ; export default post ; export const getstaticpaths : getstaticpaths = async ( ) = > { ... } ; export const getstaticprops : getstaticprops = async ( { params } ) = > { ... } ;
how would i add a < script > tag in nextjs ? i am using a create react app theme that has this in the head of the index.html i tried adding this in a < head > element in my _document.js file but i got an error ; something about unexpected token regarding the semicolon after ( 'dark ' ) ; thank you , < code > < script > if ( localstorage.theme === 'dark ' || ! ( 'theme ' in localstorage ) ) { document.queryselector ( 'html ' ) .classlist.add ( 'dark ' ) ; } else { document.queryselector ( 'html ' ) .classlist.remove ( 'dark ' ) ; } < /script >
hello , i 've been working on a project with normal bootstrap then i wanted to add less support to my project so i can write some css with less , this step ended up breaking the built-in functionality of loading css without a loader . my next.config.js my _app.js anyone experienced this before ? < code > // next.config.js const withless = require ( ' @ zeit/next-less ' ) ; module.exports = withless ( { lessloaderoptions : { javascriptenabled : true , } } ) import react from 'react ' ; import app from 'next/app ' ; import 'bootstrap/dist/css/bootstrap.min.css ' import ' .. /public/styles/antd.less ' class myapp extends app { constructor ( props ) { super ( props ) ; } render ( ) { const { component , pageprops } = this.props ; return ( < component { ... pageprops } / > ) } } export default myapp
hello ! i am moving a project to next and following the guide for incremental adoption i am using the rewrites as suggested : for the blog section i have the /pages/blog/ [ slug ] .tsx and its getstaticpaths ( ) that fetches available posts from a cms . when i visit a post which is not found in the available paths , in local i get a 404 page while in preview branches deployed in vercel it resolves to the legacy domain as expected . even the built version in localhost gives 404. i am a bit worried for what is going to happen when i push to production . i guess it will work same as preview but i would like to understand why this happens locally . any ideas ? thanks in advance ! ! < code > async rewrites ( ) { return [ { source : '/ : path * ' , destination : '/ : path * ' , } , { source : '/ : path * ' , destination : ' < url > } , ] ; } ,
hello , i 'm using custom _app.js before returning the component , i 've put console.log ( pageprops ) on page /index it populates the props and works like a charm . on pages like / [ page ] the props are empty object and the router object included with the appprops says that current route is / [ page ] instead of having something like /actual-template-here and also isfallback=true , why is it like that ? is such behaviour by design ? < code >
hi , could somebody please advise why i 'm getting too many re-renders with the below ? i 'm not sure why a loop is occurring when trying to setstate . < code > const product = ( ) = > { const router = userouter ( ) console.log ( { router } ) if ( typeof window === 'undefined ' ) { return null ; } const [ item , setitem ] = usestate ( ) const { id , matrix } = router.query const { data , error } = useswr ( '/api/item ? itemid= < cur > { id } ' ) console.log ( { data } ) if ( data.item ) { setitem ( data.item ) } return ( < div > test < /div > ) }
is there a way to apply a blur effect when loading the images by combinign next/image and tailwind ? currently i 'm having following component to load my images . < code > export default function coverimage ( { title , src , slug } ) { const image = ( < image src= { src } alt= { 'cover image for < cur > { title } ' } layout= '' fill '' classname= '' object-cover object-center '' / > ) ; return ( < div classname= { cn ( `` relative shadow-small h-36 md : h-60 lg : h-72 '' , { `` hover : shadow-medium transition-shadow duration-200 '' : slug , } ) } > { slug ? ( < link href= { '/blog/ < cur > { slug } ' } > < a aria-label= { title } > { image } < /a > < /link > ) : ( image ) } < /div > ) ; }
hi all , here is my build output now i would expect that `` first load js '' column is sum of page size and `` js shared by all '' at least i got that impression from # 10014 i have also checked doc improvement in # 12034 but im not wiser im really wondering how next calculates that number and why its so high thx in advance fo any insight < code >
hi , i 've an issue with a route that the user is taken to with router.push ( ) and has two route parameters : i use that same code for other routes and it works fine . for this particular one though , the router not only interpolates the parameters in the route but also appends them . so instead of going to it 's going to this is only happening when i do npm run build & & npm run start . it works fine with npm run dev . found a similar issue that with no solution provided ( other than the same author 's workaround ) # 19704 < code > /12345/abcd-1234/ready /12345/abcd-1234/ready ? id=12345 & anotherid=abcd-1234 router.push ( { pathname : '/ [ id ] / [ anotherid ] /ready ' , query : { id : router.query.id , anotherid : router.query.anotherid } } )
hello , i imagine my use case is a bit strange but i would really like to be able to do this with next.js as i really like it . i would like to serve some dynamic files by adding a get route ( maybe to the webpack dev server ? ) in development . because of my usecase , these files can not be in the public directory at this point . when deploying to production , i will manually copy the files that i need to public before building , so the handler is not needed anymore . is there a simple way to achieve this ? it would be ok to use a custom server but in that case i would like to avoid losing any of the features i get with the default one . also , in production the handler would not really be needed , so i am unsure what to do . i would be grateful for any tip ! thanks , alberto < code >
hello i 'm trying to use the : export tool from sass to reuse a variable declared from scss side to js side here an example < url > but i did not succeed could someone help me about it ? ( i posted same request on an issue ticket which should have apparently fixed that ... # 11629 ) thanks for help < code >
when using next js 's webpack splitchunks configuration , as per < url > vendor chunks which would otherwise be split into separate chunks are being included inside the next.js chunk . as a result , any change in the application code will result in the vendor scripts being re-downloaded . according to the document `` any sufficiently large third-party module ( greater than 160 kb ) is split into its own individual chunk '' . i have two questions ? why 160kb ? is n't that huge ? as an example , react-slick is less than 120 kb ( stat size ) . inside the webpack configuration , the condition is on module.size ( ) . this means that it would check the size of each module within a library/plugin . for example , the below is the output taken for all modules in react-slick ( the largest being 33 kb ) : < code > // console.log ( ' < cur > { module.identifier ( ) } : ' < cur > { module.size ( ) } ' ) ; `` /node_modules/react-slick/lib/index.js '' : 334 `` /node_modules/react-slick/lib/slider.js '' : 12852 `` /node_modules/react-slick/lib/inner-slider.js '' : 34135 `` /node_modules/react-slick/lib/initial-state.js '' : 764 `` /node_modules/react-slick/lib/utils/innersliderutils.js '' : 29325 `` /node_modules/react-slick/lib/track.js '' : 12173 `` /node_modules/react-slick/lib/dots.js '' : 7382 `` /node_modules/react-slick/lib/arrows.js '' : 8286 `` /node_modules/react-slick/lib/default-props.js '' : 1598
what version of next.js are you using ? 10.0.1 what version of node.js are you using ? 10.0.0 what browser are you using ? chrome what operating system are you using ? macox how are you deploying your application ? next start describe the bug i am facing one issue .i am creating a css file in getstaticprops ( context ) { but that css is not apply to element.i have created a build when i run the application .my css is not applied in element . here is my code < url > created a css file like this i imported this text.css in _app.js but when i run my build my css is not applied . _app.js expected behavior css will apply to reproduce < url > < code > // import app from 'next/app ' import `` .. /styles/text.css '' ; function myapp ( { component , pageprops } ) { return < component { ... pageprops } / > ; } const fs = require ( `` fs '' ) ; export default async function handler ( ) { await fs.promises.writefile ( `` ./styles/text.css '' , '.red { color : red } .b { color : blue } ' , `` utf8 '' ) ; return true ; } export async function getstaticprops ( context ) { const f = await handler ( ) ; console.log ( f ) ; return { props : { } // will be passed to the page component as props } ; }
i have two pages /posts/ [ id ] and /posts/form latter is a page that renders form to create post or modify post ( to distinguish creating and modifying , i use query ? id=postid ) . both pages use getserversideprops when latter page returns notfound props from getserversideprops which happens when post does n't exist then nextjs runs /posts/ [ id ] 's getserversideprops function with `` form '' as id params is it intended behavior ? < code >
hey next.js community ! here 's the gist : frontend ( next ) talks to api via endpoint defined in kubernetes ingress when a user authenticates , the cookie is set on this ingress endpoint my hoc to check if a user is authenticated runs in getserversideprops getserversideprops has no knowledge of this ingress ( because it 's run on the server i.e . in the cluster ) , and uses kube dns to talk to the backend service the cookie is obviously not set on the kube dns backend service domain , so the hoc ca n't tell if the user is logged in my ideal solution would be for getserversideprops and client-side api calls to both talk to the same endpoint , so that cookies are automatically sent back and forth . the catch 22 is basically that getserversideprops does n't know this endpoint exists , because it executes in the kubernetes cluster and thus does n't have awareness of the ingress that the client is using . i hope the above rambling made sense , i 'm pretty new with next and kubernetes , so if anyone 's run into this before hit me up ! thanks : ) < code >
what version of next.js are you using ? 10.0.1 what version of node.js are you using ? 10.0.0 what browser are you using ? chrome what operating system are you using ? macox how are you deploying your application ? next start describe the bug i am trying to removed unused css .i make a two example in first example it is successfully removed .but in second example it will not removed not sure where i doing wrong .here is my code < url > reference api link : < url > expected behavior it will remove unused css to reproduce < url > < code > export const getstaticprops = async ( ) = > { // example 1 is working fine see console let xx = await postcss ( [ await purgecss ( { content : [ { raw : `` < div class='blue ' > jjj < /div > '' } ] } ) ] ) .process ( `` .red { color : red } .blue { color : red } '' ) ; console.log ( `` xx '' , xx.css ) ; // example 2 is not working fine why ? ? let xx2 = await postcss ( [ await purgecss ( { content : [ `` ./pages/ * * / * . { js , jsx , ts , tsx } '' , `` ./components/ * * / * . { js , jsx , ts , tsx } '' ] } ) ] ) .process ( `` .red { color : red } .blue { color : red } '' ) ; console.log ( `` xx2 '' , xx2.css ) ; return { props : { } } ; } ;
hello , everybody . i 'm finishing a new version of my website ( < url > - nodejs/ejs to next js ) . the thing is , all my articles has only json information when i check the source code . when i inspect an element i can see all the meta tags that i need though . what i understand is that everything is rendered at client side . my problem is that social media services , like facebook , can not read the meta tags of my articles header . websites like < url > also fail reading any information . a link where the problem can be seen it : < url > i 'm using getstaticprops and getstaticpaths to render every article . i would appreciate any help . thanks . build result : < code > page size first load js / 2.57 kb 86.8 kb / [ ... url ] 47.5 kb 128 kb /energia/jejum-intermitente-guia-completo-como-porque /fundamentos/mudar-habitos-exige-mudar-forma-pensar /fundamentos/como-ter-bons-habitos-sem-saber-quem-e [ +86 more paths ] /404 553 b 81.4 kb /artigos 2.42 kb 99.1 kb /blog 2.61 kb 99.3 kb /busca 1.2 kb 85.5 kb /contato 3.88 kb 84.7 kb /termodeuso 2.5 kb 83.3 kb /vertudo 3.53 kb 84.3 kb + first load js shared by all 62.7 kb ( server ) server-side renders at runtime ( uses getinitialprops or getserversideprops ) ( static ) automatically rendered as static html ( uses no initial props ) ( ssg ) automatically generated as static html + json ( uses getstaticprops ) ( isr ) incremental static regeneration ( uses revalidate in getstaticprops )
i 'm looking to implement a redirect in getserversideprops on specific paths , but in doing so would like to first fetch some data that changes often enough it ca n't be `` static '' , as the redirect path itself ( potentially ) lives inside the fetched data . if the data/boolean from the fetch includes a redirect , would like to go to it . otherwise on error , or in the case of no redirect json value , go somewhere else . this seems to work well so far with the caveat being that i do n't want any jsx to render , and it should n't ever based on the javascript in getserversideprops . my question is : is there anything wrong with simply returning null as the default export function ? it feels hacky but seemingly checks all the boxes and works as expected . for example : if a user hits /fakepage , it would look something like : < code > const fakepage = ( ) = > null ; export async function getserversideprops ( { params , res , req } ) { let redirectlocation ; try { const mydata = await fetch ( `` phofurl if ( mydata.redirecturl ) { redirectlocation = mydata.redirecturl ; } else { redirectlocation = `` /somegenericredirectpage '' ; } } catch ( err ) { redirectlocation = `` /somegenericredirectpage '' ; } res.writehead ( 303 , { location : redirectlocation } ) ; res.end ( ) ; return { props : { } } ; } export default fakepage ;
i read the document and find out the _document.js was designed to set in the pages folder . but in my opinion the pages folder is used to set react component level pages . does it more reasonable to set it under the root folder ? < code >
i am using locales and custom headers . in my next.config.js file i have the following code snippet : above config does not return the custom header . according to < url > i should use with-locale . changing to source : 'with-locale/ ( . * ) ' , or source : 'with-locale ' , does however not help . only explicitly specifying each locale ( using locale : false does work , e.g : am i missing something or is this a bug ? < code > { source : '/en ' , locale : false , headers : [ { key : 'referrer-policy ' , value : 'no-referrer-when-downgrade ' , } ] } , { source : '/nl ' , locale : false , headers : [ { key : 'referrer-policy ' , value : 'no-referrer-when-downgrade ' , } ] } module.exports = { ... i18n : { locales : [ 'en ' , 'nl ' ] , defaultlocale : 'en ' , } , target : 'serverless ' , async headers ( ) { return [ { source : ' ( . * ) ' , headers : [ { key : 'referrer-policy ' , value : 'no-referrer-when-downgrade ' , } ] } ] ; } , }
i have a form with some data , and i want to submit this data to server with axios , but when i make the submit request , i got the error : the same when i use fetch function : how can i do this ? code file < code >
hi , not familiar with next.js , willing to use it professionally in the short future , i wanted to have an example using antd with less and jest for testing . looking at the way examples are named , a lot of them is prefixed by the world `` with '' so it reminds me of traits that can be combiened . knowing that to use the example with less and antd the command npm init next-app -- example with-ant-design-less with-ant-design-app will do the trick , and to use the example with jest the command npx create-next-app -- example with-jest does the job . will the command npm init next-app -- example with-ant-design-less with-ant-design-app with-jest provide me an example of well reconfigured project that uses antd , less and jest ? thank you < code >
let 's say i have the following getstaticprops function : then nextjs will create the static page . will a malicious user be able to get the value of pagedata.itemtwo even if the page does n't use that variable ? in other words , pagedata.itemtwo is never used on the actual page , but will it be available in rehydration ? then someone could theoretically get the value of pagedata.itemtwo . if so , the easy solution would be to just not include it in the output of getstaticprops , but just want to know if that 's necessary . < code > export const getstaticprops : getstaticprops = ( ) = > { // pretend like this is coming from a database const pagedata = { itemone : 'this can be public ' , itemtwo : 'this should be kept secret ' } // getstaticprops expects a promise return promise.resolve ( { props : { pagedata } } ) }
next.js @ 10.0.5 node-sass @ ^5.0.0 sass-loader @ ^10.1.0 after upgrading to v10 , all local file imports are throwing `` file not found '' errors . i 'm putting all static assets in public/assets/ * , and here 's what my next.config.js looks like : has anyone run into this , and do you have a solve ? thx . < code > webpack : config = > { config.resolve.alias [ '~ ' ] = path.resolve ( __dirname ) ; config.plugins = config.plugins || [ ] ; config.module.rules.push ( { test : /\.scss < cur > / , loaders : [ require.resolve ( 'style-loader ' ) , require.resolve ( 'css-loader ' ) , require.resolve ( 'sass-loader ' ) ] } ) return config ; } , i18n : { locales : [ 'en ' , 'fr ' , 'es ' ] , defaultlocale : 'en ' , } ,
i am having trouble find information or figuring out how to set client side env variables that are different per build environment . how i am handling on server side : ( may not be the best solution but it works ) vercel env variables are : dev_baseurl , tst_baseurl .... ect and on our front end we are reading via a switch statement . what i do here is use the commit ref to determine what env i am building too . this process fails with public env variables . anyone got any ideas to get dev , test , uat , prd public env variables to be used client side ? < code > switch ( process.env.vercel_github_commit_ref ) { case 'dev ' : return process.env [ ' < cur > { process.env.vercel_github_commit_ref.touppercase ( ) } _ < cur > { envvariable } ' ] ; }
what version of next.js are you using ? 10.0.3 what version of node.js are you using ? 10.16.3 what browser are you using ? chrome what operating system are you using ? ubuntu how are you deploying your application ? aws cloudfront describe the bug query object from userouter ( ) ; have old values when page is served from cache , both before and after hydration . expected behavior userouter ( ) ; should returns correct query object after hydration process , to reproduce this problem start appearing when we changed query string forwarding and caching rules in cloudfront from forward all , cache based on all to forward all , cache based on whitelist i have a simple page , just to print query object . first time url visit < url > output is straightforward since this is first time we visited this page , so it came from source not from the cache . second time url visit now we have different values in query < url > now since page was cached , it should give the same response but after next.js hydration process it should print the correct values . but even though after hydration process page given the old values . query string whitelist does n't contains tech and year as we do n't want to cache pages on these query params , but on client side we should to have its correct values , regardless with what values page was opened first time . < code > // pages/test-page.js function testpage ( ) { const router = userouter ( ) ; return ( < div > < h3 > query < /h3 > < h5 > { json.stringify ( router.query ) } < /h5 > < /div > ) ; }
hi , i 've got something like in my _app.js : < header / > < layoutwrapper classname= '' simple-header '' > < component { ... pageprops } / > < /layoutwrapper > i have set up basepath in next.options.js when i 'm using < link > ( next/link ) inside < component > ( that is in pages/ * .js ) , the urls are fine , but when i use < link > outside the < component > , for example in < header > , the < link > is without basepath . is there any solution to make link working properly ? < code >
in our application we have a few different users ( ~20 according to plumbr ) per day who get the following exception error : loading initial props cancelled we have determined that the error comes from the _getdata < t > method in router.ts but have n't been able to figure out the cause nor reproduce it . we have tried adding throttling using chrome dev tools and doing multiple actions that call router in quick succession but no dice . what causes the error ? < code >
hi all , hope someone can help me i 'm awaiting an api call to the next.js backend and then calling router.push to a new route . if the api call is commented out then the page changes correctly , however if it is there , it seems the route-loader.js which injects the script for the next page hangs forever . if i refresh the page , the router.push promise resolves and do land on the new page . it seems to specifically be an api call ( we 're usnig axios ) to causes this effect , awating an empty promise before router.push did n't seem to have this effect . we have no idea what is causing this and thought it could be related to vercel/next-plugins # 282 some how , however this issue is closed ( and we 're using styled components ) . does anyone have any idea what might be causing this and what else we might look at ? also -- this seems to only be in dev mode , so perhaps related to compilation of the pages at run time ? < code >
i 'm using next.js and locally i dont have any issues . but when i deploy to either my preview or my prod builds i cant seem to call any of my api routes . or rather , i can call them , but i always get 405 errors . i cant seem to figure out what the issue is . i 've read the documentation but cant seem to see anything relating to this problem . can someone help me try and debug this situation , or if they 've seen the problem and fixed it can you let me know what it is please . this is my super simple api endpoint . this is how i 'm calling it const res = await fetch ( url , options ) ; where options is : as i 've said locally i dont have any issues at all . < code > { method : `` post '' , body : { `` email '' : '' < email > '' , '' name '' : '' '' , '' rss '' : '' '' , '' csrftoken '' : '' '' } } import { nextapiresponse } from 'next ' ; / * * * get the user details * / export default async function handler ( res : nextapiresponse , ) : promise < any > { res.statuscode = 200 ; res.setheader ( 'content-type ' , 'application/json ' ) ; res.end ( json.stringify ( { name : 'john doe ' } ) ) ; } ;
i 've looked in to api-routes-apollo-server-and-client-auth example and not sure how can i mutate context both on ssr and client request . i want for every graphql resolver ( using api ) have access to ctx.user object with preparsed jwt token . but where should i parse it ? if i parse it here : then ctx.user will be undefined on ssr request , working only on client request . < code > const apolloserver = new apolloserver ( { schema , context ( ctx ) { ctx.user = '123 ' return ctx } } ) export default apolloserver.createhandler ( { path : '/api/graphql ' } )
could you please tell me why red1 classname is showing while it is not used ? i am using this plugin < url > to remove unused css . i am following this documentation < url > here is my code < url > in my code i did n't used red1 class in my project directory.but still in console is showing why ? < code > const xx = await new purgecss ( ) .purge ( { content : [ `` * * / * `` , `` pages/ * * / * . { js , jsx , ts , tsx } '' ] , css : [ { raw : `` .red1 { color : red } '' } ] } ) ; console.log ( `` xx '' , xx ) ;
hello all , in my next.config.js file , i 'm splitting main js file and extracting react and reactdom file as a separate file with this block . now , this works and it create a vendor.js file , now , i want to move only vendor.js file to cdn and access it with cdn path provided with asset prefix . next js changes all paths to cdn url but i want to only change one ( or a few ) , not all files which starts with .next/static/ . is this doable somehow ? < code > config.optimization = { runtimechunk : `` single '' , splitchunks : { cachegroups : { vendor : { test : / \/ ] node_modules [ \/ phofhyperlink [ \/ ] / , name : 'vendor ' , chunks : 'all ' , } } } }
today i realised one of my deploys failed because of an error on a storybook file . basically , i ran next build and got the following error : type error : 'box ' is declared but its value is never read . on my file named accordion.stories.tsx what 's the recommended way to tell next build to ignore story files ? shall i simply add * * / * .stories.tsx to my tsconfig.json under the exclude property ? or ... is there a way to tell next build to do n't be so strict when building , for instance , only give warnings for minor issues such as a variable not being used but still build the project ? < code >
i am wondering if there is anything that i can use in place of getinitialprops in a next app which has custom _app . i saw in this documentation that getinitialprops is not recommended . there is a suggestion to use either getstaticprops or getserversideprops . but there is a problem with getserversideprops . in this documentation , it says that getserversideprops can only be exported from pages . i believe a custom _app is n't counted as a page ( ? ) . indeed , i tried exporting a getserversideprops function from the app module , it does n't work . the function is not even executed . but , getinitialprops gets executed , if there is any . even in the code example here , getinitialprops is shown that it is meant to be used . so , getinitialprops is deprecated , but i can not use getserversideprops , but i really need one of these functions to work because my app component logic depends on these . what else can i use in place of these two ? < code >
hello , i wanted to know if this is possible with the help of webpack and nextjs . instead of bundling react ( and other libs like reactdom ) via webpack , i would like to use external/cdn version . i tried webpack plugins like htmlwebpackplugin and dynamiccdnwebpackplugin , but they did not work . i wanted to know if anyone has tried this ? < code >
describe the feature you 'd like to request vercel has support for wildcard domains . i think that it would be awesome if similar to the setup with [ slug ] .js we could get [ wildcard ] .yourdomain.com . describe the solution you 'd like i believe that a good solution would be something like this : obviously you could n't do this with getstaticprops ( ) , that would be a separate feature and more complex . describe alternatives you 've considered i have considered making a custom function for this in my project , and likely will be doing this . but , i think for the future this would be great . i 'm not sure what to write here . thanks for considering my idea and apologies if i made a typo or an inaccuracy : ) < code > import getwildcard from `` next/wildcard '' ; // access it in your default function export default function home ( props ) { return < div > the wildcard is : { getwildcard ( ) } < /div > ; } // if you went to sampoder.yourdomain.com , this code sample would output a page saying `` the wildcard is : sampoder '' // or when using getserversideprops ( ) export async function getserversideprops ( ) { let wildcard = getwildcard ( ) return { props : { wildcard } } ; } // if you went to sampoder.yourdomain.com , props.wildcard would equal sampoder
i mostly use tag directly for linking but this time i thought of giving the link component a try and what i am seeing is that it is slow , very slow . now i am not sure why it is that way but i have checked with prefetch true and false and so far it is not the most convenient/good experience at the user end . you click a link and it waits 1 or 2 sec before it transitions . now it serves excellent for a developer but the wait between pages is just not worth it when you are a visitor of website . a person would rather see a while blank loading page ( the normal way ) instead of clicking a link and waiting for it to wakeup and open the new page . can anyone elaborate on this ? and how i can make the transition between pages smoother/ friendly ? < code >
in vercel production , i am getting an error when trying to connect to google cloud platform . from some googling , it seemed most likely that my private key is being rejected , which i have stored as a secret key in a vercel environmental variable . i hardcoded my secret key to bypass the environmental variable ( just temporarily ) and then the connection started working . the google key is formatted like so : `` -- -- -begin private key -- -- - your-key-here-keep-the-quotes -- -- -end private key -- -- - `` does vercel modify environmental keys in any way ? i read that users of some hosting platforms needed to do a regex in their code to correct formatting issues with environmental variables because the `` `` was mishandled by the hosting platform . is vercel somehow modifying the key in my case causing it to be incorrect ? < code >
the example < url > looks awesome for integrating graphql with next but i 'm struggling with a best practices way of incorporating jwttokens into that . years ago , there was a lot of discussion around login support but that seems to have been de-prioritized as examples . any url 's that have a good clean solution would be appreciated . i like the apollo solutions since there is a lot of following behind them . < code >
i suppose everyone knows this but me , but if you turn your javascript off in the browser , both reactstrap and react-bootstrap render without css which is basically useless with most sites . previously , i 'd just included bootstrap classes directly and my ssr pages looked good . is this a good reason to not use either of these two packages and stick to just bootstrap in classes ? not sure what i think of this as i 've just discovered it . < code >
hi , i have a url such as : `` /products/42 ? matrix=true & item=my-shiny-item '' i have the id ( the `` 42 '' in the url ) available in params but also need access to the matrix=true in getstaticprops . is this possible ? < code >
lets say i have blog post page component like this one which is dynamic , and i have to fill post in server-side in getserversideprops function . is there any way i can access to seooptions in post component and update it before page loaded . sorry for my bad english pages/ [ ... postid ] .js < code > import { pagelayout } from ' .. /components/layouts ' const blogpost = ( ) = > ( < div classname= '' mt-8 max-w-xl mx-auto px-8 '' > < h1 classname= '' text-center '' > blog post with id : 1345 < /h1 > < /div > ) blogpost.pageconfig = { layout : pagelayout seooptions : { title : 'my blog | < cur > { posttitle } ' , desc : 'my blog | < cur > { postdesc } ' , } } export async function getserversideprops ( { params } ) { const { slugs } = params ; const post = await postservice.query ( slugs [ 0 ] ) ; return { props : { post } } } export default blogpost
i 'm using ssg with i18n routing , and it works fine . but a console error annoying me . i visited the source/output page , and it seems like there is no ja/index.json file but ja.json file . i think this is a bug , but if someone knows how to fix this , please let me know . < code >
i seem to have noticed that if i have a bunch of links on a page , that as soon as the browser visits that page , all those pages are regenerated . i do n't see an option to disable that ( or any discussion of that happening ) . i noticed it because my server got really busy doing regenerations when only one page had been requested . please clarify behavior on links and isr . this is the code that caused the regens i believe . < code > < div key= { speakerrec.id } > < link href= { { pathname : '/presenter/ [ year ] / [ nameslug ] ' , query : { nameslug : speakerrec.nameslug , year : year } , } } > < a > { speakerrec.nameslug } < /a > < /link > < /div >
i just implemented the experimental script loader into my codebase at work . i first noticed that the next/experimental-script import had no typings available . i dropped a @ ts-ignore to skip that but then the build failed because it could n't find the import . i was forced to use the direct path . while implementing the script tag , the options seemed confusing when coming from knowledge of script tag 's attributes defer and async . i think it would be much better to more closely match the script tag 's attributes and then add any additional logic . lastly , it appears this only appends it on the client-side . it would be cool if the ssr/ssg would swap the script tag out for a base script tag in the document . tagging the people involved in the original pr ( # 18281 ) @ janicklas-ralph @ janpot @ timer @ timneutkens < code > // import script from 'next/experimental-script ' // typescript fails to compile this and has no typings available import script from 'next/dist/client/experimental-script.js ' // next.config.js module.exports = { experimental : { scriptloader : true } }
hey ! i was wondering what the recommended method of hitting /api is from getserversideprops . of course , just fetching it is an option but it 's definitely better to avoid a round trip . can i import the function from /api and call it by passing in ctx.req and ctx.res ? is it safe to cast them considering req is of type incomingmessage and the /api accepts nextapirequest ? < code >
nowadays , we have lots of documents and article , but i do n't sure which one is exact one to use . because of , the frameworks for javascript/typescript are changing really fast so i wan na know currently great example . what is your idea ? < code >
hello , i 'm working on a project that requires my next app to have a custom express server . we are wanting to share some services between server and client , which we were hoping to achieve by using es6 modules on the custom server . we 've tried using `` type '' : `` module '' in package.json , which broke next build and looks as though this is a known issue . we 've also tried using .mjs files , however have found they break node debugger and organisation could get a bit messy . i was wondering whether anyone had achieved anything similar , where they have shared app services between a custom express server and their client side app ? if so what did you do ? < code >
is it ok to have a loading state in _app.js ? because i need to load user from localstorage if it exists . will this piece of code in is going to render correctly in the server ? < code > useeffect ( ( ) = > { if ( ! process.browser ) { setloading ( false ) ; } const userinstorage = localstorage.getitem ( `` user '' ) ; if ( userinstorage ) { setuser ( json.parse ( userinstorage ) ) ; } setloading ( false ) ; } , [ ] ) ; if ( loading ) { return < > < / > ; } return ( < usercontext.provider value= { state } > < component { ... pageprops } / > < /usercontext.provider > ) ;
hi , so what do you think is the best way to make a site 's mobile version knowing that the mobile version and the desktop version have little in common . i can think of two ways : use media queries , but the bundle size would be bigger which could degrade performance ? have the mobile version in a subfolder ( /mobile for example ) and redirect each request accordingly . this seems the better way in my opinion , but the new getserversideprops does not handle conditional redirect natively yet i think ( would have to implement my own then ) . what do you think ? do you know a better way to handle this ? thanks . < code >
currently , create a user profile through the layout as in the photo above . when fetching user information here , it is fetched through getseversideprops for each page . i 'm curious about the other way , not how to get it on request for each page . how do you get it ? another thing i tried was to create a user component and import it through useswr . but i did n't use it because it flickers before the data is imported . < code >
can you make an algorithm that detects all domains specified on image component so we do n't have to config on next.config.js file . an algorithm that detects domains and pass it on webpack if the feature is possible for zero config i 've been doing projects but that next.config.js for image component . it would be great if the team would solved it . < code >
i was hosting my app on vercel but have decided to find another solution . i have yet to find a proper solution to deploy to any aws service if you are using api routes . i 've been searching for a while . i 've attempting to deploy my app to aws using serverless . however , there is currently some issues with serverless-nextjs and getinitialprops or getserversideprops that does not allow for me to deploy properly . i 've attempt amplify and have not been successful . i know that it could be due to my lack of knowledge . is lightsail hosting on vercel the only solution we have when using api routes ? has anyone found any success anywhere else ? if so , mind sharing details ? < code >
hello , i am using next/image component for some svg images and lighthouse shows the `` image elements do not have explicit width and height '' flag in the performance category . has anyone else had this issue ? and know a potential fix ? < code >
i 've a component that uses react-data-grid which uses window . initially i got the same error in dev mode . but i solved that error using dynamic import . it 's working fine in dev mode . however , i 'm getting the same error during build next build this is how i 'm importing it in my component : ./components/data-grid.tsx imports react-data-grid ; the error i 'm getting in build time is : any idea how can i solve this ? tia ! < code > > build error occurred referenceerror : window is not defined at object. < anonymous > ( / < project_path > /node_modules/react-data-grid/dist/react-data-grid.js:1:325 ) at module._compile ( internal/modules/cjs/loader.js:1138:30 ) at object.module._extensions .. js ( internal/modules/cjs/loader.js:1158:10 ) at module.load ( internal/modules/cjs/loader.js:986:32 ) at function.module._load ( internal/modules/cjs/loader.js:879:14 ) at module.require ( internal/modules/cjs/loader.js:1026:19 ) at require ( internal/modules/cjs/helpers.js:72:18 ) at object. < anonymous > ( / < project_path > /node_modules/react-data-grid/index.js:1:18 ) at module._compile ( internal/modules/cjs/loader.js:1138:30 ) at object.module._extensions .. js ( internal/modules/cjs/loader.js:1158:10 ) { type : 'referenceerror ' } const datagrid = dynamic ( ( ) = > import ( './components/data-grid ' ) , { ssr : false } ) ;
hi , i 've an app where my users land on a page that starts a flow . the url that brings them to this start page has an id and a redirect query parameters . once in the page , users can click something and move to the next step and so on . i 'd like to keep the url query parameters in the url at all times while the user advances through the pages , without having to add these to each url in each instance . i could use local or session storage , and once users arrive to the page , strip the query params from the url and save them to local storage and use them from there in the next pages . however , it would be nice if this could be kept within next.js . i tried looking into the router events but they 're not useful for this case . it would be nice if there was a way to `` filter '' the url before the route changes , to append the query params at that moment before proceeding to the next page . < code >
i 'm running next.js 9.5.2 with typescript . i 'm importing and implementing a component via : however , this wo n't build and i receive the error : type ' { name : string ; age : number ; } ' is not assignable to type 'intrinsicattributes & { children ? : reactnode ; } ' . i 've also tried writing the import like this : as per another users suggestion with no luck . so from what i can tell it has n't imported my component properly as i do n't seem to have access to the properties that exist on that component . this component exists as part of a npm package that i maintain . i 've imported it via a dynamic import as it contains references to window and these would throw separate errors if i were to import the component normally . my page contains other components that i 've imported from the npm package via a normal : import { contentholder , body } from ' .. /components/containers ' ; these work with no issues . < code > const mycomponent = dynamic ( ( ) = > import ( ' .. /components/mycomponent ' ) .then ( mod = > mod.mycomponent ) , { ssr : false , } ) export default function home ( ) { return ( < div > < head > < title > my site < /title > < /head > < main > < mycomponent name= '' damian '' age= { 27 } / > < /main > < /div > ) } const mycomponent = dynamic ( async ( ) = > { const module = await import ( 'components/mycomponent ' ) return module.mycomponent } , { ssr : false } )
when a server error occurs on nextjs , the call stack gives me the component where the error occurred but it does not give anything helpful beyond that . for example , in pages/index.js i include a component called test . this component includes another component called test2 , where the error occurs . nextjs will tell me an error occurred in test2 , but does not mention test or pages/index.js . so it 's up to me to guess where test2 was included . see here : < url > all the /node_modules/react-dom/cjs/ calls are not helpful . so how can i get a more helpful call stack when an error occurs in nextjs ? < code >
i want to have a dynamic route having the pattern / : sourcename-to- : destinationname eg . route : < url > so i tried creating a file with name [ sourcename ] -to- [ destinationname ] .js under pages directory . but the router.query is storing values as { `` sourcename ] -to- [ destinationname '' : `` canada-to-india '' } . i want canada to be stored in router.query.source and india to be stored in router.query.destination i.e , the req.query should contain { sourcename : `` canada '' , destinationname : `` india '' } i might also have a route like < url > so the separator ( to / ke ) is needed in the placeholder please help me solve this problem . < code >
hi , so i 'm slowly getting my head around sessions and auth with next.js ( deployed on now ) . what i 'm running into now is that i have a hoc ensureadmin that i can wrap a page with to check that a user is authenticated and actually an admin . ( the api routes are secured ofc so it 's mostly a ux/visibility thing ) . the downside is that you need to repeat this for every page . is there a way to do this globally for everything under this path /admin ? it would be nice to for instance have a custom _app.js that applies to this folder+children or something . how do you solve this ? should i just not try to limit access to the page and use a fetch hook to check client side after rendering the skeleton ? < code >
hi , there . i use image import image from 'next/image ' component as a background like in this example < url > and i ca n't find any information about how i can change background position of my image . how i can put it up or down ( background image ) . my example . < imagebg src= { breakpoint.mobile ? '/hero/bg -- mobile.jpg ' : '/hero/bg -- desktop.jpg ' } alt= '' background image '' layout= '' fill '' objectfit= '' cover '' quality= { 100 } priority= { true } / > < code >
tutorial in dps section of deploying your next.js app page says : ... ship : we 've merged the pull request to main to ship to production . we strongly recommend using this workflow when developing next.js apps it will help you iterate on your app faster . is there a reason to use main branch for production instead of master ? i 've tried deploying to vercel with master branch and it seems a correct way - judging on vercel dashboard . < code >
implementing integration tests for next.js apps currently involves relying on browser e2e tests . that makes sense since we want to simultaneously test routes , ssr server and page component all together . i recently made an attempt to carry out next.js integration tests using only dom tests with quite a promising outcome . the testing scope is of course more limited then browser tests and supports dom testing page components along with file-system routing , fetching methods and custom app component . in order to do so i simplistically re-implement a few next.js internal behaviour to be able to get the react element matching a specific route/page and test it with react testing library like : the utility takes care of : resolving provided routes into the matching page component calling next.js data fetching methods ( getserversideprops , getinitialprops or getstaticprops ) set up the expected mocked next/router provider wrapping page with custom _app component instantiating page component with the expected props emulate client side navigation via link , router.push , router.replace i published this proof of concept here , and i 'm wondering whether a similar utility could be in future considered to be shipped as an `` official '' next.js dom testing tool . thanks for the great job you 're all doing here . < code > const { render } = await getpage ( { route : '/blog/1 ' , } ) ; render ( ) ; expect ( screen.getbytext ( 'blog ' ) ) .tobeinthedocument ( ) ; fireevent.click ( screen.getbytext ( 'link ' ) ) ; await screen.findbytext ( 'linked page ' ) ;
for supporting only modern javascript , which plugins should we add from < url > that are n't already a part of the webpack config that next.js ships ? also hoping to discontinue supporting ie11 and opera mini , so legacy code is n't required . < code >
after upgrading to nextjs 10.0.5 today i noticed that window is always scrolled to top when router.back ( ) is used . is this new behavior or some kind of bug ? i am showing post details in dialog abouve post list using router.push ( ) and closing using router.back ( ) . so every time user closes dialog he lost his scroll position in post list . it is very anoying . < code >
my redis provider has limitations on the number of concurrent connections that can be established at a given point . and they recommend using connection pool . how would this work with next.js / vercel ? my api file looks like this in this case a new redis client will be created for every request , and if i have a large number of requests the limit is reached very fast . any help with this would be very much appreciated ! < code > // src/api/foobar.ts import { nextapirequest , nextapiresponse } from `` next '' ; import redis from `` redis '' ; const redisclient = redis.createclient ( { port : number ( redis_port ) , host : redis_host , password : redis_password , } ) ; const handler = async ( req : nextapirequest , res : nextapiresponse ) = > { // do something with redisclient } ; export default handler ;
situation : before doing static server side rendering ( through getinitialprops etc ) i need to make several requests to an external api to fetch some data . i need to do these requests only once and share the results among several pages so they can use inside their getinitialprops and getinitialpaths . i tried to implement an intermediary cache store to control the requests , but i soon noticed that during the rendering stage ( npm run build ) calls to getinitialprops are run in different node contexts ( ? ) , the easiest way to verify this is by importing this code inside different page/ files and using it inside getinitialprops and seeing that the resulting globaldata will be different for each getinitialprops call . so i ca n't use any cacher . i tried different solutions found here but i didnt find any of them elegant enough : # 15373 the accepted answer seems like it would n't work very nicely . it suggests running a separate script before next build that fetches everything to a file . but that file would still be redundantly read into memory for every single getinitialprops call during rendering . so is it just impossible to achieve what i presented ? also should i have used that thread instead of opening a new discussion ? sorry if i opened this wrongly . < code > // request-cacher.js export const 'globaldata ' = math.random ( ) ; }
hi , when i try running my website through page speed insights , it shows remove duplicate javascript . i suppose this is due to the same script tag one in the head with rel=prelaod and one at the end of the body . is there any quick fix to this ? this is my website < url > lighthouse report link < url > any help will be great . sorry , i am a newbie developer , do n't know a lot about next.js < code >
i am making a blog like dev.to where most of the stuff is dynamic especially images . the wysiwyg editor uploads the images through `` /api/ '' based route to the `` public '' folder . now , in dev mode , when i upload the image , its fine , accessible but then when i run the app after building it using npm run build and then try to upload image using wysiwyg editor , the app shows 404 on accessing the newly uploaded image . what could be the reason ? i am doing ssr only . however , now after uploading the image , if i then rebuild my app , i can then access the image . is this normal ? < code >
i 'm trying to implement fcm ( firebase cloud messaging ) following with-firebase-cloud-messaging-app example . things work fine , but i wish to add env variables to service-worker.js static file as i do n't want to public my apikey to client . can i do that ? this is the service-worker.js file : < code > importscripts ( ' < url > ) importscripts ( ' < url > ) // trying : import from file in build importscripts ( './service-worker-env.js ' ) if ( ! firebase.apps.length ) { firebase.initializeapp ( { apikey : * * * * * * * * * * * * * * * * , projectid : * * * * * * * * * * * * * * * * , messagingsenderid : * * * * * * * * * * * * * * * * , appid : * * * * * * * * * * * * * * * * } ) } else { firebase.app ( ) } const messaging = firebase.messaging ( )
hey ! this is a new behavior that 's kicking in . whenever i hit commnad+s to save the file and see the changes , i get a bunch of next/cache/babel-loader files committed with changes and this makes the reload , even with minor ui changes take a while . does anyone have any clue what 's going on ? i have n't made anything differently ... < code >
for just setting environmental variables where no javascript processing code is needed , is it better to just use the new environment variable features and get rid of all of that in next.config.js ? seems like there is a bunch of overlap and the guidance is not clear to me . < url > < code >
hi , what do you consider best practice when using auth with nextjs ? i am currently using firebase auth but i am not that happy with it and think about changing to next-auth ? mainly because firebase is pretty slow ( i am base in europe ) and i think next-auth is easier to use with ssr . how do you handle auth and are you happy with your choice ? < code >
with the nextjs tutorial you have to create a component with a css module and then import that module . now my vscode does n't recognize this file type after i created both layout.js and layout.module.css . all works find in the browser so thats good .... i have n't editted anything in the config files . < code >
i have the following page hierarchy [ product ] ( folder ) [ slug ] .tsx index.tsx on the [ slug ] page , i have queries against graphql with product parameters ( that is , depending on what product it is , these slugs will be returned ) . the problem is that in the middle of the getstaticpath method , i can not ( or do n't know how to ) get the router object to determine the current [ product ] . code for better understanding < code > export const getstaticpaths : getstaticpaths = async ( ) = > { const apolloclient = initializeapollo ( ) const { data } = await apolloclient.query ( { query : productsbytypedocument , variables : { producttype : 'there should be the type of product , ( e.g . iphone , macbook ) that i want to get from the router object ' } , } ) const paths = data.products.map ( ( { slug } ) = > ( { params : { product : 'there should be the type of product , ( e.g . iphone , macbook ) that i want to get from the router object ' , slug } , } ) ) return { paths , fallback : false ,
i 'm developing a module which exports some react components and hooks . i 'd like to use yarn link and next.js to test out the module as i go . however , i 'm getting the error seen in this image , presumably because there are multiple instances of react ( the one in my yarn-link 'd module and the one in next ) . i saw that this could be solved using a webpack alias and that aliases could be created in next via tsconfig.json or jsconfig.json so i set up my jsconfig.json to look like : but i 'm still getting the error . does anyone know if i 'm going about this the right way , or how it could/should be setup ? < code > { `` compileroptions '' : { `` baseurl '' : `` . `` , `` paths '' : { `` react '' : [ `` node_modules/react '' ] } } }
i 'm using css.module for the components in my project ( < url > ) . i 'm having a problem adjusting css on the server-side . if i go to chrome developer tool - > network - > preview , my website shows unstyled html . google web cache also has unstyled html . however , if i block js , the page appears with styled html .. i 'm not sure whether serverside css applied or not . how can i adjust css on the server-side ? i found some documents for styled-components and material-ui ( mentioning serverstylesheet ) , but not for the css modules . in short , is there any additional setting i should apply for the server-side css ? < code >
currently our build generates 1855 static page . but it takes a while ( ~5 minutes here ) : it 's calling a free heroku dyno . upgrading would make this faster ? also , we 're planning on adding a large amount of data that will result in at least 55,000 static pages . should i drop static generation ? < code > 17:02:07.231 | info - generating static pages ( 0/1855 ) 17:04:12.332 | info - generating static pages ( 463/1855 ) 17:05:58.974 | info - generating static pages ( 927/1855 ) 17:07:39.023 | info - generating static pages ( 1391/1855 ) 17:09:14.341 | info - generating static pages ( 1855/1855 )
hi everyone , i have a hook calling an api route and i get the following error : the pages structure is like this : /pages /api /1stfolder/ [ id ] /2ndfolder [ id ] if i call the hook from components inside the 1st folder it works fine , but if it gets called from the second i get the error above . how is it possible to get this request url in one folder : and this from the other folder : i tried everything , i surrender 😣 < code >
hello there . i have an authentication page , which is an image and two tabs : for sign in and sign up respectively . i used to solve this by creating authlayout component , which holds the top image and two tabs . then i created auth folder which has sign-in.tsx and sign-up.tsx files . here is a relevant part of authlayout when i am switching between tabs , layout is re rendered , thus image component is re rendered too . thus , image is flickering . how would i go about this ? in simple react , i would create common component , and then would make my sign in and sign up tabs just a nested components . but here , i can not do it like this . any help is much appreciated . < code > return ( < box classname= { classes.wrapper } > < box classname= { classes.topbar } > < image src= '' /auth-page.png '' layout= '' fill '' objectfit= '' cover '' / > < /box > < box classname= { classes.authwrapper } > < navigation / > { children } / either sign in or sign up part < /box > < /box > ) ;
i only have a catch-all route [ [ slug ... ] ] .js with getstaticprops and getstaticpaths . i want to fetch /csr/page1 , but the browser should just display /page1 . so i try this : unfortunately , this is not working , i am still navigating to /page1 . can somebody explain why this is not working ? because the documentation says : href - the path or url to navigate to . this is the only required prop as - optional decorator for the path that will be shown in the browser url bar . before next.js 9.5.3 this was used for dynamic routes , check our previous docs to see how it worked < code > < link href= '' /csr/page1 '' as= '' /page1 '' > < a > page 1 < /a > < /link >
i want to change my url programmatically without losing my state . and by changing url , i mean go from /home to /about . i tried using shallow routing , but i do n't seem to know how to properly implement it . so how do i programmatically navigate to another url without refreshing my page ? < code >
hello community 🚀 i have a question regarding initial data fetching in a custom _app.js , where i 'd like to query for data , which should be available on all pages ( e.g . menu items ) and persisted in the store . the items are dependent on the current locale , but it seems that the current locale is not available in getinitialprops . does anyone know how to solve this or a better solution ? i 've found this answer but the solution looks a bit fragile to me . thanks a lot 🙏🏽 < code > import app from 'next/app ' import { storeprovider } from ' .. /lib/store ' import { usehydrate } from ' .. /lib/store/zustand ' import { query } from ' .. /lib/initial ' ; export default function sbapp ( { component , pageprops } ) { const store = usehydrate ( { ... pageprops.globalstate , ... pageprops.initialstate } ) ; return < storeprovider store= { store } > < component { ... pageprops } / > < /storeprovider > } ; sbapp.getinitialprops = async ( appcontext ) = > { const appprops = await app.getinitialprops ( appcontext ) ; const globalstate = await query ( / * need the current locale * / ) ; appprops.pageprops.globalstate = globalstate ; return { ... appprops } }
hello everyone ! i am trying to create a mini-application using typescript in nextjs since now typescript is supported in next.js out of the box . and i also want to incorporate these two newly added features : image component and image optimization ( next/image ) internationalized routing ( i18n ) take i18n for e.g . : unfortunately , i am having a really hard time using them in my next.config.js , as for the normal application ( javascript only ) , it is working as it should . but for the typescript version , i am getting this error : it will be really helpful if any of you can help me out or can give an example that how to properly use next.config.js and incorporate those new features in the typescript nextjs application . thanks in advance and cheers 💜 < code > // next.config.js module.exports = { i18n : { // these are all the locales you want to support in // your application // sub-path routing locales : [ 'en ' , 'cn ' ] , // this is the default locale you want to be used when visiting // a non-locale prefixed path e.g . '/hello ' defaultlocale : 'en ' , } , } ( node:15704 ) unhandledpromiserejectionwarning : typeerror : can not set property '__nextlocale ' of undefined
i am trying to be able to run our next.js app in two different modes . mode 1 ) i need to use a runtime configuration determined by the request url or an authorization header ( like login ) . getserversideprops works great . isr works great , no issues . mode 2 ) i need to , when environment variable are defined that specify which of the runtime configurations to use , do a full export of a static site . however , it seems i ca n't just implement getserversideprops and force next to just use that method in conjunction with my getstaticpaths implementation to then just go through and generate the entirety of the requested pages . it forces me to implement getstaticprops , but then i ca n't get the dynamic runtime configuration into that via the req object , because it does n't behave like getinitialprops . i 'm fine if i can just implement both methods and then specify at built-time which of the methods to use , but next.js forces me to implement explicitly only one or the other and it 's really frustrating my efforts here . if i implement a conditional componentdidmount to just fetch the information , i miss out on the ssr optimizations of isr and seo . am i just missing something in the docs ? is there something already coming ? i 'm kind of at a loss . thanks in advance . < code >
hello there , i am using nextjs and graphql to build a very complex blog with a lot of content types , and every content type has its own template ( the template is a component ) at first all the posts routing is on pages/posts/ [ id ] , i use getstaticpaths & getstaticprops to get the basics data that i need to decide what is the article template based on its content type , so after deciding the template , now i need to get more data that related to its content how can i make another async api call to modify the template ( component ) props ? < code >
i 'm trying to figure out how to get stylelint to play nicely with styled-jsx . i first tried out the postcss plugin , but could not figure out when it was supposed to run , it seems like it makes it a part of the build process ? but i did not see errors on build . also , we want to be able to run the linter outside of the build process at any time so i 'm not sure if the plugin approach allowed for that ? since i could n't get that to work i followed this guide instead , and that worked great ! but the problem was due to it requiring a processor , it broke support for stylelint -- fix as that does not seem to support processors . so it seems the two options i have are to either remove the need for a processor via the configuration solution i 'm using , or to get the plugin approach to work , but i 'm not actually sure if that approach supports -- fix and i 'm not sure if it 's possible to use that approach for linting outside of build time . has anyone gotten -- fix to work with styled-jsx ? thanks for any help ! < code >
as a precursor , the storybook example is pretty useless ( when/if i get time , i 'll send a pr to tidy it up , the next.js really is n't next-ish and it does n't answer any basic questions - like this ) . i 've got a component that calls userouter ( a navigate bar ) and i want to test it in storybook , but it throws when router.pathname is access since , i 'd imagine , router is null . what pattern do i need to test this outside of the full nextjs setup ? < code >
i 'm following this nextjs blog example . to create a new page , i have to create a new .md file in /_posts directory and it will create a new page with that file name . everything works well in there . but is it possible to create a subdirectory/ subpages , as we do in the default nextjs layout . where we create a new folder in the /pages directory and nextjs serves pages under that subdirectory . so is it possible to configure something like that in that markdown blog example ? @ timneutkens < code >
hi guys , i 'm using vercel analytics and one thing i do n't get is what exactly a data point is ? i read through the whole doc but i could n't figure it out . can somebody please explain me what a data point exactly refers to ? on my page i just show a normal navigation bar that has a dropdown which gets his data from an api . on analytics it says this page has : 119 data points what does it mean ? thx guys ! < code >
hello everyone , i deployed my first next.js application on vercel last week just to experiment the framework and i did a simple blog to start , still working on it ( and enjoying 💯 ) . until now , no problems with the lighthouse score , it is ~ 100 % . however , checking the vercel analytics sometimes i see some variances on the res ( real experience score ) - please check the screenshoot below . even in the pages section i can not understand why i 'm only seeing informations for the root page `` / '' when i have another pages ( e.g . posts/xyz ) . note that i 'm probably the only one accessing it / contributing for the data points collection . can someone help me in order to understand this behaviour ? for example , yesterday my score was good/normal but today as you can see there is something wrong . no changes made . thanks in advance . < code >
for me lighthouse score was as low as 55. this propaply should n't happen as on the next.js conf analyzing and performance were talked about so much . i do n't know , just dropping it here . of course these are very early days since next 10 release , but still , how could this be pushed to us in times when we all aim for < 1s scores ? < code >
hi there ! in my next.js app , i have a logo inside a link in the header that takes the user to the homepage . i override my focus styling to be more prominent on a elements , when : focus-ed . when i click on the app logo link , and navigate to another page , the clicked logo receives a styling , which is still visible after the transition . this is because the element is part of a persistent layout . should i somehow `` reset '' ( and if so , how ) the focus on the page , or is it ok to let it be where it was ? this is something that happens to all links/buttons/inputs that wo n't change on page transition , like header elements in persistent layouts . ( search bar , button to home , menu items , etc . ) what is the standard behavior ? how should i handle it ? the page was sent back from internal testing , cause they `` did not like '' how the focus persists . should i tell them this is expected because of a11y ? or can/should i do something about it ? thanks ! < code >
hi guys . first , i have to tell that i 'm new at this world and usually lost with my code . is very nice to find this space so active with so many people willing to help . really =d let 's jump in ... i 'm bulding a website with four categories and my routes looks like this : mywebsite.com.br/category/article-url i tried to use dynamic routes two different ways . ___________________ the way i want , but it 's not working ___________________ file : ./ [ url.js ] ___________________ the way i 'm able to make it work ___________________ file : ./category1/ [ url.js ] file : ./category2/ [ url.js ] and loading the right ulr list for each category in each url file : i hope i 'm clear enough . any suggestions how could i achieve the first option ? < code > export async function getstaticpaths ( ) { return { { params : { url : `` category1/article1-url '' } { params : { url : `` category2/article2-url '' } } , fallback : false } } export async function getstaticpaths ( ) { return { { params : { url : `` right-article-url-for-right-category '' } , fallback : false } }
hi guys , i am new to next js and trying to add windows authentication to my application . i have n't found much material online for this . so far i have tried to use node sspi ( but could n't move forward due to some binary issue ) , next auth , ldapjs . i am able to authenticate my credentials using ldapjs but how to get those credentials from windows/browser is the bigger question now . if anyone has any idea , please comment here . thanks in advance . < code >
the next/image component will automatically generate smaller sizes through built-in image optimization - nextjs.org the problem is that i 'm trying to build a gallery where images could extend to take up the full page 's width , and next.js only gives me a maximum of 457.61px . how to make the image component display larger images ? < code >
hello , guys , first let me say happy new year . i 'm reading about next.js and am hooked , official tutorials , as well as lee rob 's blog . my question is , i want to be able to save files when in dev mode ( npm run dev ) . like if we take the official blog tutorial , how can i make it that i have another page where i can write markdown stuff , and then have a button to save that file along with the other .md files so it 's included when generating all the static data and i do n't have to resort to an external editor ? i think i can use api routes , but how can i `` disable '' them for production ? cheers , zed < code >
feature request make getstaticpaths have fallback===true work like getserversideprops on first time load is your feature request related to a problem ? please describe . i have a single product page with fallback : true , when i post new product it can be loaded on . but problem is when i post new product , it will share it auto on facebook page , post image in seo tag did n't exist yet so it take image from homepage = > no image of product show on shared post on facebook . i know because this code no data to show with facebook on first time load . describe the solution you 'd like make an option to getstaticpaths work like serversideprops . wait for page render then send to client , not send immidiate . describe alternatives you 've considered additional context < code > if ( router.isfallback ) { return ( < layout > < loadinganimate / > < /layout > ) ; }
using nodemailer in one of the pages/api routes produces the following error message : [ error ] ./node_modules/nodemailer/lib/sendmail-transport/index.js module not found : ca n't resolve 'child_process ' in ' c : \ua-demo\node_modules\nodemailer\lib\sendmail-transport ' with my understanding being that the next.js pages/api routes run in the server environment alone , it is a wonder that this error is occurring . how could this be addressed so that i can send email updates to my users ? an example has been added here at codesandbox.io . i think that we need to build a copy of the program directly on a local machine to reproduce . also discussed on so < code >
hi , i 'm loading a few components like modals using next/dynamic to reduce the main bundle size and speed up page loading . only problem is that when i want to open a modal it 's not smooth because it has to load the component on demand . is it possible , once the main page has loaded ( and not when rendering ssr or static generation ) to pre-fetch a dynamic component , getting the best of both worlds , e.g . fast page loads but still having the component ready before the user opens a modal ? thanks . < code >
hi all , i have a header and footer which are consistent across most pages of my site ( but not all ) . i currently have a and component which i import into every page and place as the very first and very last element in the page component . the header and footer both contain data which is pulled from a cms and because i 'm using getstaticprops to statically render the pages this currently needs to be fetched on every page and injected into the header and footer like this ... now , because i 'm using static generation and every rendered page needs the correct menu items in the footer when generated i do n't believe i can just move these components to the _app.js or _document.js . is there a solution to this ? is it possible to put the header and footer in every page without it flashing and re-rendering when changing pages . or , is there a way to pass data from getstaticprops to a custom app or document so that a full rendered ssr page has the correct header and footer ? < code >
hello all , despite all my efforts , i ca n't reach a good pagespeed insight performance with nextscripts rendered in the dom . i have static geenration , scripts are deferred , code splitting , lazy loading when usefull , inlining of css , etc ... when i keep nextscripts i have a google mobile pagespeed insight score of 50 , when i remove them it reaches 99. bu i need some usestate and useeffects hooks so i ca n't remove them completely . my next idea is to not defer the scripts but only load and execute them after the window.onload event . looping throught scripts in a class which extends nextscript , do you see a pretty way to do that ? if you want to see for yourself the stack trace : < url > thanks a lot ! < code >
hi all , in the next.js projects i 've made so far , i 've been doing get calls in getstaticprops . but i can see some obstacles for this method if i want users to be updating their profiles etc . let 's say a user has already entered their profile info . then a few days later they come back to edit it . i can retrieve the data in getstaticprops no problem , but then if i want the user to submit a form to update that info where can i make that call ? the page has already rendered so all of the ssr methods are n't an option . is it just the case that i should be using the ssr methods for initial load and then do everything else in react lifecycle methods ? previously i was thinking of the ssr methods as replacements for lifecycle methods , but is this the wrong way to view next 's functionality ? < code >
icons seem ca n't be loaded . i tried to add global styles using < style jsx global > but to no avail . how to configure next.config.js file in the right way ? < code > < style jsx global > { ' thead th.ascending : :after { font-family : 'font awesome 5 free ' ; font-weight : 900 ; content : ' 15e ' ; display : inline-block ; margin-left : 1em ; } thead th.descending : :after { font-family : 'font awesome 5 free ' ; font-weight : 900 ; content : ' 881 ' ; display : inline-block ; margin-left : 1em ; } ' } < /style >
i have my own portfolio using digitalocean for a server and digitalocean space for storing image . now nextjs have a image component and i check the document with next.config.js . there is only config with the provider like imgix , cloudinary , akamia vercel : works automatically when you deploy on vercel , no configuration necessary . learn more imgix : loader : 'imgix ' cloudinary : loader : 'cloudinary ' akamai : loader : 'akamai ' default : works automatically with next dev , next start , or a custom server my question is there any way . to config with digitalocean space ? < code >
hi i was wondering is it possible to create bundles depending on the locale ? in the sense that i have two bundles created one for `` en '' and one for `` es '' instead of it being part of the same bundle ? < code >
sorry if this has been asked before because i could n't find any ! i 'm really new to next.js and i would like to know how can i add tags or categories to the posts i write ? edit : i 'm using the md blog starter < url > < code >
hello , how can i implement loading the app until the user 's data is loaded ? the application uses react-redux , i need to check the presence of the user 's token in the cookies , perform authorization , pre-load some information and enter this data in the redux store , so during these actions the user should see the loading screen . the option above does n't work . < code > export default function app ( { component , pageprops } : appprops ) { const store = usestore ( pageprops.initialreduxstate ) ; const { dispatch } = store ; const { initialized } = store.getstate ( ) .app ; useeffect ( ( ) = > { if ( ! initialized ) { dispatch ( appservice.initializate ( ) ) ; } } , [ initialized , dispatch ] ) ; return ( < provider store= { store } > { ! initialized ? ( < loading / > ) : ( < component { ... pageprops } / > ) } < /provider > ) ; }
hi there , i 'm using next/image for image optimization . is it possible and how to add fade-in effect for the lazy loaded image . thanks . < code >
hi , i am trying make site fastest on mobile . but how can google detect link /post/my-post ? amp=1 ? ? ? is bot smart enough to find it ? or i must add the link with query amp=1 to sitemap.xml ? or will we rediect user to link /post/my-post ? amp=1 if they are on mobile ? < code >
how to make a client side redirect without a page reload ? i 'm using next v10.0.4 . inside a component function i know i can do that ( see code below ) . but i need to perform a redirect outside a component function so i ca n't use the userouter hook . < code > const aboutpage : nextpage < props > = ( { owners } ) = > { // with this technique , the redirect happens and the page does n't reload . ✅ const router = userouter ( ) ; router.replace ( 'login ? page_requested=user/1 ' ) ; // with this technique , the redirect happens but the page reload . ❌ router.prototype.replace ( 'login ? page_requested=user/1 ' ) ; return ( ...
i am using dynamic import to render articles written in mdx into a common layout which is working as expected . 🎉 but the dynamic import is running in the browser . because it 's the slug that 's determining which mdxfile to load , it should be possible to render it during static generation . i assume i should move const mdxfile = dynamic ( ( ) = > import ( .. / .. /_articles/ < cur > { slug } .mdx ) ) ; into getstaticprops ( ) but how would i then pass mdxfile to the article page ? i do n't think you can pass it as a prop because it ca n't be serialized . thanks for any advice 😀 < code > //pages/articles/ [ slug ] .js import dynamic from `` next/dynamic '' ; import articlelayout from `` .. / .. /components/article-layout '' ; export default function article ( { slug } ) { const mdxfile = dynamic ( ( ) = > import ( ' .. / .. /_articles/ < cur > { slug } .mdx ' ) ) ; return ( < articlelayout > < mdxfile / > < /articlelayout > ) ; } export async function getstaticpaths ( ) { return { paths : [ { params : { slug : `` article-1 '' } } , { params : { slug : `` article-2 '' } } , ] , fallback : false , } ; } export async function getstaticprops ( { params } ) { const slug = params.slug ; return { props : { slug , } , } ; }
i have a js file in the public folder ( custom.js ) for doing basic javascript stuff like animating the header , back to top button etc and i used _document.js to embed this script before the end of body tag . now in regards to cache busting - is there a way to add hash to the file name for cache busting ? thank you very much in advance . < code >
hello ! happy new year everyone ! ! i have a vps and i would like host a next.js while it 's on development with apache2 proxy ( call me crazy if you want , maybe i should n't have a live app while it 's in development ) here 's what i have done so far my apache2 already hosts a website made in wordpress and i 'm just using proxypass i have configured the script dev as : as you can see when i run the next dev it uses 4000 port on apache2 i 'm using this configuration i have checked that my apache2 configuration is ok however , when i visit mydomain.com/next/dev my webpage does n't render , i get error error 404 : resource not found if i visit < url > my app renders totally fine . please note : the above is possible because i am connected to my vps through ssh on visual studio code and visual studio code by default forwards all ports please note that the scripts : with the next start , the app renders but i 'm still getting `` errors 404 not found '' update 1 : the errors 404 happen because the browser tries to fetch files from the following urls : < url > however the files are for example in : < url > < code > < location /next/dev > proxypass < url > proxypassreverse < url > < /location > `` dev '' : `` next dev -p 4000 '' , `` build '' : `` next build '' , `` start '' : `` next start -p 4000 ''
when there 's an error next js shows wrong line/file almost every time ? is this normal behaviour or it just i messed up something ? as per the above image , there is no attribute called type on pointed location , or the file . this very hard to debug . < code >
i 'm looking to serve a static js file that users can embed on their website . i currently have a .js file in my public folder and it works fine . however , the js file is not compressed/minified so the entire source code is inspectable and quite large . how can i compress/minify js files in the public folder ? < code >
hello all . i am a big fan of next.js . recently i intended to create a static blog site where i will keep the blog contents ( .md/.mdx files ) on github and build the site . first i chosen github-pages but later understood i want more flexibility which next.js provides . after some google search , i found the awesome example , with-mdx-remote . this example shows how we can fetch .md/.mdx files from a remote database and create the site . however , the example does n't fetch files from a database . rather the project has a directory named posts where the .mdx files remain and that 's what i was searching for . we can always create a site like that with next.js . but the example was too simple . a real blog will contain several subdirectories inside posts and each subdirectory will have its own subdirectories and so on . so it will become more complex to build the paths key on getstaticpaths . to solve this problem i have started an open-source npm package named next-dynamic-route-generator . now i want to edit the with-mdx-remote so that developers who want to build such a site learn about this package , use it , contribute to it , etc . no my question is , can i update the with-mdx-remote example with a bit more complex posts directory and generating paths using the next-dynamic-route-generator ? < code >
i try to use typeorm add database support for my data management for next.js project . i use tsconfig.json to support that . my tsconfig.json is : i already use esperimentaldecorators and emitdecoratormetadata options . but the issues still when i try to use decorators . how to set them ? < code > error : support for the experimental syntax 'decorators-legacy ' is n't currently enabled : 5 | 6 | > 7 | @ entity ( ) | ^ 8 | export class user { 9 | 10 | @ primarygeneratedcolumn ( ) { `` compileroptions '' : { `` target '' : `` es5 '' , `` lib '' : [ `` dom '' , `` dom.iterable '' , `` esnext '' , `` es5 '' , `` es6 '' ] , `` allowjs '' : true , `` skiplibcheck '' : true , `` strict '' : false , `` forceconsistentcasinginfilenames '' : true , `` noemit '' : true , `` esmoduleinterop '' : true , `` module '' : `` esnext '' , `` moduleresolution '' : `` node '' , `` resolvejsonmodule '' : true , `` isolatedmodules '' : true , `` emitdecoratormetadata '' : true , `` experimentaldecorators '' : true , `` jsx '' : `` preserve '' } , ... }
the i18n guide says it 's `` up to you '' to add the < link rel= '' alternate '' hreflang= '' '' href= '' '' / > tags in the < head > for seo optimization . how do we generate links to each language variant dynamically ? i do n't see a way to ask the router to build a url string , so i have to go through the next/link component . i have this code which works outside of the < head > tag just fine : unfortunately , the < link/ > tags never show up in the head . presumably because of this warning : title , meta or any other elements ( e.g . script ) need to be contained as direct children of the head element , or wrapped into maximum one level of < react.fragment > or arraysotherwise the tags wo n't be correctly picked up on client-side navigations . is there a way to dynamically generate a localized-url or to use the next/link component in < head > ? < code > { router.locales.map ( ( locale ) = > ( < link key= { locale } href= { router.route } prefetch= { false } passhref locale= { locale } > < link key= { locale } rel= '' alternate '' hreflang= { locale } / > < /link > ) ) }
building the with-styled-components example which uses getinitialprops in _document.js gives me this cli output whilst the docs mention that getinitialprops will disable automatic static optimization . in the _document docs it is mentioned that document 's getinitialprops function is not called during client-side transitions , nor when a page is statically optimized .. in conclusion , although the build output suggests that the pages are static , i 'm confused as to whether that 's actually the case . < code >
i try to generate static pages with getstaticpaths and will have a fallback . i would like to use fallback here . but on first init of database , there is no data . so the paths will be an empty array . here i use notfound in case of no post is found with the param . next tries to render the 404.js page , but this page does not exists on dev mode . is this behavior correct from next to render 404.js page on dev mode in case of notfound : true ? on production the 404 page was created through build and can be found . here you can see it in action : < url > < code > export async function getstaticpaths ( ) { const posts = [ ] ; // no posts in database const paths = posts.map ( ( post ) = > ( { params : { id : post.id } } ) ) ; return { paths , fallback : true } ; } export async function getstaticprops ( { params } ) { const post = null ; if ( ! post ) { return { notfound : true } ; } return { props : { post } } ; }
i have two environment files for each stage inside the root directory of my project as i need to connect to my backend on localhost during development . in these files i am exposing the same key - next_public_mykey , but with different values for each environment . i dont use any other env files in my directory . .env.development -- next_public_mykey= < url > .env.production -- next_public_mykey=8.8.8.8 while developing local i dont have no problems but by recently checking the deployed version on vercel i see the connection string to my backend is merged together from development & production . the client is now trying to connect to < url > did somebody else encountered this problem ? < code >
at development my app looks like this but at it looks like this i dont knw what happened at production link for repo < url > i m using context api along with usereducer , react , next , typescript and tailwindcss < code >
i upgraded nextjs to 10 so i could use internationalized routing . this is how my nex.config.js file is looking : module.exports = { i18n : { locales : [ 'rs ' , 'en ' ] , defaultlocale : 'rs ' , } } and everything is working fine , except one thing and that is when i open app it 's always using en , instead of rs . when i change the language to rs it works fine , myapp.com/ and for en is myapp.com/en . but it just looks like defaultlocale is n't working like it should and i do n't know where the problem is . < code >
feature request add parameter of context in getstaticpaths ( ) too so that we can access nested path param is your feature request related to a problem ? please describe . i want to fetch the question slugs of a particular quiz slug , and for that i will need to know the slug in qslug page a clear and concise description of what you want and what your use case is . i do n't know if anyone has occurred this thing but this might be useful in some cases where we need multiple nesting and pre rendering . describe the solution you 'd like i would like to have access to parent slug in the getstaticpaths describe alternatives you 've considered right now i am creating an another api to get all the quiz slugs so that i can fetch it in getstaticpaths and map it accordingly . < code > quiz [ slug ] question [ qslug ] .tsx [ slug ] .tsx
we are trying to authenticate users using windows authentication but not able to achieve it . the api we are using to fetch the data from is windows authenticated . when we put the code to fetch the data in getserversideprops with credentials : `` include '' , we get 401 error message . however , the same code is running when we do it in react useeffect hook . any help is much appreciated . < code >
hey , is it possible to either render a static page if the user is not logged in or otherwise show the app on the same url ? use case : we 'd like to either show a landing page ( which includes a login form ) which can be static or the real app ( which ca n't be static ofc ) . thanks ! < code >
hello everybody , is it possible to revalidate a static generated page by passing a param in url . currently , i have a blog that with ssg pages however every now and then i change something on a page and want to regenerate it without adding revalidate in getstaticprops function since that will affect all pages ? < code >
whenever i try to run the script npm run dev , i get this error down below , and i 'm not sure why . i searched around to see if there 's anyone else who had the same experience as me , but there does n't seem to be enough information on this . i appreciate any help i get . error : can not find module ' c : \users\jaydev\documents\test2\node_modules\postcss\lib\parser ' at createesmnotfounderr ( node : internal/modules/cjs/loader:952:15 ) at finalizeesmresolution ( node : internal/modules/cjs/loader:945:15 ) at resolveexports ( node : internal/modules/cjs/loader:473:14 ) at function.module._findpath ( node : internal/modules/cjs/loader:513:31 ) at function.module._resolvefilename ( node : internal/modules/cjs/loader:911:27 ) at function.module._load ( node : internal/modules/cjs/loader:769:27 ) at module.require ( node : internal/modules/cjs/loader:997:19 ) at require ( node : internal/modules/cjs/helpers:92:18 ) at object.552 ( c : \users\jaydev\documents\test2\node_modules\next\dist\compiled\postcss-scss\scss-syntax.js:1:11590 ) at webpack_require ( c : \users\jaydev\documents\test2\node_modules\next\dist\compiled\postcss-scss\scss-syntax.js:1:11735 ) at object.560 ( c : \users\jaydev\documents\test2\node_modules\next\dist\compiled\postcss-scss\scss-syntax.js:1:400 ) at webpack_require ( c : \users\jaydev\documents\test2\node_modules\next\dist\compiled\postcss-scss\scss-syntax.js:1:11735 ) at object.290 ( c : \users\jaydev\documents\test2\node_modules\next\dist\compiled\postcss-scss\scss-syntax.js:1:260 ) at webpack_require ( c : \users\jaydev\documents\test2\node_modules\next\dist\compiled\postcss-scss\scss-syntax.js:1:11735 ) at object.632 ( c : \users\jaydev\documents\test2\node_modules\next\dist\compiled\postcss-scss\scss-syntax.js:1:3733 ) at webpack_require ( c : \users\jaydev\documents\test2\node_modules\next\dist\compiled\postcss-scss\scss-syntax.js:1:11735 ) { code : 'module_not_found ' , path : ' c : \users\jaydev\documents\test2\node_modules\postcss\package.json ' } npm err ! code 1 npm err ! path c : \users\jaydev\documents\test2 npm err ! command failed npm err ! command c : \windows\system32\cmd.exe /d /s /c next dev npm err ! a complete log of this run can be found in : npm err ! c : \users\jaydev\appdata\local\npm-cache_logs\2020-12-29t00_14_40_916z-debug.log < code >
if there are 10 clients requesting data from getserversideprops . then i assume that each one of them will have 10 different jsons built for that page . then , let us increase this number from 10 to 1000. umm ! means 1000 different jsons . being stored in cache/next-babel-loader folder inside the app . now , this will soon increase the memory of the server where app is hosted . how can i overcome this issue ? i am sure this is a general problem for scale . is there anything that is exposed to users to clean up these json cache accumulated from time to time ? < code >
i am currently passing values from _app to page component using getinitialprops via the getinitialprops function in _app ( psuedocode ) : via the component prop received by the function in line 2 , i can pass mypassedvalues to the component being rendered in line 3. does this same functionality exist for getserversideprops ? is it possible to have _app have visibility to the getserversideprops function in the component to pass values or does that not exist yet ? i know that _app currently can not perform 'getserversideprops ' , but that does strictly prohibit it from interacting with/sending values to the other pages that perform it ? < code > class myapp extends app { static async getinitialprops ( { component , context } ) { let passingvalues = await component.getinitialprops ( { ... context , mypassedvalues } ) return { passingvalues } ; } render ( ) return ( ) }
hello , i 'd like to use next.js on an existing site ( not made with react ) to make the search engine more dynamic . so in this configuration , the main component would be included on a dedicated page which already contains header , footer ... generated by a cms . how to make ssr and routing works in this configuration ? thanks . < code >
so i am working on a project where the base url caters to a few different kind of pages . most of these pages are static so i have been using getstaticpaths and getstaticprops to generate the static pages and serve them . there are some pages that are also dynamically queries for which i have been using a simple [ base ] .js file which uses the above getstaticpaths and getstaticprops and on fallback , makes a swr query to fetch data and render on the client side . so the basic idea is to check static file exists and render if no static file exists then make a fetch request and see if data is returned and render i was wondering if there 's a way to use getserversideprops in this mix too so that my dynamic queries can be rendered on server side and then swr can be used only for incremental purposes . right now as i add getserversideprops to the same base file , i end up with you can not use getstaticprops or getstaticpaths with getserversideprops . to use ssg , please remove getserversideprops is it impossible in next to use ssg and swr together , or is there a workaround to this ? < code >
i am using nextjs and when i use direct css import ... css alongside a styled-component createglobalstyle . my direct css imports are always included last in my html causing some overriding issues that i 've setup in globalstyles . how can i resolve this ? rendered html _app.js _document.js < code > < head > < link href= '' /_next/static/chunks/main.js ? ts=1609163560022 '' > < style > < /style > // global styled component < style > < /style > // bootstrap imported after global styled component < /head > import { themeprovider } from `` styled-components '' ; import 'bootstrap/dist/css/bootstrap.min.css ' // this is always loaded last < head > import globalstylesfrom 'styles/global ' ; // this is always loaded first in < head > const theme = { ... } ; export default function app ( { component , pageprops } ) { return ( < themeprovider theme= { theme } > < globalstyles/ > < component { ... pageprops } / > < /themeprovider > ) } import document , { html , head , main , nextscript } from `` next/document '' ; import { serverstylesheet } from `` styled-components '' ; export default class mydocument extends document { static getinitialprops ( { renderpage } ) { const sheet = new serverstylesheet ( ) ; const page = renderpage ( app = > props = > sheet.collectstyles ( < app { ... props } / > ) ) ; const styletags = sheet.getstyleelement ( ) ; return { ... page , styletags } ; } render ( ) { return ( < html > < head > { this.props.styletags } < /head > < body > < main / > < nextscript / > < /body > < /html > ) ; } }
i 've tried installing some libraries to disable react devtools in next js and nothing happen and project ca n't doing next build , hope you guys can help me , thx ! ! < code >
how to prevent running getserversideprops on broswer back ? i have a posts list when navigate to one list and back to list it should n't recive data again . < code >
hi , i have a question .. i tried to update nextjs lib on my app from 9.0.2 to 9.3.5 , it works fine with 9.0.2 but when i run prod build using 9.3.5 ( no changes in my app ) , i got error : anyone encounter same issue ? thank you . < code > referenceerror : can not access 'initialstate ' before initialization at initializestore ( /var/app/build/next/server/static/c1t6bgjowixbj-3lv6fng/pages/_app.js:447:41 ) at getorcreatestore ( /var/app/build/next/server/static/c1t6bgjowixbj-3lv6fng/pages/_app.js:181:82 ) at function.getinitialprops ( /var/app/build/next/server/static/c1t6bgjowixbj-3lv6fng/pages/_app.js:201:26 ) at object.loadgetinitialprops ( /var/app/node_modules/next/dist/next-server/lib/utils.js:59:29 ) at object.rendertohtml ( /var/app/node_modules/next/dist/next-server/server/render.js:262:31 ) at processticksandrejections ( internal/process/task_queues.js:93:5 ) at async server.rendertohtmlwithcomponents ( /var/app/node_modules/next/dist/next-server/server/next-server.js:652:26 ) at async server.rendererrortohtml ( /var/app/node_modules/next/dist/next-server/server/next-server.js:863:24 ) at async server.rendertohtml ( /var/app/node_modules/next/dist/next-server/server/next-server.js:830:20 ) at async server.render ( /var/app/node_modules/next/dist/next-server/server/next-server.js:541:22 ) at async object.fn ( /var/app/node_modules/next/dist/next-server/server/next-server.js:391:17 ) at async router.execute ( /var/app/node_modules/next/dist/next-server/server/router.js:134:32 ) at async server.run ( /var/app/node_modules/next/dist/next-server/server/next-server.js:506:29 ) at async server.handlerequest ( /var/app/node_modules/next/dist/next-server/server/next-server.js:150:20 )
bug report describe the bug an unexpected error has occurred in browser while starting server built inside the jest test . to reproduce create new next.js project . add jest test with execsync ( 'npx next build ' ) call ( or so ) . run the test to perform build . run next start . see an unexpected error has occurred in browser . ( can provide a repo if needed ) expected behavior the behavior should be the same as for the builds performed from outside the jest ( terminal , script , etc. ) . screenshots system information os : windows 7 browser : firefox 84.0 version of next.js : 10.0.4 version of node.js : 14.15.1 additional context i 'm trying to achieve end-to-end testing for my package . it contains react+typescript icons so i though it would be a good idea to reproduce the whole workflow with it ( from the perspective of the end user ) inside the test . basically i do the following : create dummy package ( next.js project ) with dependencies that includes my package . run 'next buildandnext start ' from inside the jest test . get error listed above . in the very end the problem is based around next build . if it was performed from jest then next start will result in an error , no matter where i run it ( jest , regular script , terminal ) . if next build was performed from outside the jest ( regular script , terminal ) then there will be no error even in jest . ( 90 % sure it is a jest problem but still think it would be much faster to find the root cause from this side ) < code >
in my next.js blog with strapi cms , i am trying to sort the posts based on its category . i created a dynamic route for categories [ id ] .js . it is using getstaticpaths like so : i am using a dropdown to filter categories . for example , if i select category 1 , the path is like this < url > till here it 's fine . but the dropdown is still rendered on the page and when i select category 2. now , the path is < url > which of course results in a 404 error . the expected result is < url > the next/link component i am using for dropdown elements looks like so : i know i did some mistake , but ca n't figure out what it is . however , i have a [ slug ] .js for posts , which renders more posts too . that routes to proper posts without adding the extra /posts for the path . but it is not working in a similar way for categories . also tried some suggestions from my question here < url > kindly help . < code > export async function getstaticpaths ( ) { const categories = await getcategories ( ) return { paths : categories.map ( ( category ) = > '/categories/ < cur > { category.id } ' ) || [ ] , fallback : false , } < link href= '' /categories/ [ id ] '' as= { '/categories/ < cur > { category.id } ' } > < a > { category.name } < /a > < /link >
i am using getserversideprops to get data displayed on the first render . in getserversideprops i am doing 3 small requests to an external api , each request takes around 50ms . the site works fast in development mode , but as soon as i deploy it to production , the loading time jumps to around 2 - 3 seconds . here is the live version : < url > any help is much appreciated ! < code >
i 'm trying to create a new next.js app for the first time using npx create-next-app . once it 's all installed when i run npm run dev , the page localhost:3000 takes around 20 seconds to load , and then i get internal server error with no additional information . i 've tried deleting the folder and re-creating the app , but i get the same result . < code >
so basically i want to deploy files from the frontend to amazon s3 buckets using nextjs local api ( like which is inside pages directory ) directory and store the file name to my database . i have done uploading files part in the past in development mode only using multer and express . but here , i am afraid to so because i saw that vercel does n't supports custom server like express . i have searched here and there to get through this but still did n't get satisfactory answers . so i will highly appreciate if you guys help me through this . < code >
i created a nextjs blog and i found whenever i publish a certain article/post which it has to be as a page , the page does n't created and i get a 404 until i push a commit and then it builds on vercel , then the page will be available . i also added revalidate : 1 to that that page 's getstaticprops but still it does n't work ! ? am i missing something here ? code < code >
can we have a dynamic rewrite based on some condition , destination path would be dynamic based on some api response , useful when having multiple themes < code > module.exports = { async rewrites ( ) { return [ { source : '/blog/ : slug ' , destination : ' { condition_path } /news/ : slug ' , // matched parameters can be used in the destination } , ] } , }
i 'm creating an online service where people can list and submit things for others to see . i 've noticed that using getserversideprops ( ) is really useful and i 'm wondering how i can incorporate it into my existing project . right now , i 'm just fetching data using fetch ( ) in my componentdidmount ( ) method . i started using getserversideprops ( ) and noticed that i am now forced to use props instead of the state . i do n't exactly mind doing this but i would also like to re-fetch the data on the client side , which means i ca n't update the props again once it 's already mounted , or can i ? is there a better way to do what i am asking , or should i not re-fetch anything client side ? all i want to do is ensure that the data i 'm getting from the props is valid and fresh from the api itself . < code >
routes are auto generated from the file structure in the /pages folder , and they are not imported anywhere in the codebase . plugins like 'unused-files-webpack-plugin ' will list all these pages and their imports as dead code . is there any workaround or best practice to find actual dead code , ie . files that are not imported anywhere , and unused exports ? < code >
hi ! i 'm making a photography site with nextjs . each page will display about 10-12 images in a grid . what is the best way to load these images onto each page ? do i just put the images into public/static and load them from there ? or does vercel offer some solution where i can query the images and get them from somewhere else ? < code >
hey ! i generally like type inference more than pre-defined types and wondering if it 's generally safe to export types from api routes and use them in my components ? i 've made an example here : < url > in this example , i 've created an api-route from which i 'm inferring types into my pages & components . is it safe to do this ? feels bad to import api/-stuff into react-components . example deployment : < url > exporting type getusersresponse in api/users/index.tsx using said type in pages/users/index.tsx list / listitem < code >
i saw a video of someone creating incremental static generation and regeneration i can not help to think , statically generate nextjs app which hosten on a s3 , how is it calling a mongodb o_o ? < code >
hi , i 'm considering moving from gatsby to next.js for websites that we build for our clients . usually , our setup is gatsby + wordpress , but it does not work well with even medium size website - from 50 pages . the dev experience on local machine is not great because you have to fetch whole data from wp , then generate thumbnails , etc . so builds take up to 10 minutes without cache , and even with cached versions , it takes 2-3 minutes . i understand how can i replace most of the part with next.js , however , i do n't understand how can i dynamically generate/refresh routes based on pages and urls that were created in wp . example : client creates in wp new page `` /about '' and want to use a template called `` about '' that we made specifically for that page . then client can creates sub page to that parent page like /about/team and use the template `` static page '' for this . i want to have different templates that will be placed inside a templates directory , then there will be sort of a function that i will be able to re-run based on changes in wp . inside that function , there will be a way of programmatically re-map specific routes to the specific templates ( component ) . those components should have getserversideprops in order to get data required for those templates . < code >
i 'm working in a monorepo setup with lerna , the structure is like this : i 'm trying to import from package modulea into my nextjs package modulea imports some fonts , which leads to an error when i 'm trying to access a page : ' ... /build/fonts/assistant-extrabold.ttf:1 syntaxerror : invalid or unexpected token ' the file which imports the fonts in modulea looks roughly like this : modulea is transpiled to commonjs via tsc in nextjs i added this to the next.config.js any idea whar 's causing the break ? < code > import { css } from ' @ emotion/core ' ; import assistantextrabold from ' .. /fonts/assistant-extrabold.ttf ' ; export default css ' @ font-face { font-family : 'assistant ' ; font-weight : 800 ; font-style : normal ; src : url ( < cur > { assistantextrabold } ) ; font-display : swap ; } ' ; packages : nextjs // containing the next js application modulea // containing general styles and ui components // ... config.module.rules.push ( { test : /\ . ( woff|ttf|eot|svg ) ( \ ? v=\d+\.\d+\.\d+ ) ? < cur > / , use : [ { loader : 'file-loader ' , } , ] , } ) ; // ...
i would like to set a static cache-control header for all next image components , both for internal and external images . i 'm using vercel.json currently , so i 've tried with the vercel.json eg . however , this does n't work , as it appears to ignore the header , no matter what i do . is there a way to do this with next.js configuration instead ? < code > { `` version '' : 2 , `` headers '' : [ { `` source '' : `` /_next/image/ ( . * ) '' , `` headers '' : [ { `` key '' : `` cache-control '' , `` value '' : `` s-maxage=604800 '' } ] } ] }
i am getting both these errors intermittently at the same time . for additional context i am using nextjs redux since it seems to be a problem with hydration . i do not understand why it happens only sometimes . any ideas on how i can fix or debug this error ? < code > typeerror : t is undefined nextjs 41 oa qi yo su uu eu yo lu ju nu ju hydrate de e f _invoke m r s exports exports ae oe e f _invoke m r s promise callback * r s promise callback * r s exports exports ne bmp1 u t r < anonymous > framework.53cfa66f9846f4090096.js:1:94850 typeerror : object ( ... ) ( ... ) is undefined nextjs 41 fa qi yo su uu eu yo lu ju nu ju hydrate de e f _invoke m r s exports exports ae oe e f _invoke m r s promise callback * r s promise callback * r s exports exports ne bmp1 u t r < anonymous > framework.53cfa66f9846f4090096.js:1:94850 nextjs 44 eo callback di io mu unstable_runwithpriority jl pu eu yo lu ju nu ju hydrate de e f _invoke m r s exports exports ae oe e f _invoke m r s ( async : promise callback ) r s ( async : promise callback ) r s exports exports ne bmp1 u t r < anonymous >
i would love to keep statically rendered pages but i am having a problem updating the page on the client side . i have tried to force re render the page but it does n't work using useeffect and setstate . i noticed some components do refresh the dom such as my material ui drawer so i know it is possible at least . my use case is that i have a dynamic login indicator and that 's the only thing that needs to be updated . < code >
i am using next js v10.0.0 , and regraph lastest trial sdk . im a trying to import the following const neighbors = dynamic ( ( ) = > import ( 'regraph/analysis ' ) , { ssr : false } ) since im having an error navigator is not defined but when it using at runtime it says : typeerror : neighbors is not a function someone knows how to use this ? would love to know the works around . < code >
we have a site where we list links to ~100 subpages in the header menu . they are fetched from our server ( /api/subpages ) in getstaticprops in _app.js . every time revalidate re-generation runs our backend gets one request to /api/subpages for each subpage , that 's 100 * 100=10000 requests ! i 've tried to cache the api calls in memory but each page re-generation has it 's own memory ( most of the time it seems ) . is there anyway to cache the api-calls or only make them once and then share between re-generations ? < code >
we are having an issue with the image component , we currently have an assetprefix set to a subfolder so all our _next assets are loaded from a subfolder . example and our files are loading perfect from the subfolder set ( example below ) but with the new image component , all our images are trying to load from the domain without the prefix ( example below ) * note : the subfolder is in the query parameter instead of the path which is n't working becuase it ca n't find the next folder . we found a workaround that seems super hacky ... which is setting the path like below is there another way ? or is this a possible bug ? < code > assetprefix : 'sub_folder_goes_here ' , < url > path : [ '/sub_folder_goes_here/_next/image ' ] , < url >
i have intermediate knowledge of next.js and p5.js , i like the overall concept of next.js and now , i use it to for my web development and , i do sketches in p5 , so , i want to make a gallery of my p5.js sketches with next.js . and , i want help to get started . i thought of putting my sketches in separate folder 'sketches/ ' and run a for loop based on the count of sketches in sketches , using getstaticprops ( ) . but this does n't work . can anyone help me to get started ? < code >
hi ! i have a problem with google webcache , seo optiomization . when i first create website and deploy it to production , wait for google to cache my pages - everything good . but when i 'm making changes , create a new build , js/css files , chunks have new names with hash , and google webcache ca n't find old files and its broken . any suggestions ? my website < url > webcache : cache : < url > < code >
problem : i have a page that display hotel information by id , so i use getstaticpath to create thing like /hotel-info/542711 , 542711 is hotel-id problem is there are thousands of hotels , and nextjs will pre-build all that thousands page ? ? ? ? ( increment static generation ) is there problem with memory due to store too much pre-built page like that ? ... < code >
the react team announced server components this week . seeing as the nextjs team worked closely with the react team the last few months , i take it , this is old news to them , but to the rest of us , this raises a lot of questions . how does this fit in with next ? will next incorporate these server components into ssg , ssr , isr etc ? see this hacker news thread where this exact topic is being discussed of next having ssr for years and react now changing from old traditional ssr support for frameworks like next and gatsby to native component level server rendering . i would like to keep using getstaticprops and getserversideprops , but to additionally be able to do data fetching on child components rather than fetching it all on the page level and then passing down via props/context . this will simplify our codebase considerably , especially with apollo hooks . when getinitialprops got replaced by getstaticprops and getserversideprops , the getdatafromtree method became unsupported by nextjs and the with-apollo example code changed considerably . if we can do data fetching on component level , we wont need that getdatafromtree method . there are many other advantages to this new server component idea , but it is not clear if/how next will suppor it and fit it in with the traditional ssg/ssr < code >
i 'm building a site using next i18n , currently building a preview endpoint and wondering if i can use the locale/defaultlocale in api routes . i noticed that attached to req.query there are __nextlocale and __nextdefaultlocale properties but is there a safer/better way of accessing this information ? < code >
hi , i noticed that the following cache-control headers are used for the pages : page.js : public , max-age=31536000 , immutable getstaticprops json : s-maxage=31536000 , stale-while-revalidate getserversideprops json : private , no-cache , no-store , max-age=0 , must-revalidate since getstaticprops is generated at build time and its url includes the build_id ( eg /_next/data/pskmiwblfabrncx6k29e1/somepage.json why does it have those specific cache headers ? seems to me that it could be cached forever , same as the page 's .js file . when building for production next even generates that json file and it is served from disc . seems that this is related to # 11552 but if that is the case , it should be opt in right ? the default should be to return the same headers as the page.js file and if opting in to the incremental static generation , then change the headers ( and perhaps getserversideprops should be used instead since essentially the content is generated server side at that point and not at build time ... ) < code >
i 'm uploading photos from my phone to a cms and later on display it on my website . now i want to use the next image component to convert them into smaller images . i just do n't get the size property . some of the images are smaller . so if i say i want to display a 10.000 px width image , i go width= { image.width / 10 } ( while image.width is taken from the meta data ) to scale it to 1.000 px . but is the image is smaller , it scales down smaller . ( e.g . it results in the image being just 200px width ) a maxwidth property would be cool for that , so that the already small images are not affected by the division . can someone provide me with a hint on how to achieve this ? every image needs to be 600px width , while the dimensions are the same . < code >
i am trying to get data like cart items from database . i am trying to get them in context . but it looks like a mess when i did that . is n't it possible to call database from context ? < code >
hello , thank you all for your contributions to this awesome framework . i am wondering if there is a way to query data that is statically optimized from outside of the page . i know there used to be getinitialprops but from my understanding , that blocks static optimization . the goal for this would be to provide globally scoped components data and optimize it into the app . the app could also revalidate the response , but it would be opt-in from the config to revalidate globally queried data . my use case might help clarify the practicality of this prop . i have my navigation menu on my layout component wrapping all pages that depends on dynamic data . instead of moving that layout component around every page , and doing the same query on every page , it could just be one query outside of the app that returns that to the app root itself . thanks for your time and discussion . < code >
we are having significant issues when pushing new releases with flushing cache and the unique hashing names of the files within the .next directory . the core problem is the unique hash names of the chunked files and the cdn caching strategy . for instance : if we have an application like /blogs . ( production has release 1 ) /blogs .next/chunks/commons-111.js we are pushing this new release to production which npm build produces a new commons filename . ( release 2 ) /blogs .next/chunks/commons-222.js we run a flush command to delete all the urls and edge cache tags . but while the flush occurs , if a user comes to the site , they could have a cached version or be served the release 1 version of /blogs ( from an edge ) which references commons-111.js which does n't exist anymore in the cdn or nextjs producing a 404 for the chunk file that never gets resolved until my request for /blogs returns ( release 2 ) version with the new commons-222.js . how are people resolving this issue ? are you setting a short or no ttl for /blogs so that you always get the latest ? are you keeping the previous builds chunk/css files around ( since they are unique ) to server requests from edges that are not flushed yet ? looking for some help and guidance . seems like we are doing something wrong or this would be a bigger issue . looking at other resources such as : < url > < url > < code >
i 'd like to use the babel-plugin-transform-remove-console plugin to remove all console statements , but only during build time . currently , this is what my .babelrc file looks like it works , but during dev time as well ( with node_env=production ) . why would i use node_env=production during local development ? to test production-like stuff locally . how do i ensure this works only during next runs but not nest start runs so i can continue using console statements during development ? < code > { `` presets '' : [ `` next/babel '' ] , `` env '' : { `` production '' : { `` plugins '' : [ [ `` transform-remove-console '' , { `` exclude '' : [ `` error '' , `` warn '' ] } ] ] } } }
first , i update ver from v10.0.0 to 10.0.3 , the image of next change so much . ex : create two tag image : i do n't know what this means . second , when i checking with the performance of the lighthouse . i have the issue : image elements do not have explicit width and height this issue above cause the tag image . please tell me how about that < code >
i have a project : < url > i currently have argon-design-system-react installed as a node module : < url > as part of setup , in my index.tsx file i did : import 'argon-design-system-react/src/assets/vendor/nucleo/css/nucleo.css ' ; import 'argon-design-system-react/src/assets/vendor/font-awesome/css/font-awesome.min.css ' ; import 'argon-design-system-react/src/assets/scss/argon-design-system-react.scss ' ; the good part is that the scss styles and fonts propagate . the bad news is that icons do not load . here is a picture of what i mean : < url > as you can see the scss shows up but the icon is replaced by a square placeholder . in my project i setup my next.config.js file to be as follows : is there anything that i 'm doing wrong in getting the icons to load ? < code > const withfonts = require ( 'next-fonts ' ) ; const withsass = require ( ' @ zeit/next-sass ' ) ; const withcss = require ( ' @ zeit/next-css ' ) ; module.exports = withfonts ( withcss ( withsass ( { enablesvg : true , webpack ( config , options ) { config.module.rules.push ( { test : /\.graphql < cur > / , exclude : /node_modules/ , use : [ options.defaultloaders.babel , { loader : 'graphql-let/loader ' } ] , } ) config.module.rules.push ( { test : /\.graphqls < cur > / , exclude : /node_modules/ , use : [ 'graphql-tag/loader ' , 'graphql-let/schema/loader ' ] , } ) config.module.rules.push ( { test : /\ . ( eot|woff|woff2|ttf|svg|png|jpg|gif ) < cur > / , use : { loader : 'url-loader ' , options : { limit : 100000 , name : ' [ name ] . [ ext ] ' } } } ) return config } , } ) ) ) ;
i loaded a typescript book to my site to demonstrate our gitbook compatibility . the routes are generated in next.js with dynamic routes using some utility functions from a package i made , < url > we support : content is entirely separate from source code , mdx is loaded via next-mdx-remote from a repository containing only markdown . no modifications required to existing gitbook repositories . adding a new book is as simple as adding a url to a configuration . load files with or without h2 tags in the side navigation ( compatibility with both legacy and modern style gitbooks ) loading files locally ( for developtment ) or from raw.githubusercontent.com provide links to source code on github from each page plans to build a library of educational components and use overridden code blocks with yaml configurations within . < code >
next version : 10.0.3 i created a page solely to test out this problem . it is using the example code on the doc . however , i am still getting this page < code > export default function testredirect ( ) { return ( < div > < h1 > this is redirect page < /h1 > < /div > ) ; } export async function getserversideprops ( context ) { return { redirect : { destination : `` / '' , permanent : false , } , } ; }
is it possible for an api route to detect a full url in the query ? for example i have /pages/api/images/ [ ... url ] .js if i try to go to localhost:3000/api/images/ phofurl it returns a 404 . < code >
hi there . i want to fork < url > repo ( nextjs.org ) . but last few days i ca n't see this repo here . can anyone upload the code here ? < code >
feature request is your feature request related to a problem ? please describe . as reported in # 19426 , there is potential confusion on how getinitialprops works with _app.js and page-level getserversideprops . it 's useful to invoke logic on the server side that will only run on initial page load . auth , for those who wish to serve personalized pages server-side other long-lasting pieces of information , like internationalized site labels logic and queries like this are wasteful if requested on every client-side page transition . while the documentation says that getinitialprops runs client-side on page transitions , it suggests that testing for context.req is a valid approach for preventing logic from running during client-side page transitions . however , this is false in the case of using getinitialprops in _app.js and transitioning to a page with getserversideprops - in this case , getinitialprops will run on the server side . this means that inside of getinitialprops or getserversideprops , there is not a reliable , supported way to tell if the current request is during initial page load , or during a client-side page transition . describe the solution you 'd like one easy solution would be to expose a boolean flag in context that indicates whether the current request is a page transition or not . i 've seen mention of a isdatareq flag before . perhaps this could be exposed . describe alternatives you 've considered i 've noticed that on client-side page transitions , context.req.url always starts with /_next/data , and that could be conditioned upon , but it 's unclear whether this is `` supported '' in terms of something that can be relied upon in future releases . < code >
does anybody know if it 's possible to use ms sql , specifically the azure sql version with normal api routes in a next app when hosted on vercel ? am i right in thinking that api routes are run as serverless functions ? if so , i can find examples on the vercel website about using every database except mssql . there seem to be issues with connection pooling but i 'm not really a db guy so i do n't really got it . if anybody could shed some light in it i 'd really appreciate it . < code >
hi first of all , thank you to the community for all the work done which allowed this framework to be what it is today . in the official doc i found this : `` static generation ( recommended ) : the html is generated at build time and will be reused on each request . '' `` statically generated pages can be cached by cdn with no extra configuration to boost performance '' the statics js files corresponding to the pages have `` cache-control : public , max-age=31536000 , immutable '' and was cached by a cdn . but the static generated html pages have no cache control and are not cached by a cdn . can some one please explain me what i missed ? thank you < code >
i have a function dosomething like i am dynamically importing this < code > // this is working import { dosomething } from `` path '' ; // this is throwing a type error // typeerror : dosomething is not a function const dosomething = dynamic ( ( ) = > import ( `` path '' ) .then ( ( mod ) = > mod.dosomething ) ) ; export const dosomething = ( ) = > { // do something }
feature request consider adding < url > to nextjs ' webpack config . why ? google released a website where you can enter your url and it will estimate kb savings of using 'modern js ' . for my nextjs app , savings were ~9 % . the recommended improvements can be automatically applied using a webpack plugin : < url > i know i can add this manually to my webpack config , but it might be worth considering as a default part of nextjs for best developer experience . blog post with more info < url > < code >
hi , i 'm working on a nextjs app with a custom server using cloudflare as cdn . when i run tests with google insight , it tells me to reduce my server response time . that seemed weird to me because i 'm using getstaticprops . after searching , i found that cloudflare does n't prioritize time to first byte , which could be the culprit . i made a quick deployment to vercel and my app score gained more than 10 points on mobile . so i 'd like to know if there 's a way to use vercel as a cdn only ( like cloudflare ) while hosting my app on my own server . thanks . < code >
i have a variables.scss file where i declare all the sass variables . but whenever i want to use those variables in the .module.scss files , i have to reference them using @ import .. / .. /variables.scss is there a way to make them available throughout the scss files ? i tried importing them in the globals .scss file but it did n't work and i also went through a lot of discussions on github but i ca n't seem to understand it . thanks in advance ! 😄 < code >
the docs state that we can pass a custom loading component to an dynamic import , like so : my question now is : when is this component `` loading '' ? my use case is , that i want to display the loading component , until the imported component is done fetching in useeffect . here 's an example : i know that i can construct internal state in the `` hello '' -component that renders the loading component directly . but i was searching for a more suspense-like approach , where the loading component is passed to the parent ( dynamiccomponentwithcustomloading ) instead of the child tracking state . is this possible somehow ? thanks ! < code > const dynamiccomponentwithcustomloading = dynamic ( ( ) = > import ( ' .. /components/hello ' ) , { loading : ( ) = > < p > ... < /p > } ) const hello = ( ) = > { useeffect ( ( ) = > { // do something // ... // now we are done ! now the loading fallback can disappear ! } , [ ] ) return < div > hello < /div > }
let 's say my getstaticprops reads data from a local file ( e.g . json ) and i start the development server . i noticed that when i then change the json file , the development server notices and does something ( wait - compiling ... event - compiled successfully ) fast refresh is n't triggered on the browser . i understand that monitoring for prop changes ca n't be done in general , but in this particular ( and i guess not too uncommon ) scenario it could be done . so i wanted to ask : is this just not implemented , or have i misconfigured something and it is possible to get fast refresh working with data file changes as well ? < code >
i am building an e-commerce application where there are three pages yet . 1- index.js ( homepage ) 2- products.js 3- about.js ( must be static ) i want 1- how i can fetch categories from the backend on the initial page load and can be used in the whole application in footer as well . 2- how i can fetch products that can be displayed on homepage as `` latest products '' and in products page as well . i know getinitalprops can fetch categories and products in _app.js but it makes the whole application server-side rendered that i do n't want . any solution or trick that does n't make the whole application server-side rendered . < code >
hello , ive been playing with your sample code < url > im trying to add wordpress page functionality at the root level for this , ive been at it 2 days with no luck . has this already been done or is there a simple way to do it ? while the sample says pages , they are just posts by default it is setup to display posts on the home page or with the pages folder , i would like to dynamically add page routes in the root folder so i can display my pages .. a dynamic menu would be nice as well < code >
hi , first off , love for the vercel team and the next.js community . i ca n't say enough good things about the platform . i have been using next.js for a successful web-app and hot reload/fast refresh was so useful that i took it for granted . i started a new developer role a few days ago and did some environmental changes to adapt for work . since then , my hot reload/fast refresh has just stopped working entirely . changes do n't show up even if i refresh the page entirely . only shows changes when i stop the dev server and restart it with 'npm run dev ' . update : # 20284 < code >
feature request please create means to pass options to send when serving static files . in particular , i would like to pass { dotfiles : allow } ( and not use the default that is similar to 'ignore ' , causing a 404 error ) . currently , send is called without the options parameter : < url > is your feature request related to a problem ? please describe . for development , i need to serve static ome-zarr images . each image is represented by a directory structure containing files such as .zgroup and .zattrs : < url > without a means to serve dotfiles , those images can not be served . describe the solution you 'd like i would like to have a property send_options in next.config.js that is passed as a third parameter to send . < code >
i have an app that is using _app.js getinitialprops to fetch user info to render inside of a header . that works good on the first render of the app however if i logout of that user and login with a different user getinitialprops is n't run again so the previous users data is rendered . this seems like there is some sort of caching strategy with the custom app page that i have n't been able to find documented anywhere . anyone know why this behavior is occuring ? < code >
editing webpack configuration in next.config.js is often sufficient for working with nextjs projects , but sometimes you run into an issue where you need to dig deeper into what is happening with webpack . for example , i have some markdown files being loaded by custom webpack loaders and i am trying to figure out why they are n't being watched correctly by the development server . to debug this i need to run : but this errors out as i 'm in a nextjs project & there 's no explicit webpack configuration file . i run into this type of limitation over and over when working with my nextjs projects and am looking for a general solution rather than a hack : how can you access the standard webpack toolset of commands when working with nextjs projects ? ? ? < code > webpack -- watch -- progress
nextjs automatically include < script async custom-element= '' amp-experiment '' src= '' < url > to the page when i using amp-experiment tag on the page , but why amp-experiment-1.0 version ? because of that , i got this error [ amp-experiment ] experiment amp-experiment-1.0 is not enabled because 1.0 version is not stable and not ready for production . also another link pin amp-experiment to v0.1 < code >
i 'm trying to create a dynamic route with multiple params and a fixed string but the router does n't match any routes ... is this even possible or am i doing something wrong ? < code > < rootdir > /pages/ [ foo ] /something-static- [ bar ] .tsx < rootdir > /pages/ [ foo ] /something-static- [ ... bar ] .tsx
hey there , i 'm trying to import some of the javascript libraries inside of my project , but nothing coming successfully . how i can use next.config.js for that ? for example , if i want to use a library like slick-carousel or something like threejs so , how can i use javascript libraries inside of my nextjs project ? < code > module.exports = { / * how i will import the library here ? * / }
bug report hi ! i have a nextjs10 webapp . this works fine in chrome , safari , mozilla , but in ie11 the app doesnt work fine . all my arrow functions dont work . how can i get my application to work fine in ie 11 ? describe the bug in my ie11 browser this section does n't do anything ( in chrome its open , in ie11 do nothing , its an arrow function ) : my next.config.js is system information os : windows 10 browser ( if applies ) ie11 version of next.js : 10.0.3 < code > const withsass = require ( `` @ zeit/next-sass '' ) ; const withtm = require ( 'next-transpile-modules ' ) ( [ ] ) ; // pass the modules you would like to see transpiled , i only need my own code const localelanguages = [ { label : 'en ' , name : 'english ' } , { label : 'es ' , name : 'espanol ' } ] ; // extend your next config for advanced behavior // see < url > let nextconfig = { publicruntimeconfig : { localelanguages } , i18n : { // these are all the locales you want to support in // your application locales : [ 'en ' , 'es ' ] , // this is the default locale you want to be used when visiting // a non-locale prefixed path e.g . '/hello ' defaultlocale : 'en ' , localedetection : true , } , } ; // add the next sass plugin nextconfig = withsass ( withtm ( nextconfig ) ) ; module.exports = nextconfig ;
documented here : < url > it would be very useful for my current use case if the props which are passed through to the loaded version of the dynamic component are also passed through to the custom loading component . my particular use case is for a dynamically-loaded icon . i want the placeholder to be the same size , which means knowing what the size prop passed in was . at the moment i ca n't access that from the custom loading component . < code >
trailing slash issue : when copy paste url `` < url > to browser , it not converting to `` < url > next.js : 9.5.0v already added : its works fine when click a link in my app . but not working when i copy paste . < code > module.exports = { trailingslash : true , }
hi , say i have a notebooks/math/ with pages like notebook/math/1 , notebook/math/2 say up to notebook/math/10 which is the last page . and i have used static site generation ( ssg ) having static paths successfully generate these pages . but say i want the routes like : notebook/math ? page=1 , notebook/math ? page=0 , notebook/math ? page=-1 , notebook/math/-1 notebook/math/abcsdaljdsa to render the same page as notebook/math/1 . additionally notebook/math/10000 , notebook/math ? page=10000 should render notebook/math/10 or whatever the last page is . is there a way to elegantly do this ? i 've seen < url > but it does n't handle all cases and it redirects instead of rendering the same thing given different routes . thanks ! < code >
is there a way to do some kind of component introspection from within getstaticprops so that i can dynamically generate properties based on the inspection results ? for example , it would be really useful to turn the static tweet example into a reusable component . the way i imagine this to work : add < tweet id= { 12345 } / > inside your page getstaticprops ( ) somehow detects that the tweet component is requested and is asking for certain properties . within getstaticprops ( ) logic could be applied to statically generate the component based on the requested parameters . perhaps there already are ways to do this , so please enlighten me if i am overlooking something super obvious . thanks ! < code >
hi everyone , we are using next.js 9.5 and the introduced preview mode . and it works as it 's described , but we would like to use it in a slightly different way . we have 2 environments per project , staging , and production . and when our editors make changes , then we validate always in staging and manually deploy the changes to production . right now they have to enable preview mode first and access then to staging to validate the changes . so basically staging is always used in preview mode to validate existing headless content/last code changes before pushing to production . is there a way to set staging on preview mode by default ? we thought maybe could be useful to : initialize staging server passing a special param to next start script . but we do n't find it . somehow use getserversideprops to consume the data in staging instead of getstaticprops and getstaticprops only in production ? i know we ca n't export the 2 methods have a way to enable preview mode ( call res.setpreviewdata ( { } ) ; ) in normal pages component , instead of only in api routes components , so i can check the environment and enable or disable by default depending on the environment . i think this request makes sense , especially for non-technical users which need to get last copy changes in special environments . thanks in adavance < code >
how can i reduce the bundle size of nextjs app . i have tried dynamic imports but still my page size is not up to the mark . any strategies which can help me reducing the page size ? < code >
we have a page where we sometimes do a redirect in getinitialprops depending on the availability of the requested resource . this mostly works fine using this code : while this mostly works , we have one problem : on client side routing to this page after router.replace ( ) is called , the page mypage is still rendered for a short moment . and now the return { } takes its toll as it might be missing required props . our workaround is to return an explicit prop return { isredirecting : true } that will be used in the react render function to just render nothing : is there a nicer solution that aborts rendering in getinitialprops and just waits for the redirect to happen ? < code > mypage.getinitialprops = async ( { res } ) = > { const props = { a , b , c } ; .... if ( notavailable ) { redirectto ( '/other/page ' , res , 301 ) return { } } return props ; } export const redirectto = ( path , res , redirecthttpstatuscode = 302 ) = > { if ( res ) { res.writehead ( redirecthttpstatuscode , { location : path } ) res.end ( ) res.finished = true } else { router.replace ( path ) } } const mypage = ( props ) = > { if ( 'isredirecting ' in props ) { return null } ....
i have a monorepo setup , let 's say something like this : there are two apps , frontend and admin . both of them share some core functionality , like an auth flow with all it 's dedicated pages , like signup , login , etc , setting up the site layout , redux initialization , styled-components initialization ... you get the idea , there 's a lot of common stuff between the apps . i do n't want to duplicate that logic in both apps , it would be pretty hard to maintain and keep in sync . instead , i would like to use the libraries/common package to handle it all in one place . the basic idea would be to have a function in that library : and this function would create the boilerplate of core of the app , things like the _document.js , _app.js , 404 , the auth pages , etc . i 've done this with a plain'ol spa react app , but with the way nextjs relies on specific files , like pages , _app.js , etc . being in specific places , i.e . it does a lot of magic in the background , i ca n't figure out how to pull this off . so , anyone has any ideas ? < code > packages /apps /frontend /pages /admin /pages /libraries /common /pages // in admin and frontend import createnextapp from ' @ org/common ' ; createnextapp ( { appname : 'admin ' , reducer : reducers ... whatever else } )
i dont know if you heared about shopify storefront api but as vercel released examples for most popular cms 's , i can see headless e-commerce as a thing . shopify already got a react-apollo-example so it only has to be implemented with ssr in mind . what do you think about to generally roll out headless e-commerce examples ? < code >
hi , i cant use link tag for modal route as my requirement is different , few cases are - > analytics on click , user restricted for that route ..... without using link is there any example to implement modal route ? thanks < code >
i 've been trying to reason about how getstaticpaths works , and i 've been struggling a bit . my pages structure is : ... and when running in dev this works ( because ssr ) : but when running a build it fails with a route mismatch : error : requested and resolved page mismatch : //article /article at normalizepagepath i understand that most examples ask you to request your paths at build time , but when you have well over 100k articles this does n't seem optimal . what i would like to happen ideally , is that a page is generated on demand . the confusing thing is , i can get this behaviour to work by providing a single valid slug in the paths array i guess my question is , why is it important that a single asset gets built when running build when using fallback : true ? any help would be appreciated , thanks ! < code > export async function getstaticpaths ( ) { return { paths : [ { params : { primary : 'category ' , slug : 'article-title ' } } ] , fallback : true , } ; } export async function getstaticpaths ( ) { return { paths : [ { params : { primary : `` , slug : `` } } ] , fallback : true , } ; } pages - [ primary ] - article - [ slug ] .js
whenever i include the following in _app.tsx i get a first load js shared by all of 305 kb . whenever i do not include the import i get a first load js shared by all of 116 kb . i use the following npm csrf , which is 12.8 kb unpacked : can someone explain me why the size of the first js load in nextjs is 200kb higher when using the csrf library . < code > import tokens from `` csrf ''
i have deployed a nextjs blog to vercel but whenever i bring the website and then disable the browser javascript , the website does n't show up/work properly . i thought with nextjs everything will be build and send to user so it shows everything even with disabled javascript ! ( i 'm using css-in-js and sanity ) website repo < code >
i 'm using next/image , the src is updated every 8 seconds ( variable backgroudimg ) . i needed to make a transition effect when it changes , could anyone help ? i tried to use transiction on styled components did n't work . code jsx : styled : < code > < section classname= '' bgwrap '' > < image alt= '' banner '' src= { backgroudimg } quality= { 100 } layout= '' fill '' objectfit= '' inherit '' / > < /section > bgwrap { position : absolute ; overflow : hidden ; height : 110vh ; width : 100 % ; z-index : -1 ; transition : all 1s ; }
how do i render a different 404 error msg depending on the dynamic route ? for example ; path /services/kghjk should show a different error msg from /services/delivery/kghjk the paths for /services/ [ : slug ] not defined in getstaticpaths uses 404.js in this case , /services/kghjk and /services/delivery/kghjk are showing the same 404.js page . but i want to differentiate the 404 based on the route . < code >
i 'm using next/image , the src is updated every 8 seconds ( variable backgroudimg ) . i needed to make a transition effect when it changes , could anyone help ? i tried to use transiction on styled components did n't work . code jsx : styled : < code > < section classname= '' bgwrap '' > < image alt= '' banner '' src= { backgroudimg } quality= { 100 } layout= '' fill '' objectfit= '' inherit '' / > < /section > .bgwrap { position : absolute ; overflow : hidden ; height : 110vh ; width : 100 % ; z-index : -1 ; transition : all 1s ; }
whats the best way to handle running a nextjs server on a different basepath but without using the build time configuration ? i need this because i currently build a docker image of a nextjs app which users can pull and run with different environment variables . it 's impossible for me to know if they run it at a different basepath or not and do n't want them to have to build their own docker images with the added configuration . curious if anyone has found some workaround to set basepath as a runtime env ? < code >
hello community , i was wondering if there is any correct way to redirect the user depending on the existence of a cookie ? i 'm using js-cookie what is the correct way to read the cookie ? if i need to display something on my ui depending on the cookie can i read it directly on my component ? is it readable via getinitialprops ? is it read with javascript ? or through the library methods ? this is my first time using cookies , i have my doubts that is , in the application i currently work , the user must choose between some options ( this option is stored in a cookie ) i would like that when you enter , the app detects if there is such a cookie and take you directly to a home screen of the user or otherwise to another screen of my choice , and also that the user can not move to the `` home page '' or any other route you define . if i do not explain the necessary , i would like to do something similar to what makes duolingo they when entering if already these 'registered ' ( also they use cookies ) it takes to a page of welcome and if i user i want to move via url it prevents to me is done globally ( _app ) ? is the logic by page ? i know i can do redirects in useeffect , or in getinitialprops or create some hoc ( i have no idea of the logic ) i came for help because i am interested in doing it in the right and efficient way greetings ! < code >
hey ! so today , we have a pretty expensive calculation being done and stored in the api side of things , something like this : in ./pages/api/document.ts but when i make a change in the react side of things src/app.tsx the whole cache is flushed and removed . how can i make this cache a bit more persistent ? myexpensivecache takes over a minute to resolve as a promise . < code > const myexpensivecache : promise < { [ key : string ] : somevalue } > = calculateexpensivecache ( ) const document = ( ) = > { const cache = await myexpensivecache return res.status ( 200 ) .json ( cache [ req.query [ 'key ' ] ] ) } export default document
repro : < url > steps to reproduce npm ci npm run build npm start inspect button component when button is used by _app.js and a page it 's css is duplicated . observations button is a basic component with css module happens only on production build is this expected behaviour ? < code >
hey guys ! so i have my working website deployed with vercel at the link : < url > what 's kicking with me is that i have two specific routes that are working fine in localhost but if you would go to check them out in the link above , it pops a 404. you can check my repository to dive a bit deep in how i 'm calling these pages out , it 's in /pages/index.js . they are the ifood.js and rapiddo.js ones . does anyone have any idea what 's going on ? i 'm a bit clueless since the other pages are working just fine and the code has n't any typo . kinda confused here . the weird thing is that the pages files locally here are named like i 've written above : ifood and rapiddo . but if you see at the repository , both are lower case . i 'm guessing maybe that 's simply it but i have no clue why this mess of names is happening . < code >
i am using next-auth with the progressive-web-app example , but authentication does n't work on ios . i created a repo which is the simplest combination of these two examples . it 's available at pwa-sage.vercel.app . i found a solution in another repo , but i am unable to successfully implement it . the problem is described in this article . what i understood is that safari does n't handle redirects like other browsers thus breaking oauth . what exact changes do i need to make in manifest.json or application in order to use next-auth with progressive-web-app and still have oauth working in ios ? i do n't mind removing all pwa support in ios devices . < code >
recently , i had to add a sitemap and an rss feed endpoint to my blog which is built with next.js and uses sanity as the content backend . the tricky part is to deal with next.js dynamic routes and serialize the contents . i wrote about how i approach the problem and solve it . it should be applicable if you are using mdx or other cmss . basically , what i did is that i created a postbuild script that searches for any pre-rendered html files inside the output pages directory and parses the files using cheerio to extract the data . the data will then be used to create sitemap.xml and feed.json which will be written to the output static folder . lastly , i configured the vercel.json file to route the requests to /sitemap.xml and /feed.json to the corresponding files in the static folder . full post : < url > gist : < url > it might be an overkill solution so please share your feedback with me . i would love to learn how you approach the problem . 😉 < code >
hi all , i 'm trying to update my next.config.js file with a custom output path that will move the generated static files into a separate folder for deployment . here 's my attempt below , i 've been getting errors of either `` no such file or directory , open '/test/deployfolder/.next/server/pages-manifest.json ' '' or the module for the project 's pages js files can not be resolved . < code > const path = require ( `` path '' ) ; const { cleanwebpackplugin } = require ( `` clean-webpack-plugin '' ) ; const { merge } = require ( `` webpack-merge '' ) ; const { phase_development_server , phase_production_build , } = require ( `` next/constants '' ) ; module.exports = { sassoptions : { prependdata : ' /// scss code that you want to be /// prepended to every single scss file . @ import './variables ' ; ' , } , webpack : ( nextconfig , options ) = > { const { ... config } = nextconfig ; console.log ( `` webpack config : `` , config ) ; console.log ( `` webpack options : `` , options ) ; const productionconfig = { mode : `` production '' , plugins : [ new cleanwebpackplugin ( ) ] , output : { path : path.resolve ( __dirname , `` .. /test/deployfolder/ '' ) , } , } ; const updatedconfig = merge ( config , productionconfig ) ; return updatedconfig ; } , } ;
hi . we have an application that uses the openapi generator ( < url > ) . the generation has an url from the backend and generates some files including a runtime.ts in the maindirectory . in this runtime.ts file is the url of the backend export const base_path = `` < url > '' .replace ( /\/+ < cur > / , `` '' ) ; this works as expected . the trouble start on production deployment : we want to set the backend url as environment var to support smooth deployment for every server and teammember ( for testing ) the plan is to replace to string with process.env.next_public_base_path and use the content of this env var on runtime . the reality is that the variable is replaced on buildtime . is there any way to use the variable in runtime ? things i tried : reading about envvars on < url > reading about runtime config : < url > this does n't work publicruntimeconfig : { next_public_base_path : process.env.next_public_base_path , } , i tried to access the variable inside a page without success < code >
i 've already tried these solutions : proxy all api calls with api route to attach a cookie on the server-side to all api calls . custom server.js to inject cookies into code any idea would be appreciated . < code >
for now , i know that is no way provided by the framework to invalidate a static page when you want . the only way is to set an interval of time to revalidate the page every time . i 'm working with some static pages that update their data rarely but when it does i want to ship the page with updates made . i tried a workaround to have an express server running on the same machine with and endpoint that call a function that deletes the desired file from the server . but the page is not generated immediately anyway . it takes a variating number of minutes to regenerate the page . until then it just serves the old page from the memory cache probably . is there any way of forcing the regeneration of a page ? has anyone done that ? < code >
i need to write getssp codes only running on rendering ssr html and no on client side route data request , but getssp running on both and there is no flag for it . but i found when getssp is called for client side routing data , ctx.req.url becomes like/_next/data/development/index.json , i wonder if it is safe to compare ctx.req.url and ctx.resolvedurl < code > export function getserversideprops ( ctx ) { const isssr = ctx.req.url === ctx.resolvedurl if ( isssr ) { // ssr only . } }
according to the next.js documentation , i can use the router push function with a url object to route dynamic paths , like this example : but , when i try use this feature , the next.js router sends the following /post/ [ pid ] ? pid=1 to the browser ( we take for example that the post id is 1 ) , that is , the router does not replace the [ pid ] with the value of the query object . can someone help me ? < code > import { userouter } from 'next/router ' export default function readmore ( { post } ) { const router = userouter ( ) return ( < span onclick= { ( ) = > { router.push ( { pathname : '/post/ [ pid ] ' , query : { pid : post.id } , } ) } } > click here to read more < /span > ) }
bug report describe the bug when running the production build nextjs app inside a docker container , < link > components seem unable to perform a `` client-side transition '' . the page including the bundles are re-fetched , which can lead to several problems . this is issue can be resolved/ mitigated by downgrading to next : 9.5.5. to reproduce create a dockerfile build the docker image docker build . -t app run a container with the image created from said dockerfile : docker run -p 3000:3000 app click any < link > component in the app , and observe the page refetch . expected behavior the page redirection is performed on the client-side instead of a whole page fetch from the server . system information os : windows 10 version of next.js : 10.0.0 version of node.js : 15.4.0 deployment : next start inside docker container < code > workdir /opt copy package.json yarn.lock ./ run yarn -- frozen-lockfile copy . . env node_env=production run yarn build from node : alpine workdir /app env node_env=production copy -- from=build /opt/package.json . copy -- from=build /opt/yarn.lock . copy -- from=build /opt/.next ./.next copy -- from=build /opt/public ./public copy -- from=build /opt/node_modules ./node_modules user node entrypoint [ `` yarn '' , `` start '' ]
i 'm trying to use a js library that requires window , so i cant use the regular import mmenu from 'mmenu-js ' ; syntax . i see that next/dynamic is supossed to help with that , i just feel this syntax is not the most ideal . am i using this as intended or is there a better way ? < code > useeffect ( ( ) = > { const mmenu = dynamic ( ( ) = > import ( 'mmenu-js/dist/core/offcanvas/mmenu.offcanvas ' ) ) ; const offcanvas = dynamic ( ( ) = > import ( 'mmenu-js/dist/core/offcanvas/mmenu.offcanvas ' ) ) ; const screenreader = dynamic ( ( ) = > import ( 'mmenu-js/dist/core/screenreader/mmenu.screenreader ' ) ) ; const scrollbugfix = dynamic ( ( ) = > import ( 'mmenu-js/dist/core/scrollbugfix/mmenu.scrollbugfix ' ) ) ; const backbutton = dynamic ( ( ) = > import ( 'mmenu-js/dist/addons/backbutton/mmenu.backbutton ' ) ) ; const navbars = dynamic ( ( ) = > import ( 'mmenu-js/dist/addons/navbars/mmenu.navbars ' ) ) ; } , [ ] ) ;
using getstaticpaths we can generate static pages at run time with fallback : true . i am testing my application on my local system , i want to know the current number of build pages and their metadata ( build time is taken , size , etc .. ) . how can i do so ? < code >
i did n't found how to put the environment variables inside a folder instead of the root of the next project . it looks very messy with all the env files on the root . < code >
i developed a website with nextjs , and my nextimages were perfectly configured . but when i tested some devices with a larger pixelratio device , like a 150 % zoom on windows , my website got disconfigured . is there any way to develop it in a responsible way , and consider devicepixelratio property device on it ? < code >
i get some data inside getserversideprops and i do n't need to cache that data in server 's inmemorycache . ( i need to get fresh data each and every request to this route ) , so i have updated my query like this i do n't know whether this configuration fetchpolicy : 'network-only ' correct or wrong if i set fetchpolicy : 'network-only ' , as per the docs , apollo client executes the full query against your graphql server , without first checking the cache . the query 's result is stored in the cache . but here , it does not hit the graphql server and returns data from the cache itself . ( to see this i run apolloclient.cache.extract ( ) before executing the query ) i 'm new to nextjs and these things are bit confused for me , if anyone can give me some paths , that would be a great help . thanks ! < code > const { data } = await apolloclient.query ( { query : get_logged_user , fetchpolicy : 'network-only ' , context : { headers : { authorization : parsedcookies.ww_session , } , } , } )
in development mode , when i use getstaticprops and getstaticpaths , with revalidate enabled , the first render of the page does n't have props passed to it . i can then see the getstaticprops called afterwards to fetch the data . is this expected behavior ? do i need to guard against undefined props for all the pages that use getstaticprops ? if i remove the revalidate property , things work as expected and the props are valid from the first request . < code >
i use next.js for a static site , but after updating the content/style i have to trigger a reload to get the new content . is it able to add a custom query string for all the http requests ? maybe just the current project version like ? v=1.2 or a timestamp ( for example the buildtime ) . _next/static/chunks/commons.ae223a8c3795e3142689.js to _next/static/chunks/commons.ae223a8c3795e3142689.js ? v=1.2 or is there an other solution ? thanks ! < code >
allow specifying different tsconfig.json files for build , dev etc . is your feature request related to a problem ? please describe . unless i 'm missing something it appears that the tsconfig path is set statically . it appears to be at the following line . next.js/packages/next/build/webpack-config.ts line 307 in 5b89b1b const tsconfigpath = path.join ( dir , 'tsconfig.json ' ) describe the solution you 'd like while this may be sufficient for typical use cases it 's a bit cumbersome for more advanced scenarios . it might be best to set this as an env or as an option in next.config.js . the config route might be most flexible but a couple env 's would work just as well . describe alternatives you 've considered for now we 've just wrapped the next build and next dev commands and spin up a process where we simply overwrite the root tsconfig.json . however this seems silly given the fact using multiple tsconfig files is fairly common . additional context while more flexibility as described above i 'm not void of the fact that as simple as this might be in the plain ts world it may not be in the grand scheme of all things nextjs . in short simply being able to respect a `` 'tsconfig.build.json ' if it exists with fallback to tsconfig.json when building would resolve a great majority of the concerns . while not certain the above would seem to be accomplished in a check of the buildid and the existence of the tsconfig.build.json path . this seems trivial . what am i missing ? ? ? after all the vast majority simply want to exclude tests , examples and such as described here . # 11113 ( reply in thread ) < code >
hello there . i have a simple mailer api set with nodemailer . i read the docs regarding the best practices regarding where to place apis , but i am still not sure about some details . this is my setup : i have a handler with axios on the client side in a components folder : on pages/api i have the following files : contact.js - > holding the nodemailer setup key.json - > holding my api keys i import key.json inside contact.js to get my api keys in order to use nodemailer . is this a safe way of placing my api keys ? in case you guys want more info i can paste my code here . thanks in advance ! < code >
i can see that getserversideprops being run when ssr happens . however is this function supposed to run on browser side as well when you do pure client-side navigation to that page ? what function should be used for client-side navigation dynamic data fetching ? < code >
i was following a tutorial to optimize the images in my portfolio . with the new next/image component the next-optimize-images package is not more required for the blog , but there is still a feature we would like to use : pre-loaded images : one of lquip-loader or image-trace-loader . lquip shows a blurred image of the main colors first while the image loads ( like google images ) . trace shows an svg outline of the image before loading the image ( like kent 's blog ) . we were using the lquip-loader to get a beautiful transition while the images are lazy-loaded : a very smooth transition between a pixelated image and the last one . unfortunately , it requires to use of a custom loader and a preview image , a different workflow to be used . it could be great if we could use this kind of animations with the next/image component . what do you think ? < code >
currently , i 'm building a browser extension using next.js . to deploy the extension i 'm using static exports as per the idea in # 2096 ( comment ) . however , since browsers do n't support loading pages through the http-server , during development i need to generate a new build for every code change . is there any webpack config change i can make that 'd let me generate html files during the development itself so that i can get fast refresh / any other kind of live-reload during the development stages ? < code >
is there any way that the new image component can pick the optimized size for an image based on the width of the image 's parent container rather than that of the device ? so that if an image is contained in a 400px element , the smallest size would be picked even when viewing it from a desktop computer . hope this makes sense . < code >
assuming exclusive use of getstaticprops and getstaticpaths ... json data for a page is included in separate json file for link prefetching . the html file built by the next.js ssg build includes the content rendered directly in the html already . what is the need for the json data for the props to also be included inline ? thus increasing the html file size etc . i know passing only truly needed/minimal props would reduce the data size , but why in included inline in the first place ? unless we are doing something wrong ? < url > < code >
hello ! i 'm trying to image optimize my ecommerce site which has images from 200+ domains . unfortunately when trying to add all 200+ domain , i get this error : `` error : specified images.domains exceeds length of 50 , received length ( 209 ) , please reduce the length of the array to continue. '' . am i able to bypass this maximum 50 rule ? < code >
the next/link docs say `` pages using static generation will preload json files with the data for faster page transitions '' does trigger static regeneration ? or just fetch the static data ? also , what does it mean , and what are the benefit/downsides of , preloading the json files as opposed to the entire page ? i know that for static generation the data part of data fetching methods are sent as json , but why not preload the entire page if it is just static html ? < code >
i 'm using next.js to build a ssg website . in development mode i run the site with npm run dev but it seems the index pages rerun the getstaticpaths on every page visit . so e.g . going to the employee list page getstaticpaths is executed which is expected . then when going to a employee detail page and back to the employee list page getstaticpaths is called again . as the getstaticpaths takes a couple of seconds it gives a very sluggish developer experience ... is there a way to avoid getstaticpaths to be executed every time < code >
feature request i have images with different sizes so it 's difficult to determine the exact height and width of all images . for example : adding ( container width ) images to article . usually , what i do is set the image width to fit the main article container width . this also takes care of height so i need not separately provide image height . how can i do that using next/image ? right now i need to provide both width and height of container , ca n't we auto set the height if width is provided by container div ? something like this should auto set the height : < code > < div style= { { position : `` relative '' , width : `` 600px '' } } > < image src= '' /og.jpg '' alt= '' picture of the author '' layout= '' fill '' objectfit= '' contain '' / > < /div >
i am using brotli-webpack-plugin to generate brotli files & express-static-gzip to serve the files . webpack is generating the files but server is not serving the brotli files instead returns the gzip files . in next.config.js in server.js can anyone help me in this ? < code > conf.plugins.push ( new brotliplugin ( { filename : `` [ path ] .br [ query ] '' , test : /\.js < cur > |\.css < cur > |\.html < cur > / , threshold : 10240 , minratio : 0.8 , } ) , ) ; .use ( `` / '' , expressstaticgzip ( build_dir , { enablebrotli : true , index : false , orderpreference : [ `` br '' ] , } ) , )
feature request is your feature request related to a problem ? please describe . i have recently demonstrated next 10s i18n feature as it is something that my organization will make use of . however in testing it some of our dev team were surprised that it was showing the locale of their os rather than their actual location . we compared what we were doing with what msn.com appears to do . they appear to be using geoip for their redirection . describe the solution you 'd like a means by which a function could be specified under the next.config.js file that would overwrite how locale is determined < code >
feature request is your feature request related to a problem ? please describe . correct of apollo w/ next.js is challenging , especially for developers new to one or both technologies . completing the matter , the recommended approach has been in flux ( e.g . # 11957 ) and many examples found elsewhere differ from the approach currently presented in the with-apollo example . describe the solution you 'd like adding some additional comments to the example 's apolloclient.js would be really helpful . it already has some great comments to help us understand what 's going on , however some parts of the apolloclient.js code are uncommented , and as a new user of both of these frameworks i 'm still scratching my head a bit trying to understand what 's happening and more importantly , why . examples : export function initializeapollo ( initialstate = null ) when should we pass initialstate ? export function addapollostate ( client , pageprops ) export function useapollo ( pageprops ) these functions are n't commented . comments explaining this code would be really helpful for us newbs . describe alternatives you 've considered digging through github issues and project documentation . additional context < code >
env variables in next.js apps are set during build time , that means that when promoting app on heroku from dev to staging , and from staging to prod , it will always use env variables from dev . in the past , i used publicruntimeconfig , but it requires getinitialprops which i do not use anymore . any other ideas how to solve this ? < code >
hello ! i tried to find a similar issue on our forum , but did n't find anything related . what is happening is that when i follow the integration steps described here : < url > i get material ui working successfully with nextjs , however , if i need to click a link to go to another route , the app experience a long loading time for the first time . the second time you try to reach to the same url , the app loads normally as expected . i have pushed a short example in this repo : < url > after running yarn dev , you can access localhost:3000 in your browser . there 's a link for the /cart page . which shows just a few shopping cart related info + a material ui icon . very simple . when you click the 'cart ' link for the first time , the page hangs for a while and only then we get redirected . if you go back to home and click the same link again , then the app redirect you immediately . this app is pretty basic , but when i have a larger app , the waiting time gets annoying . is there a fix for it ? one thing that i noticed is that , if my /cart route does not have any reference to material ui then the problem does n't happen . also , looks like next is trying to load the respective /cart script on demand , in other words , only when user tries to click the cart link . let me know if more details are needed ... i 'm struggling to find a fix for this ... thank you < code >
i 've been away from next.js for a bit and i 'm finding this a bit confusing . it seems like my pages get rendered before getstaticprops is called , which causes quite a lot of problems since a lot of context values are undefined on first render . on a simple page composed by : my console logs will be : is this what 's supposed to happen ? surely the my page should n't render if all the props passed to it are undefined ? how do i handle hooks that ca n't be conditionally rendered if i still want to mantain ssr and static exporting ? < code > export default function serverpage ( props ) { console.log ( `` props are '' , props.params ) ; return test ; } export async function getstaticprops ( context ) { console.log ( `` params are '' , context.params ) ; return { props : { params : context.params.id } , } ; } props are undefined params are { id : ' 2 ' } props are 2
feature request is your feature request related to a problem ? please describe . when using a third-party library with /api a user could miss the fact that the library uses body-parser internally ( happened with graphql ) describe the solution you 'd like we should set req._body as body-parser checks for it describe alternatives you 've considered this can be avoided by setting config to : however , it 's very easy to mix , so a check for it would be nice additional context otherwise , body-parser just seems to hang < code > export const config = { api : { externalresolver : true , bodyparser : false , } , }
i 'm using next-transpile-modules to transpire threejs and bs-platform ( rescript ) . i would like to know if it is possible to replace next-transpile-modules with the webpack function in next.config.js trying out something like this < code > module.exports = { webpack : function ( config , { defaultloaders } ) { const resolvedbaseurl = path.resolve ( config.context , './ ' ) ; let include = transpilemodules.map ( ( m ) = > ' < cur > { resolvedbaseurl } /node_modules/ < cur > { m } ' , ) ; config.module.rules = [ ... config.module.rules , { test : / ( ? ! ( @ . * \/ ) ? ( bs- . * |reason- . * ) \/ ) .+\.js < cur > / , include , use : defaultloaders.babel , } , ] ; return config ; } , } '' ' but still get the warnings of 'syntaxerror : can not use import statement outside a module '
i have a project with the following stack : react , next , styled-components , redux , saga . currently the project is ssr , and i 'm override the _document and the _app files . i want to change the project to be static site rendering , but i 'm not able to do it , because i 'm getting this warning : warning : you have opted-out of automatic static optimization due to `` getinitialprops '' in `` pages/_app '' . this does not opt-out pages with getstaticprops ' my _app file does n't has getinitialprops , but it has hoc of withredux and withreduxsaga that contains getinitialprops . is there any way to make ssg with redux and saga ? < code >
i just want to redirect my next js client app to open with https : // forcefully without using any custom server . the reason is if i use custom node server i 'll loose all my next js optimizations and seo related things . is there any way to redirect my app to https without custom server ? < code >
hey , is there any way to prevent or redirect if user try to direct download static files in public directory ? e.g . images , font files . i 've been use `` redirect '' method on next.config.js , but all static files can not be download by the app . reference from this discussion # 11899 < code >
hi all , i 'm currently writing something akin to a browser extension that ties in with a site that i 'm working on and that uses the same repo . i wanted to make sure that i 'm understanding the documentation correctly . the readme for the example of a project with zones states : all pages should be unique across zones . for example , the home app should not have a pages/blog/index.js page . the docs also state that pages must not overlap . i understand that i ca n't put zone b in the pages directory of zone a. but is it okay to have a zone within a zone as long as the pages and static files do n't conflict/overlap ? for example , can i have a src/pages and src/next.config.js for the website and also a src/extension/pages and src/extension/next.config.js for the extension ? or is it not okay for one to be the child of the other ? i really appreciate the help . thanks . kind regards , jacob < code >
hi , i 'm trying to understand what is happening but even look at the source code i found an answer . i 'm in a single nodejs server , the site is on production with about 30k pages and i 'm using the isr feature for all of them : i made a lot of tests and i saw that pages with fallback enabled ( true or blocking is the same ) are n't never updated if their time is > = 60. i have a test site too and in this low loaded process all works fine ... so the problem happens with an high loaded nodejs process . the strange things is that if i set the revalidate time to 10 seconds , the page is revalidated ... maybe not exactly after 10 seconds but the regeneration process works for it . to test i print a console log with a date created on the getstaticprops method and for the `` immutable '' pages this value still the same obviously ... i saw that under the hood you use an lru cache of 50 mb for the incremental check ... so if i set a bigger revalidate time maybe this cache increase until the old entries are deleted and not revalidated because out of cache ? thanks ! < code >
hi guys , its possible to update an .json file that lives in vercel ? if yes how i can do that ? i have an .json file on /public folder that i need to update when in post /api/currency is requested . on localhost works , but in productions did n't work and returns : task timed out after 10.01 seconds . < code >
bug report describe the bug when running a production build of next.js with next/image implementation inside a docker container with low memory allocation ( ~300 - 500mb ) the excessive image processing triggers oom and the process is killed . the cache is cleared and the process starts all over again . to reproduce build production app run app inside docker container with 300-500mb allocated resources ( 0.5 vcpu ) access site ( subject to server configuration , and whether running locally or remotely ) see memory increase until process killed . expected behavior the application should not consume excessive resources . my thoughts : the loader should use queueing ( if not already ) to prevent excessive consuption of resources ( or at least provide the option ) . there should be an option to define allocated system memory ( as passing the `` max_old_space_size '' parameter to either build or run scripts does not work ) . screenshots if applicable , add screenshots to help explain your problem . system information os : linux , ec2 , docker chrome version of next.js : 10.0.3 version of node.js : node : latest ( unsure how to access exact version ) deployment : next start additional context add any other context about the problem here . < code >
dear community , in our project we are using nextjs . we also need to use the custom server as documented here : < url > ( as server library we did use express . reasons are request logging and additional request handlers not being served by nextjs ) to configure nextjs we have used the standard way via .env.development / .env.production / ... as documented here : < url > the challenge we are now facing is , that the express code uses other environment variables as nextjs does . for example we set the log_level in the .env.development . however , the logger in express does not know about the value we used is there a concept for nextjs if you want to use the custom server and need the same environment variables as in your nextjs code ? thank you in advance < code >
feature request i would like for my pages to be statically optimized but have the document not be . is this possible ? is your feature request related to a problem ? please describe . i have custom `` feature gating '' in my application that requires a global variable be set before any scripts are run ( eg : window.features = { ... supportedfeatures } ) ( features are fetched from api route ) . i would like to be able to access that variable even on `` statically optimized pages '' , eg : no dependency on getinitialprops . from my tiny understanding this seems like it should be possible ( without creating a custom server to inject it into the html ? ) ? describe alternatives you 've considered i could set an empty function for getinitialprops inside _app ( so that _document getinitialprops is still called ) however ( correct me if i 'm wrong on this , if i am then you can close this issue ) that means we will attempt to ssr every page on every request ? when really they 're not going to change across requests ? < code >
i currently have a graphql-yoga , prisma , nextjs , mongodb app using apollo client-side . i want to update a document when a timer ends . any idea how ? thanks ! < code >
hi everyone , i am using monorepo for my project structure . i have components as different packages for re-usable react component and other utils . when using components in my app packages , nextjs can parse .tsx react component but it can not parse .ts or .js file from components . any idea , how to fix such issue ? < code >
feature request is your feature request related to a problem ? please describe . when building nextjs in ci or locally , external api : s might be called , making the build success dependent on external factors . this makes building locally without keeping for example api-keys that are meant for live environments impossible . describe the solution you 'd like the ability to generate static content in runtime only . the revalidate property of getstaticpaths already has the behaviour i 'd like , only it should allow for being completely turned off in the build-step . effectively using the incremental static rendering , but starting from scratch in runtime . describe alternatives you 've considered there are n't any really . < code >
hey , i 'm new to nextjs and just having a flip through the docs when i saw this : < url > there is a function : further down it refers to this as a 'pure function ' : in my view , this is certainly not a pure function ( and indeed in wikipedia 's view < url > ) , as it violates the following : because it mutates the res and options objects in reference . is there some unique javascript/nextjs definition of this term that i 'm not familiar with ? < code > // calling our pure function using the 'res ' object , it will add the 'set-cookie ' header setcookie ( res , 'next.js ' , 'api-middleware ! ' ) export const setcookie = ( res : nextapiresponse , name : string , value : unknown , options : cookieserializeoptions = { } ) = > { const stringvalue = typeof value === 'object ' ? ' j : ' + json.stringify ( value ) : string ( value ) if ( 'maxage ' in options ) { options.expires = new date ( date.now ( ) + options.maxage ) options.maxage /= 1000 } res.setheader ( 'set-cookie ' , serialize ( name , string ( stringvalue ) , options ) ) } its evaluation has no side effects ( no mutation of local static variables , non-local variables , mutable reference arguments or i/o streams ) .
i 'm trying to dynamically import a custom hook which loads state from local storage . hooks/userstatewithlocalstorage.tsx components/calculator/calculator.tsx i 'm getting a typeerror : usestatewithlocalstorage is not a function or its return value is not iterable < code > ... const usestatewithlocalstorage = dynamic ( ( ) = > import ( ' .. / .. /hooks/usestatewithlocalstorage ' ) , { ssr : false } ) ... import react from 'react ' const usestatewithlocalstorage = ( localstoragekey : string , defaultvalue : any = `` ) : [ string , react.dispatch < react.setstateaction < string > > ] = > { const [ value , setvalue ] = react.usestate ( localstorage.getitem ( localstoragekey ) || string ( defaultvalue ) ) react.useeffect ( ( ) = > { localstorage.setitem ( localstoragekey , value ) } , [ value ] ) return [ value , setvalue ] } export default usestatewithlocalstorage
feature request is your feature request related to a problem ? please describe . our dashboard app integrates with many other applications . each application controls their own routing logic , some of these applications have routes that may or may not have trailing slashes , and some apps have hashtags early in the url . e.g . app/1/some/route1 app/2/some/route2/ app/3/ # /some/route1 app/4/ # /some/route2/ app/5/ # /some/route1 ? theme=dark app/6/ # /some/route2/ ? theme=dark this is currently a blocking issue for our team as the url a user provides should be preserved , and should not be mutated as it currently is . if a user navigates to app/4/ # /some/route2/ we would expect the url to remain as such , but instead the url is modified to app/4 # /some/route2 . this causes the incorrect route to be displayed for our integrated apps . describe the solution you 'd like an issue has already been raised for handling dynamic trailing slashes here : # 15148 the url syntax provided should be respected and not be mutated , as such the leading slashes before hashtags should not be removed . i.e . app/3/ # /some/route1 should not be mutated to app/3 # /some/route1 . additional context examples of these use cases can be found here : < url > < code >
can anyone guide me how can i configure my nextjs app to work with pm2 ? i am using this command but it throws error . pm2 start yarn -- name `` myapp '' -- start < code >
hello team , i really enjoyed next 10 image optimization feature however , i can not progressively load ssr images with suspense api . i would appreciate if you could add progressive image loading feature . my images urls are loading with cms . regards , punit diwan < code >
it 's about the next/amp , i want to develop with the amp regulation , however , i do n't want nextjs to add the `` amp '' attribute to the html tag . the reason is that i do n't want my page to be cached by google search . according to the amp site , if i want my page to opt out of google cache , i need to remove the `` amp '' attribute from the html tag . < code >
anyone know the recommended approach for modifying the a tags that get generated by [ ] ( ) expressions in mdx files ? for example , i 'd like to add target= '' _blank '' to certain links . < code >
hello ! 👋 i 'm following the nextjs tutorial , and i 'm a bit stumped at the `` implement getstaticprops '' section . getstaticprops is running , and returning the sample markdown blog data , but the props are not being passed to the component . the console.log in getstaticprops has data , but the console.log log of allpostsdata in home emits undefined : i 'd be grateful if someone could help me understand what i 've done wrong ! my code so far has been pushed to < url > thanks , grant < code > import head from 'next/head ' import layout , { sitetitle } from ' .. /components/layout ' import utilstyles from ' .. /styles/utils.module.css ' import { getsortedpostsdata } from ' .. /lib/posts ' export default function home ( { allpostsdata } ) { console.log ( 'home ' , allpostsdata ) return ( < layout home > < head > < title > { sitetitle } < /title > < /head > < section classname= { utilstyles.headingmd } > < p > music and code guy. < /p > < /section > < section classname= { ' < cur > { utilstyles.headingmd } < cur > { utilstyles.padding1px } ' } > < h2 classname= { utilstyles.headinglg } > blog < /h2 > < ul classname= { utilstyles.list } > { / * omitted map over allpostsdata here as weirdly it does not exist * / } < /ul > < /section > < /layout > ) } export async function getstaticprops ( ) { const allpostsdata = getsortedpostsdata ( ) console.log ( 'getstaticprops ' , allpostsdata ) return { props : { allpostsdata } } }
feature request is your feature request related to a problem ? please describe . update reasonml example to track latest version of reasonml , rescript , as well as synchronize with typical settings that the community is using . describe the solution you 'd like delete with-reasonml and with-reasonml-todo . add with-rescript . use a combination of settings that one can observe in < url > and < url > preferring rescript-lang.org when there is conflicting guidance . essentially , start from rescript-nextjs-template , remove tailwind and getserversideprop binding and usage . describe alternatives you 've considered n/a additional context n/a < code >
custom server express when i try use @ zeit/next-sass and import import ' .. /sass/app.scss ' in _app.js i got this error : same error i can get if i use import ' .. /sass/app.scss ' in pages/index.jsx ./next.config.js < code > const withsass = require ( ' @ zeit/next-sass ' ) const withcss = require ( ' @ zeit/next-css ' ) const nextconfig = { usefilesystempublicroutes : false , webpack : ( config , { isserver } ) = > { config.module.rules.push ( { test : /\ . ( jpe ? g|png|svg|eot|woff2 ? |ttf ) < cur > /i , use : { loader : `` file-loader '' , options : { name : `` [ path ] [ name ] . [ hash ] . [ ext ] '' , publicpath : `` /_next/static '' , outputpath : `` static '' , emitfile : ! isserver , } , } , } ) ; return config ; } } module.exports = withsass ( nextconfig ) error - ./src/sass/app.scss typeerror : can not read property 'tapasync ' of undefined
hi all , we currently use cloudinary for hosting all of our images but it seems that next/image has some useful additional optimizations . my worry is that doing all the extra image optimizations on our server ( which i assume next does using some kind of nodejs module ) will put even more strain on our server and that we should stick to serving them from a cdn . anybody got any experiences in production so far ? < code >
feature request describe the solution you 'd like change strict default value in tsconfig.json from false to true . it is recommended by typescript < url > < code >
i have about 2000 static pages and just a few added each day . are there any other platforms besides vercel that supports that ? i looked a netlify but that was not clear on there site . any way to support this in a docker container ? < code >
is there a good way to disable static optimization for 404 pages ? or make the 404 dynamic ? i 'm trying to address this issue this is because next will run the getinitialprops query even for the 404 , however it is run during bundle/build time . < code > given i have a custom doc ( _document.tsx ) and the document uses 'getinitialprops ' and 'getinitialprops ' requires an env variable 'targeturl ' when i run 'next build ' and i the env does not contain variable 'targeturl ' then the build breaks
hey there ! how can i get the the compiled styles ( the output of import `` .. /styles/global.scss '' ; in _app.js ) as a string to import them in another js-file ? for the preview iframe of netlifycms i need the compiled global styles . thank you for your help < code >
hi everyone , i 've build a new ecommerce site using next and statically build category pages and product pages . i use next 's < link / > component for the links and only have the href prop on that . when crawling the site , however , all the paths/links from the category are to .json files . i see from the docs that it 's normal prefetching behaviour , but i 'm a bit worried that search engine crawlers will see the same . what 's the correct way to handle this is in terms of seo ? thank you ! < code >
is there a way to generate sourcemaps for files under /_next/static/chunks/ * ? i 'm receiving errors like this in rollbar : i have followed some instructions and have most source maps uploading to rollbar correctly like so : however the ones under _next/static/chunks/ do not seem to be generated or uploaded to rollbar ( yellow in screenshot error in rollbar , unable to find matching sourcemap for reported error ) ? i found this discussion which mentioned static/chunks but unsure if that 's related to my issue here : # 7579 cheers < code > error : failed to execute 'insertbefore ' on 'node ' : the node before which the new node is to be inserted is not a child of this node . at e ( phofurl at e ( phofurl at mo ( phofurl
i opened an issue for this as a bug # 19714 , which i 'm pretty sure is correct , but i 'm sharing it here as well in case someone has ever encountered this situation before and found a work around . tl ; dr i ca n't get preview mode to work in production because getstaticprops never gets called even though the preview cookies are set . here 's a synopsis ( i 'm doing this with prismic cms ) 1. from the prismic editor ui , the user clicks on the preview button which redirects to 2. prismic then redirects to 3. the api/preview endpoint then gets the redirecturl from prismic and redirects to /redirecturl , setting the next.js preview cookies . i am able to load the page in preview mode immediately after deploying and rebuilding the app to the server ( digital ocean app platform ) . however , if i leave preview mode and load the page again , i am no longer able to view it in preview mode afterwards . successive attempts redirect me to the correct page with the cookies set , but without getstaticprops getting called . on localhost , bizarrely , it works fine on firefox but not at all on chrome . any help with this would be hugely appreciated ! < code > < url > set-cookie : __prerender_bypass=391b9dd5be2db3f82d091836f424ccd3 ; path=/ ; httponly ; secure ; samesite=none set-cookie : __next_preview_data=eyjhbgcioijiuzi1niisinr5c ... ; path=/ ; httponly ; secure ; samesite=none < url >
lazy static pages regeneration current cons of getstaticprops in the current approach , when we use getstaticprops to get information coming from the backend , we use the revalidate property to build and serve the updated pages . but , this approach assumes some regularity in the page 's content modification . as an example of the problem , i used to work for an e-commerce platform that creates websites for multiple companies , holding their product informations in our databank . in the current approach of getstaticprops , we need to assume some amount of time which all products pages would be updated , even though most of the products information was almost never updated . but , in our case , we could n't just let the revalidate value be a big , because the companies products information in the e-commerce ca n't be so outdated . on the other hand , if the revalidate value was small , we would n't be using all the laziness potential of next . proposed solution maybe , a valid approach to this problem is creating a put route in the next server which the backend could inform the need to regenerate certain pages . example of request : this approach would let developers to rebuild pages just when needed . furthermore , we would stop guessing what is the perfect revalidate time amount . < code > put < url > body : { key : 'auth_key ' , pages_to_revalidate : [ '/ ' , '/products/1 ' , '/products/2 ' ] }
question since i do n't want to show the loading state , i need to call the api in getserversideprops , but the problem is jwt is storing in the local storage and using ssr is not possible to get it . should i change the api to use cookie ? or js-cookie might help ? what is the correct way to implement the authentication ? the current way of authenticating user in my project . problem : keep showing loading on refresh < code > export default function ( { component , pageprops , router } ) { const { data , isloading } = useme ( ) ; if ( isloading ) return `` loading '' ; const isadmin = data ? .customers ? . [ 0 ] .role_ids ? .includes ( 1 ) ; const c = < component { ... pageprops } / > ; const rendercomponent = ( ) = > { if ( router.pathname.startswith ( `` /admin '' ) & & isadmin ) { return < adminlayout > { c } < /adminlayout > ; } return < basiclayout > { c } < /basiclayout > ; } ; return ( < reactquerycacheprovider querycache= { querycache } > < hydrate state= { pageprops.dehydratedstate } > { rendercomponent ( ) } < /hydrate > < /reactquerycacheprovider > ) ; }
i 'm trying to debug an issue that i 'm having with next.js , so i 've cloned the canary branch and am following the instructions in contributing but am unable to install the dependencies . at a certain point after running yarn , lerna executes which triggers a cascade of typescript errors : followed by : < code > < cur > tsc -- declaration -- emitdeclarationonly -- declarationdir dist lerna err ! yarn run prepublish stderr : error command failed with exit code 2. error command failed with exit code 2. lerna err ! yarn run prepublish exited 2 in 'next ' error an unexpected error occurred : `` command failed . exit code : 2 command : sh arguments : -c lerna run prepublish directory : /mydirectory output : `` . ./ .. /node_modules/ @ types/react/index.d.ts ( 2981,14 ) : error ts2300 : duplicate identifier 'librarymanagedattributes ' . .. / .. /node_modules/ @ types/react/index.d.ts ( 2992,13 ) : error ts2717 : subsequent property declarations must have the same type . property ' a ' must be of type 'detailedhtmlprops < anchorhtmlattributes < htmlanchorelement > , htmlanchorelement > ' , but here has type 'detailedhtmlprops < anchorhtmlattributes < htmlanchorelement > , htmlanchorelement > ' . ...
i 'm trying to create the following url structure : base/ [ .. category ] .js = > e.g . /guides/ { category } / { subcategory } / { subsubcategory } ... base/category/subcategory/ [ slug ] .js = > e.g . /guides/ { category } / { subcategory } /slug where i dont know how many categories/subcategories there are . tried setting the folder to a catch-all ( e.g . '/guides/ [ ... category ] / [ slug ] .js ) , but that 's not allowed . suggestions ? < code >
i 've been wondering for a while if this is possible . i would like to have a single route , eg localhost/ [ posts ] . under this route i would like to have some statically exported pages , eg localhost/slug-1 and localhost/slug-3 , but also be able to catch any 404s for pages that might not be exported and load the data client-side . the idea behind this is to statically generate all my pages every week , but still be able to access pages that exist on my api despite not having been statically generated . would i be able to do this ? how ? < code >
i have a specific use case that requires me to use http instead of https for an api i am fetching with axios . every time i send a request using http as the url prefix in axios , it sends it as https and i believe it has come down to this meta tag : < meta http-equiv= '' content-security-policy '' content= '' upgrade-insecure-requests '' > can i override this default meta tag from nextjs ? i figure i could use next/head or something to do so , but have had no luck playing around with it . < code >
anyone knows how to deal with this error when i yarn build ? i 'm trying to use this configuration to get react-native to work on web ( and it works in dev ! ! ) : < url > < code > info - using external babel configuration from /users/kovkev/project/dev/babel.config.js info - creating an optimized production build failed to compile . ./node_modules/react-native/libraries/newappscreen/components/debuginstructions.js:11:12 syntax error : unexpected token 9 | * / 10 | > 11 | import type { node } from 'react ' ; | ^ 12 | import { platform , stylesheet , text } from 'react-native ' ; 13 | import react from 'react ' ; 14 | > build error occurred error : > build failed because of webpack errors at build ( /users/kovkev/project/dev/node_modules/next/dist/build/index.js:15:918 ) error command failed with exit code 1. info visit < url > for documentation about this command .
✨ next-test-api-route-handler ✨ ( npm ) it 's just an easier way to unit test api routes . does n't replace integration testing or e2e testing with a full next instance , of course , but there are many advantages to unit testing your routes . for one , you can finally include them in your lint-staged/husky pre-commit hooks and tighten that developer feedback loop 🤩 . < code >
completely stumped on this . given a brand new project . yarn create next-app . and this basic script . i get the response : what am i missing here ? it works fine in postman and curl . thanks in advance ! < code > var request = require ( 'request ' ) ; ( async function ( ) { var options = { 'method ' : 'post ' , 'url ' : ' < url > 'headers ' : { 'content-type ' : 'application/json ' , } } ; request ( options , function ( error , response , body ) { if ( error ) throw new error ( error ) ; console.log ( response.tojson ( ) ) ; } ) ; } ) ( ) ; < ! doctype html > < html lang= '' en '' > < head > < meta charset= '' utf-8 '' > < title > error < /title > < /head > < body > < pre > can not post /api/hello < /pre > < /body > < /html >
hi everyone , a few days ago i tried to do a fullstack with next js . so , i made a simple rest api and fetch that api in the ssr component . everything is done easily . but , i have a question , how do you handle data deletion ? i mean with ssr all the records are in props , and as far as i know those props should n't be modified by the component itself which means i ca n't delete the records . my problem is that when i need to delete a record , i need to delete the dom node manually . for example , all records are displayed with a table ui . when i delete records with id=1 , i also need to delete the table rows where the deleted records are displayed . that way , the component wo n't be re-rendered . so when i have logic inside the component like showing `` empty state '' when all records are deleted , the empty state will not be shown . to solve this problem , my workarround is currently passing all the records from props to the state component when the component is constrcuted . i used getinitialprops for data fetching . and made me used to storing data in props . is this good or is there some other way to solve this problem ? thank you ! < code >
hi , i have tried follow this tutorial to write data to google sheets . however , when i tried to do the following : import { googlespreadsheet } from `` google-spreadsheet '' ; i get the following error ./node_modules/google-auth-library/build/src/auth/googleauth.js:17:0 module not found : ca n't resolve 'child_process ' null i 'm not really sure why am i getting this error . is there a way to go about this ? thanks ! < code >
hello , guys i know that might not be the place to ask these questions i have added a question on stackoverflow but it could be from next.js not from firebase so i wonder if anyone had a similar problem ? thanks < code >
i 'm having trouble with static exporting . when running in development mode , i can visit example.com/contact-us , and that will render the correct page . however , after exporting the page example.com/contact-us will return a 404 error . this is caused by next.js creating a /contact-us.html file rather than /contact-us/index.html . i tried moving the contact-us page in /pages/contact-us/index.js but that has the same output . i can get nextjs to create a folder if i name my javascript file anything but index like so /pages/contact-us/contact-us.js , but that will then output /contact-us/contact-us.html . how can i solve this ? < code >
i read docs but i did n't understand . why database and backend load are low when using incremental static regeneration ? thanks for your comment . < code >
hello , we have a fairly large codebase in the version 9.1.5. we did not have the time to upgrade nextjs versions as they came out and we are behind . is there a way to upgrade to the new version a page at a time so that the newer pages that are being added can use the new next.js version ? not sure if this is relevant or not , but we have an exposed custom server for some custom routing logic which was n't possible in version 9.1.5 . < code >
hi everyone ! i have a question , is it possible to use the image optimization feature with data that comes from an api ? right now i 'm injecting data to my blog that comes from a wordpress rest api and the articles usually have images on them . this data comes as html , i fetch it using getstaticprops , then i just inject it on the react component using dangerouslysetinnerhtml . is there a way to take advantage of the awesome image optimization that was introduced on next 10 , without using the < image / > component ? thanks in advance ! < code >
after upgrading to the latest version of nextjs , all of the svg from font-awesome show up but the css does n't being loaded in the 'head ' section . in the 9.5.5 , we can see the fontawesome stylesheet being injected in the 'head ' section . in the 10.0.3 , the stylesheet is not injected in the 'head ' section . the stylesheet is important to apply some of the helper classes like 'fa-x6 ' < fontawesomeicon icon= '' spinner '' size= '' 6x '' / > nextjs 9.5.5 nextjs 10.0.3 < code >
bug report describe the bug i 'm trying to start a new project . using npx create-next-app . everything downloads , and then i call npm run dev . i immediately get about 100 errors : there are multiple modules with names that only differ in casing . this can lead to unexpected behavior when compiling on a filesystem with other case-semantic . error : invalid hook call . hooks can only be called inside of the body of a function component . this could happen for one of the following reasons : you might have mismatching versions of react and the renderer ( such as react dom ) you might be breaking the rules of hooks you might have more than one copy of react in the same app a clear and concise description of what the bug is . to reproduce steps to reproduce the behavior , please provide code snippets or a repository : 1.npx create-next-app client 2.cd client 3.npm run dev 4.getting all the errors 5.if i open localhost:3000 i have an internal server error . expected behavior the app should start and i should see the default first page . screenshots system information os : [ windows ] browser : chrome , firefox version of next.js : 10.0.1 version of node.js : 13.12.0 < code >
i 'm new to next.js and my use case is as follows : i want to deploy a static site to the vercel cdn , but i also need to make use of request headers before rendering the page . more specifically - i need to use ip data to block some regions from accessing the site and make privacy adjustments based on local laws . technically speaking that means a server side function which runs before loading _document.js . how is that to be done with next.js ? thanks in advance ! < code >
it seems that there 's a bug when trying to test a component which contains a dynamic imported component . the error i get is typeerror : require.resolveweak is not a function . i prepare a repo example - > < url > which is basically the with-jest example to which i add the dynamic component to test and reproduce the error . original discussion : # 18855 ( comment ) @ lfades hi ! this is the third issue i open about this , and every time is being moved here to discussions , while this is a bug : / why is this happening ? : ) < code >
the html img tag works perfectly fine without specifying a width nor a height . it just defaults to displaying the image in the original size . why does the next/image component not work this way ? for me it is really frustrating , because it is a really cool component with optimizations i 'd like to use , but it seems that for seemingly no reason compatibility to the html img is broken . neither using layout='fill ' nor using 'auto ' for width and height are solving the problem for me . < code >
hey , my header has 2 parts . the left side has data that remains unchanged ( departments with products ( men , women , home ) for my e-commerce website ) and i want it to be statically rendered . while the right side has dynamic data ( cart and account info ) and i want it to be dynamically rendered . is there a way to achieve this ? since the header is present on every page , there are a lot of query calls made on each render to our database to render the left side . i want to avoid that . thanks , akshi tyagi < code >
i have typescript submodule as package on yarn workspace . which typescript submodule , i 'm using with import `` some-module-name/lib '' ( which is not `` dist '' js ) and webpack fails to load the submodule package ts . it works fine when i use import `` some-module-name '' ( wich i 'm importuing the dist js ) but this is not what i want . i want to use yarn workspace 's feature , live modify . but using dist wo n't be able to . how do i solve this ? reference : < url > < code > yarn build yarn run v1.22.4 < cur > next build warning : built-in css support is being disabled due to custom css configuration being detected . see here for more info : < url > info - creating an optimized production build failed to compile . .. /packages/client-sdk/lib/url/index.ts 10:42 module parse failed : unexpected token ( 10:42 ) you may need an appropriate loader to handle this file type , currently no loaders are configured to process this file . see < url > | | > export async function makeshorturl ( request : urlshortenrequest ) : promise < urlshortenresult > { | const res = await axios.post ( '/short ' , request ) | const data = res.data as urlshortenresult > build error occurred error : > build failed because of webpack errors at build ( /users//documents/github/console.bridged.xyz/node_modules/next/dist/build/index.js:15:918 ) error command failed with exit code 1. info visit < url > for documentation about this command .
i 'm not able to set 100 % width in the next/image , when set , the width is 100px . i need the width 100 % because the parent is responsive but i do n't know what the width is . < code > < image width= '' 100 % '' height= { 160 } objectfit= '' contain '' layout= '' fixed '' / >
we have created dynamic routes using express in custom server.js file . our url have dynamic parameters . for example below is the url . * * < url > en-kw ( language and country ) men ( gender ) * * but when we build and run on production , i am getting lot of 404 errors in console . get < url > net : :err_aborted 404 please let me know how we can fix this as this is highly customized ? < code >
i decided to change from using next-redux-wrapper to match the with-redux-thunk example to allow static optimization , however it seems like you can not access the store within getinitialprops to initialise the user state on ssr . is there a way to access the store in getinitialprops or should i be using the next-redux-wrapper ? < code >
hi . since i am self-hosting my nextjs-app , i need to use ssl certificates . it seems i am required to use a custom server for this . is this not a common scenario for everyone who wants to host the app themselves ? the documentation about custom servers says you should only use if the router does not meet your requirements , but it 's actually the ssl requirement that forces me to use a custom server . also i had to configure babel and use ts-node , since it 's a typescript project and i want to use es6 modules . am i overlooking something or is this the only way i can configure ssl certificates ? < code >
i need to disable amp on some pages in order to collect metrics/analytics , but if i just set export const config = { amp : true } to false , my whole ui breaks . how can i do this ? is it even possible ? thanks ! < code >
feature request is your feature request related to a problem ? please describe . given i have 2 domains my-site.nl = > nederlands my-site.be = > belgium and i want the following mapping for the locales url locale my-site.be/nl nl-be my-site.nl/nl nl-nl with the current solution i can only have the following mapping : url locale my-site.be/nl nl my-site.nl nl since url prefix matches the locale describe the solution you 'd like i 'd like to be able to setup this i18n mapping : url locale my-site.be/nl nl-be my-site.nl nl-nl i suggest to allow some configuration like this one : describe alternatives you 've considered i considered matching the locale server side with a custom mapper like this : but it 's not as readable & concise as a proper configuration in next.config.js < code > // next.config.js module.exports = { i18n : { domains : [ { domain : 'my-site.be ' , defaultlocale : 'fr-be ' , locales : { 'nl ' : 'nl-be ' // means that nl prefix uses nl-be locale } , } , ] , } , } // pages/_app.js myapp.getinitialprops = async ( appcontext ) = > { const appprops = await app.getinitialprops ( appcontext ) ; if ( appcontext.ctx.req ) { let reallocale = `` ; switch ( appcontext.ctx.req ) { case 'my-site.be ' : switch ( appcontext.router.locale ) { case 'nl ' : reallocale = 'nl-be ' ; break ; } break ; ... } }
hello , i 'm trying to use a web worker to offload some computationally expensive tasks away from the main thread i have a typescript codebase and have the following code : in index.tsx in example.worker.ts : it tries fetching example.worker.js from /_next/ [ hash ] .worker.js and that causes a 404 not found . the problem is , i can see the file if i visit that path through the filesystem ! i 've tried fiddling with the publicpath and name options , to no avail . any help ? thanks ! < code > // also tried importing `` worker-loader ! .. /example.worker '' import exampleworker from `` .. /example.worker '' ; export default function app ( ) { const worker = useref ( ) ; useeffect ( ( ) = > { worker.current = new exampleworker ( ) ; } , [ ] ) ; return ( < button onclick= { ( ) = > worker.current.postmessage ( `` runtask '' ) } > click me < /button > ) ; } self.addeventlistener ( `` message '' , ( e ) = > { // do some long-running operation , eg . android studio 's indexing } )
hi ! we are building different next.js apps for different languages . the apps do not need language switching , so theoretically , all the translations can happen at build time , thinking of something like this : i know that env variables starting with next_public_ gets inlines at build time . are there any solutions to do the same with certain function calls through babel or something similar ? this would reduce the bundle size by not needing to include all the translations at once . thanks 🙏 related : < url > < code >
feature request is your feature request related to a problem ? please describe . given i have : 2 locales : en and fr a page /pages/some-page.js i 'd like to write rewrite rules so that : /a-page url points to /pages/some-page.js for en locale only /une-page url points to /pages/some-page.js for fr locale only so : /a-page is not available on fr locale /une-page is not available on en locale if i write rewrite rules like that /a-page & /une-page are available for every locales , which is not what i want describe the solution you 'd like allow rewrite rule locale parameter to accept a specific locale so the rule is only available to this locale describe alternatives you 've considered as a workaround , we can make every rewrite available to every locale and check that the source matches the locale on the server & send a 404 if not . < code > { source : '/a-page ' , destination : '/some-page ' , } , { source : '/une-page ' , destination : '/some-page ' , } { source : '/a-page ' , destination : '/some-page ' , locale : 'fr ' // means that the rewrite rule is only available to fr locale }
hi , i 'd really appreciate some direction to solve this problem . i 'd like to import a dynamic component based on props.page.type i get from getserversideprops . my code is below : the following code works , but it is not server-side rendered which is something i need : any ideas are greatly appreciated . thanks in advance ! < code > const page = ( { page } ) = > { const content = dynamic ( ( ) = > import ( ' .. / .. /components/ < cur > { page.type } ' ) ) return ( < div > < h1 > some title < /h1 > < content / > < /div > ) } import { getpagebyslug } from ' .. / .. /utils/pagesapihelper ' import dynamic from 'next/dynamic ' // this is what i need to be dynamic and the way it is written below does n't work : const content = dynamic ( ( ) = > import ( ' .. / .. /components/ < cur > { props.page.type } ' ) ) const page = ( { page } ) = > { return ( < div > < h1 > some title < /h1 > < content / > < /div > ) } export const getserversideprops = async ( { params : { slug } } ) = > { const page = await getpagebyslug ( slug ) return { props : { page : page } } } export default page
hi , first of all , the new image component is really nice ! but i 've been looking at its html content , and i find it quite verbose . why bothering with a wrapping div with a ton of css ? why could n't we simply do this : and in the css : this way , we do have our aspect-ratio determined automatically by the browser ( thanks to the html width and height attributes ) , and it 's responsive ( with our width : 100 % and height : auto ) . i find this a lot easier to maintain . for instance , i have a list of images which have different sizes , but i want to specify a max-height and a max-width , and i ca n't figure how to do this with the image component because i ca n't specify a width or a height and do n't want to use the fill layout . actually , my best feature in the image component is the automatic optimisation thanks to the next server . but for all the rest , i prefer to use my own home-made image component , because the next 's one is too much opinionated . if the image component is going to stay like this , is there a way to only use the optimisation feature ? like a function to call and which generates all the srcset and sizes with arguments . < code > img { display : block ; width : 100 % ; height : auto ; } return ( < img width= { width } height= { height } { ... } / > ) ;
hi , i was deployed this site on vercel . after deployed i checked meta tags , on twitter card validator . but validator never find meta information . other hand i try deploy to netlify same src code same branch , it was working . so question is do i have to do something for deploy on vercel ? i use expo web with next.js adapter . you can try that . twitter card validator . < url > netlify deployed site ( working correctly ) < url > vercel deployed site ( not working ) < url > if need more information please let me know . best regards . < code >
hello , nextjs community . i 'm wondering if it 's possible for static pages to contain a component that will then be dynamically imported client-side during hydration . in other words : can i get away with lowering a page 's initial payload by statically delivering the html for a component whose javascript wo n't be there until it 's dynamically imported by the client ? i feel like this should be possible in theory , but perhaps is n't supported by nextjs right now . can anyone weigh in ? < code >
@ ashconnell , i am trying to run yarn migrate : latest command after initializing my project using `` with-knex '' example , getting the following error node version v12.19.0 postgres ( postgresql ) 13.1 postgresql db instance is hosted on the heroku free app < code > error : no pg_hba.conf entry for host `` 92.22.111.10 '' , user `` sdsds '' , database `` sdsd '' , ssl off at connection.parsee ( /users/me/np/mine/node_modules/pg/lib/connection.js:553:11 ) at connection.parsemessage ( /users/me/np/mine/node_modules/pg/lib/connection.js:378:19 ) at socket. < anonymous > ( /users/me/np/mine/telosmedia-platform/node_modules/pg/lib/connection.js:119:22 ) at socket.emit ( events.js:314:20 ) at addchunk ( _stream_readable.js:298:12 ) at readableaddchunk ( _stream_readable.js:273:9 ) at socket.readable.push ( _stream_readable.js:214:10 ) at tcp.onstreamread ( internal/stream_base_commons.js:188:23 )
feature request make revalidate param accept integer strings . is your feature request related to a problem ? please describe . i have a dev/prod environment for one of my applications and wanted to have a different revalidate time for dev / prod . i added an environment variable and made a revalidate in getstaticprops read from it . i however noticed that i needed to parse the environment variable to an integer as `` revalidate '' was not able to read an int in string format . i felt like that should be possible and could cause confusion for other developers as well . describe the solution you 'd like when a string is passed as a revalidate input . try parsing as int and accept if valid int , reject otherwise . describe alternatives you 've considered better documentation and describe the default values in the docs . confuse more developers and let it be as is < code >
hi everyone , i 'm building my first ecommerce site with next and have some questions around the best way to fetch data . currently , i 'm using getstaticprops to get all data from prismic and shopify . that 's all great , but i need to also make a client side request to shopify to get the latest inventory numbers so i can display whether the item is sold out . at the moment , i 've solved this in a function in my /pages/product/ [ slug ] .js page in useeffect ( ) ( so no getserversideprops or anything ) . it 's working , but something tells me it 's not the optimal way . furthermore , i 'd like to display whether the item is sold out in category pages , which would mean making this request twice for one product ( in category , then product page ) + do it for all products in the category at once which i fear is slow . what 's the best way to handle this case ? thank you ! < code >
@ ijjk @ timer @ timneutkens @ lfades @ styfle @ dav-is expected behavior i expected to redirect the page /insights/future-tech to /archive/future-tech ; my redirect source code is in next.config.js it is works absolutely as i expected on the npm run dev but the source code failed to execute the desired outcome after doing npm run build and npm run start . kindly address this issue . i have lost traffic drastically system information os : windows and ubuntu version of next.js : 10.0.1 version of node.js : 12.16.1 version of next compose plugin : 2.2.1 deployment : next start < code > const withplugins = require ( `` next-compose-plugins '' ) ; const withcss = require ( `` @ zeit/next-css '' ) ; const prod = `` production '' === process.env.node_env ; const nextconfig = { poweredbyheader : false , compress : false , async redirects ( ) { return [ { source : '/insights/future-tech ' , destination : '/archive/future-tech ' , permanent : true , } , ] } } ; const env = { env : { url : prod ? `` < url > '' : `` < url > '' , dev : prod ? false : true , } , } ; module.exports = withplugins ( [ [ withcss , { webpack : function ( config ) { config.module.rules.push ( { test : /\ . ( eot|woff|woff2|ttf|svg|png|jpg|gif ) < cur > / , use : { loader : `` url-loader '' , options : { limit : 100000 , name : `` [ name ] . [ ext ] '' , } , } , } ) ; return config ; } , } , ] , nextconfig , env , ] ) ;
drawer problem i have a problem , i dont know why , but when i reload the page , the drawer styles popup at the start or reload the server there is no problem , but when i reload the page . < code >
hi community : i 'm planning to deploy two sites using next.js on eks . i 'm always thinking about do n't loose the performance and out of memory in applications so , i would like to ask to you : how much memory should i use , on a single instance , to do n't be surprised about a memory leak ? best . < code >
i 'm trying to implement preview mode , it works well in development , but not in production which run on < url > it seems cookie does n't set in production . is it bug ? what i 've done is yarn build , after building app i ran yarn start implementation : < url > < url > let me know if you need more info . < code >
hi , i have a siteconfig that will be loaded based on the request.host on server . on server startup i load json files into memory and stick them into a map . based on the incoming requested domain i need to inject the relevant config ( e.g . analytics , tracking , themes etc ) i then create a contextprovider for the config for use with hooks wherever it 's needed inside the app render tree . what is the best way to expose data like this ? i 've thought about adding it to the req object for server render & then using custom _document to write a window variable for it client side something like ... is there a better way ? < code > type configs = { //example.com : { ... siteconfig } [ key : string ] : siteconfig } customapp.getinitialprops = async ( appcontext : appcontext ) = > { const { ctx } = appcontext ; const initialprops = await app.getinitialprops ( appcontext ) ; let siteconfig = null ; if ( process.browser ) { siteconfig = window.siteconfig ; } else { siteconfig = ctx.req.siteconfig ; } return { pageprops : { siteconfig } } ; } ;
hi , the nextjs example has a function called initializeapollo which you can call inside the data fetching methods to pre-populate the cache . everytime your app on the server uses the initializeapollo ( ) or useapollo ( ) this will create a brand new client when you only need to do it once per request this is causing issues for me because i need to inject custom headers into the createapolloclient method using a custom link but i should only have to do it once per request context < code > export function initializeapollo ( initialstate ) { const _apolloclient = apolloclient ? ? createapolloclient ( ) ; // if your page has next.js data fetching methods that use apollo client , the initial state // gets hydrated here if ( initialstate ) { _apolloclient.cache.restore ( initialstate ) ; } // for ssg and ssr always create a new apollo client if ( typeof window === 'undefined ' ) return _apolloclient ; < -- - this will make a new apollo client per call not just once per request // create the apollo client once in the client if ( ! apolloclient ) apolloclient = _apolloclient ; return _apolloclient ; }
i am currently having some problems using environmental variables that is set through app setting . the variables are available to the server and we can console.log them out , but we ca n't get them to show up client side . does anyone have some experience dealing with this ? just to give you some examples of what we have tried ; adding next_public_ prefixes to the variables exposing them through the next.config.js exposing them in publicruntimeconfig all of this works locally , but not when running in azure ! < code >
my understanding of nextjs is that it prefetches pages that are within the viewport , but in our case it still takes 3-4 seconds to load the subsequent page ( even when deployed to production ) . is there anything we can do to speed this up ? we 're used to gatsby where the load time is somewhere near zero . we are using getinitialprops to make server-side queries , but i 'd presume if it 's prefetched then that should n't slow it down , right ? < code >
i have an application that involves a project creation flow that has the following ux : user clicks create project button on / ( index page ) which has a next-link link to /create-project , user goes through a couple spa style views on the /create-project page before either saving the project or publishing it . if the user wants to come back to the same project after saving to make edits before publishing , they click a next-link link like /create-project ? id= { project_id } which loads the project from my api and starts the user on the view that they last left on . this all works as expected using getserversideprops on the /create-project.tsx page to read the query string , fetch the project , and load in the last save as props , however if i open a project to edit , then navigate back to / ( index page ) , then click the create project button , instead of opening the /create-project page at the first view with no data input , it loads the page back at the last view with the last accessed projects data loaded . this is particularly odd because the page props returned by getserversideprops is null ( check in react dev tools ) , as well the call to the project endpoint of the api is not called again . is there some way to disabled the loading of the previous state ? is this because i am using ssr ? i really do n't understand why this is happening , but my only insight is maybe that i need to separate the create project and edit project flows , however , this would lead to nearly identical code duplication . < code >
hi , i use nextjs with a custom express server and i 'd like to read a cookie value on the server . the following code used in the server setup makes me think nextjs has access to the request object from express : nextapp.prepare ( ) .then ( ( ) = > { app.get ( ' * ' , ( req , res ) = > { return handle ( req , res ) ; } ) ; } ) ; how can i have access to the request object , or at least the cookies . i do n't need to set cookies , just read them . thanks . < code >
hi , so i 've created a little demo to show-case all the different ways nextjs can do page-rendering : [ csr , ssr , ssg ] . you can find that demo here : < url > code here : < url > in the nextjs documentation the following recommendation can be found : however i 've found a significant performance penalty in using getserversideprops vs getinitialprops you can check for yourself by navigating between ssr and hybrid-ssr in the demo mentioned above . ssr implements getserversideprops and hybrid-ssr implements getinitialprops . both do exactly the same . it seems to me that the penalty comes from the extra roundtrip to the lambda getserversideprops of that page upon navigation . where with getinitialprops the client-side code runs getinitialprops and does the data fetching directly . knowing this , my question is what are the benefits of implementing getserversideprops vs getinitialprops ? < code > index.getinitialprops = async ( context : any ) = > { const res = await fetch ( `` < url > ) .then ( ( res ) = > res.json ( ) ) ; console.log ( `` getinitialprops '' , res , context.params , context.query ) ; return { ... res , name : context.query.slug } ; } ; export async function getserversideprops ( context : any ) { const res = await fetch ( `` < url > ) .then ( ( res ) = > res.json ( ) ) ; console.log ( `` getserverprops '' , res , context.params , context.query ) ; return { props : { ... res , name : context.query.slug } } ; }
is there any way to import this type ? < url > i am making my wrapper for a button with router.push ( to , as ) and i want to use that type for parameter < code >
next.config.js package.json after i run build : all , there will be two production files cn/_next and sg/_next , and i would like to render the specific file based on process.env.region ( start : cn or star : sg ) . how can i do that ? < code > module.exports = { distdir : process.env.region === 'cn ' ? './cn/_next ' : './sg/_next ' } { ... `` build : cn '' : `` region=cn next build '' , `` build : sg '' : `` region=sg next build '' , `` build : all '' : `` npm run build : cn & & npm run build : sg '' , `` start : cn '' : `` cross-env node_env=production region=cn node server.js '' , `` start : sg '' : `` cross-env node_env=production region=sg node server.js '' ... }
i am trying to update 9.3 to 9.4. i have updated the version on package.json `` next '' : `` ^9.4.0 '' , after that , a white page is shown and this error in console . works fine on 9.3 . any idea why this occurs ? < code > uncaught syntaxerror : unexpected token u in json at position 0 at json.parse ( < anonymous > ) at eval ( platform.js ? 2a2e:14 ) at object .. /node_modules/ally.js/util/platform.js ( main.js ? ts=1591861175888:1535 ) at __webpack_require__ ( webpack.js ? ts=1591861175888:863 ) at fn ( webpack.js ? ts=1591861175888:151 ) at eval ( detect-focus.js ? 93d2:19 ) at object .. /node_modules/ally.js/supports/detect-focus.js ( main.js ? ts=1591861175888:851 ) at __webpack_require__ ( webpack.js ? ts=1591861175888:863 ) at fn ( webpack.js ? ts=1591861175888:151 ) at eval ( supports.js ? 750b:21 )
hi there , i 've been implementing preview mode for my site which mainly uses getstaticprops , and after a few days of going around in circles , i 've discovered for posts that had not been published at the time of the latest build , for preview mode to work you need to have fallback mode enabled . this is not mentioned anywhere that i could see in the docs so i 'm posting here to : a ) check that this is expected behaviour ( all the demos seem to have fallback : true ) b ) help anyone else having the same issue . thanks tom < code >
i have been working on a project already developed by the other dev . but i am wondering about how he used getinitialprops in the project . here is the some code part to use getinitialprops for prefetching in the page . this is really not a prefetch . index.getinitialprops = async ( { store } : pagecontextprops ) = > { try { await store.dispatch ( fetchposts ( settings.blogs , { per_page : settings.postsperpage } ) ) ; return { } ; } catch ( e ) { console.error ( e ) ; return { } ; } } ; i want to hear your experts ' overview about this code part and also about the best usecase of getinitialprops . regards < code >
can anyone help me on how would a next.js app be deployed to a generic vps ? unfortunatley i ca n't deploy to vercel , so i would have to go with the vps , but i 'm not finding much resources on the topic . i 've gone through the official documentation , but the deployment section only describes the deploy process with vercel . any help or link to documentation is appreciated , and also comments on wheter this is a good solution . < code >
bug report describe the bug when setting a subfolder for static assets the application will not run when using `` /foo/bar '' , in test i only see string checks and last / stripper but no other rules for it . i also suspect the basepath to be of influence on the behaviour . to reproduce in next config js , the following works correctly : while the following does n't '' go to < url > see the console log see error , all .next assets have 404 expected behavior i would like to set my static prefix to any path i want . our applications run in a certain context and part of it needs to have a specific value . system information version of next.js : latest ( see sandbox ) version of node.js : 12/14/15 no influence additional context code : < url > server : < url > < code > basepath : `` /foo '' , assetprefix : `` /foo '' , basepath : `` /foo '' , assetprefix : `` /foo/assets '' ,
help wanted describe the bug i have upgraded my app to next @ 10.0.0 to use the internationalized routing feature . i have zh and en as the available locales and running react-i18next as the localization tool . my default locale is set to zh and fallback to en which means when i navigate to / it will use zh and /en will supposedly use english . / works fine as it should but when going to the subpath /en it does n't use my english translation file and still shows the zh language . to reproduce steps to reproduce the behavior , please provide code snippets or a repository : < url > expected behavior i expect users to browse to < url > to get the english version of the site . screenshots system information os : wsl2 ubuntu 20.04 browser chrome , safari version of next.js : 10.0.0 version of node.js : 10.18.1 additional context add any other context about the problem here . < code >
i am in need to add a redirect for a dynamic route '/topic-questions/ [ topicid ] / . unfortunately can not get [ topicid ] or : topicid to work . at present when navigated to abc/topic-questions/123 it does n't redirect to /abc but gives a 404 how can i do that ? < code > module.exports = ( phase , { defaultconfig } ) = > { console.log ( phase ) ; return { ... defaultconfig , basepath : `` /abc '' , async redirects ( ) { return [ { source : '/topic-questions/ : topicid * / ' , destination : '/ ' , permanent : true , } , ] } } }
hi , i 'm building a product website using next.js . for that i need some documentation and do n't want to generate it on subdomain but as part of path /docs . i figured there are some docs generation tools , so i guess i 'm asking is there some easily managed integration for this with next.js which i missed somewhere ? it would be painful to create such thing from scratch . maybe this discussion could be under ideas category if there 's no such feature . cheers ! < code >
hi there i am making this social media app ( which is very much like reddit/twitter ) , so i probably need good seo . i decided to go with nextjs for my frontend and use a separate express js or python flask server for my backend apis . nextjs api routes do n't really seem reliable . i mean , having to re-establish a connection to the database on every request do n't really seem fast , especially for a large application . also , there is going to be a mobile client . here is my concern about using a seperate server : i will probably deploy next js on vercel and deploy my server on horeku . so , when the client requests a page , the next js server ( with ssr or ssg ) will make a request to the server hosted on horeku to bring the data needed . this makes the request process go something like : client = > vercel = > horeku = > vercel = > client insted of : client = > vercel = > client is that really the case ? should i use the custom server approach , instead ? knowing that using it will force me to use node js in the backend even if i want to use python flask . < code >
hi guys , i am using nextjs with nginx for my service . but i wonder how to apply http2 for nextjs . should it be handled with nginx ? or can i do it alone with nextjs ? < code >
hello . i was checking my site with disabled js and got case when images does n't load . i change next/image to picture > source+img and after images load with disabled js . < code >
so i 'm working on an app that will be deployed as a static html export . i have a module that i 'm using to fetch that data , but it has a large size , and i do n't want it bundled in the export . the module is only used in the getstaticprops ( ) function to fetch the data that the static export will be built from , so i do n't see why i would need to include it with the actual export . is there any way to only use this module while my app is using built and not have it packaged with the final static export ? i 'm not exactly sure how the static html export feature works , but i 'm assuming it bundles all the modules you 're importing , including the ones installed with npm , similar to webpack/browserify . i know nextjs has a dynamic importing feature . do you think if i dynamically import this module in the getstaticprops ( ) function that it will be excluded in the static export ? < code >
let us say you have an appshell next.js project and 2 next.js applications . i have seen a pattern in ( udemy course ) in react.js , where the container/appshell calls mount method passing the html element to mount and each micro apps will have a mount ( ) method that uses reactdom.render to mount itself to the appshell . is it possible to do the same with next.js ? next.js does not expose reactdom.render ( ) , any suggestions ? < code >
i have dynamic route like below is it correct way for server side rendering ? < code > import { userouter } from `` next/router '' ; import { usegetsnap } from `` .. / .. /apollo/actions '' ; import { hero } from `` .. / .. /components '' ; import { navbar } from `` .. / .. /conatiners '' ; function snap ( props ) { const router = userouter ( ) ; const { id } = router.query ; const { data , loading , error } = usegetsnap ( { variables : { id } , } ) ; return ( < div classname= '' page-wrapper '' > < navbar / > < hero title= { data ? .snap.title } / > < div classname= '' page-content '' > { loading & & < div > loading ... < /div > } < /div > < /div > ) ; } export default snap ;
bug report describe the bug a custom server that creates/prepares two or more nextjs apps hangs after upgrading from 9.3.3 to 9.3.4. to reproduce example : < url > clone the repository , install the dependencies , and run npm start . the prepare promises for the two next apps never resolve . roll back next with npm install next @ 9.3.3 , remove the .next build folders from both apps , and restart ; the server starts and serves both apps . expected behavior the server starts and serves both next.js apps system information os : osx 10.15.4 version of next.js : 9.3.4 version of node.js : 12.16.1 < code >
i am getting this error .i am using nextjs and reactjs . the provided as value ( / ) is incompatible with the href value ( / [ ... slug ] ) i have basepath is equal to docs . so when i use this url < url > or in other words when i am using docs/ ? test=test i am getting this error please suggest how to remove this error here is my code < url > < code > module.exports = { basepath : '/docs ' , trailingslash : true , }
feature request allow specifying storage location for cached images is your feature request related to a problem ? please describe . the images are saved in the .next folder on the server . during the time space on the server runs out and there are problems with saving other resources . describe the solution you 'd like when we use the built-in image optimization tools . the images are saved in the .next folder on the server . it is a popular practice to use separate servers for cached resources . we would like to be able to specify the domain where we store the images . perhaps we will take the images from the .next script folder and upload them to the right server , but we need the right domain in the links on the image . describe alternatives you 've considered it is possible to use some callbacks . these callbacks will be triggered after you create optimized images in which we upload them to the right servers . or there should be an option to limit the size of the cache < code >
i am getting this error .i am using nextjs and reactjs . the provided as value ( / ) is incompatible with the href value ( / [ ... slug ] ) i have basepath is equal to docs . so when i use this url < url > or in other words when i am using docs/ ? test=test i am getting this error please suggest how to remove this error here is my code < url > function homepage ( ) { return welcome to next.js ! } export default homepage < code > module.exports = { basepath : '/docs ' , trailingslash : true , }
i want to run the docs like the docs website but i want to use offline in my pc , i download the next official repo , but the package.json has many commands and i do n't know which one to execute for run the docs < code >
for a static generated site i would like to generate a fuse.js fuse-index.json next.js during build time . the fuse search index will contain documents i can retrieve similar as i would retrieve data for normal pages using getstaticprops . is it possible to generate generate a ssg fuse.index.json 'page ? ' so it is part of the generated site as a static asset ? or is there another api/hook when using next.js to generate such a file ? ps : this is how the fuse.js index is generated : < code > // in the build step . // get the data . const books = // get the books . this would contain same code as i would do in getstaticprops for other pages . // create the fuse index . const myindex = fuse.createindex ( [ 'title ' , 'author.firstname ' ] , books ) // serialize and save it fs.writefile ( 'fuse-index.json ' , json.stringify ( myindex.tojson ( ) ) )
i am getting this error .i am using nextjs and reactjs . the provided as value ( / ) is incompatible with the href value ( / [ ... slug ] ) i have basepath is equal to docs . so when i use this url < url > or in other words when i am using docs/ ? test=test i am getting this error please suggest how to remove this error here is my code < url > < code > module.exports = { basepath : '/docs ' , trailingslash : true , }
hi ! i kindaa need help with next.config.js redirects ( ) along side dynamic routes . in my project , i have have dynamic route at the top level ( pages/ [ creator ] / ... ) and i would like to use redirects inside next.config.js . here is my use case : pages/ [ creator ] / ... = > user profile pages /discord = > a path set inside next.js.config that will redirect anyone who visits that page/path to my discord server . this is what i tried so far : i - ii - both i & ii do n't redirect to discord but instead go 1 ( [ creator ] / ... ) . i might be doing it the wrong way or maybe this approach is n't supported . any advice is welcomed . thanks < code > // next.config.js ... redirects : async function redirect ( ) { return [ { source : `` /discord '' , destination : `` < url > permanent : true , } , ] } ... // next.config.js ... redirects : async function redirect ( ) { return [ { source : `` /discord '' , destination : `` < url > } , ] } ...
hey there ! we 're rolling out some next.js usage at my workplace , and i wanted to poke at the removal of getinitialprops removal from some of the main documentation paths . our use case really falls specifically into the getinitialprops scenario - that is , we want to fetch once from the server on load , and then run it via the client on future routing . this is the case for things like leveraging our client cache , snappier page transitions , feature flags ( we do n't really need the server to get them the second time , could pass them via the route ) , etc . anyways , trying to get an answer if the getinitialprops is slated for removal , or is just not recommended as much anymore for general use < code >
hi all . hoping someone can explain to me what i am doing wrong . given the above four files , the output i am seeing on a build is : that is , process.env.base_url can be passed to a html 's tag attributes but not into the contents of that same html tag . any idea why ? many thanks . < code > < ! -- result -- > < a href= '' < url > '' > example link . value of base_url : . < /a > // components/my-component.js import { base_url } from `` .. /lib/constants '' ; export default function mycomponent ( ) { return ( < > < a href= { base_url } > example link . value of base_url : { base_url } . < /a > < / > ) ; } # pages/my-page.mdx import mycomponent from `` .. /components/article-layout '' ; < mycomponent / > # .env # created by vercel cli base_url= '' < url > '' // lib/constants.js export const base_url = process.env.base_url ;
hello everybody ! i have a site with statically rendered pages . it works : ) for that purpose , under pages i have a catch all [ ... slug ] containing an index.js file with getstaticprops and getstaticpaths methods . however , i would like to redirect some urls to some of those static pages . if a user gets to the baseurl/non-existing-page-id then i would like to redirect this user to a specific static page . i am struggling to find a way to do so . my ideas so far : find a way to keep a getserversideprops handle the slug if the page is not within getstaticpaths have the fallback accept a method to define what happens if the path is not found another need : i might want to redirect some slugs to an external website . example , if a user visits baseurl/login , i want to redirect this user to app.baseurl/login while keeping static generation for my site . does someone see a way to solve this redirection issue ? < code >
hi , i am trying to `` centralise '' my routes in a routes.ts file . it looks like this : i want to use it like this : but i get the following error : i know i can do it like this : but if a route changes i do n't want to change it everywhere .... i am looking for an elegant solution , where i only need to change the dynamic route in one file . thanks for your help ! < code > < link href= { getuserroutes ( authuser.id ) .editsettings } > < a > settings < /a > < /link > export const routes = { beta : `` /beta '' , passwordreset : `` /passwordreset '' , signin : `` /signin '' , signup : `` /signup '' , } ; export const getuserroutes = ( userid : string ) = > ( { onboarding : 'user/ < cur > { userid } /onboarding ' , editsettings : 'user/ < cur > { userid } /editsettings ' } ) ;
when i deploy my next app in sub path the url of the image to load the script is wrong . for istance the link is : /_next/image ? url=https//link here it should be : /_next/subpath/image ? url=https//link here here my next.config.json module.exports = { images : { domains : [ `` s3-eu-west-1.amazonaws.com '' ] , } , assetprefix : process.env.base_url , publicruntimeconfig : { staticfolder : < cur > { process.env.base_url } /static , } , } ; the images are load by amazon s3 . the component seems to ignore the assetprefix os : macos browser : [ chrome , safari ] version of next.js : [ e.g . 10.0.0 ] version of node.js : [ e.g . 12.6.1 ] deployment : next start < code >
hey team ! first of all , thanks for the great work you 're all doing ! a few little questions . i 'd love to generate as many static pages as possible for an e-commerce website i 'm working on . revalidate : is the page rebuilt once x seconds after a user visits the page , or is is rebuild every x seconds ? if it 's possible to ( re ) build on runtime a page statically , what would be the advantages of providing a paths array ? what would a bot see the first time it visits a page not rendered yet ? how would that page be removed if it 's not supposed to exist anymore ? thank you ! < code >
< url > since webpack 5 upgrade the core lib of plugins `` tapable '' , it wont't export member `` plugin '' anymore . i think `` webpackplugininstance '' should be the replacement . consider compatibility in webpack 4 and 5. i have two ideas ( 1 ) add // @ ts-ignore before import { compiler , plugin } from 'webpack ' ; tsc wo n't check it . ( 2 ) remove plugin reference here . how do you think about it ? < code >
hi , maybe i do not understand what tree shaking is , but next.js ( webpack ? ) keeps bundling all the exports from a file , even unused ones . i am using `` < url > to generate my graphql queries and mutations . this produces a substantial file . on every page i only use one or two queries from that generate file , but i see that the whole file is bundled in a js which is shared among all pages . this is not desired because my client queries comprise only 5-10 % of the size , admin queries are the rest . how can i force next / webpack to bundle only portion of that file that is actually used ? thanks ! < code >
i am using _app.js to import global styles from root/styles/global.css . inside global.css i have the following inside my root/components/layout.js i have the following if i edit this file to include style jsx to be and save i get the following error if i remove the style jsx edit and save , the error disappears . i believe this is happening because the new .container css in my layout.js is conflicting with global.css imported using _app.js resulting in this strange error . my github < code > import styles from './layout.module.css ' ; export default function layout ( { children } ) { return ( < div classname= { 'container < cur > { styles.container } ' } > { children } < /div > ) ; } import styles from './layout.module.css ' ; export default function layout ( { children } ) { return ( < div classname= { 'container < cur > { styles.container } ' } > { children } < style jsx > { ' .container { background : yellow ; } ' } < /style > < /div > ) ; } unhandled runtime error error : element type is invalid : expected a string ( for built-in components ) or a class/function ( for composite components ) but got : object . you likely forgot to export your component from the file it 's defined in , or you might have mixed up default and named imports . check the render method of 'layout ' . .container { background : red ; }
i am new to next.js and i am having an issue with displaying images . all images are being stored in `` public/img '' . i am using a netlifycms to generate md files . the md file contains a reference to the image path as meta ... `` public/img/featured-image.png when i reference this path in my component the image does not display . if i go to the markdown file and manually remove public from the url path the image displays . im a junior so i 'm just trying to find the best way handle this . i think that i just need to filter out public from the url but not sure how to go about it or if next already provides and way to solve this that i am just unaware of ? `` next '' : `` ^10.0.3 '' thanks in advanced . < code >
would anyone be interested in adding a theme-ui blog example to the repo ? i 've started one here : < url > there 's a basic website example on the theme-ui repo but it does n't cover how to style the markdown content and i found that there 's a bit of a trick to it . coming from gatsby , which has a plugin , i found it a little bit hard to work out . < code >
i 'm trying to migrate from wordpress to next.js . the posts in wordpress have two types of permalinks : /yyyy/mm/dd/post-title-slug / ? p=id using the next.config.js redirects i 've managed to create redirects for all of them , but the second type does n't work . i assume it 's because / ? p=id ends up pointing to pages/index.jsx with a p query parameter , but i need it to redirect ! how do i solve this ? 😕 update actually , it does n't just not work , it crashes completely when starting next.js . question very much still stands though ! how can i create working next.js redirects for these wordpress permalinks ? 😟 < code > error parsing '/ ? p=64 ' < url > reason : unexpected modifier at 1 , expected end / ? p=64 ^ 'source ' parse failed for route { `` source '' : '' / ? p=64 '' , '' destination '' : '' /blog/quick-way-to-do-cross-thread-calls-to-update-form-controls '' , '' permanent '' : true } error : invalid redirects found at checkcustomroutes ( y : \projects\geekality.net ode_modules ext\dist\lib\load-custom-routes.js:8:1575 ) at loadredirects ( y : \projects\geekality.net ode_modules ext\dist\lib\load-custom-routes.js:8:1772 ) at async promise.all ( index 2 ) at async loadcustomroutes ( y : \projects\geekality.net ode_modules ext\dist\lib\load-custom-routes.js:8:2265 ) at async devserver.prepare ( y : \projects\geekality.net ode_modules ext\dist\server ext-dev-server.js:14:669 ) at async y : \projects\geekality.net ode_modules ext\dist\cli ext-dev.js:22:1
hi , i 'm looking to add a statically-generated banner to all pages ( content is queried from our cms at build time ) . we could add a custom app.js with a getinitialprops that queries our cms , however it 's my understanding that this will be called for every page individually greatly slowing down our build time ( we have 40k+ pages ) . the content does not vary by page , is there a way to query our cms once and use that to power the relevant component ? < code >
hi i 'm an absolute beginner i used isomorphic-fetch in the past to fetch data from an external api but i have no idea how to fetch data from an api inside next.js how to fetch data from < url > thank you < code > import react from 'react ' import fetch from 'isomorphic-fetch ' class index extends react.component { static async getinitialprops ( { req , res , query } ) { let stories ; let page ; page = number ( query.page ) || 1 ; const response = await fetch ( ' < url > } ' ) ; stories = await response.json ( ) ;
environment nextjs version 9.5.2 node 10.16.2 centos 6 nginx hi guys , i 'm having bit problems with handling concurrent users . my old sites version is using express + ejs , and i convert it to nextjs . old setup did n't have problem with handling users 1k concurrent users at same seconds , recorded on ga is 30k live users . meanwhile on nextjs during 100-200 concurrent users , i see server cpu spiking 20 % -30 % and ram consumption is around 500mb i already implement cache using cacheable-response and serving images from cdn ( different domain ) , i also did cache on my nginx . is there anything i can do yo inspect this bit further ? to find culprit , i know ssr is bit heavy but i 'm not expecting this much heavy . < code >
hej folks ! since i actually could not find any good examples or articles to read on the web i wanted to ask in the community : what do you consider a best practise for displaying a `` browser incompatibility message '' within a next.js app ? i have a few ideas on where ( in the server , in a custom app , on each page individual , etc . ) and how ( with a middleware or decorator that parses the useragent and does something depending on it ) to build a solution for it but i am hesitating to implement one because i was surprised not to find a common example on how someone would do that within next.js . before i start building a custom solution for it i wanted to make sure that i am not missing something totally obvious . just assume that you build a project with a certain compatibility in mind e.g . `` only chrome > =v75 and firefox > =v77 '' and all the other browsers should get a designated message displayed that informs the user about the browser he can use to visit the website . ideally the solution would work without a custom server and supports even outdated browsers , e.g . ie11 . happy to hear all your ideas and thoughts ! < code >
bug report describe the bug i am using next.js 9.5.2. i have tried to incorporate a useeffect that console logs window.scrolly or window.pageyoffset on a scroll event . while the code works with next.js 9.4.4 , it will not work properly with the most recent version of next.js 9.5.2. i have tried a `` click '' event listener in place of `` scroll '' , which works ... very strange functionality . i have successfully created scroll functionality from scratch with different versions of next.js previously and feel like i am missing something very small - please help ! to reproduce the relevant code is posted below please note - i have tested this same code block in a next.js 9.4.4 application and it works perfectly fine : import head from 'next/head ' ; import layout from ' .. /components/layout ' ; import styles from ' .. /styles/index.module.scss ' ; import react , { useeffect , usestate } from 'react ' ; import { section } from ' .. /components/transitions ' ; const index = ( ) = > { useeffect ( ( ) = > { document.addeventlistener ( 'scroll ' , ( ) = > { console.log ( 'position ' , window.scrolly ) } ) ; / * or console.log ( 'offset ' , window.pageyoffset ) * / } , [ ] ) return ( ... //includes content that extends beyond the viewport ) } export default index ; expected behavior the code above should render the accurate window.scrolly or window.pageyoffset on every scroll `` event '' . screenshots if applicable , add screenshots to help explain your problem . system information os : macos version of next.js : 9.5.2 version of node.js : 13.5.0 additional context add any other context about the problem here . < code >
feature request is your feature request related to a problem ? please describe . the existing internationalized routing mechanism in next.js 10.0 does not allow building sites with dynamic content where no locale is considered a primary ( default ) locale . for example , in < url > , en-us is considered the primary locale that serves pages under / whereas all additional locales have pages relegated to locale-specific sub-paths such as /nl-nl . for certain business cases however , no single locale must be considered primary and therefore all pages must reside in their locale-specific sub-paths . the unique remaining root path / will then perform automatic redirection of visitors to locale-specific pages based on business criteria ( e.g . accept-language header , geo ip , etc. ) . no other routes must exist that are not locale-specific . it is not possible to implement such a scenario with internationalized routing in next.js 10.0. describe the solution you 'd like a viable solution would be to allow setting i18n.defaultlocale to null . consequently no routes under / must be generated other than the defined locales . describe alternatives you 've considered an alternative is to manually build a folder structure that implements the locale sub-path via dynamic routes , e.g . / [ locale ] / [ slug ] .js . this approach works , however features like automatic locale injection into the link component have to be built manually . additional context this issue is highly relevant for sites generated predominantly from dynamic content ( e.g . headless cms ) where page instances are generated via getstaticpaths ( ) . < code >
feature request is your feature request related to a problem ? please describe . as the i18n feature of nextjs is dope , currently i am missing the options inside of api routes . i use api routes to create dynamic sitemaps and thus i would need to access the information i add to i18n section of next.config.js - especially i18n.domains describe the solution you 'd like attach i18n config into nextapirequest as option param . this would be a great addition to handle requests based on the i18n setup . < code >
hi there , i 'm having a bit of a moment and i ca n't really find a good reference as a starting point . maybe that 's a sign it 's not exactly possible . what i want to do is dynamically build a navigation list on every page of a next site , purely based on the pages that are present in the pages directory . is that even possible with something like getinitialprops in a custom _app.js file ? i keep getting a lot of fs module ca n't be found errors . wondering if there is a good example that exists on a good way to do this so i can reference it ? thanks in advance < code >
i have created a dynamic route component called [ base ] .js in my src . i needed to do it this way because i am porting a project to next js so i needed to overwrite the path at the root . however this seems to be bloging my access to public folder . a lookup for images in public routes me to the [ base ] .js and ends up in a 404. is there a best practice around this ? or even a way for my fallback to somehow route to the public folder ? < code >
feature request is your feature request related to a problem ? please describe . default exports . literally . i do n't like them . describe the solution you 'd like something very close to export const page = foopage , like export const getstaticprops = ( ) = > { ... } which already exists in next < code >
i 'm wondering : should n't getstaticpaths have access to the locale parameter like getstaticprops have ? my paths may in fact depend on the locale i 'm in ( e.g . i have an article written in en but not yet in ru ) , and there is no way to generate this difference in paths currently , at least from my understanding . < code >
describe the bug i do n't know if it is a bug , but the situation is : i 've some images which are protected from public , only some users can access them . when using the < image/ > component to get them the headers are n't been sent . i 'm using httponly to store my token . in that way , the < image/ > component does n't has permission to get the image . currently i 've fixed that using the html tag , but i would like to use next 's image component . system information os : linux mint version of next.js : 10.0.2 version of node.js : 12 deployment : yarn dev = node server.js ( custom server.js ) < code >
hi team , i 've come across this documented caveat about using `` automatic static optimisation '' : pages that are statically optimized by automatic static optimization will be hydrated without their route parameters provided , i.e query will be an empty object ( { } ) . after hydration , next.js will trigger an update to your application to provide the route parameters in the query object . this explains well why my login callback handler does n't have access to the route parameters . the problem here is that it works fine ( page receives route parameters ) in my local environment , and silently changes behaviour in production ( page does not receive route parameters ) . how can i emulate this locally ? i have tried various combinations of next build , next export , and next start , but this page always has the route parameters when the page i 'm using them in mounts . next version : 9.5.5 ( apologies if this is the wrong forum to ask this question , but i could n't find anything [ easily ] via google ) . < code >
all of my images look washed out unless i set the quality to 100 % . why are the colours being affected like this ? other image compressors do not have this issue . original image ( actual source ) next.js optimised image < code >
when i say wrap , means some or alot modifications are ok to convert it as also-desktop-compatible application . i noticed and tried out nextron , which is it 's own framework by itself , does not work well with existing-complex nextjs application . will be great to have an official example from nextjs , using below techs . nextjs electron monorepo micro frontend wich all subdomains gets deployed separately , and also the electron side gets packed separately . < code >
i have a webapp hosted on vercel that is using next.js getstaticpaths and getstaticprops methods . on build ( and on runtime via the revalidate : 10 option ) i make a call to my api ( also hosted on vercel ) that connects to a mysql server . the issue here is when i go to a page that is statically generated , next.js try to rebuild it in the background ( to keep it fresh ) and i end up instantly with more than 50 connections to my database . ( i have around 80 statically generated pages on the site , around 50 for a certain url and 30 for another ) if i continue to browse , the connections keep piling up until i reach the mysql connections limit ( 152 here ) and all the pages builded are now 404 ( the api ca n't respond data , just errors ) . do you have any idea where the problem could arise from ? why so many connections are created ? thank you in advance , i would be sad to give up statically generated pages that are a big boost of performance : ( < code >
if you are server-side rendering any react components , consider using 'rendertonodestream ( ) ' or 'rendertostaticnodestream ( ) ' to allow the client to receive and hydrate different parts of the markup instead of all at once . even the framework also its showing taking so much time . how can i solve this issue , or how should i proceed ahead ? lighthouse pagespeedinsights < code >
bug report describe the bug i updated my website to v 10.0.0 right after it was published , now , while trying to update to v 10.0.1 most of images got broken , sized incorrectly and some styles do n't work the same . to reproduce please go to the production website and testing website for comparison . here 's screenshots for troubling images comparison . before after production website vs testing website before after production website vs testing website before after production website vs testing website before after expected behavior all images should look and work the same after update . screenshots if applicable , add screenshots to help explain your problem . system information os : macos version of next.js : 10.0.2 version of node.js : 12.16.2 < code >
bug report describe the bug in index page shows this message of missmatch client with server content . i 've created a custom hook useauth where it returns : isauthenticated : boolean , isloading : boolean . based isauthenticated i return authorized/nonauthorized content . if i add isloading condition to show 'loading ... ' instead of auth/non-auth content , the message displays this error . to reproduce steps to reproduce the behavior , please provide code snippets or a repository : expected behavior not to show this error . screenshots if applicable , add screenshots to help explain your problem . system information os : windows browser ( if applies ) chrome version of next.js : 10.0.3 version of node.js : v15.1.0 deployment : localhost additional context what i saw is that the content of non-atuhorized component si compared with 'loading ... ' < code >
so , i am using getstaticprops incrementally to generate static pages of dynamic route with fallback : true . but , the issue is i do build and upload to s3 and then use assetprefix to serve static files from s3 . now , the issue i am facing is every time i do a yarn build my old generated pages gets deleted because we use different environment every time . same issue i am facing with next-images also , as all the images are cached in the cache folder after the build . < code >
hi all , with cra to change my hostname and set https locally i can simply add host=projectname.local.proxy https=true to my .env.development . is there a way that i can do something like that with next ? thanks in advance . < code >
bug report error resolving style name describe the bug in the next10.0 version , styles using css modules were resolved incorrectly the code is pretty simple but the header style name has been incorrectly parsed into the list below and whether i remove the header or change it to something else it 's still a list instead of a header and the whole style fails and that 's the only thing that happens on this page screenshots system information os : macos 11.0.1 browser chrome 87.0.4280.67 version of next.js : 10.0.1 version of node.js : v14.15.1 deployment : next start < code >
i upgrade next with template tailwindcss from 1.9.6 to 2.0.1 and i get this error : error - ./styles/index.css ( ./node_modules/css-loader/dist/cjs.js ? ? ref -- 5-oneof-6-1 ! ./node_modules/next/dist/compiled/postcss-loader/cjs.js ? ? ref -- 5-oneof-6-2 ! ./styles/index.css ) error : [ object object ] is not a postcss plugin how can i use the last version of tailwindcss ? < code >
according to next js official documents , it 's recommended to set the build target to `` serverless '' . what 's the difference ? is it correct to call an application that is running on a single machine , serverless ? how could it be serverless ! ? ? i 've also asked this question on stackoverflow < code >
i 'm aware of a few discussions on bundling client-only vs server-only code . these solutions rely on typeof window === 'undefined ' checks to indicate whether code should be bundled . this feels like a weird hack . any ideas on ways to make this more explicit ? one idea is typescript decorators but that would n't work for plain js , of course . if intent was explicit , it would afford a nicer dx where helpful errors could tell you what you 're doing wrong if you accidentally imported or tried to use server code on the client , or vice versa . < code >
bug report application builds and behaves normally on local machine , but it fails on github ci . describe the bug i have two components located in , footer.tsx and home.tsx . i want to use the footer component in the home page component . it can be done on my development machine , but not in ci . i did n't experience this behavior when vanilla react was used to build the application . expected behavior i expect the build to fail locally . screenshots system information development : version of next.js : [ e.g . 10.0.2 ] version of react : [ e.g . 17.0.1 ] version of typescript : [ e.g . 4.1.2 ] < code >
hello , i wanted to ask how can one remove all the unused css in his code using next.js . my project uses scss and has 1 starting point ( app.scss ) which imports all other partial .scss files . in next.config.js i 'm using withsass and i 've tried using withpurgecss but it removes all css instead of the unused one . < code >
hi , i 'm working on a project that use nextjs for seo purpose and we have a development environment . everything is working fine beside the images that we put on our public folder , none of then are working on development environment , but if you run the project locally everything works as expected . one thing that a notice is that none of the files in public folder are being sended to next build folder ( .next ) . do we have to do something to make static files in public folder avaible on build folder ? current using a custom server approch with express . < code >
as i 've noticed in the documentation : the expiration ( or rather max age ) is defined by the upstream server 's cache-control header . if s-maxage is found in cache-control , it is used . if no s-maxage is found , then max-age is used . if no max-age is found , then 60 seconds is used . on files inside the public/ , no cache-control header is set by default , thus , next/image should default to caching them for only 60 seconds . i would like to ask whether it 's possible to cache files under that folder indefinitely by appending a content hash to each of them in the background . or should i set cache-control : public , max-age=31536000 , immutable manually inside next.config.js and append a version string or hash to the filename itself ? < code >
feature request problem statement i 'd like the ability to have certain functionality apply for all api middleware routes . similar to the concept of _document.js or _app.js . i could use this for : logging all requests and responses in and out . some transformation . whitelisting or black listing requests . error tracking/handling really anything without having to import a function from a utility for each route . the solution you 'd like something like a pages/api/_middleware.js that would default to current working directly and work up if i want to only opt-in or opt-out in some scenarios ( so i could have pages/api/foo/_middleware.js only be middleware for api/foo/ * endpoints if i wanted ) this would handle : preflight request middleware support post response handling middleware error handling middleware maybe something like : many other alternatives i 'm sure but conceptually this feature would be nice . seen another issue where they just wanted in `` onerror '' i think this capture more use cases < code > import cors from 'micro-cors ' // none of these ideally would allow sending response back before hitting a route . export async function prerequest ( req , res ) { const cors = cors ( { allowmethods : [ 'get ' , 'head ' ] , } ) return cors // could wrap functions around each routes exported function , or do something with req or res like logging } // not sure if i like the naming export async function postresponse ( req , res ) { // same as above } export async function onerror ( req , res ) { // maybe not needed and could just capture in postresponse }
feature request is your feature request related to a problem ? please describe . we 're using the api rewriting feature of next.js to rewrite calls to a backend system . this system expects all api calls to be authorized with a bearer token in the authorization header . however our next.js frontend is using a session cookie to hold the token . given the current feature set we can not proxy calls to the backend system unless we manually write the rewrites . describe the solution you 'd like the ability to rewrite parts of the incoming/outgoing request as its re-written to the remote . this would probably take the form of some sort of middleware function . describe alternatives you 've considered we 're unable to change the backend system to extract the token from a cookie rather than the authorization header . we 've also considered manually proxying the calls using something like the technique described here , but this requires a bunch of extra dependencies , something our environment is sensitive to . additional context this is somewhat related to # 17557 < code >
next.js/packages/next/server/lib/find-page-file.ts lines 41 to 43 in f637c8a if ( await iswriteable ( pagepathwithindex ) ) { foundpagepaths.push ( relativepagepathwithindex ) } i 'm working with next.js in containers , and this check turns permission problems into silent failures . is there a reason the page needs to be writable , or even readable to be a candidate ? an existence check instead would have been helpful to me in debugging , but i 'm not sure if next.js attempts to write to pages at some point , or if ignoring unreadable files is desired for some other reason , so i 'm asking this question before opening a pull request . : ) < code >
feature request is your feature request related to a problem ? please describe . one limitation with the api/ folder is that it requires you to have your api under /api . i 'd like to define an api directly from the base url . i understand this is possible when using a custom server but i do n't want to switch to a custom server since that would remove some performance optimizations that next 's internal router adds . describe the solution you 'd like maybe it 's possible to decide in each file whether it 's a page or an api endpoint , like this : originally posted by @ lucleray in # 7297 ( comment ) or if we could just use the next router to custom define the api endpoint , that would be great . describe alternatives you 've considered this example using express seems to be the best alternative : < url > < code > // pages/index.js import { api , page } from 'next ' // an api endpoint export default api ( ( req , res ) = > 'hello ' ) // a page export default page ( ( props ) = > 'hello ' )
hi , i was wondering if you could add an option to prefetch data even when a page uses getserversideprops . something like < link serverprefetch= { true } href= '' /post/ [ id ] '' as= '' /post/1 '' > < /link > thanks . < code >
i just created a next project with 10.0.1 and pages that have text only are not showing the `` thunder pre-rendered page '' indicator , tried but it does n't work . what can i do ? , the feature it 's gone for ever ? : ( < code > module.exports = { devindicators : { autoprerender : true , } , } ;
in my app , each user has a page , and each page has an image . i am storing the image externally at storage.googleapis.com/bucket/images/users/ [ username ] /image . because the image path is static per user , but the image itself can change , i am updating a query param in the src so the browser does n't use a cached image since it may have changed ( following guidance of option 2 in this stackoverflow answer ) . imageuploadeddatetime is a react state variable that i am updating when the user updates the image . i am wondering how next/image handles this scenario ? i am guessing next/image will have to re-optimize every server render which kind of defeats the purpose of the optimized image , but i just want to confirm . i know the proper & more robust solution would be to use a unique url for each uploaded image so there is no conflict or cache issue , but if next/image handles scenario this reasonably , it will simplify the logic in my app and reduce the number of db reads that have to be performed . < code > < image src= { ' < cur > { imagepath } ? < cur > { imageuploadeddatetime } ' }
i 'm using next with hapi custom server , now ever since i introduced the next/image component i 've been having issues with images showing sometimes , currently , the biggest issue has been once i upload a new image to a folder called uploads in public next will not see it but once i restart the server it 'll be seeing it i 've traced once which i am very sure the image uploaded but it 's not inside the publicfiles set instance i do n't know i have tried to reproduce it with a new project < url > but it 's working fine and i do n't know what i 'm doing wrong in the main project < code >
in the debugging section of the docs , it is mentioned that a debugger can be attached to the nextjs process by using inspect flag , it is also mentioned that in commands such as npm run dev the debugger should be attached before starting the next process , and not outside the whole process , as it would try to attach debugger to both the npm process as well as the next process . in my case , i am using a custom server , so my dev script looks something like this node server.js . this server.js internally calls nextjs . i am not able to figure out how to attach a debugger to next js in this case ? when i add the flag to this command , it starts a debugger for server.js , but also tries to attsch a debugger for another process , which fails ( i am guessing the other process is next ) has anyone figured out how to do this ? < code >
how to make the public assets that came from the public folder came with the md5 checksum . now it has no cash at all , and it 's loading all the time . < code >
i wanted to build a boring old form yesterday and ran into a problem . i wanted the form to post the data against the page itself , so i could show the form again with ssr error messages if something goes wrong . on success , i would redirect to a confirmation page . really basic form flow which has been done since 30 years 😁 my idea was : okay , you get the req object in the context object of getserversideprops , so data processing should be a no brainer . the problem is that - yes , the req object is there - but the request body is not parsed in any form and this would have to be done by the dev manually . even more - you need to read the request body from a buffer first and turn it into a parsable string on your own . when i post the form against an api route , suddenly the req object is treated differently by next and i can access req.body which contains the parsed request data , based on content type . the point is : this is confusing . it does n't matter if its an api request or a request against a page route - they are both http requests and the framework should parse the request bodies similary . since the logic is already there for api routes , it should be applied to all other routes as well . < code >
doing a redirect in an api server call is adding a # sign to the end of the url . the url ends up being anyway to get rid of that extra # ? < code > res.writehead ( 302 , { location : '/forecasting ' } ) res.end ( ) < url >
hello , on the client side , i need to use an environnement variable prefixed by next_public_ in a .env.local file . so i created a .env.local file with this content : after that , i executed the following commands : after that , everything was ok and the value of console.log ( next_public_test ) was burger as expected . but then , i tried to change the value of next_public_test to banana and i re-executed this command : but the content of console.log ( next_public_test ) was still burger and not banana . i had to re-execute next build and next start to update the value of next_public_test . so it seems like environnement variables on client side can only be defined at build time . question : is there any way to define environnement variables on client side at run time instead of build rime ? i am using next v9.5.5 . < code > next build # then i got this message loaded env from path/to/project/.env.local info - creating an optimized production build ... done in xx.yys . next start # then i got this message loaded env from path/to/project/.env.local ready - started server on < url > next_public_test=burger
hi all , i have an express middleware in my next.js app that could pass to the express instance an error : i do n't understand how to render the error custom page from my express error handler function . i reproduce the problem here where : my base path is set to `` /preferences '' ( next.config.js ) attach to `` /preferences '' a middleware that returns an error ( see ) and my error handler : but instead of rendering _next.js component it returns all assets with status code 500 : it access properly to the error handler ; what am i wrong ? < code > function ( req , res , expressnext ) { //returns an error : expressnext ( err ) } function errorhandler ( err , req , res , next ) { console.log ( `` error handler with error '' , err ) ; res.status ( err ) ; return app.render ( req , res , '/_error ' , req.query ) ; }
i know there 's a known pattern for using persistent components at the root level of app by creating a layout component and making use of it inside of the _app.js file : and it works great for top-level things like header , footer , etc . but how can i achieve the same in some nested component ? suppose i have something like this : and the idea is to whenever i navigate from photo to video i want media component to be left unchanged ( unmounted ) . for example , it can be useful for some tab animations or just state keeping . i 've seen some hacks like adding a component.layout property and then checking for it in _app.js but it has 2 big disadvantages : it does n't let you override the title , both video and photo will inherit the title form media it wraps the whole page including implicit < main > < /main > and it can break the semantics and layout is there a way to achieve it without using any hacks ? i heard twitch is using next and it seems like they have solved this issue . < code > media ( /media ) > photo ( /media/photo ) > video ( /media/video ) < layout > < component { ... pageprops } / > < /layout >
how do you guys do server side redirects right now ? using this : works when you 're typing the url ( or you are not in the app ) and going to the page but when you 're already in the app and try to visit a page that has this logic implemented the whole app crashes : error [ err_http_headers_sent ] : can not set headers after they are sent to the client when i 'm trying to find a solution everyone says that `` it 's a known issue , use clientside redirects instead '' or `` here 's an rfc '' and these answers are kind of outdated . so i was wondering how do people implement ss redirects in their apps ? i do n't believe that everyone is just using client side redirects < code > // inside of getserversideprops if ( context.res ) { context.res.writehead ( 303 , { location : target } ) ; context.res.end ( ) ; }
cookies are showing in the the following code in my local environment , but not on my production server : i 'm using apolloboost : and custom graphql-yoga server with express : any suggestions would be much appreciated . i might not be sending headers correctly within the configuration somewhere , but i 'm stumped . < code > function createserver ( ) { return new graphqlserver ( { typedefs : `` src/schema.graphql '' , resolvers : { mutation , query } , resolvervalidationoptions : { requireresolversforresolvetype : false } , context : ( req ) = > ( { ... req , db } ) } ) ; } function createclient ( { headers } ) { return new apolloclient ( { uri : process.env.node_env === `` development '' ? endpoint : prodendpoint , request : ( operation ) = > { operation.setcontext ( { fetchoptions : { credentials : `` include '' } } ) ; } } ) ; } export async function getserversideprops ( ctx ) { const pageprops = { } ; console.log ( ctx.req.headers.cookie ) ; console.log ( ctx.req.cookies ) ; return pageprops ; }
feature request since v10 it is possible and much cleaner to do ssr redirects using : < url > it is however not possible to set headers using this approach . imagine we have a `` authenticated '' using cookie auth . when cookie expires is invalid , we would like to redirect user to /login and clear the cookie using set-cookie header . describe the solution you 'd like add a headers attribute to the redirect type : describe alternatives you 've considered currently this is possible to do using old approach and manipulating context 's response directly . this solution is however not as clean . < code > export type redirect = | { statuscode : 301 | 302 | 303 | 307 | 308 destination : string basepath ? : false headers ? : outgoinghttpheaders } | { permanent : boolean destination : string basepath ? : false headers ? : outgoinghttpheaders } context.res.writehead ( 302 , { location , ... headers } ) ; context.res.end ( ) ;
with i18n enabled , under what circumstances is locale in const { locale } = userouter ( ) , getstaticpropscontext and getserversidepropscontext undefined ? this context has shown up in my logs and i need to handle it by falling back on defaultlocale . is it a feature or a bug ? i might be mistaken , but i think it is new . i think locale always has been defined until recently . < code > { locales : [ 'en ' , 'sv ' , 'en-gb ' , 'sv-se ' ] , locale : undefined , defaultlocale : 'en ' }
hello . i 'm new to next version 10 and i just heard of this thing called issg . it sounds really good to be honest , and i read some articles about it from arunoda 's blog : < url > forgive me if this sounds noob , but these are the questions i want to ask regarding issg implementations : even though the tutorial says that issg can be used and good for e-commerce , i want to ask how good it is ? is it good for a private e-commerce site where you only sell your own stuff , or can it be used for a dynamically user-generated content e-commerce site ( e.g : amazon ) ? should i use issg for a page that implements multiple user-generated contents ? like for example an amazon/medium/reddit clone ? based on the explanation , the pages would be built on build time , so it would build too many pages , right ? should i stick with ssr or follow the tutorial of `` part ssg , part client-side api implementation '' if i want to make such types of sites/platforms ? < code >
feature request is your feature request related to a problem ? please describe . i 'm looking to have a hybrid website with a combination of ssg and ssr pages . the goal would be : to have ssg pages , static assets , etc , exported at build time and hosted on a cdn . to have ssr pages running on a custom server setup describe the solution you 'd like have a few different configuration settings added to the config for production output : ssgbasepath - specifically for ssg pages , have a basepath that applies to them . this would be used when outputting production routes ssrbasepath - specifically for ssr pages , have a basepath that applies to them . this would be used when outputting production routes in links and all underlying assets . for cases where the cdn and customer server are on different subdomains we may also need : ssgprefix - prefixed transport and domain for ssg pages ssrprefix - prefixed transport and domain for ssr pages i 'm sure there are some edge cases with other configuration settings that have overlap or are for some other use case . however i 'm sure we can identify those conflicts and come up with a reasonable warning message if the config is setup in such a way that the system does n't know how to behave . describe alternatives you 've considered i have really only one solution at the moment . i 'll have to host my own custom server configuration and use no cdn . < code >
hey guys , i 'm just starting exploring next.js and migrating my app from create-react-app to next.js . so far it looks amazing ! but i run into a problem with fetching data from a remote endpoint . in the current create-react-app , i 'm requesting data within app.tsx ( useeffect hook ) which is then getting saved to redux store . when you navigate through the app , the page components select data from this store , therefore no additional api calls needed . this saves me tons of money as i host everything on aws and instead of having an api call per page i have only one call at the initial app render . so , i am curious how can i achieve the same result with next.js ? are there any possibilities to have a similar approach with ssg ? if not , what would you recommend me in this case ? any help is much appreciated . thanks ! < code >
not sure why i am having such a hard time with this . i 'm trying to setup a custom rewrite rule for any path that contains the string badge . here is what i am using , but when i try to visit a route similar to /random-badge it always rewrites to the `` legacy rule '' below : other rewrite rules such as / : url ( badge ) seem to rewrite to the correct page but i ca n't it pull off unless i try to match the exact string . am i missing something ? < code > async rewrites ( ) { return [ // badge rule { source : '/ : url ( . * badge . * ) ' , destination : '/badge-page ' , } , // legacy rule { source : '/ : path * ' , destination : '/ : path * ' , } , { source : '/ : path * ' , destination : '/api/legacy/legacy-page ' , } , ] } ,
i am using nextjs in my application .when application load all ( or first time when contend is rendered from server ) my meta tag are on top .but when i click to any button client side rendering start then my meta tag move to end why ? here is my code < url > steps to reproduce the bug . when application load first time .it load all meta tags on top . click on about link see below screenshot.meta tag move to bottom why ? < code >
i 've reconfigured my app based on this official example and i 've got it to the point where i have my data cached and set to initialapollostate , but i 'm having trouble figuring out how to get the extract the data from this object on each page . my pages are dynamically created from getstaticpaths which queries a graphql api that is set up to query rest api endpoints . my old setup ( which did not allow for ssg , which is why i had to reconfigure ) , the getstaticprops function used the page id parameter to query that specific id and get all the data needed for that page and set them to props . this new setup however , seems to set the data to the initialapollostate object with the id attached to the object name itself . for example , one of the prop objects is named tourdossier:33887 , so i do n't know how i 'm supposed to extract any data from this object when it will have a unique name on each page . i suppose i 'm just lost on how i 'm supposed to extract data when using apollo and ssg using the official example i listed above . the example is very simple and there seems to be another layer of complexity when using getstaticpaths and the id parameter from the path in the getstaticprops query . any help or docs to read would be greatly appreciated . < code >
when i map array and give image link to components , it caches images and shows them incorrectly : | than i check image on url and is another than was drawn in component : | what can i do for this ? < code >
i 'm aware we can use getinitialprops , or getserversideprops from a page to query things on the server . in gatsby ( i know , static vs ssr ) , we can use usestaticquery , in php everything is server-side . in nextjs is it completely impossible to query things within components on the server ? i ca n't find any documentation around it . if so , why ? < code >
i 'm using next.js 10.0.1 with svgr loader for svg files . when using bundle analyzer , i found out that all svg files got bundled into every page ( even if it is not imported ) , which make the page bundle gets a lot heavier is this normal behavior ? is there a way to eliminate or separate those svg bundle ? < code >
article : < url > github : < url > this tool ( rome ) seems to be of very high quality and aims at replacing the whole js toolchain ( linters , etc . ) and combine many tools into one . i know it 's a bit early , but the project has drawn quite a bit of attention , with 13k stars already . i 'd like to know if you 're considering it to eventually replace some tools currently used by next.js ( e.g : babel , webpack , eslint ) has there been any attempts/tests/pocs about replacing the current toolchain with rome ? not only am i interested to know about whether it 'll integrate with next.js ( and whether it 'll be compatible with the next.js/vercel build chain , instead of webpack ) , but i 'm also interested about using it within next right now for all the benefits it might bring . at the time of writing , rome can only be used as a js/ts linter . < code >
i am using next.js v 9.5.5 ( so no image component yet ) i am importing images this way : this site will be published in a domain subfolder . so the images finally will have to be in /subfolder/images/book-img.png . how can i make the image path work in dev as well as in next export ? for assets such as css and js , basepath : /subfolder works fine . but for images linked in this way , no . please help < code > < div classname= '' xyz '' > < div classname= '' book-image '' > < img src='/images/book-img.png ' alt= '' image '' / > < /div >
do you have more control and information over deployments and `` under the hood '' operations with the paid tier ? i completely understand that vercel is a business and i have no problem with upgrading to the paid tier & incentivizing people to use vercel - people should see the fruits of their labor - but the documentation on deployment outside of vercel is abysmal to be frank . i also understand the whole allure is how simple it is to deploy and it is exceedingly simple and feature rich . i just want to know if i proceed to pilot nextjs for a potential business if i will be able to have more insights into my application and be able to have a second form of deployment in the case that terms change/something happens to the company/etc etc . thank you ! < code >
hello , i found i can not serve static files from public directory when i use i18n domain routing served from vercel . default locale serves correctly but the others returns 404 status . here is a simple reproducible example . < url > this app is served from vercel via the url below . < url > i mean i can not get < url > thanks a lot : ) < code >
i 'm looking for a way to implement a redirect or rewrite that gives me access to the req object . example scenario : i 've reimplemented this route : / : site/page/ : slug * to be just /page/ : slug * the dynamic : site is still important to me , but i 've decided to provide this context in a request header ( my app is behind a gateway ) . but to help with development , i want to rewrite /some-site/page/some/path to /page/some/path but also set a request header like x-context-site=some-site . in getserversideprops i can then do : so with this implemented in next i can imagine config like this : < code > const site = context.req.headers [ `` x-context-site '' ] ; const slug = context.query.slug ; redirects : async ( ) = > [ { source : `` / : site/page/ : slug * '' , destination : `` /page/slug * '' , permanent : false , req : ( req , context ) = > { // the context is the source context req.headers [ `` x-context-site '' ] = context.query.site ; return req ; } } ] ,
hello everyone , i know that it seems like an issue but i 'm not sure , so this is why i think it 's better to ask here . if we look at the demo of the next image component with the intrinsic layout here , it does n't seem to change the loaded image ( and it 's weight ) depending on the screen size . on my laptop , when i 'm loading the page in fullsize , it 's loading an image with a 18.6kb weight . if i resize with chrome tools , to a phone screen size , the weight is still the same when the page loads . if we have a look at the srcset , it 's only changing the image depending on the resolution . is it the expected behavior or is this an issue ? i thought it was designed to automatically optimize the loaded image depending on the screen size . thanks for your help : ) < code >
hey ! i am attempting to add redirects to my next.config.json and i am wondering if this specific use case is supported . our old app uses a path like : /example.php ? id= : id our new app uses a path like : /example/ : id would something like this be possible ? if not , what would be a good approach to solve this ? here is what this potential solution would look like in the next.config.json : module.exports = { redirects : async ( ) = > { return [ { source : '/example.php ? id= : id ' , destination : '/example/ : id , permanent : true , } , ] ; } , } ; < code >
bug report describe the bug when i replaced my app from react to preact , i kept both ssr and client-side rendering of my page content to reproduce i replaced my react and configure next.config according to using-preact in examples , but when i build and start to access my page , i now find that my page has duplicate content and the dom tree is as shown in the figure above . expected behavior i hope it should display my page correctly . screenshots config < code >
i 'm trying to load an image from an external source using next/image however it is prefix the image url with /_next/image i guess serving it form the public folder . how can i load from an eternal source ? < image src= '' < url > alt= { name } width= { 300 } height= { 300 } / > < /imgwrap > module.exports = { images : { devicesizes : [ 640 , 750 , 828 , 1080 , 1200 , 1920 , 2048 , 3840 ] , imagesizes : [ 16 , 32 , 48 , 64 , 96 , 128 , 256 , 384 ] , domains : [ 'images-na.ssl-images-amazon.com ' ] , loader : 'imgix ' // path : ' < url > } , target : 'serverless ' , env : { api_key : process.env.api_key } } < code >
is there a way to terminate a database connection pool before the application shuts down within api routes ? the workaround i 've seen is creating a custom server with something like express , then using a sigterm watcher such as terminator . the problem with this is , the db connection pool would be outside of the api routes within next.js and therefore api routes would need to use express rather than using api routes . is there a better , more `` next.js '' way of handling this in order to take advantage of api routes ? thanks ! < code >
by default query variable type alway string | string [ ] but sometime i need to define specify type form query how can i redefined query variable type ? < code > type category = `` apple '' | `` banana '' type articleid = number const { query : { category , articleid } , } = userouter ( ) ;
feature request be able to add -- max-http-header-size to increase the maximum header size allowed passed 8k that is built in with node.js is your feature request related to a problem ? please describe . after the node.js update that decreased the max http size down from 80k to 8k we 're trying to allow a higher header size so users arent dealing with the 431 error describe alternatives you 've considered we tried using cross-env and it works locally , but once deployed to the dev environment ( using azure ) , the flag is ignored or it throws an `` export : -- max-http-header-size bad variable name '' error < code >
how to access .next/server on vercel when running build : rss script : vercel throws error : whereas netlify works just fine . < code > { `` export '' : `` next export '' , `` build '' : `` next build & & npm run export & & npm run build : rss '' , `` build : rss '' : `` node ./.next/server/scripts/build-rss.js '' , `` start '' : `` next start '' , } > node ./.next/server/scripts/build-rss.js 15:14:05.786 internal/modules/cjs/loader.js:968 15:14:05.786 throw err ; 15:14:05.786 ^ 15:14:05.786 error : can not find module '/vercel/workpath0/.next/server/scripts/build-rss.js ' 15:14:05.786 at function.module._resolvefilename ( internal/modules/cjs/loader.js:965:15 ) 15:14:05.786 at function.module._load ( internal/modules/cjs/loader.js:841:27 ) 15:14:05.786 at function.executeuserentrypoint [ as runmain ] ( internal/modules/run_main.js:71:12 ) 15:14:05.786 at internal/main/run_main_module.js:17:47 {
hi all , i 'm building an app accessible from multiple domains , where each domain can have its own locales . here is an example : example.fr - > the first domain , it has only one language ( french ) example.fi - > my second domain , it should have 2 languages : example.fi ( finnish ) and example.fi/sv ( swedish ) example.be - > my third domain , it should have 2 languages : example.be ( dutch ) , example.be/fr ( french ) so in total if i have a page /about , it should be available on : example.fr/about example.fi/about example.fi/sv/about example.be/about example.be/fr/about as i read docs , current next.config does not support this scenario , or am i missing something ? i managed to achieve that by having 3 separated next.js instances as docker containers passing envs to each of them . obviously , this makes it way more complex , so i 'm thinking around the alternatives to my solution . thanks a lot and stay safe ! < code >
hi , i was wondering is it possible to make imagesizes work with wordpress image sizes ? i can not seem to make it work . is there any way to provide custom srcset as fallback ? thank you < code >
bug report describe the bug urls that result in 404 's are creating new files in .next/server/pages , when it should be serving the single cached 404 page . we are running with fallback : false , and generating all pages at build-time . i 've noticed that removing the call to getstaticprops in our 404.js solves this issue , but our use case requires us to read data from the filesystem to generate the 404 page . how to reproduce pull down < url > build using next build run using next start visit a 404 url such as hello or test observe .next/server/pages create html pages for these 404 urls . context we noticed a huge spike in storage used in our next.js production instance . when looking into it , we saw that the .next/server/pages directory was filled with bot traffic urls that should of received 404 responses . this quickly consumed our entire 64gb storage capacity for our production server . now we have thousands of bot produced urls in our .next/server/pages directory . screenshots system information os : macos version of next.js : 9.5.0 version of node.js : 12.18.4 deployment : next build & & next start < code >
bug report describe the bug when developing using `` next dev '' the _app page is invoked before the underlying page . this makes _app home to a lot of central configuration - e.g . firebase initialisation . when building for production using `` next build '' the individual page is invoked before _app . this has the consequence that components might be used before being configured . to reproduce steps to reproduce the behavior , please provide code snippets or a repository : create a standalone file that configures firebase ( this is customary ) import said file at the application entrypoint ( index.tsx in create react app , pages/_app.tsx in next ) somewhere else in the application import firebase for usage using `` import * as firebase from 'firebase/app ' '' . use firebase functionality . this succeeds during `` next dev '' but fails during `` next build '' . expected behavior the same behavior is expected whether next dev or next build . there does n't seem to be any reason for the order of invocation to change . system information os : macos catalina version of next.js : 10.0.1 version of node.js : 12.18.3 deployment : next dev and next build < code >
hi , i 'm wondering why almost no materials / guides are available regarding these two different but similar topics : after building a next.js app and deploying it to the production , the sources are minimized , which means , if a bug happens and we want to debug it directly on the production environment , it 's almost impossible to deeply understand where is the problem in the original source code . sourcemaps are supposed to solve this issue ( by mapping the minimized js files to the original sources available on the developer 's computer ) . the questions are : how to configure next.js to create these sourcemaps on build where to place them ( should they be deployed to the production server along with the minified files or kept on the developer 's machine ) how to configure chrome to use these source maps , and how to tell chrome where the original sources ( which are mapped to ) sit after building a next.js app and statically exporting it ( so it runs on serverless setups such as aws s3 etc ) , we deploy the static export ( under `` out '' folder ) to the web server . how to debug this setup ? do sourcemaps work here too ? can someone shed some light on the issue ? thanks ! ! < code >
i want to use < url > to generate sitemap . however , when i use it normally like : next-sitemap.js it generates sitemap for all my posts . although , in my .mdx files , i have a published key to know whether the post is a draft or it is ready to be published like : how do i read the published key from .mdx file so i can generate sitemap of only published : true posts ? note : i ca n't use < url > because my .mdx files have an exported object as metadata . < code > module.exports = { siteurl : ' < url > ' , generaterobotstxt : true , } export const meta = { title : 'hello world ' , date : '2020-09-11t14:54:37.229z ' , tags : [ 'hello ' , 'world ' ] , author : 'akshay kadam ' , published : false , } # hello world this is my first blog post , not yet ready to be published
hi , i have a page that exports getserversideprops . what i would like to know is how to prohibit the page to re-fetch the server side props and use cached ones when re-visiting the page in the same session ( e.g . click on a link away from the page and then click back to the same page ) . re-visiting the page is now slow-ish , and i get unnecessary server communication . i use apollo , and when i do not use server-side props , all data is served from cache and blazing fast . < code >
i just noticed that apparently my next build is broken , while next dev works fine . i have absolutely no idea why and the error message is astoundingly useless ( although that 's on webpack , not vercel , i think ) . this happens when i run next build since i assume it is relevant , these are my dependencies : i 'll work on whittling this down to a minimal example but honestly , i do n't have time for this s * * * and i hope that someone on here can enlighten me as to what is going on here . < code > < cur > ./node_modules/next/dist/bin/next build info - creating an optimized production build failed to compile . modulenotfounderror : module not found : error : empty dependency ( no request ) > build error occurred error : > build failed because of webpack errors at build ( /path/to/my/project/node_modules/next/dist/build/index.js:15:918 ) at processticksandrejections ( node : internal/process/task_queues:93:5 ) < cur > `` dependencies '' : { `` next '' : `` 10.0.1 '' , `` postcss-flexbugs-fixes '' : `` ^5.0.1 '' , `` postcss-preset-env '' : `` ^6.7.0 '' , `` react '' : `` 17.0.1 '' , `` react-dom '' : `` 17.0.1 '' , `` tailwindcss '' : `` ^1.9.6 '' }
hello 👋 does someone happen to know if it 's possible to receive the current router/page context in the reportwebvitals function that you can set in _app ? after some quick glancing and some attempts , it seems like you 're currently only limited to getting the web vitals data with no additional context attached to it . i think it would be beneficial to also have additional ( page/router ) context , so it 's easier to keep track of pages that could need some more tweaking . < code >
sup ppl ! 👋🏼 i 'm working with nextjs + tailwindcss . ( lovely couple 💐 ) i 'm trying to put an image component inside a wrapper with fixed width and height and the image fills the most upper parent of the component . here we have the code snippet ! and the screenshot . you can see the parent in green and the nav in pink . it 's simple , but i do n't know why i ca n't make it work . i assume the image component is focused in other use cases , so i will be using normal image , but i still want to learn how to use it , for real haha . thanks a lot for your time ! 😄 < code > < nav classname= ' w-full h-24 bg-pink-200 fixed top-0 ' > < wrapper classname= ' h-full ' > < div classname= ' w-56 h-full bg-green-500 ' > < image src='/img/logo.png ' layout='fill ' / > < /div > < /wrapper > < /nav >
currently amp only supports css-in-js right ? i 'm working on a project where all styles are stored in sass files , which wo n't be loaded on the amp version and that 's fine , i understand why . so i suppose that in order to create styles for the amp version , i should create a tag < style jsx > or < style jsx amp-custom > or even < style amp-custom > with them . the issue here is no matter which of those tags i use , they will all render the styles also on the non-amp version , which should not be used . should n't setting up the attribute amp-custom on a style tag only render the respective styles on the amp version ? using a condition based on useamp ( ) to render that style tag does not work , as it wo n't parse the styles to the head tag . ex . : { useamp ( ) ? < style jsx / > : `` } might there be any other functionality to render the css-in-js conditioned by the version of the page ( either amp or non-amp ) ? i believe that when css modules are made available as a way to set the styles for amp pages , this wo n't bother anymore and that this is the only proper solution for the problem . but please tell me if i am wrong and if there is any solution that i have not come across ( i have searched for quite a while and i have n't found any issue closely related , so i might be missing something ! ) . thank you in advance for your kind attention ! < code >
hi , i am dealing with authentication , is this ok to render loginpage for any url when the user is logged out ? < code > // _app.js { user ? < component { ... pageprops } / > : < loginpage / > }
i am serving images from the public folder with next/image 's default loader . if i am understanding the docs correctly , currently these images will be generated on request and cached for 60s , but then deleted and regenerated again when they are requested after that . is it possible to only generate images once , the first time they are requested , but then cache them indefinitely ( or with a much higher ttl ) ? < code >
i have a small project three modules : a next.js frontend , an express backend , and a bunch of common code shared between the two . everything is in typescript . i have ci set up to run on every commit . even at this early stage , `` next build '' takes 45 seconds to run , which is more than half of the total build+test run . is there a quicker way to check that the frontend code is not broken without doing the full production next build ? < code >
i wrote a tutorial on building an image gallery with nextjs using pexels api and chakra ui on freecodecamp . how to build an image gallery with nextjs using the pexels api and chakra ui github repo : < url > deployed : < url > let me know if you have any feedback or suggestions . p.s . i know that the url slug is wrong , and i am working on getting it resolved . < code >
reading the documentation on data fetching , i am not clear for what is the difference apart from cdn caching if i choose fallback : true in static rendering for my dynamic routes . here is my understanding - : let 's say i have [ somedynamicpageslug ] .js and i will need to have getstaticpaths to render top 10 slug pages and getstaticprops with fallback : true will serve rest of the pages generating them on demand for first time and then next time it will serve it right out of cdn . now , it is mentioned under getserversideprops when to use section that in increases the time to first byte ( ttfb ) . my first question is will not fallback : true do the same for first time render of a page which does n't exists in getstaticpaths and have same ttbf ? i 'm asking because , i 'm evaluating if i can simply use getserversideprops with manual caching option instead of defining getstaticpaths and getstaticprops with fallback : true . second question is that is there any seo impact in picking one strategy over the other . the way docs are put up there does n't seems to be but if someone has worked on the scale of million metrics and have seen any difference please let me know . i will appreciate to sufficiently deep these about it . how they work internally ( if possible ) as reading the docs , gives a black box to people like me for inner workings of it . thanks in advance ! < code >
it would be awesome if a next.js site would request client hints . specifically , if we can get the dpr the image component can intelligently request 2x/etc images . if a client only has a dpr of `` 1 '' then there is little reason for the 2x image to be included . < code >
if i include an image in a next app , and i look in the console , it fails with code 403 , whereas when i create a blank html file with just am img component with the same url , the image loads . < code >
feature request please provide a way to use a private repo as the source when using create-next-app is your feature request related to a problem ? please describe . currently we are using other tools to clone/update references for fresh projects . it would be great if we could use the tools that next provides ! describe the solution you 'd like currently when using an example other than default with create-next-app it is using http . it would be great if we could pass in a pat for private repos . or if there was a way to have the script use the native git client that might be a great alternative ! describe alternatives you 've considered currently we are spinning up a laravel project alongside our next.js frontend so we have had to hack in some workarounds since private repos do n't work . < code >
dear nextjs community , server-side rending is important in some of the pages we have in our platform , i 'm using apollo client and a version of a withapollo ( # 9542 ) h.o.c . to achieve ssr on the pages i need it , this hoc uses getinitialprops . now for some pages this might be a bit slow , so i started thinking about caching . i figured out that hosting on vercel , i can set cache-control headers for serverless functions , and i was wondering if this is the right way to go if i put for example : in my pages getinitialprops , also read a bit about ssr with incremental builds , but i 'm not sure if that 's reasonable to do in this case , since we might have 50.000+ of these pages at one point and they need to be updated when new information is available . there is only a few limited actions that we need to do though before this information needs to be re-regenerated . any tips / advice ? < code > ctx.res ? .setheader ( `` cache-control '' , `` s-maxage=7200 , stale-while-revalidate '' ) ;
i have in pages api/hook that receives data from a webhook to my post route /api/hook . i then need to make this data available globally throughout my application . a customer will go onto the site and place an order the webhook will then trigger and the data available from the post route but i need the data available in the frontend of my application once the webhook has triggered . how can i make the data available once the order has been placed and webhook triggered ? webhook { `` content '' : { invoicenumber : '01201 ' , finalgrandtotal : ' 8.99 } } api/hook.js < code > export default async ( req , res ) = > { const { method , body } = req if ( method === 'post ' ) { res.statuscode = 200 res.setheader ( 'content-type ' , 'application/json ' ) res.end ( json.stringify ( { 'msg ' : body , } ) ) try { const url = ' < url > { body.content.invoicenumber } & orderamnt= < cur > { body.content.finalgrandtotal } & numofitems=1 & cur=gbp ' const response = await fetch ( url ) console.log ( 'response ' , response ) console.error ( response.status ) console.log ( url ) } catch ( error ) { // console.error ( error ) ; } } else { res.status ( 200 ) }
@ lfades @ timneutkens @ leerob please help , i 'm really confused now . ( note : this does not happen when running yarn dev , it only happens when doing yarn build and then yarn start ) . i 'm following along this example : < url > where i 'm using the component firebaseauth inside < url > exactly as it 's shown there . i have a login page that exports a login component , like below : this page is linked from the main page . if i click the link from the main page i can get to the login page and the auth component renders normally . but if i go to the browser and type out the full address ( e.g . localhost:3000/login ) then i got the following error i 've spent hours on this and i 'm completely confused now . please help . thanks ! < code > export default function login ( ) { return ( < div classname= { loginstyle } > < div > < firebaseauth / > < /div > < /div > ) ; } uncaught error : could not find the firebaseui widget element on the page .
feature request is your feature request related to a problem ? please describe . the < image / > and < link / > component make use of useintersection . it would be great if that hook would be publicly available describe the solution you 'd like expose hook useintersection for public use : < code > import { useintersection } from 'next/client '
hello , been struggling with environment variables for some time . i have a file .env.development inside which i declare 3 variables , all with the next_public prefix like so : next_public_hostname=localhost next_public_port=3000 next_public_host= phofurl they are neither available in the code nor on the client-side next version is 10.0.1 < code >
hello ! i have a small problem with my website when i am running the lighthouse report ( you can directly find it here , or you can run a lighthouse report on < url > ) : i think this is in the next build because i do n't have any < link > in my app . if somebody has an idea about how to fix that i will be very happy . you can find the repository here . < code > warnings : a preload ' < link > ' was found for `` < url > but was not used by the browser . check that you are using the 'crossorigin ' attribute properly . a preload ' < link > ' was found for `` < url > but was not used by the browser . check that you are using the 'crossorigin ' attribute properly .
as per the docs , next/images use the upstream url 's cache-control maxage ( otherwise default to 60 seconds if the header is not found ) . is there a way ( or an upcoming pr ) to override the maxage for the images ( either individually or globally ) to a custom value of our own ? example use case : gravatar provides a 5 minutes ttl , but passing through next/image , is it possible to override that to a much higher maxage ? < code >
i am currently trying to use dynamodb in vercel . but i keep getting this error . i created an iam user with the following permissions : amazondynamodbfullaccess awscloudformationfullaccess cloudwatchfullaccess i also changed the environment variable names , and gave them directly like this . < code > accessdeniedexception : user : arn : aws : sts : :764717618004 : assumed-role/cloudwatch_logs_events_putter/l0zfqqmkovxq44u8qwb1yh0f-805fd9d54732e5470e54bf12bd9a25672e379b5 is not authorized to perform : dynamodb : getitem on resource : arn : aws : dynamodb : ap-south-1:764717618004 : table/users const db = new dynamodb ( { region : process.env.dynamodb_region , accesskeyid : process.env.dynamodb_access_key_id , secretaccesskey : process.env.dynamodb_secret_access_key } ) ;
it will be very cool if i am setting the response header in next.config.js . i should add headers [ 'strict-transport-security ' ] = [ { key : 'strict-transport-security ' , value : 'max-age=63072000 ; includesubdomains ; preload ' } ] ; header to https request for seo purpose . i cant integrate express.js with the next.js because of using aws-serverless-next.js framework . i also cant edit my cloudedge @ lambda function . so any advice to solve this proplem for now will be helpful . thank you in advance . < code >
i 'm trying to deploy a fullstack graphql app on vercel . ive gotten the project to deploy but for some reason my api routes are still calling < url > when i think they should be calling my next_public_ ... environment variable . based on the logs i think it would be the client side issue , but i am not sure . any insight would be most valuable . here are the function logs : < code >
i am stuck in a specific situation where my application triggers endpoints through an sdk that my company uses . this means i dont have direct access to post urls inside my application when using next . is there a work around to post to external urls without having to use api routes within the next application ? example : user login in i hit aesop.sdk.login ( { username , password } ) that then posts to phofurl < code >
we are interested in using the basepath option : < url > but i 'm finding a lack of clarity in the documentation around handling urls in the app . links i see that if i set my baseurl to be /docs then i can just use an absolute url to and the base url will automatically be handled so < link href= '' /foo '' > foo < /link > will actually link to < url > and not < url > also , how does basepath affect i18n routing ? when linking to a page , i see that the locale is put before the basepath in the final url : < url > } /docs/foo instead of < url > } /foo . is that expected ? static files how is basepath supposed to affect static files served from the public folder . in my testing , it seems like absolute urls are relative to the origin still and not modified with the basepath as links are so : resolves the image at < url > and not < url > is that correct . so would a i need to prepend all static urls with the basepath like : < code > < img src= { '/ < cur > { router.basepath } /example.png ' } alt= '' '' / > < img src= '' /example.png '' alt= '' '' / >
i am trying to follow the official nextjs tutorial but i hit an initial roadblock ; the first command npx create-next-app nextjs-blog -- use-npm -- example `` < url > returns this error . system details operating system : ubuntu 20.04.1 nodejs version : v15.2.0 npm version : 7.0.10 nvm version : 0.37.0 could somebody help me resolve this issue ? < code > npm err ! code eresolve npm err ! eresolve unable to resolve dependency tree npm err ! npm err ! found : < email > .1 npm err ! node_modules/react npm err ! react @ '' 16.13.1 '' from the root project npm err ! peer react @ '' ^16.6.0 || ^17 '' from next @ 10.0.1 npm err ! node_modules/next npm err ! next @ '' ^10.0.0 '' from the root project npm err ! 3 more ( react-dom , @ next/react-dev-overlay , styled-jsx ) npm err ! npm err ! could not resolve dependency : npm err ! peer react @ '' ^17.0.0 '' from use-subscription @ 1.5.0 npm err ! node_modules/next/node_modules/use-subscription npm err ! use-subscription @ '' 1.5.0 '' from next @ 10.0.1 npm err ! node_modules/next npm err ! next @ '' ^10.0.0 '' from the root project npm err ! npm err ! fix the upstream dependency conflict , or retry npm err ! this command with -- force , or -- legacy-peer-deps npm err ! to accept an incorrect ( and potentially broken ) dependency resolution .
bug report anonymous function warn for a worker.js file ( next v10.0.0 ) describe the bug i just updated my next.js app from v9.4 to v10.0.0 and everything looks alright but i keep this annoying warn on my server console that said : i think this warn is irrelevant because my worker file has no `` function '' . to reproduce steps to reproduce the behavior , please provide code snippets or a repository : update next to v10.0.0 create a worker.js file run see warn in server console expected behavior expect to not showing any warn screenshots system information os : macos 10.15.7 version of next.js : 10.0.0 version of node.js : 14.15.0 version of webpack : 5.0.0-beta.30 ( resolutions ) additional context my setinterval.worker.js file : < code > self.addeventlistener ( 'message ' , function ( e ) { const { timeout } = e.data ; let intervalid = setinterval ( ( ) = > { self.postmessage ( 'tick ' ) ; } , timeout ) ; } ) ; warn - ./src/utils/setinterval.worker.js anonymous function declarations cause fast refresh to not preserve local component state . please add a name to your function ,
hello next.js team , where did vercel/next-site go ? this repository was a valuable resource . it 's disappearance also makes links in the official docs redundant . kind regards , simon < code >
this wasted my time figuring out what 's the problem in my api . my code was like this : i 'm trying return a response with an object ( which is an array element ) from the filtered array . when i dynamically route to the page that uses this api , it does n't have a problem , but when i reload the page or dynamically enter the url of the page that uses this api , it shows the `` typerror : argument entity is required '' what 's intruiging for me is that when i use spread operator on the filtered [ 0 ] array element and store it in a a variable and pass it into the response call , it works i do n't know if its a false report or its really a problem in the entity on my fetch call , < code > import { traffic } from ' .. / .. / .. /lib/trafficdata ' export default function datatraffichandler ( { query : { dataid } } , res ) { if ( dataid ) { var filtered = traffic.filter ( data= > data.dataid == dataid ) var data = { ... filtered [ 0 ] } return res.status ( 200 ) .json ( data ) } } import { traffic } from ' .. / .. / .. /lib/trafficdata ' export default function datatraffichandler ( { query : { dataid } } , res ) { if ( dataid ) { var filtered = traffic.filter ( data= > data.dataid == dataid ) return res.status ( 200 ) .json ( filtered [ 0 ] ) } }
i tried to make a `` regex testing editor '' , which i would like to test whether the given regular expression is a valid regexp or not . the idea is , there is an input , where user will enter a string that will be converted to regexp . however , when i tried to use try ... catch approach when testing the regexp , the next babel catch it first , so i can not do error handling for invalid regexp . is there any way for me to catch the error insteadof next babel ? it would be nice if i can catch the error , and do my own handling during regexp creation . way to reproduce the regexp error catching : the idea is , when i send ' [ a-za-z0-9 ] ' - > should be returning true , since it is a valid regexp . but when i send ' [ a-za-0-9 ] ' ( noticed that i removed z intentionally ) - should be returning false , since it is not a valid regexp . but instead , the next babel catch it first , and throw the error . here , i can not do my own error handling for invalid regexp . any ideas ? < code > const regexpvalidator = ( regexpstring ) = > { try { new regexp ( regexpstring ) ; } catch ( error ) { console.log ( `` not a valid regular expression ) ; return false ; } return true ; }
i 've been trying to adapt next.js/examples/api-routes-graphql/ to connect to a faunadb database via apollo-server-micro . using the supplied fetcher function : i can send queries in and get back results - but i 'm not sure how to pass a mutation through . please could someone point me in the right direction ? thank you ! < code > // index.js const fetcher = query = > fetch ( `` /api/graphql '' , { method : `` post '' , headers : { `` content-type '' : `` application/json '' } , body : json.stringify ( { query } ) } ) .then ( res = > res.json ( ) ) .then ( json = > json.data ) .then ( data = > console.log ( data ) ) ; const query = ' { getallcomments { name comment } } ' ; fetcher ( query ) ;
hey guys . i 'm new to nextjs and i 'm getting used to react-router ( v5+ ) where you can define routes dynamically . so you can easily compose routes with pages/modules , and i have no idea what is the best practice to do the same in nextjs . let 's take a basic example , i have 4 pages : /sign-in contains simple form to authenticate /app contains navbar and app home page /app/settings/user contains navbar , settings sidebar and user settings form /app/settings/account contains navbar , settings sidebar and account settings form in react router we can implement the routing like so : the main benefit is you only instanciate your < navbar > and < settingssidebar > once in the code . with nextjs , it seems that only the _app.tsx can be used to wrap route , and i have no idea what would be the best practice to handle such cases . < code > // apppages.tsx < navbar > < route path= '' /app '' component= { dashboard } / > < route path= '' /app/settings '' component= { settingspages } / > // settingspages.tsx < settingssidebar > < route exact path= '' /app/settings '' > < redirect to= '' /app/settings/user '' / > < /route > < route path= '' /app/settings/user '' component= { usersettings } / > < route path= '' /app/settings/account '' component= { accountsettings } / > // mainrouter.tsx < route path= '' /sign-in '' component= { signinpage } / > < route path= '' /app '' component= { apppages } / >
hi there , very new to next.js and feeling like i 'm missing something ( i 've done a considerable amount of googling/digging through github ) i 'm wondering how to upgrade from next.js 9.x to the latest release . there appears to be an `` upgrade guide '' in the official docs , but nothing on how to upgrade to version 10. is it simply bumping the version number in package.json ? do i need to upgrade any other versions ? can i upgrade react to 17.x as well ? < code >
in next.js conf keynote @ timer mentioned that differential loading for modern browsers is enabled by default . but according to source code of next.config.js this configuration option is still experimental and it 's default value is false . so i 'm a bit confused and wondering should i explicitly define experimental : { modern : true } in my next.config.js ? < code >
i have implemented internationalized routing into my app , here is my next.config.js but i am recieving the following build error when i deploy to vercel . my code builds and works perfectly on my machine , even with a fresh git clone of it . my suspicion is that vercel does not currently support deploying with next.js 10 , which is where internationalized routing was introduced , but i can not seem to find anything confirming this suspicion . < code > 12:22:44.955 | > build error occurred -- | -- 12:22:44.956 | typeerror : can not read property 'defaultlocale ' of undefined 12:22:44.956 | at object.pkvh ( /vercel/workpath0/.next/serverless/pages/about.js:1572:44 ) 12:22:44.956 | at __webpack_require__ ( /vercel/workpath0/.next/serverless/pages/about.js:23:31 ) 12:22:44.956 | at module.ilr1 ( /vercel/workpath0/.next/serverless/pages/about.js:1333:13 ) 12:22:44.956 | at __webpack_require__ ( /vercel/workpath0/.next/serverless/pages/about.js:23:31 ) 12:22:44.956 | at module.hbjj ( /vercel/workpath0/.next/serverless/pages/about.js:804:20 ) 12:22:44.956 | at __webpack_require__ ( /vercel/workpath0/.next/serverless/pages/about.js:23:31 ) 12:22:44.956 | at /vercel/workpath0/.next/serverless/pages/about.js:91:18 12:22:44.956 | at object. < anonymous > ( /vercel/workpath0/.next/serverless/pages/about.js:94:10 ) 12:22:44.956 | at module._compile ( internal/modules/cjs/loader.js:1137:30 ) 12:22:44.956 | at object.module._extensions .. js ( internal/modules/cjs/loader.js:1157:10 ) 12:22:44.956 | at module.load ( internal/modules/cjs/loader.js:985:32 ) 12:22:44.956 | at function.module._load ( internal/modules/cjs/loader.js:878:14 ) 12:22:44.956 | at module.require ( internal/modules/cjs/loader.js:1025:19 ) 12:22:44.956 | at require ( internal/modules/cjs/helpers.js:72:18 ) 12:22:44.956 | at hascustomgetinitialprops ( /vercel/workpath0/node_modules/next/dist/build/utils.js:24:1070 ) 12:22:44.957 | at /vercel/workpath0/node_modules/next/dist/build/index.js:15:3313 module.exports = { i18n : { locales : [ 'en ' , 'fr ' , 'es ' , 'gr ' ] , defaultlocale : 'en ' , } , }
i have deployed website built in next.js and apparently when you deploy a next js app you can find the directory of all the static files and resources which i do n't feel very good about . the directory is generated in this way : mydomain.com/_next/static in my case < url > the next js docs say : to prevent showing a directory listing page , add an index file , such as index.html , which will then show that file instead when accessing the directory 's path . but i really do n't understand what directory should i add the index.html file to ? so where should i exatcly put the index.html at ? and another question : is it bad if i leave this just like that ? does it have any risks or stuff like that ? < code >
bug report describe the bug link fails to trigger a client-side transition under the following conditions : you are using react v17 you have a document level click listener ( for handling the common 'click-outside to close ' behavior or dropdown menus ) the link is conditionally rendered to reproduce minimal repro : < url > expected behavior links always trigger a client-side transition system information os : macos browser ( if applies ) : chrome version of next.js : 10.0.0 version of node.js : 12.8.2 < code >
feature request is your feature request related to a problem ? please describe . react.createportal requires a dom node which is not available server side . on the server side , i would still like to render my portal at the end of the body ( similar to what head is doing in the ) describe the solution you 'd like a utility component that would allow to render its children at the end of the body describe alternatives you 've considered i could render the component at the same place in the dom < code >
hey there ! i 've got a pages structure that looks like this , with the intended route being /wiki/ [ region ] / [ ... destination ] pages wiki [ region ] index.js [ ... destination ] .js my getstaticpaths function located in [ ... destination ] .js looks like this , region is a single string , and those pages load/compile just fine . the destination param however is an array of strings but i get a 404 page . any hints in the right direction would be helpful - thank you ! < code > export async function getstaticpaths ( ) { const apolloclient = initializeapollo ( ) ; const regions = await apolloclient.query ( { query : all_regions_query } ) ; const paths = regions.data.entries.map ( ( item ) = > ( { params : { region : item.slug , destination : item.children.map ( ( destination ) = > destination.slug ) } } ) ) ; return { paths , fallback : false } ; }
hi , i 'm using nextjs on an ecommerce website and i 'm having some issues with a dynamic page . i 've seen a bunch of issues , tried a few different things and i 'm feeling helpless ... i have a checkout page that renders an invoice ( /invoices/ [ orderid ] ) . it uses getinitialprops to get the data from server . the problem i 'm getting is that , when deployed , if i refresh the page , or direct link to that page , i get a 404 page not found ! in the page i 'm using usequery , to get the data : there 's also a usemutation , to get a new invoice : why is this behavior and how do i fix it ? best regards , tiago vasconcelos < code > update_invoice , { refetchqueries : [ `` get_order '' ] , onerror ( error ) { addtoast ( error.message , { appearance : `` error '' , autodismiss : true } ) ; } , } ) ; data : { order } = { } , loading , error , startpolling , stoppolling , } = usequery ( get_order , { variables : { id : props.orderid } , pollinterval : 5000 , } ) ;
hello everyone , i am building a chat web app with nextjs and socket io on frontend part . my project totallty work in dev mode ( when i npm run dev ) . so i decided to put in production my work , backend is on a personal vm instance and for deploying frontend i use zeit/now ( vercel ) . but i have a problem with the frontend part , all the link are unreachable in production mode and i got these error : `` /_next/static//pages/ * * * .js 404 not found '' . it seems that router does n't work . ps : i also try simple to next build and test it in a production mode and i got same error as zeit deployment . here is my code to handle routing using router from 'next/router ' const handlejoin = ( ) = > { ( name & & room ) ? ( router.push ( { pathname : /chat , query : { name : name , room : room } , } ) ) : e.preventdefault ( ) } how to reproduce ? 1 - go on < url > 2 - fill name and room 3 - click on `` entrer '' 4 - tadam look at the console 😞 please can someone help me with this case ? < code >
i am trying to download few css files and put in my project dir before making a build .i works with simple nodejs program like this < url > but when i apply same logic in nextjs i am getting this error i want to download my css file in my css directory before starting the build . here is my code in nextjs < url > < code > const fs = require ( 'fs ' ) .promises ; module.exports = async ( phase , { defaultconfig } ) = > { let res = await axios.get ( ' < url > ) ; console.log ( res ) console.log ( 'dddddd ' ) await fs.writefile ( './styles/css.css ' , res.data ) ; // need to be in an async function console.log ( 'the file hadddds been saved ! ' ) ; return { ... defaultconfig } } ( async ( ) = > { let res = await axios.get ( ' < url > ) ; console.log ( res ) console.log ( 'dddddd ' ) await fs.writefile ( './css/css.css ' , res.data ) ; // need to be in an async function console.log ( 'the file hadddds been saved ! ' ) ; } ) ( ) error : > promise returned in next config . < url > at normalizeconfig ( /home/runner/drycompetentwaterfall/node_modules/next/dist/next-server/server/config.js:7:566 ) at loadconfig ( /home/runner/drycompetentwaterfall/node_modules/next/dist/next
hello , i 'm trying to use a svg image in background of an styled component but i this error is returned : typeerror : c : \users\gutyerrez\documents\hyren network\w.web\src\components\icons\arrowright\index.ts : pass.get ( ... ) is not a function < code >
hi there ! i 'm upgrading my project to v10 on a branch , and using next start to deploy my app . i noticed that the images on my site are somewhat slow to load , even after the first time i load them at a screen size . when using next start with local images ( in /public ) , are the resized images cached anywhere ? or does compression + resizing happen on every requests ? i noticed that the rfc mentions though the image component is designed with cdns in mind , it will also work with locally hosted images . the application developer simply needs to add an image compression/resizing step into their build process , and write a custom loader that generates urls pointing to the output paths used by that build process . would anyone be able to share steps to do this , if it 's necessary for next start ? thanks in advance ! < code >
hi , i see on `` examples/with-jest '' how a page may be tested using both jest snapshots and react testing library . however , i do see a < title > , and < link > being set on the index.js page ( via `` next/head '' ) and nothing asserting on that when testing with snapshots , or when testing with react testing library . is there a way to do that ? i know `` next/head '' is tested using some sort end-to-end-ish browser automation ( ? ) . but i 'm hoping there 's another way of accomplishing that 🤞 . ideally , i 'd be able to set up a test so that a page component is fully rendered ( < html > , < head > , and < body > ) and have that be available to react testing library for assertions , without resorting to mocking . is there a way to test `` next/head '' changes using with just react testing library ? 🙏 thanks ! < code >
problem description : when css and other files are import in node_modules , compilation will throw error problem analysis : the root cause is node environment when ssr rendering , node can not process these types of files problem solving : this package can ignore css and other files when multi-threaded packaging < url > if there are font files , pr can be raised < code >
hi guys . i have problem with using singleton router in this case . language is not taken into account when navigating p.s i did all settings with new i18n feature < code > import router from 'next/router ' ; function handleclick ( event ) { router.push ( { pathname : pagepath.search , query : { q : value } } ) ; } function component ( ) { ... }
hey there . i 'm searching around and i see some mentions that the functions in api/pages are bundled together and will create another bundle if it exceeds the 50mb limit . what i do n't exactly understand regarding this , is if the functions in said bundle now act a singular function in the sense of limitations on vercel or if each individual function in said bundle is also distributed out towards that limit ? and in the same regard , if they are bundled together , do they also all share the same cold-start initiation ? since i 'm currently putting everything i have into separate optional catch-all routes to avoid both of these issues . i want to avoid this and partially have just now started undoing that because i had an issue just now with a function that puked up errors in parts of the code that had nothing to do with function that was being called ( so the code should not be reached ) which was very worrisome and confusing . < code >
i 've just created a new portfolio site which seems to not be routing on the client side - seems like it 's statically fetching and loading the new pages on navigation ( try clicking on /work or the first blog post in the list ) . i 'm using getstaticprops in my index and blog pages but otherwise have n't done much of anything to disable features . should client side routing be working or have i misinterpreted something ? < code >
i am using postcss-purgecss plugin to remove unused css file.i am facing one issue my one class is not preserve in bundle why ? here is my configuration file why this class is not preserved `` .f20 [ class^='icn- ' ] : before , .f20 [ class * = ' icn- ' ] '' it should be present in bundle . steps to follow to check build close the terminal and run npm run build . it create .next folder inside this there is static folder inside there is css folder where you check the output < url > < code > { `` plugins '' : [ `` postcss-flexbugs-fixes '' , [ `` postcss-preset-env '' , { `` autoprefixer '' : { `` flexbox '' : `` no-2009 '' } , `` stage '' : 3 , `` features '' : { `` custom-properties '' : false } } ] , [ `` @ fullhuman/postcss-purgecss '' , { `` content '' : [ `` ./pages/ * * / * . { js , jsx , ts , tsx } '' , `` ./src/pages/ * * / * . { js , jsx , ts , tsx } '' , `` ./components/ * * / * . { js , jsx , ts , tsx } '' , `` ./src/components/ * * / * . { js , jsx , ts , tsx } '' , `` ./src/core/components/ * * / * . { js , jsx , ts , tsx } '' ] , `` safelist '' : [ `` body '' , `` html '' , `` .f20 [ class^='icn- ' ] : before , .f20 [ class * = ' icn- ' ] '' ] } ] ] }
hi all , i 'm wondering if nextjs and vercel are good tools to use for developing and deploying an authorization server . i 'd rather use them than the more common express/ejs stack . any thoughts on this ? here are the example routes : < code > get accounts.example.com/login get accounts.example.com/authorize post accounts.example.com/api/login get accounts.example.com/api/logout post accounts.example.com/api/token
first off - i 'm ( very ) new to web dev , and i apologize if this is a stupid question . i 'm getting the following error after running `` npm run dev '' and attempting to load the webpage : step 1 ( npx create-next-app nextjs-blog -- use-npm -- example `` < url > ) appeared to have no installation issues and appears to have worked correctly . i 've browsed through the following 2 links and have been unable to resolve the issue . # 9022 < url > once again , apologies if this is a stupid question , but a friend recommended i use next.js for a website i want to build and i want to stick to his recommendation . this issue seems awfully complex to be occurring during the intro , and i 've spent a couple of hours now trying to get it figured out with no luck . any help is greatly appreciated . < code >
feature request is your feature request related to a problem ? please describe . i would love to see an alternative image source tag on the component . this source should be used on mobile ( portrait ) devices instead of the default source describe the solution you 'd like additional context this would enable lets say a 3:2 image ratio for tablet/desctop and 2:3 image ratio for mobile devices < code > < image src= '' /path/to/image-3x2.png '' srcmobile= '' /path/to/image-2x3.png '' / >
i would like to know how i could manage to have a base for my title , and a custom title for each page like : < cur > { base } | < cur > { custom } i could go a lib like : for my website | hello ! . but i do n't like it so much . any suggestion ? < code > const base = `` my website '' const gettitle = ( text ) = > ' < cur > { base } | < cur > { text } ' < head > < title > gettitle ( `` hello ! `` } < /title > < /head >
hi everybody , description we have a ssg page whose main content is displayed in the middle of the screen . on the left side there is a drawer menu with links to other exercises ( it is an e-learning site ) . to display these links data has to be loaded from the backend . if we now use a `` revalidate '' to update exercises , a lot of pages have to be re-rendered because a small part of their drawer has changed . what we would like achieve it would be perfect if the drawer and the exercise could be pre-rendered independently . case example imagine there are 40 links to different exercises in the drawer . if now another exercise is added , all 40 existing exercises + the newly created exercise have to be re-rendered , because a part of the drawer has changed . what we would like to achieve is that only the new exercise has to be rendered + 1 time the drawer , which then can be used again in all exercises that have been there before . thanks for your help . : ) < code >
i have been seeing that apollo client does n't server render the page if you run it inside getserversideprops . my problem is that i am not looking for static data , for which i should use getstaticprops . since my website is not a static blog but a full cms like wordpress or medium . therefore , i need help in converting the current withapollo example back to full ssr . note : in getserversideprops the data is returned fine in the `` props '' object but its just that i can not render the data inside my component without using `` loading '' or without checking data object . < code >
i have a nextjs project .i am using postcss-purgecss to remove my unused css classes but i am facing one issue .in my style.css file there is two : before class on same element . i take help from < url > .but when i compile and remove unused css file it remove one before class.i want both should be present in my bundle css file.how i will achieve this ? current output is this here is my postcss.config.js file < code > .f20 [ class^= '' icn- '' ] : before , .f20 [ class * = '' icn- '' ] : before { font-family : 'icons ' ! important ; speak : none ; font-style : normal ; font-weight : normal ; font-variant : normal ; text-transform : none ; line-height : 1 ; -webkit-font-smoothing : antialiased ; -moz-osx-font-smoothing : grayscale } .f20 [ class^= '' icn- '' ] : before { font-family : 'icons ' ! important ; speak : none ; font-style : normal ; font-weight : normal ; font-variant : normal ; text-transform : none ; line-height : 1 ; -webkit-font-smoothing : antialiased ; -moz-osx-font-smoothing : grayscale } module.exports = { plugins : [ 'autoprefixer ' , 'postcss-flexbugs-fixes ' [ // ... ( process.env.node_env === 'production ' ? [ purgecss ] : [ ] ) , ( 'postcss-preset-env ' , { autoprefixer : { flexbox : 'no-2009 ' } , stage : 3 , features : { 'custom-properties ' : false } } ) ] , [ `` @ fullhuman/postcss-purgecss '' , { `` content '' : [ `` ./pages/ * * / * . { js , jsx , ts , tsx } '' , ] , 'whitelistpatterns ' : [ /fb20/ ] } ] ] } ;
re : this issue , # 18563 , it is now closed . yahooo ! thanks y'all ! i see the milestone for it is iteration 12 , which is due november 16th . does this mean , that after november 16th , i 'll be able to update my version of next and it will include that fix i am expecting ? or is the iteration date , simply just a projected sprint end date , and not the actual release date for the fixes on that iteration ? < code >
hey there , quick question . for all routes in /account , i would like to use react-navigation instead of next router . is it possible to configure this ? ( for context , react-navigation functions similarly to react-router . ) for example , i would initialize react-navigation in the pages/account.tsx file , and the component in that file would return a custom router . then , if you visit /account , or /account/payments , etc , it 's all is handled by react-navigation . i believe that this would require any requests sent to /account/ * to be pointed to /account for react navigation to handle , correct ? < code > // pages/account.tsx const { navigator , screen } = createstacknavigator ( ) export default ( ) = > { return ( < navigator > < screen name= '' general '' component= { general } / > < screen name= '' payments '' component= { payments } / > < /navigator > ) }
feature request is your feature request related to a problem ? please describe . we have a large site powered by next.js ( thanks ! ) , with quite a complex legacy url structure . some urls are required to have trailing slashes and some are required not to , depending on the type of url it is . this currently does n't seem possible to achieve with next.js alone . we achieve it by running express in front of next , but we 'd like to remove that if possible . we also run into redirect loops sometimes , with our express setup adding a trailing slash and then next removing it . describe the solution you 'd like the ideal solution for me would be a way to set the trailing slash config to be customisable per-page , either in each page file itself or in next.config.js . a less-ideal solution would just be a way to opt-out of next.js trailing slash behavior entirely . this way , we could at least manage the urls from a custom server without hitting a redirect loop . describe alternatives you 've considered we could change all our urls to be fully consistent , but we are concerned about the seo hit . i 'm not aware of any other alternative we can try . < code >
hey , i just updated to next.js 10 and noticed that i ca n't reach the i18n data inside app context my usage was like this ; after next.js 10 , should be like this ; am i doing something wrong here , i could n't find it in the docs ? < code > class myapp extends app { static async getinitialprops ( context ) { const { component , ctx } = context ; let props = { pageprops : { } } ; if ( ctx.req ) { const { apolloclient } = ctx ; let locale = ctx.locale await fetch ( ' < cur > { config.path.server } /handshake ' ) // this is where we download translation data etc . } } class myapp extends app { static async getinitialprops ( context ) { const { component , ctx } = context ; let props = { pageprops : { } } ; if ( ctx.req ) { const { apolloclient } = ctx ; let cookies = cookie.all ( ctx ) ; let locale = cookies.locale ; await fetch ( ' < cur > { config.path.server } /handshake ' ) // this is where we download translation data etc . } }
is it possible to set a custom property in history.state for all routes using router.events ? i tried to use history.replacestate method , but it only works for history.state.options and i 'm not sure it 's the best idea . here is an example : also in this case state is not persistent . i want to add a previouspath prop on routechangestart or routechangecomplete event , then save it in history and make it persistent on page reload . any idea how to implement this ? < code > function setcustomoptionsinhistorystate ( customoptions : object ) { const { state } = history ; history.replacestate ( { ... state , options : { ... state.options , ... customoptions , } , } , `` '' , state.as ) ; }
hello ! i 've got a nextjs app ( 9.5.3 ) which is doing mostly static pre-building using wordpress as a headless cms ( via graphql ) . it 's working really well but recently it 's been failing when i deploy to production with internal server error . i 've tracked it down to the fact that wp-graphql seems to return null for linked resources it ca n't access ( because they 're a draft for example ) . my question is , why am i not getting an error in development or at least when i run next build locally ? it feels like quite a fundamental issue as one of the things i like about next is how close dev+production feel ! < code >
i am getting data undefined when i goto to localhost:3000 : /someslug/ is there i am doing something wrong in this ? 'import react from 'react ' ; import layout from `` @ components/layout '' ; import loader from `` @ components/loader '' ; import products from `` @ components/products '' ; import { usequery } from `` @ apollo/react-hooks '' ; import * as constants from ' .. /config/constants ' ; import { withapollo } from ' .. /config/withapollo ' ; import gql from `` graphql-tag '' ; import styles from ' .. /components/products/products.module.scss ' ; const category_query = gqlquery categoryquery ( < cur > slug : string ! ) { categorybyslug ( slug : < cur > slug ) { url slug productcount } } ; const category = ( { slug } ) = > { const { loading , error , data } = usequery ( category_query , { variables : { slug } , } ) ; } export default withapollo ( { ssr : true } ) ( category ) ; ' < code > console.log ( data ) ; if ( error ) return < h1 > error < /h1 > ; if ( loading ) return < loader / > ; return ( < layout > < div classname= { styles.product_wrapper } > { / * { data.allproducts.length ? data.allproducts.map ( product = > < products key= { product.uuid } product= { product } / > ) : `` '' } * / } < /div > < /layout > ) ;
incompatible href and as values warning popping up when railing slash and base path set . anyone faced same issue ? attached code to test how to replicate ? localhost:3000/customers/ ? abcd=abcd but not issue without any parameter localhost:3000/customers/ link-issue.zip < code >
i read this article . i will not use static generation . so , is there a problem if i use custom server only as ssr ? i wonder is there a difference in behavior between the custom server and the basic internal server when using ssr only ? thanks . < code >
i am using strapi as my headless cms . in nextjs , i have a page that uses isc . the current behaviour is updating in cms - > reload # 1 nextjs show old data - > reload # 2 nextjs shows new data . however , since i want to try to see whether i can somehow tell nextjs to rebuild the page upon data update , and not after 1 reload . i 'm thinking of using webhooks from strapi but not really sure how that works . can anyone lend me a hand ? tks : d < code >
i 'm not sure how this works exactly , so please correct me if i 'm wrong . does this built-in import css support increase the final bundle size ? i mainly want to make sure that users who visit my site to use as less bandwidth as possible . if yes , is there a way to turn it off somehow ? i want to use a different styling framework . < code >
this is my dockerfile i 've noticed that the build time is taking very long ( sometimes > 10mins ) . any tips on how to improve the build time ? i am using skaffold and docker for desktop for the development env . thank you . < code > from node:10 # setting working directory . all the path will be relative to workdir workdir /usr/src/app # installing dependencies copy package * .json ./ run npm install # copying source files copy . . # building app run npm run build # expose port expose 3000 # running the app cmd [ `` npm '' , `` start '' ]
feature request is your feature request related to a problem ? please describe . as a vercel user i 'd love that the image service does not only point to same domain but would rather point to an independent image proxy domain ( for example image.mydomain.com ) . currently with every release / re-deploy all image caches will be purged even though most likely the image never changed . describe the solution you 'd like add a next.config where the location of the image scaling service is deployed . for example me as a vercel user i could deploy a naked nextjs project which simply does all image scaling for all my projects . with that i make sure that if content is changed and cdn on content level is purged all images are still in the edge cache of vercel . < code >
hi everyone , this is mostly a question about ssr/ssg and all that , i 'm new to it and am learning the ropes using next.js . i have this feature on a page where i show a countdown to a specific date like `` in 4 days 2 hours 30 minutes 12 seconds '' , but of course because i 'm using the static site generation , my page only gets rendered once and does n't rerender every second . i figure it 's a client-side rendering part that i want inside of the component showing the countdown , so i looked in the docs and found out about swr but i 'm not sure that 's it purpose . how would you do this ? what 's the best approach here ? thank you all for your help , it 's greatly appreaciated . < code >
hello , i 've the following code and i would like to enable analytics only when deployed by vercel in production . for that i used vercel_github_deployment and activated it only in production configuration in vercel . the thing is that variable is not available to the frontend and as you can see i use typeof window ! == `` undefined '' . i could use next_public_ but not sure how and about the returned values . someone told me to use a .env.production with next_public_vercel_github_deployment= < cur > { vercel_github_deployment } do you have any idea ? is still typeof process.env.vercel_github_commit_ref ! == `` undefined '' relevant or will i end with an empty string if not defined ? < code > const isproduction = typeof process.env.vercel_github_commit_ref ! == `` undefined '' ; if ( ! firebase.apps.length & & typeof window ! == `` undefined '' ) { firebase.initializeapp ( firebaseconfig ) ; firebase.analytics ( ) .setanalyticscollectionenabled ( isproduction ) ; }
hi , i am trying to define my content-security-policy like this : i can see this header is correctly sent by the server , but my problem is that there are in fact two headers , this one , and an other one more restrictive : default-src * data : 'unsafe-eval ' 'unsafe-inline ' . i do n't know from where this second header is coming from and i ca n't access the server to check it out . so my question is , does next js send me this header like a `` default csp '' ? thank you for your help . < code > async function headers ( ) { return [ { source : `` / '' , headers : [ { key : `` content-security-policy '' , value : `` default-src * data : 'unsafe-inline ' 'unsafe-eval ' ; worker-src * data : blob : ; script-src * data : blob : 'unsafe-eval ' 'unsafe-inline ' ; '' , } , ] , } , ] ; }
i am trying to add a really cool comments widget to my next.js blog which requires you to place a script tag at the place in the dom where you want your comments widget to be . the script uses insertadjecenthtml to place an iframe immediately after itself in the dom , and then it deletes itself from the dom . if i try to add this script using next/head , the iframe will be placed in the < head > which obviously wo n't work . how else can i install this ? when i include the script tag as part of my returned jsx , the script from the src is retrieved and executed as it should be , and the new iframe is added to the dom as it should be , but somehow next deletes milliseconds afterwards . there seems to be some sort of race condition going on that i do not completely understand . any ideas ? < code >
i 'm going to build an admin panel using nextjs which is capable of listing , creating , and editing data from a database ( that has one million media item ) , but i 'm considering which approach achieves better performance in my case : a ) using static generation pages with a client-side rendering for data from the database ( swr ) or b ) using server-side rendering pages . ( getserversideprops ) as i understand : ( a ) means more ttfb than the second option , but it also has better performance as a better cpu is going to render the page rather than the client 's cpu which could be overloaded by other pages and other apps . on the other hand , other discussions here mentioned that the ( a ) option has better caching , which results in a better browsing experience as the same users are going to use the same database over and over again . are those the only aspects of comparison in this case ? the app is private only a few users are going to use it . obviously seo is not a concern . i 'm not sure if i forget some other factors that are involving here too . if my understanding is accurate , what would result in a better performant site : a server-side rendering ( taking the heavy load from the client ) or a better-caching policy ? < code >
bug report describe the bug as of next v9.5.0 , clicking on the inside dropdown is breaking . however , this works perfectly fine for next 9.4.4. to reproduce a small reproduction can be seen in this repo < url > as shown in the below gif , clicking on the link inside the dropdown breaks the next link . if the nextjs version is downgraded to 9.4.4 it works fine . expected behavior clicking on the link inside the dropdown should work fine for next 9.5+ screenshots n/a system information os : macos browser : n/a version of next.js : 9.5.0 version of node.js : 12.18.0 additional context migrating to 9.5.1 or higher does n't resolve as mentioned here # 15543 < code >
hey ! i have the feeling i did read everything under the sun regarding nextjs env vars ( official docs , source code , blog posts - notable mentions : < url > < url > ) but i still ca n't tell if it 's even possible to inline env vars at build time which should only be available on the server / api routes code . this would be really helpful to have as we build our bundle on circleci and then copy/deploy to ec2 and it would save us from having to generate a .env file on the fly . as far as i 've understood it the only ways to 'inline ' an env value is by either using the next_public_ prefix or by defining them in the env key in the next.config.js file . both methods also make the var available in the browser so are not suited for secrets . last resort would be ( to give up on build time and use ) serverruntimeconfig which should at least save us from having to generate an .env file , but i never got it to work with circleci . < code >
hey ! i 'm trying to integrate my next.js app with azure ad but am having trouble because all of the examples i 'm finding online require fine-tune support with express objects to run . there seems to be a need for support for express middlewares like passport or express-session to work . anyone have any ideas on which direction to go ? in the ideal world , i 'd be able to set up ad in an api endpoint and redirect unauthorized requests in gss part of my pages . thanks ! < code >
hey team , i have dynamic api routes in my application . for example /api/resource/ [ type ] / [ ... path ] and inside my handler i am accessing request params using req.query.type and req.query.path . it 's all convenient and works well . i tried following approach for testing api routes and it works well with routes which do n't deal with req.query . but i am not able to get this working with dynamic routes . < url > please help ! < code > import ' http from `` http '' import fetch from `` isomorphic-unfetch '' import listen from `` test-listen '' import { apiresolver } from `` next-server/dist/server/api-utils '' import { handler } from `` .. /home '' describe ( `` / handler '' , ( ) = > { test ( `` responds 200 to authed get '' , async ( ) = > { expect.assertions ( 1 ) let requesthandler = ( req , res ) = > { res.user = { username : `` scooby '' } return apiresolver ( req , res , undefined , handler ) } let server = http.createserver ( requesthandler ) let url = await listen ( server ) let response = await fetch ( url ) expect ( response.status ) .tobe ( 200 ) return server.close ( ) } ) } )
i have a blog that used mdx . i 'd like to start using next/image for all the images in my articles . however , i do not want to go through every .mdx and change every tag to a next/image component and look up the resolution of every image file . since everything happens on the server at build-time there is no reason why i should n't be able to do this programatically , right ? what i have in mind : using getstaticprops to fetch the image res and then inject this into my image component inside mdxprovider i do n't know if that 's possible since getstaticprops only works with pages writing a custom loader that extends file-loader and fetch the metadata there has anyone done anything similar and/or can give me some advice on this ? ideally i 'd like to achieve this within next.js without messing around with webpack . < code >
feature request it would be helpful if css and sass loaders were exposed on defaultloaders in config options . is your feature request related to a problem ? please describe . when in a monorepo workspace , there is an error check that forbids using css modules from other workspace packages . ( see : next.js/packages/next/build/webpack/config/blocks/css/index.ts line 156 in e5f9fbb // throw an error for css modules used outside their supported scope ) describe the solution you 'd like if css and sass loaders are provided in defaultloaders then they can be safely modified during configuration phase to support workspace packages . describe alternatives you 've considered lookup sass-loader and css-loader by inspecting config.module.rules.oneof and do the modification that way . this works but is n't future-proof if the structure of the config ever changes . additional context the same ask exists in this popular project . < url > < code >
i 'm trying to use this example from wasm-bidgen in next : but i get referenceerror : alert is not defined anyone knows why ? < code > use wasm_bindgen : :prelude : : * ; # [ wasm_bindgen ] extern `` c '' { fn alert ( s : & str ) ; } # [ wasm_bindgen ] pub fn greet ( name : & str ) { alert ( & format ! ( `` hello , { } ! `` , name ) ) ; }
with nextjs 10 , you can have a catch all route , which looks something like this [ ... id ] .tsx . the idea is that this will allow for dynamic pages . so it should match /example , /example/new , /example/new/latest etc . the issue im facing is that a specific matched routes ( for example /example/new ) may need extra data in order to correctly render . seeing as i only really have one file in my pages folder , i only have access to one getstaticprops call . fetching all possible data for all possible routes seems quite wasteful . server side data fetching at the component level would solve his issue but this does n't seem to be a supported feature in nextjs is there a recommended way around this ? conditional data fetching based on context inside getstaticprops ? 🤔 < code >
is it possible using ssr to have data updated in real-time using firebase ? or is the page simply static with no possibility of receiving new data updated in real-time on the screen ? < code >
i tried to send a post request by calling this as function onclick & also inside /api routes in as an endpoint that sends a request for login . both are not working so how we send post requests in nextjs ? < code > axios .post ( '/ phofurl { username : `` user '' , password : `` 123456 '' } ) .then ( res = > { console.log ( 'res ' , res.data ) ; } ) .catch ( err = > { console.log ( 'error in request ' , err ) ; } ) ;
hi there ! i am using dynamic imports with a dynamic path , to fetch a react component depending on my props . when i run next build though , and analyze the code , the entire package i am importing from is in the main bundle , and i do n't understand why . ( using @ material-ui/ { core/icons/lab } , and all of it is bundled , even though they are defiend as peerdependencies in @ org/components ) anything wrong with this approach , and why the entire @ org/components package is bundled , even though i try to fetch a single submodule ? we have been struggling with this at work for a few days now , anyone who could take some time to help would be highly appreciated ! i can provide more example/information if needed ! < code > const calulcator : react.fc = ( { id , ... props } } ) = > { const [ component , setcomponent ] = react.usestate ( ( ) = > skeletoncomponent ) react.useeffect ( ( ) = > { if ( id ) { ( async ( ) = > { const component = await import ( ' @ org/components/ < cur > { id } ' ) setcomponent ( ( ) = > component.default ) } ) ( ) } } , [ id ] ) return < component { ... props } / > }
the image component url does n't follow the trailingslash options from next.config.js , whereas every /api/ endpoint and /page/ does . what we get is /_next/image ? url= what i would expect is /_next/image/ ? url= should n't this be standardised ? < code >
( 9.3.0 ) i have data that my entire site relies upon ( nav , footer ) that i really only want to fetch at build time . is there a way to do this within _app.js . from what i understand , getstaticprops does n't work at the component level or within _app < code >
very simple question : with the following pages setup : pages/offense/index.js pages/offense/ [ id ] /index.js pages/search/ [ ... slug ] /js why does the following transition allow for shallow routing : but the following does not the docs do not explain this caveat very clearly : shallow routing only works for same page url changes . for example , let 's assume we have another page called pages/about.js , and you run this : router.push ( '/ ? counter=10 ' , '/about ? counter=10 ' , { shallow : true } ) since that 's a new page , it 'll unload the current page , load the new one and wait for data fetching even though we asked to do shallow routing . i have highlighted the wording that does not make sense to me `` since that 's a new page '' but in the above scenario pages/offense/index.js and pages/offense/ [ id ] /index.js are different pages as well - but shallow routing is still allowed between them ? if i am misunderstanding something with the wording of this caveat , please let me know , and perhaps we could update the docs to be more clear < code > /offense/1 - > /search /offense/1 - > /offense
i have the following code in my next.config.js : i want to redirect from / to /about page . the next.js documentation says that this is how you should use redirects : how do i use redirects in my case , i.e , while using @ next/bundle-analyzer ? < code > module.exports = { async redirects ( ) { return [ { source : '/ ' , destination : '/about ' , permanent : true } ] } } module.exports = withbundleanalyzer ( { pageextensions : [ 'js ' , 'jsx ' , 'ts ' , 'tsx ' , 'md ' , 'mdx ' ] , experimental : { modern : true , } , webpack : ( config , options ) = > { ... } } )
i tried to define my image like this : but that wo n't work . the image is only displayed at full size . what should we do when we wa n't a fluid width for the images , to use in a responsive grid etc ? < code > < image src= { props.image.url } alt= '' picture of the author '' width= { props.image.width } height= { props.image.height } classname= '' card__image '' / > < style jsx > { ' .card__image { width : 100 % ; } ' } < /style >
hi everyone ! i 'm using getstaticprops + swr for my movie project . getstaticprops fetch at build time , so what happens if i have a large data of movies e.g : 30.000 movies ? should i use getserversideprops in this case ? < code >
i have the following use case -- basepath -- /_foo/ actual url -- abc.com/_foo/post required url -- abc.com/post can i use the as prop to change the full url along with basepath ? as per the docs , its an optional decorator only for the relative path < code >
how do people use not compiled libraries with nextjs ? i am linking the library which has .scss files for the components ( imported in their .js ) but nextjs gives an error because the file is not named as .module.scss . i have n't found any workaround via config . should the library be forced to rename the files ? < code >
hi , i tried to use this next js with ant design pro less example < url > i want to create a style less file like in this guide < url > but the next js page does n't recognize the style import . i have the styles.less on root directory . i also tried this type of import but the style did n't work . can you guide me on the correct way to import styles here ? thank you so much . < code > import `` .. / .. /styles.less '' export default ( ) = > < div classname= '' example '' > hello world ! < /div >
i have a button in one of my components that is wrapped in a link which is referencing a page that has a getserversideprops function within it and inside of that function i am calling an api route that sends back a randomly generated uuid . if i click my button from the home page after a fresh restart of the server , i get the randomly generated uuid displayed on the page just as expected , however if i go back to the home page and then click my button again , i get the same uuid ... i think the application is caching the result , but i need it to call the api every time i click the button . how would i go about doing this ? < code >
hello all i have some question i dont understand in next js please can someone clear this stuff for me and thanks api route is it obligatory to deploy api routes to lambdas functions ? what is the benefits of deploying my api route to lambdas function ? it 's not a problem if i work with api routes in big project rather than express app ? data fetching do we need getserversideprops if yes can you give me some use case please ? can i have the same use case that getserversideprops gives me with getstaticprops , incremental static regeneration and client side data fetching with swr ? its not a problem if i read and write to database with getstaticprops not with a cms ? < code >
i 'm using next 's own servless api , but to be able to fetch this api i need to use the absolute url , if there is an environment variable with this information , how can i make this url be relative to the environment that the server is running , between dev server ( < url > ) and production ( dns ) . fetch i want to do something like this < code > const currencyinfoapiresponse = await fetch ( ' < url > ) const currencyinfoapijson : currencyinforesponse = await currencyinfoapiresponse.json ( ) const currencyinfoapiresponse = await fetch ( ' < cur > { process.env.host } /api/crypto ' ) const currencyinfoapijson : currencyinforesponse = await currencyinfoapiresponse.json ( )
hello all ! i currently have an app with a single entry point in the form of /pages/ [ ... slug ] /index.ts it contains a getserversideprops function which analyses the slug and decide upon a redirection in some cases a redirection is needed , but it will always be towards a page that can be statically rendered . example : redirect /fr/uid towards /fr/blog/uid which can be static . in other cases the slug already is the url of a page that can be static . how can i mix this dynamic element with a static generation of all pages ? thanks a lot for your help ! < code >
problem next emits tons of great information , but much of that information is not available to users outside of stdio . consider the output of yarn build : as seen above , you can see that next.js finds it reasonable to share a bunch essential build information to users via stdout . similarly , i have questions , reports , and rules/enforcements that i want to generate or apply , but need much of that information programmatically . i assume all parties agree parsing stdout is not a practical option to access this type of information . some practical usages that this information would be useful for : assert total first load js to be less than x kb forbid too many or too few chunks assert ssg/server/static for pages x , y , or z for my app assert x kb threshold for css add # -pages , sum ( count-assets ) , sum ( count-js-kb ) to trending reports tl ; dr , next has great internal stats -- i want access to them ! solution add an api to tap into these entities . # 16418 is a simple-stupid approach to enable this , and more . < code >
with the new image component , lighthouse is not happy with the image sizes provided as you can see below : after reading quite a lot about it i am still unable to satisfy lighthouse . take a look at this issue , for instance . i thought that that could be addressed by the sizes property of the image component , but that did not work . this would output like below , ie , adding a sizes property with a media-query , but no effect on lighthouse . i was expecting it to add a srcset with the informed size . actually i was expecting that next/image would handle that automatically by providing different sizes/resolution for the most common devices . < code > ' < img alt= '' quiamo logo '' src= '' /_next/image ? url= % 2fimages % 2fmain-logo.png & amp ; w=320 & amp ; q=75 '' srcset= '' /_next/image ? url= % 2fimages % 2fmain-logo.png & amp ; w=320 & amp ; q=75 320w '' class= '' makestyles-branding-7 '' sizes= '' only screen and ( min-resolution : 3dppx ) 473px '' style= '' visibility : visible ; height:100 % ; left:0 ; position : absolute ; top:0 ; width:100 % '' > ' < image src= '' /images/main-logo.png '' alt= '' quiamo logo '' classname= { classes.branding } width= '' 180 '' height= '' 60 '' loading= '' eager '' priority sizes= '' only screen and ( min-resolution : 3dppx ) 473px '' / >
bug report when i use a getstaticprops , getting posts from wordpress cms using this example ( < url > ) in my wordpress , only when i upload this files to amazon s3 , i get the utf8 errors , only to this data describe the bug i understand that issue begins when i change my host from blog . in the first time , when i go to website ( < url > ) , its working , but when i reload , i got this issue : i trying to use utf8 in api , like this in local this errors didnt appear to reproduce go to website ( staging.uaubox.com.br/blog ) expected behavior which should be a right letters system information os : linux browser : brave version of next.js : 9.5.0 version of node.js : v15.1.0 < code > const { data } = await axios ( { url : api_url , method : 'post ' , headers : { 'content-type ' : 'application/json ; charset=utf-8 ' , 'accept ' : 'application/json ; charset=utf-8 ' , } , data : payload , } ) ;
i was using getserversideprops for my use case and everything looks so good . but i have a problem which is the permalink of the request url for json that is generated for each page is predictable . for example , if i have a listing page of say fruits , the permalink looks like json generated for each page goes like this example.com/_next/data/ < cur > { randomnextid } /fruits/apple example.com/_next/data/ < cur > { randomnextid } /fruits/orange example.com/_next/data/ < cur > { randomnextid } /fruits/banana and the response of each json has the entire data required for that page . this would turn out easy for users to scrap the entire data when they have the all the permalinks that are possible ( list of all fruits here ) . is there a way with which i can get around by blocking it ? < code >
it works well on desktop . but if i simulated on chrome dev tools mobile view , the image component detects the wrong device size . so it used a big size image than the real device size . @ timneutkens @ timer < code >
question refs : # 16832 can i use native lazy loading with next/image ? canary implementation is always lazy loading by intersectionobserver ( if able to use intersectionobserver ) . refs rewrite and check loading attr in chrome . source `` auto '' is default value in chrome , out of the whatwg spec . i think the best implementation is switching strategy native or not with feature detection like as 'loading ' in htmlimageelement.prototype . what about do you think ? why dont use native lazy loading ? < code >
hey guys , i 'm quite a new dev and i 'm starting to familiarise myself with next to build my apps . i want to upload images to s3 or cloudinary from an app and i 'm getting a bit confused as to the best way to go about it . i know that usually image uploads are handled on the server for security reasons . and i definitely do n't want to expose the credentials on the front end . but what 's the best way to achieve this on next ? if i store my sensitive credentials in a .env file . should i secure an api end point with auth and then post from there ? or will that still expose the information on the front end ? any help or hints much appreciated cheers tom < code >
hi everyone , i started to play with nextjs today , and trying to import tailwind was a total pain , because of that , i 'm looking for help . i have this structure by default development -- pages -- - > _app.js -- - > index.js -- styles -- - > global.css -- - > tailwilnd.css when i run npm run dev everything looks great , but when i deploy the project to vercel it looks kind of bad .. ( < url > ) and i 'm thinking it is because of global.css not being imported probably ? so i do n't know what 's going on . here you have some examples of what i 'm trying to say . dev deploy if this have something to do with it , i followed this blog to import tailwind in the project < url > < code >
i 'm trying to implement pagination by rewriting numbers in the path to the query var ? page . i got it to work more or less , but the string part of the path gets cut in half , it returns `` alimentacao-e- '' when it should return `` alimentacao-e-bebidas '' . my next.config.js looks like this : the route i 'm working with is /category/ [ ... slug ] . i tried changing \w { 1 , } to \w+ , [ a-z- ] { 1 , } , [ a-z- ] + and all of them ended up giving the same result . < code > const withimages = require ( 'next-images ' ) ; module.exports = withimages ( { async rewrites ( ) { return [ { source : '/categoria/ : slug * ( \w { 1 , } ) ' , destination : '/category/ : slug * ' } , { source : '/categoria/ : slug * ( \w { 1 , } ) / : page ( \d { 1 , } ) ' , destination : '/category/ : slug * / ? page= : page ' } , ] ; } } ) ;
after reloading the page or at random times . the styles of the few components does n't apply . after checking inside devtools , the css classname does show in the html but its styles are missing . i am using styled-components to apply styles . < code >
the quality of the next/image is set to 75 by default . but what are the implications when changing it to 100 ? if the page has a lot of images and all of them are setting the quality to 100 , i suppose that it would lead to some performance issue ? maybe making the optimization process be slower ? i would like to understand how the property quality acts behind the scenes and what are the consequences by setting the quality to 100 on a lot of images . < code >
the current upgrade guide page was n't updated when next 10 released . even if no breaking changes were made , i would assume the guide would be updated to reflect that . my team support several projects on next 9 which we do n't feel safe enough to upgrade without knowing if there were breaking changes , specially because react was updated to v17 . are there any plans to update the guide ? < code >
i was using next.js with hot refresh since next 9.4.x and it was working fine . i updated to 9.5 and still working fine . i do not remember to have changed anything in the configuration of my app , but suddenly it stopped working . it means , now when i run yarn next the dev server starts properly but once i am using the app in the browser , if i make changes to the source code it will update in the browser as usually but suddenly stops working , i.e . suddenly it does not update the app in the browser any more . no matter what i do , no changes are reflected in the web browser . this is very frustrating since i have been using fast refresh for months with this app and it always worked flawlessly . now , i do not expect here an answer on why my fast refresh is not working . this is because the react app is quite big and i can not just really drop the whole app here ( i do not believe anyone would have the time to look at it and also is proprietary software ) . question here is : where should i look at ? i did not update any packages , did not change really any configuration anywhere and suddenly one morning stopped working as usual . now in nextjs 9.5.5 but tried with prior versions that were working properly and no difference . < code >
hi . i have a spanish version of the site , and i want to keep the files in the /pages folder in english because of my conventions . but in the url i want to have a spanish slug , eg the folder is called /articles and i have index.tsx in it , but in the url i want /articulos . i was thinking about using rewrites eg : do you think it 's okay ? do you also have english names in the pages folder ? is it possible to merge this article rule into one object ? thank you . < code > async rewrites ( ) { return [ { source : '/articulos ' , destination : '/articles ' , } , { source : '/articulos/ : id ' , destination : '/articles/ : id ' , } , ] } ,
i am short of a beginner here , so i would like to ask if i can use the useswr hook with my graphql api built with apollo . i would not like to use the apollo client on the front-end , but i am interested in using relay modern . i have seen various articles and it says it also in the documentation that swr works great with graphql , implementing it with the graphql-request package . however , i would like to know what to use for fetching data inside the getstaticprops or getserversideprops fetching data methods , provided by next.js . i know that i can not use the useswrhook inside the data fetching methods , but only inside the react component . but , what i can do is totally fetch the data i am going need inside those next.js methods , and then pass them as props and use them as initialvalue of swr . so my question is , what should i do to fetch data from a graphql api inside next.js data fetching methods , should i use the regular fetch ( ) function , or use the relay modern client inside those , or use something else ? i will be using issg a lot , so i am not going to use only the default ssg that would fetch the data at build time . another discussion about this topic can be found on the official vercel/swr repository thank you in advance for your help or advice ! < code >
as our application is scaling , we are using pages merely as `` routers '' with all components , utilities and tests moved into another containers folder . i think this defeats the major feature of next.js wherein you can create a completely self-contained page in a folder rather than abstract it out to other folders . does not know how ignoring special directories like pages/myroute/_components or pages/api/myroute/_utils can be achieved ? look forward to your feedback ! < code >
i 'm using this layout pattern in nextjs as this seems to be the recommened way of avoiding the layout to re-render , however i ca n't see how i can update the page title in the head of the layout , if i put the < title > page name < /title > into a component it renders it in the wrong place . how can i update the title of the page using this pattern ? _app.js import react from 'react ' import app from 'next/app ' import layout from ' .. /components/layout ' layout.js < code > const layout = ( { children } ) = > ( < div classname='layout ' > < globalstyle / > < head > < link rel= '' preconnect '' href= '' < url > '' / > < link rel= '' preconnect '' href= '' < url > '' / > < link rel= '' stylesheet '' href= '' < url > / > < /head > < wrap > < spacer / > < header / > < mainwrap > { children } < /mainwrap > < script async src= '' < url > / > < div hidden id= '' snipcart '' data-api-key= '' '' / > < /wrap > < /div > ) export default layout const myapp = ( { component , pageprops } ) = > { return ( < layout > < component { ... pageprops } / > < /layout > ) } export default myapp
is there a way to turn off this feature ? automatic locale detection when a user visits the application root ( generally / ) , next.js will try to automatically detect which locale the user prefers based on the accept-language header and the current domain . if a locale other than the default locale is detected , the user will be redirected i 'd like the site to always display in the default language unless explicitly routed to another language . thanks < code >
i know with mdx is possible . but mdx also created with remark or rehype plugins . i can use html tags in markdown with rehype . but how can i use the new nextjs image optimization ? < code >
i created an app with npx create-next-app -- use-npm . when i run npm run build inside of that directory , i get this in my output : the program exits after that . there 's no build created anywhere . not seeing any errors either ! i do n't know what to do . i 'm on windows 10 , tried it in git bash , wsl , powershell , and cmd . < cur > node -v is v14.15.0 < code > info - creating an optimized production build info - compiled successfully info - collecting page data info - finalizing page optimization page size first load js / 3.44 kb 65 kb css/9a89afcbe95084ea8b90.css 703 b /_app 0 b 61.6 kb /404 3.44 kb 65 kb + first load js shared by all 61.6 kb chunks/f6078781a05fe1bcb0902d23dbbb2662c8d200b3.ca31a7.js 11.3 kb chunks/framework.9116e7.js 41.8 kb chunks/main.d1e355.js 7.3 kb chunks/pages/_app.333f97.js 529 b chunks/webpack.e06743.js 751 b css/6e9ef204d6fd7ac61493.css 194 b ( server ) server-side renders at runtime ( uses getinitialprops or getserversideprops ) ( static ) automatically rendered as static html ( uses no initial props ) ( ssg ) automatically generated as static html + json ( uses getstaticprops ) ( isr ) incremental static regeneration ( uses revalidate in getstaticprops ) [ == ] info - generating static pages ( 0/2 )
i want to write a media query in styled-jsx and use the breakpoints that i 've set in my scss variables . does anyone know of a good way of doing that ? < code >
feature request is your feature request related to a problem ? please describe . we 're developing a site , in which editors frequently add new redirect rules , so we 'd like to be able to maintain the list of redirected urls in our cms and fetch them inside async redirects ( ) . the problem with doing so is that it seems this method is only ever triggered when the server is started , and is then never refreshed throughout the lifecycle . describe the solution you 'd like we 'd like to be able to configure an interval in which next.js refreshes the configuration of redirects , so that for instance an updated list of redirects is fetched from our cms on a daily basis . describe alternatives you 've considered currently we 're considering forcing the server to reboot on a daily basis to force it to refresh redirect configuration , but we 'd much prefer not having to do so . < code >
what is best practice for logging on the server side ? i have code that syncs two databases and i need to see the log . i was thinking about using an external logging service like papertrail . what are you using ? < code >
bug report describe the bug no favicon image is shown on the browser tab even though if i inspected the page i can find < link rel= '' icon '' type= '' image/x-icon '' href= '' /images/favicon.ico '' > in head and if i open the href in another tab , the image appears to be loaded well . to reproduce steps to reproduce the behavior : i put images/favicon.ico in public folder in root and this is what i 'm doing in _app.tsx and if you check < url > the image is loaded correctly . however , it 's still not visible on the tab . expected behavior favicon should be visible on the browser tab system information os : macos catalina 10.15.7 browser : chrome version of node.js : 12.5.0 version of next.js : 10.0.0 < code > < cur > git clone < url > < cur > npm i < cur > npm run dev import { chakraprovider } from ' @ chakra-ui/core ' import theme from ' .. /theme ' import { appprops } from 'next/app ' import head from 'next/head ' function myapp ( { component , pageprops } : appprops ) { return ( < chakraprovider resetcss theme= { theme } > < head > < link rel= '' icon '' type= '' image/x-icon '' href= '' /images/favicon.ico '' / > < /head > < component { ... pageprops } / > < /chakraprovider > ) } export default myapp
the problem is in that i require locale variable in _app.js but ca n't find it . in my custom app i have next render : ' render ( ) : react < cur > element { const { component , pageprops , headerprops , footerprops , } = this.props ; ... ' in footer and header i have getstaticprops , becouse i want to optimize it to avoid reload this parts of pages , when page is changed . but in header and footer getstaticprops have not locale variable . in _app.js the same , const { locale } = context ; // undefined please help to decide how to resolve this problem with use new 10 version internationalized routing feature . are this possible ? may be i'am doing something wrong ? < code > return ( < appcontextprovider > < head > < meta name= '' viewport '' content= '' width=device-width , initial-scale=1 , user-scalable=no '' / > < /head > < header { ... headerprops } / > < component { ... pageprops } / > < footer { ... footerprops } / >
feature request is your feature request related to a problem ? please describe . it would be great if the component could make external image resources to be copied into the resource folder . with this addition the entire project would be offline capable after ssg/export describe the solution you 'd like it would be great if the build pipeline of the image processing would generate local images on the fly . this would make for example a pwa entirely offline capable . similar to the data.json files generated of the props on getstaticpaths and getstaticprops < code >
hello i want to establish communication between react-native webview and nextjs using window.onmessage ( ) but after start yarn dev webivew shows blank page and tested on android chrome browser and it working and result from yarn build also work but i want debug with yarn dev my android version : 4.4 kitkat < code >
hello , description i 'm working on a nextjs ( 9.5.4 ) project . i have some troubles to understand how i should keep an active user session after a refresh ( server side rendering ) . once the user is logged in , i do 3 things : i save a client side cookie which contains an acesstoken and a refreshtoken . i save the user profil information and these both tokens inside a redux store . i set an authorization : bearer header inside the config of axios instance client side . if the user refresh the website , i want him to stay connected . so from the getinitialsprops of the _app.tsx file , i look for cookie and make a call to my api in order to get user 's information . the question is once i have the information , and new access/refresh tokens , : must i synchronise server and client side cookie ? how to do it ? must i synchronise redux server and client store ? how to do it ? thank you for your help ! < code >
feature request option to change the error component colors . today we have just the default error and to customize it we need to create another one from scratch . describe the solution you 'd like i would like to change just the background and the text color . the grey colors could be a variation of the main text color . if you had a prop to change that , it would work like a charm : describe alternatives you 've considered an better alternative would be to have a configuration where you could change the colors for all errors page , but it may be harder to do . the error pages are pretty , but i want to change the colors to match my site style ( how the error page looks like in a black themed website : < url > ) < code > < error title= { title } statuscode= { errorcode } backgroundcolor= ' # 111 ' textcolor= ' # 111 ' / >
hello guys , i 'm working on a video on demand project , and i 'm thinking about use full ssg , we have 60.000 movies in our catalog , is this a good idea ? i can set a timeout to revalidate each page like i can do when i 'm using fallbacks ? thanks so much ! < code >
hi , does anyone have any ideas how best to achieve the following ? i want to host a single next.js application on multiple domains , but i only want to serve a sub-path on each domain . e.g . the path for an incoming request < url > gets converted by the reverse proxy to localhost:3000/somedomaincom/some/path so that multiple different domains can be hosted by a single instance of next.js . i am fine with the reverse proxy side of things and i can get next.js serving the correct sites on the right domains . the issue i am facing is with routing . i basically need the inverse of customisable base paths . either i am able to get links that load pages dynamically ( and href links are incorrect as the contain the domain part ) or the href links are correct but pages are not navigated to dynamically . hope that makes sense thanks conor < code >
we decided to jump on and try version 10 , but after upgrading to it , i get new errors . i 'm not sure if they are created directly due to a bug in next or the way the code is built , so i 'm trying here before opening a bug . the error i get when building : this is the imported file : i 'm pretty sure it 's the way we import svg files , after removing the import it worked , but then i got more errors on more similar issues . i assume we can change it all but it all over the code , but it will be a bit time consuming , so do you know about any other way so i can keep the current code ? maybe a missing babel setting or the next config ? using node v10.16.3 thanks ! < code >
bug report /posts/ [ slug ] .js returns 404 | this page could not be found in production vercel deploy/vercel -- prod/github integration . describe the bug a statically generated blog example using next.js and prismic . < url > is not working properly in production deployment . in local , somehow works . a clear and concise description of what the bug is . to reproduce 1 . ) follow the instruction stated in the tutorial : < url > 2 . ) add env variables using prismic token/ repo name that you 'll be created in prismic.io 3 . ) then , deploy in vercel . 4 . ) see error on clicking one of your `` posts '' from /posts/ [ slug ] .js expected behavior it should return `` loading ... '' then and generate static page based on the slug data . ( this works while npm run dev ) screenshots system information os : [ e.g . windows ] browser ( if applies ) [ e.g . firefox dev , firefox , chrome , safari ] version of next.js : [ e.g . 10.0.0 ] version of node.js : [ e.g . 12 . * ] additional context add any other context about the problem here . < code >
why when we use custom _app.js file we need to extend component from 'next/app ' not so 'class app extends component ' ? why like this ? but not like this ? < code > class app extends component { ... } import nextapp from 'next/app ' ; class app extends nextapp { ... }
i 'm trying to build an api route which accepts a user api key on the x_api_key header . i currently have this working in local dev but when i deploy to production it 's being set to undefined . i 've read the docs on custom headers at < url > but it seems like it does n't specify a way to allow through the values sent by the client . is there a work around for this ? < code > const { x_api_key } = req.headers ;
i noticed that the [ create-next-app ] [ 1 ] calls makedir twice in `` create-app.ts '' : next.js/packages/create-next-app/create-app.ts lines 110 to 124 in 5c97b97 await makedir ( root ) if ( ! isfolderempty ( root , appname ) ) { process.exit ( 1 ) } const useyarn = usenpm ? false : shoulduseyarn ( ) const isonline = ! useyarn || ( await getonline ( ) ) const originaldirectory = process.cwd ( ) const displayedcommand = useyarn ? 'yarn ' : 'npm ' console.log ( 'creating a new next.js app in < cur > { chalk.green ( root ) } . ' ) console.log ( ) await makedir ( root ) process.chdir ( root ) why ? is n't this a soft bug , caused by the fact that make-dir does n't throw a warning/ error when the directory already exists ? < code >
hi there , nextjs 10 introduced importing css from third party react components . is it possible to to something like this in one of my components : import './plyr.css ' ; unfortunately i get this error : global css can not be imported from files other than your custom < app > . please move all global css imports to pages\_app.js . or convert the import to component-level css ( css modules ) . read more : < url > the rationale behind this is simple . i use react-plyr and it has it 's own css file , but i want to modify it and use the modified one instead of the one from react-plyr itself . i do n't want to import it globally since i do not need it on all pages . < code >
based on the with-dynamic-app-layout how best should this be used with typescript ? without some declaration merging you will get ts compile errors saying something like layout does n't exist on ... it looks the component prop passed into the _app component is using the nextcomponenttype and we can use declaration merging to add the layout property onto the functioncomponent and componentclass types something like this : however this will add reactnode to all react components when really we only want allow it on components that are typed with nextpage or nextcomponenttype . so what is the best way to use dynamic app layouts with typescript ? < code > declare module 'react ' { interface functioncomponent { layout ? : reactnode ; } interface componentclass { reactnode ? : reactnode ; } }
feature request reportwebvitals is a nice feature , but one thing we 're unable to do is link the stats with a page . we do n't use google analytics which handles his automatically , we usually send the pathname with our stats so we can see which page types perform best . right now this is hard to do , we ca n't use the userouter hook because reportwebvitals is n't a component . the only other option is to grab it from document.next.router but that feels a bit hacky , should we be using that object ? having context would also be useful , but if this is not possible i would be happy with just router for now . < code >
is there any way we can do that ? like an option in nextjs config to disable the spinner since i 'm going to make a spinner at the same position too so it kinda hard to work with . < code >
/posts/ [ slug ] .js returns 404 | this page could not be found in production vercel deploy/vercel -- prod/github integration . a statically generated blog example using next.js and prismic . < url > is not working properly in production deployment . in local , somehow works . to reproduce 1 . ) follow the instruction stated in the tutorial : < url > 2 . ) add env variables using prismic token/ repo name that you 'll be created in prismic.io 3 . ) then , deploy in vercel . 4 . ) see error on clicking one of your `` posts '' from /posts/ [ slug ] .js image it should return `` loading ... '' then and generate static page based on the slug data . ( this works while npm run dev ) < code >
i have a project , which can not leverage ssr or static caching , due to server constraints . we normally use cra for that , but i 'd like to use nextjs instead . primarily to use the router , which the team knows and loves , but also to gain zero-config route based code splitting , and the general consistency of tooling config across projects . so the plan is to simply not define any getstaticprops or getserversideprops methods , and use nextjs just for spa like output - build then export . to get the routes aligned with the cms , we 'll use php to detect the incoming link structure , and simply serve up the right [ slug ] .js route . for example , if we have a pathname like /page/this-is-my-slug , we 'll explode the pathname , figure out that it 's the page component , and load /page/ [ slug ] .html from the out directory . ( i do n't think it 's strictly necessary to even do this - as i understand it we can just load the main index.html file , and that will work too - but this seems like a more next-like way to do it . ) this seems to work ! the one issue is that it loads for a split second with the router.aspath prop set to /page/ [ slug ] .html instead of /page/this-is-my-slug ( with const router = userouter ( ) ) . but it resolves immediately , and is easy to work around . the point of this post is to ask whether i 'm in for other unforeseen consequences of doing things this way . am i ? < code >
hi ! i 'm currently developing an enterprise e-commerce project , and i 'm planning to implement ssr on it . it first started off with cra , now that it 's grown so much , i 'm thinking about ways i can get this ssr thing up & running . next.js seems like a really cool tool ! but i 've also checked out after.js , which is kinda the same , but it allows you to use react router . on the other hand , it definitely has fewer features and a much smaller community . i 'm wondering which way to go ? both have their own benefits < code >
i have a pr open for a new example app , and i have some test failures like : `` azure next.js ( test_chrome node-10-1 ) failing after 39m test_chrome node-10-1 failed '' can anyone shed any light on this ? here 's the pr # 18570 thanks ! < code >
i 'm working on a nextjs application that should be deployed in a lan , and the server is not connected to the internet . so the problem that i have is that in the backoffice i 've got some forms to add/update/delete employees informations . there are also images profiles and qrcode that are generated for some reasons . i store those images inside users_images folder inside the next.js public folder . in development everything works just fine i can server those static files ( images ) . but when i execute next build and run the application for production , only images in the users_images are build time are serverd but the news assets that are being created in the backoffice are not served and the server returns 404.i 've read in the nextjs docs and that is the expected behavior : static file serving . as the application will be deployed in an offline server , i can not use services like aws s3 or services such as cloudinary for storing and retrieving images . do you have any ideas about how to solve this problem to help me serve those files even after build ? i 've also tried serving them with nginx and images are accessible but i get 505 while accessing pages . here is my nginx configuration . next application listen on port 3000 @ timer @ timneutkens @ ijjk @ lfades < code > server { listen 3000 ; root /path_to_apps_public_folder ; location / { try_files < cur > uri < cur > uri/ =404 ; } }
cloudinary allows you to modify images on the fly like this : this crops the image and makes 1200 x 1200 px wide . i tried using the new image component to accomplish the same , however it seems like the image component overrides my parameters . the resulting url looks like this : is there any way i can pass my params to the url through the image component ? < code > < url > ^^^^^^^^^^^^^ this part overrides my params < url > ^^^^^^^^ these params modify the image < image width= { 1200 } height= '' 1200 '' src= { '/w_1200 , h_1200 , x_0 , y_0 , c_crop/image_id.png ' } / >
we have quite a restrictive content-security-policy ( csp ) which blocks unsafe-inline as a matter of caution . it 's always been fine with our next setup ( we use css modules and host our assets on a cdn ) . i just updated to next 10 and now on first load i 'm getting an unstyled page , because our csp is refusing to load the unsafe styles . looking in the dom i can see a load of css in < style > tags that never used to be there . is there a way of disabling this so we do n't have to enable unsafe-inline ? < code >
i use caprover to deploy my project with docker and i want to set different api address for dev/prod branches . but i find it 's difficult to use environment variables and ssr when using docker . variables like process.env.api will be replaced as string during build process . so when i use docker to run my project , environment variables wo n't work . any solution to use runtime environment variables ? < code >
i 'm using v10.0.0 and generating dynamic pages [ slug ] .tsx using getstaticpaths and getstaticprops with fallback : false so any slugs which do n't exist should throw 404 but instead in vercel it tries to render the component which throws 502 error . it works fine locally in dev and when i build locally . any help would be much appreciated ! < code >
hallo all . i 'm gon na have base props on ssr for each page and special props for the particular page . but tell me is this good way as pattern ? getserversidepropsbase is function thats return base props for standard getserversideprops method : so , i 'm gon na get additional props for homepage /pages/index.tsx : < code > const homepage = ( { basepropforanypage , propforhomepage } : ipageprops & ibaseprops ) = > ( < div > we have both props < /div > ) export const getserversideprops = async ( ctx : ipagecontext ) = > getserversidepropsbase ( ctx , ( { req } : ipagecontext , base : ibaseprops ) = > { const propforhomepage = 'anything ' return { props : { ... base , propforhomepage , } , } ; } ) ; export default homepage ; import { getserversideprops } from 'next ' ; export function getserversidepropsbase ( args : any , impl : function ) : getserversideprops { const basepropforanypage = 'anything ' return impl ( args , { basepropforanypage } ) ; }
hi all , i am a little confused about how a headless cms like sanity.io , combined with next.js , when deployed would have good seo for blog posts . for example , let 's say i created a blog post on sanity and run through the build process with next , and deploy . how does google know that i have a blog post called 'how to write great github tickets ' on my next site ? does it load the javascript in an environment of some sort , actually execute the fetch requests , then crawls through the now populated blog posts ? and then indexes the resulting route tree , even though there are n't multiple routes - it 's really a re-usable component that tricks google by putting in unique metadata from the blog post ? that makes sense ... but it almost sounds too good to be true . maybe i 'm under-estimating how good a job google has done in improving how they index websites , and now does not require a technical 'file ' - they can auto-create indexes through dynamic routes ? i guess my question is more about how seo works with dynamic react routing - if anyone can confirm my suspicion here , that would be awesome . i 'm sorry it 's not worded exceedingly well , i hope people can follow my train of thought . < code >
i 've been seeing this error during vercel builds involving build-storybook . storybook attempts to build the preview.js file and fails to output iframe.html . once built , iframe.html either 404s or falls back to a catch all route ' ( node:1469 ) unhandledpromiserejectionwarning : typeerror : can not read property 'length ' of undefined 17:03:00.391 | at getbasewebpackconfig ( /vercel/workpath0/node_modules/next/dist/build/webpack-config.js:8:650 ) 17:03:00.391 | at object.webpackfinal ( /vercel/workpath0/.storybook/next-preset.js:21:35 ) 17:03:00.391 | ( node:1469 ) unhandledpromiserejectionwarning : unhandled promise rejection . this error originated either by throwing inside of an async function without a catch block , or by rejecting a promise which was not handled with .catch ( ) . to terminate the node process on unhandled promise rejection , use the cli flag -- unhandled-rejections=strict ( see < url > ) . ( rejection id : 2 ) ' after some digging , build-storybook is failing on vercel production because the @ next/plugin-storybook preset is n't passing rewrites : [ ] into getwebpackconfig next.js/packages/next-plugin-storybook/preset.js line 11 in 8b4d624 const nextwebpackconfig = await getwebpackconfig ( cwd , { which is required to have the property length on this line next.js/packages/next/build/webpack-config.ts line 216 in 8b4d624 const hasrewrites = rewrites.length > 0 || dev < code >
hi ! i do n't know if this is a next.js problem or a framer-motion problem , but my page animation breaks in production while it works perfectly in local host . if you go to my website ( < url > ) you 'll see that when you exit the main page , the main image flashes big and then disappears . the desired behavior is for the red block on the right to expand all the way across and my name to glide up to the upper left corner . please let me know what i can do to demonstrate this better , since this is my first time posting here . in the meantime , my next js code can be found here thank you so much for your help ! < code >
bug report describe the bug when following the with-why-did-you-render example , having a page using a hook and making a change to the _app file will cause the following error : rendered more hooks than during the previous render . i was n't sure if this issue should exist here or on the whydidyourender repo to reproduce steps to reproduce the behavior , please provide code snippets or a repository : go to < url > open up the _app file edit the text in above the layout component see error expected behavior the number of hooks called should be the same and no error should be displayed system information os : macos browser ( if applies ) chrome version of next.js : 9.5.4 and 10.0.0 version of node.js : 10.21.0 < code >
hello guys , great job at the internacionalization proccess ... there is example about how to use domain internacionalization ? and how can i integrate the locale auto detected to my i18n ? and there is a way to load only the language `` dictionary '' that i will use ? thanks so much guys ! < code >
hey there , i was going through the docs found these two parts : and if i want to get inferred typings for my props , i can use infergetstaticpropstype < typeof getstaticprops > : the problem is , if i type getstaticprops with getstaticprops : getstaticprops the props typing does n't work . i went with removing getstaticprops : getstaticprops but i 'm not sure if this is how you people thought it should be . < code > import { getstaticprops } from 'next ' export const getstaticprops : getstaticprops = async ( context ) = > { // ... } import { infergetstaticpropstype } from 'next ' type post = { author : string content : string } export const getstaticprops = async ( ) = > { const res = await fetch ( 'https : // ... /posts ' ) const posts : post [ ] = await res.json ( ) return { props : { posts , } , } } function blog ( { posts } : infergetstaticpropstype < typeof getstaticprops > ) { // will resolve posts to type post [ ] }
hi i am receiving this network error with my nextjs project hosted on netlify and backend hosted on digital ocean vps . the error only happens when i visit a url directly for a page that calls getinitialprops ( ) : do you have any ideas what could be causing this ? i am wholly unfamiliar with networking . thanks for any tips or advice in advance . < code > error : network error : request to < url > failed , reason : hostname/ip does not match certificate 's altnames : host : staging.frontend.co.uk . is not in the cert 's altnames : dns : backend.com , dns : < url >
i could not find any information regarding amp support for the new image component , so i 'm not sure if this is supposed to work or not . i tried using it in an amp page and the image does n't render , so i 'm guessing it 's not supported yet ? < code >
feature request is your feature request related to a problem ? please describe . im kind of missing the information how to access next.js from my local network describe the solution you 'd like extend the next-start and next-dev with more information about the server example describe alternatives you 've considered n/a additional context would you accept a mr like this ? < code > you can view the application in browser . local : 0.0.0.0:3000 on your network : 111.111.111.111:3000
hello , i 've been struggling to nail down an issue where my next.js app ( w/ typescript ) works fine in dev mode but does n't hydrate ( no event handlers , etc . ) in prod mode . unfortunately i get no build errors or any runtime errors . i was able to reliably fix/repro the issue after reducing my app down to a single internal import , but the import is just a simple function , so i 'm completely stumped . i 'm using a fairly standard next.js setup , no custom webpack config like the poster in this issue . here is the repo with a contrived index.tsx where the button works fine in dev mode but not in prod mode . any help greatly appreciated ! < code >
feature request is your feature request related to a problem ? please describe . i would love to see an alternative image source tag on the component . this source should be used on mobile ( portrait ) devices instead of the default source describe the solution you 'd like additional context this would enable lets say a 3:2 image ratio for tablet/desktop and 2:3 image ratio for mobile devices originally posted by @ dohomi in # 18358 < code > < image src= { [ '/path/to/image-3x2.png ' , '/path/to/image-2x3.png ' ] } width= { [ 1200,640 ] } height= { [ 900 , 900 ] } / >
i like the look of the new image component , especially the ability to convert to webp and only load images that are on screen , however i 'm not sure how it will work with our existing image optimization and where exactly is the image resizing happening ? at the moment all of our images are stored in storyblok cms which has image resizing . we currently use a srcset which we have to write manually but it works well . if we start using next/image can it just use the special image resize urls ( something like path-to-image/200x100/image.jpg ) which we use or will it do the resizing itself and if so where will it cache the images ? < code >
feature request i read new next.js feature - < url > i see that list of locales is hardcoded inside next.config.js file . that means that if i add from my admin panel a new locale ( part of app that works through rest api ) next will not receive it , until next server will be restarted and manually changed list in i18n.locales array . how to deal with maintaining locales updates on demand ? any ideas ? thanks ! < code >
hey all , so last night i tried the new image component in my own project . after not getting it working properly i decided to give the example a go to and inspect it to understand what is happening . the remote url is this . i have n't modified the code , deployed directly using the deploy button located in example repo . the example states that as you adjust your browser width , a different sized image is loaded .. but when i inspect network , the only image loaded is from this url : < url > with 1024px width . and when i resize my browser , no new requests with different image sizes are made . tried with safari ( 14.0.1 ) , chrome ( 86.0.4240.111 ) , and firefox ( 82.0 ) . what is going on here ? should n't it be fetching different sizes according to the default breakpoints ? then i cloned it and tried on my local . the only way i am getting different sized images is via changing the width property of the image component . if i change the width and the height properties in the example code , to say 400 instead of 1000 , then i am getting the 420px sized image . when i run the same project on my local ( next dev ) , chrome and firefox are getting webp images , however safari is served with png . however the remote example successfuly serves webp files to safari 14. i checked the local request and the appropriate accept header is present . i cant figure out what im doing wrong . < code >
i get the idea that as a new page shows up , it gets built into static javascript and then somehow deployed as static , but i seem to have missed the implementation detail . what is the tech that generates this page ? is that something that has to be run against netlify or vercel ? is that something that i can setup in a docker container ? sorry if everyone totally gets this and i 'm the only lost puppy out here . feel free to point me at some doc . i 've read the nextjs docs multiple times and it 's just not clear to me what is happening on the server to make this magic happen . ( btw , i 'm really not a fan of the prayer icon when posting for help , feels a little condescending ) < code >
since next.js version 9.5.3 update , it fetches some css files twice . as seen in the above images , one is fetched as a stylesheet , and another one as a fetch . i think this pr made this change . i wonder this behaviour is intended . for reference , i use tailwindcss and emotionjs for this project . and i do n't use @ tailwindcssinjs/macro because i use those two css frameworks separately . < code >
i 'm trying to roll by own localization solution since the built in version does n't support next export , which is critical for my project . is it possible to get / [ locale ] /foo.js to compile out to : /foo /en-us/foo /fr/foo /nl-nl/foo < code >
< url > i want to reproduce the same animation scroll effect ? how to reproduce that please in next.js website ( with ssr , no window object .. ) ? < code >
hello everyone , i am new to nextjs and i 'm having a big issue . i feel like i 've tried everything i could but nothing works . basically , i have a page in which there is a form and onsubmit , i would like to send the data of that form to getstaticprops of another page . in fact , depending on the data received , that second page fetches the details of that data in my database . i have tried several things and the only one i found that worked is creating a blob in the onsubmit function that is then read from the local downloads file in getstaticprops of the other page . that is a big problem because obviously every computer does n't have the same path towards downloads . i 'd like to know how to do beauce i 'm really struggling . can someone help ? < code >
i just upgraded an app to next.js 10 and the only thing that seems to have broken is that one of the class components needed an explicit import react from 'react.js ' where it was n't needed prior to the upgrade . this is n't so much a problem as trying to understand why that would be necessary . thoughts ? < code >
the following code does not work unless the attribute for anchor tag has been changed from classname to class < code > < link href= '' < url > '' > < a classname= '' font-medium text-indigo-500 hover : text-gray-900 transition duration-150 ease-in-out '' > < span > next.js ! < /span > < /a > < /link >
how can i add search bar in next ssg site should i do with the react way ? or is there any plugin or something for adding search bar ? < code >
hi guys , i 'm using next js 8.1.0 and i have a default.js file ( for ssr , where i call getinitialprops ) where i fetch data from magento through graphql and it works well . the problem is only on safari on all iphone versions , when i use safari back button to return on previous page of my website i have this message error in console `` the connection was lost '' and i can see the right page but my async methos to fetch data through graphql does n't work and , of course , these contents are not in the page . all works fine on desktop and on all android devices , any ideas ? thanks in advance ! < code >
my config my project 's vercel url is < url > my domain ( added to project settings in vercel dashboard ) is < url > the issue when i use facebook sharing debugger to inspect the meta tags on a particular url , the meta tags are picked up correctly when using the esourcing-frontend.vercel.app domain and not my actual domain < url > . for example , for a url /uneefy on my website , the og tags are picked up correctly for < url > but not for < url > have a look at these screenshots . < code >
trying to deploy next app i discovered that even minimal version of package.json `` dependencies '' uses stuff that used in build only . is it possible to have next start app that has no babel or other webpack stuff in it ? < code >
when accessing query params from router.query in a useeffect hook , they are only available after the second render pass , although router.aspath includes them . example : on < url > this will log : i realize that according to docs , the query object will only be populated after hydration - but i had assumed that useeffect would only run after the client was hydrated ? < code > // pages/index.js import { useeffect } from `` react '' ; import { userouter } from `` next/router '' ; export default function homepage ( ) { const router = userouter ( ) ; useeffect ( ( ) = > { console.log ( router.aspath ) ; console.log ( router.query ) ; } , [ router.query ] ) ; return null ; } / ? hello=world object { } / ? hello=world object { hello : `` world '' }
feature request is your feature request related to a problem ? please describe . yes , from rfc : returning redirects from getserversideprops / getstaticprops copy paste the logic on every pages that fetch datas in ssr is not dry . it seems difficult to implement it when api calls are chained : check the return on every line is really redundant . surround everything with a try catch do not seems to be granular enough . describe the solution you 'd like a method to implement server side ( e.g . axios interceptors ) would be more convenient : describe alternatives you 've considered additional context none < code > export default function homepage ( ) { return hello world } export async function getserversideprops ( { params } ) { const item = await getdata ( params.id ) if ( ! item ) { return { redirect : { permanent : false , destination : '/somewhere-else ' } } } return { props : { item } } } export async function getserversideprops ( { query } ) { const documents = await getdocuments ( query.id ) const users = await getusers ( documents ) const kittens = await getkittens ( users ) return ( { props : { documents , users , kittens } } ) import { redirect } from 'next/server-side ' // maybe : { router } from 'next/server-side ' import { login } from 'constants/routes ' // [ ... ] // axios interceptor static responseerror ( error ) { if ( error ? .response ? .status === 401 ) { redirect ( login ) } }
when using react-router , we can use browserhistory.listenbefore to monitor routing , when we use next-router , how can we realize the url of the monitoring route ? < code > const unlisten = browserhistory.listenbefore ( ( location , cb ) = > { const currentpathname = window.location.pathname ; const currentsearch = window.location.search ; const nextpathname = location.pathname ; const nextsearch = location.search ; ispopup = false ;
i want to avoid including style-src 'unsafe-inline ' in my csp for security reasons . however , styles seem to be broken without it ( getting an error suggesting i need a nonce or hash for the style-src , even when it falls back to default-src 'self ' ) . i ca n't figure out how to assign a nonce or get the hash for my styles . i see # 7486 which seems to be more focused on the script side of things ( which i have no problem with , default-src 'self ' works fine ) . and there 's < url > which also does n't touch on the styles . also , i want to be able to specify the csp in my next.config.js which is possible now . < code >
access to fetch at ' < url > from origin ' < url > ' has been blocked by cors policy : no 'access-control-allow-origin ' header is present on the requested resource . if an opaque response serves your needs , set the request 's mode to 'no-cors ' to fetch the resource with cors disabled . i 'm getting this error while trying to fetch youtube video info using ytdl-core . using cors it can be fixed but i ca n't figure out how can i use cors with next.js custom server . can anyone please help me with this ? < code >
bug report describe the bug i have this ref that i 'm trying to make into an observable with rxjs : const input = useref ( ) ; const observabletry = fromevent ( input.current , //this input already have a handle that sets the new state 'change ' , ) .pipe ( tap ( console.log ) ) ; then simply i 'm trying to subscribe to it : useeffect ( ( ) = > { observabletry.subscribe ( ) } ) after a 'fast refresh ' it usually works . after a reload it start giving errors . after an error , a 'fast refresh ' keeps on giving errors and i have to do a reload again . not able to reproduce anymore , but a while ago the reload was n't only giving errors , but `` breaking '' ( stopping ) the whole `` next dev '' script . i 'm already use a `` predev '' script that rimraf the '.next ' folder since i 've had a few problems with persisting errors before . my structure until now is basically the `` create next app '' and from the index page i call my `` app '' component that have a `` input component '' that have this logic . to reproduce create a observable from a reference ( ex : useref ) and try to subscribe to it . expected behavior in this case , any change to the value of the input should be logged to the console . screenshots system information os : windows 10 version of next.js : 9.5.5 version of node.js : 12.19.0 additional context i believe this to be some weird side effect related to next compiler with rxjs and not from react/rxjs alone . < code >
i am having trouble getting my theme color mode to persist on refresh of a dynamic router ( created by getstaticpaths and using getstaticprops ) . it works fine if i navigate from the index page ( or refresh on the index page ) but if i load one of the dynamic pages ( or refresh on one ) it breaks the color mode and resets the styles to the default color mode . is there something i am missing about the ssg pages in the docs ? < code >
hi , i have /embed/ * routes with few widgets and they should be iframe available for any origin but all another routes must be protected with x-frame-options : deny , how this can be configured with 9.5.0 headers ( same issue with vercel.json headers ) ? < code >
i tried using labelled tuples in our project but i always get the error shown below . i tried digging how i can use the feature and it seems that i need to use babel v7.11 for this and it seems that nextjs is using babel 7.0.0. i also found out that i can not override the babel version used in nextjs . is there any way to use the new features in typescript 4.0 ? < code >
i have a question about incremental static regenerator . is there a limit on how many pages can statically be generated ? are there any drawbacks to generating , let 's say , 200k static pages ? if there are limits , is there a way to optimize this ? thank you for your time . < code >
i 'm writing a small function in next js with react . when i use navigator , i get the following error . referenceerror : navigator is not defined here 's my code : i know this renders on server that 's why throwing error . but how do i make it run on the browser to get the platform and then render a section based on that ? < code > import react from `` react '' ; export default function app ( ) { const ismac = navigator.platform.touppercase ( ) .indexof ( `` mac '' ) > = 0 ; return ( { ismac ? `` i 'm mac '' : `` i 'm windows '' } ) ; }
hey there , i just read the documentation of next about browserslist configuration , and also search in the entire repo for information about it . i do n't see anywhere that i could use .browserslistrc over package.browserslist configuration . is this possible ? it would be good to document about the usage of the file itself instead of using package.browserslist . < code >
hello , we have a nextjs app for an online shop . we also have a complex animated welcome page built in static html and js . rather than converting the welcome page to react , i would like to load the html page from the public folder when user is at the root route '/ ' . anyone know how to do this ? thanks < code >
i have an api route /api that the client will hit when it wants data . i have other pages : /page1 , /page2 that want to load data from the db in their getinitialprops . should i have /page1 and /page2 connect to the db to get their data when they are rendering on the server ? or should only /api connect to the db and /page1 and /page2 should simply send an http request to /api to get the data ? note that i am using apollo , so schemalink ( < url > ) makes the request handling on the part of any page easy ( i.e . i could use the same graphql schema for /api , /page1 , and /page2 ) . i 'm just not sure if opening a lot more connections to the db ( 1 for every page that needs db data ) is actually considered better than making the http request from each page to the /api route . < code >
i installed next using npx create-next-app and created a components directory in the root . i added 2 files , components/element1.js and components/element1.module.css inside components/element1.module.css , i added the following code : .xyz { color : green ; background-color : red ; } inside components/element1.js , i added the following : later , i imported element1 inside index.js and used it . here 's the code for index.js : i 'm unable to see the styling being applied in element1 component . i have not used any external libraries since next supports module.css feature by default . i do n't really understand what am i missing . my version of next is 9.5.5. please help ! < code > import head from 'next/head ' import element1 from ' .. /components/element1 ' export default function home ( ) { return ( < div > < head > < title > create next app < /title > < link rel= '' icon '' href= '' /favicon.ico '' / > < /head > < element1 / > < /div > ) } import { fragment } from `` react '' ; import styles from './element1.module.css ' export default function element1 ( ) { return ( < fragment > < h1 classname= '' styles.xyz '' > hello there < /h1 > < /fragment > ) }
hi , in my app , i 'm sending request from getinitialprops to an api endpoint ( in /api folder ) . when running my app in localhost , everything works , because it 's all under same domain ( localhost ) . after deploying my app successfully to aws-lambda ( using serverless-next.js ) , those requests does n't work anymore . the reason is that the host header when running getinitialprops in server , is myappbucket.s3.us-east-1.amazonaws.com , but the app domain is < url > .. request to myappbucket.s3.us-east-1.amazonaws.com/api/users does n't work but < url > works . but i do n't have < url > when running getinitialprops . i do n't want to put the domain as an env var . there is another solution for this ? thanks < code >
in create react app , i used to have a snippet like below in my index.html head section . it instantiates an npm lib to use settings for my website . but i ca n't include < script > tags in the nextjs header . where should this type of snippet go in nextjs ? what i tried : i removed the html tags , added a 'window is not undefined ' conditional so the server does n't error , & then i tried placing it in my next/head component , _app.js , & pages/index.js but have n't found a spot where it works yet . oddly , i 've seen it work noce or twice , but without changing any code , it would then fail again consistently after a hard refresh : ( < code > < script type= '' text/javascript '' > window.acme_config = { hosts : [ { domain : 'example.com ' , foo : bar } ] } < /script >
i am trying to solve this question : is there any way to know how many [ id ] .json files have been generated with incremental static regeneration and fallback=true in production . # 18109 i tried to use process.cwd ( ) to traverse the files ( hosted in vercel ) but i got this error . < code >
hello next.js'ers , i 've got a question : i 'm working with mdx and next.js , to build a blog / documentation website . due to some great examples i 've figured out i can scan the filesystem at build time to compile a list of the mdx pages in my app . this is useful to make a documentation sidebar / blog posts overview page . i place my mdx pages inside the /pages directory and make use of the mdx plugin to compile these files as pages . now , i 'd like to build these mdx pages on the fly using fallback : true , to achieve quicker build times . i ca n't use a /blog/ [ post ] .tsx dynamic route , because it is not possible to `` read '' mdx files at build time without making the generated pages 2x as large ( due to the nature of getstaticprops and __next_data__ ) . instead , i have the mdx pages inside the /pages directory . what if we could set fallback on getstaticprops ? because of this , i ca n't think of any way to use fallback mode with these mdx pages , which would be really nice to do . what do you think ? < code >
i have a next.js app running on vercel . the problem i have is ... to use getstaticprops you have to use an absolute url in my getstaticprops i 'm making a call to a dynamic api route to fetch some json when the build process runs for the first time on vercel the url of the api route does n't point to anywhere ( because it has n't been built yet ) . and , on subsequent deploys , if i change the code in the api route , i ca n't access this during the build process that runs when i push this code . how can i resolve these issues ? surely i 'm missing something obvious . < code >
hi , i have some question about serverless on lambda now , in my case , i deployed aws elasticbeanstalk because of fail setup lambda . the problem is i think lots of developers want to adopt lambda for serverless , but after update from nextjs 8 to nextjs 9 , the next module is supported to serverless on aws lambda @ edge with cloudfront for super-fast loading anywhere in the world . it 's cool ! , however , the lambda @ edge service only works on just us-ease-1 ( virginia ) . and lambda need to vpc and netgatway if want to connect rds ( it can not connect another region network ) also , many applications or websites need to databases like aws rds or aurora . but original source file or source place on the virginia region aws . and source file copy replica version on the world cloudfront region . the problem is in the case database can not connect with service becuase the real source file is placed in virginia region aws . so , in other places like europe , aisa or other countries can not access rds . that 's it i need to your opinion and ideas ! thanks now using nextjs9 rds mysql region aisa/seoul region wanted to apply lambda with rds < code >
hi ! wish someone can help me with this . i have a next project deployed in amplify . it contains a registration site for a company . it happens to me that wen arriving to the registration from a landing site , all the analytics query params and some we use are `` lost '' due to a 302 redirect . example : someone arrives to < url > clicks a button that opens in a new page a link to : < url > registration site is loaded but without the query params : < url > network response : request url : < url > request method : get status code : 302 response headers : location : < url > expected result when coming from < url > and being redirected to start.domain.com/ ? plantype=full , no redirection is done and params are kept . < code >
what is the best way to build a big amount of pages ? this is wordpress headless cms that has 90k pages . i am using graphql to fetch data . is there a way to optimize this because now it takes a lot of time to build them ? is it good for all pages to be static with the revalidate option to update content ? are there any drawbacks to using this method , and is it possible to overcome them ? if not , what do you suggest ? i am pretty flexible and i can easily change the flow of the project for now . < code >
hello ! my company uses adobe fonts as their web font platform and we are looking to add support into nextjs to optimize those fonts . i 've recently created a pr for adding font-optimization support for adobe fonts / typekit . changes can be reviewed here , # 18146 i was n't sure what the appropriate process was for adding a new feature , so i hope this is the right place 🤞 if this is n't the right place , please point me in the right direction ! thanks , andrew < code >
i am facing a problem where view page source only returns a bunch a scripts with almost no page related html code , and i am not using redux-persist , anyone has idea on this ? < code >
in this example , it uses yarn -- cwd packages/ < workspacename > < commandname > to execute commands for the application . i thought yarn workspace < workspacename > < commandname > would be more intuitive and suited as a `` workspace example '' . i tested and worked fine . is there any reason why workspace command is not recommended here ? < code >
i am trying to get ssg working along with redux persist but sadly < div id= '' __next '' > < /div > is always empty even when i use redux persist . expected : ( without redux persist ) - works perfectly , the data appears in the dom from the store . getting : ( with redux persist ) - persists perfectly , but __next div is always empty therefore making it non-seo friendly and voids the point of doing ssg . i am using getstaticprops to fetch the data and dispatch actions on the store within getstaticprops . my getstaticprops implementation with and without redux persist is of the form : any help would be appreciated . < code > export const getstaticprops = wrapper.getstaticprops ( async ( { params , store } ) = > { store.dispatch ( { type : '' some_type '' , payload : { } } ) } ) ;
i tried using plyr.io but could n't get it to work with nextjs . ended up using html5 player . does anyone have ideas on how to make it work ? ( tried react component version as well ) . < code >
server rendered pages will get cookies from context , static pages from browser , sounds sane . is it possible to do in _app.js ? other option takes more effort and much less preferable : i could add getinitialprops to every ssr page , pass cookies to my app 's layout component and handle fallback to browser cookies in layout upd : after some thinking i come to conclusion that getinitialprops would not harm to performance much , so it 's not a big deal < code >
hi anyone encountering crashes while running dev server like this assertion failed : ( 0 ) , function uv_close , file .. /deps/uv/src/unix/core.c , line 178. from discussion in webpack/webpack # 10037 ( comment ) it appears to be something with respect to file watcher watchpack .. next version 9.4.1 < code >
local environment redirects work perfectly with getinitialprops , but in my netlify frontend they do not . my backend is hosted on a vps and a different domain . < code >
hi , can i get yarn build to list all the statically generated paths ? now i get : i 'd love to be able to check all the generated paths for correctness and completeness . < code > / [ locale ] /apply/ [ [ ... slug ] ] 2.31 kb 528 kb /en/apply/some-nested-page /en/apply/another-nested-page /en/apply/some-other-nested-page [ +15 more paths ]
hi to every one . how to fix this . i did nothing for this and error show up randomly . unhandled runtime error typeerror : n.getfiberroots is not a function my package.json `` dependencies '' : { `` @ material-ui/core '' : `` ^4.11.0 '' , `` @ material-ui/icons '' : `` ^4.9.1 '' , `` @ material-ui/lab '' : `` ^4.0.0-alpha.56 '' , `` @ zeit/next-css '' : `` ^1.0.1 '' , `` axios '' : `` ^0.20.0 '' , `` bcryptjs '' : `` ^2.4.3 '' , `` bootstrap '' : `` ^4.5.3 '' , `` firebase '' : `` ^7.24.0 '' , `` fs '' : `` 0.0.1-security '' , `` jsonwebtoken '' : `` ^8.5.1 '' , `` next '' : `` ^9.5.5 '' , `` react '' : `` ^16.14.0 '' , `` react-dom '' : `` ^16.14.0 '' , `` react-image-gallery '' : `` ^1.0.8 '' , `` reactstrap '' : `` ^8.6.0 '' , `` slugify '' : `` ^1.4.5 '' } < code >
feature request is your feature request related to a problem ? please describe . the only advised route for having a health check is # 6750 but i would like to ask to have a .well-known health check build in the core itself . we have health checks on container level , and never expose it to the real world . describe the solution you 'd like please do not let people make endpoints for having a health check , but look how it could be part of the server core , on a well known entry from which the server runs ( so if i run under baseurl '/foo ' i dont want '/foo/health ' but something like /.well-known/health or so ? describe alternatives you 've considered i considered running the app from own express server , but i just like everything to be nextjs . but if you consider it , i at least tried : ) < code >
i suppose what i 'm looking for is something like getstaticprops , but for components . unfortunately getstaticprops only works for pages . say i have inside my component a reference to an image . < img src= { require ( ' .. /public/photo.jpg ' ) } / > . this image is required at build time , otherwise you would get a module not found error . i wish to replace the src of this image with a base64 encoded data-uri . this data-uri comes from a third party service ( visit url , returns the string ) ; but i do n't want the data-uri to be fetched each time the component is mounted . this is a 20x20px pixel image used for blur-up effect , so it really needs to be part of the page during the time of request . does anyone know the best way to achieve this ? ( edited for clarity ) < code >
the nextjs docs say : `` css modules are an optional feature and are only enabled for files with the .module.css extension . regular stylesheets and global css files are still supported . '' but trying to use non-module css at the component level gives an error ( next 9.5.5 ) : `` global css can not be imported from files other than your custom . please move all global css imports to src/pages/_app.js . or convert the import to component-level css ( css modules ) . read more : < url > the docs are misleading imo . modules are , unfortunately , required for css used at the component level . needing to move all css out of co-located files into a global css file does n't make css modules optional , it means they 're required ... unless wanting to be really dirty with component-level css all dumped into a global file . tldr ; i think the docs should ideally be updated , as long as this remains the case , to say : `` css modules are required at the component level . '' < code >
bug report describe the bug a clear and concise description of what the bug is . to reproduce steps to reproduce the behavior , please provide code snippets or a repository : go to ' < url > enter enter a value in the first input field quickly enter the same value in the second input field in safari , firefox the loading states resolves , in chrome it stays in loading state forever . seems to end up in a validating state , check the console you may have to try some different values before you see the issue expected behavior chrome should work same as safari and firefox system information os : macos browser ( if applies ) version 86.0.4240.111 ( official build ) ( x86_64 ) version of next.js : 9.5.5 running on vercel additional context repo is here : < url > similar code is found here : < url > - this does work in codesandbox in chrome , it 's almost identical to the nextjs code on vercel < code >
at times during the initial load , the next link tag does not redirect correctly . when you update the page , it starts working . please , has anyone been through this situation ? some tools used in the project : material-ui redux redux-persist < code >
as described in the title , looks like that next is duplicating the import adding twice a single css chunk . as you can see below , it has the same base64 hash at the beginning of the file name , but the final is different . the urls paths are different as well : returning 404 : < url > returning 200 : < url > do you have some suggestions for what can be the problem and how to fix it ? i am not able to figure it once i even do n't know where to find , once i did not configured directly nothing related recently . if i even were able to remove the 404 < link > s , it would be enough . < code >
feature request is your feature request related to a problem ? please describe . analytics is a pretty common use case for modern apps . a frequent implementation for analytics is when user loads a particular screen . nextjs 's router has excellent set of lifecycle events . the most close to this use case is routechangecomplete we can use this to log analytics centrally from the application template _app.ts from one central location . however this does n't works for the first page load but on all pages post the first page load . describe the solution you 'd like we can have an optional flag to execute the callback of routechangecomplete which would execute on first load as well . describe alternatives you 've considered useeffect ( ( ) = > makeanalyticscall ( ) , [ ] ) is not clean since this needs to be applied on all pages of the app . routechangecomplete is near perfect baring the first page load . < code >
hey , i 'm trying to deploy my nextjs app to mydomain.com and dev.mydomain.com . when i visit mydomain.com , everything looks great . but when i go to dev.mydomain.com , none of the pages load ( 404 ) . i assume the dev subdomain is interfering with how pages are looked up in /pages directory . i 've searched the internet but have not found a solution to this problem without using vercel ( i prefer to deploy my site myself ) . i 'm currently using firebase hosting and firebase functions . any ideas ? < code >
i did n't found that this feature already exists in next js or not when we use getstaticpaths then this method brings all the available urls from the server and then renders the page using getstaticprops . this is great . use case - update suppose i have a blog website when 1000s of blogs are posted on daily basis . a user rahul posted a blog after few he noticed that blogs post need some changes . to do some changes he needs to rebuild the whole website . use case - remove after posting the blog , website owners noticed that this post has some harmful content and he wants to delete that post . in sort getstaticprops and getstaticpaths saves the url in the json file , and i want to update the url and remove the url at run time . < code >
hi guys ! i 'm working on a project which requires ssr for seo , and i 'm checking out nextjs+ react . my bundle size is around 250kb+- , my api requests time is around 200-500ms , but the page serving and the react hydration takes time and im ending up with 1-2s requests and even more depending on request amount . i wanted to know if someone stumbled upon the same issue ? is it react ssr and rendertostring is too slow and this is reason most of the parts works fine but ending up with long request time to server the page ? thanks guys ! : ) < code >
hi everyone ! i 've just finished creating my site at < url > . i would like to build out < url > this for the blog section , but do n't want to add apollo to my current site , as it seems like it would be annoying - currently using react-query . also my main site i have some load speed issues to fix and do n't want to complicate things when i can just use this tutorial site above . if i use the new feature from next to use a different base url , being /blog , would the seo flow through to the main index site ? alternatively - would using react-query be difficult to implement the same functionality ? thanks ! < code >
hi , we have a serious performance issue when we test the loading speed in google pagespeed insights . we have read a lot of guides , but we still have n't found a solution how to make the download speed index on mobile devices increase . as a test , we used one page , where everything was connected via dynamic import , but this did not speed up . my development team is at an impasse , and we do n't know where to go next . maybe there is some kind of solution that is not written anywhere ? screenshot with pagespeed rating < code >
as shown in the figure . similar , < url > // need . css modules import styles from './foo.less ' ; // no css modules import './foo.less ' ; < code >
i develop a browser extension and i want to send requests to my own api routes to the nextjs app but all i get is i know that i need to add maybe the url to the permissions of the manifest.json that the extension has and i added it but still ca n't get it working to accept api calls , apis like unsplash for example worked instantly . anyone who can help me out ? thanks < code > access to xmlhttprequest at ' < url > from origin 'chrome-extension : //iociilcemoadfblogekljlomfecdo ' has been blocked by cors policy : response to preflight request does n't pass access control check : no 'access-control-allow-origin ' header is present on the requested resource .
i 'm trying to implement a react component shortcode for use by users editing the content in the database . the way i 'm doing it is by rendering the component and replacing it in the html from the database using this function called from getstaticprops after fetching the page html . ultimately the template renders out the html like this : < div classname= { styles.content } dangerouslysetinnerhtml= { { __html : page.body } } > < /div > this is all working well . the html is rendered out with the generated css module classnames , but the styles themselves are never included on the page . is there a way to get the styles to be included when rendering in this way ? < code > export function populatecomponents ( html ) { const shortcodes = html.matchall ( /\ component id= '' ( . * ? ) '' \ phofhyperlink \ [ \/component\ ] /gs ) try { for ( let shortcode of shortcodes ) { const wholeshortcode = shortcode [ 0 ] const componentid = shortcode [ 1 ] const componentconfiguration = json.parse ( shortcode [ 2 ] ) if ( componentid ) { const component = require ( 'components/ ' + componentid + '.js ' ) const rendered = rendertostring ( react.createelement ( component.default , componentconfiguration ) ) html = html.replace ( wholeshortcode , rendered ) } } } catch ( e ) { console.log ( e ) } return html }
i want to make sure my getstaticprops code does not end up in js bundles , and that includes functions called which have to be imported at the page level . does using typescript have any effect ? do i need to use require ( ) and/or node 's fs.readfilesync to load modules and any api keys inside the gsp function body ? < code >
currently , it seems that it 's unavoidable for my app for use _app.getinitialprops for user data , but on the page 's perspective , i think i could optimized the api call by using getstaticprops ( with revalidate ) . what i want to know is , is the combination a good practice and doable solution ? < code >
hi , i have a query string as follows news ? state [ ] =2 & state [ ] =3 & state [ ] =4 & date-from=2020-01-09 & date-to=2020-05-07 how do i get the state values as there are multiple values assigned to it ? also , how do i get the date params as they have - in the name of the param ? < code >
i am almost certainly missing something obvious - but i can not for the life of me work out what it is . i have a standard nextjs ssg site running using api routes . when i deploy the site behind cloudflare it will not load as the api is returning nothing . this is because ( i think ) the ssl is at cloudflares end and when the server tried to get the api it is finding itself which does n't have https . the app is running in a docker container and there is no ssl on the server itself ... is the only answer to add ssl to the server do you think ? < code >
how can i solve a 404 error on a custom server route setup with express ? 'const express = require ( 'express ' ) const next = require ( 'next ' ) const bodyparser = require ( 'body-parser ' ) const dev = process.env.node_env ! == 'production ' const app = next ( { dev } ) const handle = app.getrequesthandler ( ) const mailer = require ( './utils/mailer ' ) app.prepare ( ) .then ( ( ) = > { const server = express ( ) } ) ' < code > server.use ( bodyparser.json ( ) ) server.post ( '/api/join ' , ( req , res ) = > { // return handle ( req , res ) const { email } = req.body console.log ( `` this is the request body : '' , req.body ) mailer ( { text : email } ) .then ( ( ) = > { console.log ( 'success ' ) res.send ( 'success ' ) } ) .catch ( ( error ) = > { console.log ( 'failed ' , error ) res.send ( 'bad ' ) } ) ; } ) server.get ( ' * ' , ( req , res ) = > { return handle ( req , res ) } ) server.listen ( 3000 , ( err ) = > { if ( err ) throw err console.log ( ' > read on < url > ' ) } )
i 'm trying to make use of next/router in a react component library so that i can add routing logic into my react components . this library will only ever be consumed inside a next.js project . the component library is n't a next.js project but i have added next.js as a peer dependency . when using any part of userrouter ( ) i always get null errors . both of these error out saying : can not read property 'pathname ' of null can not read property 'push ' of null i suspect this is because i ca n't use next/router while not specifically running a next project but is there a way around this , or am i missing something ? < code > export const button = ( ) = > { const router = userouter ( ) const onclick = ( ) = > { console.log ( router.pathname ) router.push ( `` /home '' ) }
i have a page setup that looks like this : /blog/ [ id ] .tsx when i switch from /blog/1 to /blog/2 , i want the < div classname= '' inner '' > to not display and instead show the < spinner > while the other page loads . once the page finishes loading the < spinner > should hide itself . the problem with the solutions i see online is they are for global page transitions ; it is not possible to only have the transition show for a defined page ( i have other pages which does not need the spinner ) . how do i achieve the above effect ? < code > const blogpost : nextpage < blogpostprops > = ( { blogpost } ) = > ( < > < navbar / > < spinner / > < div classname= '' inner '' > { blogpost } < /div > < / > ) ; ... getstaicprops etc
after one hour when token expires , the browser console shows 401 errors ... i believe the example does n't use getidtoken ( ) and therefore does not trigger the refreshing of the access token . additionnally , accessing user.xa in mapuserdata.js does not seem a documented approach to getting the token . < code >
after an update to some new nextjs version i started to notice the following message from the next dev server : can someone provide more context on what it means and how it can be fixed ? < code > ! ! ! warning ! ! ! your function crashed , but closed the response before allowing the function to exit . this may cause unexpected behavior for the next request .
i 've tried to run my project in sub folder , i ' v changed my assetprefix to run assets from sub folder but i cant define my base url as < url > ( that base url include subfolder ) how can i run my project in subfolder ? thanks < code >
using getstaticpaths in combination with trailingslash : true leads to invalid json prefetching . for a link to a dynamic route , the json file that is prefetched includes an invalid slash in the path , causing a 404 to be returned . example : while on the homepage , clicking on the navigation for the /about page request a resource `` _next/data/it/about/.json '' instead of `` _next/data/it/about.json '' anyone else experiencing this ? 😢 < code >
i prod-built my code twice , without a single code change . both times all chunks got the same names except these : build 1 : chunks/commons.de9959.js [ ~3 mb ] - so need it to be same if there 's no code change ☹️ chunks/webpack.384624.js build 2 : chunks/commons.57b734.js chunks/webpack.7da0b4.js any clue on whether this is expected ? or should i take care of something while doing my prod build . < code >
the specific use case i am trying to solve is that i want to statically generate all `` valid '' dynamic paths based on entries of a specific type found on a headless cms . so if a user tries navigating to an invalid path , they would get redirected to a default page defined on a different static path . ideally , i would set fallback to false so the fallback check is n't necessary , but really it 's just a nice-to-have . i have managed to trigger a client-side redirect on a dynamic route page component by assessing through next router whether a page is on a fallback route , but this requires rendering the initial page first -- and in my case , since the page component requires data from a cms call , requires turning these `` required '' props into `` optional '' props and essentially adding fallback-specific render logic . with getserversideprops , i was able to trigger a server-side redirect when we were unable to retrieve the required data for these props , but i 'm wondering if there is an analogous approach using getstaticprops and getstaticpaths ? one approach i have been curious about is using the incremental adoption approach for rewrites defined within next.config.js as illustrated here . when i tried this myself , it still rendered the fallback when fallback is set to true and 404 when set to false . i was wondering if anyone has gotten this approach to work for them ? < code >
i 'm following this example to move my application to firebase hosting . after deployment , everything seems to be okay , except for accessing static assets . i 've stored all of my static files under this directory : /src/public/ , and to access an image , i 'm doing this src='/my-image ' this seems to work fine in the dev mode ( npm run dev ) , static images/svg loads as expected . but when the application is deployed on firebase , it does n't work . it shows no image in the /my-image path . what to do now ? @ jthegedus < code >
seeing the comment [ 1 ] , i wonder if i should use css-modules from now for next.js . on the other hand , i also saw that css-modules is recommended over css-in-js [ 2 ] . wo n't css-modules be deprecated for next.js and can i use it without worries about the future ? [ 1 ] webpack-contrib/css-loader # 1050 ( comment ) [ 2 ] # 15542 < code >
when i am trying to mach pages in my server.js everything is working until there are params in path . my folder tree : matching in server.js : when you go on < url > application throws following error : expected result . matched different language variations of url to single page file . steps to reproduce . follow this example , add page with params and mach it with custom path : < url > unfortunately i did not find a way to provide 'as ' value neither documentation describing how to make it work . version of next.js : 9.5.5 < code > unhandled runtime error error : the provided 'as ' value ( /potvrdit-email/some-test-token ) is incompatible with the 'href ' value ( /confirm-email/ [ token ] ) . read more : < url > src pages confirm-email [ token ] .tsx expressapp.get ( '/potvrdit-email/ : token ' , ( req , res ) = > { nextapp.render ( req , res , '/confirm-email/ < cur > { req.params.token } ' , { ... req.query , ... req.params } ) ; } ) ;
hi , i have a list of items in menu and menu on every page , its not static , it is queried from api . is there anyway to query one time in _app.js then pass to react context ? i read document but if use getinitialprops , site will be slower ... or i must run query in every page to get menu list ? can you give me an idea ? thank you < code >
is this the right way of storing data from getstaticprops to usestate hooks /users/ e.g < code > const index = ( { data } ) = > { const [ state , setstate ] = usestate ( data ) ; return ( < div classname= '' container '' > < div classname= '' row '' > { state.map ( ( { id , ... otherprops } ) = > < card key= { id } id= { id } { ... otherprops } / > ) } < /div > < /div > ) ; } ; export async function getstaticprops ( ) { const res = await fetch ( ' < url > ) ; const data = await res.json ( ) ; return { props : { data } } ; }
our site will be quite large once complete and each page needs to make ~10 api calls , so we 'd like next to skip rendering pages when building pull request branches . we can live with full rebuilds in our main integration branches . either skip rendering or some more limited test like making sure tsc is happy . any ideas ? < code >
the issue is i have 5 next.js apps deployed on a kunerbenetes cluster with traefik as ingress controller . now , traefik is ca n't reach them ( returns 502 bad gateway ) . checked the logs of each pod and saw they are all listening on localhost . i want to know if it 's possible to specify the hostname from within next.config.js since it has to be dynamic ( so i ca n't pass a static -- hostname to next start ) . < code >
feature request is your feature request related to a problem ? please describe . our app is dual-hosted : in an intranet it shows fresh content from a cms that editors are working in . however the final product is required to be a static build with the content frozen at build-time . the final site ca n't call the cms , so getinitialprops is out . and getserversideprops is -- seemingly arbitrarily -- banned from export . so we 're limping along with getstaticprops and revalidate : 1. so cms editors see fresh content on the very next refresh , we have to ignore the props from next and re-fetch from the client . describe the solution you 'd like getserversideprops could export just like getstaticprops , freezing output into json files . < code >
hi , greetings , i am pretty much new to next js , had to convert react to ssr , so used next js , everything is working fine , and i have filter applied on data , it even shows filtered data in redux dev tools , but rendering same unfiltered data . i am having hard time understanding get server side props , initial props concepts , and i think i 'm missing it in my components , need help to implement it correctly just for this component . i 'm using next redux wrapper . thanks < code >
feature request is your feature request related to a problem ? please describe . our public site must be static , however many pages must have dynamic access to a large data structure ( from a cms ) that gets frozen at export-time . on our intranet , we use next start with preview mode to see fresh content from the cms . sending this data from getstaticprops would mean every page loading a large json file . describe the solution you 'd like pages/api/foo.json.js would be a regular json-returning api route in the build ( at /pages/api/foo.json ) , but would become a static json file during next export . static pages could simply fetch it client-side . next offering an async function like fetchapijson ( 'foo ' ) that knows the right build-time url would offer better control of caching . describe alternatives you 've considered we 're considering duplicating this effort in an express route that handles /data.json during development , then at build-time creating the real file to live beside the static export . < code >
describe the bug not sure if its a bug or something else . but when using nextjs without any custom server , it compiles the pages pretty fast . but when using a custom server ( like express ) , the app.prepare promise takes about 10-20 seconds to resolve . is there any way to make it faster ? or is there any way so that it can automatically determine , whether react code is changed or server code is changed , and it will run/re-run only the necessary functions/portion of codes ? to reproduce i 'm using this configuration for custom express server using nextjs : < url > ( using this boilerplate : < url > ) when changing anything whether it be in the react code or in the express-sevrer ( in the server.js file ) code , it takes about 10-20 seconds to compile the pages . expected behavior i wish it was faster like working in normal cra app or like when running next instead of nodemon server/apis/server.js system information os : windows 10 64bit ( 12 gb ram ) browser : chrome version of next.js : 9.5.2 version of node.js : 12.18.2 additional context i tried googling the problem . but found no solution that works < code >
hi , hopefully this is the right place to help but i am having trouble importing the npm package drei when using nextjs , i am importing it like this : import { orbitcontrols , standardeffects , draco } from 'drei ' and the error i get is this : i 've imported it in a react-app and it works perfectly fine with no syntaxerror so i assume nextjs app is missing something that react app has ? or maybe its a threejs issue but that works perfectly fine in nextjs before importing drei -- i hope someone can point me in the right direction . any help is appreciated . < code > c : \users\user\desktop\webdev\r3f-own-nextjs\node_modules\three\examples\jsm\lines\linegeometry.js:2 import { linesegmentsgeometry } from `` .. /lines/linesegmentsgeometry.js '' ; ^ syntaxerror : unexpected token { at module._compile ( internal/modules/cjs/loader.js:723:23 ) at object.module._extensions .. js ( internal/modules/cjs/loader.js:789:10 ) at module.load ( internal/modules/cjs/loader.js:653:32 ) at trymoduleload ( internal/modules/cjs/loader.js:593:12 ) at function.module._load ( internal/modules/cjs/loader.js:585:3 ) at module.require ( internal/modules/cjs/loader.js:692:17 ) at require ( internal/modules/cjs/helpers.js:25:18 ) at object. < anonymous > ( c : \users\alejandro\desktop\webdev\r3f-own-nextjs\node_modules\drei\index.cjs.js:11:20 ) at module._compile ( internal/modules/cjs/loader.js:778:30 ) at object.module._extensions .. js ( internal/modules/cjs/loader.js:789:10 ) c : \users\user\desktop\webdev\r3f-own-nextjs\node_modules\three\examples\jsm\lines\linegeometry.js:2
i have 5 env local , development , alpha , beta ( stage ) , production next dev is used to only local but , i want to build as development mode or alpha for not minify , uglify , and to use browser react developer tools . but next build is always run as production . help me plz : ) < code >
hi , i used amp-carousel and added attributes autoplay loop , but it is n't working . the console print : is something wrong with my code ? or how can i use correct method amp-carousel with loop and autoplay ? < code > error the attribute 'autoplay ' in tag 'amp-carousel ' is set to the invalid value 'true ' . < url > error the attribute 'loop ' in tag 'amp-carousel ' is set to the invalid value 'true ' . < url > < amp-carousel type= '' slides '' width= '' 950 '' height= '' 500 '' controls loop autoplay layout= '' responsive '' delay= '' 3000 '' role= '' region '' aria-label= '' looping carousel '' > ... < /amp-carousel >
feature request is your feature request related to a problem ? please describe . when using getstaticprops or getserversideprops , i can return data in that function : that is very useful , because now i can infer the return types of that function for my props . however , from api routes i do n't get the types . describe the solution you 'd like i would like to be able to return a promise in an api route : now i can import the type in my component and use it . describe alternatives you 've considered i 'm not aware of an alternative for this . < code > const { prismaclient } = require ( ' @ prisma/client ' ) const client = new prismaclient ( ) export default async ( req , res ) = > { const data = await client.user.findmany ( ) return data } export async function getstaticprops ( { params } ) { const user = await prisma.user.findone ( { where : { id : number ( params.id ) , } } ) return { props : { user , } , } } import usersapi from ' .. /api/users ' export default function users ( { users } : infertypes < typeof usersapi > ) { return < div > ... < /div > }
i 'm currently migrating a large react app that used react-router to next . by default , react-router is case sensitive , while next is n't . is there a way to replicate the behavior of react-router ( case insensitive routes ) using rewrites ? < code >
when using dynamic import ( ) inside a client-side script , typically to conditionally load a polyfill , like so : an unhandled rejection ( chunkloaderror ) : loading chunk polyfill.pepjs failed error is raised . this can be overcome by specifying the webpack output path inside next.config.js with : but , is this a bug or the normal behaviour ? < code > config.output.publicpath = '/_next/ ' ; const loadpolyfill = ( ) = > new promise ( ( resolve , reject ) = > { import ( / * webpackchunkname : `` polyfill.pepjs '' * /'pepjs ' ) .then ( resolve ) .catch ( reject ) ; } ) ; await loadpolyfill ( ) ;
hey guys , so i 'm using router.events to use loading screens on our applications , the problem is per different page we are using skeleton loaders so depending on the page the skeleton loader is different . is there a way to convert the path parameter of route.events i.e routechangestart into basically the router object . i tried getting the router props on the _app but on.routechangestart seems like it 's not updated and still using the previous route it only changes when it ends on.routechangecomplete thanks everyone < code > { path : '/asfas params : { param1 : 'param1 ' , param2 : 'param2 ' , } }
i need the basepath option in production to rewrite all my link , route , generated urls in pages and components . but the root index page should remain as it is ( as i am hosting a running next.js application on a subpath via nginx reverse proxy ) . the following next.config.js throws the error `` invalid rewrite found '' : < code > module.exports = { basepath : process.env.node_env === `` production '' ? `` /test '' : `` '' , assetprefix : process.env.node_env === `` production '' ? `` /test/ '' : `` '' , async rewrites ( ) { if ( process.env.node_env === `` production '' ) { return [ { source : `` / '' , destination : `` / '' , basepath : false , // this somehow isnt recognized as an option . } , ] ; } return [ ] ; } , ... }
without using a custom server , is it possible to have a dynamic route that also has a static element in the same segment ? i gave it a try and it did n't seem to work , but i 'm wondering if there 's anything extra i should do . i know i could make the url / [ dynamic ] /and-static but for seo and ux reasons that does n't feel right so i 'm seeing what my options are . thanks ! < code >
hello next community im facing problem with query = undefined when i get it from getinitialprops example : im navigate to new-post ? id=create = > query : { id : `` create '' } after i refresh the new-post ? id=create = > query : { id : undefined } i hope anyone can explain and help me to resolve . thank you ! < code >
hello , i 'm currently working on a nextjs project in which we use apollo client to retrieve data from contentful cms by graphql queries for static html generation purpose . i have over 800 contents on contentful and there are some repeated field ( such as header or footer ) over these 800 contents . the issue is : the time for next build and export for generating html from 800 contents on contentful is taking around 2 hours . so i 'm trying to reduce this build time . what i have already done : use of apollo inmemorycache as follow : const client = new apolloclient ( { ssrmode : true , cache : new inmemorycache ( { resultcaching : true } ) , link : apollolink.from ( [ authlink , retrylink , httplink ] ) } ) ; use of apollo `` cache-first '' fetchpolicy when executing graphql query : const result = await client.query ( { query , fetchpolicy : 'cache-first ' , variables , context : { shared : isshared , preview } } ) ; i also tried to use files to store the graphql results and use this file instead of sending a graphql when the result is available inside the file . but with all these things i could get only an improvement of 10 minutes in terms of nextjs static generation time do you have any idea on how i can improve this build time ? thanks < code >
i 'm currently using next.js to generate a static site . i 'm building it into multiple languages by setting process.env like lang=en_us next build for the english version or lang=fr_fr next build for the french version . i have some pages in pages/ folder only designed for the us audiences and some other pages only made for france audiences . i want to exclude france 's specific pages when building the us version , and vice versa . please advise if it 's possible to achieve it . ideally , i hope there 's something i can set in config.next.js so that i can decide which pages should be excluded base on the process.env value , but i did n't find such an option exists . thanks ! < code >
bug report describe the bug platform.js json.stringify then json.parse ( deep clone ) .default property but that property is undefined . this only happens in dev but not in production ( deployed on vercel ) to reproduce steps to reproduce the behavior , please provide code snippets or a repository : i am not sure if there is an issue with my setup but it 's just a simple page , called flow.tsx expected behavior no platform.js error and my page shows screenshots look at the top right , shows undefined if applicable , add screenshots to help explain your problem . system information os : macos browser : chrome latest version of next.js : 9.4.2 version of node.js : 12.16.0 additional context here is my package.json : < url > my next.config.js : and my tsconfig.json : < url > add any other context about the problem here . i can load the index.tsx file just fine without the platform.js error , only flow.tsx page is causing an issue and it just returns an < h3 > flow page < /h3 > < code > const withworkers = require ( ' @ zeit/next-workers ' ) // todo : use externals to minimize the size of the bundle : < url > module.exports = withworkers ( { / * config options here * / } )
middleware in express in nextjs in next js we could do something like this or is there any way to achieve functionality like express . < code > app.get ( '/ ' , [ middleware.requireauthentication , middleware.logger , ...... ] , function ( req , res ) { res.send ( 'hello ! ' ) ; } ) ; async function handler ( req , res ) { // run the middleware await runmiddleware ( req , res , cors ) // rest of the api logic res.json ( { message : 'hello everyone ! ' } ) } export default withfoo ( handler )
after working through the awesome nextjs tutorial ( i do n't think i 've ever seen a better tech tutorial ) , i 'm enamored . but is nextjs overkill for my needs ? i need a site for a user manual for my react-native app , and i do n't need server side rendering . i was initially attracted to nextjs because i thought i might be able to port parts my current site , which have a lot of interactive client-side react code . but after thinking about it more , i 'm inclined to put that stuff out of its misery and just start over with a completely static site . should i be looking at jekyll instead ? also , i totally suck at css . are there templates available that can give me a good head start on simple responsive structure for user docs ? < code >
hi . how to be with styles for page . i mean about.module.scss profile.module.scss it be like component in upper first letter ? about.module.scss and how to be with code splitting ? < code > import react from 'react ' import styles from 'features/about/about.module.scss export default function about ( ) { ... }
with an upgrade to 9.5.4 , this broke our application . we have an index.js and [ ... slug ] .js at the root and then within a folder we have a optional catch all [ [ ... slug ] ] .js . we also have basepath set and utilize ssg with fallback=true . is having the [ ... slug ] .js a bad practice and frowned upon ? the problem is really if our application runs as part of a larger site , so we are using basepath . but when we do this , we have _app.js , _error.js , 404.js , index.js all at the same path of [ ... slug ] .js . this causes issues in 9.5.4 because when we do something like the following : /blogs - > index.js /blogs/a - > [ ... slug ] .js /blogs/b - > [ ... slug ] .js /blogs/search - > search/ [ [ ... slug ] ] .js when we have something like /blogs/search ? a it routes to our optional catch all in the search directory and when this is done processing , it then gets processed by our [ ... slug ] .js at the root and breaks the page . trying to understand best practice around catch all at root with the other files that exist at root . < code >
hello next.js people , i have next project where i call api and then i export it to static html . all works fine ! but i want in that export html to have some ajax call ( maybe jquery or plain js ) , how to do this ? < code >
hello , i 'm trying to resolve a specific requirement for our web app . we have a page 'item ' that in case of an item sold out should keep showing item but the page 's response code must be set to 404. i 'm trying something like that : in pages/ [ id ] /item.tsx : but it will automatically redirect to the homepage with status code 302. how to achieve this behavior ? < code > static async getinitialprops ( ctx ) { //retrieve item if ( item.issoldout ) { ctx.res.statuscode = 404 ; } //all other stuff }
is it possible to optimize the static html output by adding some config in webpack ? i want to minify the classname of my app with posthtml-minify-classnames ( if there is a better way of minifying it in js , that will be better ) < code >
hi everyone 👋 i 'm building a nextjs app around the cms umbraco . currently our setup is as follows : _app.tsx - fetches navigation and global metadata through getinitialprops [ ... index.tsx ] - catches the url slug and fetches layout data for the current page through getserversideprops using i expected navigating between pages would only invoke the new pages getserversideprops , but it seems that if the page navigated to has a getserversideprops function _app.tsx'es getinitialprops ( ) s function is invoked before hand as well . reading through earlier discussions a lot of people suggest going for a static approach , but it 's unfortunately not a viable option for us at the moment . here 's a mini example < url > if this is intended or neccessary , what do guys do to speed up your headless cms implementations ? < code >
hey on our landing page ( with a lot of traffic ! ) getstaticprops makes a few calls to mongodb atlas so it takes a few seconds to complete and it is quite heavy on the server . we do n't make a lot of changes to the page content , but it is very handy to have incremental static regeneration , as rebuilding and deploying the whole project just to update a few small changes in the db is annoying , and takes a long time ( more than 1500 pages ) , so i set it up with reavalidate:600 . ( also tried other numbers ) but then i see in the server logs that the calls are being made every few seconds , sometimes more than once a second . this take up huge bandwidth on my server and i had to remove the isr , sadly .. i guess it has something to do with the amount of traffic , but i really dont know .. ( this also happen on other pages ) btw : nextjs 9.5.3 , deployed on vercel thanks ! < code >
i 'm running this authentication hoc but unfortunately i am unable to check any of the console.logs within netlify , i am only able to check them at build time in the deploy logs . however , the user i 'm trying to query using apollo client obviously returns null because there 's nobody logged in at build time . any help finding out how i can see the netlify logs for getinitialprops would be appreciated . < code > import react , { component } from `` react '' ; import { current_user_query } from `` ./user/user '' ; const isloggedin = ( c ) = > { return class higher extends component { static async getinitialprops ( ctx ) { const res = await ctx.apolloclient.query ( { query : current_user_query , } ) ; console.log ( ctx.res ) console.log ( res.data.user ) if ( ctx.req & & res.data.user ) { console.log ( `` working ! ! ! '' ) ctx.res.writehead ( 302 , { location : res.data.user.permissions.includes ( `` admin '' ) ? `` /admin '' : `` / '' , } ) ; ctx.res.end ( ) ; return { user : res.data.user } ; } let pageprops = c.getinitialprops & & await c.getinitialprops ( ctx ) ; return { ... pageprops , } ; } render ( ) { return < c { ... this.props } / > ; } } } ; export default isloggedin ;
is there a way to separate babel compilation targets to specify both browsers and node.js versions for client-side and server-side transpiling , respectively ? it does not seem to be taken into account with the following preset-env typical object : < code > `` preset-env '' : { debug : true , modules : false , usebuiltins : false , targets : { node : 'current ' , browsers : [ 'last 3 chrome versions ' , 'last 3 safari versions ' , 'last 3 ios versions ' , ] } }
greetings , some time ago there was a tutorial in the next.js page that made an app fetching some batman api which i find really simple and straightforward , is this tutorial still available ? < code >
i use a lot vscode and markdown to write-down notes a better system to add files from markdown docs it would be great as i speak vscode 1.50 has just this i have to wait and then i have to click ... and click at the dialogue saying the file does not exist ... can we make it faster ... link create a new file after n seconds the markdown links snippet is added < code > here phofhyperlink
hi , i need help , urgently . i have a client that wants to increase the number of products that are displayed per page in woocommerce . i have looked at the code and modified parts of it , but i have not found the key . please help ! ! ! ' optimizar wordpress keyword long tail posicionamiento web madrid < code >
e.g you have a route that is /movie ? sorted=top_rated 1. is there any way that getstaticprops can access the sorted query for fetching the movie 's sorted or 2. just implement userouter hook in the component then use the useeffect hook and fetched the data i 've been thinking when i use the 2nd method the next.js wont statically prerendered the data < code >
i 'm building a multi-language app where the language is globally provided via languageprovider : all pages are located inside [ lang ] folder like this : what i want to do is to statically generate these pages using getstaticpaths , and here what i 've tried for index.js page : resetting the language provider 's value inside indexpage is what worried me . will the language value update and the pages gets statically generated fine ? < code > // _app.js function myapp ( { component , pageprops } ) { return ( < languageprovider > < component { ... pageprops } / > < /languageprovider > ) ; } pages -- [ lang ] -- -- index.js -- -- about.js // pages/ [ lang ] /index.js export const getstaticpaths = async ( ) = > { const languages = [ `` ar '' , `` en '' ] ; const paths = languages.map ( ( lang ) = > ( { params : { lang } , } ) ) ; return { paths , fallback : false } ; } ; export async function getstaticprops ( { params } ) { return { props : { lang : params.lang , } , } ; } const indexpage = ( { lang } ) = > { const { setlanguage } = usecontext ( languagecontext ) ; setlanguage ( lang ) ; return ( // ... ) ; } ;
bug report all my pages are ssr . when i click on the browser back button , the styles get messed up . this is happening in chrome only . i have tried safari and firefox . both work fine . describe the bug when i click the back button on the browser , the page style is not correct . the css file loads fine . to reproduce chrome version 86.0.4240.75 ( macos ) go to ' < url > click on 'join now ' go back using chrome back button . see error * * * sometimes there is no issue . but most of the time there is . expected behavior page should be rendered as usual . screenshots system information os : [ e.g . macos ] browser : chrome version of next.js : 9.5.5 version of node.js : 12.18.4 additional context does not happen in dev mode . happens only in production . < code >
i would like to render the html of the component on the server-side , that will be loaded on the client only when it comes to the viewport . the idea is generally to render the html on ssr and import the component 's code only when visible using intersection observer . is it somehow possible to configure dynamic ( ) method options not to include js of ssr 's loaded component ? < code > if ( process.browser ) { // render if visible on the client if ( isvisible ) { return < buttonlazy / > } } // render as default on the server - but do n't include js in a bundle return < buttonlazy / >
if i change a page in an existing site to use getstaticprops , the page works in next dev but 404 's in next build . the page can be as simple as : i can see the respective html , js & json files with appropriate content ( from a cursory inspection ) in .next/server/json/ , so it seems like a routing issue in build . any pointers as to where i should look next ? thanks . < code > import react from 'react ' ; export async function getstaticprops ( ) { return { props : { } } ; } export default function page ( ) { return < div > hello , world ! < /div > ; } `` next '' : `` ^9.5.0 '' ,
bug report describe the bug i 've got a complex component using useform ( ) ( from react-hook-form ) . note that this component does have child components that update the state too . works well , including in prod . however fast refresh is messing up the state . after fast refresh , ( most ) fields are not available when handlesubmit ( ) is called . to reproduce happy to try to repro is useful - however , it 's a complex component and i 'd rather save the time if it 's a known issue or a feature . expected behavior internal state of the form should remain the same . screenshots n/a system information os : macos browser ( if applies ) ; chrome version of next.js : 9.5.5 version of node.js : 14.4 additional context could be related to # 13268 and being able to simply disable fast refresh would be welcome . < code >
one thing i 've never been able to get working is the instagram-style `` clicking a link opens a modal , hitting refresh shows a full page '' routing behavior when working with dynamic routes . here 's an example of a link from a demo project i was hacking on to try and get this working : here 's a live demo : < url > notice that clicking an album cover goes to a new page instead of doing a shallow navigation ( which should open a modal ) ? here 's a direct link that includes the showalbum query param , so you can see what should be happening : < url > ... and here 's the source on github for anyone interested : < url > is there any way to make this actually work with dynamic routes ? < code > < link href= { '/artists/ < cur > { artist.id } / ? showalbum= < cur > { album.id } ' } as= { '/albums/ < cur > { album.id } ' } scroll= { false } shallow >
i am totally stuck on trying to understand a part of next.js related to the params and router.query . when i run the post example from < url > and print out the router.query object with console.log ( query < cur > { json.stringify ( router.query ) } ) ; , i can see the route parameter and all query parameters in the browser console . when i am working in a ssg with fallback=true , and i do the same thing , but print out the params object in getstaticprops with console.log ( getstaticprops - enter < cur > { json.stringify ( params ) } ) ; , during runtime when i hit a post that was generated during build time .... all i see printed in the output is the url/route parameter ... no query parameters are printed in the array . why the different behavior , what i am i missing ? how do you access query parameters from within getstaticprops ? < code >
export async function getserversideprops ( { params } ) { const res = await axios.get ( < cur > { url } /api/categories ? slug= < cur > { params.id } ) const data = await res.data.data ; console.log ( data ) // pass data to the page via props return { props : { data } } ; } how can i redirect to my 404.js page in this async function ? @ timneutkens < code >
hi . i have a case when i need to get some data for runtime when starting a production build using the fs module . now it i do n't like that you need to import the config like this my suggestion < code > const app = next ( { dev , conf : ( config ) = > { // do something with existing next.config return config } } ) import conf from ' .. / .. /next.config ' ; const runtimevars = // do something with fs conf.publicruntimeconfig = runtimevars const app = next ( { dev , conf } ) ;
feature request is your feature request related to a problem ? please describe . when setting aria-current on navlinks it is helpful to get everything necessary for the matching function from userouter . for dynamic routes , userouter currently returns the route ( name of the file in pages folder ) , a query object , and aspath which includes pathname+query+hash . however , the resolved pathname of the current route is not directly available from userouter . describe the solution you 'd like userouter should return an additional property ( named resolvedpathname or similar ) . for example on a /posts/ [ id ] route , when navigating to /posts/one ? category=new , userouter would then return : describe alternatives you 've considered use new url ( router.aspath ) .pathname or window.location.pathname < code > { `` pathname '' : `` /posts/ [ id ] '' , `` route '' : `` /posts/ [ id ] '' , `` query '' : { `` id '' : `` one '' , `` category '' : `` new '' } , `` aspath '' : `` /posts/one ? category=new '' , `` resolvedpathname '' : `` /posts/one '' // this would be added }
using css modules , pages are incredibly ugly for a second before the css modules are sent down to the client . i really , really , really do n't want to use styled jsx anymore , or create global css files for that matter . nowhere in the docs does it say that css modules are second-rate in this fashion . there should be a huge disclaimer . honestly they should n't even have been included when they 're clearly not ready for production . < code >
i have some .mjs files that are imported in my next project and required in various utility scripts . this has worked fine for some time . but recently , they do not seem to be included in the dev version of the application . npm run dev runs the app , but in the console i get things like : what 's extra weird is that if i run the production version with npm run start , everything works fine . i can repro on node 12 and 14 and on two different machines . next is at version 9.4.1. i see # 9607 , but that seems like a different issue ? i also see experiments.mjs in webpack 5 ... but we 're not on 5 yet right ? < code > error was not caught referenceerror : module is not defined at eval ( webpack-internal : ///./utils/constants.mjs:35 ) at module .. /utils/constants.mjs ( _app.js:2765 ) at __webpack_require__ ( webpack.js ? ts=1589750690485:863 ) at fn ( webpack.js ? ts=1589750690485:151 ) at module.eval ( webpack-internal : ///./components/layout.jsx:10 ) at eval ( webpack-internal : ///./components/layout.jsx:269 ) at module .. /components/layout.jsx ( _app.js:46 ) at __webpack_require__ ( webpack.js ? ts=1589750690485:863 ) at fn ( webpack.js ? ts=1589750690485:151 ) at module.eval ( webpack-internal : ///./pages/_app.jsx:8 ) at eval ( webpack-internal : ///./pages/_app.jsx:94 ) at module .. /pages/_app.jsx ( _app.js:2742 ) // use utils/constants.mjs in layout.jsx import { base_href , dev } from `` .. /utils/constants '' ;
ok , i have no idea what 's going on here . i 'm on nextjs version 9.1.5 and this still happens on 9.5.5. my node version is 12.19.0 my code that is running just fine in production wo n't run locally after i got a new macbook pro this year . my app is using server side rendering . i used to get this navigator is not defined error during ssr , but the app would still load just fine . now i 'm getting this error from reactdevoverlay and i have no idea how to resolve it . has anyone else ran into this ? < code > [ pm:0 ] 16:31:01.024 error critical_error : router referenceerror : navigator is not defined at /users/lwdthe1/documents/programming/myapp/node_modules/react-dom/cjs/react-dom.development.js:24989:5 at object. < anonymous > ( /users/lwdthe1/documents/programming/myapp/node_modules/react-dom/cjs/react-dom.development.js:25011:5 ) at module._compile ( internal/modules/cjs/loader.js:1015:30 ) at object.module._extensions .. js ( internal/modules/cjs/loader.js:1035:10 ) at module.load ( internal/modules/cjs/loader.js:879:32 ) at function.module._load ( internal/modules/cjs/loader.js:724:14 ) at module.require ( internal/modules/cjs/loader.js:903:19 ) at module.hook._require.module.require ( /users/lwdthe1/documents/programming/myapp/node_modules/require-in-the-middle/index.js:80:39 ) at require ( internal/modules/cjs/helpers.js:74:18 ) at object. < anonymous > ( /users/lwdthe1/documents/programming/myapp/node_modules/react-dom/index.js:37:20 ) at module._compile ( internal/modules/cjs/loader.js:1015:30 ) at object.module._extensions .. js ( internal/modules/cjs/loader.js:1035:10 ) at module.load ( internal/modules/cjs/loader.js:879:32 ) at function.module._load ( internal/modules/cjs/loader.js:724:14 ) at module.require ( internal/modules/cjs/loader.js:903:19 ) at module.hook._require.module.require ( /users/lwdthe1/documents/programming/myapp/node_modules/require-in-the-middle/index.js:80:39 ) at require ( internal/modules/cjs/helpers.js:74:18 ) at object. < anonymous > ( /users/lwdthe1/documents/programming/myapp/node_modules/ @ next/react-dev-overlay/lib/internal/components/shadowportal.js:27:19 ) at module._compile ( internal/modules/cjs/loader.js:1015:30 ) at object.module._extensions .. js ( internal/modules/cjs/loader.js:1035:10 ) at module.load ( internal/modules/cjs/loader.js:879:32 ) at function.module._load ( internal/modules/cjs/loader.js:724:14 ) at module.require ( internal/modules/cjs/loader.js:903:19 ) at module.hook._require.module.require ( /users/lwdthe1/documents/programming/myapp/node_modules/require-in-the-middle/index.js:80:39 ) at require ( internal/modules/cjs/helpers.js:74:18 ) at object. < anonymous > ( /users/lwdthe1/documents/programming/myapp/node_modules/ @ next/react-dev-overlay/lib/internal/reactdevoverlay.js:43:22 ) at module._compile ( internal/modules/cjs/loader.js:1015:30 ) at object.module._extensions .. js ( internal/modules/cjs/loader.js:1035:10 )
i have a repo , which is a wrapper-ui built around chakra-ui < url > my main project , uses nextjs , and every time i try to import this repo it trows error saying i have multiple react projects . what i ca n't understand i created two examples folder to test . one import with webpack alone , and another with nextjs ssr , and turns out that only the nextjs version wont work ... i think may related with some kind of the ssr part but i 've already tried several options and none of they work . the repo i 've linked have both examples . thechakra-ui it 's fully compatible with nextjs used alone , without this wrapper i just created . it seems that i need to override alias been used by the node/webpack of nextjs but i 've already implemented the alias rules inside next , but none of they work as i expected . < code >
i ca n't seem to figure out how to `` stream '' data back to the client from an api route . in its basic form i 'd like to just do res.json ( ) multiple times . any tips ? in this exact example it 's progress of a file upload and then progress of the processing of that same file . < code >
i have a next.js application where i am fetching data from an external server api . i have a bunch of radio buttons as a filter . basically i want to add a query param in the url based on the radio button selection in the url and re render the component such that the api has the query params selected and the api call is hit again . eg : 'baseurl ' fetches inital data . after the radio button selection , the api 'baseurl ? queryparametre ' is called and a filtered result is returned again . as i keep on selecting radio buttons of another group , i would like to add those to the url as query params as well , which re calls the api . i would like to know a detailed approach to this as i am fairly new to ssr with react . any help would be appreciated . p.s . due to privacy concerns , i can not share the code base here . i would appreciate any guidance . < code >
described here make sure google can crawl and index your pages and here verifying googlebot are the recommended ways of allowing googlebot to index the paywalled content of a page . some of our page content ( like section headings and a short summary ) is available publicly , so this is fetched in a getstaticprops function , with a revalidate set . on the other hand , some of the content is only available to subscribed/authenticated users through a paywall , and fetched client-side after user authentication . we would like to let googlebot index that content as well though . with ssr , we could check the incoming ip and user-agent to verify the requester , and let the bot load the whole page as if it was an authenticated user , but this can not be done safely on client-side . is there any way to check the user-agent/ip in getstaticpaths and return different data to the client based on that ? < code >
how you handle fetching another data without going to another route fetch another data but prerendered e.g < code > import react , { usestate } from 'react ' ; export default function home ( props ) { const [ state , dispatch ] = usestate ( props.data ) ; const onuser3 = ( ) = > { // fetch another data e.g * * users/3 * * // dispatch something // update the state or * * is it possible to update the getstaticprops method * * } return ( < div > < h1 > { state.name } < /h1 > < button onclick= { onuser3 } > click < /button > < /div > ) ; } export async function getstaticprops ( ) { const res = await fetch ( 'https : // ...... /users/2 ' ) ; const data = await res.json ( ) ; return { props : { data } } ; }
in my new application i am using react and nextjs . the application has a list containing items that are highlighted when the page is active . when you click on an item in this list , you are taken to another page . looking into the profiler , i noticed that all the list items were redrawn , although only 2 needed to be redrawn redrawn starts in this component full code here why is this happening and how to avoid it ? < code > export const sidebarorganizationslistitemlink : react.fc < sidebarorganizationslistitemlinkprops > = ( props ) = > { const { classname : classnameprop , data : { organization } , ... restprops } = props ; const classes = usestyles ( ) const router = userouter ( ) const active = react.usememo ( ( ) = > { const { organizationid } = router.query return organizationid === organization.id } , [ router , organization.id ] ) const classname : string = react.usememo ( ( ) = > { return clsx ( classes.root , { [ classes.active ] : active } , classnameprop ) } , [ classes , classnameprop , active ] ) return ( < buttonlink { ... restprops } classname= { classname } > < badge color= '' secondary '' overlap= '' circle '' badgecontent= { organization.badgecontent } > < avatar classname= { classes.avatar } > { organization.alt } < /avatar > < /badge > < /buttonlink > ) }
greetings let 's say i have a list of popular topics to be display on my landing page from api , which will be updated every few days . in this scenario , client side fetching or getstaticprops ( with revalidate ) is more doable ? my main concern on the selection would be performance and seo friendly , does choosing any of them makes any difference ? i am also worrying that choosing the incremental static generation approach might be overkill for the application . < code >
hey there ! i am new to the community and plan on contributing more often . in the meantime , i have a quick question . i am happy with nextjs page navigation but i want to implement a custom contact form and was reading this article which uses express . my question : can i use express in addition to the nextjs built-in navigation that it uses to navigate between pages ? if i use express will it interfere with nextjs page navigation ? * * * * goal my goal is to use express to work with mongodb ( get , post data etc ... ) but i am wondering if that would interfere with nextjs pages navigation ( which uses the files in the pages directory ) . < code >
hello i 'm trying to implement a whole url path for the social media share i 'm currently using react-share but i got problem with the share url the only result is /pathname/ [ id ] any tips or suggestions how i can implement this the easy way i know is window.location.pathname thanks a lot < code > const { basepath } = userouter ( ) const router = userouter ( ) ; const shareurl = basepath + router.pathname < facebooksharebutton url= { shareurl } > < facebookicon size= { 32 } round / > < /facebooksharebutton >
is it possible to change the directory name for static html generation in next.js ? i have checked the documentation , but i can not find what i need . < code >
i 'm using the swf-loader webpack module on nextjs however , it appears that the webpack is not creating the folder in the public folder but it is creating in the .next folder next.config.js : i have 404 not found error in this url : < url > it seems that the folder was not created , however in .next folder : and inside the bundle folder : but i need to access this folder publicly . and i think it was to have created in the public folder too system information version of next.js : [ 9.5.3 ] version of node.js : [ 12.18.4 ] < code > module.exports = ( nextconfig = { } ) = > { return object.assign ( { } , nextconfig , { webpack ( config , options ) { const { isserver } = options ; if ( ! options.defaultloaders ) { throw new error ( `` this plugin is not compatible with next.js versions below 5.0.0 < url > ) ; } const prefix = nextconfig.assetprefix || `` '' ; config.module.rules.push ( { test : /\.swf < cur > / , use : [ { loader : require.resolve ( `` swf-loader '' ) } , ] , } ) ; if ( typeof nextconfig.webpack === `` function '' ) { return nextconfig.webpack ( config , options ) ; } return config ; } , } ) ; } ;
i am using a context api in the _app.js and passing in a jwt token in all my pages in the application . the problem is that the state persists whenever i am using client side navigation from the application . but when i do a refresh manually from the browser , the context api prop becomes null . how to make sure that the state persists even when i am doing a browser side refresh ? < code >
feature request is your feature request related to a problem ? please describe . i would like the ability to animate between pages , with either css transitions or with hooks for js to use . describe the solution you 'd like basically what nuxt does : < url > describe alternatives you 've considered there is third party solution ( < url > ) but this only works with css and risks falling behind any changes to the next.js core . additional context i feel like animated page transitions is a basic feature of modern web development and deserves to be included in the core . < code >
i just read this excellent guide on migrating from gatsby . there is one gatsby feature i heavily rely on : component shadowing with a plugin approach . basically you can install plugins , that overwrite/shadow parts of the code which makes it super easy to extend and contribute to existing projects without touching the original code base . i have n't seen anything on next.js which could be used for component shadowing - but maybe there is a clever way to do this in next.js as well ? if so , let me know ! < code >
i 'm using the contentful extensions sdk which is initialized by calling an event listener for window.message . this works fine when i run next build but when running node_env=development next the event never fires on the local dev server . i did n't have this problem in older versions of next . currently i 'm running 9.5.3 < url > < code > const dynamicpagemetaextension = async ( ) : promise < react.fc > = > { const { default : pagemetainputuiextensionlazy , } : { default : react.fc ; } = await import ( 'extensions/field/pagemetainput ' ) ; const { init } = await import ( / * webpackchunkname : `` contentfuluiextensionssdk '' * / 'contentful-ui-extensions-sdk ' ) ; const sdk = await new promise ( ( res ) = > init ( res ) ) ; // this promise never resolves in dev mode ! ! ! ! return ( ) : reactelement = > ( < contentfuluiextensionscontext.provider value= { { sdk : sdk as fieldextensionsdk } } > < pagemetainputuiextensionlazy / > < /contentfuluiextensionscontext.provider > ) ; } ; const dynamicpagemetaextensionwithnossr = dynamic ( dynamicpagemetaextension , { loading : ( ) = > null , ssr : false , } ) ; const pagemetainput = ( ) : reactelement = > < dynamicpagemetaextensionwithnossr / > ; export default pagemetainput ; export async function getserversideprops ( ) : promise < { props : { theme : string } } > { return { props : { theme : gettheme ( { initialstate : { } , pageflags : { noindex : true , isuiextension : true , suppressssr : true , } , params : { slug : undefined , } , } ) , } , } ; }
i have my /blogs page and /blogs/ [ slug ] page server side rendered . i want to display my latest blogs on to my homepage statically . i want to keep my home page static . how to go about it ? this is /blogs ( ssr ) this is /blogs/ [ slug ] ( ssr ) < code > singleblog.getinitialprops = async ( { query } ) = > { const res = await singleblog ( query.slug ) ; if ( res.error ) { console.log ( res.error ) ; } else { console.log ( `` get initial props '' , res ) ; return { blog : res , query } ; } } ; export default singleblog ; blogs.getinitialprops = async ( ) = > { let skip = 0 ; let limit = 4 ; const res = await listblogswithcategoriesandtags ( skip , limit ) ; if ( res.error ) { console.log ( res.error ) ; } else { return { blogs : res.blogs , categories : res.categories , tags : res.tags , totalblogs : res.size , blogslimit : limit , blogskip : skip , } ; } } ; export default withrouter ( blogs ) ;
i am trying to migrate to nextjs- from my already working enterprise-level application ( custom webpack build + express ) . the problem here is - a single page of mine ( lets call it /about ) is pretty big enough - takes around 10mins for it to be built ( along with the async chunks ) . now if while doing ssr , there 's an error in rendering the /about page - i would go and fix the code . after this , whereas it should re-build only the portion that 's changed , nextjs seems to be building the whole page again ! ( takes around > 10 mins ) . has anyone faced a similar problem before / any insights here ? i have a custom webpack config here - but that 's not a problem . what i observed : if the code is less within a single page - > it seems to rebuild v fast and only the portion that i change . if the code is large enough - > it just gives up and seems to re-build the whole page . < code >
hello , our app is being served with the basepath config set to /app and the following nginx proxy config : this works perfectly with a similiar app we serve in the same way but on next 9.4. with 9.5 , we get a 404 on all network requests : what could be the issue ? < code > location /app { proxy_pass phofurl }
problem next.js builds use webpack `` external '' for nodejs dependencies in my server bundles , but given that i am building from a monorepo , i do not want to include my full node_modules discussion does anyone have a nice recipe for the webpack server build process to bundle my nodejs dependencies into .next/ such that the build output is truly standalone , and does not depend on any node_modules directories ? i see that some people use pkg , however , i 'd like to be able to still a clear , clean node process , rather than a fancy binary . in this fashion , i still get good node ergonomics ( optional sourcemaps , ability to enter a debug session remotely , etc ) . < code >
in my app i have images that are coming from a 3rd party ( contentful ) . so i load them through an url . all the bulk of the optimisation is made client side through the 3rd party api . now on the server side , i would like to include an inline , low-quality version of image which is used as a placeholder while the client is fetching the actual image . this is a common pattern nowdays . i have a pretty good idea of what i should do to achieve that : fetch the image from the url use sharp to turn it into base64 render an img with inlined base64 now all this operation is async , and since i want this to occur during server side rendering , i ca n't use any async code ( only getinitialprops at page level ) i know there are packages to optimize images ( next-images ) , but they run at build time . the only 2 solutions i see are : going through my whole data structure from 3rd party ( fetched in getinitialprops ) and everytime i find a url , generate what i need , and during server side rendering , render the generated data instead doing a manual rendering before the real rendering , register my specific effects , wait for them to resolve , and then let nextjs render ( < url > ) the second solution feels more generic to me but i 'm not sure how costly it is to render everything one extra time < code >
i just deployed my nextjs project that i created using create-next-app -- example with-tailwindcss but in the production build tailwind does n't work . how do i go about fixing this ? < code >
i currently have a file structure like so within the 'src ' directory : i would like to keep this file structure and use dynamic routing . for example , the route for 'pagetorenderondynamicroute.js '' will be something like '/page/pagetype/ : pageid/otherslug/ : slug ' . i am aware that i can use the dynamic routing provided by next.js , but i do not want to use the necessary file structure of : i have tried using next-routes , but ran into many issues , including : returned 404 when using getstaticprops or getserversideprops , returned 404 on refresh of page , returned 404 when url typed in manually . does anyone know of a way that i can keep my existing file structure and use dynamic routing ? i am open to any options , including continuing to try next-routes if you are aware of working solutions to the aforementioned issues . i appreciate your help ! < code > | |____page | | |____pagetype | | | |____ [ pageid ] | | | | |____otherslug | | | | | |____ [ slug ] .js |____pages | |____firstpage | | |____first.js | | |____index.js | |____secondpage | | |____second.js | | |____index.js | |____firstdynamicroutepage | | |____pagetorenderondynamicroute.js | | |____index.js
hello , in the footer area . my website has included the json data with the following example . < script id= '' __next_data__ '' type= '' application/json '' > { `` props '' : { `` pageprops '' : { `` originalurl '' : '' '' , '' active_sub '' : '' '' , '' gt_language '' : null , '' post_type '' : '' page '' , '' parent_1 '' : '' '' , '' parent_2 .... can we hide this ? or this is necessary to hide ? used getstaticprops . thanks . < code >
next build currently requires devdependencies to be around for the build when you have typescript enabled , which bloats the container image size when trying to deploy for production with only prod deps . < code >
hi guys , with react-router-dom , our login has link , but it opens on a popup , there is a way to do the same with nextjs ? i need that `` app.com/login '' opens a popup with the form on the screen . thanks so much ! < code >
when building , i often see first load js color in red , despite me doing all kind of code optimization . may i know what are the criterial for the first load js to be shown as green or yellow instead of red ? red color signifies critical , or error , and usually a page of red is not a good sign , which requires actions . so , how are the colors determined ? if it 's purely base on size , showing it in red is definitely not the best idea as different projects are of different sizes . < code >
i 'm having a problem with injecting font on ssr at first time page loads without particular font , which is stored localy in the public folder . browser replaces it with some default font . then my local font is loaded and at that moment user feels like text is jumping . so my question is : is it possible to load page already with needed font . here is my code : fonts file style.ts : file _document : < code > export default ' @ font-face { font-display : swap ; font-weight : normal ; font-family : 'segoe-ui ' ; src : url ( '/fonts/segoe ui/segoe ui.ttf ' ) ; font-style : normal ; } ... ' ; import fonts from 'public/static/fonts/style.ts ' ; ... render ( ) { return ( < head > ... < link rel= '' preload '' href= '' fonts/segoe ui/segoe ui.ttf '' as= '' font '' crossorigin= '' '' / > ... < /head > ) } mydocument.getinitialprops = async ( ctx ) = > { const sheets = new serverstylesheet ( ) ; const originalrenderpage = ctx.renderpage ; try { ctx.renderpage = ( ) = > originalrenderpage ( { enhanceapp : app = > props = > sheets.collectstyles ( < app { ... props } / > , ) , } ) ; const initialprops = await document.getinitialprops ( ctx ) ; return { ... initialprops , styles : ( < > < style dangerouslysetinnerhtml= { { __html : fonts } } / > { initialprops.styles } { sheets.getstyleelement ( ) } < / > ) , } ; } finally { sheets.seal ( ) ; } } ;
hi ! i want to use a module that is being transpiled into es6+ . this brings some some problems with next.js so i thought of circumventing the issue by importing the typescript source code directly from my own typescript code but i am getting this error : is there a way to make this work ? even a hacky temporary solution would make me very happy . this is the only 'decent ' financial charting library that supports/uses typescript . < code > error - ./node_modules/react-financial-charts/src/series/barseries.tsx 17:0 module parse failed : the keyword 'interface ' is reserved ( 17:0 ) you may need an appropriate loader to handle this file type , currently no loaders are configured to process this file . see < url >
how can i add redirects only for paths that do n't resolve to a page - basically i 'm trying to recreate with nextjs 's redirects feature what i currently get after next export with the shadowing behavior of netlify redirects . < code >
hi ! i want to use the rust to webassembly tutorial `` conway 's game of life '' in next . tutorial : < url > i have finished the rust tutorial and i have a working version , but i do n't know how to integrate with next . the rust tutorial make a first version where the game universe is just an array of characters rendered in a < pre > tag . for the animation uses requestanimationframe ( ) . i do n't understand how to use requestanimationframe ( ) inside a component so i tried with hooks but i get error : invalid hook call . hooks can only be called inside of the body of a function component .. it 's possible to use hooks inside the dynamic load of wasm ? any clues is appreciated . < code >
hi i am new to next.js . recently postcss has upgraded to version 8 , and many plugins are now incompatible . how can i check the supported version of postcss in next.js , and downgrade or upgrade my postcss plugin accordingly ? < code >
bug report describe the bug incremental static generation is triggered again after next.js is restarted . to reproduce steps to reproduce the behavior , please provide code snippets or a repository : clone this sample project < url > add a console.log with the tweet id on this line : < url > start the process for the first time with next build and next start trigger the static generation once restart the process without rebuilding make another request with the same tweet id that triggered static generation previously expected behavior static generation should n't be triggered again after restart if static assets are within the revalidate age . system information os : macos version of next.js : 9.5.3 version of node.js : 14.9.0 < code >
hi , i am having issues getting crawlers to register the < meta > tags that i am parsing into the < head > of my nextjs application , both on pages and dynamic pages . i am fetching the wordpress data with getserversideprops on the relevant pages and using yoast plugin on wordpress to handle the seo tags , which gives me an json containing an object that i then parse into html tags to insert into the < head > . those tags are parsed correctly but nothing gets registered by crawlers on production environment , which is linked to a live domain . i have tried to use the getstaticprops with revalidate but got the error : the revalidateproperty is not yet available for general use . to try the experimental implementation , please useunstable_revalidate instead . the site is deployed on vercel and ideally i want the wordpress content to be 'refreshed ' on each page load dynamically as it is likely to change and would want the changes to reflect immediately . not sure what else to try so any suggestions welcome ? < code >
hello . first of all , thank you to everyone working on next.js , you 're doing a great job ! i was wondering if there 's a way to get the server request ( when it 's available - when the requested page is rendered on the server ) . i know that i can get it using getinitialprops , but this will disable automatic static optimization . thank you ! < code >
hello , i 'm using the getstaticprops + revalidate . how can i download the images from the rest api ? my rest is json and it 's uploaded on a different domain . what 's a good way to start ? thanks . < code >
< link href= '' # course '' > < a > < p > course < /p > < /a > < /link > or < a href= '' # course '' > < p > course < /p > < /a > tried both of them but not working .. inside page navigation < code >
hi guys , we need to use localstorage in this project , and we have a context api that get the credentials from the localstorage and put in his shared state , but i need to this process happens only on the clientside , or be postponed ... is there a way to put the useeffect to execute only on the client-side ? is there a way to execute a callback only when the app is on client-side ? thanks so much ! best regards . < code >
bug report describe the bug on an exported site , the routing works via links however the urls in browser do not get suffixed with .html and therefore if someone wishes to share a link , it does not work . to reproduce steps to reproduce the behavior , please provide code snippets or a repository : create next site create /pages/test.js and add basic content . add < link href= '' /test '' > < a > visit test.js < /a > < /link > on index.js next build & & next export deploy /out folder to static website hosting visit url . click visit test.js page loads copy url goto new tab in browser and paste url page not found error ( 404 ) expected behavior either the route in url should be .html or the route when copied should work when shared . system information os : any browser ( if applies ) any version of next.js : canary < code >
bug report describe the bug dynamic api routes ( pages/test/ [ index.js ] ) fails top build when i try to deploy into production builds ( yarn build followed by yarn start ) . it returns an internal server error with the following stack : < url > expected behaviour the build should be successful system information os : macos browser : chrome version of next.js : 9.5.3 version of node.js : v10.16.3 < code > > build error occurred error : build optimization failed : found page without a react component as default export in pages/test
hi all , this is a custom server from official example < url > i changed from to and it is still working . console.log ( ) show no request from client side , which has link > with `` as '' is app.render ( ) the third parameter pathname a redundant design or a bug ? < code > server.get ( '/a ' , ( req , res ) = > { return app.render ( req , res , '/iaisefq9824r ' , req.query ) } ) server.get ( '/a ' , ( req , res ) = > { return app.render ( req , res , '/a ' , req.query ) } )
first i install next-app project this is from an official demo < url > ) second , i install elasticsearch with from < url > without changing a single line , the yarn dev does not run any more . ( ironically , elastic.co is built with next.js ) < code > npm install @ elastic/elasticsearch npx create-next-app -- example custom-server-express custom-server-express-app
i wanted to integrate auth0 along with apollo ' client . i 'm facing difficulties in integrating both of them in my application . handling protected routes graphql queries on the client-side with the authentication token issued from auth0 . i 'm a newbie ! can someone help me , please ? < code >
( basically reposting a twitter question in hope to find some answers and ideas from more senior next developers . ☺️ ) hi next community , i recently had a look at nextjs and was a little bit confused about environment variables . are the limited to test/prod/dev ( with local overrides ) ? what if i have more stages i want to deploy to ? is there something like `` stage configs '' build in ? because the current env vars look more like `` build configs '' ( test builds , production builds , dev builds ) . it does n't look like i can create a prod build and deploy it to different stages with different configs or ? also coming from < url > background i wonder if `` exposing environment variables to the browser '' make it strict necessary to create a build per deployed stage ( instead if creating one build and just change the config per deployable stage ) . background : i created several client-side only react projects were we had dev and production configs/builds , but also stage specific configs . i created a production build once and could deployed to multiple stages without the need to rebuild it . the only difference was a small config.js file which put some global configs on the window object . that file was different for every deployable stage . thank you ❤️ < code >
hi guys , i 'm trying to stop to use the file route in my project , i want to create my own route path , how i can create this ? example : filepath : 'pages/about.tsx ' route : '/sobre ' ps . : i tried to use rewrites but , this does n't work how i think . thanks in advance ! < code >
i am learning to use sequelize with my next.js app.i set up the sequelize , used the cli to generate migrations , created the model ( user ) , and when i try to test it , going to the < url > . i get an error - > can not read property 'findall ' of undefined . my model class is coming up as undefined . anyone has any idea ? * director structure db.js model/user pages/api < code >
i have issue with displaying my team 's website in ie11 . it went fine on other modern browsers tho . this is the warning that came on ie11 console and the line that triggers it that arrow was not transpiled to es5 compatible apparently , and there were 2 other instances in the same file where arrow function was used . i saw some other discussions in here regarding issues with ie11 , the answer i found was apparently it might be caused by some modules in node_modules were not transpiled to es5 properly . now that i found these 3 arrows in commons , but i could n't figure out which modules that led to it . my only hint was the nearest functions where the arrow appears in the file . looks like functions that came from @ material-ui/core library , but im not sure if mui was the culprit for this . so how can i know that error came from which module ? i plan to use next-transpile-modules plugin to transpile to modules that were not transpiled to es5 for ie11 , but based on the error displayed , i have zero clue as to which modules that causing it . i definitely need help on getting this issue out and make the website works in ie11 . < code >
hi , i am trying to use babel-plugin-react-css-module < url > i am trying to use it , it can generate hash class css but no css file load , so the style not work . thank you so much if you can help fix this error : ( < code >
i am trying to use ffmpeg.js with next.js . but i run into an exception because the library depends on process.stdout to exist . i was able to solve a similar problem where the library depended on fs simply by setting the config this way following this suggestion : is there a similar step i can follow to work around the dependency on process.stdout ? < code > module.exports = { webpack : ( config , { isserver } ) = > { // fixes npm packages that depend on 'fs ' module if ( ! isserver ) { config.node = { fs : `` empty '' , } ; } return config ; } , } ;
hey ! i 've got a project with incremental static regeneration . if i locally boot-up next using next start and hit the url < url > the files /.next/server/pages/products/123.html and /.next/server/pages/products/123.json are created and everything feels nice and speedy . if i deploy the very same application on heroku and hit the url < url > login in to my environment using the heroku cli , heroku run bash , cd /.next/server/pages/products/ there are no files created , but it still feels nice and speedy . why is that ? are the files created , but i ca n't see them ? does next use some kind of in-memory store if it does not have file-write-access ? does isr not work out-of-the-box on heroku , but my server is fast enough anyway . should i use vercel to get the most out of next ? thanks in advance , jan < code >
bug report describe the bug the new toast introduced in v9.4 seems intrusive and does n't hide which makes it difficult to see the background when simulating the mobile viewport in chrome to reproduce you should have an error in the console simulate responsive viewport in chrome expected behavior it should be closable or not show at all screenshots system information os : macos browser ( if applies ) : chrome version of next.js : 9.4.0 version of node.js : 12.11.1 additional context add any other context about the problem here . < code >
i am looking for a way to code obfuscated all js files that generated for a better security i was looking in doc but nothing mentioned if this is possible do anyone have any idea to do this ? < code >
e.g : you have a dynamic page the fetched the user id depends on the query id from 1 to 10. what if the user will fetched the id # 11 how could i redirect them to 404 page ? code : < code > const user = ( { data } ) = > { const { id , name , email , address } = data ; return ( < div > < card id= { id } name= { name } email= { email } address= { address } / > < /div > ) ; } ; export async function getserversideprops ( ctx ) { const res = await fetch ( ' < url > } ' ) ; const data = await res.json ( ) ; return { props : { data , } , } ; }
hi there , i 'm building a nextjs app with graphql-yoga / prisma backend and apollo-client / nextjs frontend . for some reason in my index.js file in the backend i am able to log the user / cookie token in local development environment , but not when it 's in production . anyone ever experienced a similar issue and if so , what resolved it ? the function that logs the user once i log in is in the index.js server setup file and works in local environment but not in prod . any help would be greatly appreciated ! < code > server.express.use ( ( req , res , next ) = > { const { token } = req.cookies ; console.log ( token ) ; if ( token ) { const { userid } = jwt.verify ( token , process.env.app_secret ) ; console.log ( userid ) ; req.userid = userid ; } next ( ) ; } ) ;
feature request is your feature request related to a problem ? please describe . i wish it would show me exactly where in my code i was going wrong instead of where the error message was thrown . specifically , if you have the code the error message it gives you is that error does n't tell me where the link that 's missing the href property is . contrast that to the redbox error from create-react-app that shows me exactly where the error is , and i can immediately edit it . describe the solution you 'd like it seems like typescript compilation errors are not being output to the error box , and it would be nice if these errors were included . describe alternatives you 've considered create-react-app , checking vscode `` problems '' box , but this only works on the files you have open , so does n't really help if you do n't know the file where the error is < code > import head from 'next/head ' import styles from ' .. /styles/home.module.css ' import link from 'next/link ' export default function home ( ) { return ( < div classname= { styles.container } > < link to= '' /hello '' > my link < /link > < /div > ) }
hello friends ✌️ i 'm a designer & front end developer currently researching how developers build user-facing applications . this is for a project that would be compatible with the nextjs framework . details i 'll pay you < cur > 50 for 1 hour of your time in that hour i 'll run through a standard research interview your identity is kept anonymous ( in case that 's important for you ) similarly , your answers are kept with me and do n't go anywhere . if you 're open to participating , please complete this tiny screener : < url > it 's just 6 simple questions that 'll take you 2 minutes to complete and helps give me some context on your dev experience . mods if this is n't ' the right place to post this , can you please let me know where would be better ? i always want to respect the community guidelines ❤️ < code >
bug report describe the bug next.js does not allow anything besides paths starting with slash as basepath . to reproduce when next.config.js is as follows : then on build you get an error : expected behavior dot as basepath is perfectly legit since files can be taken from where index.html was loaded in cases when no navigation is used . i am using next.js to build an app for electron , and there the app would be served with file : // protocol . and the problem is that final location of app is not quite determined ... i can get around this by string replacing the path directly in the out directory inside the electron app , but that 's nasty ... system information os : macos version of next.js : 9.5.3 version of node.js : 14.4.0 < code > module.exports = { basepath : './ ' , } ; > build error occurred error : specified basepath has to start with a / , found `` ./ ''
it seems we ca n't rewrite homepage `` / '' : work : not work : < code > { async rewrites ( ) { return [ { source : '/ ' , destination : '/schedule/2020/fall ' , } , ] } } { async rewrites ( ) { return [ { source : '/about ' , destination : '/schedule/2020/fall ' , } , ] } }
hey everyone , i have some data layer code that uses the global xmlhttprequest object to do the queries , and i need to use this code on the server side with getstaticprops . i tried using the xmlhttprequest package and included some code like this on the next.config.js : when starting the dev server , the app does n't crash anymore regarding a missing xmlhttprequest constructor , but it also does n't resolve the request and hangs in loading localhost:3000 indefinitely . does anyone know how to polyfill this the right way ? < code > const xhr = require ( `` xmlhttprequest '' ) ; global.xmlhttprequest = xhr.xmlhttprequest ;
hi all , currently my app is using ssr where all the data is fetched in nodejs . i am trying to improve the first paint and first contentful paint especially on low bandwidth network as the whole page needs to be built . i understand that ssr is when the server has to prepare the html before sending it to the user . however , i was wondering if it is possible to render in chunks when the data is ready . i read about stream ssr with rendertonodestream but as far as i understand , nextjs does n't support it . all help is appreciated . < code >
i 'm making a component library that will be consumed in a next.js project . i would like to add features of next.js into my components . will simply adding next.js as a dev dependency in the component library be enough ? < code >
hello , i 'm considering moving my project over to next.js ( with preact ) and had some concerns . we are an e-commerce platform on nuxt.js and after some time of maintaining it , i am now firmly opposed to using client-side routing in most instances . i want to : use preact as the main framework remove next.js router and link maintain server-side routing for the most part use preact router for certain dynamic pages is this doable ? are there pros and cons to this approach ? < code >
issue describe the bug i 'm using custom-server-typescript example on one of my applications . on that application i was using youtube-captions-scraper library . since this library does n't have its own type module , vscode code editor was showing an error and the compiling was failing . so i 've declared own module type in the next-env.d.ts file . now next-env.d.ts looks like this : after this change , vscode code editor was n't showing any error , but the compiling was still failing , saying the same error : sample code repository here < code > could not find a declaration file for module 'youtube-captions-scraper ' . ' e : /coding/ # # # quary/quary-development/node_modules/youtube-captions-scraper/dist/index.js ' implicitly has an 'any ' type . try 'npm install @ types/youtube-captions-scraper ' if it exists or add a new declaration ( .d.ts ) file containing 'declare module 'youtube-captions-scraper ' ; ' /// < reference types= '' next '' / > /// < reference types= '' next/types/global '' / > declare module `` youtube-captions-scraper '' ;
this error pops up whenever i save to refresh ( fast refresh ) ... it goes away when i make a different change only to re-appear in the next other change . appear-disappear-appear ... i 'm running on ... i believe it comes from here < code > `` next '' : `` ^9.5.3 '' , `` react '' : `` ^16.13.1 '' , `` react-dom '' : `` ^16.13.1 '' , `` styled-components '' : `` ^5.0.0 '' , unhandled runtime error typeerror : destroy is not a function call stack commithookeffectlistunmount node_modules/react-dom/cjs/react-dom.development.js ( 19710:0 ) commitpassivehookeffects /_next/static/chunks/main.js ( 40064:11 ) htmlunknownelement.callcallback node_modules/react-dom/cjs/react-dom.development.js ( 188:0 ) object.invokeguardedcallbackdev /_next/static/chunks/main.js ( 20533:16 ) invokeguardedcallback node_modules/react-dom/cjs/react-dom.development.js ( 292:0 ) flushpassiveeffectsimpl /_next/static/chunks/main.js ( 43149:9 ) unstable_runwithpriority node_modules/scheduler/cjs/scheduler.development.js ( 653:0 ) runwithpriority < cur > 1 /_next/static/chunks/main.js ( 31335:10 ) flushpassiveeffects node_modules/react-dom/cjs/react-dom.development.js ( 22820:0 ) < unknown > /_next/static/chunks/main.js ( 42995:11 ) workloop node_modules/scheduler/cjs/scheduler.development.js ( 597:0 ) flushwork /_next/static/chunks/main.js ( 49188:16 ) messageport.performworkuntildeadline node_modules/scheduler/cjs/scheduler.development.js ( 164:0 ) function commithookeffectlistunmount ( tag , finishedwork ) { var updatequeue = finishedwork.updatequeue ; var lasteffect = updatequeue ! == null ? updatequeue.lasteffect : null ; if ( lasteffect ! == null ) { var firsteffect = lasteffect.next ; var effect = firsteffect ; do { if ( ( effect.tag & tag ) === tag ) { // unmount var destroy = effect.destroy ; effect.destroy = undefined ; // this is where it happens ... why not // check if it 's an actual function ? ? ? if ( destroy ! == undefined ) { destroy ( ) ; } } effect = effect.next ; } while ( effect ! == firsteffect ) ; } }
hi guys , just a short question . i need to create global configuration object based on the domain /en/de/it and access it while fetching the data in the getserversideprops method . my idea was to create it in the _app wrapper and provide as a props to the other components . the question is if it 's possible to access the props in the getserversideprops ? do you have any other idea how i could solve that ? < code >
i have a use case where i need to make authenticated calls to my backend to serve data . this means - i ) i 'd need to run some logic for building my request ii ) attach the necessary auth headers which i 'd get in a cookie from the browser - before i make a call within getserversideprops iii ) be able to do/use the same code for making calls ( e.g . pagination on scroll ) when inside client/browser now . p.s . there are several calls - bootup/data-fetch etc which need to be made when gettingserversideprops . i am wondering what 's the best way to do so when ssring also p.s . - > uptil now when i did n't do any ssr , i had several global variables/configs available in my react context on the browser side , using which i could `` make '' my request 's payload and then do the n/w calls . now within getserversideprops - > i no more have react context of any sort , and need to pass on my configs/global variables all the way down to all function calls : ( any help/insight would be appreciated , thanks you ! < code >
feature request is your feature request related to a problem ? please describe . two overarching related issues : the directory pages no longer makes sense now that it contains api routes . these are n't pages . the name pages is a convention generally used in other frameworks to denote a place where top level ui components and accompanying files such as styles , tests , stores or state live . describe the solution you 'd like with the addition of api routes , it makes much more sense to consider renaming this from pages to routes . this has been requested multiple times before but mostly this was before api routes were introduced . consequently , this also allows developers to continue using the pages convention to contain top level ui components and related files all in one place . src/routes/api/ * * / * .js : api routes src/routes/ * * / * .js : exports the relevent page component from src/pages src/pages : contains one folder per page component along with it 's store/state and styles src/components : re-usable components describe alternatives you 've considered src/pages/api/ * * / * .js : api routes src/pages/ * * / * .js : exports the relevent screen component from src/screens src/screens : contains one folder per screen component with state and style files src/components : re-usable components this structure trips me and other developers up every single time : when you want to edit an api route is this in pages or screens ? none seem relevent to `` api routes '' . when you want to edit the ui for a page is this in pages or screens ? pages seems most relevent but this is wrong . < code >
i 'm using dynamic route where i have two files , [ ... slug ] .js and blog.js . so , ideally /blog should render content of blog.js file and any other route render content of ' [ ... slug ] .js ' which is working fine but as soon as i add trailingslash : true , in next.config.js . it renders content of [ ... slug ] .js for all the routes . it is happening for csr only . repo : < url > version of next.js : v^9.5.3 version of node.js : v12.17.0 < code >
hello , i 'm trying to deploy my app on subdirectory but when i do that the css , js and images are not loading . i 'm using nginx to proxy the localhost:3000 to my subdirectory , but no luck . but when i open the ip:3000 of the server it renders correctly . so there must be something to be configured on nginx ? have somebody have the same issue ? i 'm trying to fix this 3 days so far and ca n't find anything on the internet . kind regards , tomislav . < code >
feature request is your feature request related to a problem ? please describe . when deploying a nextjs app within docker is probably a fairly common pattern . to keep the internet and cold-boots fast and happy , it 's best to keep that docker image as small as possible . describe the solution you 'd like expose a supported method to create a tiny-as-possible docker image that can run a nextjs app . i think this could be as simple as making a runtime-server via node a `` first class '' export or as far as publishing a next start binary yourself that 's consumable . describe alternatives you 've considered using pkg on the built app itself using ncc and pkg on the built app , both serverless and monolith additional context linking to a hacky `` solution '' that i 've found : # 8574 ( comment ) it involves using ncc and pkg to create a binary for next start that can be used to run a built app with no dependencies . < code >
i want to get data from an api and send this data as props to all components . like this codes in index.js the mobile is available in mainbody . but i want to access mobile data in all components , < code > const index = ( { ... props } ) = > { return ( < react.fragment > < layout > < homeheader / > < mainbody { ... props } / > < footer / > < /layout > < /react.fragment > ) ; } ; export async function getserversideprops ( ) { const mobile = await fetchdata ( `` /customers/products/filter/ ? category=68 & limit=10 & sort=random & in-stock=true & lang=fa '' ) ; return { props : { mobile } , } ; }
i am trying to compile typescript on the client side ( like the typescript playground ) . i want to use dynamic imports so that most of my page can load while the components that compile typescript display a loading message . i am seeing that the entire page is loading at once , which i did n't expect . am i misunderstanding dynamic imports ? also , dynamic imports will never cause me to do something like loading a package twice , i wo n't load typescript twice if two components both depend on it and are loaded dynamically ? example repository : < url > < code >
hello there . i 'm trying to get the url slug inside a variable at the page load . as simple as that . but there 's a catch . first here is what i have in pages/profile/ [ ... slug ] .js : and the issue is , on each page load the console.log is triggered 2 times . first time is undifined and then there 's the expected value . i do n't get why is done 2 times and mainly why is the first one undifined . because , during ssr , router has access to the full url , has n't it ? < code > // ... const profile = ( ) = > { const router = userouter ( ) ; const slug = router.query.slug || [ ] ; const target = slug [ 0 ] ; console.log ( target ) ; const [ tab , settab ] = usestate ( target ) ; // ...
hi the community . i have a separate service layer for my fetch calls on my project . assume getsomedata function there . so , if i import and call that function inside getserversideprops , it returns null . but if i call fetch directly inside getserversideprops it works ok. why that ? my getsomedata function calls same fetch , but just wrapped in a couple other functions like getsomedata - > callmysuperapi ( `` /call '' ) - > fetchbackend ( `` /call '' ) - > fetch ( `` phofurl appreciate your help . thank you . < code >
hi . i recently asked a question on how to send data between pages in nextjs . it was suggested to use router.push , and at the time , it worked . however , i noticed that one of my query parameters actually has nested objects , and if i use router.push , it would just return an empty string for that field . i looked into it and found this : # 2530 ( which says nextjs does not support nested objects in query parameters ) . what would be an alternative to router.push for sending data between pages with nested objects ? < code >
during our development process using a cms it 's been common to encounter errors as the cms is being shored up . code does n't properly handle missing data etc . instead of building the thousands of pages and listing the 10-20 that are failing , is there a way to just stop the static site build immediately on any error ? this would save considerable ci build time . just an example of an unhandled error it would be nice to fail immediately on . < code > 1:58:51 pm : unhandled error during request : error : destinationtype is content reference , but no content reference is selected 1:58:51 pm : at object.default ( /opt/build/repo/.next/serverless/pages/conditions/ [ slug ] .js:58990:23 ) 1:58:51 pm : at traverse ( /opt/build/repo/.next/serverless/pages/conditions/ [ slug ] .js:52390:44 ) 1:58:51 pm : at /opt/build/repo/.next/serverless/pages/conditions/ [ slug ] .js:37820:38 1:58:51 pm : at /opt/build/repo/.next/serverless/pages/conditions/ [ slug ] .js:29318:15 1:58:51 pm : at baseforown ( /opt/build/repo/.next/serverless/pages/conditions/ [ slug ] .js:27383:24 ) 1:58:51 pm : at function.mapvalues ( /opt/build/repo/.next/serverless/pages/conditions/ [ slug ] .js:37819:7 ) 1:58:51 pm : at traverse ( /opt/build/repo/.next/serverless/pages/conditions/ [ slug ] .js:52408:45 ) 1:58:51 pm : at /opt/build/repo/.next/serverless/pages/conditions/ [ slug ] .js:52420:16 1:58:51 pm : at /opt/build/repo/.next/serverless/pages/conditions/ [ slug ] .js:60044:50 1:58:51 pm : at step ( /opt/build/repo/.next/serverless/pages/conditions/ [ slug ] .js:59999:23 )
hi , i 've been looking around after a proper solution for getting google analytics to work with next.js , without any luck . it does n't seem like google analytics updates the viewed page when i 'm navigating around my website . if i enter a direct url , or refresh , it will register the page as it should . all my internal urls are using the link component . like this : google analytics does n't register when i 'm clicking the link . if i 'm moving directly to the page : < url > it gets registered i have a layout component as per next tutorial . i 've tried adding the analytics script within the head component in here . i 've also tried adding the analytics script to every page , within the head component no matter where i put this script , it does n't seem to register the page clicks correctly . i suppose this has to do with the way link is built . since it does n't do a complete refresh . how can i install google analytics the proper way ? < code > < link href= '' /some-url '' > < a > visit some site < /a > < /link > < head > < script async src= '' < url > < script dangerouslysetinnerhtml= { { __html : ' window.datalayer = window.datalayer || [ ] ; function gtag ( ) { datalayer.push ( arguments ) ; } gtag ( 'js ' , new date ( ) ) ; gtag ( 'config ' , 'ua-179245515-1 ' ) ; ' , } } / > < /head >
i submitted < url > but it gets deleted . i wonder why the issue has been deleted ? ( i provided the reproduce procedure and my nodejs , next.js , macos version ) . maybe security-related issue should n't be submitted there ? but i am keen on a workaround provided by next.js team : ) < code >
hi , so we are having a memory leak , it was probably there since we started developing the app so it is really hard to pinpoint where this error is coming from , maybe someone has experienced something similar . i took two snapshots and between i run : running 1000 requests test @ < url > 50 connections the allocation of memory is quite significant with around 300mb as you can see here if i select objects allocated between snapshot 3 and snapshot 4 you see the larget position are strings which look like this i suspect this is having to do something with emotion . why are to strings not garbage collected ? < code >
here there , does class component break fast refresh ? in fact , class component are exported by default in _app.tsx and _document.tsx and i have sometimes this error in browser console , after somes changes ( not always , but after few minutes of coding ) : i use stitches in my projet ( < url > ) which implant styled components . who can help me to newer show this error message 🙄 thanks 🙏 < code > [ fast refresh ] performing full reload fast refresh will perform a full reload when you edit a file that 's imported by modules outside of the react rendering tree . you might have a file which exports a react component but also exports a value that is imported by a non-react component file . consider migrating the non-react component export to a separate file and importing it into both files . it is also possible the parent component of the component you edited is a class component , which disables fast refresh . fast refresh requires at least one parent function component in your react tree .
i have a project that uses static pages through next export . but there is a lot of pages , so i ca n't export all of them each time something changes . modifications are , so to speak , saved , and a cron reads these from time to time , and creates a dynamic exportpathmap , so that only what is really needed will be exported . then the static files are sent to the same place where all others unmodified pages are too . the trouble is that , because the unmodified pages and the modified ones belong to different build times and bundles , when i click at a link ( that uses link component ) that would go from , say , an unmodified to a modified page , it does not occur through js , so the window refreshes ( i.e . does not behave as a spa ) . anything to avoid that ? thanks in advance 😺 < code >
( i 'm not good english . i ask for your understanding in advanced ) i have been using getinitialprops to write isomorphic code . that is many things to be aware of in order to write code that can work in both ssr and csr , but i thought that i could move to the react ( spa ) project at any time because it is code that can run in the browser however , after nextjs 9.3+ , the getinitialprops function was deprecated , and getserversideprops and getstaticprops were added , but they seem to have a different way or intention to operate with the existing getinitialprops . getserversideprops or getstaticprops executed only in ssr environment , there are a lot less parts to be careful compared to isomorphic code , but it seems that it can not replace the existing getinitialprops . i hope getinitialprops stays . how about naming getinitialprops as getisomorphicprops to clarify its use ? is there any other problem that is deprecated ? < code >
hi , i am working with next a little while and i am looking at examples with redux at main canary/examples github repo of next . tbh i do n't really know if it is desired to have 2 stores , and adds only more confusion . to me , the issue is if you have declared hydration on getstatic/serverside props on each change of route you will override the client store right , that means that you always lose progress made in a different route , or there is some approach that will help you preserve progress and `` throw-away server store '' if you made some update or progress on client ? . clearly , i would need some help to understand how to use redux in next js correctly , if there is some guide article for more `` dummies '' because this is only one thing that i do n't really get . redux-wrapper seems not to fill that functionality or at least it exactly does what i have described above . < code >
hi all , i 'm new in react or nextjs and i 'm getting project that must use diagram flow like react-flow . before doing to use that library i 'm doing research about how to use , and implement in nextjs project , but when im searching on exmple in this repo i did n't see example that use react-flow library from wbkd and i think why do n't i just do this , but the big question is , may i doing request to adding an example to use nextjs with react-flow ? sory about my bad english before , tahanks and i hope that you all understand what i mean < code >
hey 👋 , i 'd like to ask if there is an option to render fallback static paths on the server ( ssr ) ? imagine a lot of items ( e.g. , 100 000 , not frequently changed ) that can not be prerendered on build time , but you always want to get static html . so , if the page ( static path ) is not yet generated ( first visit ) , it would behave like getserversideprops but when the page is generated it will be returned immediately ( second visit ) . imagine a setup like this : so , my question is , is there an option something like this or a way to achieve this ? thanks . < code > export async function getstaticpaths ( ) { return { paths : [ ] , fallback : true } ; } export async function getstaticprops ( { params } ) { const item = await fetchitem ( params.id ) ; return { props : { item } } ; } export async function getstaticpaths ( ) { return { paths : [ ] , fallback : true , ssr : true } ; }
imagine you 're a website builder and hosting provider and you 're using next.js as the framework to render the websites . if you wanted to leverage static regeneration you would probably have to deploy each site as a separate next.js app so that they can take advantage of all the static optimizations . if there are a lot of sites being created , though , that might be unnecessary overhead . would it be possible to leverage static regeneration for multiple hosts in a single next.js server where the referenced pages can be matched not just by path but also by the host header ? there 's no issue at the cdn layer since the host and path are both considered , but is static regeneration supported with custom servers in next.js ? < code >
recently , i made a project that used materialui and nextjs , and based on nextjs-with-typescript . i tried to figure out the code in _document.tsx , but got confused with the comments . i think if there is no comment , i might just pass this part , but this comment seems important . could anyone explain the comments ? why do we need to know these secret orders for different rendering ? edit : i guess it might relate to the working flow of nextjs , the only explaination i found is borek bernard 's comment . ca n't find any article or flow-chart to explain this in nextjs docs . did i miss something ? < code > // resolution order // // on the server : // 1. app.getinitialprops // 2. page.getinitialprops // 3. document.getinitialprops // 4. app.render // 5. page.render // 6. document.render // // on the server with error : // 1. document.getinitialprops // 2. app.render // 3. page.render // 4. document.render // // on the client // 1. app.getinitialprops // 2. page.getinitialprops // 3. app.render // 4. page.render
i would like to deploy a nextjs behind a lambda @ edge ( cloudfront edge worker ) function that does some authorization , reads a cookie , and then routes requests to the origin based on the results . this way , the user can request urls like this : /posts/ : postid that are forwarded to my nextjs origin server as : / : language/ : permission/posts/ : postid this has the advantage of only ever exposing 'clean ' urls to users , while still getting good cache performance since the cdn caches the expanded url , rather than the clean one . with this setup , when i load a ssrd page everything seems to work ok , but i ca n't get client-side routing to work since the 'clean ' urls are not in my route manifests ( i believe ) and my hrefs do n't match my 'as ' props . an example link : i am also having various problems with ssg/isr , but i suspect that they are related to the issues with ssr , so i 'll focus on those for now . this setup is n't all that different to putting nextjs behind a reverse proxy , so i 'm hoping that i 'm missing something obvious and there is a way to support this without resorting to modifying all of my route manifests as a post-build step ( i 'm not even sure that would work ) . does anyone have any advice ? < code > < link href= '' / [ language ] / [ permission ] /posts/ [ postid ] '' as= '' /posts/1234 '' > < a > click < /a > < /link >
bug report describe the bug in this pr # 16184 , the files property was removed from the documentprops ( types ) and the corresponding implementation . is this intended ? and if yes : how can i access the files like in the following code : to reproduce system information version of next.js : 9.5.3 version of node.js : 12.18.2 < code > import react from 'react ' ; import { readfilesync } from 'fs ' ; import { resolve } from 'path ' ; import { head } from 'next/document ' ; import type { documentcontext } from 'next/document ' ; class criticalhead extends head { getcsslinks ( ) { const cssfiles = this.context.files.filter ( f = > /\.css < cur > /.test ( f ) ) ; const { nonce } = this.props ; const csslinks = cssfiles.map ( file = > { const stylecontent = readfilesync ( resolve ( process.cwd ( ) , '.next ' , file ) , 'utf-8 ' ) ; return < style key= { file } nonce= { nonce } dangerouslysetinnerhtml= { { __html : stylecontent } } / > ; } ) ; return csslinks.length ? csslinks : null ; } }
we are deploying quite regularly daily , which means our pages that have previously been generated on the fly will now all show the fallback again , instead of immediately loading from the cdn ( which is obvious , since the pages might have changed after a new deployment so they will require to be regenerated ) . we really would love to reduce the amount of instances where users are seeing fallbacks , but still continue to take advantage of site generation during runtime . we were wondering if there would be a way to instead of the fallback serve the last valid ( stale ) version of a page if one has already been generated for a previous release and generate the new version in the background so that the updated version would be served afterwards for all users . this would have the downside that some users might be seeing a stale page after a new update was deployed , but the upside is that no users would ever have to see a fallback page again , no matter how often you deploy . with critical deployments there could be an option to invalidate the cache and force all pages to render with a fallback again . really curious if this is something that could be viable . < code >
i 'm trying to using a tag to preload data as recommended in the swr package but the request that is made does not contain my cookie so fails every time . my cookie has secure = true , samesite = lax and httponly = false . the cookie domain is set to the api which is on a subdomain of the next app ( this may be the issue , not sure ) . how do i include the cookie in the request made by < link rel= '' preload '' href= { < cur > { process.env.next_public_api_url } /user } as= '' fetch '' crossorigin= '' anonymous '' / > ? < code >
hello guys , what is the proprer way to start production ( builded ) version of nextjs project on different ports via forever ? we are starting domains on different ports . i already searched whole internet ... , tried : port=5605 in .env.production and bunch of other solutions thank you < code >
i have a graphql query that is called in getserversideprops . the query returns an error when called in getserversideprops , but the same query works when calling it from the page component using usequery hook . other queries are executed successfully when calling them inside of getstaticprops function . this is code for the query error i get any help and ideas would be appreciated . < code > response : response { size : 0 , timeout : 0 , [ symbol ( body internals ) ] : [ object ] , [ symbol ( response internals ) ] : [ object ] } , statuscode : 400 , bodytext : ' < html > ' + ' < head > < title > 400 bad request < /title > < /head > ' + ' < body > ' + ' < center > < h1 > 400 bad request < /h1 > < /center > ' + ' < hr > < center > cloudflare < /center > ' + ' < /body > ' + ' < /html > ' export async function getserversideprops ( ctx ) { const apolloclient = initializeapollo ( ) const token = ctx.req.headers.cookie & & cookie.parse ( ctx.req.headers.cookie ) let data = await apolloclient.query ( { query : get_lesson , variables : { coursetitle : ctx.query.slug , lessontitle : ctx.query.lessons , } , context : { headers : { authorization : 'bearer < cur > { token & & token.user_token } ' , } , } , } ) return { props : { lessondata : data.data , } , } }
suppose i have route : both routes should open same page /god/thor . i am also having a page /god/ [ others ] now on local it works for caps or no caps . but when i host it goes to the others page . to handle that i have added in redirects in next config but on local i am getting err_too_many_redirects < code > /god/thor /god/thor { source : '/god/thor ' , destination : '/god/thor ' , permanent : true }
hey all , if you pull a list of paths from a source [ index , about , blah , contact , etc . ] , how do you ssg your site with dynamic routes ( using getstaticprops/getstaticpaths ) but have the homepage resolve as somedomain.com/ ? i have the rest of the code working , but on building it exports the homepage as /index/index.html instead of /index.html which obviously means hitting the root domain just 404 's ( but somedomain.com/index works fine ! ) . i can redirect / to /index and it works great , but that 's probably not a clean solution . and if i copy and paste the code of pages/ [ slug ] .js into pages/index.js it works fine but that 's a pretty ugly solution as you need to maintain 2 lots of code . i found this example code but that does n't seem to work for me . am i missing something obvious ? thanks for any pointers : ) < code >
bug report describe the bug is there a way to ignore the custom server file or fix this to reproduce steps to reproduce the behavior , please provide code snippets or a repository : make a typescript next app with a custom server along with typeorm expected behavior the dang thing to work or not to check the server folder system information os : macos version of next.js : latest version of node.js : 14 < code > error - ./server/entity/referrer.ts:10:1 syntax error : support for the experimental syntax 'decorators-legacy ' is n't currently enabled : 8 | import { nanoid } from 'nanoid ' ; 9 | > 10 | @ entity ( 'referrers ' ) | ^ 11 | export class referrers extends baseentity { 12 | @ primarycolumn ( 'text ' ) 13 | id ! : string ;
the new build-in css and sass support expects the global styles to be imported in the pages/_app.js . the reason is to avoid class name and ordering conflicts , < url > question , how the global styles should be imported on demand ? example : using third part components that are loaded on demand and are n't used frequently . makes no sense to download their stylesheets for the whole app . < code >
i have yarn monorepo with following structure where from nextapp i do it resolves the package correctly , but since these are ts files , the ts loader is not applied and it fails with module parse failed : unexpected token . any idea how to modify webpack config to make this work ? < code > packages/ nextapp/ shared/ import x from `` @ monorepo/shared ''
i want to add a global meta description for all pages from a cms at build time while still keeping all pages statically optimized , does every page need a get static props now or can i use _app/_document for that without breaking any static optimization ? < code >
i would like to add following script in my footer ( custom ) component . < script language= '' javascript '' type= '' text/javascript '' > trustlogo ( `` < url > `` cl1 '' , `` none '' ) ; < /script > this script is supposed to show ssl logo image in my webpage footer component . but nothing 's happened . i already added nextscript component in my _document.js . and i tried according to # # 17358 but still not working . so , i created a new script file ( called hello.js ) which includes simple test script < script type= '' text/javascript '' > console.log ( `` * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * external external '' ) ; < /script > and try to import in my component by using < script type= '' text/javascript '' src= '' ./hello.js '' > < /script > i did get any console output either . it seems no script is executed inside my custom component . is there anyways to show trustlogo in my custom component ? thanks in advanced < code >
i recreated the problem in this codesandbox < url > i have two routes ( pages ) / /car/info and two components header carinput i used context to maintain the state and pass it to both the pages . when im in route /car/info and i change the state using input , the updated state gets displayed in header component of the same route ( page ) . but when i go to / route ( page ) the state is not updated .i inspected using react dev tools and the context doesnt have the updated values . even when i go back to /car/info , the updated state is not there too . as soon as i transition to / from /car/info the state goes back to intialstate . steps to recreate the same on sandbox click on `` go to add car '' enter a car name in the input and click add click on `` go to home '' now you can see the car you added is not present there . context usage pattern reference : < url > < code >
inside _app i 'm writing import type { appprops } from `` next/app '' ( from next.js doc ) but vscode is giving me a warning . if i write import { appprops } from `` next/app '' instead everything would be fine . which one is the right option ? < code >
in my react code , i have a link to some favicons , and i 'd like to re-use the same url string when linking to the same icons in my manifest.webmanifest file . i 've placed the url 's to these favicons in a constants.ts file , and i use these in my react code . i 'd like to automatically generate a manifest file from these constants to make changing the favicons location easier . is this possible ? i 've read lee robinson 's approach , but this means that either : i ca n't use typescript / es6 / import my constants with webpack - > i need access to my constants.ts file . or the manifest.webmanifest url is a serverless function serving the file - > i 'd like to use only static assets . what can i do to make this happen ? i wonder whether generating this asset through a page like lee does has any downsides due to next treating it like a page ? < code >
hello , i 'm building several static next.js applications ( some of them with ~200 pages ) . can someone please elaborate on the bundling process ? , especially about performance , lazy loading ( if any ) , etc . my aim is to produce a minimal bundle size for each page so i 'm planning to include only relevant components . my question is this , after implementing getstaticprops and running build & export for my project : does next.js bundles all components into one file for one http request or do it `` lazy loads '' relevant chunk per page ? is there any way to `` tree-shake '' or remove unused next.js features from the final bundle ? is there any `` best practice '' list for optimizing next.js static sites for production ? thanks for answering . < code >
now , i have user role in context . i can check the role of context in useeffect on each page before fetch data and redirect to login if the user does n't have the admin role : but i do n't want to rewrite to check the user role on each page . how can i use it for every page ? after research , i 've used a hoc component to protect the route and wrap each page : fetch data on page ( do n't need check role because check from hoc component ) : but , it still fetches data before redirect , and i get an error because ca n't get api without the admin role : is this the correct way ? thank you for your support ! < code > useeffect ( ( ) = > { if ( userinfo.role == 2 ) { get ... ; } else { router.push ( '/login ' ) ; } } , [ ] ) ; export const withprivateroute = component = > props = > { const role = 1 ; useeffect ( ( ) = > { if ( role == 1 ) router.push ( '/login ' ) ; } , [ ] ) ; return < component { ... props } / > ; } ; useeffect ( ( ) = > { get ... } , [ ] ) ;
given that we have the following directory structure : [ id ] is our dynamic route , and we want to account for multiple routes that would do different things like /api/post/ : id/create , is it possible to do it this way ? < code > pages/ api/ post/ [ id ] / index.js create.js
bug report describe the bug when using a next 's link component with a bookmark url , i.e . # sectionid , it auto prefixes the url with / . to reproduce in both examples above , the rendered anchor tag contains the following href value = / # sectionid expected behavior either an optional prop to include/exclude the slash or not having this behavior by default and a prop to enable this prefixing . system information os : macos browser ( if applies ) across browsers version of next.js : 9.5.0 version of node.js : 14.8.0 < code > import react from 'react ' ; import link from 'next/link ' ; import styled from 'styled-components ' ; const styledanchorlink = styled.a ' text-decoration : none ; ' ; const bookmarklinkwithstyledcomponent = ( { title } ) = > ( < link href= '' # sectionid '' passhref > < styledanchorlink > { title } < /styledanchorlink > < /link > ) const bookmarklinkwithregularanchortag = ( { title } ) = > ( < link href= '' # sectionid '' > < a > { title } < /a > < /link > )
i have a monorepo of typescript packages , i use yarn workspaces for the packages to be hoisted in development so i do n't have to push npm private repo package every time there is a small update . the current error i am getting with next @ 9.5.3 and next-transpile-modules @ 4.1.0 is that the npm private repo packages that i hoist with yarn workspaces are showing the error `` can not use import statement outside a module '' when added in with next-transpile-modules . let me know if you need any other information to help - been stuck on this for a while now . thanks so much ! < code >
hey all ! i 'm having an issue where my app is throwing up a generic internal server error on ssr and an unexpected error has occurred . on client side navigation . this is happening for all server-side-rendered pages , but not any api routes or statically-generated pages . this is happening only on on appengine . the stack trace is : the app runs fine locally in dev and production , which makes me think it 's something about the difference in the deployment environments . however , a previous commit works just fine . thank you for the help ! < code > typeerror : undefined is not iterable ( can not read property symbol ( symbol.iterator ) ) at nextscript.getscripts ( /workspace/build/server/pages/_document.js:633:5 ) at nextscript.render ( /workspace/build/server/pages/_document.js:731:179 ) at d ( /workspace/node_modules/react-dom/cjs/react-dom-server.node.production.min.js:38:231 ) '' , at processticksandrejections ( internal/process/task_queues.js:97:5 ) '' , at rendertohtml ( /workspace/node_modules/next/dist/next-server/server/render.js:52:103 ) '' , at renderdocument ( /workspace/node_modules/next/dist/next-server/server/render.js:3:640 ) '' , at rendertostaticmarkup ( /workspace/node_modules/react-dom/cjs/react-dom-server.node.production.min.js:54:462 ) '' , at a.b.read ( /workspace/node_modules/react-dom/cjs/react-dom-server.node.production.min.js:44:18 ) '' , at a.b.render ( /workspace/node_modules/react-dom/cjs/react-dom-server.node.production.min.js:44:476 ) '' , at < cur > a ( /workspace/node_modules/react-dom/cjs/react-dom-server.node.production.min.js:39:16 ) '' ,
hello members , following is problem set : i have a form on /contact page . i want to check if user filled this form or not . on form submission , i set a local cookie for 24 hours using ncookies . i want to perform redirection based on this cookie . if cookie is present , user can access any page , otherwise redirect to /contact page . i managed to setup redirection on client-side , but i see a flicker . what is the best way to setup redirection on server side ? i have components folder for each section like twocolumnslayout , threecolumnslayout which are rendered in pages folder . i am unable to leverage getinitialprops in each page and perform rendering at server side . any ideas ? following is code on how i handle redirection on client-side : < code > redirectpage = ( ) = > { let hascookie ; const cookies = document.cookie.split ( ' ; ' ) .find ( row = > row.startswith ( 'formsubmitted ' ) ) ; hascookie = cookies === undefined ? false : true ; if ( ! hascookie ) { router.push ( '/contact ' ) } } componentdidmount ( ) { this.redirectpage ( ) ; }
dear next.js community , i 'm currently evaluating next.js for a project and there 's a tricky requirement that i 'm trying to tackle . let 's say there are 1000 pages which can all be generated statically ( i.e . the pages always look the same ) . 100 of them shall only be a available to a small group of people . these people have an user account in my backend application . before serving the ( statically generated ) pages , i need to check both publication status of the pages and user permissions . if possible , do n't want to use server-side rendering for this case , but static generation . here 's what came to my mind : using preview mode for all logged-in users and fetching data on request ( or returning a 403 status ) using x-accel or x-sendfile : serve the pages from a web server 's private location and performing access control before allowing users to view the private location ( creating several build of my page , including different files ) do you have any recommendations for implementing the intended behavior ? thanks for your advice ! < code >
i 'm new to the scene of vue and react , and was looking at the differences between nuxt and next , what would you guys reccomend ? < code >
hello , i 'm trying to generate a png on ssg . therefore i render a react generated svg into a string buffer which is than transformed into a png via sharp where i ran into the issue described in lovell/sharp # 1875 - essentially lambdas not having fonts installed . it 's relatively hard to debug as locally via next dev & vercel dev things work , but once deployed to vercel it generates things like ( the boxes are the issues as they should be text instead ) : i tried following the suggestions from lovell/sharp # 1875 without success so far ( will update this question in case i make some progress ) . did someone figure out a way to properly load any fonts on build on vercel ? < code >
hello there , i am trying to use type-graphql and typeorm inside my next project but i have a problem when i save the code i get this error : alreadyhasactiveconnectionerror : can not create a new connection named `` default '' , because connection with such name already exist and it now has an active connection session . at new alreadyhasactiveconnectionerror ( /home/mi3lix9/projects/templates/mi-template/node_modules/typeorm/error/alreadyhasactiveconnectionerror.js:10:28 ) at connectionmanager.create ( /home/mi3lix9/projects/templates/mi-template/node_modules/typeorm/connection/connectionmanager.js:51:23 ) at /home/mi3lix9/projects/templates/mi-template/node_modules/typeorm/index.js:207:66 at step ( /home/mi3lix9/projects/templates/mi-template/node_modules/tslib/tslib.js:141:27 ) at object.next ( /home/mi3lix9/projects/templates/mi-template/node_modules/tslib/tslib.js:122:57 ) at /home/mi3lix9/projects/templates/mi-template/node_modules/tslib/tslib.js:115:75 at new promise ( < anonymous > ) at object.__awaiter ( /home/mi3lix9/projects/templates/mi-template/node_modules/tslib/tslib.js:111:16 ) at createconnection ( /home/mi3lix9/projects/templates/mi-template/node_modules/typeorm/index.js:192:20 ) at module.exports .. /src/pages/api/graphql.ts.__webpack_exports__.default ( /home/mi3lix9/projects/templates/mi-template/.next/server/pages/api/graphql.js:243:73 ) this is the code : < code > export default async ( req : nextapirequest , res : nextapiresponse ) = > { await createconnection ( { url : mymongourl , type : `` mongodb '' , entities : [ todo ] , } ) ; const apolloserverhandler = await getapolloserverhandler ( ) ; return apolloserverhandler ( req , res ) ; } ; export const config = { api : { bodyparser : false , } , } ; let apolloserverhandler : ( req : any , res : any ) = > promise < void > ; export const getapolloserverhandler = async ( ) = > { if ( ! apolloserverhandler ) { const apolloserver = new apolloserver ( { schema } ) ; apolloserverhandler = apolloserver.createhandler ( { path : `` /api/graphql '' , } ) ; } return apolloserverhandler ; } ;
i m using next js latest version 9.5.3 with the redux ( saga ) i created some dispatch method using saga but now when i m calling my dispatch method it says : - typeerror : can not read property 'dispatch ' of undefined this is my page import react , { component } from 'react ' import footer from `` .. /src/containers/footer/footerview '' import header from `` .. /src/containers/header/headerview '' import homeview from `` .. /src/containers/homecontent/homeview '' import { connect } from 'react-redux ' import { loadhomepagedata } from ' .. /src/containers/homecontent/actions ' import { loaddatameganav } from ' .. /src/containers/meganavcontent/actions ' const home = ( props ) = > { return ( first page ) } export async function getserversideprops ( context ) { console.log ( 'contextcontext > > > ' , context ) const { store , isserver } = context store.dispatch ( loadhomepagedata ( ) ) return { props : { store : 'ssss ' } } } export default connect ( state= > state ) ( home ) < code >
this morning we updated our next version from 9.5.2 to 9.5.3. after a while we noticed a warning in our dev console saying : after digging i found out that we did n't use the html tag , however , we have n't use that tag since the startup of our project ( ~2 years ago ) . did it became required from 9.5.3 ? we have n't seen that warning before . nothing was mentioned in the update logs ( from dependabot ) . thanks in advance 👍 < code > expected document component html was not rendered . make sure you render them in your custom '_document ' see more info here < url >
describe the bug using a module replacement plugin , similar to webpack 's normalmodulereplacementplugin , the replaced modules appear only in the client-side bundle and not in the server-side bundle . this causes the application to display wrong components on the ssr output which then gets replaced when client-side javascript takes over . webpack plugin used is @ deity/normal-module-override-webpack-plugin webpack config : expected behavior replaced modules should appear in both bundles so the ssr output is rendered correctly . system information os : windows 10 , ubuntu 20.04 version of next.js : 9.3.6 version of node.js : 12.16.3 < code > const normalmoduleoverrideplugin = require ( `` @ deity/normal-module-override-webpack-plugin '' ) ; module.exports = { webpack : ( config ) = > { config.plugins.push ( new normalmoduleoverrideplugin ( { `` package/path/to/component '' : `` src/custom/component '' , } ) ) ; return config ; } , } ;
hey , i am currently migrating a platforms frontend to use next.js . the website is made up of products and categories , the url is made from the product name or the category name . for example : page type page id name url category 1 tablets /tablets category 2 phones /phones product 1 ipad 4th gen /ipad-4th-gen so we do not have to setup a bunch of redirects , in the express server i lookup the route information from an api and change the request url to match the routing used in next : /product/1 /category/1 this seems to work well , however , i do n't know if it 's possible to do shallow linking with this method ? say i wanted to link to a different category , is there a way i can do something like this ? if this is n't possible , can somebody point me in the direction of the code where i could possibly change the users route ? if not i guess i will bite the bullet and redirect the existing urls . < code > < ul > < li > < link href= '' /category/ [ id ] '' as= '' /category/2 '' seourl= '' /iphones '' > < a > iphones < /a > < /link > < /li > < /ul >
bug report describe the bug when i have a dynamic url , if you visit the url directly and without a trailing query string in the url , the query params are empty . if you access the page via a next-link , it works as expected . to reproduce steps to reproduce the behavior , please provide code snippets or a repository : clone the reproduction example start the dev server : yarn next dev visit localhost:3000 and click the link to go to /helloworld the page outputs the contents of router.query as expected refresh the page and notice that router.query is empty go to localhost:3000/helloworld ? anything=whatever notice that now router.query.foo is populated correctly look at the second commit to see the diff between the generated create-next-app boilerplate and the implementation expected behavior router.query should be populated with the url param system information os : macos browser ( if applies ) chrome version of next.js : 9.5.3 version of node.js : 12.16.1 additional context my use case is to build static sites ; i do n't use 'app ' output from next at all , only the output from next export . i use dynamic urls when i have multiple pages that use the same basic structure but different content . this is why the example commit includes the exportpathmap and getstaticroutes functions . < code >
we are building and appp using next with our own cms which is handling url rewrites history . as pages change a url path we store historical changes in the db . the intent is to allow old url links to still be resolvable to the latest destination while passing propped redirect seo codes . we implemented this using custom router before the latest version came out . i am looking for someone who is will to port our logic to our of the box functionality on per project bases hit me up it 's pretty urgent . < code >
i would like to know why the application is still hard refreshing on save . currently in my package.json i have : `` scripts '' : { `` start '' : `` node_env=production node server.js '' , `` dev '' : `` next dev '' , `` build '' : `` next build '' , `` next '' : `` next start '' } running next dev still gives hard refresh , any idea why ? do i need to include fast refresh in my config , or is there something possibly causing the hard refresh ? < code >
hello , i 've been trying to create a next js app that catches all links ( permalinks ) to one page , first i 've created a [ ... permalink ] .js page in pages root , lets call this page the permalink handler page for future reference then all my links were like this : < link href= '' / [ ... permalink ] '' as= '' path/to '' > link < /link > which works great on the server side and the client side in development mode when i go to production the following happens : when i click the link , i get the permalink handler page , but i also get this message in console : get < url > net : :err_aborted 404 ( not found ) when i refresh the page for ssr , i get 404 right away maybe my approach to the whole thing is wrong , any help is much appreciated < code >
hi guys ! i already have my login proccess , that saves my user data and jwt token in a context ... but i 'm so confused of how to do the privates routes , can anyone help me ? thanks guys < code >
i 'm using next start to take advantage of the automatic static optimization , rather than using a custom node server . i ca n't find for the life of me how to redirect our production routes to https on the backend . is there some configuration that will force https without creating a custom server ? < code >
hi i want simple next js express js typescript code that back end and front end in the same server i want next js custom server but what is searched and found in google was old . is there any new types of next js custom server for new versions ? i relay need that if any one can help answer this thanks . < code >
i would like to use scss module and typescript together . in this way , i can do something like import { btn , btnprimary } from `` ./index.scss '' ; using tools typed-scss-modules to give me a nice auto complete to get the classes i want . previously , i am able to do this kind of feature using `` @ zeit/next-sass . since the next js 9+ is coming and it suggests to remove `` @ zeit/next-sass . i am not able to make it work . i would like to ask you advice . how to implement this in latest version of next js . goals : get rid of @ zeit/next-sass and can import bootstrap scss into my own scss . can import bootstrap classes in anywhere and create own scss for componenet the previous version is on here new version with error on here or you may read this to know why i want this kind of feature . thanks in advance . < code >
hi there , i 'm customizing the error page of my next.js app . the code in the doc indicates to use getinitialprops to handle ssr errors properly . however , the official doc also encourage to use getserversideprops instead of getinitialprops in general . so my question is : can i use getserversideprops instead of getinitialprops for the custom error page ? i 'm not really sure about this since getserversideprops does n't receive the prop err through context , so getinitialprops is the only way ? thanks . < code >
previously i was using the nextjs v9.4.4 , in that version getinitialprops was working fine but after upgrading it to the latest version i was getting an error which says : context.req is undefined . here is the code snippet in which i was getting error : < code > lessonpage.getinitialprops = async context = > { const { whiteboardevents , lesson } = context.req ; return { whiteboardevents , lesson , } ; } ;
hi , i have an error when yarn build . but not occurred when yarn dev typography is my custom component . i use absolute imports using baseurl option in tsconfig.json next : v9.5.2 typescript : v3.9.7 i need help thanks . < code >
was wondering where i can dig in to get more information on this ineffective mark-compacts heap error : the only thing i can think of is that i use a long maxinactive age : but would that actually be the reason if i 'm only really working on 1 or 2 pages ? the error usually comes about after 2-3 days . < code > ondemandentries : { maxinactiveage : 24 * 60 * 60000 }
the docs is saying the following : you can use static generation for many types of pages , including : marketing pages blog posts e-commerce product listings help and documentation e-commerce product listings is referring to the product page itself ? or the page that the user is looking for products ? it makes sense to me that a product page can be generated at build time . usually the products page ( the browse page for products ) has a lot of filters that handle different api requests and probably pagination . i assume you have to do server side rendering , no ? thanks < code >
bug report withrouter query object return null describe the bug in my component i used withrouter and i want to pull query string object from it , but at the first render ( i mean for example refresh the page ) , router.query return an empty object , but my url is something like : ... /question ? id=sdsdsdsadda < code >
describe the bug amp pages show a blank page if you have setup store connected with _app.js , if you remove redux store settings from _app.js , it starts working ... < url > < code >
this is my page code : the chrome show the terminal show but page cant get the myreducer.name < code > import { useeffect } from `` react '' ; import { usedispatch , useselector , connect } from `` react-redux '' ; import head from `` next/head '' ; import { userouter } from `` next/router '' ; // import nav from `` .. /components/nav '' ; import { wrapper } from `` .. /redux/store '' ; import { changename } from `` .. /redux/actions '' ; var date = new date ( ) ; const home = props = > { const router = userouter ( ) ; const dispatch = usedispatch ( ) ; const myreducer = useselector ( store = > store.myreducer ) ; console.log ( `` myreducer= '' , myreducer ) ; function goto ( ) { router.push ( `` /zhangwei '' ) ; } return ( < div > < head > < title > home < /title > < link rel= '' icon '' href= '' /favicon.ico '' / > < /head > < h1 onclick= { goto } > { myreducer.name } < /h1 > < /div > ) ; } ; export const getserversideprops = wrapper.getserversideprops ( async ( { store } ) = > { store.dispatch ( changename ( `` zhangwei '' ) ) ; } ) ; export default home ;
i have a project with dynamic route like / [ category ] / [ product ] . after a client-side request via userouter to graphql for example /hatchback/nissan/ returns a product with a code of 200 , but if i make a request to /hatchback/nissan111/ , i get an error because no such route exists and its response code still of 200 instead of 404. how can i check if a route exists and return a 404 status code during the component mount stage ? i use ssr to achive this < code >
hiiii . first post in here . i 'm about to try firebase as my backend for my next.js applications . would probably use it too for authentication . it would be my first time doing this ( past experience was with rest api using node and express ) , any suggestions , or tips or anything ? stay safe ! < code >
good morning guys ! how is the best way to integrate ga in my app ? how are you integrating nextjs and google analytics ? thanks all ! < code >
hello we 're trying to set up a reverse proxy on cloudflare ( using portzilla ) to access our nextjs app ( hosted on vercel ) in the /app subfolder on our domain . to achieve this i 've set the basepath in next.config.js as '/app ' . however , now , when i go to /app i see a directory listing for root , with a sole directory , app , within it . see screenshot . what am i doing wrong ? < code >
bug report describe the bug builds for dev , staging and production contain hard coded environment variables to reproduce steps to reproduce the behavior , please provide code snippets or a repository : do next build & & next export with environment variables next_public_client_backend_api= < url > next start and check in browser that url being used by client react app is < url > stop the app change env variable to next_public_client_backend_api= < url > next start and check in browser that url being used by client react app is < url > bug : browser is still using < url > expected behavior backend url should be backendurl2.com as app is doing ssr and not static builds according to next.js docs on how it decides whether to static or ssr exports per page . page is dynamic as requires data from external resources and so is not exported as a static html . screenshots if applicable , add screenshots to help explain your problem . system information os : macos/linux browser ( if applies ) [ e.g . chrome , safari ] version of next.js : 9.4.4 version of node.js : 14 lts additional context add any other context about the problem here . < code >
i 'm deploying a next app , but when i try to run it i get the following error : it seems as if node is not identifying the code . i understand that that is why we have to use babel , so node can understand es6 sintax . i do n't think i have to add babel configuration since i did n't have to do that when i was running my nextjs project locally , but i actually tried that anyway and got an error when trying to build my app . this seems to be an issue related with the node environment itself and not next , but i was wondering if somebody has encounter something like this . i am deploying this site using plesk , and it seems as if plesk uses phusionpassenger to serve the app . < code > import react , { usestate , useeffect } from 'react ' ; ^^^^^ syntaxerror : unexpected identifier
i have this blog and the paths to the articles are /article/ [ id ] / [ slug ] . when generating the fetching the data from the api , only the id is used . what this means is that if someone accesses the page using the wrong slug , it wo n't return a 404 , instead it 'll regenerate the page , consuming more disk space . is there any way to avoid this ? < code >
hello there , i 'm new to next.js and would like to know if what i 'm thinking of is possible . basically , i want my index page to be a static landing page , benefiting from static pre-rendering and optimization , but i also want that same page to , when accessed by an authenticated user , display something completely different ( such as a dashboard ) . i know it would probably be simpler to just use a /app page or something of sorts , but i 'd like to know if this is possible and how it could be done . < code >
hi , i am developing a next-apollo package on top of next-with-apollo , with a slightly simplified interface . previously , the code of the package was living directly into a next app code ( see withapollo code ) . it now lives into a lerna repository ( see the new withapollo version ) . it relies on a process.env.next_public_graphql_uri to get the default url from config . however , now that the package lives into its own repo , it does n't benefit from next build time . i 've tried to setup next-transpile-modules without success , see my next config . what is the expected behaviour regarding process.env in 3rd party repo , and more broadly building modules that target next ? is what i am trying to do actually doable ? i 'd like to find solutions that requires minimal modification in the end-application , though i can accept adding something like next-transpile-modules . related : # 11106 # 9133 # 13532 possible lead : built code is looking like this : `` process.env.next_public_graphql_uri '' , e.env.next_public_graphql_uri ) '' . since babel is looking for process.env that may break it . i may need to publish my next package as a raw package and let next do all the building instead . < code >
hi , i suddenly started to get this error when using a dynamically imported component : assetsmapcontainer being the component that calls a dynamic component like so : the weird thing is that this issue appeared like 2 weeks ago , while this component is months old . i did n't update next ( v9.4.4 ) nor webpack ( v4.43.0 ) . did someone hit the same issue ? should i update next to 9.5 ? < code > const assetsmap = dynamic ( ( ) = > import ( `` ./assetsmap '' ) , { ssr : false } ) ; loading chunk 0 failed . ( missing : < url > ) chunkloaderror : loading chunk 0 failed . ( missing : < url > ) at function.requireensure [ as e ] ( < url > ) at function.fn.e ( < url > ) at _c ( webpack-internal : ///./src/components/map/assetsmap/assetsmapcontainer.tsx:55:30 ) at
because next.js works so differently when built , i test the using the flag `` production '' in my machine . the issue is that , because i 'm local and not in the production server i need to use the local addresses for external assets and data which results in me changing a couple of variables in my code to make that happen . i have n't pushed to prod with these variables changed , but i feel like it 's a disaster waiting to happen lol . what do you guys do to test builds ? thanks : ) < code >
since the revalidate feature is still experimental what would be an alternative ? it is said in the documentation to use getstaticprops for headless cms . however , when the data in the cms changes , you have to re-deploy the app to get the new changes every time . < code >
im creating a auth structure : web nextjs api rest express i have my login and submit button action with something like that : this method redirects me to index.tsx with the following code . the problem here its ca n't get cookies i tried with req.headers.cookie and req.cookies and none of those works . but in my devtools/network in login request , get a response with that cookie . my login endpoint in express . i hope someone can help me , or give me alternatives . < code > if ( user & & user.role ) { const token = jwt.sign ( { id : user.id , role : user.role } , config.secret_key ) ; res .cookie ( ' x-auth-header ' , token , { maxage : 60 * 60 * 1000 , // httponly : true , // secure : true , // samesite : true , } ) .json ( { user } ) ; else if ( ! user.role ) throw new error ( errorstatus.rol_error.message ) else res.status ( 404 ) .json ( { message : 'something went wrong ' } ) requesttoapi ( { data , url : '/auth/login ' , method : 'post ' } ) .then ( result = > { console.log ( 'result ' , result ) ; if ( result.status === 200 ) return else if ( result.message ) throw result.message else throw error ( 'error here ' ) } ) .then ( ( ) = > router.push ( '/ ' ) ) ..... export async function getserversideprops ( { req , res } ) { const cookies = req.headers.cookie console.log ( cookies ) ; return { props : { cookies : `` req.cookies '' } } ; }
hi there ! i have a api rest with expressjs and im trying to implement a authorization in pages with getserversideprops and a cookie sent by api rest , when login function is triggered in the response got the cookie , but when i refresh or redirect page the cookie disappear . note : i tried with a auth route in pages/api and it works , but i want to avoid it and do it directly from api rest remote . i hope someone can help , hint or show me a example . < code >
hey , first time here , just wanted to see if next js fits for my needs . suppose , i have a digital goods marketplace , i want to build it with next js , i can handle payments via stripe . now i wanted an option to provide users to download the `` purchased digital goods '' via next js . so , only purchased users will able to access the file ( check with stripe ) . otherwise gets an error . i will be hosting it in vercel . so , is it possible to restrict accessing files only for authenticated users ? let me know the details . thanks so much ! ~surjith < code >
this might be more of a webpack question , but if we have a wrapper around the fetch and it is used in both getstaticprops/getstaticpaths as well as in our client code , does this function get pulled into the client js file and still stay in the server side files ? is this done by webpack ? just trying to figure out if we have a logger for client and a logger for server ( that has a 'fs ' dependency ) , if i should create a decorator for the fetch function ( one for client logger and one for server logger ) and then use those individually . in order to avoid the 'fs ' errors on the client . < code >
hello ! lately i tried to use the redirects method on a ssg project ( using next export ) ... before i read more carefully nextjs documentation , and noticed then that those redirects ( as well as rewrites ) were `` only available on the node.js environment '' ... but as trailingslash is described as a redirecting method in docs , could someone explain to me the difference between both methods ? < code >
i have added the store in _app.js , simple like this : store is shared when navigating client side and initial store is provided when server side ( refreshing ) , what purpose is solved by with-redux example , ca n't wrap my head around it . i understand the working , but cant understand the purpose , when we can simple add redux in _app without creating store every time and get the same functionality . < url > < code > import { provider } from 'react-redux ' import store from ' .. /store ' export default function app ( { component , pageprops } ) { return ( < provider store= { store } > < > < p > i 'm on every page ! < /p > < component { ... pageprops } / > < / > < /provider > ) }
hello , i have a question . is it possible to separate ( isolate ) next.js ( let 's say in /src/client ) from express.js ( let 's say in /src/server , so that there will be 2 package.json and 2 node_modules , and the client ( next.js ) can be started independently in a different port than the server ( express.js ) ? i know next.js is server-side rendering , but it is still client stuff ( understanding `` client '' here as front-end development ) . i have already done all the isolating stuff , i got it working , but the problem i have now is how to allow express.js to manage the routes ( not defined before in the express.js server.js file ) by next.js . so when writing a single server.js file which initiates express.js with next.js we include this line : app.all ( ' * ' , ( req , res ) = > requesthandler ( req , res ) ) ; here requesthandler is a handler defined by next.js , but as i am not including or initiating next.js in this server.js file i would need something just like it is done with create-react-app and express.js ( which can be easily isolated ) : app.get ( ' * ' , ( req , res ) = > res.sendfile ( path.resolve ( __dirname , 'client ' , 'build ' , 'index.html ' ) ) ) ; regards , nestor llamas < code >
i can hard-code a runtime variable in next.config.js in publicruntimeconfig and it works fine . but when i try to pass an environment variable from process.env it 's always undefined . to reproduce publicruntimeconfig : { cmsbase : process.env.cms_base , } , `` start '' : `` cross-env cms_base= < url > next start '' function createapolloclient ( ) { const { publicruntimeconfig } = getconfig ( ) ; const cmsbase = publicruntimeconfig ? publicruntimeconfig.cmsbase : ' < url > ' ; this means that deploying onto multiple environments using docker/kubernetes would require a separate build for each env . is there a way to get this working ? < code >
i 'm using firebase-admin on server side , in getserversideprops i called a function from db.js called fetchusers , which looks like this : but because of hmr , this file will be executed more than once , so admin.initializeapp will be called multiple times , which cause a problem is there anyway to prevent a server side file to reload in dev environment ? < code > var admin = require ( 'firebase-admin ' ) const serviceaccount = { // ... } admin.initializeapp ( { credential : admin.credential.cert ( serviceaccount ) , } ) console.log ( 'executed==== ' ) const db = admin.firestore ( ) const fetchusers = ( userid , db ) = > { return db .collection ( 'users ' ) .doc ( userid ) .get ( ) .then ( ( docref ) = > { // ... } ) }
my project is based on nextjs 9 custom server . custom server is express v4 . i upload files through the multipart form to the server into /public/static/ folder by multer . in production mode i always receive response with 404 code for get-requests to just uploaded files . after server restart i receive response with 200 code for all previously uploaded files and 404 code for new uploads only . this issue does not exist in developer mode . problem is not present only if server.js contained : const nextapp = nextjs ( { dev } ) ; and server launch command is : < cur > nodemon server.js versions tested : os : ubuntu 18.04 and windows 7 x64 version of next.js : 9.4.4 and 9.5.3 version of node.js : 10.20.1 and 12.18.4 github project page < code >
hi all , i 'm new to next ( so far i really like it tho ) and currently running into a challenge i need to overcome . in my app there is a list of options a user can choose from . when a user picks one of the options a button becomes available and the user can go to the next page where a component is loaded based on the picked option now i want to write a test so i can test the flow and see if when option 1 is picked component a is rendered . so far i ca n't find any documentation on how to achieve that . i and the team i work in both do n't have any clue on how we could achieve this . is there anyone that can point us in the right direction where we can build on ? i 'm not looking for a complete code example but more a some pointers on how to set it up so i can learn from it aswel thanks in advance < code >
let 's say i have a file named utils.js , containing two functions s and c. s is a server-side function ( being called on an /api endpoint handler ) , and uses mongodb package . c is a client-side function ( will be bundled and sent to the browser ) . when compiling the app using next build , will it cause any issues ? does webpack know to bundle only part of a file/module ? ( considering server-side functions and imports as a `` dead code '' since they only being called from a server-side code ) thanks < code >
good day everyone , i 'm working on a website which fetches data from a headless cms . most of the website 's content is fetched from the cms . i would like to call the website semi-dynamic . : there is an article system which changes every time the client posts a new article . this component might change often . there are some tabular board member data which changes from time to time . this component changes occasionally . static content should be pulled from the cms as well , these components changes rarely . if i 'm using getstaticprops it only fetches on build time . does that mean i have to set up a cron job or something else , which restarts the server when the client is adding or editing content ? this seems quite cumbersome . according to the documentation , i can pass a revalidate to the return statement , by using this , i am able to fetch freshly updated content from the cms . is this the best way to achieve what i 'm trying to do ? i could of course use getserversideprops and be done with it , but it would be nice to reduce the amount of external api fetching for better speed . what are the best practices in situations like this ? < code >
bug report describe the bug i just started a new next.js project using yarn create next-app i then ran yarn dev within the generated folder and immediately get the error : referenceerror : react is not defined to reproduce run yarn create next-app choose a directory within the above project run yarn dev expected behavior the app runs without error system information os : macos browser ( if applies ) safari version of next.js : next @ 9.5.2 version of node.js : 12.14.0 < code >
i 'm using rewrites with dynamic routes , and it fires a `` unhandled runtime error '' . my folder structure is : and i want to access the brand page using /cars-audi instead of /cars/audi , that 's why i 'm using rewrites ( both next and vercel ) . then , on the brand page , i use getstaticpaths with fallback true and getstaticprops with revalidate . the problem is that the expected value of `` params '' is { brand : 'audi ' } , but it 's current value is { brand : 'audi ? brand=audi ' } and it is trying to fetch the wrong json file : < url > am i doing something wrong or it 's a bug ? thanks < code > async rewrites ( ) { return [ { source : `` /cars- : brand '' , destination : `` /cars/ : brand '' } ] } | - index.js | - /cars | - / [ brand ] export async function getstaticpaths ( ) { return { paths : [ ] , fallback : true } } export async function getstaticprops ( { params } ) { const res = await getbranddata ( params.brand ) const item = await res.json ( ) return { props : { item , notfound : res.status === 404 } , revalidate : 60 } }
bug report describe the bug when using a custom server the setpreviewdata function is not setting the cookies as expected . if next start or next dev is used the cookies will be set . to reproduce create a next site using a custom server . follow the instructions for preview mode visit the /api/preview route expected behavior the __next_preview_data and __prerender_bypass cookies are set . system information os : macos version of next.js : 9.5.3 version of node.js : 10.15.0 < code >
i 've been using next.js for a couple years and i 'd say the past year or so i 've had this problem of hmr and more recently fast refresh . when i load a page in the browser it does n't hook up to fast refresh right away . if i make changes it does n't do anything for about the first 5 minutes . then randomly it will kick in at some point . how can i start with debugging this ? nextjs : 9.5.3 docker for mac : 2.3.6.1 < code >
hello 👋 i would like to use a nextjs link inside a react portal , in next 9.4 it was working without needing to provide any context . in next 9.5 i got an error telling me that router is null within the link component . is there a provider i could import from the core component or someone has any other solution i could use to make is works ? 🙏 thank you ! < code >
hi there , i wanted to ask for help in solving this problem , here is what i 'm trying to do : serve up a public page with a dynamic route ( ex . [ id ] .js ) i wanted to get the client ip ( client side ) grabbing the slug ( [ id ] ) , i wanted to fetch data from an ip sending both the ip and the id to the api url . then rendering the page with the returned data - with open graph tags in the header for social media sharing . can someone suggest how i should approach this ? i took advantage of usestate and useeffects , but i can not get the final rendered to overwrite the html source , and it builds the static html with the first render pass . thanks in advance . < code >
when running the application , we have a search page that shows posts . we return the first 3 pages of post in the getstaticpaths so that we essentially build the first 30 posts during build time and utilize ssg fallback=true to dynamically build the other ones upon swr pagination . the interesting piece is the pages built during build time , even with revalidate on , build as an html file when viewing source with json config references to an index.json ( initiator of other ) . so the meta-tags are viewable in the view source of the page . for pages built dynamically with ssg fallback=true , two json configs are returned , one is the index.json ( initiator of main-xxxx.json ) and one is the .json ( initiator of .json ) . the meta-tag fields are n't viewable in the view source because they appear to be one of the json configs . so the concern is that some of our indexing hardward may not be able to index this meta-data since it is not viewable in the source . is there something we need to change to expose these meta tags into the html for a page even if it is built dynamically ? < code >
i am generating a site map during the build process next build . i need to run my script after next builds the .next . where/when do i run my script ? i thought it would go into next.config.js and override the webpack but not sure where to find the end of the bundle process . any advice or tips ? ! ! thank you ! < code >
node v14.10.0 npm v6.14.8 next v9.5.3 hi , after installing date-fns using npm im getting this error . i did not find anything relative to this . some clue would be really appreciated , is my first time using the framework . < code >
i have a relatively simple typescript-powered next.js application . i am attempting to use the with-typescript-eslint-jest example to add unit testing to my application . however , after implementing the example i get unexpected reserved word 'interface ' when running my first test because the page i 'm testing defines an interface . the example does n't seem to define any types or interfaces in the example page , so i 'm not sure if this is unsupported with the example configuration or if i 'm doing something wrong . any ideas ? < code >
hey folks ! with the code above , eslint complains that getstaticprops is `` missing return type on function '' based on < url > i can use getstaticprops as return type as : but now in { detail } : infergetstaticpropstype < typeof getstaticprops > detail has any type instead of mytype , as it does when i omit the return type . any clue ? < code > export const getstaticprops : getstaticprops = async ( { params } : getstaticpropscontext ) = > { ... } type mytype = { name : string } export const getstaticprops = async ( { params } : getstaticpropscontext ) = > { const req = await fetch ( ' ... / < cur > { params ? .alias } ' ) ; const detail : mytype = await req.json ( ) ; return { props : { detail , revalidate : 86400 } } ; } ; const test : nextpage < infergetstaticpropstype < typeof getstaticprops > > = ( { detail } : infergetstaticpropstype < typeof getstaticprops > ) = > { ... } export default test ;
bug report describe the bug i 've followed the first 5 steps of this tutorial , npx create-next-app -- example cms-wordpress cms-wordpress-app installed the wpgraphql & wpgraphiql plugins in wordpress content is already populated .env.local is setup : wordpress_api_url= < url > i run the command npm run dev , and i receive the following output : info - loaded env from /home/insightw/cms-art/.env.local { error : spawn enomem at childprocess.spawn ( internal/child_process.js:366:11 ) at spawn ( child_process.js:538:9 ) at object.fork ( child_process.js:113:10 ) at childprocessworker.initialize ( /home/insightw/cms-art/node_modules/jest-worker/build/workers/childprocessworker.js:137:44 ) at new childprocessworker ( /home/insightw/cms-art/node_modules/jest-worker/build/workers/childprocessworker.js:127:10 ) at workerpool.createworker ( /home/insightw/cms-art/node_modules/jest-worker/build/workerpool.js:44:12 ) at new baseworkerpool ( /home/insightw/cms-art/node_modules/jest-worker/build/base/baseworkerpool.js:82:27 ) at new workerpool ( /home/insightw/cms-art/node_modules/jest-worker/build/workerpool.js:30:1 ) at new jestworker ( /home/insightw/cms-art/node_modules/jest-worker/build/index.js:131:26 ) at new devserver ( /home/insightw/cms-art/node_modules/next/dist/server/next-dev-server.js:1:4580 ) errno : 'enomem ' , code : 'enomem ' , syscall : 'spawn ' } npm err ! code elifecycle npm err ! errno 1 npm err ! cms-wordpress @ 1.0.0 dev : next npm err ! exit status 1 npm err ! npm err ! failed at the cms-wordpress @ 1.0.0 dev script . npm err ! this is probably not a problem with npm . there is likely additional logging output above . npm err ! a complete log of this run can be found in : npm err ! /home/insightw/.npm/_logs/2020-09-15t05_44_03_910z-debug.log to reproduce see above steps expected behavior to receive an error/exit code of 0. system information os : linux cpanel version of next.js : 9.5.3 version of node.js : 10.15.3 < code >
hey , i just started using next.js and ca n't seem to figure out anywhere what the purpose of the /styles folder is . anyone can explain it to me ? i 've seen that there are multiple ways of styling your app - but i ca n't seem to find anything specific to this folder using google or the documentation . < code >
after adding trailing slash config in next.config.js , its adding trailing slashes for all paths . i have few resources in the public directory , i 'm looking for a way to not apply this configurations for the public directory . < url > < code >
so when using getserversideprops in next.js , the docs recommend not directly using fetch ( ) , but instead , importing the api endpoint function directly . i tried doing this , but got hung up when trying to incorporate my mongodb middleware . i end up with something like this : how could i refactor this in such a way that i could directly import this endpoint into my getserversideprops function ? or should i ignore the documentation suggestions and just use fetch ( ) ? i was thinking i could do something like like below , but i 'm not sure how to allow my getpost function to access the middleware db connection . and then in my next.js page : < code > const handler = nextconnect ( ) ; handler.use ( middleware ) ; handler.get ( async ( req , res ) = > { const post = await req.db.collection ( `` posts '' ) .findone ( ) ; res.send ( { post : post , } ) ; } ) ; export default handler ; import { getpost } from './api/post ' ; ... export async function getserversideprops ( context ) { return { props : { post : getpost ( ) , } } } export const getpost = async ( ) = > { const post = await req.db.collection ( `` posts '' ) .findone ( ) ; return post ; } handler.get ( async ( req , res ) = > { res.send ( { post : getpost ( ) , } ) ; } ) ;
i was going through the nextjs examples , and noticed that there was n't an example for workbox + nextjs basic implementation . they do have the next-offline usage here . can someone add or provide the basic implementation of workbox + next js ( both custom server and inbuilt nextjs server . ) seems a bit tricky , as workbox recommends to use webpack as a bundler , and am not sure if it 's needed here . am currently using inbuilt server ( next dev ) . cc : @ timneutkens thanks . < code >
trying to build an entirely static web app , i 'm facing an issue where some params in my page url are known at build-time , but some are n't . example : / [ lang ] /blog/ [ slug ] /edit . [ lang ] can be set when building the app and , as expected , changes i18n settings within the app . [ slug ] depends on which blog post the user is editing . the edit.js page looks exactly the same for every blog post : it 's a form with pre-filled inputs based on [ slug ] . it would n't make much sense to generate a slightly different .html file for each blog post - not to mention , that would amount to hundreds of pages . instead , i 'd like to fetch the post data by slug client-side , while still be able to pre-render i18n texts on the page . however , getstaticpaths makes setting both lang and slug params mandatory . is there a way to work around this ? in short , i would need [ lang ] to be statically set at build-time , but keep [ slug ] as a dynamic router param . < code >
when routing in client side next.js will trigger an internal api to generate a .json file with getserversideprops . is this json considered as safe ? for instance the consider the with-apollo example ( < url > ) . a route change in the client to the main page will generate a json like this : so this file is kind of public . the example would expose whatever the server side requests . on a page that is only accessible for authenticated user it could expose user-data wich is then cached somehow . so you could warm up the apollo cache as well as the user data on the server side : fetch cookie from req get userdata form private api return props including user-data and apollo cache but those values are then public . so is this json considered as safe ? or would you always re-create the cache on the client and reload user data ? is it possible to configure the lifetime from those json files ? < code > { `` pageprops '' : { `` initialapollostate '' : { `` post:30502c87-9c25-466f-95b1-50e5643d25dc '' : { `` id '' : '' 30502c87-9c25-466f-95b1-50e5643d25dc '' , '' __typename '' : '' post '' , '' title '' : '' twitter '' , '' votes '' :1 , '' url '' : '' < url > '' , '' createdat '' : '' 2020-09-14t13:46:58.873z '' } , '' post : ea32d5b2-9022-468a-bacb-fa1e6f3d2ac1 '' : { `` id '' : '' ea32d5b2-9022-468a-bacb-fa1e6f3d2ac1 '' , '' __typename '' : '' post '' , '' title '' : '' nextjs '' , '' votes '' :45 , '' url '' : '' < url > }
hello , i used to have a custom server with the start option like this : `` start '' : `` node_env=production node -- max_old_space_size=4096 server.js '' . now i am shifting to using next server . next start is there a way to increase memory for the nextjs server ? < code >
whenever a static file is requested from the server no matter what it is , the following error is getting logged to the server console : i realize this has to do with the fact that i have a dynamic route at the root level pages/ [ language ] and changing this from a dynamic route to a static one resolves the issue , i just do n't know if this is a normal behavior of next.js or how to go about it ! any help would be much appreciated 🙏 cheers ! < code > fetcherror : invalid json response body at < url > reason : unexpected token < in json at position 0 at /users/elia/desktop/schwebebahn/schwebebahn-fe/node_modules/next/dist/compiled/node-fetch/index.js:1:133590 at runmicrotasks ( < anonymous > ) at processticksandrejections ( internal/process/task_queues.js:97:5 ) at async getserversideprops ( webpack-internal : ///./pages/ [ language ] /index.tsx:490:19 ) at async rendertohtml ( /users/elia/desktop/schwebebahn/schwebebahn-fe/node_modules/next/dist/next-server/server/render.js:36:185 ) at async /users/elia/desktop/schwebebahn/schwebebahn-fe/node_modules/next/dist/next-server/server/next-server.js:76:329 at async /users/elia/desktop/schwebebahn/schwebebahn-fe/node_modules/next/dist/next-server/server/next-server.js:75:142 at async devserver.rendertohtmlwithcomponents ( /users/elia/desktop/schwebebahn/schwebebahn-fe/node_modules/next/dist/next-server/server/next-server.js:99:365 ) at async devserver.rendertohtml ( /users/elia/desktop/schwebebahn/schwebebahn-fe/node_modules/next/dist/next-server/server/next-server.js💯656 ) at async devserver.rendertohtml ( /users/elia/desktop/schwebebahn/schwebebahn-fe/node_modules/next/dist/server/next-dev-server.js:34:578 ) { type : 'invalid-json ' }
since unfortunately there is not a good way to setup i18n i am basically forced to use a custom server . but how bad is it to do that ? before deciding to use a custom server please keep in mind that it should only be used when the integrated router of next.js ca n't meet your app requirements . a custom server will remove important performance optimizations , like serverless functions and automatic static optimization . the docs do n't make it that comforting . is there ways to mitigate the damage ? < code >
hi : ) recently , i 've been struggling with setting up i18n with the next.js static export . ( namely the i18next library . ) what i 'd like to achieve ? i want to generate multiple versions of the app , one `` version '' per one language . i want to handle all the translations at build time . ( i 'd like to output static html files translated to different languages and do n't want to include the translation logic in the bundle which gets shipped to the user ) has anyone had any success achieving something similar ? the closest solution i found is < url > which is unfortunately only for plain html ( no jsx ) . < code >
hi all , please help , i need to use getstaticprops in order to read markdown files and parse them to react on build time . but my docs site is using material ui , so , as in this example < url > i need to use getinitialprops in _document to fix an issue with client/server css class names mismatch . if i try to do this i have an error , that i ca n't mix usage of getstaticprops and getinitialprops so i tried to just replace getinitialprops by getstaticprops in the _document and it 's not working . does anybody know that in theory , it 's possible to use ssr materialui altogether with getstaticprops or i should not even try and do n't waste my time ? previously i used preval for build-time data processing , so maybe i should get back to this approach instead of trying getstaticprops ? < code >
documentation states that i have to either use userouter or withrouter to access router and i ca n't find a way to use router outside of components . thing is , that almost all side effects are handled inside state management library and creating additional state and useeffect just for redirecting user to another page ( in my case - error page ) seem unnecessary . is there a way to use router outside of components ? i tried to import { router } from 'next/router ' , but got typeerror : router.push is not a function . < code >
i 'm using < url > but i do n't think it matters too much . i 'm trying to fetch a secret from vault using async/await but i get a promise { < pending > } what is the proper way to do this ? would a plugin help doing that maybe ? the problem is similar ( or even worse ) if i try to do this in server/config.ts , because it complains about top-level awaits . also asked here auth0/nextjs-auth0 # 167 and here < url > any really help very appreciated , cheers < code > // utils/auth0.js async function getsecretfromvault ( ) { const res = await client.fetchsecret ( ) ; console.log ( res ) ; // shows my secret correctly return res ; } const secret = getsecretfromvault ( ) ; console.log ( secret ) ; // shows promise { < pending > } export default initauth0 ( { clientid : `` my_id '' , clientsecret : secret // this will be invalid : ui shows `` client_id is required '' .... } ) ;
hello . i 'm looking for instructions on how to make a calltwo ( or more ) methods in getstaticprops ( ) but i have n't found anything . this is my idea . then what do you think about it ? < code > import react from 'react ' ; import { getstaticprops } from 'next ' ; import users from '~modules/users ' ; import brands from '~modules/brands ' ; import { usersdocument } from '~modules/users/users.graphql ' ; import { brandsdocument } from '~modules/brands/brands.graphql ' ; import { initializeapollo } from '~lib/apollo ' ; function home ( ) { return ( < div > < users / > < brands / > < /div > ) ; } export const getstaticprops : getstaticprops = async ( ) = > { const client = initializeapollo ( ) ; await promise.all ( [ client.query ( { query : usersdocument , } ) , client.query ( { query : brandsdocument , } ) , ] ) ; return { props : { initialapollostate : client.cache.extract ( ) , } , revalidate : 2 , } ; } ; export default home ; import react from 'react ' ; import { usebrandsquery } from './brands.graphql ' ; import { isundefined } from '~utils/isnil ' ; function brands ( ) { const { loading , data } = usebrandsquery ( ) ; if ( loading ) return < div > loading < /div > ; const brands = data ? .brands ; if ( isundefined ( brands ) ) return null ; return ( < div > { brands.map ( brand = > ( < div key= { brand.id } > { brand.name } < /div > ) ) } < /div > ) ; } export default brands ;
in the current with-apollo example , i 'm not able to access request headers during ssr using setcontext as recommended by apollo 's docs : what 's the best way to set up apollo client so that request headers exist ? < code > const authlink = setcontext ( ( _ , { headers } ) = > { // headers is undefined } ) ;
hi guys , i have a problem with reading file directories on vercel , i can read it without a problem on my local machine but i ca n't read it on vercel , it throws this error : and my code looks like this : < code >
hello . i like next.js and use it . i always want to improve the application to the best performance by researching the best methods . do you think i should import all css files belonging to third party libraries in '_app ' ? or what is the best method of this ? when i import this in this way , when opening index.html , all these css files i have added are added to the head . i think this also leads to unnecessary performance loss . thank you in advance for your comments . have a nice day . < code > // _app.ts import react from 'react ' ; import app from 'next/app ' ; import { router } from 'next/dist/client/router ' ; import { themeprovider } from 'styled-components ' ; import globalstyle from ' .. /components/global-styles/global-styles ' ; import { theme } from ' .. /const/theme ' ; import nprogress from 'nprogress ' ; import { animatepresence } from 'framer-motion ' ; import { getstores , storeprovider } from ' .. /stores/stores ' ; // third party librarys css files import 'nprogress/nprogress.css ' ; import 'react-datepicker/dist/react-datepicker.css ' ; import 'react-toastify/dist/reacttoastify.css ' ; import 'swiper/css/swiper.css ' ;
hi , i have api express server , and i want to get some data by getserversideprops from my api , and render them on my page . my question is i should call my api like : const response = await axios.get ( /api/questions ) ; and pass my data to props , or there is better way to do that . i think this approach is not ideal , because i am making extra request on server and my ttfb will increase ! < code >
< url > does n't talk about what it does for static generation ( /pages/p1 becomes /p1/index.html ) . seems strange , since that 's the most important thing it does ( at least from a beginner 's point of view ; the static stuff is much more important than the redirects using the next server ) < code >
we have a baseurl like `` /sample '' and a root level catch all [ ... slug ] .js that uses ssg with fallback=true . during build time , we build 18 blogs , and the static files get placed in the root of /.next/server/pages/ ( even though we have a basepath of /sample ) . then during runtime , when we hit a blog directly ( [ ... slug ] .js ) , the fallback=true file that is statically generated is put into /.next/server/pages/sample/ . so our build time files are placed in one directory , while our fallback=true runtime files are placed in the context of the baseurl ( sample ) . the application works , but the two directories have potentially duplicate files ( the only thing different is the configuration of the path within for the json file ) . has anyone else seen this ? < code >
hi . i want to remove custom server to api-routes and dont understand how do it . i have url api/auth/login and in custom server handle it like this authrouter i try create folder api/auth/login.ts and move authrouter to .ts file with default export but it doesnt work so , how to handle my case right with api-routes ? < code > authrouter.get ( '/google ' , getsocialauthhandler ( 'google ' , { scope : [ 'profile ' , 'email ' ] } ) ) ; authrouter.get ( '/google/callback ' , getsocialauthcallbackhandlers ( 'google ' ) ) ; authrouter.get ( '/fb ' , getsocialauthhandler ( 'facebook ' , { scope : [ 'email ' ] } ) ) ; authrouter.get ( '/fb/callback ' , getsocialauthcallbackhandlers ( 'facebook ' ) ) ; export default authrouter router.use ( '/api/auth/login ' , authrouter ) ;
speaking as a fairly new next.js user , the documentation i 'm looking for for firebase is : static files served by firebase hosting . non-static served by cloud functions . this is confusing : the goal is to host the next.js app on firebase cloud functions with firebase hosting rewrite rules so our app is served from our firebase hosting url . each individual page bundle is served in a new call to the cloud function which performs the initial server render . does n't sound like what i 'm looking for , since i think it 's saying that it 's going to serve everything from cloud functions . ( also , the phrase `` page bundle '' never appears anywhere else in node.js documentation . ) < code >
bug report describe the bug using a basepath configuration and navigating client-side using the link component , a url that matches the basepath is not recognised as the site root and the basepath is added to the url . this results in an incorrect url . to reproduce next config : pages/test.js : clicking the above link takes you to /docs/docs expected behavior the link component should recognise the href as being the basepath and therefore the site root and not add the basepath to the href . system information os : macos browser : chrome version of next.js : 9.5.3 version of node.js : 12.4.1 < code > { ... basepath : '/docs ' ... } import react from 'react ' ; import link from 'next/link ' ; const test = ( ) = > ( < main > < h1 > test < /h1 > < link href= '' /docs '' > < a > link to home < /a > < /link > < /main > ) export default test ;
i 'm trying to make the index of my app to be a default category at page 1 , if nothing matches my categories it should also go to the default category and load the first page , i do n't have a bunch of pages so i 'm also trying to generate all the pages for my categories with getstaticpaths . i 've read the docs trying to figure this out but they use a very simple example where you have a bunch of posts and you generate each post using static paths , when you have nested dynamic routes i 'm not sure how to achieve it , any help would be appreciated : / < code >
here is my blog react-login-form-typescript if you check the network tab on the chrome inspect you will notice the highlight.js is rendering the syntax on the run time . i want it to generate the syntax highlighter on the build time as it a ssg page . i am using markdown and react-highlight modules for the same < code >
when adding a rewrite like : the logs will show requests like < url > with unnecessary path query parameters , which next.js seems to add automatically . this is not directly harmful , but will make the logs harder to read . is there any way to disable this ? the docs do n't seem to mention it . < code > async rewrites ( ) { return [ { source : `` /api/ : path * '' , destination : `` < url > } ] ; } ,
hi everyone , i am playing around with incremental static regeneration on one of my projects where one of the main goals is to minimise calls to the database/api . i have an edit functionality on the project that allows users to update an entry on the database and then view the updated version on the next.js app ( which uses incremental static regeneration ) . so ideally , i would only want to re-generate that page when a user actually updates the entry corresponding to that page on the database . is there any way to `` manually '' re-generate specific pages , instead of re-building the entire site or incrementally regenerating with something like revalidate ? i am not entirely sure what the best path here would be , and i would appreciate any suggestions ! thank you : ) < code >
reference : # 12079 i 'm trying to integrate firebaseui in next.js , which comes with a css file . it can be acquired in two ways : < url > or via the npm package require ( 'firebaseui/dist/firebaseui.css ' ) ; doing require ( 'firebaseui/dist/firebaseui.css ' ) ; will not work since it does n't live in global space in the app . i do n't want it living in global space since not all pages require it . now , if i copy the css file directly and import it as part of a component , i get this error probably because it does n't fit the definition of a css module . sample component code : < code > import react from 'react ' import firebase from ' .. /utils/firebase ' import './login-options.module.css ' // configure firebaseui . const uiconfig = { // redirect to /signedin after sign in is successful . alternatively you can provide a callbacks.signinsuccess function . signinsuccessurl : '/signedin ' , // we will display google and facebook as auth providers . signinoptions : [ firebase.auth.googleauthprovider.provider_id , firebase.auth.emailauthprovider.provider_id , ] } export default function loginoptions ( ) { react.useeffect ( ( ) = > { // must be required here since this is server-side rendered const firebaseui = require ( 'firebaseui ' ) // initialize the firebaseui widget using firebase . const ui = new firebaseui.auth.authui ( firebase.auth ( ) ) // the start method will wait until the dom is loaded . ui.start ( ' # firebaseui-auth-container ' , uiconfig ) ; } , [ ] ) return ( < div id= '' firebaseui-auth-container '' > < /div > ) } syntax error : selector `` dialog '' is not pure ( pure selectors must contain at least one local class or id )
in an example project where we have a blog post built with [ ... slug ] .js , we have fallback true set and only build some posts during build time . many of the posts are built during runtime . the docs say this around fallback=true : when that 's done , the browser receives the json for the generated path . this will be used to automatically render the page with the required props . from the user 's perspective , the page will be swapped from the fallback page to the full page . at the same time , next.js adds this path to the list of pre-rendered pages . subsequent requests to the same path will serve the generated page , just like other pages pre-rendered at build time . i build 30 cards during runtime , but the rest are build dynamically with fallback=true . and the funny thing is some of the pages return .json every single refresh of the page along with the index.json , while others only return index.json . what is the expected behavior of fallback=true ? what resources should we see in the browser on the first hit , subsequent hits , and revalidate hits ? < code >
next.js/examples/with-typescript-eslint-jest/package.json lines 14 to 25 in ca986ab `` test-all '' : `` yarn lint & & yarn type-check & & yarn test '' } , `` husky '' : { `` hooks '' : { `` pre-commit '' : `` lint-staged '' , `` pre-push '' : `` yarn run type-check '' } } , `` lint-staged '' : { `` * . @ ( ts|tsx ) '' : [ `` yarn lint '' , `` yarn format '' if trying to install this example with npm/npx , it 's going to fail when committing due to yarn not found ( if you do n't have that ) . is there a way to make this compatible with both npm and yarn ? < code >
is there a way to make react refresh understand static function properties ? i am following the approach for persistent layouts suggested in the with-dynamic-app-layout example of putting a static layout prop on the default export . this works with fast refresh as long as the layout is imported from another file ( which is what the example project does ) . however , it does not work when the layout is defined in the same file : changing the background styles requires a hard page reload to take effect . < code > export default function page ( ) { return < h1 > page < /h1 > ; } function customlayout ( props ) { return < main { ... props } style= { { background : 'deeppink ' } } / > ; } page.layout = customlayout
i have both of my domain records ( with www and without it ) added to the domains list on vercel . and i 'm wondering if that 's a proper way to do it or there is a better one ? < code >
i am using _app.js to so that i can diplay navbar and footer to all the pages but i want to disable the for the login page and registration page _app.js import { userouter } from 'next/router ' ; function myapp ( { component , pageprops } ) { const router = userouter ( ) ; const { aspath } = router ; const nonav = [ '/login ' , '/registration ' ] ; return ( { nonav.includes ( aspath ) ? null : < nav / > } < component { ... pageprops } / > { nonav.includes ( aspath ) ? null : < footer / > } ) ; } the above example does does hide the nav and footer but the issure is with if the path is localhost/login ? sometext its displaying the navbar help willappreciated 🙏 < code >
the issue : getstaticpaths right now only works for actual routes like /blog/page/ [ page ] . i 'd like to use it with query params like /blog ? page=1 . solutions i considered : making the entire thing the param ( / [ blogwithquery ] - > /blog ? page=1 ) , but that would prevent me from putting another dynamic page at the root ( like / [ gender ] /products ) putting the query parameter into the route param ( /blog/ [ query ] - > /blog/ ? page=1 ) but that 's a bit unusual and i had clients complain about it . fetching pages dynamically or at run time , but that leads to slowdowns or worse ux . are there any recommended , or alternative methods for handling this ? < code >
i 'm about to use custom server way and project has ts for server ( db init too ) , js for browser ( react ) and run project with 'node server.js ' but i 'm consider how to build and how to run typescript imported by server . 'js ' because next build makes on .next directory < code >
any idea on how to approach this ? i managed to dinamically write all the urls but not sure how to make it use xml header since in _document.js it 's stating html . any ideas ? < code >
as using create-react-app , for very large react application , i intend to write all my future app in next.js , because it 's default built-in feature . my question is , when i was building very large enterprize app , i use redux for global state management . because there are lot 's of share state i need and redux is very good choice with big team . what do you people prefer , if you need to build very large web application in next.js where you have so many global data and need share state ? < code >
i have a page that uses getserversideprops . during dev time , this works fine . i expect the code to be executed for each page request , as an ssr page should . however , during build time using next build , my build fails because it seems like during the `` automatic optimization '' stage , next decides to execute my page code . this fails due to the fact that the page automatic pulls in my database and creates a connection . this is due to the fact that my database module roughly looks like : as a result , during build time , i fail to build my app because it can not connect to the database . why is this the case ? i would assume by opting into server side rendering i should n't be executing code during build time ? is there a way to mark this as such or do i have to create workarounds of initializing my database separate from import ? < code > import mysql from `` mysql '' const pool = mysql.pool ( { database settings } ) // the above fails because if executed during build time , there 's no database . export default pool
hey there ! i use playwright-community/jest-playwright to test my next.js site . their docs recommend using pagewaitforloadstatestate or timeouts to wait for page transitions . the problem with pagewaitforloadstatestate is that , if the page was n't built before next.js triggers the browser redirect after the build is completed . so the actual readystate is 'complete ' . this is indicated by the tiny ( and lovely ) triangle at the lower right corner . i could use a selector and wait for the div to disappear . but maybe it 's somehow possible to wait for the corresponding events written to the console ( [ fast refresh ] done ) . has somebody already invested time in this or has somebody a sweet solutions for this ? < code >
i do n't host my site on vercel ( at least , not this project ) , and currently , deployment involves packaging the next site into a container and deploying via kubernetes . currently , that build process involves generating an nginx container that serves all the static files and a nextjs container doing ssr . it works decently well . the one issue i have is that it does n't keep previous builds around , which means that if a user ( lets call him brian ) opens the site , i deploy a new version , and then brian tries to load a code-split ( code-splat ? what 's the past tense here ? ) piece of the site , it 'll fail because the build id is different . what are others doing ? conceivably , i could upload the builds to a cloud storage bucket and serve from that ( so that we do n't purge the old builds ) , but that would just grow in storage space over time ( or at least until someone goes and manually clears it ) . thanks ! < code >
hello all , so i have a static script i am including in the _app.js as so . this expects jquery to be present as < cur > . i have jquery installed on my application with npm , and i am using it elsewhere successfully with import < cur > from 'jquery ' . however how do i require jquery in the < head > before my custom.prism.js file is loaded so it is able to find and use the < cur > variable ? i understand i could just scrap jquery in npm and include it as above but i do like the idea of being able to use npm to upgrade jquery if i want . any input would be great . thanks chris < code > < head > < script type= '' text/javascript '' src= '' /static/custom.prism.js '' > < /script > < /head >
since next-mdx does n't support yaml frontmatter , why not expose the webpack config to allow extra loaders to be passed as a plugin argument ? like this : we can then use a custom loader function to extract frontmatter , add a default layout , or do other pre-processing . in my opinion , it 's a more flexible solution than relying on 3rd party plugins . example loader : here , layout is an hoc which takes the extracted frontmatter as an argument to define the default mdx layout . since the frontmatter is not exported as a variable from within the mdx , fast refresh still works . < code > // loader.js const matter = require ( `` gray-matter '' ) ; const path = require ( `` path '' ) ; module.exports = async function ( src ) { const callback = this.async ( ) ; const { content , data } = matter ( src ) ; const slug = path.basename ( this.resourcepath , path.extname ( this.resourcepath ) ) ; const frontmatter = { ... data , slug } ; const layoutpath = path.relative ( path.dirname ( this.resourcepath ) , path.join ( this.rootcontext , `` components/layout '' ) ) ; const mdx = 'import layout from `` < cur > { layoutpath } '' ; export default layout ( < cur > { json.stringify ( frontmatter ) } ) ; < cur > { content } ' ; return callback ( null , mdx ) ; } ; // next-mdx ... config.module.rules.push ( { test : extension , use : [ options.defaultloaders.babel , { loader : `` @ mdx-js/loader '' , options : pluginoptions.options , } , ... pluginoptions.additionalloaders ] , ...
my assumptions based on observations and documentation : next.js prefetches links in the view port by default . content changes in statically generated pages create files with new names based from hashes ( based on the content ) prefetched links reference the hashed content file names in the ssg files result : any content change in a page that is linked ( and prefetched ) at a header or footer level causes all pages created with ssg ( that use the header/footer ) to be new content essentially from the standpoint of page hashing and file names based on hashes . this means any site wide caching strategy ( based on hashing ) is busted when a common link ( prefetched and header/footer ) has a simple content change . this seems like a fundamental issue with prefetching based on hases , not a bug or issue that ca n't simply be solved . so if i am correct , what strategies are there to reduce this problem ? initial thoughts : explicitly disable prefetching on any next/link in a header or footer only . drawback lose prefetching on common landing pages etc . use hover/mouseover to trigger prefetching instead of in view port . < code >
hello , i 'm trying to implement next.js as part of a micro front-end . i 'm having issues getting around cors for the static files next js hosts . i 've got this inside my next.config.js which seems to work for the pages but not the static files .. example file not working : if anyone has done this or knows if it 's even possible please help 🙏 < code > access to fetch at ' < url > from origin ' < url > ' has been blocked by cors policy : no 'access-control-allow-origin ' header is present on the requested resource . if an opaque response serves your needs , set the request 's mode to 'no-cors ' to fetch the resource with cors disabled . vm272:1 get < url > net : :err_failed module.exports = { basepath : '/base ' , async headers ( ) { return [ { source : '/ : path * ' , headers : [ { key : 'access-control-allow-origin ' , value : ' * ' , } , ] , } ] } , }
i am trying to call a hook that grabs the data of an authenticated user . i cant seem do that anywhere in _app.js without getting an error . server errorerror : invalid hook call . hooks can only be called inside of the body of a function component . any suggestions < code >
hey guys , i 'm building an e-comm site at the moment and i have made an announcement bar component . nearly all of the site is ssg as products etc wont change very often . i am making an announcement bar component , that will fetch the latest news from headless cms via axios in useeffect hook . then on successful load will render the bar , which can be dismissed by the user . the only problem is , useeffect keeps firing when i navigate pages causing the bar to pop up again , despite having passed in an empty array . the announcement bar component is rendered within my layout component which wraps my _app component . so unless i 'm missing something it should n't be re-rendered for a page change . whats going on here ? any help would be greatly appreciated . < code > useeffect ( ( ) = > { axios .get ( ' phofurl ) .then ( ( res ) = > { setannouncement ( res.data.acf.message ) ; setshowannouncement ( true ) ; } ) .catch ( ( err ) = > console.log ( err ) ) ; } , [ ] ) ;
i have to update environment variable values from cmd but nothing working for me .... i tried following in cmd export api_base_url=my_url is there a way to do this .. can wwe update environment variable values dynamically from cmd ? ? thank you < code >
i 've been using nextjs for a while , but i still get this confusion . one thing that i could think of is when you want to serve html page with already filled data , it 's recommended to use getserversideprops ( am i right ? ) . and are there any other reason when to fetch in server vs client ? but after that , a question pop out again in my head `` when should i serve html with already filled data ? '' i think this question kind of out of nextjs scope , but i 've been thinking about this lately , if anyone could answer this , i really appreciate it 🙏🙏🙏 < code >
i have a large react codebase that i 'm hoping to open source via a reusable npm react package . the codebase uses next/dynamic strategically in several places to cut down on the minimal bundle size . my question is whether or not you know of any examples of using async imports with either next/dynamic or a similar solution from within an npm library that can then be consumed by next.js or any other webpack-based bundler ? one potential option would be to just use next/dynamic as a peer dependency in my library and require that anyone using the lib uses next.js , but that does n't seem ideal . btw , this is for an upcoming version of react-notion . < code >
hey everyone ! as a front-end developer who stumbled into figuring out the back-end , i wanted to create a resource to help others figure out which backend to use for their next.js ( or other front-end ) apps . you can check out the full post here . here 's a high-level summary : databases : postgres , mongo , fauna , dynamo , etc . apis ( auto-generated and custom ) : hasura , nhost , appsync , nexus , apollo . all-in-one services : firebase , userbase , supabase , amplify . db clients/orms , which includes prisma , typeorm , etc . it 's worth mentioning , for next.js specifically , you can use api routes in conjunction with some of these services , depending on how much of the backend you want to build yourself . < code >
hi , i want to share data between my getstaticpaths function and my getstaticprops function as described in : # 10933 the following answer : # 10933 ( comment ) mentions writing the data to file in getstaticpaths and then reading the file in getstaticprops . this works locally , but when i deploy to vercel , it fails because the generated file can not be found . when i run npm run build . i can see that the generated file is not copied to the out_publish method . is there a way to copy this file during the build phase ? < code >
i 'm learning next.js and ca n't resolve a problem with slow page loading in production with pagination . for some reason page loads for minimum of 2 seconds for only 2 posts that are called from wordpress rest api with low res image and title . app is full basic just for learning with no extra libreries . here is the demo page that i deployed on vercel : try clicking the next button to see slow performance < url > and here is my repo for this component : < url > // check out test.js does anybody know what am i doing wrong ? is there a better way to create pagination , maybe somehow with getstaticprops ? thanks ! < code >
hello , abount the revalidate attribute of getstaticprops there are some questions ? who can help me out ? 1 - whether the revalidate attribute has a default value ? if i do n't set it 's value , will the server continue to generate static pages instead of just generating pages once in the revalidate seconds , increasing the pressure on the server . 2 - the page re-generation timing . for example , when i set 10 seconds and the res data changed in 5s , the request within 10s was still using the cache page , and the new request after 10s updated the page data , then when did the page is re-generated , 10s later or 5 - 10s ? < code >
think about situation you set fallback true in getstaticpaths , for exmaple in this route : < url > ] / [ name ] the correct url is : < url > but user enters wrong url , for example : < url > so what should we do ? by default , nextjs will build this page . but we do n't want to build it , because of wrong name ! we want to redirect it to correct url . there should be a solution for this , because for each wrong url nextjs will build a useless file in disk . thank for your time . < code >
hi ! does anyone know of a good way ( or any way , really ) to fetch data so that it is globally available during static generation , without explicitly adding it to getstaticprops on every single page ? my use case involves getting translations and some configuration data from an api , and my attempts did n't work out so far . i considered doing 'something with webpack ' , or having a pre-build step to download the data before next kicks in , but maybe there are other options ? < code >
i 'm struggling with authentication in next.js . i would like to implement authentication with firebase , and this example helped a lot . but i would like to check for user authentication status when user opens any page , not just index as the example shows . and if the user is not authenticated , redirect him/her to auth page , else fetch from api server user profile and render the page . and this auth token is saved in cookie , or save as global state with user profile . i 'm used to react and still learning next.js , so please tell me if i got this wrong : do i have to implement a getinitialprops or getserversideprops in _app.js ? like : but getinitialprops is not recommended according to this document ? back in react , i used to wrap all pages with an < authcomponent > and do all the check auth thing in it . since it 's an spa , the auth only checked once , until page got refreshed or user log out . is this the same in next ? can i do this in next ? any instruction would be very helpful ! some example code would be better . < code > // _app.js ... getinitialprops ( ) { const token = checktoken ( ) if ( token ) { return fetchdata ( token ) } else { // redirect to auth page } }
i render products using getstaticprops on a page and i want to filter them with user navigator.language ( client ) . is it a possible way to do it ? what the best practice when you want to dynamically filter static data ? < code >
our server is kind of slow . doing ssr means calling the slow server and waiting for the data before being able to send bytes down the pipe . is there a mechanism to start streaming html response before getinitialprops is completed ? maybe http/2 push can help ? < code >
i 've read that the serverless build creates a tree-shaken production build with no dependencies on node_modules . i want to take advantage of this to slim down my production image for deployment in a gke cluster . i understand that i can run the serverless build with next start , which also means , in turn , that i should have at least nextjs installed on the serving image . nextjs is huge , though . something like 400mb+ ... surely not all of it is needed to serve the serverless bundles . is there a slimmer way to server the serverless build ? < code >
i was wondering if there is anyway to swap out to the react build for the profiling build version for a subset of users ? can i somehow switch the react build being used to the profiling build ? i would love to be able to use this feature described here : interaction tracing with react < code >
i would like to use in my next.js app a shared ui library based in styled-components . that library exports its own themes , themeprovider , components and behaviors . but until now , i 'm not able to configure properly since the library access de document , so i think it needs to be loaded in the client . i tried to use dynamic import , configure the _document with the serverstylesheet like styled-components docs , configure babel.config.js ( that i 'm far from an expert ) , and even create a component that checks if ( typeof window ! == 'undefined ' ) , but i 'm still getting document is not defined error t_t i was able to use styled-components , so my s-c configuration is right , but the ui library does n't work . is there something that i missed ? < code >
hey , i 'm using chakraui for my hybrid application which required me to add the < cssreset/ > component to my _app.js file to delete all default browser css styles . now i wanted to extend my app by a blog that uses static site generation with getstaticprops which get populated by markdown files . the problem : resetting the initial css with the < cssreset/ > component ( which i need for the rest of my app ) deletes all the markdown html formatting/styles . so my blog pages look like one single < p > tag because all the styles get removed . is there a way to not render that < cssreset/ > component inside my _app.js or to use the default _app.js when a specific path ( the path of my static site ) is being requested ? i do n't want to hardcode every single blog-page html because that would make the app pretty much unmaintainable . thanks in advance < code >
feature request allow to setup different lang attribute values to different pages , at build time currently it set on document and so is the same for all pages . is your feature request related to a problem ? please describe . indicate the language for the page is important for seo . chrome lighthouse report the lack of it . i ca n't set it up using client code but that is not the best away for all crawlers and it ca n't be done for amp pages . describe the solution you 'd like be able declare it in each page . if declared on the page should override the value defined at the document level . the logical place to place this functionality should be the meta module . < code >
feature request is your feature request related to a problem ? please describe . we have to proxy several routes to a 3rd party service like in this example : # 14057 ( comment ) this is working only in api routes and in next.js api routes reside only in pages/api/ directory . we need paths other than < url > to be server as api routes . describe the solution you 'd like probably config list in next.config.js containing a list of directories in pages/ that should be interpreted as api routes ? probably hoc that can be used like : i am open to other alternatives as well . describe alternatives you 've considered maybe we can use rewrites to change the api routes to desired paths , but - docs state rewrites are available only in node.js environment and we are targeting serverless build . thanks . < code > import { withasapiroute } from `` next-api-route '' ; ... export withasapiroute ( component ) ;
feature request is your feature request related to a problem ? please describe . if we want api not inside /page/api folder or mixin page and api in same folder we need use custom server < url > i hope can more easy control it , without config next.config and custom server describe the solution you 'd like export enableapirouter in any file will mark this file is api router page/my_api.ts describe alternatives you 've considered a clear and concise description of any alternative solutions or features you 've considered . additional context add any other context or screenshots about the feature request here . < code > export const enableapirouter = true ; export default ( req , res ) = > { res.statuscode = 200 res.setheader ( 'content-type ' , 'application/json ' ) res.end ( json.stringify ( { name : 'john doe ' } ) ) }
i have a react , next.js application that makes use of ts . i 've been deploying it using the serverless for next.js framework which deploys it to an aws lambda @ edge and also makes use of cloudfront . recently i wanted to add authorization in the form of aws cognito . i followed this guide and it worked well and my multi-page site was now sitting behind a cognito login . i 've now run into the problem where only my main index page loads fine . all other pages load differently as can be seen here via the chrome developer tools sources tab . vs another page . before adding the cognito authorization all my pages code in sources looked similar to the first screenshot . i dont know what 's caused this change , i 'm relatively new to aws as a whole and specifically cognito . i 'm also unsure of whether i potentially need to add something into the next.js project itself . any help or direction would be greatly appreciated . < code >
next/link error message should be more clear . i have hundreds of components with used . can not identify which is using just string in describe the solution you 'd like error should should where error occur , or offer a url with document to show how to find the components which string as child . < code >
hi , i just want to rewrite the example with-passport-and-connect by typescript , but i find in file lib/db.js have : but nextapirequest do not have seesion parameter , just want to know which class or interface have session ? < code > export function getallusers ( req : nextapirequest ) { // for demo purpose only . you are not likely to have to return all users . return req.session.users // just want to know which class }
hi . i try to create myself react components thats wrap mdc-component ( like this : < url > ) this is example of mdc component < url > each component is a separate repo . unfortunatelly , this works fine for example in storybook , but in next project this fail with this kind of errors : after several tests i found out that occur in first import from mdc-component that contains es6 code import { mdctabscrollerfoundation } from ' @ material/tab-scroller/foundation ' ; = > import { __assign , __extends , __read } from `` tslib '' ; // throws error why next.js not resolve this case of usage ? maybe something wrong with material-components library ? i tried in next.config but this is very strange and after that i have not see any errors , but component that i use not working correctly . any help ! please ! < code > const transpilemodules = require ( 'next-transpile-modules ' ) ; ... transpilemodules ( [ // add the name of your package here ... ' @ material/base ' , ' @ material/tab ' , ' @ material/tab-bar ' , ' @ material/tab-indicator ' , ' @ material/tab-scroller ' , ' @ material/dom ' , ] ) ,
please forgive my ignorance , or if this is a stupid question . in the following component the final return line is return data ? .posts . what does the question mark do ? append post if not empty ? and trying to google a question mark is not helping . also how do you add generalsettings to the return ? the following did n't work return data ? .posts.generalsettings return data ? { .posts , .generalsettings } component < code > export async function getallpostsforhome ( preview ) { const data = await fetchapi ( ' query allposts { posts ( first : 20 , where : { orderby : { field : date , order : desc } } ) { edges { node { title excerpt slug date featuredimage { node { sourceurl } } author { node { name firstname lastname avatar { url } } } } } } generalsettings { title description } } ' , { variables : { onlyenabled : ! preview , preview , } , } ) return data ? .posts }
bug report no error is thrown when an incomplete comment is put inside jsx style , compilation just idles describe the bug the incomplete comment before width hangs the compilation , once removed everything goes back to normal < code > export default function joboffercard ( props ) { return ( < div classname= '' joboffercard '' > < style jsx > { ' button { / * width : 62vw ; } ' } < /style > < button > { props.position } < /button > < /div > ) }
has anyone managed or thought of a way to document their api routes that exist in their app ? i know you can use swagger for express applications , and you can make jsdoc work to some capacity to create some documentation , but has anyone managed to find a solution that they like for documenting their api routes ? < code >
i have a problem adding styles to our amp version of our page using the native next.js implementation of styled-jsx on next.js version `` 9.5.1 '' . i am trying to add the styles on the _app level as global styles but i seem to encounter a few issues when it comes to amp . if i use < style jsx global > in the body as it is implied in the documentation and available tutorials , no styles are applied in the amp version of the page if i use < style jsx > the styles are applied but the page does not seem to be valid amp , since i get a message the parent tag of tag 'style amp-custom ' is 'body ' , but it can only be 'head ' from the validator . if i use the < style jsx > tag in in head no styles are applied on either amp or normal page if i do n't use the jsx flag and just try to use < style amp-custom= { isamp } > in head , styles are applied but the attribute seems to be striped from the tag so the amp page still does not validate . it seems to me there is no way to produce a valid amp page on next.js even though the native amp support is one of the main reasons we switched to it in the first place . can anyone help me produce a valid amp page using the native styled-jsx ? < code >
hi brilliant guys .. i want any code snippets by which we can add jwt authentication in few pages . e.g i have a login.jsx and profile.jsx . i want to open profile.jsx only when its has a valid jwt token .. additional if any one try to open profile.jsx from address bar ( without jwt authentication ) then they should be redirect to login.jsx < code >
bug report describe the bug i ca n't deploy my app on vercel with exemple with-yarn-workspaces there is an error at deployment when using monorepo deployment to reproduce steps to reproduce the behavior , please provide code snippets or a repository : run yarn create next-app -- example with-yarn-workspaces with-yarn-workspaces-app publish on github repository create new monorepo project on vercel ( < url > ) choose packages/web-app with next.js template click on deploy button expected behavior app deploy withour error screenshots i got following error just after deploy 11:52:54 | cloning github.com/lionel95200x/next-clone ( branch : master , commit : 25d0021 ) 11:52:55 | error : enoent : no such file or directory , stat '/tmp/qqamocoxu7dzrgl4xgvt/packages/web-app/node_modules/.bin/next ' system information os : [ e.g . macos , windows ] browser ( if applies ) [ e.g . chrome , safari ] version of next.js : [ e.g . 6.0.2 ] version of node.js : [ e.g . 10.10.0 ] additional information deployement succes when i am using vercel-cli on root project < code >
i set up my next.js project to reside outside of the website root . ( i placed it in /app subfolder ) . it all worked fine until i started to use dynamic routes for a couple of pages . i tried in three ways : < link href= '' /project/ [ project_id ] '' as= '' /app/project/project1 '' > which returns error error : the provided 'as ' value ( /app/project/project1 ) is incompatible with the 'href ' value ( /project/ [ project_id ] ) < link href= '' /project/project1 '' as= '' /app/project/project1 '' > which kind of works ( it navigates ) but it fails to preload next pages ( i get errors 404 - not found for pages linked like this ) < link href= '' /app/project/project1 '' as= '' /app/project/project1 '' > does not work at all . does anyone have an idea how to solve this ? < code >
bug report describe the bug getting this error when calling a custom hook : unhandled runtime error typeerror : invalid attempt to destructure non-iterable instance . in order to be iterable , non-array objects must have a symbol.iterator method . to reproduce steps to reproduce the behavior , please provide code snippets or a repository : added screen shots how i got the issue . expected behavior its a simple custom hook and it should work . screenshots if applicable , add screenshots to help explain your problem . system information os : windows browser- chrome version of next.js : 9.4.4 version of node.js : v12.13.0 additional context add any other context about the problem here . < code >
was trying to integrate storybookjs with the base tailwindcss example and was running into an invalid postcss config issue . took me a while to figure out , but i found the issue here . solution is below . do n't know if your goal is to try to keep all of the readme of the examples very narrowly scoped to the libraries involved , but it seems like storybook + tailwind would be a pretty common combo and nextjs using its special way of listing postcss plugins w/out require ( ) immediately breaks storybook , so maybe it could save people time to just make note of the fact that postcss with nextjs does this and integrating it with other libraries that do n't understand it could break and can be fixed by doing this . if this seems like something that would be merged in , then i can do it and create a pull request . otherwise just a suggestion that putting problem solving tips that pop up like this at the fountainhead of the template could save people some time . < code > // broken config module.exports = { plugins : [ 'tailwindcss ' , 'postcss-flexbugs-fixes ' , [ 'postcss-preset-env ' , { autoprefixer : { flexbox : 'no-2009 ' , } , stage : 3 , features : { 'custom-properties ' : false , } , } , ] , ] , } // fixed config module.exports = { plugins : { 'tailwindcss ' : { } , 'postcss-flexbugs-fixes ' : { } , 'postcss-preset-env ' : { autoprefixer : { flexbox : 'no-2009 ' , } , stage : 3 , features : { 'custom-properties ' : false , } , } , } }
when writing a generic navlink component , i have found that matching a links href and as props with the current route ( e.g . to set aria-current ) is a bit confusing with next.js . are these the equivalents between router props and link props ? const router = userouter ( ) linkprops ( already ensured to be urlobjects , not strings ) router.pathname href.pathname new url ( router.aspath , ' < url > ' ) .pathname ( as ? ? href ) .pathname router.query href.query new url ( router.aspath , ' < url > ' ) .hash href.hash < code >
hey everyone , i 'm wondering how you 'd include a message queue without your nextjs application . for example , i 'd like send email notifications once an action happened . the email notifications can be sent in the background , it does n't need to be blocking . at the moment , i 'm simply calling a lambda ( /api/notify ) and do n't wait for the response . i 'd be curious to hear best practices . thanks ! < code >
the docs seem to suggest that getinitialprops is no longer recommended for use . however , i do n't see any other way to accomplish ssr or direct page loads without remote calls for client side routing . i want to render user info for the currently logged in user in the header of my app and i want that to use ssr . however , i do n't want a remote request to be made for every single page load to get that details because it 's going to always stay the same and is already in my apollo cache after the initial server render . is there a more `` modern '' next.js way to accomplish this ? < code >
basic question , instead of running two applications/parts of the site in one project , we are talking about splitting the project out into two separate next.js applications . but if i am running two different next.js applications , can i do client-side linkage between applications ? < code >
hi ! thanks for maintaining this project 😄 my next.js-app throws the following error when i am using nextjs auth0 : 2020-06-21t12:31:15.731z undefined error uncaught exception { `` errortype '' : '' runtime.importmoduleerror '' , '' errormessage '' : '' error : can not find module 'next/dist/next-server/server/node-polyfill-fetch ' require stack : - /var/task/.next/serverless/pages/api/auth/me.js - /var/task/now__launcher.js - /var/runtime/userfunction.js - /var/runtime/index.js '' , '' stack '' : [ `` runtime.importmoduleerror : error : can not find module 'next/dist/next-server/server/node-polyfill-fetch ' '' , '' require stack : '' , '' - /var/task/.next/serverless/pages/api/auth/me.js '' , '' - /var/task/now__launcher.js '' , '' - /var/runtime/userfunction.js '' , '' - /var/runtime/index.js '' , '' at _loaduserapp ( /var/runtime/userfunction.js💯13 ) '' , '' at object.module.exports.load ( /var/runtime/userfunction.js:140:17 ) '' , '' at object. < anonymous > ( /var/runtime/index.js:43:30 ) '' , '' at module._compile ( internal/modules/cjs/loader.js:1133:30 ) '' , '' at object.module._extensions .. js ( internal/modules/cjs/loader.js:1153:10 ) '' , '' at module.load ( internal/modules/cjs/loader.js:977:32 ) '' , '' at function.module._load ( internal/modules/cjs/loader.js:877:14 ) '' , '' at function.executeuserentrypoint [ as runmain ] ( internal/modules/run_main.js:74:12 ) '' , '' at internal/main/run_main_module.js:18:47 '' ] } unknown application error occurredruntime.importmoduleerror everything works fine when running locally with dev and build/start . i had this issue last week . then it ( confusingly ) disappeared when i added .github and .vscode to .vercelignore . however , it reappeared a couple days ago . i 'm using next 9.4.4 , but i have tested with 9.3 as well . furthermore , i 'm running node 12 , both locally and on vercel ( through engines in package.json ) has anyone experienced something similar ? any help is very much appreciated ! < code >
bug report describe the bug when updating the query params of a route using the following code the page scrolls to the top , and causes a `` refresh/rerender '' a clear and concise description of what the bug is . to reproduce steps to reproduce the behavior , please provide code snippets or a repository : create a page which is longer then your screen update query params progammatically expected behavior i would expect the page not to rerender , stay in the current scroll spot and update the query params without any extra things going on screenshots if applicable , add screenshots to help explain your problem . system information os : macos chrome version of next.js : 9.3.4 version of node.js : 12.x < code > router.push ( '/jobs ? < cur > { query } ' , '/jobs ? < cur > { query } ' , { shallow : true , } ) ;
currently the error overlay is using the same root as next.js root directory . this works in most cases but when next.js is running in a container and files are synced to the container from a local file system the links to `` open in editor '' do not work anymore . suggested solution we can add an additional optional configuration for where the actual source is located at and pass down this information to the the middleware where the path to open in editor is computed : next.js/packages/react-dev-overlay/src/middleware.ts lines 138 to 141 in f1c4cb8 const filepath = path.resolve ( rootdirectory , getsourcepath ( sourceposition.source ) ) i can work on this change if sounds good ! < code >
hi , im trying to create an next app but with multi example , like this create-next-app -- example with-next-i18next with-next-sass with-next-seo next-learn i got this error could not locate an example named `` with-next-i18next '' . please check your spelling and try again . but i want multiple examples , is that possible ? thanks in advance carlos vieira < code >
hello . i am having problems when deploying to vercel . my public directory is at src/ ( just like pages/ ) , working well in local build . however , when i deploy to vercel , i have to move my public directory to the root of my project or else the requests will fail with a 404. thanks in advance . < code >
i 'm having a lot of indexing problems thanks google and his mobile friendly test checking tools . all the problems are related because it can not load the files . the exact error is page partially loaded the problem url is : < url > but after researching i 've seen this happen to many people even i have reviewed large companies where they have made pages with next.js and i 've gone through the validator and have the same problem . they do n't finish loading the files . nike < url > hulu < url > so my question is simple , is it possible to have the option to generate a single javascript file instead of a bunch of js file . i think that having only one file can solve the loading problems . what do you think ? < code >
hey all , i 'm running next.js in a node:12 docker container . i 'm noticing that my index page ( / or pages/index.js ) is not being generated during production builds . it is however being generated during development builds . i 've searched google and other discussion posts under this repo for the source of my issue to no avail . my production environment ( node_env=production ) is being started with next start . my development environment ( node_env=development ) is being started with next dev ( node_options= ' -- inspect=0.0.0.0:9229 ' ) . fwiw i 'm able to run my app on my host machine in production mode without issue . my code can be found here : < url > any suggestions what i might need to change ? < code >
hey there , my website has a slick-slider which is not full screen at this moment . i want to do it full screen . so when i inspect the website i can see this code ; @ media ( min-width : 768px ) .col-md-9 { flex : 0 0 75 % ; max-width : 75 % ; } this code comes from global.css which i dont have it in my theme folders . when i change max-width to 100 % on inspect slider becomes full screen when i paste this code to my css file nothing happens . how can i mport this code to my css ? thanks . < code >
from the get go the starter i 've been using has been configured with typescript and as my project has developed i 've decided against using it .. this was fine at a component level in which i converted pages/comps accordingly however since attempting to do so with _app.tsx and _document.tsx ( into _app.js and _document.js ) i 'm receving errors regards finding the respective pages with their .tsx extension .. cmd+f does n't seem to resolve where these files are being called and thus why im asking if the community know of a way in which i can turn off typescript ? < code >
hi , curious if what has been done here in the preact example : < url > would also work for e.g . component libraries . commonly , their code is re-used across at least multiple pages if not all , so it would n't make lots of sense to duplicate that code . however although this optimization seems easy to execute considering there 's not a lot of code to alter , in my tests it always led to more or less the opposite : the entire component library is included in all bundles individually . so my assumption is that this optimization just ensures that the entirety of matching modules will be marked as externals , without any tree shaking happening , which would already defeat the point of doing this for component libs as you basically never use the entirety anyways . ideally , i 'd like to see this : / uses button and link /about uses button and heading thus no code for button , link or heading is within a page bundle , but only the required code for those 3 components is within a shared bundle . this comes at the cost that a user initially has to load components he does n't even use yet , which i 'd consider a worthy tradeoff that has to be evaluated on a per-project basis . if your landing page is very simple , you might not want to download all the components hidden behind a login , e.g . any help here is appreciated ; if this is possible , it will be included in the docs for @ chakra-ui v1 < code >
so we deployed the dev branch of our site at dev.ourapp.io . our start script is : but i noticed something strange with jss ( css in js ) . is my configuration wrong ? ( works fine with next start or next dev ) < code > { `` start '' : `` node_env=development next build & & node_env=development next start -p 80 '' }
hello ! i 've used next.js in side projects and have been impressed at how quick it is when developing locally . i 'm wondering how well the local development experience scales as a codebase gets large . imagine dozens ( or hundreds ? ) of pages with contributions from a variety of engineers . if you use next.js in a large codebase , i 'd love to know : how many pages does your project have ? how long does it take to boot up and load the homepage ? how long does it take for a change to a file to appear in the browser ? thank you ! < code >
i am using next.js 9.5 in my project . i have use case to support urls with and with out trailing slash e.g < url > and < url > should return same content . from documentation it seems like only either of them is supported . is it possible to support above usecase ? < url > < code >
next.js question . hey , i am working on implementing auth for a site and the auth provider instance that i have to work with relies on browser storage being present in order to function properly . every time that i import this module however i get errors related to the window not being present . i figured that i might try the dynamic import function provided by next and use the ssr : false option but that dynamic function clearly expects to work in conjunction with a module that exports a react component . does anyone have an idea of how to import a module that relies on the window that is n't a react component ? < code >
im using next 9.5.3 and when using trailingslash : true option then all pages in my all going to redirect with trilling slash . but i want to redirect some of the pages not all how can i get that . < code >
the company i work for is looking into aws and would prefer to manager everything through aws . is it possible to use incremental builds/static exports with aws ? < code >
hello . note : this is a very minor bug and i 'm not fully convinced this is actually a bug or if i am misunderstanding how it works . bug description : static optimization indicator is not showing up for pages which are qualified for automatic static optimization but include dynamic route on their routing path . to reproduce image we are trying to create a hello world app with support for i18n . so i created the following structure : pages - > [ locale ] - > hello.js ( whereas `` [ locale ] '' is a directory ) if i go to '/en-gb/hello ' i expect to see a message in english or if i go to '/pt-br/hello ' i expect to see a message in portuguese important to note i 'm providing all the possible language values through getstaticpaths ( ) method . i 'm providing the messages through getstaticprops ( ) which depends only of the locale param value . i can export the application normally to static files and i have tested it using a simple http server and worked normally . screenshots next export output the code static optimization indicator not appearing i know this is not very important , i just want to make sure i have understood it correctly . thanks . < code >
describe the bug i feel like i miss something , but when i import a custom script ( which itself import the node-persist module as follow import storage from 'node-persist ' ; ) i have the following bug i do this import ( the custom script ) in order to use an async function in getserversideprops . to reproduce just import node-persist in a page . expected behavior should be able to import a custom script importing `` server side '' modules itself ( i say server side because it handles files ) . system information everything is to the latest version . `` next '' : `` 9.5.2 '' , `` node-persist '' : `` ^3.1.0 '' , < code > error - ./node_modules/node-persist/src/local-storage.js:6:0 module not found : ca n't resolve 'fs ' null
we are trying to run a website on account/product . and in this case using traefik 's reverse proxy to point the url to : visiting the /account/product url gives a 200 but all the assets in /account/product/_next/ * keep giving 404 errors . what are we doing wrong ? extra info : we need to point this application using path ( `` /account/product '' ) because other applications are running on / . < code > - 'traefik.http.routers.product-frontend.rule=host ( ' < url > ' ) & & path ( '/account/product ' ) ' const nextconfig = { basepath : '/account/product ' } ;
hi , i have a simple next.js project . i am using next/head . i want to publish it on traefik as a docker container . i am getting bad gateway error . how can i fix this error ? dockerfile .dockerignore server port is 80 on traefik 's docker-compose.yml - `` traefik.http.services.simple-nextjs.loadbalancer.server.port=80 '' < code > .next/ node_modules/ .git .gitignore dockerfile from node:12.18.3-alpine3.12 copy . /app workdir /app run npm install run npm run build expose 3000 cmd [ `` npm '' , `` run '' , `` start '' ]
i 've started writing an application following the with-relay-modern example , and the withdata hoc works for fetching data , and the relay store is properly hydrated on the client side , but the ui does n't appear to update when mutating the store . i have written a simple updater that looks like this : this works , i have confirmed from the debug statement at the bottom that the local object that my ui is built from was successfully updated , but my ui does n't refresh . i noticed that the example does n't actually include a queryrenderer anywhere . is n't that required for the view to update when the store changes ? if somebody could confirm that the example does n't actually work when mutating the store that would be immensely helpful , because otherwise i 'm completely lost as to why my ui is n't refreshing ... < code > function updatestore ( store : recordsourceselectorproxy , forminstanceuuid : string , ) { const mutation = store.getrootfield ( `` updateformvalue '' ) ; const newformvalue = mutation ? .getlinkedrecord ( `` formvalue '' ) ; if ( ! newformvalue ) { throw `` expected new form value from server '' ; } const localforminstance = store.get ( forminstanceuuid ) const localvaluerecords = localforminstance ? .getlinkedrecords ( `` values '' ) || [ ] ; for ( const record of localvaluerecords ) { if ( record.getvalue ( `` partuuid '' ) == newformvalue.getvalue ( `` partuuid '' ) ) { console.log ( `` copying fields from server provided value to local value '' ) ; record.copyfieldsfrom ( newformvalue ) ; } } console.debug ( `` new state of store : '' , initenvironment ( ) .getstore ( ) .getsource ( ) ) }
when running node_env=production next build with node 10.22 on our ubuntu ci build agents we 'll occasionally hit the following error when building : we use @ zeit/next-css ( for global css in node_modules/ ) and styled-jsx with styled-jsx-plugin-sass and styled-jsx-plugin-postcss so i 'm wondering if it may be something related to node-sass ? curious to hear if anyone else has hit this before . research on this particular error has n't turned up anything very obvious so far . edit : forgot to mention this is with next @ 9.4.4 < code > node [ 30966 ] : .. /src/node_file.cc:995 : void node : :fs : :fstat ( const v8 : :functioncallbackinfo < v8 : :value > & ) : assertion 'args [ 0 ] - > isint32 ( ) ' failed . 1 : 0x8fb090 node : :abort ( ) [ node ] 2 : 0x8fb165 [ node ] 3 : 0x93a08a [ node ] 4 : 0xb917ef [ node ] 5 : 0xb92359 v8 : :internal : :builtin_handleapicall ( int , v8 : :internal : :object * * , v8 : :internal : :isolate * ) [ node ] 6 : 0x1bb66215be1d
hi all , i have got one free admin dashboard . < url > and they have for react too < url > as i am new to both react and nextjs , i am not able to decide which template will be much easy to implement react or plain bootstrap . if you guys have any free nextjs admin template please mention . < code >
hello everyone , i want to ask about static generation pages , i just work on a project with streaming data from firebase . can i use static generation for production ? or i should use server-side rendering ? thanks < code >
hi , i have a requirement where i 'll be having 7-8 pages as static and blog which can be easily built with nextjs and i have done the tutorial for the same . along with the static website , there is a dashboard which is user-specific and it contains dynamic data , with user authentication . i 'm not able to find any tutorial which can cater to these requirements . i want to use strapi as rest api to display the dashboard . < code >
hi ! anybody know if is possible with either nextjs or with now to do a redirect from something like pages/blog/ : id to pages/ : id but for multiple pages , and by multiple pages i mean having pages/blog/ : id , pages/categories/ : id and then redirect all to the root pages/ : id i did this by creating a [ slug ] .js inside my pages and then there dynamically check which component to show depending on the slug but the problem with that approach is that there is no way to respond with a 404 when a page is not found when using fallback : true this is a follow up of # 10960 < code >
i tried to reuse the with-redux-thunk example . in these pages pages/ [ pageid ] /index.js pages/ [ pageid ] /show-redux-state.js looks like redux state is lost in dynamic routes . < code >
hi , i 'm trying to use data from an api but my data does not render in the browser . this is my first foray into react so i 'm not sure what i 'm missing . would somebody mind pointing out my error please ? the below also console.logs as expected . < code > export default function home ( { items } ) { console.log ( items ) // items listed in the console fine return ( < ul > { items.map ( ( item , index ) = > { < li key= { index } > { item.description } < /li > } ) } < /ul > ) } export async function getstaticprops ( ) { // get data here return { props : { items } } } ; export default function home ( { items } ) { return ( < ul > { items.map ( ( item , index ) = > { console.log ( item.description ) ; < li key= { index } > { item.description } < /li > } ) } < /ul > ) }
hello everybody , so here 's my problem , i 'm using a headless drupal as an api for a next/drupal boilerplate project , and i am trying to figure out a thing or two . back in november 2019 , it was announced that getstaticpaths could not be nested one into another , but i really need to achieve it ( and maybe since then it is somehow feasible ) . for now , my routes look like this : in my index.js , i fetch all the content types that exist on the api ( like article , page , event , etc ... ) and generate a `` main '' view listing all the nodes . in [ slug ] .js i would like to retrieve the [ type ] value in order to use it in the fetch that is used to retrieve every single node from my content type and feed the paths of getstaticpaths . the thing is , there is no params to get in getstaticpaths even if the page is one level below it . is there any hack to get this upper-level param ? i tried using the router in order to get the path but of course , since we are generating a static build , the router is null at this specific moment . thanks in advance , < code > pages | -- [ type ] | | -- [ slug ] .js | -- index.js
just upgraded to next 9 and started using the dynamic routing from the package . awesome work ! one thing that 's throwing me for a loop is the files coming out of this situation : pages/blog/ [ slug ] .js - > out/blog/post-name.html pages/blog/index.js - > out/blog.html this is a bit confusing to me because when i use npx serve out or npx http-server out neither of them will render < url > they 're looking for /out/blog/index.html which is not being created . my /blog/index.js source is being exported as blog.html which is not one of the fallbacks for either of the basic , static-file servers . is there a config option i can set , or a getstaticpaths configuration i can give , or something else entirely ? < code >
evening ... i want to be able to build a pagination component that is statically generated for each paginated page ... i.e projects/ , projects/1 , ... etc at the moment , only currentpage page from the params object is available in getstaticprops . without totalpages , and postperpage i ca n't see how i can build a pagination component . i could make the same request in getstaticprops , but this feels icky . cheers dave < code > export async function getstaticpaths ( ) { const data = await gqlclient ( ) .request ( pagesquery , { skip : null , first : null , } ) const postperpage = 10 const { projects } = data const { length } = projects const totalpages = math.ceil ( length / postperpage ) const paths = array.from ( { length : totalpages } ) .map ( ( _ , i ) = > ( { params : { currentpage : ' < cur > { i + 1 } ' , totalpages , postperpage } , } ) ) return { paths , fallback : true , } } export async function getstaticprops ( { params } ) { const currentpage = params ? .currentpage || 0 const postperpage = 10 // // ideally params.postperpage // this request seems a bit wasteful , this data could be // passed from getstaticpaths const data = await gqlclient ( ) .request ( pagesquery , { skip : currentpage * postperpage , first : postperpage , } ) return { props : { data , currentpage , totalpages : ? ? ? ? ? } , } }
in .next/static/chunks/ i have some chunks named [ int ] . [ hash ] .js and others named [ hash1 ] . [ hash2 ] .js . what is there difference between these ? < code >
hi all , i 'm currently struggling with error pages , specifically 404 errors . at the moment if a page that does not exist in my application is requested , the user is directed to /pages/404.js , as they should . however , if i have a catch-all route like /pages/posts/ [ slug ] .js , i am unable to show the same 404 page i mentioned above . i 've looked all over but for some reason there seems to be absolutely no information on how to achieve this . resources i found that did n't help : # 746 < url > # 10960 # 11644 at the moment i 'm able to return a 404 error , but this is displayed as the browser 's default error which does n't look very professional . this is the code for achieving that : is there any way to both return a 404 state as well as showing a custom error page ? < code > export const getserversideprops = async ( { res } ) = > { res.statuscode = 404 res.end ( ) ; return { props : { error : 'oops ' } } ; } ;
i am severing my app on an s3 bucket and pre-rendering using npm run export . does setting the build target do anything for my static app ? thanks ! < code >
when i make code changes in the server ( e.g . a console.log statement ) and ran npm run dev , the console.log would not display on the console . but when i remove the console.log and run npm run dev , the console.log is displayed . i 've also attempted to use rimraf to remove the entire .next folder before running the npm run dev . though the folder was removed and then re-created after the build , the supposedly removed console.log still appeared on the console . how can i prevent this behavior ? it is currently confounding the development experience . fwiw , i 'm also using : next connected custom express server the getinitialprops static method next.js version : 9.3.0 os : windows 10 < code >
notice : this has been solved , as the original post was about a possible deletion of an issue . turns out the issue was moved to discussions without notice . i made a very long feature request a few days ago , full of examples , descriptions and quality of life improvements for developers . it got a few thumbs up in the very first hours and no comments . and apparently it got closed ... i mean deleted ! there 's no trace of it . not a single line of feedback or comment . i spent around 2h writing the examples and text and gathering information for it . i completely think that an issue marked as a `` feature request '' should not be treated as such , specially after people marking it as `` thumbs up '' ? am i missing something here or what ? ca n't you guys simply say `` hey we 're not interested in this nor we 'll be building it '' ? what 's the point in deleting an entire handcrafted issue from the repo otherwise ? are n't you interested in people 's feedback ? < code >
when next/link does client-side navigation , everything that falls under/inside the page component subtree gets re-rendered . for example , consider these two pages : and according to react docs , because that div changes to p , the whole subtree below div or p is discarded . it will never be compared with the diff algorithm . but this means that wrapper and sidebar will not be re-rendered . for example when user is on page1 , and made an action that results in a state change in the sidebar component instance , it should retain that state when they move to page2 on client-side navigation with next/link , given that sidebar props never change . however this is not what happens . everything is re-rendered when clicking the next/link ( except these elements in _app.tsx , above the page component ) is that intentional , and the right thing to have ? < code > < wrapper > < sidebar / > < p > page2 < /p > < /wrapper > < wrapper > < sidebar / > < div > page1 < /div > < /wrapper >
hey all , we 've got a few next apps within a monorepo , and we run jest from the root of that repo to run tests for all of those apps . our tests use react-testing-library ( rtl ) . we 're using next 9.5.2. i 'm trying to replace the older publicruntimeconfig with the more up-to-date environment variables as suggested in the docs , which is working fine when running the app , but it 's broken all our tests . for example , our api path is set with process.env.next_public_api_path , but when we render a component directly with render from rtl , the api path does n't get set . since we are n't running the next build process when testing with rtl + jest , the environment variables do n't get substituted for the real deal ( so .env.test does not work as suggested in the docs ) . i 've tried to set the env vars explicitly in the test files , but this still is n't working - everything is coming through as undefined . is there another way to do component testing while still using next 's environment variables ? should i just go back to using publicruntimeconfig if i want to use react-testing-library ? thanks ! < code >
we have problems getting redirects to work if the redirect.source url matches an already existing express route . given the following redirect rule in next.config.js : and the following server.js the redirect from /foo to /foobar only works if we remove this route to me it seems like redirects only happen after route matching and only if it does n't match an already existing route . this seems a bit weird to me , can someone shed some light on if we are using redirects in the wrong way ? < code > server.get ( '/foo ' , ( req , res ) = > { return app.render ( req , res , '/foo ' ) } ) async redirects ( ) { return [ { source : '/foo ' , destination : '/foobar ' , permanent : true , } , ] } , app.prepare ( ) .then ( ( ) = > { const server = express ( ) server.get ( '/foo ' , ( req , res ) = > { return app.render ( req , res , '/foo ' ) } ) server.all ( ' * ' , ( req , res ) = > { return handle ( req , res ) } ) server.listen ( port ) } )
i would like to have the ability to share static props obtained through getstaticprops between multiple pages . in my case , i have a dynamic route with around 20 different pages that fetches exactly the same data from a salesforce api . i would like to be able to fetch it just once to reduce my build times and api quotas spent . < code >
the class name in the css file is modified , resulting in a match that does not match the classname property on the label . css , classname i want to define the classname style that is common to all pages . classname _app the global style imported in .tsx and do not want to convert the style of the css file to a random name . _app.tsx , css when you import a third-party library css style , the style inside is also converted to a random name , resulting in a missing mismatch . css , , < code >
as title states , i would like to check out browser logs from appearing on the terminal , so it can show just server-side logs ( logs made in getserversideprops , api routes , etc ) . is there a config option to achieve this without much tinkering ? thanks in advance . < code >
i want to run my project in production mode in centos server , when i run next build & & node_env=production node -r dotenv/config index.js command , and getting some errors in application , app will be crashed for everyone and all static files in .next/static directory will be removed . so we need to run that command again ! question : in witch situation static files in .next directory will be removed automatically in production run ? and how i can prevent that ? < code >
bug report describe the bug we are deploying our next project using npm run build and npm run start . it works fine on all browsers . when all cookies are disabled the browser returns net : :err_aborted 404. for js and css files ( slug.js , _buildmanifest.js and chunk.css ) some files return 200 and some return 404. to reproduce npm run build npm run start steps to reproduce the behavior , please provide code snippets or a repository : disable all cookies in chrome , npm run build and then npm run start ... expected behavior we expect the application to load properly on a browser where cookie is disabled as it is loading on a browser where cookies are enabled . screenshots system information os : [ e.g . macos , windows ] browser ( if applies ) all browsers version of next.js : 9.4.4 version of node.js : 13.5.0 additional context < code >
bug report describe the bug server is unresponsive in dev mode . requests are pending forever and get cancelled . in `` production '' mode it works fine . updated from 9.4.6 i use next-pwa screenshots system information os : macos browser chrome version of next.js : 9.5.2 version of node.js : 10.15.0 < code >
i am very new in next.js comming from a react spa and apollo-server background . there are some questions that i have that would help me to jump into next.js how can i get session cookies in a next.js server ? ( something like express-session ) how can i get apollo-server into next.js and inject the context with the req.session.id ? when do you need/recommend to add a custom server to next.js ? it looks like next.js does not need that but i would like to know if there are some use cases and what they are . i also do not understand why you loose optimization if you use a custom server , because your custom server just gets the request first and then pass it to your next.js portion . i hope you can help me with these questions , thanks ! < code >
i 'm using the next api routes with express-session how to configure a trust proxy to take advantage of the secure : true option ? < code > cookie : { httponly : true , samesite : true , secure : true , } ,
hello guys , we have a problem with styles in production builds . after build in server , styles get randomly changed or are missing completly . we use styled-components and on some pages we use getinitialprops to ssr components . but in local with styles are everytime correct without bugs . anyone solved simillar issue before ? wrong css correct < code >
i 'm working on my personal website , and while the css works locally . every time i deploy it to vercel , or run next start , the css does n't work and i ca n't find the culprit . you can look at the issue here : < url > this is the repo of said website . the current deployed version is at `` master '' branch : < url > i was wondering if it was tailwind purge css but even after turning it off it still did n't work . i need some external eyes help to try to see what i 'm not seeing . < code >
i 'm currently migrating an small nextjs project from 9.4.4 to 9.5.2 , everything works fine on 9.4.4 , however , when upgrading to 9.52 i 'm gettings the invalid hook call error . mismatch react & react dom versions : no , both are using 16.13.1 breaking hooks rules : no . i 've removed all my files and tried a minimal next.js page and still occurs ( no _app.js or _document.js ) . more than one copy of react : no . npm ls react - > < email > .1 let me know if someone is also having trouble with this < code >
hi there , i need to have a custom server.js for ssr caching , however this approach cancels redirects in config . do you have any suggestions ? version 9.5 < code >
i 'd like to profile my api endpoints to help determine the source of some slow api responses and found this method that node provides : < url > how do i use that profiler with next.js ? from what i can tell , in order to use it , you need to add -- prof to the node command that starts the server . -- prof is not allowed in node_options so it was n't clear if there was a way to do it with some sort of config on the standard next dev command . i tried making a custom server ( per these instructions : < url > ) and then calling node -- prof server.js which gets me a set of v8 log files as the server starts , but it does n't seem to continue to generate log files after that initial startup ( ie no logs seem to be generated when i hit the api endpoint ) . < code >
in my project , we use bootstrap on one of our pages . however , on every other page , we want to maintain our own custom styling . right now , we are importing the bootstrap.min.css file in our _app.js file . the problem with this approach is that we import the bootstrap styles throughout the entire application , rather than on the sole page where we want it . i have looked at the component-level css docs and it seems like this could be adapted to how i want this to operate . my line of thinking is that i can import the bootstrap css file , and then re-export it as a module.css . my approach right now is using a copywebpackplugin to rename the boostrap.min.css file to a module.css file . however i 'm running into issues because bootstrap has selectors that are not `` pure '' when i import the module.css file . does anyone have any suggestions for how to get around this ? or maybe another approach that i have n't considered to accomplish this ? < code >
suppose i have an index.js the looks like this : and given that page1.js is in the pages/ directory , it can take advantage of the getserversideprops mechanism . how do i get access to the properties set by that function call when they get overridden by the call on the index page ? or am i not supposed to compose one page with others but with components ( in which case the responsibility of fetching data from some remote source can not be delegated to the component ) ? appendix i i guess by way of explanation , my index page creates a tab container and each of the tabs should display a page , ergo the need to create a page of pages < code > import page1 from './page1 ' export default ( ) = > ( < page1 someprop= '' yes '' / > )
we have a monorepo structure that is not supported by vercel yet ( i am aware of the progress being made on vercel/vercel # 3547 ) . is it possible to build lambdas locally and then just publish the result to vercel ? that would be a good workaround in the meantime but i 'm not sure how to do it . in other words , after i run next build , then how to publish the result to vercel ? note : it 's not a static project that could be next export-ed . < code >
hi i was wondering if someone could give a bit of help ? we 're using next and next/link for a headless wordpress site . some pages are dynamic , routed from the pages directory . others used a fixed route type page . see an example directory structure below : imagine we a menu with links that look like this : if i 'm on the /news/a-slug page , when i click on /news/overview it pushes that url into browser history but does n't actually navigate me there . am i doing something wrong here ? can you use next/link for pages that do n't have a dynamic component ? < code > < link href='/news/overview ' / > < link href= { '/news/ < cur > { item.slug } ' } / > pages/ news/ overview.jsx [ slug ] .jsx
in docker for mac nodemon does n't work unless you do -- legacy-watch . it appears to have the same problem with create-next-app . how can i add -- legacy-watch ? < code >
i want to make a single site application which is an e-commerce application . for this i want use django , django rest for api endpoints as backend . and for frontend i want to use react , redux , axios , react-router , antd . so for professionally deploy this app , what is need of nextjs or gatsby ? i want to scale my application for million users . please help & thanks . < code >
i have re-produced that tree shaking is broken in my monorepo project . when importing anything from material-ui/mdi-material-ui/ or my core node_module using a named import , it causes all the lib to present in the chunks . when i check lighthouse in debug mode , i could see 5mb has beee downloaded . < url > < url > < url > please can anyone take a look at my code and see why is it not working ? < code >
bug report describe the bug can not execute create-next-app in/user ( not allowed ) because of permission . to reproduc go to /users npx create-next-app -- example hello-world hello-world-app ( any example ) see error expected behavior explicitly indicate that the error is due to permission . screenshots system information os : macos version of node.js : 12.7.0 additional context an example of npm < code > npm err ! path /users/package.json npm err ! code eacces npm err ! errno -13 npm err ! syscall open npm err ! error : eacces : permission denied , open '/users/package.json ' npm err ! [ error : eacces : permission denied , open '/users/package.json ' ] { npm err ! stack : `` error : eacces : permission denied , open '/users/package.json ' '' , npm err ! errno : -13 , npm err ! code : 'eacces ' , npm err ! syscall : 'open ' , npm err ! path : '/users/package.json ' npm err ! } npm err ! npm err ! the operation was rejected by your operating system . npm err ! it is likely you do not have the permissions to access this file as the current user npm err ! npm err ! if you believe this might be a permissions issue , please double-check the npm err ! permissions of the file and its containing directories , or try running npm err ! the command again as root/administrator ( though this is not recommended ) .
i have a private npm package that i maintain , which i use in a next.js project . both projects are react , typescript projects . i 've recently added a graph into the npm project and have now run into the problem of ; all the calls to window within that npm package throw an error window is not defined within the next.js project as i 'm using a library , that i do n't have control over , to build my graph , i do n't have the luxury of wrapping the calls to window in some sort of if ( typeof window ! == `` undefined '' ) statement . i get these errors on build of my next.js project , before i 've even made a call to a component that makes use of the graphing library . simply including my npm package in my main project as a dependency results in these errors arising . would it be possible to stop server-side rendering just for that particular graphing library or perhaps my entire npm package ? alternatively , any other solution would be welcome , however wild . < code >
hi , i am making edit page : d and yes we can use form . but i want to make something more . i want on single product page , if user ( owner of that product ) click to edit , component input will load from server , not from current code from client or push another page . is there a feature like that ? thank you . < code >
i 've submitted a feature request to vercel , explaining that most of the community extensions for styled-jsx are unmaintained , buggy , and although one of them works on mac , none of them currently work on windows . all of them require two extensions and they all have problems . anyone else feel like it would be great to search the marketplace and see a single , official vercel styled-jsx extension ? < code >
feature request : official styled-jsx vs code extension styled-jsx is great but lacks vs code support . it would be great to have a single extension from vercel that provides bug-free syntax coloring and code-completion . current extensions : syntax highlighting : vscode-styled-jsx marked as unmaintained windows : does n't install for wsl ubuntu like other extensions , which may cause environment problems code completion : a number of broken , unmaintained extensions exist , the styled-jsx-language-server ( and a duplicate uppercod ) is broken - it pukes on every key press - and is unmaintained a fork southclaws tried to clean this up , but their fixes only work on mac all existing extensions seem to rely on the unmaintained one above it 's a mess . i know vercel is not in this business . but man oh man , would i 💓 to have code completion in my css ! thanks for considering it . < code >
hello , starting the tutorial to get a little more familiar with next.js . i followed the instructions and was just wondering if this page would need to amended by adding another answer open ( 'read this page ! ' ) or change the files in this starter project ? url : < url > opened up the browser to localhost:3000 as instructed and am greeted with 'read this page ! ' . the question in this part of the tutorial asks what you see on the page with the below two answers welcome to next.js ! hello next.js ! < code > npx create-next-app nextjs-blog -- use-npm -- example `` < url > cd nextjs-blog npm run dev
hey all , i 'm working on a little pokedex project here and while my local version works fine , my prod build seems to log a ton of 404 's that point to some strange .js files in chrome devtools application > frames > other . it looks like these js files are being generated from the fetched images , but i 'm not sure how or why . the behavior is also inconsistent . sometimes it logs get < url > net : :err_aborted 404 while other times it logs a series of failed to load resource : the server responded with a status of 404 ( ) would love any insight/direction here . it 's not affecting the app itself to my knowledge , but is driving me crazy . < code >
i 've got a normal login page and the < form > 's action points to /login . so when you run a get you get the content from next , and when you run a post you should hit the /api/login.js . i can add a redirect to next via the next.config.js but ca n't currently see that it should be conditional based on the request type . is it possible ? otherwise i can post to /api/login , but if the user posted when js did n't fully hook ( or if it failed to download for whatever reason ) , i want to make sure the endpoint would redirect them to signed in ( whereas a client-side sign in would only get the token back and to a client side redirect ) . in the ( g ) olden days , i would have checked the xml-requested-with - but that seems clunky compared to all the shiny tools we haveno ? < code >
is there a best practice solution for handling < a > tags output from a wysiwyg editor in next ? a potential solution is to wrap the output in a component that maps through each child element and changes any with a type of a to a next link . the issue is this relies on a few packages , such as react-children-utilities , and i 'm not sure if the hit to performance from the extra weight and processing is worth any perceived gain from the links . < code >
imagine i 'm fetching posts from a system that has a rate limit . suppose i 'm able to fetch 100 posts at a time and i got 300 of them . in getstaticpathts , i 'm getting the list of handles ( slugs/ids ) for the entire list . once getstaticpaths returns it 's value getstaticprops runs for every post . that results in a problem where the initial 100 posts get fetched , skipping the remaining 200. i tried different approaches , could n't make it work , would love to hear your ideas . feels like there 's a solution for that and i 'm missing it . thanks . < code >
recently i tried to build a website with next.js and netlify stacks . i want some standard blogging features for my project , but there is no good example for realizing them . the template i built has the following features : tagging : organizes content by tags author : displays author names who write a post pagination : limits the number of posts per page cms : built with cms to allow editors modifying content with the quickest way seo optimized : built-in metadata like json-ld shortcode : extends content writing with react component like wordpress shortcodes i believe it is enough for implementing a website like blogs . let me know if you found what i need to fix , or something was missing for building your website with this template . < code >
hello everyone ! i 'm creating a client rendered app using nextjs and hosting it on aws s3 . when i access dynamic routes locally in development , say /posts/1 , it works great ! but when i build and run the build locally using serve , i ca n't access /posts/1 but however if i try to access /posts/ [ id ] , it does work . the idea is that a user may access /posts/1 , then data is fetched inside my react component using a useeffect ( ) with the route param , just like you would in a client rendered app using react-router and create-react-app . hope someone can understand what i 'm trying to achieve here . is this possible or did i miss something ? < code >
hi , i tried to upgrade nextjs v7 to v9.5 . in my project , i used ant design less with styled-components . after i upgrade to v9.5 my css order wrong but i ca n't find any solution . from the image , the link tag should be above the style tag to make the css correct . how can i order it ? packages : next 9.5.2 styled-components 5.1.1 antd 3.18.2 < code >
i 'm currently using next 9.2.3 with unstable_getstaticprops with contentful without any issues . i attempted to upgrade to 9.3 now that getstaticprops has been officially released . doing so , however , gives me a reason : circular references can not be expressed in json . without any code changes . my data does have some circular references in it , but i go out of my way using safe-stringify to remove them when the data is fetched from contentful . what changed between 9.2.3 and 9.3 ? is it possible to tell next to ignore the result of the circular reference test if i 'm sure the data is serializable , as it was in 9.2.3 ? < code >
i 'd like to use next to build a documentation site . i need to add a drop-down for versioning . is there a way to show a different set of pages based on the drop-down or version the user picks ? < code >
hello folks , i need to create an api route gateway that will wrap up another graphql 3rd party service , one of the reason i 'm doing that is to improve security and avoid expose secrets required for the 3rd party service . the gateway will just hook up the secrets keys and set up a few headers , nothing more . do you have any idea how i can implement it ? < code >
as i update next version for 9.3.6 , compiler starts warning to remove the `` const withcss = require ( ' @ zeit/next-css ' ) '' globally and to import all css at app.js . after removing , i start getting issues in my production build . there are two css loading instead of one minified and this is creating some issues related to designs in anchor 's , font family and background colors . here is my next.config.js file : const withfonts = require ( 'next-fonts ' ) ; const withimages = require ( 'next-images ' ) ; // const withcss = require ( ' @ zeit/next-css ' ) const withplugins = require ( 'next-compose-plugins ' ) ; const nextenv = require ( 'next-env ' ) ; const dotenvload = require ( 'dotenv-load ' ) ; dotenvload ( ) ; withfonts ( { webpack ( config , options ) { // config.plugins.push ( new webpack.environmentplugin ( localenv ) ) return config ; } } ) module.exports = withplugins ( [ nextenv ( { staticprefix : 'custom_static_ ' , publicprefix : 'custom_public_ ' , } ) , withfonts , withimages ] ) ; os : [ e.g . ubantu ] browser [ chrome ] version of next.js : `` ^9.1.6 '' additional context < code >
hi guys , hope you 're well . i 'm trying to make a page in my blog and it needs to not be pre-rendered in any way . the concept of pre-reder is presented in the tutorial ( < url > ) . i need that this page assumes a normal react behavior , so the page will not be pre-rendered and the browser of the user will hydrate the code with local javascript . is it possible ? thanks guys . < code >
bug report describe the bug when pushing a route that is handled by a catch-all page , i expect the routing to happen client-side . instead , the entire page reloads and server-side routing is used . for example , suppose i have defined the following page : and suppose i have the following links defined somewhere : when i click on page 1 , the page reloads as the routing happens server-side which is not ideal . when i click on page 2 , the routing happens client-side which is ideal . to reproduce git clone < url > yarn dev and visit localhost:3000 click on page 1 link observe the entire page reloads ( the page will flicker ) . expected behavior page should not reload , but instead page transition should happen client side . screenshots n/a system information os : macos browser ( if applies : firefox 79.0 version of next.js : 9.5.1 version of node.js : 10.22.0 additional context n/a < code > pages/ [ [ ... slug ] ] .js page2.js < link href= '' /page1 '' > page 1 < /link > < link href= '' /page2 '' > page 2 < /link >
i try the example with-yarn-workspaces and it works well . i also added typescript and css modules . when i tried to add inline-react-svg ( inspired by svg-components example ) i get the problem of what i tried to do is creating babel.config.js with i want tohave the ability to write how to config it right ? < code > module.exports = { presets : [ `` next/babel '' ] , plugins : [ `` inline-react-svg '' ] , } ; module parse failed : unexpected token ( 1:0 ) you may need an appropriate loader to handle this file type , currently no loaders are configured to process this file . see < url > import baricon from `` ./assets/baricon.svg '' ; ... < baricon height= { 100 } width= { 100 } / >
currently i 'm using ssg which is perfect . but i want my site support multilingual . i tried next-18next but it does n't support ssg now . i 'm thinking using local subpath ( e.g domain.com and domain.com/es ) but i can not imagine how to generate a new set of static html pages of the new language . does anyone have any idea ? < code >
i use router.aspath in _app in order to set alternate link tags . i.e . : for the page /pages/article/ [ id ] .js ssr returns /article/123 , but in case of ssg it return /article/ [ id ] . i see this behavior on the vercel platform , not locally . i use next.js 9.5.2 . < code >
feature request is your feature request related to a problem ? please describe . see pr and discussion here : # 15202 the existing firebase auth example sets a cookie with the firebase user info , which is then available for server-side rendering . however , firebase tokens expire after 1 hour , which means the server side wo n't have access to the user when they revisit the site an hour after their last visit , because the token and associated cookie have expired . this wo n't work for apps that always need to ssr and need the firebase id token to ssr . these apps need additional logic to refresh the firebase id token on the server side . we should add this to the firebase auth example . describe the solution you 'd like there 's a pr here with a working server-side token refresh : # 15202 we should merge its logic with the with-firebase-authentication to make it easier for users to choose ssr , as suggested in this review comment . describe alternatives you 've considered n/a additional context n/a < code >
hi 👋 i was testing out the with-react-intl example and found that navigations seem to cause the locale to go missing . has anyone else come across this or have any ideas as to what could be causing this ? < code >
i have been struggling to test my api routes . i finally found this discussion , which got me much closer and seems to make sense . i made a local copy of some of the tools from the next-testing-utils as suggested . the process of invoking next build and then starting up the server seems to work . however , my code uses node_env to determine which database setup to use ( 'production ' , 'development ' , or 'test ' ) . i am using jest , so the environment should be set to 'test ' , but when i run my tests it would try to access the production db . when i logged process.env.node_env , it reported 'production ' . after thinking i was going insane ( logging process.env showed node_env='test ' ) , i discovered that deep under the hood webpack is just swapping out the string process.env.node_env with 'production ' in my code ( which i confirmed by looking at the generated code ) . i can work around this with an additional environment variable in my code , but i am wondering if anyone has any thoughts about how to do this more elegantly ( in essence , how can i make `` test '' builds that do n't claim to be production ) . < code >
i am new to nextjs . i wan na add my custom fonts to my project . i am totally confused about how to do that ( my fonts are in `` public/fonts/ '' ) . my global.css file is this- //global.css 'html , body { padding : 0 ; margin : 0 ; font-family : -apple-system , blinkmacsystemfont , segoe ui , roboto , oxygen , ubuntu , cantarell , fira sans , droid sans , helvetica neue , sans-serif ; } a { color : inherit ; text-decoration : none ; } { box-sizing : border-box ; } @ font-face { font-family : `` avenir '' ; src : url ( `` .. /public/fonts/avenirnextroundedstd-demi.ttf '' ) ; src : url ( `` .. /public/fonts/avenirnextroundedstd-medit.ttf '' ) ; src : url ( `` .. /public/fonts/avenirnextroundedstd-reg.ttf '' ) ; } ' //next.config.js const withcss = require ( `` @ zeit/next-css '' ) ; module.exports = withcss ( { / * config options here * / } ) ; < code >
bug report describe the bug i get the following error when trying to start my next.js application in my production environment ( aws ebs ) : typeerror : can not read property 'filter ' of undefined at nextscript.getpolyfillscripts ( /var/app/current/.next/server/static/8hsfigb_bmrkaqmwjtl6h/pages/_document.js:735:26 ) at nextscript.render ( /var/app/current/.next/server/static/8hsfigb_bmrkaqmwjtl6h/pages/_document.js:836:75 ) at d ( /var/app/current/node_modules/react-dom/cjs/react-dom-server.node.production.min.js:38:231 ) at < cur > a ( /var/app/current/node_modules/react-dom/cjs/react-dom-server.node.production.min.js:39:16 ) a.b.render ( /var/app/current/node_modules/react-dom/cjs/react-dom-server.node.production.min.js:44:476 ) a.b.read ( /var/app/current/node_modules/react-dom/cjs/react-dom-server.node.production.min.js:44:18 ) rendertostaticmarkup ( /var/app/current/node_modules/react-dom/cjs/react-dom-server.node.production.min.js:54:462 ) renderdocument ( /var/app/current/node_modules/next/dist/next-server/server/render.js:3:624 ) rendertohtml ( /var/app/current/node_modules/next/dist/next-server/server/render.js:50:72 ) processticksandrejections ( internal/process/task_queues.js:97:5 ) the aws ebs environment runs node.js 12 on a 64bit amazon linux 2/5.2.0 . i 've deployed another app in a similar environment without any issues using v9.4.0 of next . to reproduce i build the app , zip it up , deploy it to aws ebs and run npm start on port 8080. expected behavior expected behaviour is that the app starts without any internal server errors . screenshots stacktrace from my aws environment : system information the aws ebs environment runs node.js 12 on a 64bit amazon linux 2/5.2.0 . i use 9.4.0 of next . < code >
hi , i 'm moving my app from create-react-app to nextjs and i 'm running into a weird bug when installing twilio-chat . every time i run the code i have this error : i created a sandbox with a basic nextjs set up to reproduce the error . < url > i tried to install @ babel/runtime and other packages from @ babel but nothing works . any idea what could go wrong here ? < code > error - ./node_modules/twilio-chat/browser/logger.js module not found : ca n't resolve 'babel-runtime/core-js/array/from ' in '/sandbox/node_modules/twilio-chat/browser '
is it possible to limit the amount of rendered pages created from getstaticpaths with fallback set to true ? evicting the oldest pre-rendered page for example . < code >
in my application , whenever i follow a link to a statically generated page which uses dynamic routing with getstaticpaths e.g . < link href= { / < cur > { collection } / < cur > { product.handle } } > my react context created with usecontext and being provided to the rest of the application via _app.js is being reset . am i missing somethin fundemental about how ssg is working ? would be massively grateful for any help : ) < code >
problem : some times our database has few change in one day than means we can create static page with getstaticprops method and pass revalidation to set time of need to wait for regenerating page . for now this strategy is in the nextjs project . but a problem is when we in dynamic route . suppose in dynamic route we have 1000 page generated and revalidation method is going to regenerate all 1000 pages but we now at most 10 page have changes in one minute and we need regenerate 10 page not 1000 page solution : in revalidation property we can set a function instead of a number . this function get a page id ( suppose in dynamic route we in /page/ : id ) and return true or false for regenerating page . this strategy can remove high processing in server and in some kind of page we can transfer ssr page to ssg and it 's awesome note : i see the planing for next version of the project and see your team want 's add event listener for regenerating pages and for this it 's better you create listener for each page of dynamics root ( page/1 , page/2 , ... ) and it 's can improve the performance and app do n't need regenerating all pages note 2 : i want to contributing for develop this strategy if it 's possible . < code >
a page can export a config object that contains some per-page configuration options . the only example of this that i can find is specifying the `` amp '' config for a page : i have two questions about this : is it possible to add custom configuration to the config object exported on the page ? is it possible to read the exported config object in a custom app ( in /page/_app. { js|ts } ? use case : in order to configure the app layout , i would like to specify per-page config options for a top-level layout component that wraps all page components ( using a custom app ) . < code > export const config = { amp : true }
lately , i was building a nextjs starter for blog . a totally modern stack for my blog using nextjs as the main framework . the starter code are also using a type checking ( typescript ) , linter ( eslint ) , code formatter ( prettier ) , css framework ( tailwind css ) . finally , it very easy to deploy on netlify . you can check a live demo at this location : nextjs starter and the code source are hosted on github at this repo : nextjs starter blog here is the list of major feature : 🎈 syntax highlighting your code with prism.js 📖 blog pagination 🎨 include a minimalist blog theme 💅 design with tailwind css ✏️ linter with eslint and prettier 🎉 type checking with typescript ✅ easy deploy on netlify 🤖 seo friendly 🚀 production-ready , you just need to focus on your writing < code >
i am using this pattern for building persistent layouts : ( < url > ) [ persistent layout patterns in next.js ] [ 1 ] it works fine when your layout does n't rely on external data . what to do if you want to build a documentation like page - and in your layout there is a sidebar with sections like getting started , examples , faq , about ? ideally i would like to store those sections in a markdown file and generate the layout at the build time . how to achieve such functionality with next.js and getstaticprops ? < code > // markdown file -- - section_1 : `` getting started '' section_2 : `` examples '' section_3 : `` faq '' section_4 : `` about '' -- -
hi guys , i did all tasks for to best the performance my website , but ttfb from server is very bad . anything ideia ? i using getserversideprops in index page for ssr thanks - odete.com.br < code >
hi , i got this error with next . i found the answer on google and fixed by moved my function to a new file . i think this error come from preact , staring use it ? because my other repo use same structure too and no issue ( i put all func in to one file : d ) i want to ask : put all func into one file will make bundle bigger , right ? just wonder ... < code >
howdy , i was checking out some graphql implementations with next.js . the implementations in question are as follows : 1 . ) if you go to the examples folder on github you can find this with-apollo example . it looks like it is ssr with an implementation with apollo client . 2 . ) my guy , ben grunfeld , implements graphql on the the next.js api routes using apollo server . link here . i guess my question is when would i go with one implementation over the other ? i can only surmise that it depends on what i 'm using as a data source . like for example , if i used hasura , i 'd use the first implementation , as compared to using firebase , which at which point i 'd use the second implementation ( cause i 'd need to code the graphql interaction with firebase ) . does anyone have further insight on this ? i 'd love to hear it . < code >
hi all , when running the command : npx create-next-app nextjstest -- use-npm -- example `` < url > it returns with the following error : i ca n't proceed from there thanks for your help < code > npx : installed 1 in 2.605s unexpected token * node : v8.10.0 npm : 3.5.2 npx : 10.2.0
feature request is your feature request related to a problem ? please describe . hi , i am trying to understand preview mode demo . i want user can edit their post easy , just need press a button and edit then save , do i understand right about preview mode ? wish you can make a super simple example of preview mode , the current so complex with me , i think : ( at least need to understand how it work . describe the solution you 'd like open edit for just h1 tag , then it become an input tag to edit . : d < code >
i read through the source of with-firebase-authentication . it uses js-cookie to read and write cookies . however , when i try this in my app cookies are always undefined on the server side . i can see the cookie in in req.headers.cookie server side , but js-cookie does not magically obtain that value . i do n't see wire-firebase-authentication parsing the cookies anywhere so i do n't understand how it could actually work . am i missing something ? thanks 🙏 < code >
i 'd like to build an api using next.js , but some of the data returned by my api is static , so i 'd like to generate the json at build time rather than using the api/ route . i 've already found this discussion , but it looks like they ended up using the api route and the getinitialprops answer does n't seem like it would let me use getstaticpaths and getstaticprops as well . my ideal use would be defining a path under pages and returning raw json and getting json ( not an html page with json in it ) . < code >
here 's my code : when i run this code , i get i 'm not sure why . should n't lib/test2.ts compile to lib/test2.js , and the import should be fine ? i suppose i 'm not very familiar with how the imports actually get resolved when typescript is in the mix . link to all the code here : < url > < code > module not found : ca n't resolve ' .. /lib/test2.js ' in '/users/user/documents/software/nextjs-test/pages ' // pages/index.tsx import { getserversideprops } from `` next '' ; // works import { test } from `` .. /lib/test.js '' ; // error import { test2 } from `` .. /lib/test2.js '' ; export const getserversideprops : getserversideprops = async ( { req , } ) : promise < { props : { } } > = > { test ( ) ; test2 ( ) ; return { props : { } } ; } ; export default function home ( props : { } ) { return < div > hi < /div > ; } // lib/test2.ts export function test2 ( ) { console.log ( `` test2 '' ) ; }
i am facing problem in creating environment variable in in nextjs 9.1.1. i have done r & d on it . i have read on nextjs official website . if version is 9.1.1 then we have to define environment in next.config.js file but if i create environment in next.config.js then i cant add it in gitignore because next.config.js is imp file . so i want to create environment variable in different file like .env . and also i wanted to know what is difference between .env and .env.local and .enc.build ? thank you < code >
vercel has a limit in their vercel.json of 1024 redirects , but i wonder if next 9.5 's new redirects in next.config.js have that same limit , and if not if any limit is applied once on vercel ? ps : i have no real-world use case for this , i 'm just thinking ahead for if that time ever comes . < code >
what 's the right way to install the 'next ' command so you can run from the command line without npx ? i tried but i get : james @ gig : ~/workspace/nexttutorial/nextjs-blog < cur > next dev the module 'react-dom ' was not found . next.js requires that you include it in 'dependencies ' of your 'package.json ' . to add it , run 'npm install react-dom ' ( node:104613 ) unhandledpromiserejectionwarning : error : can not find module 'react-dom/server ' require stack : /home/linuxbrew/.linuxbrew/lib/node_modules/next/dist/next-server/server/render.js /home/linuxbrew/.linuxbrew/lib/node_modules/next/dist/next-server/server/next-server.js /home/linuxbrew/.linuxbrew/lib/node_modules/next/dist/server/next.js /home/linuxbrew/.linuxbrew/lib/node_modules/next/dist/server/lib/start-server.js /home/linuxbrew/.linuxbrew/lib/node_modules/next/dist/cli/next-dev.js /home/linuxbrew/.linuxbrew/lib/node_modules/next/dist/bin/next at function.module._resolvefilename ( internal/modules/cjs/loader.js:623:15 ) at function.module._load ( internal/modules/cjs/loader.js:527:27 ) at module.require ( internal/modules/cjs/loader.js:681:19 ) at require ( internal/modules/cjs/helpers.js:16:16 ) at object . ( /home/linuxbrew/.linuxbrew/lib/node_modules/next/dist/next-server/server/render.js:1:136 ) at module._compile ( internal/modules/cjs/loader.js:774:30 ) at object.module._extensions .. js ( internal/modules/cjs/loader.js:785:10 ) at module.load ( internal/modules/cjs/loader.js:641:32 ) at function.module._load ( internal/modules/cjs/loader.js:556:12 ) at module.require ( internal/modules/cjs/loader.js:681:19 ) ( node:104613 ) unhandledpromiserejectionwarning : unhandled promise rejection . this error originated either by throwing inside of an async function without a catch block , or by rejecting a promise which was not handled with .catch ( ) . ( rejection id : 1 ) ( node:104613 ) [ dep0018 ] deprecationwarning : unhandled promise rejections are deprecated . in the future , promise rejections that are not handled will terminate the node.js process with a non-zero exit code . this works fine in that directory though : npx next dev ready - started server on < url > event - compiled successfully < code > npm -g install next react
hi guys , i have a navbar ( it can only be rendered client-side ) , so i imported it in the page.js component and i put it before { children } which is the concerned page depending on the url . so at the top of each page i have my navbar rendered in js . but , as the navbar is not ssr , my page loads first and then my navbar gets mounted ... which results in terrible user experience . any idea on how i could tell any page to wait for my non-ssr navbar to render and then display the ssr page ? thank you 🙏🏼 < code >
so here i want a way to show type error when the user does this < loader loadingtext= '' loading ... '' withmodal= { false | undefined } / > what is the direct way for doing this in react with ts . < code > interface loaderprops extends spinnerprops { withmodal ? : boolean ; // the below should n't be exisited if there is no modal loadingtext ? : string ; }
is it possible to skip getserversideprops when navigating from one page to another on the client ? i want to prerender a page ( ssr ) when the user lands directly to the url but when he navigates via client navigation i want to use useswr and show the page with some skeleton loaders . is that currently possible ? < code >
my project folder structure is like this : /pages /hotels [ id ] .js hotels.js and i want to use pretty urls so on my next.config.js file i added this : basically what i want to do is use the link component from next/link to go the correct files whenever i get a url from my cms . so the following component should go to the /pages/hotels page like so : but for some reason when i do this approach my app does a reload of the site . i previously was able to achieve this successfully with next-routes but wanted to moved out of it since it seems it 's no longer being supported . < code > module.exports = { async rewrites ( ) { return [ { source : `` /hotels-on-the-beach '' , destination : `` /hotels '' , } , ] ; } , } ) ; // linkobj = { // label : `` hotels on the beach '' , // url : `` /hotels-on-the-beach/ '' , // } < link href= { linkobj.url } > < a > { linkobj.label } < /a > < /link >
let suppose there is a landing page and on landing page there are 2 options one is for login and another is for signup . on login page i am just checking whether cookies are enable or not , so if cookies are blocked then i want to show the snackbar , same goes with signup page . now what happens is when i clicked on the login button , the login page opens up but if the cookies are blocked then snackbar dose n't pops up , but if i refresh the login page then snackbar pops up . i want to popup snackbar at the first render itself . if i use ' a ' tag then it works fine but using link tag it dose n't work . can someone please guide me on this . < code >
i need to check if a non admin user is inside any /admin/ * routes and redirect the user to a 404 page . right now i can only do checking page by page if ( router.pathname === '/admin/page1 ' & & ! userisadmin ) { router.push ( '/404 ' ) ; } < code >
i have developed a simple e-commerce website using next js , it is working fine on my machine but after deploying it to vercel on every request made to backend it throws a `` cross-origin request blocked : the same origin policy disallows reading the remote resource at < url > ( reason : cors request did not _succeed ) . '' error as also shown in picture . here is the code from my backend where i tried to resolve my issue . < code >
feature request is your feature request related to a problem ? please describe . it is difficult to navigate setting up azure active directory or microsoft graph in next.js because the current methodologies are reliant on accessing the next ( ) function , or solely using express with intensive middleware . describe the solution you 'd like a demo as to how to set up microsoft graph or azure active directory in next 9.x . describe alternatives you 've considered an express tutorial with microsoft graph this outdated ( next 8.x ) tutorial of how to set up ms graph < code >
i 'm building a simple blog that has public posts and private posts . the page for post view is using getstaticprops to populate post data now i want to prevent unauthorized ones to access the private posts . i have researched about it but seems like it 's impossible to implement so . i 've tried to redirect in the component as follows it redirects in a flash but it still reveals the private post . also is revealed clearly in the view-source page . i 've been struggling on this for whole 2 days . is it really impossible ? < code > useeffect ( ( ) = > { const router = userouter ( ) ; if ( ! localstorage.getitem ( `` accesstoken '' ) ) { router.push ( `` / '' ) ; } } , [ ] ) ;
that is my configs in tsconfig.json file these are recognized by vscode and it auto completes the directories for me but i got this error in the browser and terminal however , i 'm using the latest next package 9.5 < code > module not found : ca n't resolve ' @ src/components/appheader ' in '/mnt/e/dev/projects/share-thinking/pages ' `` baseurl '' : `` . `` , `` paths '' : { `` @ src/ * '' : [ `` ./src/ * '' ] , `` @ hooks/ * '' : [ `` ./src/hooks/ * '' ] , `` @ components/ * '' : [ `` ./src/components/ * '' ] , `` @ root/ * '' : [ `` ./ * '' ] }
hi , i 'm trying to use a redirect from getserversideprops and i get error [ err_http_headers_sent ] : can not set headers after they are sent to the client in some cases . i have seen that this problem was covered in issues many times and the solution was to use res.end ( ) like this . however , the following code fails for me when used with link or router.push ( ) : while this one works : so , my first guess was that this happens because the first code returns the same props ( ? ) for both paths , but i tried to return { props : { foo : 'bar ' } } ; , and it gave me the same result . it would be super helpful if somebody could help me understand the cause of this behavior . i 've also gone through all links at this rfc thanks , simon < code > export const getserversideprops = async ( { req , res } ) = > { res.setheader ( 'location ' , '/signin ' ) ; res.statuscode = 302 ; res.end ( ) ; return { props : { } } ; } ; export const getserversideprops = async ( { req , res } ) = > { const session = await getcurrentsession ( { req } ) ; if ( ! session ) { res.setheader ( 'location ' , '/signin ' ) ; res.statuscode = 302 ; res.end ( ) ; return { props : { } } ; } return { props : { } } ; } ;
my public directory is public/assets and my next.config.js `` headers '' : [ { `` source '' : `` /assets/ * '' , `` headers '' : [ { `` key '' : `` cache-control '' , `` value '' : `` public , max-age=31536000 , stale-while-revalidate '' } ] } error ! header at index 1 has invalid source pattern `` /assets/ * '' < code >
i 'd like to set node_env to test but < cur > next dev ignores that and sets node_env to development . is this a decided behavior ? ca n't find anything relevant in issues . < code >
i 've downloaded some glyphs from icomoon . i have a style.css file and a fonts folder which contains the eot , woff , svg and ttf files . one solution ( workaround ? ) i found was : move the fonts folder into the public folder . import style.css ( which contains the required styles for icons ) as a global style in _app.js . source : < url > however , i do n't need the icons for all my pages . i 'm not sure whether importing them as a global style is the best way to do this as it may increase the page load ( albeit by a few kbs ) . or am i missing something ? any pointers will be appreciated . < code >
hi , i 'm trying to work through the next/firebase example and am getting stuck at a few points : first , i can get mostly everything working locally . i can log in and out and correctly display my user email . however it does n't want to show my 'foods ! ' i instead see both the failed to fetch foods ! error message and loading ... message . i have n't modified getfoods.js . in fact as per the examples readme file - the only modification i have made has been to the env.local file . the above sounds the same as a comment on # 15628 second , when i tried to deploy the app with vercel , it builds successfully but then when i visit the app - it just throws a fullscreen 'unknown error ' message . my dev tools tell me that my firebase api key is invalid . ( does n't happen locally ) as the firebase api key is set in .env.local , should .env.local be removed from .gitignore ? knowing it will be pushed to a private repo ? i feel like i 'm missing a step ( or a fundamental understanding with this can anyone clear it up ? ) thanks < code >
hi , i have i have dynamic pages /shop/ [ slug ] .js which build statically using getstaticprops my question is should i rebuild the entire content everytime i add new one for the above page ? if i have not mistaken the incremental build in next.js should add new page ( on the fly ) without me have to rebuild from the start . if it 's correct then why every link that leads to the new page throw me to the 404 ? < code > // [ slug ] .js const productpage = ( { product } ) = > { const router = userouter ( ) return ( < layout > < singleproductblock product= { product } / > < /layout > ) } export const getstaticprops = async ( { params } ) = > { const id = params.slug const result = await client.query ( { query : product_by_slug_query , variables : { id } } ) return { props : { product : result.data.product } , revalidate : 10 } ; } export async function getstaticpaths ( ) { const allproducts = await client.query ( { query : products_homepage , } ) const paths = allproducts.data.products.edges.map ( ( product ) = > ( { params : { slug : product.node.slug } , } ) ) return { paths , fallback : false } } export default productpage
hi next.js team , i was using fallback : `` unstable_blocking '' in the new v9.5.2 and i noticed that the static build was not classified as isr . is this the correct behavior , or is my understanding regarding fallback : `` unstable_blocking '' incorrect ? < code >
i am having a hard time replicating the with-apollo example found here in my own code . i started a new nextjs app ( code here ) and hooked up my own contentful api source for a twitter clone app i 'm trying to make . it seems to work fine on the index page where i am using apollo with ssg and initializing the client in getstaticprops . however , when i try on my [ username ] .js page , where i am trying to use apollo on the client-side only , it does n't work . the client side usage in the example works on my computer when i tested it , but i ca n't seem to figure out where my code differs from the example . when i try with my code , it gives me the following error : error : json.parse : unexpected character at line 1 column 1 of the json data when i inspect the network request where apollo tries posting the query , it looks like the client is trying to use the default localhost:3000/graphql endpoint instead of the custom link i made in lib/apolloclient.js . why would this be ? the example app properly uses the uri setup in the apolloclient file there . as far as i can tell , the only differences between the two projects ( with respect to apollo ) is the link set up for the apolloclient . < code >
hi guys , i already used some libs to document some apis with express and swagger , there is some ways to auto generate a api documentation , using the '/pages/api '' folder ? thanks so much ! < code >
i want to be able to build only once and then set the api endpoints depending on what lies in environment file somewhere . or do i really have to build a new bundle for every possible development environment ? p.s i assume this kind of thing is only possible for pages that are ssr-only ? < code >
in a project i have the folowing page structure : / / [ lang ] / [ lang ] /index.js / [ ... all ] .js this works fine until i had to also accept urls like : `` /cms-page.html '' ( where `` cms-page '' is a variable ) . obviously i have a match on / [ lang ] /index.js and i can , based on the query to check if it 's and cms page or the normal page with a language selected . i would love to have partial matching for routes so i can do stuff like : / [ lang ] / [ cmspagename ] .html.js - matches any url that is 2 level deep and ends with `` .html '' /faq- [ faq-name ] .js - matches any url that starts with `` faq- '' /faq- [ faq-name ] -page.js /faq- [ faq-name ] [ faq-id ] .js i think this will make the routing system a lot more powerful and would make a lot of developers 's lives a lot easier . at the moment the only way to do this is to create a lot of [ ... all ] pages and based on the url return the page needed . the downside is that that page will contain all the possible pages and the bundle for those routes will be quite big ( ex : for 5+ possible return values ) < code >
i am using the following next config to rewrite dynamic urls to the next page pages/post/ [ id ] , which works great on my local machine ( using next @ 9.4.2 ) however , when i deploy the app to vercel i get an 404 for these routes . i am further confused with vercel routes ( < url > ) and rewrites ( < url > ) . which solution should be used when hosting next.js on vercel ? < code > // next.config.js module.exports = { experimental : { async rewrites ( ) { return [ { source : '/ ( . * ) - : id ( \d+ ) .html ' , destination : '/post/ : id ' , } ] } } }
my folder structure is so , basically i import like this import { button , checkbox } from './components/base ' ; similarly for composite and containers but in my build i am getting all my components getting added together in common chunk like this this is the screenshot of bundle < url > than i tried importing like this import button from './components/base/button/button ' ; import checkbox from './components/checkbox/checkbox ' ; and my common chunk reduced significantly but the problem was i need to use absolute path of files . but with next 9.4 even i also added alias to do that < url > and which changed my import to import button from ' @ base/button/button ' ; import checkbox from ' @ base/checkbox/checkbox ' ; now the problems with the above i ca n't import like this which was my primary motto import { button , checkbox } from ' @ base ' ; because if i do so my build gets bigger . < code > + first load js shared by all 544 kb static/pages/_app.js 44.5 kb chunks/0c427a655d9403f7dac568f61d54bc3a0a076000.1255c1.js 9.07 kb chunks/154e5c1e8c086a9c75a17cb3d0ce05a5d5989541.30a49e.js 4.66 kb chunks/4ec9d92409f1e756c674245a6ebde4e4b9f1c3cb.232262.js 18.5 kb chunks/62f56c8205754453a75eeae7838257e73a95eb2f.222465.js 2.76 kb chunks/7284791643293bcf3ac1591cc4862e96973957a8.9babe3.js 3.84 kb chunks/949382b6a867a6d3a65aa642346894560d05ef7a.21fa5b.js 98.3 kb chunks/a9b991a426760cdeb698ecebeb4b66f8aed73dd7.7fa176.js 101 kb chunks/c0d53ec4.713370.js 28.6 kb chunks/commons.90d196.js 181 kb chunks/f634702a4e841db03723154f17c966aad0b368c1.d50012.js 4.71 kb chunks/framework.619a4f.js 40.3 kb runtime/main.277472.js 6.33 kb runtime/webpack.1c5199.js 746 b css/ea00252dd85417fc6f66.css 1.02 kb .src/ components base button button.jsx checkbox checkbox.jsx index.js composite aboutdrawer aboutdrawer.jsx index.js container batch batch.jsx index.js
feature request apologizes if it is a repeat issue . i did a fair amount of searching but no issue was exactly asking for this . we have a bunch of files in the public folder . these files are : favicon app manifest json open search xml files etc currently we have a script for uploading contents of . .next folder to s3 and use assetprefix to deliver the built files via our cdn . the cdn delivery is omitted from the public folder contents . i can upload contents of pubic folder to s3 and deliver via cdn in production by having lines like this is my _document : this does n't seem right . i wish next would take public folder and fingerprinted those assets . because with above solution , a new favicon will show up in prod the moment s3 upload is done . possible solution i 'm expecting next.js rewrite href and urls referring to assets in the public directory and build them into the distdir folder . < code > < link rel= '' icon '' href= { ' < cur > { process.env.node_env === 'production ' ? assetprefix : `` } /favicon.ico ' } type= '' image/x-icon '' / >
do you find github discussions useful as a communication channel ? maybe not ? hello developers ! i am raula gaikovina kula , a software engineering researcher < url > together with a team of researchers , we are interested in your thoughts about using the github discussions beta . we noticed that your project is currently using . we have developed a simple 3 question survey that could take up to 5 mins to complete . < url > thank you in advance for your time and apologize if this is not a proper use of this channel . @ raux raula , phd on behalf of hideaki , sebastian , nicole and christoph < code >
hi , i 'm trying to use the new rewrites feature but i 'm stuck on making < link > work correctly with it . here 's my config : i have a page at /pages/news/ [ slug ] .js . i tried these two ways to create a link to /blog/hello : the first one throws this error : error : the provided as value ( /blog/hello ) is incompatible with the href value ( /news/ [ slug ] ) . read more : < url > while the second one causes a full page reload . is there any way to make this link work like how normal links work ( no full page reload ) ? < code > < link href= '' /news/ [ slug ] '' as= '' /blog/hello '' > < a > /blog/hello < /a > < /link > < link href= '' /blog/ [ slug ] '' as= '' /blog/hello '' > < a > /blog/hello < /a > < /link > async rewrites ( ) { return [ { source : '/blog/ : slug ' , destination : '/news/ : slug ' , } , ] ; } ,
i have a component that takes a url as a prop , and raises an event when the link inside that component is clicked : because i do n't have access to the internals of this component , i have to manually call router.push in handlebuttonclick . this works fine without a base path . however , with a base path set in next.config.js , i also need to ensure that the base path is added when passing the url to the component ( so that the url rendered in the browser is correct ) , and that the base path is removed when calling router.push ( since the router expects bare urls with no base path ) . so my code ends up looking like : so my question is , is it safe to rely on these functions ? they 're imported from next/dist/next-server/lib/router/router . or are these considered private internals that are likely to change ? if they are not safe to rely on , i wonder if these should be exposed as part of some public api ( the router perhaps ) ? < code > import { addbasepath , delbasepath } from `` next/dist/next-server/lib/router/router '' // again this is a contrived example ... // i realise i do n't actually need delbasepath here , // but in other instances i do , so it 's included for illustration < mycomponent url= { addbasepath ( `` /some-page '' ) } onbuttonclick= { e = > router.push ( delbasepath ( e.detail.url ) ) } / > import { addbasepath , delbasepath } from `` next/dist/next-server/lib/router/router '' // this is all simplified for example purposes < mycomponent url= '' /some-page '' onbuttonclick= { e = > router.push ( e.detail.url ) } / >
one of the part as a newbie to the framework that is totally confusing to me is the discussion about client vs server code . like in a logging framework , trying to find one that can log statements and determine if they are server side and can be logged to a file . discussions and docs say getstaticprops/getstaticpath only run during build time , but with fallback=true , it seems like they run server side when receiving a runtime dynamic route . is there a clean way to understand if the context of the function is server vs client ? are getstaticpaths/getstaticprops with fallback=true server side then and everything else in the component is client side ? and is there a logging framework that can determine that as well where it takes a single log statement and determines if it is client it goes to console otherwise it logs to file ? < code >
rephrasing a question i had earlier . i understand dynamic routing to some level when we are talking about 'pages/post/ [ pid ] .js ' : /pages/post/123 /pages/post/abc i understand that during ssg these two are seen as distinct routes and produce two pages . and that with fallback = true , if someone hits with a valid : /pages/post/story1 that the getstaticprops will run and provide data for 'story1 ' and this will be considered a new distinct route and product a page . what i am wondering is whether the same url can use query parameters to create unique dynamic routes . for instance , can i have something like : /pages/post ? id=abc /pages/post ? id=123 and these be considered unique dynamic routes ? asking because we have an spa application with some permalinks and so the main application is at something like /pages/post but we want to be able to ssg some of the permalinks using ? id= . < code >
related : # 15508 i 'd like to create a dynamic menu where i define the major routes to the top and others to the footer , but i think it could be done using next/route or anything else native . since next.js do n't have a routers management , it 's not easy to know how to do that . < code >
we would like to have a page that is accessed at domain.com/api . as the /api folder in /pages is reserved for api routes , i 'm wondering id there is a way to make this happen . choosing not to have any api routes and having an api.js does not seem to work . is having an /api page not possible at all with next or is there a way to make this possible , has anybody does something like this ? < code > pages/ api.js
hello there , my app uses ssr and ssg . i have a multilingual website therefore i set alternate link tags in the head tag at _document.js . in order to get the current path i use this.props.dangerousaspath . from what i see it behaves different on ssr and ssg , if i deploy the app to vercel . i 'm not able to reproduce it locally , even if i run build . i.e . : for the page /pages/article/ [ id ] .js ssg stores /article/123 in this.props.dangerousaspath , but in case of ssr it stores /article/123 ? id=123 . i see this behavior on the vercel platform , not locally . as you can see it adds a query string of the variables used in the path . any ideas why this is the case ? < code >
when working with next and a linked module , the hot reloading does n't work on the server but only on the client . when you have a linked module inside the node_modules folder the module is only replaced on the client but not on the server . this means that you have to restart the whole next application in order to render the updated module on the server . when the module is a react.component and the output change this even results in inconsistent rendering between server and client shown in a error message in the console . < code >
hi team , am facing an issue while generating exportpathmap during next export , the problem is exportpathmap is creating slugname.html instead of slugname/index.html , even though i have configured the attribute exporttrailingslash , can u guys please help me on this whether is this a version issue or something else . happy to hear ! < code >
i have a preview mode url `` /api/preview ? secret=token & path=/posts/id '' when i visit it first time with preview mode on , getstaticprops is called and i receive a page with update data in draft , that is completely fine . but now any one can visit /posts/id and see what i am upto ? probably because page generated for preview only is stored on disk . < code >
i am very curious which backends you use for your nextjs applications ? because of vercels limit to 12 api routes and the lack of backend processing/queueing with vercel , i tried to aws cdk , while powerfull , the developer experience is pretty bad compaired to nextjs , to i am looking to try out other alternatives . < code >
bug report inside hello-world.module.scss , trying to style a native html tag such as article , nav , main , etc . will throw an error . sass modules does n't recognize these properties to reproduce fork next-sass from next-plugin examples add a native html tag like article , etc . add styles to hello-world.module.scss for that article see error add classname like < article classname= '' post '' > style using that class name no style rendered additional context work around is to use next-sass plugin < code > error - ./components/hello-world.module.scss:7:1 syntax error : selector `` article '' is not pure ( pure selectors must contain at least one local class or id ) .post { font-size : 32px ; color : yellow ; } article { font-size : 24px ; color : blue ; } article { font-size : 18px ; }
next.js v : 9.1.6 react : 16.12.0 deployment environment : amazon cloudfront the issue started yesterday . on page load ( using getinitialprops ( ) ) , the index page would display error `` 200. an unexpected error has occurred . '' when i go to a different page and then back to the index page , it renders the page normally ( a server-side vs client side rendering issue perhaps ? ) the same issue was observed again in a different app , where on load it redirects to /_error . no reason whatsoever for these errors . i have used the same code as a template dozens of times to deploy micro web applications with no issues . nothing has changed since the last successful deployment . also , no errors in the console or red flags in the networks tab of devtools . please note that this happens only when deployed . when running locally there are no issues whatsoever . < code >
i 'm currently using ssg with the new next.js revalidate feature for making a question/answer forum it works fine but the problem is when the user answers a new question and refreshes the page , his answer does n't load until his specified time expires . so i need a way to revalidate page on some user actions . is it possible ? < code >
i 'm trying to match the 404 and index pages with a function pattern on the vercel config , but none of the paths are working . my goal is to ignore the public folder on the serverless functions , as they 're causing my build to fail with the following message : < code > error : the serverless function `` _error '' is 165.1mb which exceeds the maximum size limit of 50mb . learn more : < url > { `` functions '' : { `` pages/ * * / * .js '' : { `` excludefiles '' : `` public/ * * / * `` } , `` 404.js '' : { `` excludefiles '' : `` public/ * * / * `` } , `` _error.js '' : { `` excludefiles '' : `` public/ * * / * `` } } }
hi , i 'm implementing multi zones with firebase sessions and was wondering if anyone has a suggestion for how to handle sessions across zones ? i 'd like one zone to act as an entry point for authentication/session creation which also provides a view for links to other zones once user is authenticated . the other zones will serve as different services user can use . curious if anyone has done this already or has a recommendation for how to store the sessions as well as how to work with sessions across zones locally as well as in prod . any thoughts are appreciated . thanks ! < code >
i am using firebase messaging which requires service workers as a separate js file < url > in a next js project , how could i create a script that is not in the main bundle ? ( still need webpack to bundle required packages ) < code >
i 'm currently working on converting my express custom server to api routes 🥳 i had a couple of globally defined middlewares in my old express server , but am not sure how to handle in the world of api routes . best solution i have so far is to create some kind of base middleware and use it in every single route , but it seems like a lot of duplicate code . any guidance on best practices would be greatly appreciated 😄 < code >
i 'm using nextjs , prisma , graphql-yoga , apollo client . currently in my custom server i have the following : i would like to access the req.user client-side i.e . in my _app.js file i should be able to do this : for some reason req.user is undefined . any ideas why ? i have another application with a similar stack and i have this working . however , this app it does n't seem to work . any help greatly appreciated . < code > server.express.use ( async ( req , res , next ) = > { if ( ! req.userid ) return next ( ) ; const user = await server .context ( ) .db.query.user ( { where : { id : req.userid } } , `` { id , permissions , email } '' ) ; req.user = user ; next ( ) ; } ) ; class myapp extends app { static async getinitialprops ( { component , ctx } ) { let pageprops = { } ; if ( component.getinitialprops ) { pageprops = await component.getinitialprops ( ctx ) ; } // this exposes the query to the user pageprops.user = ctx.req.user ; console.log ( ctx.req.userid ) ; return { pageprops } ; } render ( ) { const { component , apollo , pageprops } = this.props ; return ( < component { ... pageprops } / > ) ; }
i have a scenario where a url with a query string , i.e . : /blog/this-is-a-slug/ ? v=test needs to point to a different template file . i used to do this with a custom express server but i 'm wondering if i could achieve the same with rewrites from next 9.5 ? something like : this , however , does n't work : reason : unexpected modifier at 5 , expected end . wondering if there 's an alternative ? < code > async rewrites ( ) { return [ { source : '/blog/ : slug/ ? v=test ' , destination : '/journal/ : slug/ ' , } , ] }
if i use only the code below then i can use getinitialprops on every page and return data to the component . fine , but getserversideprops does n't seem to run , i.e . no data is returned . _app.js if i add this code below then i can use getserversideprops on pages and return data to the component , but now getinitialprops does n't run . i am not using them both at the same time . i want to be able to use either getinitialprops or getserversideprops on any page , not only one . can someone explain why this is happening and how to fix . < code > const main= ( { component , pageprops , store } ) = > { useeffect ( ( ) = > { // remove the server-side injected css . const jssstyles = document.queryselector ( ' # jss-server-side ' ) ; if ( jssstyles ) { jssstyles.parentelement.removechild ( jssstyles ) ; } } , [ ] ) ; return ( < provider store= { store } > < head > < title > main < /title > < /head > < themeprovider theme= { theme } > < cssbaseline / > < component { ... pageprops } / > < /themeprovider > < /provider > ) ; } ; main.getinitialprops = async ( appcontext ) = > { // calls page 's 'getinitialprops ' and fills 'appprops.pageprops ' const appprops = await app.getinitialprops ( appcontext ) ; return { ... appprops } ; } ;
hi guys , i 've ran across an issue trying to set up my next project with styled components and material ui . you can check out the code here : < url > if you click on one of the inputs , you 'll see that materials default styling on the label is a little off , however in _app.js , when you remove from line 44 and refresh the browser , the styling is back to normal ! anyone know what 's going on ? is this a bug or am i doing something wrong ? thanks ! < code >
edit : issue not because of nextjs , it is a temporary npm issue as amedvedevajt said see the basic tutorial : < url > to install the starter , one must run : npx create-next-app nextjs-blog -- use-npm -- example `` < url > this results in the following message : not sure why this package is n't found in the npm registry , i do find it on the npmjs.com site . so i 'm not sure whether this is a problem on npm 's side , or the specific package in question . < code > npm err ! 404 ' @ ampproject/toolbox-optimizer @ 2.2.0 ' is not in the npm registry . npm err ! 404 you should bug the author to publish it ( or use the name yourself ! ) npm err ! 404 it was specified as a dependency of 'next '
in dev everything works . once deployed , everything work ... ish . the api returns the right result and status code when called with a curl . - in the logs in my vercel dashboard , i see a 200 : - in the browser , i get the right result : - but in the browser , i get a 404 : any one knows where this 404 comes from ? this method is just a healthcheck . here is the code : return serverresponse.status ( 200 ) .send ( 'ok ' ) ; since i get the ok , it means that the method works . i get more complex response for other routes . evrything seems to work . except that i get this 404 response code everywhere for no obvious reason . < code >
hi devs , i hope you are all doing well . well , i was using the next framework since the march-2019 , the version 8.x was good with window log error in browser easy and understandable just like in create-react-app but starting from the version 9.x that error log dialog becomes a monster whenever there is an error in my code that window shows up in the browser and the cpu starting increaing for chrome until ~56 % sometime the laptop stops and closed . i do n't know is the problem from next or the browser itself or maybe from the vs code . but surely the cpu consumption comes from chrome ( tab where dialog exist ) . hope to find a solution for this because i was suffering with this many months ago . my env . next version : 9.4.4 chrome version : 84.0.4147.105 yarn version : 1.22.0 node version : 12.16.1 regards . < code >
i 've been trying to reduce the bundle size of an app by lazy-loading components using 'next/dynamic ' , then having those components only appear in render tree when a particular button has been pressed for example . i was curious to understand why a < link rel= '' preload '' href= '' /_next/static/chunks/hash.js '' as= '' script '' / > is added for this category of script , hinting to the browser to give them a high priority among all resources being downloaded . my instinct is that this maybe should n't happen , because these scripts would compete for resources alongside css , images , fonts etc . but i know there will be something i 'm not aware of . i was just curious to learn more about what goes on here . thanks a lot . < code >
my goal is to use css ( less ) modules with my custom react components along with ant design . i 've cloned with-ant-design-less from the examples but after enabling cssmodules in next.config.js ant design 's css is missing , while my css ( less ) modules appear to load . the easiest way to observe this behavior is by changing next.config.js like so upon next server restart all ant design css/less will be missing . < code > module.exports = withless ( { cssmodules : true , lessloaderoptions : { javascriptenabled : true , modifyvars : themevariables , // make your antd custom effective } , ...
hello , i 'm looking for a way to set active tab style on link elements defined in the custom _document . what i found online is ways that use the router to get the pathname and set the active class based on the href if they 're equal . so far the router always returned null , and i read in the docs that _document only runs on the server . do you think there might be workarounds for this ? ? < code >
i ca n't send any data using a post request in nextjs . in the api route , i receive the request and can send a response back ... but i could n't receive the data that i 've sent from the client . so , my req.body shows an empty object : { } heres how i 'm sending data from the client using axios : and here 's how i 'm handling the data on /api/hello route : < code > axios.post ( `` /api/hello '' , { data : `` hi there '' } ) .then ( res = > { console.log ( res ) } ) .catch ( e = > { console.log ( e ) } ) export default ( req , res ) = > { if ( req.method === 'post ' ) { console.log ( req ) console.log ( req.body ) //this returns an empty object , why ? ? } else { // handle any other http method } res.statuscode = 200 res.json ( { name : 'john doe ' } ) } '' '
bug report describe the bug i 've setup my project like in this project and i want to use some api routes , so i have created the function and everything in the api folder and stuff . anyways , when i run the app with next dev i get the following error : this is the api function code , just in case : what could i be doing wrong ? how can i solve this ? thanks in advance system information os : macos version of next.js : 9.5.1 version of node.js : 12.18.1 < code > export default async ( req , res ) = > { const { site } = req.query ; if ( ! site || site.length < = 0 ) return res.json ( [ ] ) ; const request = await fetch ( ' < url > } ' ) ; const response = request.json ( ) ; return res.json ( response.data ) ; } ;
next.js really does n't want you to do server side functions on your 404 page : error : pages/404 can not have getinitialprops/getserversideprops , < url > but sometimes this is preferable . in an ideal world you could add getserversideprops to do custom 301 redirection and otherwise you can do a router.push client side . the behavior i 'm looking for is something like : 404.js : /old/blog - > 301 to /blog /gone/page - > 404 in this case / * - > 301 to / is there a workaround to doing custom server-side response statuses for seo reasons ? < code >
i am setting up my project for sentry , i need to get my github commit sha , from what i discovered each commit has it 's own sha , b ut what the setup is requesting seems to me like a single value . please , how do i go about this ? < code >
is there any way to load next.js chunks ( < nextscript / > ) with the type= '' text/javascript '' or some other custom tags ? it seems that there are third-party tools , like onetrust to handle cookie or third-party scripts consent regulation that might prevent loading necessary js chunks because it might automatically categorize them as some functional / tracking scripts . < code >
with recent releases it seems next.js is coming to ssg space . but i am wondering how to you guys plan to implement the data layer ? ex : gatsby 's graphql . data layer is important to separate data ( ex : blog post content ) from the template and to have easier integration with headless cmses . < code >
i 'm creating a test application that uses files in serverless function . repository : makutamoto/vercel_test according to this , i created vercel.json like this : and created test application that tests whether files are uploaded or not . however , when i access api/hello , i get the following results . it seams that files i specified so far are not uploaded to serverless function . i want to know how to fix this problem . help . < code > // pages/api/hello.tsx // next.js api route support : < url > import fs from 'fs ' ; import { nextapirequest , nextapiresponse } from 'next ' const handler = ( req : nextapirequest , res : nextapiresponse ) = > { res.statuscode = 200 ; res.json ( fs.readdirsync ( __dirname ) ) ; } export default handler { `` functions '' : { `` pages/api/hello.tsx '' : { `` includefiles '' : `` _files/ * '' } } } [ `` bin '' , '' boot '' , '' dev '' , '' etc '' , '' home '' , '' lib '' , '' lib64 '' , '' media '' , '' mnt '' , '' opt '' , '' proc '' , '' root '' , '' run '' , '' sbin '' , '' srv '' , '' sys '' , '' tmp '' , '' usr '' , '' var '' ]
on my computer , in dev environement it works well . in production , when i go to the home ( index.ts ) i land on the 404 page . there is no error . any idea how can i debug this ? thanks < code >
hi , i want to load moment.js library on useeffect hook . - ( not by traditional way of js loading ) as moment.js library was too big which will be slow down my page loading performance .. may i know how to load import library on useeffect or other function .. < code >
bug report describe the bug i 'm using a custom server implementation of next . i am having an issue in dev mode which is not reproducible outside of dev mode . basically , when i launch next in dev mode then the client react methods are not called ( ie componentdidmount ) const app = next ( { dev , quiet : false } ) ; when i launch the app without dev mode after running 'next build ' : const app = next ( { quiet : false } ) ; then the client side lifecycle methods are called appropriately . i 'm guessing i 'm probably doing something wrong somewhere in my application but i am new to next and any help / pointing to the right direction would be appreciated . please let me know what other information may be relevant to help reproduce . i recently upgraded next , it was previously working ( on 8.1.0 ) . expected behavior i would expect dev mode to call the same lifecycle as the production build . system information os : macos version of next.js : [ 9.5.0 ] version of node.js : [ 10.16.0 ] additional context add any other context about the problem here . < code >
i found in next js blog article that next js provide old browser support with polyfills . does that mean it supports html semantic elements , other js syntax like intersection observer api etc. ? < code >
hi , i my account login i have url like this : mydomain.com ? redirect=/user ? addtoken=token123 & item=321 the page will redirect to /user ? addtoken=token123 & item=321 yes , it work but the itm=321 was lost . i just have /user ? addtoken=token123 in new page did i do something wrong ? < code >
this might be the dumbest question on this forum , but i had to ask it . maybe i am understanding this all wrong , but my goal is to make the dynamic routes work in an exported next js app . based on what i understood from the docs , i have to declare all possible routes in getstaticpaths for ssg to work properly , but the routes can be based on which user logs in and might be completely database driven , which is not possible to know at build time . considering that scenario , is nextjs ssg a good option , knowing that i have limitation of not being able to run server side rendered next app . the pages - pages/index.js pages/product/ [ name ] .js < code > const product = ( { name } ) = > { return ( < div > < h1 > hi { name } < /h1 > < p > welcome to our product page for { name } ! < /p > < /div > ) ; } ; export async function getstaticprops ( context ) { return { props : { name : context.params.name } , } ; } export async function getstaticpaths ( ) { return { paths : [ `` /product/coffee '' ] , fallback : false , } ; } export default product ; import link from `` next/link '' ; const home = ( ) = > ( < div > < h1 > test site ! < /h1 > < p > view our { `` `` } < link href= { '/product/coffee ' } > < a > espresso product < /a > < /link > ! < /p > < /div > ) ; export default home ;
im trying to use absolute paths with nextjs , but vscode complains it can not resolve the module . nevertheless , the site is working ok. my jsconfig.json file : how im trying to import the component : my folder structure : vscode error message : < code >
hi , i 've updated next to the latest version ( 9.5.0 ) and one of the new features was that now it support res.redirect helper function similar to express . however , when i tried to use it during ssr , it gave me an error : i took examples from this commit . even though those changes were undone later , i suppose that now , when this feature is released , it should work . my code : what do i do wrong ? thanks , simon < code > typeerror : res.redirect is not a function export const getserversideprops = async context = > { const { req , res } = context ; const session = await getcurrentsession ( { req } ) ; if ( session ) { res.redirect ( '/dashboard ' ) ; return ; } return { props : { } } ; } ;
hello , i recently updated my create-next-app script , which caused a behaviour to break . earlier ( in version 9.4.4 ) whenever i executed npx create-next-app , i would be asked what is your project named ? pick a template default starter app example from the next.js repo but in the version 9.5.1 , this is broken . the user is only prompted for the q1 above , and not for q2 as well . i want to know whether this is intentional ? < code >
hi , spent almost the entire morning on this so now i have to ask your help : ) i am using a react package called scroller-motion . i wanted to make some changes for my app , and do a pr to contribute to the package . however , i can not get a local version of the package to work , in whatever way i try . i 've tried all kinds of things : using npm link , both from a different folder as the project root folder npm installing directly from github cloning straight into the node_modules directory npm installing from a local path and i keep running into this error : it seems the package is including its own copy of react even though it 's listed as a peerdependency . something to do with webpack perhaps ? anyone has experience with this , how to work around it ? it baffles me that it is this hard to contribute to open source .. < code >
i 'm in a bit of a quandry at the moment and i wonder if someone can help me figure this out . i have a simple application . you login , then it should take you to a 'userdetails/create ' page allowing the user to populate some more data . my current plan is to utilise getserversideprops to : ensure user is logged in get existing user details return to page as props at the moment i 'm using an api to get the existing user details . but all this does is : ensure user is logged in access the database do a select return some data or various error types i guess my question is . what is the point of doing the api call if all it 's doing is accessing a database on the serverside . why dont i just access the database directory to solve my problem ? this would save me doubling up the authentication check reduce network costs as i wont need to do an api call the page , api and also the db connection / user details service layer are all within the same codebase . < code >
i 'm using `` next '' : `` ^9.4.4 . have deployed to vercel and getting the error - request failed with status code 405 while trying to signin / signup or any post request using the vercel url . working fine while using heroku deployment . < code >
i have a form in my homepage than when submitted it adds data to a database . i have it coded so that it sends a fetch with post to /api . it works perfectly , however i 'm worried anyone could use for example postman and add a lot of records to my database . what 's the proper and easier way to secure my api so that it can only get requests from my website ? < code >
i am using getinitialprops in pages for initial data populating . so anyone go website directly or press f5 getinitialprops do n't work . only working when next/link or next/router navigate . how can i fix this ? postdetail.getinitialprops = async ( ctx ) = > { await ctx.store.execsagatasks ( ctx.isserver , ( dispatch ) = > { const { post } = ctx.query ; dispatch ( getpostdetailrequest ( { slug : post , loaderstart : true , token : parsecookies ( ctx ) .token , isserver : true } ) ) ; } ) ; return { } ; } ; < code >
i 'm using `` next '' : `` ^9.4.4 . have deployed to vercel and getting the error - request failed with status code 405 while trying to signin / signup or any post request using the vercel url . working fine while using heroku deployment . < code >
i 've created an app with a js ( node.js ) serverless function in /pages/api/seed-data.js . i created a pr and on the vercel ci server ( < url > ) , i 'm able to access that api route . ( /api/seed-data ) i also included the go sample file from < url > in that same directory . i expected that a call to /api/date to work . however , i 'm getting a 404. as a related question , is it possible to test such a serverless endpoint locally ? do i need to run vercel dev and have installed go locally on the host first ? or would it run the go code in a container so the host does n't need go to be installed ? < code >
feature request is your feature request related to a problem ? please describe . some module is check regex flags has u or not but useunicodeflag did n't enable by default this case unknown bug for we ca n't see it and almost all current browser support it describe the solution you 'd like describe alternatives you 've considered a clear and concise description of any alternative solutions or features you 've considered . additional context add any other context or screenshots about the feature request here . < code > `` @ babel/plugin-proposal-unicode-property-regex '' , { `` useunicodeflag '' : true }
hello , i was suffering from an infinite loop when running the firebase authentication example , which i was able to fix with an early return if the app is already on the route , but for some crazy reason , if i change the following line i get syntaxerror : if i change if ( ! cookie ) { to if ( ! cookie & & router.route ! == '/ ' ) { , or even if ( false ) { , i get : it only works if i create a completely new if block : i 've tested creating a new app from scratch with yarn create next-app -- example with-firebase-authentication test and changing the line , same error . what is happening ? do you guys get this error ? < code > if ( router.route ! == '/ ' ) { return } if ( ! cookie ) { router.push ( '/ ' ) return }
bug report vscode complains it is unable to resolve path to module when using absolute paths , but modules are found when run `` npm run dev '' . to reproduce download the branch custom_eslint_config from the following repository and open it in vscode : < url > expected behavior vscode should not complain about absolute paths which actually work . screenshots my jsconfig.json : vscode complaining about the absolute path : my folder structure : system information os : [ ewindows ] version of next.js : [ 9.3.5 ] version of node.js : [ 12.8.0 ] < code >
bug report describe the bug exporting static builds ends up with setting 'text/html ' on css files , which in turn circumvents the rendering of these files . to reproduce steps to reproduce the behavior , please provide code snippets or a repository : create a new next app run the build script run the export script use something like npx serve ./out to serve the contents of the /out folder you 'll notice in the console a bunch of mime type errors when relating to css . issue does n't seem to happen when using a node-sass build . expected behavior the export script should correctly generate mime types for each file type system information version of next.js : 9.5.1 < code >
i 'm developing a website that fetches data from a cms on getstaticprops . one of the fields it fetches is a list of pictures in binary format . currently i 'm converting the pictures to base64 and appending them directly into the html , but that increases the html size by a lot and makes the website 's load very slow . as a solution , i would like to store the images i fetch on every build , and just pass the paths to the html . is there a good practice to do this ? it seems like a common scenario . would copying the file to /public work ? thank you ! edit : i 've seen recommendations of using s3 or any external file system . i 'd like to avoid this added complexity if possible . ideally this should just store the fetched images on .next/static/images like the rest of the images of the website . the fetching will only happen on build time ( getstaticprops ) , so this should n't be a problem technically . < code >
i use aws cloudfront as cdn and want to deploy static pages to s3 and deliver server-side rendered pages using lambda @ edge . i want to use path patterns to be able to route between s3 and lambda @ edge . is it possible to configure a custom route prefix for static pages in next.js ( e.g . static/ ) , so that any request that matches /static/ * is forwarded to s3 and any non-matching request is forwarded to lambda @ edge ? < code >
when i add getstaticprops the page is no longer pre-rendered ( but the html is available in view source ) and going back and forth between two such pages is very slow as it builds them each time . is n't the point of getstaticprops to enable pre-rendering ? < code >
bug report describe the bug a clear and concise description of what the bug is . to reproduce the usage of console.log console.error etc .. do n't get pushed to the deployed application realtime logs and i found no way to send them except if i use throw ( `` my error '' ) steps to reproduce the behavior , please provide code snippets or a repository : console.log in you next.js app and deploy to vercel expected behavior send logs to the functions logs console . a clear and concise description of what you expected to happen . screenshots if applicable , add screenshots to help explain your problem . system information os : [ e.g . macos , windows ] browser ( if applies ) [ e.g . chrome , safari ] version of next.js : [ e.g . 6.0.2 ] version of node.js : [ e.g . 10.10.0 ] additional context add any other context about the problem here . < code >
i 'm still new using next.js hope someone can help . on initial page load the active link will have a background color because the slug state === nav if i share a link the tuesday nav will be highlighted but when i try to click another nav item e.g wednesday the state is not updated . the highlighted nav is still in tuesday i would like to update the slug state onclick and add a background color on selected nav while remove the background on the current one . thank you < code > import react , { usestate , useeffect } from 'react ' ; import { userouter } from 'next/router ' ; const navlinks = [ 'monday ' , 'tuesday ' , 'wednesday ' , 'thursday ' , 'friday ' ] ; const nav = ( ) = > { const router = userouter ( ) ; const [ slug , getslug ] = usestate ( `` ) ; useeffect ( ( ) = > { getslug ( router.aspath.split ( ' # ' ) .pop ( ) ) ; } , [ ] ) ; return ( < > < div classname= '' d-flex justify-content-between mb-3 '' > navlinks.map ( ( nav ) = > ( < a href= { '/days # < cur > { type.lowercase ( ) } ' } key= { nav.tolowercase ( ) } classname= { 'col < cur > { nav.tolowercase ( ) === slug ? 'current ' : `` } ' } onclick= { ( ) = > getslug ( nav.tolowercase ( ) ) } role= '' link '' > { nav } < /a > ) ) } < /div > < / > ) ; } export default nav ; www.agenda/days # tuesday
hello , i 'm new to ssr and i wanted to learn nextjs so i decided to use the pokeapi to make a simple pokedex that works this way : search for pokemon see a list that consist on the pokemon you search for and type like pokemons click on one pokemon and enter a detailed page with it 's data . the app works by me making a request to the pokeapi each time the users search for a pokemon , i have zero data stored on the app . all the data needed for the details is fetched on the first search two issues i have encountered that i have not been able to sort reading the docs : i 'm not entirely sure how to pass the already fetched pokemon data that is already on the search result ( index ) page to the dynamic route page for previewing the detailed information . i can pass a couple of query parameters but i 'm not sure how to get the entire object to the detailes page . before making this work i noticed that the page with the search result is not cached so each time i go back from the details page ( the one that i mentioned above that is currently empty ) the search page is empty again as if i have n't search anything . i 'm sorry if i 'm too much of a noob but i 'd like to ask : what am i missing here ? what should i be looking into ? < code >
i want to use getserversideprops with firestore , so i added firebase-admin . it had no problem when next dev , but i could not do next build . the error is like this in detail , please check this pr and github actions result mikan3rd/commitly # 60 ( oddly enough , the build has been successful on the vercel where i 'm hosting it . ) i need your help ! < code > > build error occurred error : error reading first path in the walk /protos error : enoent : no such file or directory , lstat '/protos ' at eventemitter. < anonymous > ( /users/mikan3rd/practice/commitly-next-web/.next/serverless/pages/profile/ [ username ] .js:89524:28 ) at object.oncewrapper ( events.js:422:26 ) at eventemitter.emit ( events.js:315:20 ) at fn ( /users/mikan3rd/practice/commitly-next-web/.next/serverless/pages/profile/ [ username ] .js:89359:17 ) at statter ( /users/mikan3rd/practice/commitly-next-web/.next/serverless/pages/profile/ [ username ] .js:89396:7 ) at walkdir ( /users/mikan3rd/practice/commitly-next-web/.next/serverless/pages/profile/ [ username ] .js:89528:3 ) at function.module.exports.ftcu.walkdir.sync ( /users/mikan3rd/practice/commitly-next-web/.next/serverless/pages/profile/ [ username ] .js:89274:10 ) at object. < anonymous > ( /users/mikan3rd/practice/commitly-next-web/.next/serverless/pages/profile/ [ username ] .js:164967:6 ) at object.b1/w ( /users/mikan3rd/practice/commitly-next-web/.next/serverless/pages/profile/ [ username ] .js:165211:30 ) at __webpack_require__ ( /users/mikan3rd/practice/commitly-next-web/.next/serverless/pages/profile/ [ username ] .js:23:31 ) at object.qlmp ( /users/mikan3rd/practice/commitly-next-web/.next/serverless/pages/profile/ [ username ] .js:228240:16 ) at __webpack_require__ ( /users/mikan3rd/practice/commitly-next-web/.next/serverless/pages/profile/ [ username ] .js:23:31 ) at object.c0x5 ( /users/mikan3rd/practice/commitly-next-web/.next/serverless/pages/profile/ [ username ] .js:169363:22 ) at __webpack_require__ ( /users/mikan3rd/practice/commitly-next-web/.next/serverless/pages/profile/ [ username ] .js:23:31 ) at firebasenamespace.get [ as firestore ] ( /users/mikan3rd/practice/commitly-next-web/.next/serverless/pages/profile/ [ username ] .js:276997:29 ) at module.jis5 ( /users/mikan3rd/practice/commitly-next-web/.next/serverless/pages/profile/ [ username ] .js:203713:27 ) error command failed with exit code 1 .
hi , by following nextjs examples , i 'm aware that calls to router.push/replace should be wrapped into useeffect hooks . however , i did not find a clear explanation as to why we should do : over can someone clarify as to why one pattern should be used over another ? or are they both correct ? thank you < code > function mycomponent ( { somepropthatchecksforredirect } ) { const router = userouter ( ) ; if ( somepropthatchecksforredirect ) { router.push ( `` / '' ) ; return null ; } return < div > hello < /div > ; } function mycomponent ( { somepropthatchecksforredirect } ) { const router = userouter ( ) ; useeffect ( ( ) = > { if ( somepropthatchecksforredirect ) { router.push ( `` / '' ) ; } } , [ somepropthatchecksforredirect ] ) ; return < div > hello < /div > ; }
as per this previously answered question regarding _app.js not supporting getstaticprops , the answer says : this is just an initial restriction as we want to make sure we provide the right abstraction for it in _app this will be a game changing addition for me , so i 'm really excited to see it . is there a known timeframe for this work ? < code >
hi 👋 i 'm currently building a website where i can static and dynamic pages . the landing page is static but one of the other pages is completely dynamic and needs getserversideprops . therefore , i ended up removing next export from my built command . i was hoping if there is any option to use next export and pages with getserversideprops with at the same time . the command i execute is next build & & next export -o build but it fails because of the getserversideprops function : thanks for your help and patience ! < code > > using build directory : /users/kcubero/projects/gitlab.com/web-v2/.next copying `` static build '' directory > no `` exportpathmap '' found in `` next.config.js '' . generating map from `` ./pages '' launching 15 workers copying `` public '' directory [ == ] exporting ( 0/4 ) error occurred prerendering page `` /s/ [ search ] '' . read more : < url > error : error for page /s/ [ search ] : pages with 'getserversideprops ' can not be exported . see more info here : < url > at object.exportpage [ as default ] ( /users/kcubero/projects/gitlab.com/web-v2/node_modules/next/dist/export/worker.js:14:254 ) exporting ( 4/4 ) error : export encountered errors on following paths : /s/ [ search ] at exportapp ( /users/kcubero/projects/gitlab.com/web-v2/node_modules/next/dist/export/index.js:24:1103 )
i have a next.js project at work that needs to host html . ( sometimes the outsourced company ca n't write react . ) so i decided to host the html files in the public directory , but there 's one problem . for example , i put the html file in /public/example/index.html . i can access it at phofurl but if i go to phofurl i get a 404 not found . it would be better to be able to specify the index , like expressjs/serve-static . please let me know what you think . < code >
feature request my cdn has redirect/rewrite capabilities at the edge . i would like to leverage those capabilities to enable next.js static export for use with fully dynamic routes ( no getstaticpaths ) . is your feature request related to a problem ? please describe . i do n't believe there 's a problem . i 'm running a server right now , but since i do n't do any ssr i 'd rather turn off the server and serve static files . describe the solution you 'd like ideally , when i run next export it would output what rewrite mappings i should configure with my cdn provider . this should be machine readable so i could automatically update my cdn on deploy . describe alternatives you 've considered i 'm running a server right now , which certainly works . i 've found a few threads indicating this might be possible already , but i was n't able find a conclusive path forward . it looks like some of what may have been possible in the past may no longer be possible - as far as i 've found there 's no officially supported approach . here 's one such thread : # 2542 < code >
after upgrading to next 9.5.1 this issue started popping up when running next in production . a short term solution could be adding webpack to dependencies , but i 'm not sure about the proper solution . < code > error : can not find module 'webpack ' require stack : - /node_modules/mini-css-extract-plugin/dist/index.js - /node_modules/mini-css-extract-plugin/dist/cjs.js - /node_modules/ @ zeit/next-css/css-loader-config.js - /node_modules/ @ zeit/next-sass/index.js - /next.config.js - /node_modules/next/dist/next-server/server/config.js - /node_modules/next/dist/next-server/server/next-server.js - /node_modules/next/dist/server/next.js - /node_modules/next/dist/server/lib/start-server.js - /node_modules/next/dist/cli/next-start.js - /node_modules/next/dist/bin/next at function.module._resolvefilename ( internal/modules/cjs/loader.js:965:15 ) at function.module._load ( internal/modules/cjs/loader.js:841:27 ) at module.require ( internal/modules/cjs/loader.js:1025:19 ) at require ( internal/modules/cjs/helpers.js:72:18 ) at object. < anonymous > ( /node_modules/mini-css-extract-plugin/dist/index.js:7:16 ) at module._compile ( internal/modules/cjs/loader.js:1137:30 ) at object.module._extensions .. js ( internal/modules/cjs/loader.js:1157:10 ) at module.load ( internal/modules/cjs/loader.js:985:32 ) at function.module._load ( internal/modules/cjs/loader.js:878:14 ) at module.require ( internal/modules/cjs/loader.js:1025:19 ) { code : 'module_not_found ' , requirestack : [ '/node_modules/mini-css-extract-plugin/dist/index.js ' , '/node_modules/mini-css-extract-plugin/dist/cjs.js ' , '/node_modules/ @ zeit/next-css/css-loader-config.js ' , '/node_modules/ @ zeit/next-sass/index.js ' , '/next.config.js ' , '/node_modules/next/dist/next-server/server/config.js ' , '/node_modules/next/dist/next-server/server/next-server.js ' , '/node_modules/next/dist/server/next.js ' , '/node_modules/next/dist/server/lib/start-server.js ' , '/node_modules/next/dist/cli/next-start.js ' , '/node_modules/next/dist/bin/next ' ] }
i 'm logging with sentry and following the with-sentry example . but i want to add the release property to my sentry.init call . the example uploads the sourcemaps using the option.buildid as its release propery in the next.config.js file . and i want to match that when running sentry.init . is it possible to have the buildid as an env variable in both server and client ? < code >
when i 'm using process.env.mongodb_uri in my app then there is an error on the pages that uses the process.env : 502 : bad_gateway code : no_response_from_function this occurred on deployment to vercel . the keys exist in the environment variables and the use in code is like the following : process.env.mongodb_uri when i change the use in the application instead of process.env to a hardcoded uri everything works fine . next '' : `` version '' : `` 9.5.0 '' < code >
an unanswered related post # 13763 what can i reduce server response times using ssr + getinitialprops / getserversideprops to fetch data ? it 's for a better ux , speed index and load performance . i think it 's something that everyone using next.js want to know about . environment : next : 9.3.6 react : 16.13.1 react-dom : 16.13.1 @ material-ui/core : 4.9.12 @ material-ui/lab : 4.0.0-alpha.51 node : 10.20.1 npm : 6.14.4 os : linux debian 4.9.0-12-amd64 recently next.js lanched getstaticprops and getserversideprops and i noticed that it 's recommended using getstaticprops instead of others for seo . nextjs.org/docs - data fetching , when-should i use getstaticprops the main issues are described in the screenshots below : old discussions : < url > @ spectrum.chat/next-js-and-google-pagespeed-optimisation < code >
hi all , i 'm currently migrating an e-commerce cra/redux to nextjs and trying to find the best way to keep the existing multilingual routing for seo purposes . for example , i have a dynamic route to display recipes . in english the route is /recipe/ : id , in french it 's /recette/ : id and i also have a shortened one /r/ : id . id is a dynamic parameter associated to a recipe 's unique identifier . what is the best way to reproduce this using nextjs ? i want to do this without creating locales sub-paths ( and associated redirections ) . all help appreciated 🙏 i 've tried different solutions but still struggling which one is the best : 1. duplicated pages and paths which is very painful and seems to be a lot of duplicated code ... 2. use dynamic routes which only works ( in my understanding ) with getstaticpaths but will catch every other pages with the same `` logic '' ( /my-account/ ( en ) === /mon-compte/ ( fr ) ) ... 3. create a custom server which is something i do n't really want because i will loose automatic static optimisation ... any other solution [ yours ] < code > pages/ [ recipe ] / [ id ] .js pages/ recipe/ [ id ] .js recette/ [ id ] .js r/ [ id ] .js
in webpack 5 process is no longer defined . @ timneutkens recently added a polyfill for this , but he stated `` this is to not break existing projects '' . my question is : how are new projects supposed to use environment variables in webpack 5 ? the docs still recommend using process.env . * , but they might not have been updated yet . i understand i can use the polyfill , but surely webpack 5 does n't just remove environment variables altogether ? under what accessor are they now available ? < code >
hi , the seo tags does n't get rendered in ssr when using next-seo package . i have tried < nextseo / > to the render code in a next.js page , but no luck . can anyone have workaround solutions by using next-seo with ssr ? thanks . < code >
feature request is your feature request related to a problem ? please describe . when using amp together with amp-script , it 'd be good if the script somehow could be transpiled . for example , if i would like to import preact and build some component i have to either introduce a second build step , or heavily modifiy the current webpack config , if that 's even possible . i 've tried to add custom entries , but they do n't end up in the build manifest so i have no way of getting their path . describe the solution you 'd like the way i see it , there are two ways to go here . one way would be to magically find all the amp script tags on the page that are n't remote and transpile them automatically during build . the other way would be to let users add custom entries in the webpack config that would end up in the build manifest . < code >
i have an app built on create react app which loads the route information ( allowed list of routes for the logged in user ) from the server and generate the routes based on that . for example , the user logs in the app makes a get request to fetch the routes array the app goes through the fetched results and returns a route : my question is , can we do something similar in nextjs ? < code > routes.map ( ( route ) = > < route path= { route } / > )
i run my project locally in firefox using version 49 & 50 and i get syntaxerror : missing = in const declaration . any one can help for this ? < code >
so ... weird behaviour i 've encountered with nextjs 's new static-first focus . for a project with the following structure : i get this .next/serverless/pages structure . now , the way blog/ [ slug ] .js vs the prerendered posts make sense , since that 's using getstaticpaths which i assume can be dynamic , but i 'm a bit suprised to see blog.js there . for reference , this is the getstaticprops logic i have in blog/index.js ... from my understanding , getstaticprops run only at build time , so this should mean that only .next/serverless/pages/blog.html is generated , not .next/serverless/pages/blog.js , yet both are there . does anyone know why both are outputted ? does every file that uses getstaticprops generate a .js file on the serverless build ? and is that designed to allow the hosting platform to refresh the static snapshot ? i thought you had to opt-in to that behaviour ... < code > // blog/index.js import { request } from `` .. / .. /lib/datocms '' export default function blogindex ( props ) { const posts = this.props.posts.allblogposts return ( // .. ) } export async function getstaticprops ( ) { const blogpostlist = ' query blogpostlist { allblogposts { title slug } } ' const posts = await request ( { query : blogpostlist } ) return { props : { posts } } } > tree .next/serverless/pages .next/serverless/pages _error.js about.html blog [ slug ] .js why-my-cat-is-best.html why-my-cat-is-best.json why-dogs-are-overrated.html why-dogs-are-overrated.json blog.html blog.js # < -- - blog.json ... > tree pages pages _app.js _document.js _error.js about index.js blog [ slug ] .js index.js ...
i do n't quite understand how errors ( other than 404 ) are handled . what is the expected behavior if an api route returns an uncaught 500 error ? should the default 500 error page be displayed ? if not , what is an example of when the 500 error page should be displayed ? < code >
i 'm using redux ( with next-redux-wrapper ) to store the user data when he is logged in . but the store is not persistent ( and i found complicated using redux-persist ) so i 'm using localstorage to save the data and recover it . this looked to be working fine until i noticed some elements that use the user data are not being rendered correctly . this is how my selector hook looks this is how it looks when it uses localstorage this is how it looks without it i 'm using localstorage so i do n't need to fetch the profile every time the page is reloaded , without it for few seconds it looks like if the user is not logged in . so is there a fix or better way of doing this ? < code > export const useuserselector = ( ) = > { const { data } = usetypedselector ( ( state ) = > state.user ) // redux store is not persistent , so lets check if the profile is saved in the webstorage // if i comment this , the elements get rendered correctly if ( ! data ) { const profilefromwebstorage = getprofile ( ) if ( profilefromwebstorage ) { return profilefromwebstorage } } return data }
hello guys . after nextjs build it doesnt send any http requests to the api . api calls written in getstaticprops but in dev mode everything is okey . any suggestions ? i 'm new in next . < code >
can fallback : true be used as a check to determine whether the router exists or not . so if isfallback is true . i can conditionally render page doesnt exists or something else . is this correct according to the good practices ? i tried it , it works but the code for content page also runs as if ( router.isfallback ) { return 404 } else { content } i am not passing any staticprops so it is giving an error . < code >
none of my pages is specified as needing a serverless function , but a serverless function is still created , named _next_page_lambda_0 my output looks like this if the context of the code helps , it is this branch of this repo < url > < code > page size first load js -- 19:16:54.636 | / 27.2 kb 85.5 kb 19:16:54.636 | /_app 275 b 58.4 kb 19:16:54.636 | /404 3.25 kb 61.6 kb 19:16:54.636 | + first load js shared by all 58.4 kb 19:16:54.637 | static/pages/_app.js 275 b 19:16:54.637 | chunks/b1f7f5a8a27fcde646c27c850cdb3d62ad483f1c.a1a019.js 10.5 kb 19:16:54.637 | chunks/framework.4dd100.js 40.3 kb 19:16:54.637 | runtime/main.e836bc.js 6.54 kb 19:16:54.637 | runtime/webpack.c21266.js 746 b 19:16:54.637 | css/4994a887f3aa593846f0.css 2.36 kb 19:16:54.637 | ( lambda ) server-side renders at runtime ( uses getinitialprops or getserversideprops ) 19:16:54.637 | ( static ) automatically rendered as static html ( uses no initial props ) 19:16:54.637 | ( ssg ) automatically generated as static html + json ( uses getstaticprops ) 19:16:59.994 | traced next.js serverless functions for external files in : 5248.054ms 19:17:01.022 | compressed shared serverless function files : 1028.157ms 19:17:01.140 | all serverless functions created in : 118.047ms
i 've just tried to create a dynamic route like /shops/ [ shop ] /products.ts ( so there 's a [ shop ] folder ) . when i access req.query.shop , it is undefined . just wanted to confirm that this not supported ? i 'm aware i could probably work around it with catch-all routes . < code >
for info on feature toggles : < url > as far as i can see , one needs ssr when wanting to release features to only some of one 's users , for example only logged in users should get the new features , or only 10 % of the users , etc . we are using this all the time to make sure we make stuff that users actually use . the problem with this is of course not being able to take advantage of caching of static pages , i.e . it will be a small number of variants for each page which actually should be easy to cache . does anybody have a good solution in next.js for this use case ? < code >
hello ! now i have been wondering , is there any way to load a css stylesheet for a specific component and not globally ? i have tried to : 1 ) import the css stylesheet into the file , 2 ) use the < link > tag to include the .css file . but none of them worked < code >
enabling `` strict '' : true results in an error . i ca n't find it mentioned anywhere in the documentation . is there anything that would be helpful ? components/test.tsx pages/index.tsx argument of type ' ( ) = > promise < ( ( ) = > jsx.element ) | componentclass < never , any > | functioncomponent < never > | { default : componenttype < never > ; } > ' is not assignable to parameter of type 'dynamicoptions < { } > | ( ( ) = > loadercomponent < { } > ) | loadercomponent < { } > ' . < code > const dynamiccomponentwithnossr = dynamic ( ( ) = > import ( `` .. /components/dynamicimporttest '' ) .then ( ( mods ) = > mods.dynamicimporttest ) , { ssr : false , } ) ; export default ( ) = > { return ( < > < h1 > { `` test '' } < /h1 > < dynamiccomponentwithnossr / > < / > ) ; } ; export const dynamicimporttest = ( ) = > { return < div classname= '' test '' > < /div > ; } ;
i 'm curious if there is a convention to where people put their styles for a next app ? i have been using : does anyone do anything else ? < code > /assets/main.css /public /pages
bug report describe the bug i 'm using powershell inside windows terminal . i 've got a documents folder on another hard drive which is symlinked via a documents-sl link . i navigated through to my dev projects directory via this symlink and got this error when launching my next.js project : to reproduce you must have a directory symlink to reproduce this bug . i am using a documents folder on another hard drive . cd into a symlink directory - ( eg : cd c : \users\abcde\documents-symlink\projects ) run yarn create next-app frontend select the with-typescript example project as a template cd into the ./frontend directory run yarn dev navigate to < url > expected behavior expected the page to load . instead got an error page . system information os : windows 10 x64 [ build 18363.900 ] browser : mozilla firefox 77.0.1 version of next.js : 9.4.4 version of node.js : 14.3.0 additional context i do n't think this is necessary a template issue , or even a next js issue necessarily , but i 'm not sure where the issue stems and someone else may have more luck with debugging/tracing . < code > error - e : /users/offic/documents/_dev/_web/practice-strapi-website/frontend/pages/index.tsx 5:2 module parse failed : unexpected token ( 5:2 ) you may need an appropriate loader to handle this file type , currently no loaders are configured to process this file . see < url > | | const indexpage = ( ) = > ( > < layout title= '' home | next.js + typescript example '' > | < h1 > hello next.js < /h1 > | < p >
after upgrading to 9.5.0 , i 'm getting the following build error : ./src/components/header/header.module.css css modules can not be imported from within node_modules . read more : < url > location : src/components/header/header.tsx i do n't quite understand what 's wrong with what i 'm doing . this is a local css module import . it is n't an import inside of node_modules . the import line looks like this : is it not correctly detecting that ./src/components/header/header.module.css is inside my local project directory ? < code > import styles from './header.module.css ' ;
consider this example why it does n't work and what should i do in order to fix it ? < code > < style jsx > { ' .menu { background : red ; } ' } < style > < menu theme= '' light '' mode= '' horizontal '' classname= '' menu '' > ... < /menu >
hello , i was under the assumption that getinitialprops runs once on the initial page load , but it seems to run every single time i change the route ? if this is the case , how do i do the following situation ( psuedo code ) : so when the user loads the page , it has the jwt in the reactcontext available for use , but as soon as they change routes , the jwt goes missing . how can i persist this jwt between route changes once its fetched once ? if the user transitions on the client side , it should continue to hold the jwt in memory . any help would be greatly appreciated ! < code > app.getinitialprops = ( ) = > { const appprops = await app.getinitialprops ( ) ; if ( isserver ) { // do some stuff return { jwt , ... appprops } } return { ... appprops } }
hi , the intelligent guys .. just want to know in next js the routing is case sensitive or not ? if yes then how i can made in case insensitive . e.g . i have a page `` pages/mybio.jsx '' in browse when i type localhost:3000/mybio then pages gets open but when i type localhost:3000/mybio or localhost:3000/mybio in browser address bar then its not get open .. help please . < code >
hi , im making ssg dynamic routes with getstaticpath and getstaticprops . but im not getting fully reset of state when i change url on client side . the `` x1 '' product items and the border color are persisting even in urlchange . that info comes from an state that i set when page init then change when i click and add more quantity . the expected is to restart all the page and states on route url changes . const [ prods , setprods ] = usestate ( data.products ) what could be wrong ? < code >
am quite new to next.js so please help with my understanding . i am in my _document.js file and am logging the slug property of ctx like so : we have a page called [ slug ] .js and i need this slug name to do some api call in getinitialprops . however , i get 2 query objects : hence , when i do my api call passing the slug parameter , it 's taking favicon.ico instead of the actual slug . how do i get around this issue ? else , is there any other way to get the url parameter in `` _document.js '' ? < code > static async getinitialprops ( ctx ) { const initialprops = await document.getinitialprops ( ctx ) ; console.log ( ctx.query ) ; return { ... initialprops , } ; } { slug : `` the-slug-i-need '' } { slug : 'favicon.ico ' }
i tried with /tags/ [ tags ] .tsx . look like it only works with post slug or id . i added `` tags : [ `` tech '' , ... ] '' in my markdown files to implement tags . fetching tags works fine but how can i create category page ? i am learning next js and i am trying my best not to depend on any third-party libraries . because i want to learn more . is it possible to add the category page in nextjs ssg ? < code >
feature request is your feature request related to a problem ? please describe . it 's not related to a problem , although , would be really nice to add types for the router events since it would be easier to use without having to refer every time to the documentation . i think it 's an easy enhancement that can improve the developer experience . describe the solution you 'd like i would like to have autocompletion for the router events . additional context i added a string literal type for the events , and that 's the result : < code >
is there a way to know when a page is not found ? i tried using statuscode but it 's unreliable . my goal is to detect all 404s and log them through sentry to be aware of which pages are not found and fix those . < code >
i set up absolute paths with tsconfig.json . i got error `` module not found : ca n't resolve ' @ /components/header ' in ~ '' . reproduce : repo tsconfig.json : src/pages/index.tsx : is there anything wrong with that ? do i need any other settings ? < code > . readme.md next-env.d.ts next.config.js package.json src components header.tsx pages index.tsx tsconfig.json yarn.lock import header from ' @ /components/header ' export default function home ( ) { return ( < div > < header / > < /div > ) } { `` compileroptions '' : { ... `` baseurl '' : `` . `` , `` paths '' : { `` @ / * '' : [ `` src/ * '' ] } } , ... }
hi everyone , not sure if this is a bug report or intended behavior but i noticed that if you use router.push , there is no way to mention the prevention of scroll to top , like there is for link . here are the docs for this : < url > it seems like here in the code , there needs to be a check for scroll : next.js/packages/next/next-server/lib/router/router.ts lines 738 to 740 in 23db226 if ( hash === `` ) { window.scrollto ( 0 , 0 ) return @ timer @ timneutkens is there a hidden way to do this and docs just need to be updated or there is a reason for router.push to not support scroll ? @ everyone-else : do you have workarounds in the meantime ? < code >
i have been testing a website < url > build in wordpress where the pagespeed is showing remove unused css from the website . that particular css is actually the minified version of all the css and is preloaded in the header . how can i eliminate the issue < code >
is it safe to use options in router.push ( url , as , options ) to pass state between routes ? currently i 'm migrating a project to next.js and it has references to history.pushstate ( state , title [ , url ] ) . apparently the docs does n't explicitly say this , so is it safe to use this approach ? < code >
hello ! so i 'm letting the user sign in via fetch ( '/login ' , { username , password , etc } ) . the server then sets the users session with express-session ( req.session.user = await user.findone ( { user , password } ) .username ) now , if i refresh the site . everything works . but i want it to happen dynamically without a `` hard refresh '' . how can i solve this ? < code >
hi , i need some help , maybe i am not really aware , i have next ssg project , do next build - revalidation happens periodically , do next-export - nothing happens . as i understand i have to get static update for this case too , have n't i ? < code >
so i was trying out the unstable_revalidate property and deployed it : however i do n't see the statically generated page being updated . i can check this via the timestamp which is being fetched . < url > edit ( 2020-05-14 ) : it seems that pages that implement getstaticprops without getstaticpaths will not be regenerated when using the unstable_revalidate option . < code > // we will attempt to re-generate the page : // - when a request comes in // - at most once every 10 seconds unstable_revalidate : 10 ,
my problem seem # 10256 inside getserversideprops of somepage.js has a part of code which is download a image and push it into public/images directory . if i command next dev , then go to < url > a picture will be downloaded and it can access from < url > but , if i command next start , then go to < url > a picture will be downloaded , but the page < url > show 404 this page could not be found . can anyone help me how to make the image that can accessable if i command next start < code >
hmr was cool on the tin , but causes more problems than it helps ( errors with web-workers , file-update-event thrashing , a bunch of other issues ) . has anyone published a fork with hmr removed ? i 'll love you forever . < code >
i have the following next.config.js file in my application . i want my application to handle the following two situations the application should redirect to some external page like < url > the application should allow some kind of rewrite/redirection to file path in next.js pages folder structure and the next.cofig.js file but nothing seems to be working , can someone help me ! . thank you < code > | -- - pages | -- - [ id ] | -- - company const withsass = require ( `` @ zeit/next-sass '' ) ; module.exports = withsass ( { usefilesystempublicroutes : true , async redirects ( ) { return [ { source : '/ ' , destination : ' < url > } , ] } , async rewrites ( ) { return [ { source : ' : slug/company/details ' , destination : ' : slug/company/index ' , } , ] } , } ) ;
i have seen a feature available with next/router to pre-fetch some of the pages on the fly . ( link from next/link internally uses this ) . and link is not a choice for my requirement . by referring to the example available at documentation , i 've came up with following piece of code in the above snippet neither of them worked ! ! router.push ( path , as ) & router.push ( path ) . am i doing anthing wrong < code > try { await router.prefetch ( '/ [ organization ] /reports/ [ id ] /view ' , '/ < cur > { organization } /reports/ < cur > { reportid } /view ' , ) ; // navigate to page router.push ( '/ < cur > { organization } /reports/ < cur > { reportid } /view ' ) ; // < -- -- -- -- -- -- -- -- -- - not worked router.push ( // < -- -- -- -- -- -- -- -- -- -- -- - not worked '/ [ organization ] /reports/ [ id ] /view ' , '/ < cur > { organization } /reports/ < cur > { reportid } /view ' ) ; } catch ( err ) { console.log ( 'pre-fetch error ' , err ) ; }
bug report describe the bug on ie11 document.referrer is n't set . the return value is just an empty string instead of for example < url > . to reproduce i just set up a small next.js project like recommended in the next.js documentation ( < url > ) after this project set up i started the next.js dev server ( via yarn dev ) . then i visited google.com ( with ie11 ) and searched with a random search term after that i manipulated a search result link via dev tools . the manipulated link has now the href attribute `` < url > '' finally i clicked this manipulated link so that i was routed to my next.js page result : there i can see that document.referrer returns an empty string instead of `` < url > '' expected behavior document.referrer should be set correctly . system information os : windows browser : internet explorer 11 version of next.js : 9.4.4 version of node.js : 12.13.0 additional context an error has already been created on this topic ( # 8365 ) . but at that time the bug was not fixed . < code >
hi , i 'm trying to load a component dynamically inside the getinitialprops . this is an mdx component . it needs to be loaded dynamically based on the language ( i use next-i18next ) . the source code is here : < url > it kinda works , but with an error : anybody might now how i can solve this problem ? tx. , < code > unhandled runtime error error : element type is invalid : expected a string ( for built-in components ) or a class/function ( for composite components ) but got : undefined . you likely forgot to export your component from the file it 's defined in , or you might have mixed up default and named imports
feature request currently , next.js adds web-vitals package and a file that handles it -- into the production bundle . though it may be useful in many cases , my project does not rely on these metrics . it adds an extra kb of code and whatever the parsing resources it needs from the user 's machine . this is n't much , but i think that in line with next.js 's telemetry opt-out we should be able to opt out of this feature as well . describe the solution you 'd like add a flag/setting in next.config.js to opt-out of web-vitals . describe alternatives you 've considered the only thing to do here , as i understand , other than setting up the above flag is to fork next.js . additional context # 15296 < code >
hi , we would like to build a fully offline capable react web application . we usually work with nextjs . the current problem that we are facing is that we are not able to precache all routes of the application , even though they are not making use of ssr . for example : the service worker should precache all pages ( html ) upfront , so that the application is immediately fully offline capable : / /projects /projects/123 /projects/ ? ? ? we tried to use next-offline and next-pwa , but we were only able to precache the static assets . has anybody had a similar requirement and found a solution ? < code > pages - index.js - projects - index.js - [ id.js ]
feature request is your feature request related to a problem ? please describe . i need to do asynchronous setup before running the nextjs compilation , such as creating some additional pages , currently i can not run asynchronous code because the config export must be an object or a function and not a promise describe the solution you 'd like the module.exports object can be a promise nextjs will wait for the promise to finish before compiling describe alternatives you 've considered i considered making a webpack plugin or a webpack loader but the pages files created during webpack compilation are not used by nextjs < code > // next.config.js module.exports = new promise ( ( resolve ) = > { asyncwork ( ) .then ( resolve ( { pageextensions : [ 'js ' , 'jsx ' , 'ts ' , 'tsx ' ] , } ) , ) } )
server.js file example ( page ) returned an empty object from getinitialprops . how to fix ? < code > server.all ( '/example ' , ( req , res ) = > { const actualpage = '/example ' ; const query = req.body ; return app.render ( req , res , actualpage , query ) ; } ) ;
i have a page like hello_there.tsx , but i would like it to be accessible under the url /hello-there . is there a way to do this ? < code >
i presume it 's possible by editing the package.json with the git url of the version you want to try out but i was wondering how everybody else is doing it . < code >
hey all , i have a pretty basic site that uses dynamic routes pulled from a local data file . basically i have ... i 'm using both getstaticprops and getstaticpaths in services/ [ service ] .js as recommended in the docs : note servicedata is an object imported from my data.js file which is in the root folder of the project . there 's no api call being made here . in [ service ] .js i 'm using reacts usestate to track a currently selected activesubservice , which is only populated ( via setactivesubservice ( 'subservice ' ) ) when the user clicks on one of the `` sub services '' on the service page . when i navigate from one dynamic [ service ] .js route to another i noticed that if i had selected a sub service ( thereby firing setactivesubservice ( ) ) the next route still has the active sub service set from the previous page . is this expected ? currently i have to add some extra checks to make sure that the data is n't junk since the state is completely invalid . am i doing something wrong here ? thanks ! < code > /services ( services/index.js ) /services/ [ service ] ( services/ [ service ] .js ) export const getstaticpaths = ( ) = > { const paths = object.keys ( servicedata.services ) .map ( ( service ) = > ( { params : { service } , } ) ) return { paths , fallback : false } } export const getstaticprops = ( ) = > { return { props : { pagedata : servicedata , } , } }
in the with-apollo example if we disable apollo caching and return the queried results as props from getserversideprops , is it possible to do pagination from client side , in this case , how do get hold of refetch reference since first usequery happened on server side ? if caching is on , then usequery on client side pulls the data from cache and you can get refetch funciton how does it work with no caching ? < code >
page home component gallery component home - > gallery - > photo in order to avoid deep and complex props delivery , i would like to access the data for ssr directly from the photo component rather than props . ( like a redux but excluding the use of context api , redux ) if you have any ideas for this , please help . : ) < code > const home = ( { data } ) = > { < gallery data= { data } / > } export const getserversideprops : getserversideprops < props > = async ( context : getserversidepropscontext ) = > { const { channelname : brandurl , id } = context.params const apolloclient = initapollo ( ) const productqueryresult : apolloqueryresult < productquery > = await apolloclient.query < productquery , productqueryvariables > ( { query : productdocumentquery , variables : { channelproductno : number ( id ) , // @ ts-expect-error brandurl , } , } ) // extract cache const initialstate = apolloclient.cache.extract ( ) return { props : { initialstate , data : productqueryresult ? .data , pagetype : pagetype.product , } , } } const gallery = ( { data } ) = > { < photo data= { data } / > }
i was disoriented when i wanted to use react-google-charts in the project vuejs , i tried and i knew that without the reactjs environment react-google-charts would n't work . thanks ! < code >
i 'm stumped on how to do this . at the moment i have similar routing as the example starters : what i 'd like to do is if it is a series post : has anyone done this or have any ideas ? < code > pages/blog/ [ slug ] .tsx -- > https : // ... /blog/my-post /blog/ [ series-name ] / [ slug ] .tsx # # toc 1. getting started -- - > https : // ... /blog/my-series/getting-started 2. yadda yadda yadda -- - > https : // ... /blog/my-series/yadda-yadda-yadda
we 're deploying a next.js app to production with npm run build & & npm run start , i can imagine we need node_modules for the next server but we do n't need them all , packages like formik are n't needed after build right ? do we move these to devdependencies ? < code >
hey 👋 i 'm using the recent getserversideprops on a 9.4 nextjs app hosted on vercel . when i develop locally , i can reach a page , let say /pages/test/ [ test ] .ts without any problem . test is a random id , let 's say `` 1 '' . i made a simple page that display the test value . works great . when i push it to vercel , this page ( /test/1 ) is not found ( 404 ) . it should be rendered by a function . i do n't even see a function invokation in the vercel dashboard ... what is weird is i can reach e.g . < url > ] ( the link should work , it 's a test page without any auth ) . so , meh , is that normal ? did i miss something obvious ? thanks for you help edit : more infos : this /appis just a custom prefix handled by a custom function until basepath lands ( 9.4.5 ? ) i could use query params . pretty sure it will work ; but not the intended ux . < code >
it seams that all apollo examples was moved to ssg 😢 . there was one left showing how to make the plain-old ssr using @ apollo/react-ssr ? < code >
based on the multi-zone doc , i gather that the `` proper '' way to structure multiple next.js apps is by having each of them have a package.json + configurations files . that is , the project directory should look something like this : the obvious draw back of this set up is that there 's a lot of duplicate configuration code that could have been shared between the apps . some of the duplications can be worked around , but before embarking on that journey it would be greatly appreciated if a member of next.js 's development team to chime in on whether this is the `` expect '' / `` support '' setup . < code > app1 package.json next.config.js .. ( other configuration files tsconfig.json , .eslintrc.json , etc . ) src/ app2 package.json next.config.js ... src/ app3 package.json next.config.js ... src/
hey all ! : ) i have got a question about getserversideprops and .json file which is being returned straight after request . i have a problem as i am serving my website on a subdomain , called /test-poc , unfortunately , next.js is not adding the assetprefix into this call , it is calling _next/data directly . i have gone through all of the docs and codebase , and can not find any way how i can either change this call or disable it . does anyone know how to do any of this ? : ) thank you in advance ! < code >
greetings . i 'm trying to 'catch all routes ' by using [ ... example ] and pass to my dynamic component with initialprops some data for fetching it . the problem is that i 'm using with 'href ' - where i 'm passing some data that i need to do not show in url , so i include 'as ' prop to ( for optional decorating of the url ) and as a result in [ ... example ] , context.query of 'href ' is overwritten by 'as ' . so the question is : does as is really optional decoration ? and why it overwrites an context data ? < code >
what is the best way to pull global site data ( site name , global nav data , etc ) from a cms ? does n't seem very efficient to pull that sort of data on every page . the alternative is running a script to pull that data before the site builds and save it to a json file . it feels like there should be a cleaner solution to this built into next . does anyone have a better solution ? < code >
can anyone provide example next.js code for the graphql mutation shown below ? this mutation works perfectly in graphql playground . mutation add author with query variables mutation createauthor ( < cur > input : createauthorinput ! ) { createauthor ( input : < cur > input ) { author { name } } } query variables { `` input '' : { `` data '' : { `` name '' : `` sam '' } } } result { `` data '' : { `` createauthor '' : { `` author '' : { `` name '' : `` sam '' } } } } < code >
hi , i am trying to serve a static website inside public/nesteddir/ . inside nesteddir i have an index.html file . now , i can get to the file if i do localhost:3000/nesteddir/index.html , but how can i make index available as a default file type so i can just hit localhost:3000/nesteddir and open the index file ( no need to specify it ) . another approach i 've tried is : setup an nginx in sidecar pattern when i run in container mode - that is how i will be accessing this static website . so i 've also been to use an nginx rule to rewrite /nesteddir/ to /nesteddir/index.html via a location block , but have n't been able to do so successfully . i would then still need to do localhost/nesteddir/index.html to get to the page . < code >
hello everyone ! i dont know how to exactly phrase the fetch url in a put request to api endpoint that updates a sqlite database . in development i had this : i tried using process.cwd ( ) but it did n't work out . i can get the json data manually here < url > ( this is an example for one blog post ) but how can i formulate this inside fetch ? big thanks in advance ! christian < code > const updatecolumn = async ( id , column ) = > { const endpoint = ' < url > } ' ; try { await fetch ( endpoint , { method : `` put '' , headers : { `` content-type '' : `` application/json ; charset=utf-8 '' , } , body : json.stringify ( { column : column } ) , } ) ; } catch ( error ) { console.error ( error ) ; } } ;
i 'm not using the reporting tool . ironically , it adds 3kb/1.3kb gzipped + parsing time to my app . is there a way to disable this functionality ? if not , it seems like there should be . thank you ! < code >
hi all , is there any way to access the context to get to the req.headers inside the new with-apollo example ? the goal would be to pass along those cookies within the apolloclient server side to a standalone service . < code >
in the withapollo example , there is a need for a separate page that showcase how to use getserversideprops , because just changing getstaticprops method in the current index.js to getserversideprops does not work .the following changes are required to get it working with ssr- 1 update getstaticprops method in index.js like so .. ( change method name and remove unstable_revalidate : 1 ) export async function getserversideprops ( context ) { const apolloclient = initializeapollo ( ) await apolloclient.query ( { query : all_posts_query , variables : allpostsqueryvars , } ) return { props : { initialapollostate : apolloclient.cache.extract ( ) , } , } } in postlist.js , update if ( loading & & ! loadingmoreposts ) return loading to if ( ! data & & ( loading & & ! loadingmoreposts ) ) return loading this is required for page to be server rendered am i doing something wrong ? iam happy to create a pull request with a new page , let me know < code >
i 'm running into an issue for supporting a ( invalid ? ) url . i could n't find any solutions applicable without introducing a custom server . with the removal of documentmiddleware experimental flag , are there any other way to rewrite/sanitize url ? e.g . < url > rewrite/sanitize into < url > thanks in advance ! < code >
should i reconnect to the db in every handler when i use next.js for api ? or is there a better way to do that ? and is n't that a bad thing if it was the regular approach ? i tried to create a nextjs project with typeorm or mongodb and all the examples and resources look like they are waiting for the connection with each call . this image is for typeorm example . i got it from this repo and here is the mongo articles that i found that they instruct to add the db connection in middleware and recall it in every handler . < url > < url > and here is the repos middleware to check it too if you like < url > < url > could n't i just create an entry point to set up my connection for one time so i can keep using it without re-waiting everytime ? < code >
i have a page that uses getstaticpaths and getstaticprops . everything works fine locally , but in my deployments , some of these pages show a 413 error : [ error ] [ 1594929353014 ] lambda_runtime failed to post handler success response . http response code : 413. it looks like this is due to a large body size . i tried increasing it to 2mb : and the error is still occurring . is there a way to find the output of these requests so i can figure out why it is going over the limit ? < code > export const config = { api : { bodyparser : { sizelimit : '2mb ' , } , } , }
i hope this is n't a stupid question ... in the with-apollo example , from what i can understand the cache is persisted through the build step by each page including initialapollostate in the page props so that it can be picked up and added to by each subsequent page generation : 'export async function getstaticprops ( ) { const apolloclient = initializeapollo ( ) await apolloclient.query ( { query : all_posts_query , variables : allpostsqueryvars , } ) return { props : { initialapollostate : apolloclient.cache.extract ( ) , } , unstable_revalidate : 1 , } } ' i understand how this would improve the build stage as it prevents continuously refetching the shared data that appears on multiple pages , but is there a client performance cost to it ? does n't it mean that the entire cache from the build process is included in the json exported from getstaticprops and downloaded by the client - although it 's not used by the client ? i can see it in my page.json in the client console . if the performance improvement only impacts the build step ( and the db server ) , would n't it be better to sacrifice these to maximise client-side performance ? or have i completely misunderstood how this works ? a related , more specific question : is 'unstable_revalidate : 1 ' required for this example ? i was having issues with it so i disabled it as i do n't currently need incremental builds - should this cause any knock on problems ? < code >
i do have this known custom _document.js synatx to get it work with styled-components i wanted to add a global meta tag < meta name= '' viewport '' content= '' width=device-width , user-scalable=no , initial-scale=1 , shrink-to-fit=no , viewport-fit=cover '' / > but i do n't understand the syntax above or where to put this meta tag . < code > export default class mydocument extends document { static async getinitialprops ( ctx ) { const sheet = new serverstylesheet ( ) ; const originalrenderpage = ctx.renderpage ; try { ctx.renderpage = ( ) = > originalrenderpage ( { enhanceapp : ( app ) = > ( props ) = > sheet.collectstyles ( < app { ... props } / > ) , } ) ; const initialprops = await document.getinitialprops ( ctx ) ; return { ... initialprops , styles : ( < > { initialprops.styles } { sheet.getstyleelement ( ) } < / > ) , } ; } finally { sheet.seal ( ) ; } } }
hi guys . i have created this little wrapper for fetching api pages server-side without actually fetching . i have achieved this task by creating a simple nextapirequest and nextapiresponse from the nextpagecontext available in getinitialprops and then proceeding to execute the code . it is n't all feature complete , but i was wondering if anyone has done something similar and know of some caveats or issues ? for now , i 'll continue to build this out a bit further and report back to my gist with updates . it ends up looking this in my getinitialprops/getserversideprops < url > < code > let data = null ; if ( process.browser ) { data = await fetch ( `` /api/post '' , { method : `` post '' , body : json.stringify ( { name : id } ) } ) .then ( r = > r.json ( ) ) ; } else { data = await serverapihandler ( ctx , post , { } , `` post '' , { name : id } ) ; }
hi community , i try to build and export an small nextjs project on github pages using travis cli . i think the build is correct , but i do n't really understand why the webpack and framework js files are missing . i 've been created the .nojekyll file in out dir , but same result . you can see the public repo and the hosted github pages anyone have already deploy static files on gp ? thank you community ! edit : fixing by adding custom webpack config stephane-r/holoplay-lp @ 6f939e7 < code >
i had some cases where makes sense to use shallow changing the current route and i do n't get why exactly the shallow option on router.push do n't work on route change . is there a good reason for that or this is an open feature ? < code >
hello , in my app on the refresh i send a request with a token to authenticate the user , on the response i update redux store with the currentuserdata and authed : true when the user visits a page from any route all working fine as the data already in the store . but when refresh i check if ! currentuserdata.authed i redirect him to the login page . the problem now the page redirect as the store not updated yet i 'm looking for a way to load the page after making sure that the store is updated as this request happen outside the page . < code >
i want to be able to send a response with a status code of 304 when an htmlfile has expored from the cache . i thought next js by default sets etag headers so that this automatically happens . i am not seeing any etags t or if-none-match headers being sent . how is this accomplished with next js ? < code >
i 'm trying to avoid implementing a custom server by using experimental basepath and rewrites features . however , when using together with getserversideprops , the page reloads and throws a typoerror in the terminal . to reproduce , add the following config to the with-redux example . and change < link href= '' /ssr '' > in nav.js to < link href= '' /ssr '' as= '' /abc '' > . click on the ssr link . observer the reload and the following error in the terminal any help is appreciated . thanks ! < code > // next.config.js module.exports = { experimental : { basepath : `` /t '' , async rewrites ( ) { return [ { source : `` /abc '' , destination : `` /ssr '' } , ] ; } , } , } typeerror [ err_invalid_arg_type ] : the `` string '' argument must be of type string or an instance of buffer or arraybuffer . received undefined
when attempting shallow routing with a dynamic route in next.js the page is refreshed and shallow ignored . seems allot of people are confused about this . say we start on the following page then we route to another blog post : this does not trigger shallow routing , the browser refreshes , why ? in the codebase its very clear that this is a feature : i can achieve the same manually using window.history.pushstate ( ) although this would of course be a bad idea : as the internal api of next.js could change at anytime ... i may be missing something ... but why is shallow ignored in the case ? seems odd . < code > window.history.pushstate ( { as : '/post/2020/01/01/foo-bar ' , url : '/post/ [ ... slug ] ' , options : { shallow : true } } , `` , '/post/2020/01/01/foo-bar ' ) ; router.push ( '/post/ [ ... slug ] ' , '/post/2020/01/01/foo-bar ' , { shallow : true } ) ; // if asked to change the current url we should reload the current page // ( not location.reload ( ) but reload getinitialprops and other next.js stuffs ) // we also need to set the method = replacestate always // as this should not go into the history ( that 's how browsers work ) // we should compare the new aspath to the current aspath , not the url if ( ! this.urlisnew ( as ) ) { method = 'replacestate ' } router.push ( '/post/ [ ... slug ] ' , '/post/2020/01/01/hello-world ' , { shallow : true } ) ;
i was going through the auth0 sample and i came across the ssr-profile.js file . trying to make sense of what this file does as i do n't see how an user would even arrive at this url . is this some special directory thing ? < code >
[ next.js on vercel ] hello , is there any difference between ssr page and a function placed in /pages/api ? thinking both can return json data and both are turned into serverless functions . i suppose that on vercel there is no difference afterall , but on node.js server target outside of vercel there is no /pages/api , so only ssr pages are left ( and they are ofc running not in a serverless manner ) . is this correct ? `` pages that use server-side rendering and api routes will automatically become isolated serverless functions . '' < url > < code >
i have recently trying to upgrade my nextjs app from 8 version to 9 but , facing this issue : failed to compile - _app.js typeerror [ err_invalid_arg_type ] : the `` path '' argument must be of type string . received type undefined how to fix this issue ? < code >
hello and thanks in advance . i am having an issue where i am calling a function , but the browser is saying it is undefined on the first call , but when i call it again on the same page , it works the second time . it does n't like the login ( ) function i am calling that is imported from another file . click handler : < url > < -- full component < url > < code > const handlesignin = ( e ) = > { e.preventdefault ( ) ; if ( isvalid ) { signin ( { variables : { input : { email : form.email , password : form.password } } } ) .then ( r = > { console.log ( typeof ( login ) ) ; login ( data.login.token ) ; } ) .catch ( e = > { console.log ( e ) ; } ) ; } else { setform ( { ... form , dialogopen : true , apierrormessage : 'email and password invalid . ' } ) ; } }
i need to create a wizard using next.js , using enters /video/ [ key ] i generate the key if valid - > go to /video/register , then /video/questions/ then /video/finish/ . so each step depends on the previous one , and there 's data sent in-between . how to achieve this ? i 'm migrating from gatsby , and gatsby has something called navigate that i can send data between routes and i can not achieve this using next.js < code >
hey folks , quick question : i have an external component library that i 'm including in my nextjs app as dependency . for some reason , it is not being properly tree-shaken . in the component lib , i have an esm module bundle ( pointed to the module field in pkgjson ) and a cjs bundle ( pointed to the main field in pkgjson ) . anytime a component is included in a bundle in the nextjs app , it brings along all other unused components . does anyone have an idea as to what the issue may be ? do i need to tell webpack to specifically use the module field for this package ( per # 9323 ) ? < code >
we are using nextjs 9.3.2 framework with static site generator i.e ssg with the introduction of google lighthouse 6 largest contentful paint ( lcp ) is affecting my site performance score . most of sites have a hero image in above the fold content . so i am looking to preload the image to cut down the time of lcp . can you guys guide how can i preload big hero image in nextjs with ssg < code >
hi there , i 'm trying out incremental static regeneration ( unstable_revalidate ) at the moment . i have a slider banner on my index page which is populated with images/data from getstaticprops . i 've added the unstable_validate flag to my returned props object but it does n't seem to be having any effect either on vercel or locally when doing yarn build + yarn start . when i add a new image for the slider in my cms it 's not changing on the site ( i 've left it for ages to test now ) . reporting as a potential bug , or maybe i 'm missing something . if there 's any way to troubleshoot let me know . index.tsx : < code > export async function getstaticprops ( ) { const apolloclient = initializeapollo ( ) ; await apolloclient.query ( { query : home_banner_query , } ) return { props : { bannerdata : apolloclient.readquery ( { query : home_banner_query } ) , unstable_revalidate : 1 } , } }
i have a listing page of products that i intend to server render . so using nextjs 's getinitialprops i fetch the list of products and pass it on to the components and it works . there is a requirement , whenever a city changes ( from dropdown ) in client-side , i need to refetch the updated list from the server , so i have this api call in a useeffect . this is somewhat the idea . the problem is at step 3 below , at the server products api call is made and fed to redux . the page is built at the server-side and sent over to the client . at the client , useeffect runs and unnecessarily calls the api endpoint again . how do i prevent this redundant call , the first time when the page is rendered on the client ? well , just an if check inside useeffect whether data is present before making the api call does n't work , because despite products data being present in redux store , if the city changes , the api call has to be made . < code > productswrapper.getinitialprops = async ( ) = > { // fetch list of products const products = await getproducts ( ) ; // update the redux store with products returned from server return { products } ; } // products is a redux connected component that listens for product and city state updates function products ( { products , city } ) { // fetch new products iff city changes useeffect ( async ( ) = > { const products = await getproducts ( ) ; // update the redux store with products returned from server } , [ city ] ) }
i 've migrated from create-react-app to create-next-app to my website for the seo , but the head ( app/head ) component is n't working properly assuming i have a blog , and in pages , i have the following structure : pages/blog/index.js , pages/blog/ [ slug ] .js . in [ slug ] .js , i 'm using the head component so it takes the title of the blog post : < title > { post.title } < /title > the problem is that when using react-share on the blog post it does n't put the right title , even when i do an inspect element on the page , i can see the right head values , but the facebook debug ( < url > ) tool does n't recognize the right title . i have to mention that when i 'm in the pages/blog/index.js the sharing is working corectly am i doing something wrong ? < code >
hello , i 'm looking for some guidance on how to combine two of the examples listed in this repo , auth0 and api-routes-apollo-server-and-client . i have both of these working separately , but what i would like to do is get my session from auth0 and add my user to the apollo server context . when i attempted to do this , i saw that my session cookie was coming through on my graphql api route , but then it suddenly becomes an empty object . i 've added my api route code below so that you can see what it is i 'm attempting to do . thank you in advance . pages/api/graphql.js < code > import { apolloserver } from 'apollo-server-micro ' ; import { schema } from 'apollo/schema ' ; import auth0 from 'lib/auth0 ' ; export const config = { api : { bodyparser : false } } ; const apolloserver = new apolloserver ( { schema , // tried to make this async and call auth0.getsession ( req ) // but because the cookies are { } my session is null context : async ( { req } ) = > { const session = await auth0.getsession ( req ) ; return session ; } } ) ; // created this hof so that i could log out the cookies const handler = apollo = > async ( req , res ) = > { // works once , then is { } console.log ( req.cookies ) ; return apollo ( req , res ) ; } ; export default handler ( apolloserver.createhandler ( { path : '/api/graphql ' } ) ) ;
hello , i have an /api/graphql endpoint in order to fetch data . on the endpoint an apolloserver is set up . i defined the schema , the resolvers and it basically fetches data from a mongodb , which is running on a root server . the endpoint mostly serves data to the client , when he navigates the page . now i would like to serve some initialdata from getstaticprops in order to generate some pages statically . since i should not fetch data from my /api/graphql endpoint in getstaticprops , what is the recommended way ? best regards , hk < code >
so i want to expose some environment variables from the server to the browser during the initial request . i 'd want something like using getserversideprops in _app which does n't seem to be supported . i do n't want to use next_public because that replaces the values at build time and i want the same build to be deployable to multiple environments , with different environment variables , without the need to build for each one . is my only option to create some /api routes and request those in the client ? these are configuration values that i need through the whole app and i was thinking that there should be a simple way to expose these values during initial server rendering and without the need to inject the actual values during build . am i missing something here ? < code >
due to the memory shortage of my server , i adopt a static html generation strategy , in which i utilize npm run build & npm run export to create html results of my next js app and put those html files into my server . however , head elements such as a title or meta do n't appear in generated html files even if they behave normally in development mode ( i assume that they wo n't be problematic in a regular next js app . ) believe or not , when i put some of the head elements into _document.js head , they appear . nevertheless , migrating every head element into _document.js means i can not assign open graph meta tags for individual pages and also i have to insert the title html element into _document.js , the act that should not be done in next js development . i tried to search for any issue related to next/head along with static html generation , but it seems to be minor discussion , therefore i post this to find out any solution . < code >
🙏 how do i get my pages/about.js to export as about/index.html instead of about.html thanks ! you 'll see i 'm also having this issue with tags , and you ca n't see it , but i have the issue with tag/ * as well . oh , and post/ * -- to visit the site directly , you need to have .html at the end , and that 's horrible ! any help would be greatly appreciated . < code >
i am unable to import es modules in api routes . for example when importing from < url > this fails as it wo n't detect the declared export in the package.json : < url > directly import from the /lib subfolder will then fail due to the use of imports in there , so i guess this is expected to be cjs . currently i could work around this by using next-transpile-modules and declaring webpack resolve aliases for that /lib subfolder in my next.config.js . ( as actually , i 'm dealing with multiple modules importing from each other . node 12 could use these without any transpilation when using the -- experimental-modules and in this case , also -- experimental-json-modules flags . but with serverless deployments in mind , i 'm wondering if that currently is worth achieving , as somehow i did't find much information yet if lambdas are able to deal with esm at all . i guess that i should aim for as as little transpilation for the server code as possible , to avoid degrading performance for some features . like , esm to cjs shoud be fine i guess , but i do n't want a es5 target . however , there 's tree things i wonder now : is using es modules a possibility ? what is the default transpilation done for api routes and which target is babel using ? when using next-transpile-modules as part of the webpack config in next.config.js , will my modules be transpiled properly for the server target ? also , are there alternatives ? i guess i would only need cjs instead of esm , but do n't require any further feature transpilation besides that happening in the api routes anyway . < code >
hello , i have been working on implementing server side pagination with nextjs , and this is how i thought was the best to accomplish that : 1- at first page load , when isserver is true , i get the data and count and page from backend and send it as response to frontend . 2- when page loads and renders the array of elements , it calls the on page change handler of the paginator that pushes to the route the current page number . 3- this causes a call back , triggering the infinite loop . what am i doing wrong here ? this is the package i 'm using < url > < code >
thank you ! is it good practice to store large/big file in public folder ? for example when user upload a img file or rich text file i mentioned or shall i use cloud storage instead ? i was wondering if public folder is viewable on client side ( is it on vercel 's server , i might store private data on public folder ( btw , how much does vercel charge for storage ? i couldnt find ) tks ! < code >
i just get < code > const mongoose = require ( 'mongoose ' ) mongoose.createconnection ( 'mongodb : //localhost:27017/userbase ' , { usenewurlparser : true , useunifiedtopology : true } ) ; mongoose.createconnection is not a function mongoose.connect is not a function `` ' mongoose is installed , ive tested many times , it just does n't work . i ask here because this only happens with nextjs
feature request is your feature request related to a problem ? please describe . when using animation libraries to make page transitions , the router does n't wait for the exit animation to finish before changing the route and query parameters . the creates the problem that the old page during fade-out is re-rendered again with the route and query parameters of the new page it is transitioning to . describe the solution you 'd like do not change route and query parameters before old page is completely unmounted . additional context for an example , see this issue : illinois/next-page-transitions # 23 ( comment ) < code >
currently all images in public folder is served from / path . now i have 3 blog posts blog1 , blog2 , blog3 each of them have 3 different images but all 3 images are called feature.jpg now imagine i have 30 or 300 or 3000 blogposts . my job to to make sure each image name is not repeated on used on other blog posts . < code >
hi first , i will explain my problem through an example . i have a three components under the /pages . /a and /b and /index example a : class a extends react.component ( ... render ... ) export async function getserversideprops ( ctx ) { console.log ( `` serversideprops running '' ) } im using nextjs 's custom server . ( more information : < url > ) example my server : server.get ( `` /a '' , async ( req , res ) = > { console.log ( `` server side express running '' ) ; app.render ( req , res , '' /a '' , req.query ) ; } ) output : server side express running , serversideprops running so far , no problem . but if i come back to page `` b '' after rendering a , then back to `` a '' page , the output looks like this : output : server side express running . serversideprops running // page changed /b and redirect again /a serversideprops running is it a bug or my fault ? < code >
problem : currently there is no way to have a particular section of a page to be statically rendered and remaining part of the page to be rendered dynamically using ssr usecase : in the listing page of an e-commerce application , i would want the products ( one inside the red box , apologies for the horrible diagram 🙂 ) to be rendered through ssr ( can not render through ssg because , if done through ssg pagination needs to be csr and it will impact seo ) . and i would like to have the category flyout ( one inside the green box ) to be statically generated during build time and kept in the file system and accessed during ssr . this would avoid querying and curating category hierarchy data on every page load . this will help not just the listing page , but all the ssr pages where the flyout is displayed possible solution : can have a json file generated during build time , which is accessed during ssr can have am html file created for the section during build time and rehydrated during ssr . i went through the discussion # 11424 , and it is suggested to use the middleware feature ( # 7208 ) . looks like it was reverted later ( # 12218 ) . i am aware of the workarounds like having a webhook to create/update the json file in the codebase and trigger a build whenever the category data changes . fetching the category data in the client-side to speed up the ssr since the flyout is not displayed until the user clicks the menu and user is highly unlikely to click before the csr happens . would appreciate feedback ! < code >
using withrouter as a wrapper , shallow routing does n't seem to be working . i currently use this method to change the route : and could n't figure where to put the shallow flag . so i switched to the method mentioned in the docs : this.props.router.push ( '/post/ [ pid ] ? hello=123 ' , '/post/abc ? hello=123 ' , { shallow : true } ) so i did that manually , but i started getting 404s . < url > net : :err_aborted 404 ( not found ) decoded : `` < url > ] / [ cat ] / [ area ] .js '' i tried using : type instead of [ type ] but it also did n't work . this is how it 's configured on the server : folder structure : /pages/search/index.js it should not reload the page while changing the route , that 's the main thing i 'm trying to accomplish . i 'm implementing ssr pagination , and i 'm planning to use shallow routing to make page changes happen on the client instead of the server . meaning achieve ssr on first load only , keep user in without refreshing . < code > if ( '/search/ : type/ : cat/ : area ' === route.path ) { return app.render ( req , res , route.page ) ; } this.props.router.push ( { pathname : currentpath , query : currentquery , } ) ;
i have a css file that provides styles for the react-notifications-component library . i was importing it in my _app.tsx as recommended in the docs , but lighthouse suggests deferring non-critical css . is there a way to import that css so that it will be loaded after the main render-blocking css file rather than concatenated with it , improving page load times ? < code >
how can i deploy my next js project on github pages , is there any config i should follow or only need to run yarn next build and it will do it automatically for me ? < code >
i saw this on the api-routes-apollo-server-and-client example next.js/examples/api-routes-apollo-server-and-client/pages/index.js lines 32 to 44 in 89fffa6 export async function getstaticprops ( ) { const apolloclient = initializeapollo ( ) await apolloclient.query ( { query : viewerquery , } ) return { props : { initialapollostate : apolloclient.cache.extract ( ) , } , } } but on the api-routes-apollo-server-and-client-auth example it does n't exist . but in both in the _app.js : next.js/examples/api-routes-apollo-server-and-client/pages/_app.js lines 4 to 12 in 89fffa6 export default function app ( { component , pageprops } ) { const apolloclient = useapollo ( pageprops.initialapollostate ) return ( < apolloprovider client= { apolloclient } > < component { ... pageprops } / > < /apolloprovider > ) } what about the usage of getserversideprops for example to redirect the user instead of doing like this in the auth example : next.js/examples/api-routes-apollo-server-and-client-auth/pages/index.js lines 22 to 49 in 89fffa6 useeffect ( ( ) = > { if ( shouldredirect ) { router.push ( '/signin ' ) } // eslint-disable-next-line react-hooks/exhaustive-deps } , [ shouldredirect ] ) if ( error ) { return < p > { error.message } < /p > } if ( viewer ) { return ( < div > you 're signed in as { viewer.email } goto { ' ' } < link href= '' /about '' > < a > about < /a > < /link > { ' ' } page . or { ' ' } < link href= '' /signout '' > < a > signout < /a > < /link > < /div > ) } return < p > loading ... < /p > } what are the differences of doing the redirect directly in the page , calling initialapollostate on the getstaticprops and using getserversideprops in this situation ? < code >
i 'm trying to recover the result of sql query of backend , to server through getserversideprops , but the result is just undefined . the object returns mounted like this { name : 'name ' , id : 'id ' } here 's my code . i think is scope problem , but i do n't find solution . export async function getserversideprops ( context ) { const sql = `` select id , username from users '' ; await query ( con , sql , function ( result ) { return { full code : < url > thanks for help . < code > const con = await connection ( ) ; console.log ( result ) //works employes = result console.log ( employes ) // works fine } ) console.log ( employes ) ; //not works , is undefined let employes = [ ] props : { employes : employes } }
i am rewriting 1 of my vanilla websites into next js . i am having a problem with the styling of my navigation component . i think i narrowed it down to what the problem is , i 'm just not quite sure why it 's happening . i am using react bootstrap with custom css . it seems that the bootstrap component style is overriding my custom css . you really notice it when you select 1 of the navigation items . it 's only using the bootstrap css . this is what my navigation bar is supposed to look like : < url > here is the console output : < url > now when i try to rewrite this into my next.js application i get something that looks like this : < url > console output : < url > as you can see , the css i have written is not being recognized at all . i have a feeling bootstrap react is overriding but i 'm not sure what i 'm supposed to do . below i will link a picture of my package.json and a gist of the component itself . package.json : < url > _app.js : < url > gist : < url > p.s . i know why the brand part of the navigation bar is not styled right . i am more worried about why my anchor tag is not being styled . thank you ! < code >
hi guys ! i have a self-hosted next site with pm2 , in the same server i have a php app working . it 's possible storage a website built-in php , in a subfolder of next ? for example domain.com - next website domain.com/subfolder - php website ( /pages or /public folder ? ) thanks for you help . < code >
i got this wanted error on graphql when login is not valid : under login modal , there is the error modal in development . i assume in production , there will be only the console error , and everything will be fine ? just to confirm , this is right behavior and i can continue like this , right ? < code >
hello friends . i need to add the html file made available by google for property recognition on my ssr website , what are the ways to do this ? < code >
when i 'm debugging server-side code in my api routes with visual studio , for some reason whenever i set a breakpoint it always breaks down the stack here : i 'm able to go to the call stack and then click the top of the stack . but this is super annoying . i 'm not sure where the issue is , but i have n't had the problem with other projects not using next . here 's my setup : launch.json package.json am i missing something ? < code > `` scripts '' : { `` dev '' : `` node_options= ' -- inspect ' next '' , } { `` type '' : `` node '' , `` request '' : `` attach '' , `` name '' : `` attach to program '' , `` skipfiles '' : [ `` < node_internals > / * * '' ] , `` timeout '' : 60000 , `` port '' : 9229 } , let result : any ; if ( whenobjectresolved ) { result = whenobjectresolved.then ( ( resolvedobject : any ) = > { return actualfieldresolver ( resolvedobject , args , context , info ) ; } ) ; } else { result = actualfieldresolver ( source , args , context , info ) ; // < -- breaks right here }
i needed to get the url parameters i used router.query.slug since my file name was [ ... slug ] .js but the page renders twice so the meta tags are undefined when i do router.query.slug [ 1 ] how do i fix this url parameters are there on the second load < url > < code >
i 'm currently trying to proxypass my wordpress admin panel located on a subdomain to a subdirectory on the domain where my next.js app is running . unfortunately no matter what i do , next.js overrides apache and will show me its default 404 error if i visit /wp-admin . i could have my apache settings wrong , but nonetheless , is there a way to make next.js completely ignore a directory and let the request be handled by apache instead ? < code >
bug report describe the bug i 'm not sure it 's a bug , in that there may be a reason for this behavior . but i ca n't wrap my head around it . when returning a javascript object from getstaticprops ( ) , nextjs needs to serialize it to send it down to the page it 's called from . when i try to return a somewhat large and nested object that may have `` undefined '' values in it , next complains that it needs `` serializable '' data and that undefined is not . it should be replaced by null values . however , json.stringify ( ) does strips away undefined values . so why not allow undefined values ? what serialization does nextjs do in the background ? for large , nested objects , it might be complicated to remove/replace the undefined values except for resorting to json.parse ( json.stringify ( myobject ) ) , which is not very nice although it works to reproduce nothing to do , just observe the error at : < url > error message expected behavior let us return objects with undefined values as json.stringify ( ) remove them anyway . system information irrelevant/all < code > error serializing '.data.tobe ' returned from 'getstaticprops ' in `` / '' . reason : 'undefined ' can not be serialized as json . please use 'null ' or omit this value all together .
i am using a npm package @ brainhubeu/react-carousel , the site works fine in local dev environment . the following is an image on my local machine working perfectly fine . but when i deploy it on vercel , the hosted site is quite different - < url > ( live ) i initially thought it was due the fact that the library might not support for ssr so i used the following solution for importing the file- 'import dynamic from `` next/dynamic '' ; const carousel = dynamic ( ( ) = > import ( `` @ brainhubeu/react-carousel '' ) , { ssr : false , } ) ; ' i am also importing the css files of the library in the_app.js but not using next/dynamic any pointers as to what might be going wrong ? < code >
i 'm using redux with the newest version of nextjs and typescript . my store initializes an external sdk to set some thunk values . the problem is that said sdk depends on the window object so i was originally getting the window undefined error . i fixed that by dynamially importing the sdk , but now i get a type error saying that the sdk method is not a constructor . any help would be greatly appreciated < code > const sdk = dynamic ( ( ) = > import ( 'sdk ' ) , { ssr : false } ) as any ; const initialized = new sdk.initialize ( ) ; const store = createstore ( reducer , composewithdevtools ( applymiddleware ( thunk.withextraargument ( { sdk ) ) ) ) ;
can i put my sitemap.xml to inside of public folder ? i can see sitemap when i access < url > i wonder should i add some options like 'content-type ' , 'application/xml ' . if so , how could i do it ? < code >
bug report describe the bug when i use custom app ( pages/_app.jsx ) build an isomorphic application , it does n't work very well in ie11 , it prompts me that symbol is undefinedbut i imported polyfill.min.js globally in _document.jsx i tried with-polyfillscorejstransform-runtime , but it did n't solve my problem if i do n't use custom app , and only use custom document , it will run well i hope you can give me some help , thank you very much . github repository repository npm run dev < url > screenshots 1ie11 symbol undefined 2i have global import polyfill.js system information os : [ macos ] browser ( if applies ) [ ie11 ] version of next.js : [ 9.4.4 ] version of node.js : [ v10.21.0 ] < code >
libraries versions `` next '' : `` ^9.4.4 '' `` next-auth '' : `` ^2.0.0 '' hi , is there a way to get user session on first page request as ssr , but subsequent requests to other pages would run csr since i can store session in memory ? right now i have to implement getserversideprops on all logged-in pages . which makes my entire app ssr and routing between pages become slower even though most pages do n't do any data fetching in getserversideprops here 's a sample of what my getserversideprops look like : my csr hack right now is to get the session inside _app , and check on the pageprops if it 's isprotected . which means the initial page request ux is a bit nasty because until i get session or undefined , i do n't know what to show to the user . also if there is no session , there 'd be a heck up before i can redirect them to login . is this a current limitation of nextjs or is there a way to achieve my dream ? < code > const { getsession } = require ( 'next-auth/client ' ) / * .. .. * / export async function getserversideprops ( context ) { const session = await getsession ( context ) if ( ! session ) { context.res.setheader ( 'location ' , '/ ' ) context.res.statuscode = 302 context.res.end ( ) } return { props : { session , } , } }
hi people , i have a situation where i created an authorization middleware for my api . the situation is that i use the middleware with nextconnect and then i do : i want to use my authorization middleware just for the post route and not for the get . but if i do handler.use ( ) it will be used by both , is there a way to do that ? < code > const handler = nextconnect ( ) ; handler.use ( databasemiddleware ) ; handler.get ( ......... ) ; handler.post ( ....... ) ; export default handler
i have a page with list of links . some of these are pre-rendered , others are supposed to be rendered at runtime using fallback functionality . when i click on the link which does not have pre-rendered page nothing happens for quite a while and after some time i see a page . is it possible for me to enforce somehow to display fallback page in this case ? < code >
i see that when i use static export my data is being put into two places : in a js object within a script tag in the html file , and in its own json file . on loading a page from the top level , the data is hydrated from the script tag js object , but then the json bundle is getting prefetched anyway ( in anticipation of navigating back to this page clientside ? ) . why is the data not just put into the json bundle only ? < code >
i have a statically exported page which displays a table component with data from getstaticprops . the table will have a dropdown with two options ( by year ) `` 2020 '' or `` 2019 '' . the default view will be `` 2020 '' ; most people will only need that data . is there a way to do this in a way that is both a static export and which does n't download the `` 2019 '' data for every user , i.e . only grabbing it when they select it in the dropdown ? i realize i could use getstaticpaths , but that would generate a separate page with its own table component , right ? that 's not what i 'm looking for . < code >
hello community ! in this example blog posts are read from the file system at build time and build with getstaticpaths and getstaticprops . i want to use this example but i 'd like to use mdx inside my blog posts . does anyone have any advice on how to convert this example to use mdx ? i understand from the example that it uses remark to parse the markdown to a html string at build time . can the same be done with @ mdx-js/loader ? please correct me if my understanding about mdx is fundamentally incorrect . < code >
here 's what i have to do : load max . 1000 pictures to the browser 's memory modify each photo send all photos to the server ( firebase ) i have no problems with points 2 and 3. the problem is with point 1. i am looking for a good way to temporarily store files in the browser memory . i tried two ways : a. app state b. indexeddb there are pros and cons to these two solutions . point a - access to data is fast but large amounts of data sometimes cause the browser crash . point b - the data is secure but loading into indexeddb takes a long time and takes up additional space on the device . maybe you know better ways to store files temporarily and permanently in browser 's memory ? < code >
next.js/packages/next/client/dev/error-overlay/hot-dev-client.js lines 268 to 283 in 61e899f if ( err || hadruntimeerror || ! updatedmodules ) { if ( err ) { console.warn ( ' [ fast refresh ] performing full reload ' + `` fast refresh will perform a full reload when you edit a file that 's imported by modules outside of the react tree. `` + 'you might have a file which renders a react component but also exports a value that is imported by a non-react component . ' + 'consider migrating the non-react component export to a separate file and importing it into both files . ' + 'it is also possible you are using class components at the top-level of your application , which disables fast refresh . ' + 'fast refresh requires at least one function component in your react tree . ' ) } else if ( hadruntimeerror ) { console.warn ( ' [ fast refresh ] performing full reload because your application had an unrecoverable error ' ) } window.location.reload ( ) these 's nearly no change to see the warnings above because of window reloading if preserve log for the console is not on ... < code >
in this repo we 're creating 2 content model author and post using npx cross-env contentful_space_id=your_space_id contentful_management_token=xxx npm run setup command . i 've another content model and i want to bring it to cms-contentful how can i make it possible ? < code >
when i want to put link and script tags in an html file , should i write it in _document.js or _app.js ? when i want to enter the page to determine whether there is permission to enter , where should i write the logic , _app . getstaticprops ? linkscripthtml , _document.js_app.js ? , ,_app . getstaticprops ? < code >
i create healthcheck module folder ( within modules folder ) , that contains pages folder , components folder , routes.js . this idea for easy plugging with another nextjs system . do you have idea easy to add/import new routes.js and pages folder within healthcheck module to nextjs ? < code >
feature request is your feature request related to a problem ? please describe . we 're currently pinned to version 9.1.7 because upgrading to a more recent version causes our psi to drop significantly . here are the screenshots of the lighthouse result . 9.1.7 9.4.4 lighthouse js chunks 5 js files 20 js files first contentful paint 2.3s 4.8s describe the solution you 'd like i 'm guessing that in version 9.4.4 , psi is suffering because it 's loading an additional 15 js files . is there a way to customize code-splitting ? we have 12 different pages on our site , but most of our users rarely navigate between pages . at most , users will go to 2 pages and leave the site . i 'm also curious how the common chunk is created . we include the react-ga component in _app.js , so i expect the code for it will be in common . however , i see a separate chunk created for it . describe alternatives you 've considered i currently ca n't think of another reason why our psi score will suffer . there was no code change besides updating to next to 9.4.4. i also posted this same issue in this thread # 11120 ( comment ) . < code >
hi all , i have upgraded my project dependencies one commit that updated react , react-dom and next introduced this bug when on first render ssr delivers content without css im using styled-jsx which remained untouched at version 3.3.0 next version went from 9.2.0 -- > 9.4.4 react/dom went from 16.12.0 -- > 16.13.1 i wonder if this is not known bug . but found nothing among github issues any help or ideas will be appreciated edit : by error and trial it looks like this happens between 9.2.2 -- > 9.3.0 < code >
( node:20684 ) unhandledpromiserejectionwarning : unhandled promise rejection . this error originated either by throwing inside of an async function without a catch block , or by rejecting a promise which was not handled with .catch ( ) . to terminate the node process on unhandled promise rejection , use the cli flag -- unhandled-rejections=strict ( see < url > ) . ( rejection id : 1 ) some time i 'm getting the above error what is the solution ? < code >
hey ! over the last few months i 've been building react native club using nextjs , typescript , graphql , ant design , hasura and a plethora of other libraries . it 's ssr 'd and hosted on vercel . it 's a community site / social network purpose built for react native developers , and has features like the ability to add your app using app store and android store lookups , an npm lookup to add your favourite libraries , and a much nicer code editor than medium for writing articles with code snippets . let me know what you think ! < code >
hi there , i struggle with the following question ... whether fallback pages will be a blocker for crawlers on their `` first visit '' since they generate a static html with no potential seo content or they will somehow pass the crawl and can produce correct data for the seo ? it potentially related to og preview generation and indexing . what happens from the seo point when we have n't rendered ssg page yet ? how do the not-pre-renreded pages behave for seo ? < code >
hi , i am working on an ecom web application with front-end on nextjs and backend on java springboot . problem : i have a login component where i am making an authentication request to the backend server with the username and password . after a successful login i receive a jwt token . i add that token to the req headers with this line axios.defaults.headers.common [ 'authorization ' ] = bearer < cur > { res.data.jwt } then , i make a subsequent request to the backend to get some data where i should receive an array of states . the request needs me to add the jwt token in the headers which i did . but , i receive this error what i have tried till now : i have tried to use the reverse-proxy-with-custom-server example i have tried to use http-proxy-middleware to proxy the request in /pages/api/ [ ... slug ] .js ( this i believe should only work on the server side ) what i want to do : i would like to make the request from the login component and not receive the cors error . if it were a react application : i would have added the proxy in the package.json file and it should have worked or used the webpack config to configure a proxy . i know that this is a common request but , i am unable to find an answer anywhere with a clear explanation . hence , i turn to this community . i have spent the last 5 days looking for a solution to no avail . any help in this matter would be really appreciated . thank you for your service and time in advance . < code >
i 'm trying to define lang property in _document.js but i need to get the site 's language from a mysql database . is this possible ? any ideas ? < code >
i use eslint and the default index.js file is causing a warning around jsx and react - 'react ' must be in scope when using jsx react/react-in-jsx-scope . i can either import react from 'react ' or turn this rule off . i 've imported it for now - but will this have some weird problem with how next statically builds the app ? < code >
hello , issue : google speed is complaining of unused js files background : i have currently around 20 different page types which load different react components . the entire site is generated statically . the bundle generated as `` common '' is quite big , as more than 50 % are common in all the pages . however , a normal user wont go though all the different page types . my question is ; is it possible to generate a bundle per page type ? if yes , how can this be achieved ? thanks . < code >
feature request if you want to load an svg inline , e.g . import exampleicon from `` icons/example.svg '' ; using inline-react-svg ( as per the example in the repo found here ) and you are using absolute imports , the files will with not resolve . inline svgs are quite common in modern web development and it currently requires a lot of config and additional packages in order to make work . additional context you can fix this issue by installing the babel-plugin-module-resolver package and updating your .babelrc file as followings : proposed solution support the loading of svg components by default ( i.e . in the nextjs internals ) without needing to manually update .babelrc < code > { `` presets '' : [ `` next/babel '' ] , `` plugins '' : [ [ `` module-resolver '' , { `` root '' : [ `` ./src '' ] } ] , [ `` styled-components '' , { `` ssr '' : true } ] , `` inline-react-svg '' ] }
hi , the expected behavior when clicking on link that points to the current url , is a page refresh . but when i do router.push ( url ) and url is the current url , nothing happends . ( maybe related to dev mode ? ) could n't find the answer in the docs . thanks < code >
i 'm attempting to build this flow with next.js 9.3 , and am unable to find a solution : a user logs in , and a non-http-only cookie is set when the user clicks a logout link or visits /logout , the cookie is cleared , and the user is redirected the login part works fine , as does clearing the cookie . my first implementation was adding this to my otherwise non-rendering logoutpage : this actually works fine , and the cookie is cleared and a redirect occurs , but every time it runs , there 's an error in the console typeerror : can not convert undefined or null to object caused by this line which expects getserversideprops function to return an object containing a props object . is there a better way to write this flow ? my current workaround is just to use a custom server , which feels like overkill for such a minor thing , and it requires a real page refresh . is that what i should be doing ? < code > export async function getserversideprops ( ctx ) { ctx.res.setheader ( 'set-cookie ' , 'token= ; max-age=0 ' ) ctx.res.writehead ( 302 , { location : '/login ' } ) .end ( ) }
hi , today , i 'm performing authentiocation checks of a page in getinitialprops . if the user is not authenticated , i 'm redirecting him to another page . i read the documentation of getserverprops and saw the recommendation to use it and not getinitialprops . but , how can i implement server side redirect with getserverprops ? of course i ca n't use both in the same page . maybe it is fine to use some wrapper hoc to the page component and there define getinitialprops ? thanks ! < code >
all , i ' m a new developer trying to hack together a media on demand app . in this app i have the following page structure : i want to sort my library pages in a subdirectory , but i want the /library url to always show the catwalks page . how do i make this happen ? < code > src pages library.js < == redirect to ./library/catwalks instantly index.js library catwalks.js
describe the bug hi , i got this error from mongodb , i searched for it on google < url > problem because call mongodb too many time . the options [ servers ] is not supported the options [ casetranslate ] is not supported the options [ dbname ] is not supported the options [ srvhost ] is not supported so i think to create a middleware called end.js . is this the best way to fix this error ? thank you import { mongoclient } from `` ./database '' ; export default ( req , res , next ) = > { mongoclient.close ( ) console.log ( `` close connect db '' ) next ( ) } ; < code >
hi everyone , i 'd like to make a blog using nextjs and markdown files . i 'm then working on a backoffice system so that i can edit and write articles . problem being that all my static elements for the referencing are creating when buiding the webapp before deployment . and i do n't really want to build the app every time i 'm changing/adding an article . how can i have a kind of automatic build which does n't affects the end user and allows me to be sure that my website is up to date ? thanks ! < code >
i 'm wanting to add a navbar to the top of an mdx based page . but i want to generate the links in this navbar automatically , using the fs module . however , the only way i can see to add content to an mdx based page is by wrapping it in a component in _app.js , and components ca n't access fs , only pages can . is there a way to do this ? < code >
hi , i am trying to upgrade the code base from 7.0.2 to 8.0.0 and facing these issue . i eventually want to upgrade to 9.4.4. references like these import { externallink } from ' .. / .. /node_modules/some-icons/dist ' are not resolved after build . 'undefined ' is getting appended to the packages - get < url > net : :err_aborted 404 ( not found ) any help would be appreciated . < code >
hey guys ! i have created a project which uses magento as a cms . i want to add this in the example projects of nextjs so that it can be helpful for other developers . it will be helpful if someone guides me . here is the link - < url > < code >
i would like some routes to have aliases for seo . for this i 'm looking to something that does exactly what exportpathmap does but then when using next build instead . i tried adapting the router of the context in the getinitialprops on _app but it does n't seem to take any effect . so for example , /hello should render the page that 's also on url /hey where hey is a file under pages/hey.js < code >
i 've got a nextjs project , however it is oss that will be used locally on machine so i have opted to use lowdb as a database since it 's easy to use and perfect for my requirements on one of my pages , i use getstaticprops to read in data , and pass it to the props of the component . works perfectly what i need to do though is have a component that runs on every route and performs a similar query on the database to get the number of users . if the user array in the database is empty , i want to make sure the users can only access /pages/setup/ * . if there are users , then i want to make sure they can only access /pages/ * and not /pages/setup/ * . how can i achieve this ? i ca n't use the above function since it only runs on pages . any suggestions ? < code > export async function getstaticprops ( context ) { const filesync = require ( 'lowdb/adapters/filesync ' ) ; const dbadapter = new filesync ( path.resolve ( process.cwd ( ) , 'server/bin ' , 'db.json ' ) ) ; const db = await low ( dbadapter ) ; const responses = await db.get ( 'responses ' ) .orderby ( 'timestamp ' , 'desc ' ) .value ( ) ; return { props : { responses , } , } ; }
i have a redux store in place to share common data between pages . i am using getserversideprops , since it runs every time on server irrespective of the fact that the page is refreshed or it is client side navigated . how can i save few api hits on client side for which i already have data in the redux store ? what check shall i place in getserversideprops to avaoid an api hit ? as new store is always created at the server . shall i switch back to getinitialprops ? < code >
hey everyone , i 'm probably missing out on something fundamental . how can i reference png images from a css file within a nextjs project ? i 'm definitely referencing the file path correct . i tried placing the images inside of the public folder . and from the css file i reference : '/images/name-of-file.png ' , where images is the container folder nested inside of the public folder . can somebody point out what i 'm doing wrong ? < code >
hello community , as part of my application , i need a widget with dynamic content that any user can integrate into their sites . i 'm thinking of giving one route /embed/ : _id where i just want to serve basic html file with dynamic content from the _id . i 've google a bit and could n't find any solution for this in next.js , any ideas or sample snippets are appreciated . my html file can be simple 10 lines of html or bit complex with dynamic content < code > < ! doctype html > < html lang= '' en '' > < head > < meta charset= '' utf-8 '' > < meta name= '' viewport '' content= '' width=device-width , initial-scale=1.0 '' > < title > document < /title > < /head > < body > < h1 > hello world { name } < /h1 > < /body > < /html >
my knexfile refers to an env var in .env.local this is not a problem with the website running on dev . but when i try to execute a command line command such as knex migrate : latest which uses the same knexfile the environment variable is no longer being picked up . what is the best way to handle this ? < code >
in the below example - if i hit the url directly < url > page works fine ( context.params.slug ) is fine ... but if i navigate from a next.js link from a feed page as shown below - params ( and query ) are not interpolated , but returned as [ slug ] , not the abc i 'm looking for . on top of this - this only happens in the production build deployed to vercel - this behavior does not happen in development ... something i 'm doing wrong ? page : < url > page : < url > ] < code > export const getserversideprops : getserversideprops = async ( context ) = > { const postdata = await fetcher ( '/api/ < cur > { context.params.slug } ' , context.req.headers ) ; return { props : { initialdata : ! ! postdata ? postdata : null , } , } ; } ; < link href= '' /post/ [ slug ] '' as= '' /post/abc '' > < a > first post < /a > < /link >
it maybe good to update the cms strapi readme to clarify that if you update an existing post and put it in draft mode , this post will disappear from the website , in other cms 's like prisma , dotocms will show the last published post . works well only for new posts in draft ! in strapi published is a custom field sort of like a hack whereas other cms has support for this out of the box ? < code >
bug report describe the bug i use pkg to package my nextjs app . when i upgraded to version 9.4.0 from 9.3.6 the static pages i tried to access were all redirecting to the 404 page . ssr pages work as expected on 9.4.0. also everything works as expected on dev mode to reproduce go to this repo on master branch run yarn install , yarn build , yarn pkg ( or pkg-macos ) execute ./pkg/test to run the app in the self contained server notice that we can not access the localhost:3000 or the localhost:3000/static page but we can access the localhost:3000/ssr which is a server side rendered page expected behavior the expected behavior is that all pages ( localhost:3000 , localhost:3000/static , localhost:3000/ssr ) render normally . system information os : [ macos , linux ] version of next.js : [ 9.4.0 ] version of node.js : [ 10 ] additional context if you checkout branch 9.3.6 which has the previous version of nextjs and perform the same steps you will notice that everything works as expected < code >
good afternoon , thanks to zeit team for bringing such a wonderful framework . i 'd like to understand how my current problem can be solved using next.js . as of now , my project runs on next.js with the usage of custom express server , for a site that meant to be static . after the release of v9 with awesome getstaticprops feature , we are starting to consider to update a project for using ssg and deploy it into aws cdn instead of paying for s2 instance . the only reason why we are running a node server behind is 301 redirects that seo team demands . so it looks like frontend redirects are not an option . my question is : is there any viable solution that can achieve 301 redirects , but still allowing us to convert a project into fully static ssg and serving it from a cdn ? thank you for your advice . < code >
hi next team , when upgrading our app to a newer version of next , we noticed that a polyfill for setimmediate was removed ( see # 10612 ) . although this function is n't supposed to be used in the browser , we unfortunately have to use it based on another package we rely on . in the pr review a team member mentioned how this is technically a breaking change . i totally understand this not triggering a major release , as this function should n't be used in the browser , and probably only affects a small number of users . but would it be possible to mark these changes in some way such that library users who are doing an upgrade can find potentially breaking changes faster ? maybe a label for `` potentially breaking '' changes , or something in the commit message that can be parsed easily ? this would drastically reduce frustration when experiencing a break going up to a minor version . thanks for everything y'all do ! < code >
hello people ! i 'm having trouble accessing pages with dynamic url ( data pulled from api with getinitialprops ) /empreendimento /imovel i get page 404 when trying to access one of them . here is the routes.js file here is the organization of the pages / folder my server.js file the application is started with next build , followed by next start i try deploy on vercel , but have the same problem < url > < code > empreendimento.getinitialprops = async ( { query } ) = > { const response = await axios.get ( ' < url > } ' ) ; const build = await response.data [ 0 ] return ( { build } ) } const routes = require ( 'next-routes ' ) module.exports = routes ( ) .add ( '/ ' , 'index ' ) .add ( '/imoveis ' , 'imoveis ' ) .add ( '/imovel/ : imovel ' , 'imovel ' ) .add ( '/empreendimentos ' , 'empreendimentos ' ) .add ( '/empreendimento/ : empreendimento ' , 'empreendimento ' ) ; imovel.getinitialprops = async ( { query } ) = > { const response = await axios.get ( ' < url > } ' ) ; const property = await response.data [ 0 ] const images = await property.images return ( { property } ) } const { createserver } = require ( 'http ' ) ; const next = require ( 'next ' ) ; const routes = require ( './routes ' ) ; const app = next ( { dev : process.env.node_env ! == 'production ' } ) ; const handler = routes.getrequesthandler ( app ) ; app.prepare ( ) .then ( ( ) = > { createserver ( handler ) .listen ( process.env.port || 3000 ) } ) ;
bug report a project importing `` ow '' ( even indirectly ) causes strange compilation-time error . to reproduce yarn create next-app edit pages/index.js add import ow from `` ow '' yarn dev see error : note : the problem does n't occur in plain react project ( i.e . created with yarn create react-app expected behavior obviously , the project should start normally . system information os : found on os/x i opened it as an issue of 'ow ' , but they say here that it seems more likely line next problem ... note that ow works correctly in browser environment ( we used it with react and with plain vanilla webpack ) < code > module not found : ca n't resolve 'fs ' in '/users/dror/downloads/tnext/node_modules/ow/dist/source '
i know it is possible to do app nesting with nextjs as your documentation says with multizones , but is it possible to do it with an app with create-react-app or custom webpack react-app ? example : locahost:3000 ( nextjs route `` / '' ) locahost:3000/dashboard ( react app without nextjs ) example.com ( nextjs route `` / '' ) example.com/login ( nextjs route /login use cookie or localstorage for token ) example.com/dashboard ( react app without nextjs and render router if have token or goto /login for login ) for example , only need the principal route and some simple routes need nextjs for staticprops and seo ( and marketing ) , but , the /dashboard not need ssr or staticprops , only react . it 's advisable ? or ... example.com ( principal route with seo and marketing calls ) and use app.example.com for `` dashboard example app '' ? ? ? i 'm thiking for example in framer : < url > ( i think have ssr ) < url > ( react virtual dom ) < url > ( react virtual dom ) ( i know packages have nextjs in other subdomain ) < url > ( nextjs ) it is advisable to use next js for an app that has a lot of interactions ( example : construction of large dynamic forms , where there is a lot of handling of react states ) ? ? ? ? this is where my doubt comes from , or do i do everything within nextjs and so i do n't conflict with the query i 'm making ? i hope you can understand my question . excuse my poor english 🤪 < code >
hello everyone : ) background : i have a custom server where i use express and have a redis session . i need to access a value inside of req.user but i 'm getting a typescript error saying user does n't exists i 've been trying to extend the interface to include the type definitions of the req.user object but with no success . if anyone 's done this or knows how to achieve this i would really appreciate it . thanks < code > property 'user ' does not exist on type 'incomingmessage ' .
in the below setup , i was under the impression that the following workflows would occur : user 1 hits page router.isfallback = true ( can show loading message ) user gets static page ( with props.isfallback == false ) and rendered props a user 2 hits page 15 seconds later ( more than the revalidate setting ) is sent user 1 static page with rendered props a new page is statically rendered in the background with props b page is updated with props b < -- - this step never happens so even though i have revalidate set to 10 seconds . the second user , who could show up 3 days later , might see 3-day-old data unless they manually refresh the page . am i doing something wrong , or was this the intended behavior ? < code > export async function getstaticpaths ( ) { return { paths : [ ] , fallback : true , } ; } ; export async function getstaticprops ( { params } ) { return { unstable_revalidate : 10 , props : { date : moment ( ) .format ( ) , } , } ; } ;
how do i start the project that i 've built using forever . yarn next-start works effortlessly to start it on server . but i want to keep the project running forever . using `` forever start /node_modules/.bin/next '' gives an error : script /node_modules/.bin/next does not exist because , obviously , it could n't find a script to run . so , how do i do it ? < code >
bug report describe the bug after making a request to my api route , not passing a query param , instead of returning undefined from the request.query object , it returns a string to reproduce steps to reproduce the behavior , please provide code snippets or a repository : clone < url > run cd server-side-rendering & & yarn & & yarn dev or cd server-side-rendering & & npm i & & npm run dev see that the pokemon list is n't returned go to the search api route to debug the result and see that req.query.name is `` undefined '' instead of undefined expected behavior a clear and concise description of what you expected to happen . if not providing a req.query.name , it should return undefined and then the filter would works as expected . screenshots system information os : [ macos ] version of next.js : [ e.g . 9.0.4 ] < code > const filterqueryname = req.query.name ? new regexp ( req.query.name as string , `` i '' ) : / . * / ;
i 'd like to implement a `` publication workflow '' where my customer uses the `` staging '' stage to preview the site as it will be released upon next build onto the production stage . i would like to enforce the ssg preview mode to be enabled when navigating in my staging stage , and have it disabled in the production stage . during development stage , i 'd probably need to toggle enabled/disabled in order to test both behaviours . it does n't make sense with such workflow not to have the preview mode enabled in staging , because it 'd display the site as it was last built for the staging stage , which may be very much older than the production stage . thus , i must make sure preview mode is always `` on '' there . how would you do that ? i 'm not sure if i should check in getstaticprops what stage is being used , and redirect the user to the api endpoint that enables the preview mode , or if it should be done client side , or any other way . < code >
i am currently using apollo-sever-micro and unlike it 's express counterpart , it does not have file upload functionality by default . i 'm wondering how others have solved this problem . would it be better to have a separate end point for file upload and then just use graphql to interact with the path or should i build in file uploads into micro and handle file upload in a resolver ? or perhaps there is an even better solution ? the one thing i 'm sure of is i do not want to use a custom server . < code >
as per version 9.4 , environment variables are available to both server and browser if we configured those by prefixing next_public . so this is my env file . .env this is working fine in local . i have tested using the build as well . on the server , i have configured these var in the kubernetes itself . in this case env var not available to my app . previously i have an old version of next.js . there also i have set the env var in the kubernates , but those were available to the app . i have mentioned the details below . .env next.config.js i do n't know what is the problem with the latest version 9.4 i have not set up anything in next.config.js for old version not for new . as per version 9.4 doc , env var available to both server and browser if we use next_prefix . am i missing something ? < code > next_public_apikey= < value > next_public_graphql_url= < value > next_public_indabode_website_url= < value > const webpack = require ( 'webpack ' ) ; module.exports = { webpack ( config ) { config.plugins.push ( new webpack.defineplugin ( { 'process.env.apikey ' : json.stringify ( process.env.apikey ) , 'process.env.graphql_url ' : json.stringify ( process.env.graphql_url ) , 'process.env.indabode_website_url ' : json.stringify ( process.env.indabode_website_url ) , } ) ) ; return config ; } } ; apikey= < value > graphql_url= < value > indabode_website_url= < value >
feature request next dev should offer a feature flag to print out a list of changes every time it recompiles the project . is your feature request related to a problem ? please describe . yes , i am banging my head against the wall , trying to figure out why my global stylesheet is n't being picked up . i 'm not sure if my next dev server is picking up changes to it or not . as far as i can tell , it does n't even know that the file is part of my project , even though i 've added the import statement to _app.js per the documentation . if next dev was printing out a detailed list of detected changes , that would help me troubleshoot the above-described problem better . describe the solution you 'd like when next dev recompiles the project , i 'd like an option / flag to print out a list of changes that were detected , so i can be sure that my css file is being picked up properly . describe alternatives you 've considered not aware of any alternatives right now . additional context n/a < code >
hey guys , as the title says , i 'm seeing this bug : i 'm not 100 % sure that this bug is caused by nextjs , but i wanted to discuss and see if maybe anyone had some insight . this redefined property is only included once in the file and is happening during ssr ( not sure if it 's also happening during client side , any easy way for me to check ? ) < code > typeerror : can not redefine property : react_navigation_redux_devtools_extension_integration_enabled at function.defineproperty ( < anonymous > ) at eval ( webpack-internal : ///./node_modules/ @ react-navigation/core/lib/commonjs/basenavigationcontainer.js:181:8 )
hey , we 're about to deploy nextjs to production in a few weeks . our site sits behind cloudflare and we have some extensive caching rules there . we 're thinking about pushing files from ./next/static/ to s3 and serving it from s3 so that , after we re-deploy our app to production , we wo n't lose old static files . this way , if someone visits a cached page that points to old static files , these files will still be accessible . is there anything i 'm missing here or that should work as expected ? < code >
i am currently trying out the with-firebase-auth example to implement firebase authentication in nextjs app . it 's working great except when i run a server side rendering . when i need to fetch some remote data ( that is not nextjs api endpoint ) i need to embed firebase access token so that the request can be verified . but since i am not able to retrieve the token on the server side , i am unable to use the token when retrieving data during getserversideprops . how can i overcome this problem ? < code >
i have an app , it utilizes ssr approach for some pages ( e.g . fetch reviews from db ) . my problem : until i rebuild the bundle ( with circle ci ) it does n't update reviews page with fresh reviews , that can be added a few times per day . is there a way to rebuild the bundle once per day or i am doing something incorrectly ? that 's how i fetch them : < code > export async function getstaticprops ( ) { const res = await axios.get ( ' < cur > { process.env.apiurl } /public/review ' ) const reviews = res.data return { props : { reviews , } , } } export default reviewspage
until recently , getinitialprops ( ) was the way to load data for pages . now it 's not mentioned in the documentation at all anymore , and has been replaced with instructions on using getserversideprops ( ) on the server and swr on the client . however , it 's not just a drop-in replacement . it would be very useful to have a migration guide for applications that have been built on getinitialprops ( ) . the biggest issue for us is that our redux implementation works with getinitialprops ( ) but not with getserversideprops ( ) , but that might be out of the scope of a generic next.js migration guide . < code >
im trying to resolve the issue where the test should run without the `` -- forceexit '' argument . however when i run the tests , and they 're done . jest do n't exit because there 're process running even when every test is complete . i tried to run each one of the integration tests and all of them uses killapp ( ) and stopapp ( ) to close everything . but when i run yarm testheadless or any command to test everything and are done , there are process still running . i 've seen that uses selenium webdriver and in the teardown i see that the server started at the start , it close mentioned server . can anyone help me understand what is going on ? i 've tried debugging and see that killapp along with tree-kill are not doing the job , however running it in the normal way killapp workds < code >
why put the api under the pages directory instead of the root directory ? any file inside the folder pages/api is mapped to /api/ * and will be treated as an api endpoint instead of a page . why not design in the root directory ? what is the main reason ? hope to get your answer . < code > - myapp - pages - api - myapp - api - pages
bug report describe the bug i 'm trying to render an image if it exist and not show it if it does n't , same code in reactjs using the browser side rendering works but it fails to work with using nextjs . here is a link to the sandbox nextjs example in the sandbox < url > server side rendering sandbox < url > to reproduce from nodejs nextjs component } error it shows broken images expected behavior the onerror functions should be invoked and replace the image with default or change the css so the image does n't show screenshots using nextjs with browser side rendering system information os : persistant through different os 's including mac and ubuntu version of next.js : v9.4.5-canary.26 version of node.js : v14.0.0 < code > import react from `` react '' ; export default function testimage ( ) { const replaceimgwitherror = e = > { e.target.onerror = null ; e.target.src = `` < url > } ; const hideimgwhenerror = e = > { e.target.onerror = null ; e.target.style.display = `` none '' ; } ; return ( < div > < h1 > hello codesandbox < /h1 > < h2 > start editing to see some magic happen ! < /h2 > < img onerror= { replaceimgwitherror } alt= '' foo '' src= '' < url > / > < img onerror= { hideimgwhenerror } alt= '' foo '' src= '' < url > / > < /div > ) ; app.get ( '/test ' , ( request , response ) = > { return next.render ( request , response , '/image/testimage ' , { } ) } ) ;
hi everyone ! i faced with some problem while developing next.js application . it is rather an architectural issue . i want to switch between routes , but keeping all the states on the page so that i can return to page without loosing it 's state . i understand that i need to use initalprops at the top level . but this is only suitable for simple cases . let 's take an example where there 're hundreds of states on a page with different levels of hierarchy . is it possible to make a snapshot of all page states ? i look towards memo from react . also , i think redux would help me , but i do n't use it in the application at all and it 's one more dependency . perhaps this can be solved using the context api . < code >
hi all , i am developing a page which has different filters , upon selecting any filter , query params need to be updated . for this , i am using the following code . router.replace ( { pathname : router.route , query : { l : filteredarray.length == 0 ? null : filteredarray , d : departmentfilters.length == 0 ? null : departmentfilters , q : keyword == `` ? null : keyword , } , } , { pathname : router.route , query : { l : filteredarray.length == 0 ? null : filteredarray , d : departmentfilters.length == 0 ? null : departmentfilters , q : keyword == `` ? null : keyword , } , } , ) ; the issue i am facing is , i am getting query params in the url even though the value is null like domain.com/pagename ? l= & d= & q= . how to get just domin.com/pagename if no filter is applied . is there any way to tell next router to not use particular param if the value is null . ( like in axios post ) ? < code >
hey there , i 'm pretty new to next and trying to figure how to approach and create something similar to < url > i have next hooked up to sanity cms for my blog and would like to get the 10 most read articles/posts on build based on ga data . has anyone worked on something like this ? currently i do n't have any code to share , just gathering information on what 's possible . thanks in advance < code >
hi there , i have an apollo web application which runs a query inside getstaticprops . this is working fine in development , and builds fine locally , however fails when building on vercel . the build console log shows a 500 error . my assumption is that the build is failing because of the cors setting on my backend ; i allow the origins < url > and < url > . my api is at < url > . i assume the build 's url is under some vercel domain and therefore the query at build time is being blocked by my cors policy , however i 'm not sure what this url is . is there a specific url i need to add here ? or is there either a way for the build to make requests under my own domain ? thanks , < code >
< url > in the example above , the queries are made within getstaticprops , but the page component is not using them after fetching . i 've tried setting it up locally and it works if i do : i am able to access the data returned from queries . but if i follow the example and try accessing apollo 's cache i get a bunch of root queries instead of resolved data : < code > export async function getstaticprops ( ) { const apolloclient = initializeapollo ( ) ; const { data } = await apolloclient.query ( { query , variables : { slug } , } ) ; return { props : { data } } ; } export async function getstaticprops ( ) { const apolloclient = initializeapollo ( ) ; await apolloclient.query ( { query , variables : { slug } , } ) ; return { props : { initialapollostate : apolloclient.cache.extract ( ) } } ; }
conditions next.config target : server getserversideprops return some dynamic data for /test 1st release client navigation hits /_next/data/buildid_1/test.json 2nd release client navigation hits /_next/data/buildid_2/test.json after the 2nd release , some of the clients may still run the first version , thus they request /_next/data/buildid_1/test.json which returns a 404 ( i think this does n't happen on serverless mode as the old lambda is still alive ) . the result is that the client navigation enforces a page reload and the new version is loaded . given this scenario , is the end user affected by any issue , except the full page reload ? ( i.e . any error or inconsistent state ) is there any way to handle these 404 responses more gracefully within the next server ? for example intercepting these requests and returning an empty response to the client < code >
hello , i would like to know if there a way to scroll to top instantly on every page and every browser refresh ? thank you 🙏 < code >
hi guys , i run in a pretty big project into a < url > due to broken/misspelled links deep nested in my page tree ( headless cms ) . due to the error the build process ( ssg ) never succeeds . is there a way to print out the broken links and on which they happen ? currently its quite difficult to keep track on broken links . is there ( probably out of nextjs ) a good spider/crawler which i could run over an entire site and test if all links are still working ? any suggestions are welcome ! thanks < code >
hello community i have a problem passing parameters from the dynamic path to my component , i 'm using getstaticpaths and getstaticprops i 'm following the documentation to the letter ( i think .. haha ) < url > if i use some public api i do n't have any problem ( the parameters are passed correctly to my component ) the problem is when i try to test with the url of my site , i 've tried using my localhost ( i do n't know if it 's the ideal for testing ) and the only thing i get is the legend `` socket hang up '' i do n't know if i should deploy my site for everything to work properly . from what i understand getstaticpaths will have the paths , in this case i use fallback true not to define all the paths that 's why i need to trap the parameters of my path , now with getstaticprops it will get the parameters and pass them to my component . now i have doubts am i doing something wrong ? am i putting getstaticprops and getstaticpaths to good use ? am i misunderstanding the documentation ? i add my code in case something is not clear i 'd really appreciate your help . < code > export async function getstaticpaths ( ) { return { paths : [ { params : { param : ' 1 ' } } ] , fallback : true } ; } export async function getstaticprops ( { params } ) { console.log ( params ) const res = await fetch ( ' ' ) < = my url const post = await res.json ( ) return { props : { post } } }
so with those new methods we have available ( getstaticprops , getstaticpaths , getserversideprops ) is it going to change somehow the way to handle data fetch using graphql/apollo ? thanks ! < code >
i keep getting this error when trying to run the build process on ubuntu . i never have a problem while testing and i 'm able to complete the build process on my mac . why is this happening ? all of my css and scss imports are already in the _app.js files . < code >
hey i would like to do something like that in < url > next 9.4 but its not possible like that because of the getinitialprops on the component . the api i wont to send the token to is an laravel api with laravel passport . < code >
hi we are started to face from today strange issue with our page . all 's does not changes browser url on click , but the browser does redirect to the page . as you can see from provided example on button hover , that contains in it , browser shows right href to project page with id . however , on button click the browser redirects to right page and does not changes the url . in short , all client side rendering ( link , router.push ) does not update location you could play with our site here all our links looks like : our nextjs version is little bit old one 8.0.1 and we did not upgrade any other related libs in last month . any help will be preciated < code > < link prefetch as= { '/project/projectid ' } href= { { pathname : '/project ' , query : { id : projectid , } , } } > < a classname= '' project-link '' > { name } < /a > < /link >
hi guys , i need to keep a specific query in the url whenever the user changes the page , how i can do this ? lest 's say the user open the site with url < url > and he navigated to another page < url > this the default behavior the query removed when i change the url , but i need to keep it so when the user navigates to another page it should be in the url , like this < url > thanks in advance . < code >
hello ! i 'm using nextjs along express and everytime i visit a protected page ( through client-side navigation ) , i get the error described above `` can not set headers after they are sent . '' i tried using res.end ( ) and still gives me the error above . this is the snippet i 'm using any help would be appreciated ! thanks ! < code > export const getserversideprops = async ( { req , res } ) = > { const result = await auth.isauth ( req ) ; if ( result.loggedin === true ) { return { props : { authusername : result.username , loggedin : true , } , } ; } else { res.redirect ( `` /signin '' ) ; return { props : { } } ; } } ;
happy friday next.js friends 👋 i 've just published a post detailing my next.js helper : next-google-fonts . it ensures your google fonts load fast and asynchronously . i 've used this approach in a few projects now and it 's proved to be pretty successful . if you use google fonts , i 'd love to hear what you think . < code >
bug report ineffective mark-compacts near heap limit allocation failed - javascript heap out of memory describe the bug when running the next dev the server starts up then complies but once done the browser is n't able to reload and then stalls for about a minute and then gives the error . a clear and concise description of what the bug is . fatal error : ineffective mark-compacts near heap limit allocation failed - javascript heap out of memory 1 : 0x100bc9ae7 node : :abort ( ) ( .cold.1 ) [ /usr/local/cellar/node/14.4.0/bin/node ] 2 : 0x10008186d node : :fatalerror ( char const * , char const * ) [ /usr/local/cellar/node/14.4.0/bin/node ] 3 : 0x1000819d6 node : :onfatalerror ( char const * , char const * ) [ /usr/local/cellar/node/14.4.0/bin/node ] to reproduce steps to reproduce the behavior , please provide code snippets or a repository : go to ' < url > clone the repo cd into the repo run next dev expected behavior a clear and concise description of what you expected to happen . it should work completely fine . screenshots if applicable , add screenshots to help explain your problem . system information os : macos catalina browser chrome version of next.js : latest version of node.js : v14.4.0 additional context add any other context about the problem here . < code >
my app.tsx file : my next.config.js : the styles in _app.scss not working . please help . < code > import { appprops } from 'next/app ' ; import { provider } from 'react-redux ' ; import { persistgate } from 'redux-persist/integration/react ' ; import { appwithtranslation } from 'i18n ' ; import { store , persistor } from 'store ' ; import './_app.scss ' ; const myapp = ( { component , pageprops } : appprops ) = > ( < persistgate loading= { null } persistor= { persistor } > < provider store= { store } > < component { ... pageprops } / > < /provider > < /persistgate > ) ; export default appwithtranslation ( myapp ) ; module.exports = { ondemandentries : { maxinactiveage : 25 * 1000 , pagesbufferlength : 2 , } , sassoptions : { includepaths : [ ] , } , } ;
i can only send the page , which is the slug . it 's late in the night and i ca n't find what 's wrong . it took hell a lot of console.log 's to pinpoint it to here < code > getstaticpaths ( ) = > ( { const data = params : { page : post [ 1 ] , anotherparam : `` ca n't read this or any other param from getstaticprops '' } return { paths : data , fallback : false } } ) ,
bug report perhaps current next.config.js config seems to prevent the route.push to redirecting the page . if you try to redirect nothing happens . not sure if it is something the way less/css is built . to reproduce create a test page with the following code npm run dev - go go the test page and click on button expected behavior button click should redirect to main home index page system information os : [ e.g . macos ] pontential solution this setup worked and fixed the issue for me : < url > < code > import router from 'next/router ' ; export default function testroute ( ) { return ( < button type= '' button '' onclick= { ( ) = > router.push ( '/ ' ) } > test < /button > ) } `` dependencies '' : { `` @ zeit/next-less '' : `` ^1.0.1 '' , `` antd '' : `` ^3.5.4 '' , `` babel-plugin-import '' : `` ^1.7.0 '' , `` less '' : `` 3.0.4 '' , `` less-vars-to-js '' : `` 1.3.0 '' , `` next '' : `` latest '' , `` null-loader '' : `` 2.0.0 '' , `` react '' : `` ^16.7.0 '' , `` react-dom '' : `` ^16.7.0 '' } ,
i have tried for hours and hours to set a header using cookie or a session but its just not possible . can someone please guide on how i can set a dynamic header on the apollo client so that i can then authenticate with my graphql backend . i am using hasura for backend graphql . < code >
hello ! i 'm trying to make a fontawesome icon clickable , and when it gets clicked , to load another page of /pages folder . this is my code : but i 'm getting these errors : what i 'm doing wrong ? < code > < section > < link > < a href= '' /counter '' > < fontawesomeicon icon= { fachevronright } / > < /a > < /link > < /section >
suppose i have a page that will show the details of each chapter in the book . user can navigate to other chapters from that page , as the screen has buttons of chapters in the sidebar , and the main content shows the details of the chapter . now the user will navigate to that page from a list of books . at the page information , there 's no chapter information of that book . now if the url is ookslug , so the page will show the details of the first chapter , even it is not mentioned in the url , it will fetch the list of chapters then fetch the details of the first chapter from that list . this behaviour remains the same for url ookslug irstchapterslug . so , in react-router i used to do it like this . and on the page , i handle the params , that id the chapterid is undefined to just fetch the first chapter or just fetch the chapter mentioned in the chapterid param . now , i 'm stuck here , it is just not working , even i have marked the params in the getstaticpaths optional getstaticpaths < props , { bookslug : string , chapterslug ? : string } > s that i can write logic . how can i achieve that react-router behaviour here in nextjs dynamic routing ? < code > < route path= { '/ : bookid/ : chapterid ? ' } component= { chapterdetails } > < link href= { '/ [ bookslug ] / [ chapterslug ] ' as= { '/somebookname ' } >
i am currently working on a project that uses apollo graphql and nextjs . i have structured the project quite commonly by having components folder and containers folder where container folders include apollo states . at first , i thought it would be possible to call getserversideprops from the components and containers but it does n't seem to be the case . so currently i am calling the queries in the page that uses the containers and using usequery hook in the container to retrieve the state . then i begin to wonder if the container will be server rendered or not . how do i check if a component is being fully server rendered with the states that i expect to be present ? < code >
why i 'm just getting `` an unexpected error has occurred . '' upon embedding < url > using the following expo react-native code ? i guess webview is preventing some of my page scripts ? any fix ? ref : expo/expo-cli # 2320 luckily , it 's working on my phone but not on my android emulator ! < code > { platform.os === 'web ' ? ( < page / > ) : ( < webview source= { { uri : constants.manifest.extra.public_url + '/item-displays ' , } } style= { { height : layout.window.height } } / > ) }
my requirement is to run desktop-based web app and the mobile-based pwa app from the same repo . what i want to achieve is inside the src folder i will have 2 folders pwa and desktop . when a request is made from the desktop browser , pages from the desktop folder will be served and when any request is made from the pwa app pages from the pwa folder will be served . -src | -- pwa | -- -pages/index.js | -- desktop | -- -pages/index.js i am using `` custom express js server '' . note : i know its very easy in case we have 2 separate repo and serve it through 2 different servers and nginx can easily route them . but the requirement is to have both codebases in the same repo . < code >
hi next team , now i 'm setup scss for my project and then i decion write scss module to enscape my component . style.module.scss ; .root { .name { } } and my component wil using styles.root at root component . any example for above problem ? . thank you . < code >
when pre-rendering dynamic pages via getstaticpaths and props , the generated .json is stored , and loaded from a hashed folder . e.g . .next/server/static/ { hash } /pages with a new deployment , does n't the build process then create a new set of .json files to be served invalidating cache ? < code >
bug report describe the bug i 'm calling a certain api ( inside the /pages/api folder ) in getserversideprops and i 'm getting an error i do n't really understand . to reproduce here 's what my code looks like : this is suppose to make a call to the absolute url , which locally would be < url > however i always get the following error : expected behavior i was hoping it would hit my api endpoint . screenshots if applicable , add screenshots to help explain your problem . < code > { error : querya enotfound localhost at queryreqwrap.onresolve [ as oncomplete ] ( dns.js:196:19 ) errno : 'enotfound ' , code : 'enotfound ' , syscall : 'querya ' , hostname : 'localhost ' } import zeitfetch from `` @ zeit/fetch '' const fetch = zeitfetch ( ) export const getserversideprops : getserversideprops = async context = > { const cookies = parsecookies ( context ) const { req } = context const { origin } = absoluteurl ( req , `` localhost:3000 '' ) const token = cookies.token try { await fetch ( ' < cur > { origin } /api/favorites/list ' , { headers : { authorization : 'bearer < cur > { token } ' , } , } ) } catch ( error ) { console.log ( { error } ) } return { props : { cookies } } }
hi , recently i bought a template from themeforest that included a owl carousel but sometimes work and some does n't here how my _document.js looks as you can see i 'm importing jquery before thw owl-carousel script , so not sure if the problem is next js it self or with the file inside the script tags < code > < html lang= '' en '' > < head > < meta charset= '' utf-8 '' key= '' charset '' / > < meta name= '' viewport '' content= '' width=device-width , initial-scale=1 , shrink-to-fit=no '' key= '' viewport '' / > < link rel= '' shortcut icon '' href= '' images/favicon.ico '' / > < link href= '' < url > rel= '' stylesheet '' / > < link rel= '' stylesheet '' href= '' owlcarousel/owl.carousel.min.css '' / > < link rel= '' stylesheet '' href= '' owlcarousel/owl.theme.default.min.css '' / > < /head > < body > < main / > < nextscript / > < script src= '' js/jquery-3.3.1.min.js '' > < /script > < script src= '' js/popper.min.js '' > < /script > < script src= '' js/bootstrap.min.js '' > < /script > < script src= '' js/main.js '' > < /script > < script src= '' < url > < script src= '' owlcarousel/owl.carousel.min.js '' > < /script > < script src= '' js/custom.js '' > < /script > < /body > < /html >
i started using scss modules style and i think i 'll need to use the classnames lib in some cases , if is compatible , do i need to be careful with something ? < code >
feature request is your feature request related to a problem ? please describe . i 'm currently in the process of taking a wordpress site headless with next.js ( thanks to 9.3 🙌 ) . in wordpress , there are pages and posts ( among other entities ) that can create urls with slugs top level ( e.g . < url > < url > ) . i think for ssg , it 's reasonable to allow different templates for the same dynamic path scheme . describe the solution you 'd like i 'd like to be able to do something like this : it seems like this is possible if the getstaticpaths does not return conflicting paths and if either both ( or possibly just one ) file has fallback set to false . describe alternatives you 've considered i could get around this by adding some manual routing between the two different slugs but it requires get the paths and pulling them into the component to do matching . even if these pages share the same dynamic path , the component templates are different so it 'd be nice if next would handle this case . additional context gatsby allows these kind of schemes already via their createpage api . i think that + the fact the wordpress has top-level url slugs with different templates justifies implementing this . < code > /pages -- [ post ] .tsx -- [ page ] .tsx
inside of _document.tsx , the following produces a build error : feels as though it should work the same as this ( successfully builds ) : ran into this : 'rangeerror : maximum call stack size exceeded error occurred prerendering page `` /404 '' . read more : < url > rangeerror : maximum call stack size exceeded build error occurred error : export encountered errors on following paths : /404 at exportapp ( /users/harrysolovay/desktop/cdk-fargate-next-test/node_modules/next/dist/export/index.js:22:1166 ) at processticksandrejections ( internal/process/task_queues.js:97:5 ) at async build ( /users/harrysolovay/desktop/cdk-fargate-next-test/node_modules/next/dist/build/index.js:36:218 ) ' < code > import * as react from `` react '' ; import { head , html , main , + default as nextdocument , nextscript , } from `` next/document '' ; import * as react from `` react '' ; + import document , { head , html , main , nextscript } from `` next/document '' ;
when i create route /one and /two and have getserversideprops in each of them , even if i route through clicking on next link i realized that getserversiedeprops runs . however , i thought that only the original request runs in the server and subsequent navigation happens through client side rendering . if that is the case , getserversideprops should only fire during the initial request but obviously that does n't seem to be . is this because i am currently running in dev mode or is it how it is supposed to be ? < code >
i have a project structure like this : as you can see my dynamic projects page has name [ id ] .js but my code href= '' projects/ [ bar ] '' and it works . i can even make it href= '' foo '' and it also works . a can click on the link and get to the project 's page . i was thinking that it automatically looks for the same folder as as is pointing to and looks there for any dynamic route page . but then i tried to rename the page folder and set it in href like this but it does n't work . and i would expect quite the opposite : the first example to fail and the second to work . so what am i missing here ? how does href actually work in link ? < code >
i want to import a css file that is being used by a third party library but not have to import it in _app.js as i do n't want it loaded on all pages . just using import './component.module.css ' ; will not work as those classes will have different names with hashing . also linking the css file directly in the head ( of each page that would use this component ) would not be optimal as the css would not get minified . is this currently not supported in next 9 built-in css support ? if not , what ( if any ) workarounds are there out there ? thanks in advance . < code >
i have been trying to fetch some data using getserversideprops and pass it as props to my page component but the props received by the page component is always an empty object . page/about.js function about ( props ) { console.log ( props ) // is an empty object return } export async function getserversideprops ( ) { const res = await fetch ( < url > ) const data = await res.json ( ) console.log ( data ) // has data return { props : { data } } } export default about ; package.json { `` name '' : `` biz-page-demo '' , `` version '' : `` 0.1.0 '' , `` private '' : true , `` scripts '' : { `` dev '' : `` next dev '' , `` build '' : `` next build '' , `` start '' : `` next start '' } , `` dependencies '' : { `` @ apollo/react-components '' : `` ^3.1.5 '' , `` @ apollo/react-hooks '' : `` ^3.1.5 '' , `` @ material-ui/core '' : `` latest '' , `` @ zeit/next-css '' : `` ^1.0.1 '' , `` apollo-boost '' : `` ^0.4.9 '' , `` bootstrap '' : `` ^4.5.0 '' , `` graphql '' : `` ^15.1.0 '' , `` isomorphic-unfetch '' : `` ^3.0.0 '' , `` next '' : `` 9.4.4 '' , `` react '' : `` 16.13.1 '' , `` react-bootstrap '' : `` ^1.0.1 '' , `` react-dom '' : `` 16.13.1 '' , `` react-star-ratings '' : `` ^2.3.0 '' } } the above example is from the official next.js docs . < code >
hey 👋 according to the docs : before deciding to use a custom server please keep in mind that it should only be used when the integrated router of next.js ca n't meet your app requirements . a custom server will remove important performance optimizations , like serverless functions and automatic static optimization . after reading this , my assumption is that automatic static optimization is not being used if we use a custom server . however , the following excerpt from the blog announcing next.js 9 seems to contradict this : this heuristic allows next.js to emit hybrid applications that contain both server-rendered and statically generated pages . the built-in next.js server ( next start ) and programmatic api ( app.getrequesthandler ( ) ) both support this build output transparently . there is no configuration or special handling required . i was a bit confused so i did some tests and it seems that even when using a custom server pages not including any data fetching requirements ( i.e . getinitialprops , getserversideprops , etc . ) are being generated as static pages . furthermore , pages including getstaticprops are being generated using ssg ( static html + json ) . this seems to verify what the second excerpt above states . another thing i noticed though is that the first excerpt referenced above says that `` a custom server will remove important performance optimizations '' . so could it be that the files are automatically statically optimized but using a custom server would cancel this optimization ? can anyone clarify this ? < code >
my use case is this : i have one app that serves multiple domains . the app fetches different data based on the domain ( for example translations and cms pages ) . currently i need to use getinitialprops or getserversideprops because that 's the only place where the req.headers.host is available . but theoretically all this information can be provided at build time via the correct environment as translations and pages do n't change that often and do n't need to be fetched on every request so that all pages could be generated statically . some ideas that came to mind : using different branches and deploying each branch as a separate app ( very error prone as each branch has to be kept up-to-date ) using multiple build commands in package.json ( do n't know how to use this with zeit now ) but all this feels not quite right . is there a go-to route for a project structure like this ? < code >
feature request i would like to have some exposed option like terseroptions.drop_console to remove all of the console.log via next.config.js config.experimental is your feature request related to a problem ? please describe . the production build of the site that i am working with the team have quite significant portion of console.log for debugging and we want it to be shown on staging environment , except for production environment that need to disable all the logs . describe the solution you 'd like describe alternatives you 've considered maybe expose entire terseroption that can be spread into the object ? < code > new terserplugin ( { extractcomments : false , cache : path.join ( distdir , 'cache ' , 'next-minifier ' ) , parallel : config.experimental.cpus || true , terseroptions : { ... terseroptions , drop_console : config.experimental.dropconsole , } , } ) , { ... terseroptions , ... config.experimental.terseroptions , }
hey everyone ! i followed redux-with-wrapper example and when i finally built my project i keep seeing this : is this intended to happen ? i am 100 % sure there 's no getinitialprops in my _app file : ( here 's the code of my app file : < code > warning : you have opted-out of automatic static optimization due to 'getinitialprops ' in 'pages/_app ' . this does not opt-out pages with 'getstaticprops ' type props = { login : typeof login ; user : idashuser | null ; } ; const mapdispatchtoprops = ( dispatch : dispatch ) = > { return { login : bindactioncreators ( login , dispatch ) , } ; } ; const mapstoretostate = ( store : any ) = > { return { user : store.user , } ; } ; class myapp extends app < props > { async componentdidmount ( ) { // log in the client const { login , user } = this.props ; if ( ! user ) { login ( ) ; } // remove the server-side injected css . const jssstyles = document.queryselector ( `` # jss-server-side '' ) ; if ( jssstyles ) { jssstyles.parentelement ! .removechild ( jssstyles ) ; } } public render ( ) { const { component , pageprops } = this.props ; return ( < fragment > < cssbaseline / > < component { ... pageprops } / > < /fragment > ) ; } } export default wrapper.withredux ( connect ( mapstoretostate , mapdispatchtoprops ) ( myapp ) ) ;
i posted it as comment in other discussion but this issue is much different than that so i am creating a new one here . the issues is that i have some static images in the /public folder between ~100kb to ~300kb file size each . just after the upgrade to 9.4.0 it has become extremely slow to come from the server . the rest of the things at lightning fast speed but something terribly wrong with images . has anyone else seen this issue ? i am not on now but i do not think it is a platform issue . < code >
bug report describe the bug when attempting to import fs inside a static method on a component , we are met with the message can not resolve module 'fs ' in .... to reproduce steps to reproduce the behavior , please provide code snippets or a repository : git clone < url > cd next-fs-bug yarn build expected behavior the fs module to be available . system information os : macos 10.15.5 browser ( if applies ) : n/a version of next.js : 9.4.4 version of node.js : v12.6.1 additional context we are using some custom prop initializers in pages in order to handle pulling in translation data from the file system . this is handled as a static method on a provider component , which imports the fs module and gets the translation data from the file system . the example i 've provided simply attempts to read from the current directory , but is essentially what we are doing in our app . < code >
i 'm using a focus-visible polyfill , that way mouse events on clickable elements such as button wo n't trigger the focus outline . on nextjs , focus-visible successfully loads , because it 's class and data attribute is added to the html tag , but the focus outline still appears when clicking on button elements . focus-visible is loaded by _app.js page tried loading focus-visible inside _document.js page , did n't make a difference . the css used by both demos . demo : focus-visible removes outline on create-react-app demo : focus-visible fails to remove outline on nextjs < code > import `` focus-visible '' ; function myapp ( { component , pageprops } ) { return < component { ... pageprops } / > ; } export default myapp ; // removes outline when clicking .js-focus-visible : focus : not ( .focus-visible ) { outline : none ; } button { display : block ; cursor : pointer ; border : none ; background : # ccc ; margin : 10px 0 ; } // displays when focusing with keyboard button.focus-visible { color : red ; }
i 've created a blog with a new tutorial ( it 's great tutorial ) . and , i wanted to display toc in my post . i already know how to use remark-toc and remark-slug . here 's an image of what it looks like when i use them this is n't so bad . but i want to see it in the sidebar . can i do it with remarkjs ? do you have any ideas ? < code >
had this error when i try to start the page on the newly freshly created nextjs app ( 9.4.4 ) . seems like all the failed to fetch files were from the .next folder ... but i could see it fetched _app , webpack and main from .next just fine . i had no idea why it failed like that ... i could see all the files inside the .next folder . this app runs inside docker in our ec2 btw . and also there are another 2 nextjs app deployed in it , under the same domain . not sure if that helps in anything .. < code >
what are the recommended strategies to do so when using headless cms ( contentful , for example ) to source the data from and use it for ssg ? triggering a rebuild of the project ( next build ) seems like the first option atm but this can be very time consuming < code >
currently i do n't believe there 's a way to run a serverless build of a next.js application locally against a suite of cypress tests . ( or to simplify - just simply run a serverless build of a next.js application locally . we 're trying to run an e2e cypress test suite against a build in our ci ( github-actions ) . the only way we 're having any success is to run it against next dev . would love to have the tests run more efficiently if it was running against a build . note : only reason we 're not running it against an actual vercel build-preview is we 'd like to have full control over the services it 's interacting with : i.e . spinning up database & hasura via docker-compose . < code >
i have an external backend endpoint that relies on a cookie being present when calling . i tried adding the endpoint to getstaticprops but of course it fails and gives me a 401 because it does n't have the cookie build time . i can easily get it to work on the client side calling useswr there and it works perfectly now my question is . a ) is there any way to get this working on getstaticprops ? ( please remember the cookie is generated by the backend . ) b ) i could try and do it with getserversideprops since that would have access to the cookie i believe . would i gain anything by doing that ? c ) i 'm a newbie when it comes nextjs ( did many tutorials and a couple of project but still missing a couple concepts ) is there any drawback of using useswr directly and not using getserversideprops or getstaticprops ? 'const component = ( ) = > { const dispatch = usedispatch ( ) ; const fetcher = ( request ) = > axios ( request ) .then ( ( people ) = > { dispatch ( setpeople ( people.data ) ) ; return people.data ; } ) ; const { data , error } = useswr ( '/rest/myendpoint ' , fetcher ) ; if ( error ) { console.log ( error ) ; return ; } if ( ! data ) return null ; return //my component that work is here } ' this is what i have so far < code >
there are only discussions about this but i could n't find actual feature request issue . # 11272 # 10977 # 11370 imagine you 'd like to create a new page for each .json file in a directory . this would allow you to e.g . iterate over .json files and import/read them in one go without doing it in getstaticprops . in gatsby , you have something like createpage function . consider this example : < url > < code >
good day . i am wondering whether it is possible to persist a instance of an sql client across pages in a browser session with nextjs ? stay safe , and thanks in advance , tmp . < code >
hi , is it possible to return additional data in the getstaticpaths ( ) response ? and read that in getstaticprops ( context ) for example currently the context parameter in getstaticprops ( ) is just we would like to fetch data from our cms by id in getstaticprops , but show a different slug . < code > { paths : [ { params : { slug : [ 'content ' ] , data : 'extra ' } } ] , fallback : false } { params : { slug : [ 'content ' ] } }
suppose i have a slug for my website /en/blog/post-1 matching the dynamic route / [ lang ] /blog/ [ post ] , and i 'm using next.js to export the blog post page at build time using getstaticprops and getstaticpaths . the dilemma i am facing is as follows : inside getstaticpaths i query a cms for all posts , their language and seo-slug ( [ lang ] , [ post ] ) , to generate an index for the pages and pass these as params to getstaticprops . inside , i not want to query only the single post that is being created right now but to do that i need to know the uid of the post . i can query that in getstaticpaths alongside with the other data , but i have n't yet found a way to pass it into getstaticprops since it 's not part of the route ( and it shoul n't be for seo purposes ) . has anyone experienced something similar or knows of a workaround ? essentially , i am looking for a way to inject data into context from within getstaticpaths . cheers , simon < code >
en mi _document.js tengo importado unos scripts que usa la plantilla con la que trabajo cuando la pagina principal carga estos se cargan y funciona todo . pero cuando navego hacia orta pagina usando link de nextjs como este carga lo nesesario no me vuelve a carga los scripts , por lo que pierde funcionalidades los componentes q dependen de ellos import document , { html , head , main , nextscript } from 'next/document ' export default class mydocument extends document { render ( ) { return ( < script src= '' assets/jquery-3.5.1.min.js '' type= '' text/javascript '' > < /script > < script src= '' assets/vendors/base/vendors.bundle.js '' type= '' text/javascript '' > < /script > < script src= '' assets/demo/default/base/scripts.bundle.js '' type= '' text/javascript '' > < /script > ) } } < code >
we have recently shifted to nextjs from the custom react server at < url > . the problem is there are too many chunks that are being built , and that 's great considering parallel loading . but when we 're creating bundle there are lot of small chunks , that can be merged . i skimmed through the nextjs source and the granular chunking limit is 20kb . next.js/packages/next/build/webpack-config.ts line 429 in bef9b56 minsize : 20000 , is this an unintentional behavior or a bug ? what can be done to improve it . a sample screenshots < code >
my web app was building alright and being exported correctly , then i decided to go from pure static to ssg by adding fallback : true to some of my blog pages . ssgs can not be exported , so there is n't an `` out/ '' folder with an index file that can be served . netlify builds as it should , but all i see when i go ahead and navigate to the preview url is a 404 page . the only way i can think to sort this out is to point to the actual build folder , so netlify can serve my web app correctly . where is the build folder save after build ? any help would be great . < code >
next.js project is working on browser as excepted . but facebook debug to only read data from _app.js but not from other pages . i am putting headers for seo purpose in these pages but as facebook does n't crawl through so its not working . i am checking url at < url > next.js v9.3.6 node v14.4.0 < code >
so i hosted my website on vercel and added a custom domain to it and its working fine . when i try to share a post from that domain , linkedin blocks the request with a message that it 's suspected as a malicious website . but when i share from the automatically assigned deployment urls , it works fine . has anyone come across this issue before and if so , it is because of the default ssl certificates attached by vercel ? fyi , i checked the domain for any malware and none were reported . < code >
i 've got a route setup at pages/ [ [ ... page ] ] .js as a fallback route ( optionalcatchall is enabled ) . navigating to a route that is n't explicitly defined is successfully landing on this page as would be expected , both when clicking on a link , and when using browser navigation . when hovering over a link , however , next is attempting to prefetch the page . for explicitly defined routes this works fine , however for routes that would fall back to [ [ ... page ] ] .js , requests are being made to /_next/static/ ...... /pages/some/route/here.js , which then 404s . while this does n't directly impact ux , it causes the console to be spammed with a wall of 404 errors . is this intended behaviour , and is there a way to change it without globally disabling prefetching ? < code >
in my project i have a global css file , and i 'm using css modules ( * .module.css ) . i 've noticed that there is a fouc . is there a way to fix it or should i just switch to another styling solution that does n't have this problem ? < code >
i 'm looking to import a header component into my app as a micro frontend . i am also considering if this would work for nuxt but i have n't gotten much info there and our team is likely switching to react/next . basically i 'm curious if there are any examples of microfrontends within next in this kind of fashion , consuming remote components at runtime , not build time . i was originally going import the header via a script tag but then i 'd likely have to have react stored on the global namespace so i 'm not sure if that 's the best way to go . i 've considered using single-spa and/or systemjs to pull in this header but i have n't found a way for these things to play nicely with next . are there any examples of this ? lastly , i saw this repo for module federation with next but i ca n't find any other mention of that aside from that link so that might require a lot of work . is there another way of using a micro frontend within next that would work or will any of the approaches that i 've mentioned work out ? < code >
bug report describe the bug in development mode , the method element.getboundingclientrect ( ) returns the right values . in production mode , after being build , the values are wrong . i have a feeling it has something to do with importing the css ( scss ) . for elements like span , which are only styled , they are 0 in width , which means that the css has not been fully loaded . ( only in production as well ) to reproduce expected behavior in development mode i get these data development while in production it 's totally different , and wrong ... production : system information os : macos catalina 10.15.1 browser safari 13.0.3 and firefox developer edition 78.0b3 version of next.js : 9.4.1 version of node.js : 12.16.1 < code > { bottom : < phone > 375 , height : 16 , left : 8 , right : 8 , top : < phone > 375 , width : 0 , x : 8 , y : < phone > 375 } { bottom : 430.5 , height : 5 , left : 104 , right : 204 , top : 425.5 , width : 100 , x : 104 , y : 425.5 } componentdidmount ( ) { const element = document.getelementbyid ( `` bouding '' ) ; console.log ( element.getboundingclientrect ( ) ) ; } render ( ) { return < h1 classname= '' bouding '' > bouding element < /h1 > }
i am trying to implement custom scrolling functionality . when a user navigates away from the page i want to store the scroll position of the page so i can restore it when they return with back and forward buttons . next/router does n't provide any type of history and every time i try to save to the window.history 's state next/router overwrites this data . it seems as though they have taken away functionality that should be available with no alternative . i either need to have a reference to each page like an id or something so i can store scroll data in my own state or be able to store data in the window.history state . i do n't see any way to achieve this with next/router . i am trying to store data on routechangestart and retrieve it on routechangecomplete like so : i have also tried setting the data to options in the state i think that is what the following discussion was about # 5918 but i get really inconsistent results . < code > const sethistory = ( ) = > { const { state } = history ; const newstate = { ... state , scroll : 'my custom scroll position ' } ; history.replacestate ( newstate , `` , state.url ) ; } ; const handleroutechangestart = ( url ) = > { sethistory ( ) ; } ; const handlepopstate = ( ) = > { //console.log ( window.history.state ) ; } ; window.addeventlistener ( 'popstate ' , handlepopstate ) ; router.events.on ( 'routechangestart ' , handleroutechangestart ) ;
i 'm receiving the above mentioned error message when deploying a build to heroku . i 've checked the docs at no cache detected but no configuration is available for heroku . how do i resolve this ? to reproduce steps to reproduce the behavior , please provide code snippets or a repository : git subtree push -- prefix app-name master expected behavior builds are currently taking an inordinate amount of time to complete . i expected the deploy to build without errors . system information os : windows 10 pro version of next.js : 9.3.5 < code >
i am using express custom server only for socket.io for api routes i am using pages/api folder . the app is working fully in dev mode.how can i deploy it with custom server ? do i need to move my api routes in custom server ? my server configuration : < code >
it does not support ssr in official documentation ! you can explain how to render the received data with the redux-toolkit . how to use it with getstaticprops or getinitialprops . please help me understand < code >
i am currently trying to use getstaticprops to enrich my dynamic pages with some seo information at build time . the cms is only available via ssh-tunneling into a server and then extracting the data . now , and i might be going wrong here , every single pageid creates their own tunnel , and pretty quickly they collide . is there a standard way to share a tunnel/database connection among all getstaticprops calls during build of pages with dynamic paths ? < code >
imagine there is a component , huge in size and an api at build time decides whether to show it or not like so so the props are only generated at build time and usually that component does n't need to be rendered yet is loaded what if we could intelligently know that and not load the component knowing the prop for it is not going to change < code > export default function index ( props ) { return ( . . . { props.data.showoffers & & < offers data= { props.data } / > } . . . ) } export async function getstaticprops ( ) { const res = await fetch ( apiurl ) ; const data = await res.json ( ) ; return { unstable_revalidate : 86400 , props : { data : data } } }
hi , i 'm using next + vercel + sentry , i configured the project based on < url > and use sentrywebpackplugin to upload the sourcemap like this how i should bind the release : buildid when i initialize sentry in _app.tsx ? here release should be buildid as well . < code > // next.config.js ... config.plugins.push ( new sentrywebpackplugin ( { include : `` .next '' , ignore : [ `` node_modules '' ] , urlprefix : `` ~/_next '' , release : options.buildid , } ) ) ; ... // _app.tsx ... sentry.init ( { enabled : process.env.node_env === 'production ' , environment : process.env.environment , release : ? ? ? , dsn : process.env.next_public_sentry_dsn , } ) ...
hey ! i 'm new to nextjs . i wanted to store some secrets but i 'm a bit confused about what is the correct way of storing secrets in a nextjs app ? does storing keys in my next.config.js make them untraceable from the front-end ? if not , what really is the difference between storing keys in a simple .env file or a next.config.js file ? can someone please suggest a good method of storing and utilising keys securely ? < code >
problem i deployed the application on server and run in production mode . when starts the document size is 16k but when users start to access it increases in size , in the figure it has 12mb . what 's happening ? i need do a different configuration on the application ? it 's just happens on production mode . < code >
hi , looking at the static no-js export without the next/head component and still be able to use sass to link to a stylesheet . i assume sass compilation would need to be set up in next.config does anyone have a working example of that and what path to use for the stylesheet for both local development and static export ? < code >
i have a context provider like this : based on if isloggedin is true or false different content is displayed . when i change usetogglestate ( true ) manually in my code to usetogglestate ( false ) and save the file i expect the content on my page to be reloaded according to current state . however , it does n't happen . if i hard refresh a page , right content is loaded . according to my understanding , dev server is not hot reloading for some reason . can this be fixed somehow ? thanks ! < code > import { createcontext } from `` react '' import usetogglestate from ' .. /hooks/usetogglestate ' export const usercontext = createcontext ( ) export function userprovider ( props ) { const [ isloggedin , toggleloggedin ] = usetogglestate ( true ) return ( < usercontext.provider value= { { isloggedin , toggleloggedin } } > { props.children } < /usercontext.provider > ) }
i would like to use nextjs to create widgets for the other websites . when embed two widgets on the same site , nextjs serve duplicates shared by all scripts . shared by all 78.8 kb static/pages/_app.js 14.5 kb chunks/84189ff7ed72d5fce6e5674d20b5b99d140fad59.4069b9.js 7.42 kb chunks/commons.385a1d.js 2.43 kb chunks/e5ec452abb5649f4bd450b2e0829c6ecf1b7d1f9.b4ae79.js 7.97 kb chunks/framework.5fcc71.js 40.3 kb runtime/main.36d6ba.js 5.46 kb runtime/webpack.91b117.js 746 b is it possible to somehow separate these scripts and return them to everyone ? < code >
i am wondering if there is any documentation on what exactly next start does ( additionally to this that is ) . the reason why i am asking is that i am running my next.js app out of a docker container and am thinking it surely possible to remove some of the noise during building the container . cheers < code >
i have fairly large number of pages and this makes navigation during dev mode painfully slow . what is recommended way to handle getstaticpaths in development mode ? currently i set fallback true and limit number of results to just one if node_env is not set to `` production '' . are there any recommended ways to handle this ? < code >
bug report describe the bug a colleague is facing an issue when building ( `` npm run build '' ) the application on which we 're both working . the failure ( see below ) is produced by a mongodb client error ( that we probably should handle anyway ) and i would like to know if internet connection can be a factor in the success and/or failure of the build process . it is my main hypothesis , because ... ... there is no deployment problem ( vercel ) and i can build the exact same code ( including the required env variables to fetch the data ) without any problem . ... yesterday she had a strong internet connection and everything went fine . today , she has slow 3g at best . slow but working : 'npm run dev ' gets her all the data , she can push the code , etc . the error : to reproduce i ca n't reproduce on my computer expected behavior npm run build should work the same with different internet connections system information os : windows version of next.js : 9.4.0 version of node.js : 12 lts additional context the data is fetched from a heroku server geo this one may not help ... works at : paris , france ( good connection speed ) latitude : 48.866667 longitude : 2.333333 does not work at : ile de re , france ( an isle with pretty bad internet ) latitude : 46.191111 longitude : -1.394463 < code > automatically optimizing pages .. error occurred prerendering page `` /forms/main/5ee6729eaab6a21787a25ef3 '' . read more : -error typeerror : db.collection is not a function
i have a page that is always generated at runtime with fallback : true : getstaticprops is then ran at runtime for this page . or else the build process would need to build thousands of static pages , and that 's basically the reason to use fallback : true . i know that getstaticprops ca n't have custom query params like ? page=2 at build time , because there 's no way of knowing that . but how to do it with fallback : true at runtime ? i need to paginate a page , and the data is fetched from the server in the current page , so we fetch only the needed records . is it possible ? < code > export const getstaticpaths : getstaticpaths = async ( ) = > { return { paths : [ ] , fallback : true } ; } ;
hello . i need some help defining a plan to deploy correctly in google cloud platform . the documentation for deployments encourages the use of vercel . but our client can not approve the use of multi-cloud platforms because of security reasons . we are forced to deploy on google cloud platform . is there any way to deploy all the nextjs functions as serverless ? and , what other nuances are important in the deployments ? our initial idea is this one : deploy functions in serverless have something to route to those functions , ( ? ) where do we deploy the statics ? inside the docker ? in a cdn ? i have seen this package that helps to deploy in aws ( but not for google ) : < url > next has documentation for target serverless but i have no idea what i have to do with it . < url > i am not a devops , if there is anybody who can guide me ( and probably other people who need this ) to solve this approach , that would be great . basically we need to be able to : set up a ci / cd system targeting serverless in different domains ( pro , dev .. ) thanks < code >
i have a component that is the default layout for all pages in my application . i want this component to read a particular directory and link existing files within the component . to be very clear , i am generating pages dynamically with the files available in the directory . now the problem is , this component of mine is not inside of /pages folder and using getstaticprops outside this directory is restricted . so , i ca n't actually do this what i wrote above . what should i do on this situation ? the problem only arise when i am creating links like above in the component , because it is outside the /pages dir . i have no issue generating dynamic pages for the files . please advise , thanks . < code > import { getsortedpagedata } from ' .. /lib/pages ' export async function getstaticprops ( ) { const allpagesdata = getsortedpagedata ( ) return { props : { allpagesdata } } } export default function layout ( { allpagesdata } ) { return ( < navbar color= '' faded '' light > < collapse isopen= { ! collapsed } navbar > < nav navbar > { allpagesdata.map ( ( { page , title } ) = > ( < navitem key= { page } > < link href= '' / [ page ] '' as= { page } > < a > < navlink > { title } < /navlink > < /a > < /link > < /navitem > ) ) } < /nav > < /collapse > < /navbar > ) }
in our project , we have used optional parameters in some cases like for profile page /u/ : username/ : tab ? , i could n't find any way to achieve this using next routes . only way i could find was to add folder in following structures and put same index.js in 2 folders , that contradicts the dry principle and makes redundant codes < code > u -- [ username ] -- -- index.js -- -- [ tab ] -- -- -- index.js
in our project , we have 2 urls / : username/ : profile/ : settings / : username/ : tab so before we were using fridays-routes , where it was handled by the routes.js file . as it serves on the first come . so if the 1st url is above the 2nd one , /foo/bar/sms is automatically handled by the first one and /foo/bar is automatically handled by the 2nd one . but in next routing i am getting this error any idea to resolve it ? < code > failed to reload dynamic routes : error : you can not use different slug names for the same dynamic path ( 'profile ' ! == 'tab ' ) .
hi , i have a component facebook comment like this it work fine it 's inside a tab , so when i click to the tab , it re-render , this look not good i tried to use usecallback like this const commentelement= usecallback ( ( ) = > < comment / > ) but error ... did i do something wrong ? < code > const comment = dynamic ( ( ) = > import ( `` .. / .. / .. /lib/facebook/comments-facebook '' ) , { ssr : false } )
hi ! i am working on an application that needs to rewrite a route to either an api function or a next.js page depending on the request accept header . as far as i see in # 9081 , this is not possible using just experimental.rewrites and instead , i needed to use a custom express server , which does not work on vercel . server.js is there a way to dynamically set the destination url with experimental rewrites , based in the request header , in order to avoid using a custom express server ? < code > const express = require ( 'express ' ) const next = require ( 'next ' ) const port = parseint ( process.env.port , 10 ) || 3000 const dev = process.env.node_env ! == 'production ' const app = next ( { dev } ) const handle = app.getrequesthandler ( ) app.prepare ( ) .then ( ( ) = > { const server = express ( ) server.get ( '/x/ * ' , ( req , res , next ) = > { if ( ! req.headers.accept.includes ( 'html ' ) ) { req.url = '/api/x/ < cur > { req.params [ 0 ] } ' server.handle ( req , res , next ) return } next ( ) } ) server.all ( ' * ' , ( req , res ) = > { return handle ( req , res ) } ) server.listen ( port , ( err ) = > { if ( err ) throw err console.log ( ' > ready on < url > : < cur > { port } ' ) } ) } )
hi , i have been looking for the solution for hours , but could n't find any . i am not trying to include another module , but just files . they are js ( react/jsx ) and css files . i have a repository that looks like this : /common ( with files used by app , and nextjs ) /app ( a js app ) /nextjs ( the nextjs project ) if i try to use the files in /common from /nextjs , i get this kind of errors : you may need an appropriate loader to handle this file type [ ... ] . but of course , that was expected . i would like to avoid creating a npm module for common ( i would need to use link , and suddenly i know new issues would pop up ) . i really would like to keep things as simple as possible . thanks a lot for your ideas and help . < code >
i have been playing around with react , picked it for my next project . however i saw this community section so i want to take this opportunity to ask about best practices . i am creating a react website with landing pages that needs to be multilanguage markdown react component some requirements : all the content data has to be in the same place , it can be in individual language or in the markdown files i have a rough idea what i need to do but i thought i 'd ask about it here to see what other ideas we all have in mind and how i could implement it better . < code >
created a nextjs-blog as per the docs . can download the code from here i am trying to run now dev and keep getting the following error : not found : next os : windows 10 now cli version : 19.0.1 list of project dependencies : cookie @ 0.4.1 < email > .0 gray-matter @ 4.0.2 next @ 9.4.0 < email > .1 < email > .1 remark @ 12.0.0 remark-html @ 11.0.2 < code >
bug report all styles must be included in _app.js and therefore be global . i include my .scss files , but they must be global . it seems that this tutorial is what i 'm looking for , but you have to add a variable as a class to make it work , and as indicated in the post , it 's no longer compatible with the new versions of next.js < url > i also tried @ webdeb/next-styles but the styles are not unique to the component . they are applied by all html elements , even when the component is not displayed . expected behavior i would like to be able to use .scss files to be included in every component and page , so that i can use the style only when the component is rendered in the page . system information os : macos browser : firefox version of next.js : latest , 9.4.1 version of node.js : v12.16.1 i need help , thanks < code >
hi all , i followed the document and fetched the post data to index . when i tried to style it , it happened that the classname i applied to the list does not hook with all the lists i have . notice that classname= { indexstyles.singleproject } only got applied to the first list ( first md ) in the dev tool but not the second one ( second md i have ) here is the code : here is the screenshot from the dev tool : it happened from time to time . sometimes if i click to other page and go back to the main page , it got applied to the same style for every list . but if i do a refresh of the page , it was not applied again : ( thank you ! < code > < ul classname= { ' < cur > { utilstyles.list } < cur > { indexstyles.projects } ' } > { allpostsdata.map ( ( { id , title , description , thumbnail , skill } ) = > ( < li classname= { indexstyles.singleproject } key= { id } > < link href= '' /projects/ [ id ] '' as= { '/projects/ < cur > { id } ' } > < img src= { thumbnail } alt= { title } classname= { indexstyles.image } / > < /link > < link href= '' /projects/ [ id ] '' as= { '/projects/ < cur > { id } ' } > < a classname= { utilstyles.headinglightxl } > { title } < /a > < /link > < li > { skill } < /li > < li > { description } < /li > < /li > ) ) } < /ul >
nextjs creates api endpoints from pages/api/ directory . is it possible to find how many available api 's are there and using a loop to send request to all of them ? < code >
i reported this issue yesterday but i want to take a look at it to see if i can submit a pr . i 've been looking into build/index.ts and link.ts ( next/link ) files , but i 'm unable to find the code that fetches these routes . with optional catch-all the routes are being fetch as so : < url > ] .json any guidance about which files should i look at , would be appreciated . < code >
hi i am using import { userouter } from `` next/router '' ; currently what i am getting is . < url > what i need < url > i do not want parameters name on url . routing link < link href= { /app/filel ? id= < cur > { id } & subject= < cur > { `` 1234 '' } } > server file : server.get ( '/app/file/ : id/ : subject ' , ( req , res ) = > { return app.render ( req , res , '/app/file ' , { id : req.params.id , subject : req.params.subject } ) ; } ) ; # # # system information os : linux browser : chrome `` next '' : `` ^9.3.4 '' , `` react '' : `` ^16.13.1 '' , < code >
hi guys , i am working on a fairly big project and while i was going through the build chunks to see if i can prune any of the unnecessary stuff , i observed a pretty big part of chunks containing the react and react dom code on both _app.js and particular-page.js . is this a known issue or is there a way to solve this ? it would be great if i can save around 40 kb for my users . unfortunately i am working on a proprietary codebase and hence ca n't share the code . but i can try to stitch up a new app to demonstrate the behaviour . any help is much appreciated . thank you . < code >
all pages are static export ssr page layout has a < script > with client-side js . it executes fine on new html requests , but does n't run when ssr pages where client-side transitions happen . short of doing is there a way to reinitialise the script ? < code > export const config = { unstable_runtimejs : false }
hi guys , i still struggle to answer 2 questions in next 9.4 , regarding config : what 's the preferred pattern to set a public setting , compute dynamically in javascript ? example use case : i want to make package.json version available to the client . intuitively i 've written this : note that i ca n't get this info from environment , hence the idea of using public config . which raises even more questions : publicruntimeconfig is not available in serverless environment . why ? i do n't see the point/technical reason for this . i could set the nextconfig.env value instead . but it 's now unclear how to handle public variables this way . should i name do nextconfig.env.next_public_version = packagejson.version for instance ? is it safe ? i 've raised similar question in the .env support rfc but it was n't the most appropriate place , so i am opening a separate discussion . edit : second use case for the server is passing cors whitelist . you may want to preprocess the environment variable , by splitting the array , before including it in the config . it 's not doable at this point . < code > const withpkginfo = ( nextconfig ) = > { nextconfig.publicruntimeconfig.pkginfo = { version : packagejson.version } }
hi ! i am using the following pattern for some pages : use getserversideprops to get ( authenticated ) resources from my server . use swr on that page on the same resources to keep the data updated and do optimistic updates when the user saves or updates the data . swr calls an api endpoint which takes ( req : nextapirequest , res : nextapiresponse ) as arguments . meanwhile , getserversideprops uses a context which contains `` vanilla '' req , res arguments ( with types httpincomingmessage and httpresponse ) . this prevents code reuse between my api handler and getserversideprops , especially concerning authentication since i am using the nextjs-auth0 library which expects nextapirequest and nextapiresponse arguments . my questions are the following : is this pattern a good practice ? or should i do that differently ? is there a structural reason for the req , res arguments to have different types , or could the getserversideprops context be augmented to have a similar req , res signature ? thanks ! < code >
hello , i have using the next js with-loading example but it seems only loading the pages for a while . it 's not a preload js or css file etc . how can we achieve this ? < code >
how are folks doing dynamic routing with custom server , we are currently using friday/next-routes with usefilesystempublicroutes : false , in next.config.js , but this library is not maintained for past 2 years and want to see what are the alternative options for custom server ? < code >
i want to change query params on the same route programmatically with route.push , and i 'm confused that of the following five examples , only the first and last seem to be allowed : < code > import { userouter } from `` next/router '' ; export default function home ( ) { const router = userouter ( ) ; return ( < div > < button // this works onclick= { ( ) = > { router.push ( { pathname : router.pathname , query : { filter : `` one '' } } ) ; } } > works < /button > < button // this does not work onclick= { ( ) = > { router.push ( { query : { filter : `` two '' } } ) ; } } > error < /button > < button // this does not work onclick= { ( ) = > { router.push ( `` ? filter=three '' ) ; } } > error < /button > < button // this does not work onclick= { ( ) = > { router.push ( ' < cur > { router.pathname } / ? filter=four ' ) ; } } > error < /button > < button // this works onclick= { ( ) = > { router.push ( ' < cur > { router.pathname } ? filter=five ' ) ; } } > works < /button > < /div > ) ; }
a few things i ca n't seem to find the documentation on the render ( ) method anywhere . it 's used in the custom server info but it does n't actually say what the arguments are or how to use it . the docs say to set usefilesystempublicroutes to false if you do n't want to use /pages , but then how do you point the render method to the right folder/file ? how do you actually route to places ? i could n't find documentation on either . my whole goal is to not use the /pages folder and to be able to write custom routes . < code >
hello , i have a url like /item/ [ id ] i have a button , which allows to add a new item , which triggers a modal asking for a name . when i insert the new item into db via sync call , i redirect to the new url item/ [ newid ] . i use router.push ( '/item/newid ' ) . unfortunately , this always attracts a full-page reload . is there any way to dot this `` spa-way '' so that i would only redraw interface with new data ? it seriously breaks the experience . thanks < code >
say i have the route setup /blog/ [ year ] / [ id ] . i load the blog posts in getstaticprops . however there may be times when [ year ] or [ id ] does n't yield any results , so in case of [ id ] not existing i want to redirect to /blog/ [ year ] /1 , and in case of [ year ] not existing i want to redirect to /blog/2020/1 ( both of which i know definitely exists ) . how do i do this in getstaticprops ? < code >
i added a getinitialprops in the _document component in order to add redirects on the server side like this : locally , this redirects when i go to a route in the redirects , however in the built application i get a 404. does anyone know why the built app would behave differently than when in local development ? i do n't understand why this would be different and why the lifecycle seems different ? < code > static async getinitialprops ( ctx : nextpagecontext ) { ... const url = ctx.req ? .url if ( ctx & & ctx.res & & url & & redirects [ url ] ) { ctx.res.writehead ( 302 , { location : redirects [ url ] } ) ctx.res.end ( ) } ... }
i can not render /post/ [ y ] / [ mo ] / [ slug ] of my repo . < code > server error typeerror : can not read property '_documentprops ' of null this error happened while generating the page . any console logs will be displayed in the terminal window . call stack head.render .. / .. /pages/_document.tsx ( 280:4 ) processchild file : ///users/patarapolw/projects/jpdiary/node_modules/react-dom/cjs/react-dom-server.node.development.js ( 3134:18 ) resolve file : ///users/patarapolw/projects/jpdiary/node_modules/react-dom/cjs/react-dom-server.node.development.js ( 2960:5 ) reactdomserverrenderer.render file : ///users/patarapolw/projects/jpdiary/node_modules/react-dom/cjs/react-dom-server.node.development.js ( 3435:22 ) reactdomserverrenderer.read file : ///users/patarapolw/projects/jpdiary/node_modules/react-dom/cjs/react-dom-server.node.development.js ( 3373:29 ) rendertostring file : ///users/patarapolw/projects/jpdiary/node_modules/react-dom/cjs/react-dom-server.node.development.js ( 3988:27 ) render file : ///users/patarapolw/projects/jpdiary/node_modules/next/dist/next-server/server/render.js ( 3:298 ) object.renderpage file : ///users/patarapolw/projects/jpdiary/node_modules/next/dist/next-server/server/render.js ( 46:1020 ) function.getinitialprops .. / .. /pages/_document.tsx ( 92:33 ) loadgetinitialprops file : ///users/patarapolw/projects/jpdiary/node_modules/next/dist/next-server/lib/utils.js ( 5:101 ) rendertohtml file : ///users/patarapolw/projects/jpdiary/node_modules/next/dist/next-server/server/render.js ( 46:1330 ) runmicrotasks < anonymous > processticksandrejections internal/process/task_queues.js ( 97:5 ) async file : ///users/patarapolw/projects/jpdiary/node_modules/next/dist/next-server/server/next-server.js ( 68:285 ) async __wrapper file : ///users/patarapolw/projects/jpdiary/node_modules/next/dist/lib/coalesced-function.js ( 1:330 ) async devserver.rendertohtmlwithcomponents file : ///users/patarapolw/projects/jpdiary/node_modules/next/dist/next-server/server/next-server.js ( 91:254 )
i 'm creating a website that has a number ( 20 ) of full screen modals accessible from all pages . functionally they work well and make the website and give a sort of native feel on mobile . however , in total they add about 100kb of page weight , is there a best practice to load these on the fly ? currently they are components that just sit in the main app component and appear when a state change occurs . is there any guidance for this ? < code >
i am having an issue where lighthouse is reporting a performance score of 0 and a 22 second page load time . however when i load the website in my browse it has a 1-2 second load time . see the lighthouse score below : why am i seeing such a large discrepancy ? the website in question is hosted here : < url > < code >
hello ! i work at a project where the desktop and mobile content of the pages needs to be different . that in itself is easily solvable , just import both versions and conditional render them , basic react stuff . the problem is that i want the chunks to be different and the desktop version to not include/load the mobile components/files and vice versa . i tried to use dynamic imports but that does n't seem to help , different chunks are created but both the desktop and mobile files are being loaded no matter what is actually being rendered . any ideas on how i could do that ? i am thinking at using a custom server/router but i would really like to not need to do that . another solution would be to have 2 separate builds and one of them to have a different next/config with aliases but once again i do n't really want to run 2 separate applications if i do n't really need it . another solution that i am thinking would be to somehow modify next 's app or router ( i looked n the source code but i 'm still not sure who is responsible for determining what files should be loaded on page change ) and apply the condition there . ps : the condition to render the desktop or mobile page is a header sent by a reverse proxy . pps : ssr needs to work , i was able to get the result that i wanted by using dynamic imports but i was n't using it in the root but in a component method so no ssr was possible on one of the versions ( mobile ) . thanks ! < code >
example : < code > page.getinitialprops = async ( ctx ) = > { const { data } = await rest ( 'page ' , 'slug ' ) .get < pagerespdto > ( // this is a axios instance ctx.query.page as string , ) // in production // if this request got 404 , nextjs render nextjs error page , // . but the status code is 500 , not 404 from axios request . return { data } as pagerespdto }
how can i export multiple statements like this , but with some configuration between them ? for example , i wan na use all these hof and export them , but also i wan na add an object option in withpwa ( ) , how should i do that ? compose those plugins ! ! ! ! without 3rd party libraries thanks in advance ! < code > const nextconfig = withpwa ( { pwa : { dest : `` public '' } } , withcss ( withsass ( { webpack ( config , options ) { config.module.rules.push ( { test : /\ . ( png|jpg|gif|svg|eot|ttf|woff|woff2 ) < cur > / , use : { loader : `` url-loader '' , options : { limit : 100000 } } } , { test : /\ . ( ogg|mp3|wav|mpe ? g ) < cur > /i , loader : `` file-loader '' , options : { name : `` [ path ] [ name ] . [ ext ] '' } } ) ; return config ; } } ) ) ) ; module.exports = nextconfig ;
hi guys . i have three different environments in my project : local development , staging ( for qa 's ) , and production . with next dev and next start everything is ok , but i have a problem because i need to run the next build with staging environments . i create three files : .env.local , .env.staging , and .env.production , but when i run the next build , the production always is called . i created two tasks on scripts node on package.json : i created and environment.config.js : and created the api service to get data : but the task yarn build : hmg always generates the production build . what i was do wrong ? regards < code > `` build : hmg '' : `` node_env=staging env=staging next build & & next export '' , `` build : prod '' : `` node_env=production next build & & next export '' , import fetch from 'isomorphic-unfetch ' ; import { environment } from ' .. / .. /environment.config ' ; export const fetchdata = async ( ) = > { const res = await fetch ( ' < cur > { environment.api_url } / ' ) .then ( ( items ) = > items.json ( ) ) ; const plans = res.data ; return { plans } ; } ; const env = process.env.node_env || 'staging ' ; export const environment = { staging : { api_url : 'url staging ' , } , production : { api_url : 'url production ' , } , } [ env ] ;
i 'm trying to change code with getinitialprops to use getserversideprops . i have something like : this works fine for both client and ssr . when i simply change the getinitialprops to getserversideprops everything breaks because objid is now undefined . how do i get this to work ? < code > const objpage = ( { objid } : props ) : jsx.element = > { const { loading , error , data } = usequery ( loadobj , { query : loadobj , variables : { objid } } ) ; if ( loading ) { return < > loading ... < / > ; } if ( ! data || error ) { return < errorpage statuscode= { 500 } / > ; } ... go on to render the page } ; objpage.getinitialprops = async ( context : context ) : promise < props > = > { const { query : { objid } } = context ; return { objid : objid as string } ; } ;
next.js fails the build when it finds typescript errors . how can i find those errors without running next build ? next build is slow and only reports one error at a time . vscode only reports errors in files that are currently open . < code >
hi ! i have written a next.js-app and deployed it with vercel . when accessing an api-endpoint ( /pages/api/auth/login.ts , specifically a login-route using this auth0 library ) i am getting the following error : this only happens when deployed , and started roughly four days ago , working fine before that . does anyone have experience with something like this ? any help is hugely appreciated ! 😄 < code > 020-06-15t18:28:26.202z undefined error uncaught exception { `` errortype '' : '' runtime.importmoduleerror '' , '' errormessage '' : '' error : can not find module 'next/dist/next-server/server/api-utils ' require stack : - /var/task/.next/serverless/pages/api/auth/me.js - /var/task/now__launcher.js - /var/runtime/userfunction.js - /var/runtime/index.js '' , '' stack '' : [ `` runtime.importmoduleerror : error : can not find module 'next/dist/next-server/server/api-utils ' '' , '' require stack : '' , '' - /var/task/.next/serverless/pages/api/auth/me.js '' , '' - /var/task/now__launcher.js '' , '' - /var/runtime/userfunction.js '' , '' - /var/runtime/index.js '' , '' at _loaduserapp ( /var/runtime/userfunction.js💯13 ) '' , '' at object.module.exports.load ( /var/runtime/userfunction.js:140:17 ) '' , '' at object. < anonymous > ( /var/runtime/index.js:43:30 ) '' , '' at module._compile ( internal/modules/cjs/loader.js:1133:30 ) '' , '' at object.module._extensions .. js ( internal/modules/cjs/loader.js:1153:10 ) '' , '' at module.load ( internal/modules/cjs/loader.js:977:32 ) '' , '' at function.module._load ( internal/modules/cjs/loader.js:877:14 ) '' , '' at function.executeuserentrypoint [ as runmain ] ( internal/modules/run_main.js:74:12 ) '' , '' at internal/main/run_main_module.js:18:47 '' ] } duration : 196.43 ms billed duration : 200 ms memory size : 1024 mb max memory used : 14 mb unknown application error occurred runtime.importmoduleerror
hey everybody , i am currently trying to implement a routing system that goes beyond the 'pages ' file system limitations . i would like to render two different components for /category/subcategory.html ( category collection page ) and /category/article123.html ( article content page ) . server-side : this is solved by using your rewrites hack to check if there is an article id at the end which sends this to the article page directory . so for mywebsite/anythinggoeshere < 1234 it will work with : client-side : i would like to : < link href= '' /articles/ [ myarticle ] '' as= '' / [ category ] / [ myarticle ] '' / > but this is not possible , while pointing to the article directory to render the article with /category/myarticle url . is there any possibility to achieve this . last resort is a custom server but i would like to avoid that . my current directory structure is : < code > -pages [ category.js ] -articles [ article ] .js async rewrites ( ) { return [ { source : '/ ( . * ) ( \d+ ) ' , destination : '/articles/ [ ... article ] ' } , .....
hi ! i 'm trying to add datasources to the apolloserver in the with-typescript-graphql example but started running into issues with them being uninitialized when the schemalink is created . somewhat similar to this discussion here : apollographql/apollo-link # 1009 any recommendations on best approaches here ? < code >
i have a custom server configured . in 9.2.2 when i start a project from vscode using `` node server.js '' and then change a ts/tsx file it goes compiled and type checked . in 9.4.4 type-checking is not executed although i see tslint errors in vscode . in 9.2.2 i see in the output bundled successfully , waiting for typecheck results ... in 9.4.4 i do not see the line do i need to adjust something in next/babel configuration ? < code >
i 've been taking a look at the files created by the next build command and i noticed that none of the files appear to be gzipped : is this expected behaviour ? i thought gzipping was enabled by default ? < code >
hi , i have a package.json file like this : when i install nextjs with yarn -- prod ( production deploy with smallest dependencies size ) , and i get this result : then , i check the node_modules dir , i find there has some no-use packages in production but still installed . i think i do n't need webpack in production ~~ , so does anyone knows how can i do ? < code > < cur > du -d 0 -h node_modules 101m node_modules { ... `` dependencies '' : { `` next '' : `` ^9.4.4 '' } } < cur > tree -- si -l 1 -h node_modules | grep webpack [ 288 ] fork-ts-checker-webpack-plugin [ 288 ] pnp-webpack-plugin [ 256 ] terser-webpack-plugin [ 448 ] webpack [ 192 ] webpack-sources
hi ! i am getting deployment has failed due to an internal error . ( code : undefined ) from vercel when i try to push my code to their environment ( works locally ) this is the code , the gallery is there , but did not take it with me for this discussion . 'import customers from ' .. / .. /dist/json/customers ' ; import { userouter } from 'next/router ' ; import { usestate , useeffect } from 'react ' ; import { portfolioitem } from ' .. / .. /components/portfolio ' ; import { animateup } from ' .. / .. /components/animations ' ; const portfoliopost = ( ) = > { const router = userouter ( ) ; const { slug } = router.query ; } ; ' < code > const customerarr = customers ; const currentcustomer = customerarr.find ( ( element ) = > element.slug === slug ) ; const [ portfolioitem , setportfolioitem ] = usestate ( null ) ; useeffect ( ( ) = > { setportfolioitem ( currentcustomer ) ; } , [ currentcustomer ] ) ; return ( < > { portfolioitem & & ( < > < portfolioitem ispurple portofolioobject= { portfolioitem } / > < gallery title= { portfolioitem.subtitle } text= { portfolioitem.descriptionshort } feedback= { portfolioitem.feedback } feedbackauthor= { portfolioitem.feedbackauthor } feedbackimg= { portfolioitem.feedbackimg } gallery= { portfolioitem.imgarray } / > < / > ) } < / > ) ;
hi , when i use npm run dev i do n't have issues when i try to login . when i use npm run build and then npm run start , i have a 401. i want to troubleshoot this problem but how can i do so without having to edit the code and rebuild again . fyi , i am able to debug in dev mode using vs code . thanks , < code >
i was wondering if there are any differences between getstaticprops and getserverprops when i do n't want to site to be found without the user having the link . for example if you have a polling app and every poll has its own unique url and is static , does that make the poll easier to find compared to server rendering the unique url ? < code >
hey all hoping someone can point me into the right direction for this issue . i am using next to build a web application . since i am using some custom css , i created an _app.js file over the regular index.js file . as a result the link routing does not seem to be working . i tested the same routes when using index.js as my home page and the routes worked . is there a way to work around this without switching back to index.js ? my file structure is the way its suppose to be . all pages in /pages dir . thanks for any help ! ! ! < code >
hello everyone ! i wanted to ask if there 's a way to serve different versions of a static file based on the environment . so i have a static json file on my /public/ directory . now we need a different version of this json file when it 's on production and another version when it 's on staging . is there way to make this possible ? any help would be appreciated . thanks ! < code >
trying to figure out why i 'm not able to retrieve the params in getstaticprops . while i was doing some testing , i was able to get the params in getstaticprops when i go through the page using next/link or userouter 's push . but when it gets reloaded through my custom server that 's when i ca n't retrieve the params . any ideas on what might 've affected it ? here 's the custom server code for the particular route < code > server.get ( '/destinations/ : destination ' , ( req , res ) = > { return nextapp.render ( req , res , '/destinations/ [ destination ] ' , req.params ) ; } ) ;
let 's say i have a project with multiple clients , client1.nextjs.com , client2.nextjs.com , ... etc is their portfolio website & they 'll have the same layout overall , if you open the client1 portfolio for example i 'll have to make fetch request to get the text/images/colors for this client including the meta tags for this portfolio , now the question is if the client share their portfolio to the social media , web scrapers like facebook , twitter , etc .. will not get the meta tags from api since they do n't load javascript . if i have like +10k clients , how to solve this ? is it really ideal to make +10k fetch requests on the build time ? what if each client have a sub page like /projects , let 's say on average 10 projects for each client , that 's another +10k fetch requests , also in back-end we have a dashboard so each client can change their data all the time , so i have to re-build each time client change anything . is react / next ideal for this kind of project ? < code >
i have a requirement in which i need to fetch some config values from a remote server when the application starts . this will contain the config values required for the app . is it possible to do this and what is the best approach for this . < code >
i want to use github actions to try and run a smoke test against prod , triggered by a successful deployment to production . i know that github actions has a on : deployment and on : deployment_status trigger , but it only seems to run at the beginning of a deploy . i want a trigger that occurs on deployment success . does anyone know how to do this ? are there any examples of how to do this ? ( incidentally , in investigating , i noticed that nextjs does n't utilize the notion of smoke tests in their cicd github action : p ) < code >
which should i choose for a forum like page where the author first posts something and there will be posts below that by anonymous and posts are ranked by likes , the most liked post comes at the top . i doubt if i go with static the functions will be limited and each post might require page reload .. i do n't want to compromise performance . thanks in advance < code >
i use a combination of getstaticpaths with fallback : true and getstaticprops , with some additional client-side fetching ( reason being , part of the page data is public , but i have to fetch some of it client-side , only if the user is logged in ) . the client-side fetch can take a few 100ms to load , and this time , the client is stuck on the previous page without any indication of that the page is loading/working on something . usually it happens going from pages/ [ ... slug ] .jsx to pages/ [ ... slug ] .jsx ( so the same page , but different url/props ) , i mention it , although it might be irrelevant . is there any way of telling next.js `` go ahead , render the next page with the fallback ( or the data from getstaticpaths ) '' if the transition takes eg . more than 100ms ? # 11088 might be similar , but it does not look to be answered either . < code >
i really really love the path aliasing in jsconfig.json . makes my project so much cleaner . buuuuuut where i used to be able to click on the part after the from holding cmd and it would take me to the corresponding file . that does not work any longer . any idea how to fix this ? this is my jsconfig.json < code > { `` compileroptions '' : { `` baseurl '' : `` . `` , `` paths '' : { `` @ /componentstyles '' : [ `` components/styles '' ] , `` @ /conceptutils '' : [ `` components/concepts/utils '' ] , .... } } }
feature request is your feature request related to a problem ? please describe . consider the code after an api call to retrieve a list of paths to pre-render , getstaticpaths ( ) only passes back information about the paths ( here , given by id ) and no other information ( e.g. , name ) is sent in the params object . i can pass the { params } object to another async , e.g. , getstaticprops ( ) , but only id is returned . describe the solution you 'd like to avoid repeated api calls , i would also like to pass information other than the paths in the params object to other functions . describe alternatives you 've considered repeated api calls obviously work in the functions where i want to use this information , but i would like to reduce overheads as much as possible ( particularly as it would require another database query ) . additional context see discussion # 14150 , # 11272 for other discussions . ca n't find similar issues . < code > export async function getstaticpaths ( ) { // call an external api endpoint to get all journals const res = await fetch ( ' < url > ) let alljournals = await res.json ( ) // extract their name , slugs and their path ( i.e. , including the /j/ ) let paths = alljournals.map ( ( journal ) = > ( { params : { name : journal.name , id : journal.slug } } ) ) return { paths , fallback : false } // only `` id '' is returned here . }
hey , i make an api call during the getstaticpaths ( ) async to get a list of paths to return ( here , journals.slug ) . during this api call , i would also like to pass other information such as { journals.name } to avoid repeated api calls . is this possible ? getstaticpaths ( ) only allows two values to be returned ( else an error is thrown ( ) [ error ] ) . here 's my code . i need a mechanism to also pass the names array . any thoughts ? do i simply perform another api call in getstaticprops ( ) , i.e. , have 2 separate calls to the same endpoint ? best wishes , and stay safe , jack < code > export async function getstaticpaths ( ) { // call an external api endpoint to get all journals const res = await fetch ( ' < url > ) let alljournals = await res.json ( ) // extract their name , slugs and their path ( i.e. , including the /j/ ) let paths = alljournals.map ( ( journal ) = > ( { params : { name : journal.name , id : journal.slug } } ) ) return { paths , fallback : false } // only `` id '' is returned here . }
what is the best approach for a child component to fetch data from an api and then use that data when rendering the component ? in this instance i would ideally not have to write the query for the component in each page component and instead simply import the component as-and-when i need it . on a page i can use getstaticprops and pass the data as a prop to the component but i understand that this is only possible with page components . i apologise in advanced if this is a silly question , and appreciate any help . < code >
hi y'all hope everyone is doing well ! i have two questions here , the first is that does anyone know how to change the settings of vscode so it wo n't give me an error when i use < > ? the website works just fine but i hate seeing the error popping up everytime i saved it : ( the second question is that i want to have different background color for each page . right now i set my background color in the layout module css as well as making the container width and height 100vw/vh , but it will be set for all the pages . if i set it in a module for a specific page , the color only applies to the content . thank you in advance ! < code >
hi , i 'm new to nextjs and am enjoying it so far but am finding it challenging to wrap my head around how to structure an app that has some static pages , regular ssr pages with graphql and uses graphql with firebase/jwt auth for some of the dynamic pages ( clients side rendering ) . in particular , firebase needs to be initialized when someone logs in and i need to maintain that initialized app and jwt token across pages so that pages can render in anonymous or logged in mode . ideally pages would be ssr for anonymous users and client side / dynamic for logged in users so they could edit and view changes right away . in regular cra apps i could use a context to track the auth state ... but with nextjs i seem to lose the context and user auth info when i do n't expect to . i 'm guessing because some pages end up being ssr ... but being new i do n't have a good enough mental model to figure out how to address this and/or if i 'll be able to do what i want/need with nextjs . i 've looked at many of the examples and they are useful in isolation but do n't really seem to address this particular problem/configuration and often do n't explain their approaches well enough for me to grok . does anyone know of a good tutorial , article or documentation link that i could review for insight ? also , is there a discord , slack , gitter , etc . for nextjs ? this discussion feature is all i 've found but it leaves a lot to be desired like search . thanks in advance . julio < code >
hi my web hosting for start node server just accepts a app.js file path to run my app . i wondering how can i start my app with like node next.js instead of npm start ? is there any file i can start that file with node ? < code >
attempting to build a fully static app with some non-react vanilla js on top to manipulate the dom for a better a ux . how do i best include the necessary js that should run on load time ? i 'm assuming i put a < script src= '' my-script.js '' > < /script > in the next/head component ? can that script live anywhere ? or does it need to be in the /public folder ? will it be magically optimized / minified etc by next during ssg ? so many questions ... but i think that 's a start . thanks ! < code >
hi , i am running a next.js app on azure app services , with azure cdn in front of it . doing this after a discussion i had with @ timer using < url > as an auth solution . it has some pages using getstaticpaths with fallback : true and getstaticprops , but have also some data that is clientside fetched because it needs authentication . after logging in , my user information somehow got cached , and even if someone else logs in , they get my credentials. ! ? it looks like my credentials were saved in the cdn somehow . i would like to provide more info if necessary , also i was unsure where i should report this . someone has a good idea/experienced something similar ? < code >
when using a custom provider ( ther than vercel ) , and deploying a new version of the next.js app , what are the required steps to correctly update the cdn ? should i just purge everything , since the buildid is different on each builds ? or using < url > would be ideal here ? or it may cause problems when part of the cdn expires and a request goes to origin , but that has already changes for example ? in case i have to purge everything , i am wondering if that would mean that by using getstaticprops , all the previously cached props will not survive either ? is it maybe intentional ? < code >
bug report describe the bug i 'm unable to use navigator , i 'm getting : to reproduce simple try to use native html5 navigator api . expected behavior be able to access navigator system information os : macos browser ( if applies ) : chrome version of next.js : 9.2.2 < code > referenceerror : navigator is not defined
bug report i 'm using nextjs for multi tenant ecommerce platform . so the requirements are : when end-user visit the application first time ( visit page directly ) < url > , i have to load/fetch some meta-data ( theme settings ) inside getserversideprops . however , when user navigate on client ( client-side ) , i want to somehow recognize that it 's a client navigation . so , dont load/fetch this meta-data again . i opened a discussion thread and it looks like it 's a common/known issue . @ srikanth012 @ sadraromexs to reproduce create next.js prject add 2 pages ( i.e index.js and /products/ [ id ] ) both are implement getserversideprops navigate from index to product/aaa expected behavior expect to get some property on context to understand when it 's a client-side navigation . < code >
i have a simple nextjs app where i need to write tests to validate that blog/ : slug will work on both client-side and on the server side i am using jest for testing < code >
i was checking how next.js works and noticed these lines next.js/packages/next/pages/_document.tsx lines 165 to 191 in d874329 cssfiles.foreach ( ( file ) = > { csslinkelements.push ( < link key= { ' < cur > { file } -preload ' } nonce= { this.props.nonce } rel= '' preload '' href= { ' < cur > { assetprefix } /_next/ < cur > { encodeuri ( file ) } < cur > { _devonlyinvalidatecachequerystring } ' } as= '' style '' crossorigin= { this.props.crossorigin || process.env.__next_cross_origin } / > , < link key= { file } nonce= { this.props.nonce } rel= '' stylesheet '' href= { ' < cur > { assetprefix } /_next/ < cur > { encodeuri ( file ) } < cur > { _devonlyinvalidatecachequerystring } ' } crossorigin= { this.props.crossorigin || process.env.__next_cross_origin } / > ) } ) which results in something like what is the reason to mention the same css in preload ( meaning - start to fetch now ) and ordinary as a rel= '' stylesheet '' ? is n't the result is the same as it would be mentioned without preload ? < code > < link rel= '' preload '' href= '' /_next/static/css/5ae3fd0edafaa4b06403.css '' as= '' style '' / > < link rel= '' stylesheet '' href= '' /_next/static/css/5ae3fd0edafaa4b06403.css '' / >
i 've got a fallback page that reads the file system for markdown in getstaticprops . the fallback page works in dev , but in production , it shows the loading state while router.isfallback is true and then the server errors out . here 's a typical error . am i using this feature wrong ? < code > [ get ] /_next/data/zrnshz4ischkcz7aev5cr/tags/mac-os.json 22:45:31:14 2020-05-17t13:45:31.218z 3f2bd3f5-e11d-4373-81b3-bf8779acb3c9 error error : enoent : no such file or directory , scandir '/var/task/_posts ' at object.readdirsync ( fs.js:872:3 ) at getpostslugs ( /var/task/.next/serverless/pages/tags/ [ slug ] .js:3590:52 ) at getallposts ( /var/task/.next/serverless/pages/tags/ [ slug ] .js:3632:17 ) at getstaticprops ( /var/task/.next/serverless/pages/tags/ [ slug ] .js:129:85 ) at rendertohtml ( /var/task/node_modules/next/dist/next-server/server/render.js:277:30 ) at processticksandrejections ( internal/process/task_queues.js:97:5 ) at async renderreqtohtml ( /var/task/.next/serverless/pages/tags/ [ slug ] .js:2919:22 ) at async server.render ( /var/task/.next/serverless/pages/tags/ [ slug ] .js:2966:22 ) { errno : -2 , syscall : 'scandir ' , path : '/var/task/_posts ' }
is it possible to pass through a different config object varied on the route when using a custom server ? use case would be we 'd want the amp optimizer differently for certain routes . < code >
the whole next.js app itself is hardly with api-routes , utils , and db migration files 40mb which a decent size but then node_modules adds up 300mb to it . while this is normal considering the number of dependencies each dependency has . knowing that the next compiler is similar to ncc , i assumed that the dependencies would be packaged with the build and i could just have other static files like the migration queries exist separately if needed . i tried running just the .next folder without anything else but it need the dependencies installed so it still is worth 300mb . i might have missed something so if someone else figured it out , let me know < code >
i am upgrading from getinitialprops - > getserversideprops and saw the api request is made from node server and passes the data the .json api to the client ( client-side routing ) do n't it increases the overhead rather than making the api from the browser and getting response directly from the api now it has to call from node server and getting the response and passing to the client through .json api . can someone please clarify my understanding regarding new update . < code >
hi ! we can define build target in next.config.js : < url > but is there a way we can read this value programmatically ? thanks ! < code >
👋 i 'm starting a new project and i would like to always have a top nav and only in a specific route have a sidebar where i can click and the content will change . the top nav should always be visible if i am in site.com or site.com/ * / * * if i go to site.com/posts i want to see a sidebar with all the posts title if i click a post on the left it will redirect to site.com/posts/1 and only the right side should change i 'm having trouble with the second and third bullet . my pages path is pages/posts/index.js and pages/posts/ [ id ] .js but how can i declare only one file and avoid duplicating code ? 🤔 i tried pages/posts/ [ [ ... slug ] ] .js but i 'm seeing this error : error : optional catch-all routes are currently experimental and can not be used by default ( `` /posts/ [ [ ... slug ] ] '' ) i 'm looking for examples but so far i could n't do it . any ideas ? < code >
react-helmet has 'bodyattributes ' and 'htmlattributes ' that are very useful for getting the right attributes in place per route in ssr . is there a way to tap into this with the next/head ? < code >
hello guys i want to know in applications like react we use html output file to run frontend but here after we build out application with npm run build what exactly we should do ? < code >
according to the official examples , it is best practice to add your custom polyfills to webpack 's main.js entry point instead of polyfills.js ... is there any specific reason for doing so ? this is the example i 'm referring to . as a side note , i find it very cumbersome ( especially for newbies ) to modify the webpack config in order to add polyfills . perhaps next.js could offer a simpler way to do this ? something like an optional file next-polyfills.js at the root of the project just like it does with next-env.d.ts for typescript typings . < code >
hey there ! according to best practices of performance on the web you will need some inline javascript and / or inline css at the top of your page to achieve a critical rendering path . i was looking for mechanisms or best practices to inline js / css ( at the top of your page ) in next.js to conform that pattern , but i could not find any . so i am not sure if there has already been done some work on this or if there are paradigms or common practices for the critical rendering path , esp . inline ( critical ) js / css so i 'd like to start this discussion here . < code >
feature request i 've custom higher level amp safe components that behave differently on amp / react version of app . the problems is that for testing those components i 've to import ampstatecontext from next/dist/next-server/lib/amp-context . describe the solution you 'd like i like to import it from next/amp or next/amp-context . though it should be documented that 's for testing purpose . describe alternatives you 've considered importing ampstatecontext from next/dist/next-server/lib/amp-context . mocking can be an option too . < code >
hey there , i have truly fallen in love with vercel and next.js and we have been building some simple apps with it over the past few months . i stumbled on to a question that i can not find a solution to so far . we started with a regular index.js page , and have another like this list/ [ id ] .js now we want the index page to default to something like list/foo with foo being the id that loads by default . so far in index.js we redirect to the page but i feel that 's not the best solution and i wonder where there is a setting we can use that sets domain.com/ to list/foo is there something like that ? i found something in the vercel documentation but that did not work and i found a stark overflow that said it was outdated . do i use routes with for this ? how do i set them now with the latest next.js version with vercel if that 's the right solution ? cheers , benjamin < code >
i figured that the environment variables are needed at build time , for next_public_ vars at least , even if we are n't using ssg . when building with docker-compose from a dockerfile , we can set up the environment variables for the system , using the environment keyword , which forwards those variables as system wide variables . however , they are not available when the dockerfile is running ( and building the app ) but rather , only when docker runs the app , thus , making my next_public_ equals to undefined . we can not necessarily read from a .env file in our deployed services , only for local development . we want the hosting service to handle our vars system wide . what is the usual best practice in this case ? read from the system variables without an .env file ? this is my setup : docker-compose.yml dockerfile in this case here . `` arbitrary_value '' is not available in the browser , reading with process.env.next_public_api_uri < code > version : ' 3.7 ' services : fe : build : ./ ports : - '3000:80 ' environment : next_public_api_uri : arbitrary_value from node:12.18.0-alpine workdir /app/ copy . . run npm i run npm run build expose 3000 expose 80 cmd [ `` npm '' , `` run '' , `` serve '' ]
i 'm building my first nextjs app with strapi on the back-end . it is fully server-rendered ( at least for now ) . the app is a spa that will have some modal windows showing different projects . each modal will have a bunch of pics ( gallery slideshow ) and some text . my question is what is the proper approach to do it ? i think prerendering all the images for all the modals is definitely a bad idea can/should i fetch images on modal open ? any library suggestions for this case ? maybe there is some lazy loading option available in nextjs already that i should use ? what i want to achieve is : when a modal is opened it instantly shows the first image ( it was already fetched and ready to use ) and starts fetching all the rest of the project 's images < code >
after upgrading , we started seeing some kind of error popups in dev mode . is this a next.js feature ? if so , how can we disable this ? this makes no sense to me < code >
bug report describe the bug when i put in my browser an url like mynextjswebsite.com/page the application displays the homepage and not the page screen ( only in production mode ) . but it 's working if we click on a link button with this route ( /page ) . for information , i use the static generation build of nextjs on a personnal server . to reproduce steps to reproduce the behavior , please provide code snippets or a repository : go to 'example.com/page ' directly in the url see the application is set on the homepage not the page . expected behavior i want to go the page specified in the url and not on the homepage . thanks per advance , < code >
i used the getstaticprops for pre-rendering my product pages and it works really well , i like it ! but i 'm currently thinking of a way how i can use it ( or if i should use it ) for my navbar and footer . the links that are going to be placed in the navbar and footer are dynamic and manageable via a headless cms . i know i can only use getstaticprops on pages/index files . so should i fetch the data for a navbar on every page 's getstaticprops or is there a better way ? like a wrapper for example ? i hope someone can help me with this , < code >
hi community , i ca n't get redirection work ( router.push ( ) ) in dev mode when the page contains antd components , but can work in production mode . can someone help me ? i have created a small example below : < url > < code >
is this possible to use next as template html generator ? i know can generate full static site but generated code is useless for me cause is minified . my current system uses standard html js grunt + mock data to create templates which are retrieved from repo by backed team . pages are managed later and deliver on production site by backend team . i would like to use modern tools to create such static templates . i tried to turn off webpack optimization in next.config.js file but it does n't work . < code >
* * i am trying to update nextjs version in my project .. but i am getting this error can anyone help me * * ( node:12420 ) unhandledpromiserejectionwarning : typeerror : can not read property 'unshift ' of undefined at cfg.entry ( ext.config.js:51:31 ) at async dynamicentryplugin.webpackconfig.entry ( ode_modules ext\distuild\webpack-config.js:145:156 ) ( node:12420 ) unhandledpromiserejectionwarning : unhandled promise rejection . this error originated either by throwing inside of an async function without a catch block , or by rejecting a promise which was not handled with .catch ( ) . to terminate the node process on unhandled promise rejection , use the cli flag -- unhandled-rejections=strict ( see < url > ) . ( rejection id : 1 ) ( node:12420 ) [ dep0018 ] deprecationwarning : unhandled promise rejections are deprecated . in the future , promise rejections that are not handled will terminate the node.js process with a non-zero exit code . using external babel configuration location : `` .babelrc '' < code >
i have a project where i 'm using sass modules for all the styles . there are two pages that share a button component with default styles . on page a the button component has some of it 's styles modified with a class . however , if i hover over the link to page b , in production , next fetches the js for page b including the styles . when this happens the styles from page b override those from page a and the button style is reset to the default . a workaround for me would be to use greater specificity to protect the styles on page a. however , it 's an unexpected behavior to have styles from one page impact another page like this . especially being the only interaction needed to trigger this is hovering over a link . this only happens in production . i would n't be surprised if there are other people out there with the same issue who have n't realized it yet . < code >
less plugin documentation tells me to install @ zeit/next-less and less in dependency section instead of devdependency . this is intentional right ? from my previous spa development experience , css preprocessors are devdependency , only those that i import in files under src folder belong to dependency section . does this rule still apply to nextjs ? if not , when i want to add a package ( for example , a babel preset ) , how do i distinguish it between dependency and devdependency ? < code >
hello , i am wondering how to implement the following dynamic route with a different component to render url structure ( already have in a previous application and i do n't want to lose it ) : 1 - /assets/ [ asset-title ] /browse- [ assetid ] ==== > this should render pagea 2- /assets/ [ asset-title ] /play- [ assetid ] ==== > this should render pageb and each one of these components going to have different ( 'getinitialprops ' ) i could not find a way to make this dynamic route with folder structure can anyone help or suggest a good solution for this ? thanks , < code >
hello everyone , i have an example like this href= { /detail-post ? id= < cur > { mainid } } as= { /detail-post/ < cur > { anotherid } } i must use the mainid ( can only use this ) for fetching and anotherid to be display ( because they do n't want to show the mainid ) my issue was , how can i get the mainid after refresh page because getinitprops only get the mainid at the first time render page . thank you for your help ! < code >
bug report in yarn dev styles from react-bootstrap are not picked up on the root page . in the example at had leading to the `` join the movement '' -button not picking up the styles from to reproduce go to < url > run yarn or npm install locally run yarn dev see how button does not pick up the style expected behavior would expect all styles to be applied or see some form of error screenshots this is how the page looks in dev this is how the page looks after building ( and is supposed to look ) system information os : macos catalina ( 10.15.4 ) browser : chrome version of next.js : 9.4.2 version of node.js : 13.13.0 < code > export const verticalcenterwrapper = styled ( `` div '' ) ' height : 100 % ! important ; display : flex ; ' ;
hi , i noticed that since switching the experimental.modern option on ( in next.config.js ) all the < link rel= '' preload '' ... -s got the crossorigin= '' anonymous '' attribute ( < url > ) . what 's the reasoning behind this ? i 'm having my assets hosted on the same origin as the page itself , is this crossorigin attribute necessary ? thanks . < code >
newbie trying to get some clarification around pages and what part of the page is client vs server and is that consistent . i will make an assumption that getserversideprops , getstaticprops , and getstaticpaths are server-side , but is the rest of the component client-side or only client-side in a react hook . and does this change if we set fallback=true ? is this identified in a document ? reason i ask is if i follow the sample in this for redirects : # 11346 , it works . but if the component is ssg with fallback=true , the useeffect does not work the same and many times i get errors related to client headers have already been written . so based on the question above , is everything in the component server-side except for hooks , and then does that change if ssg is set for fallback=true . and one more question , does the server vs client change if its set to fallback=true but you hit a page that does n't exist ( which would normally be a 404 ) ? < code >
i have this route /pages/propiedades/ [ id ] .js with this code : export async function getstaticprops ( context ) { console.log ( 1 , context.params.name ) ; const propiedad = await getpropiedad ( context.params.id ) ; } and a component wit this link < link href= { { pathname : /propiedades/ < cur > { info.id } , query : { name : 'text ' } } } key= { info.id } > this link goes to /propiedades/1 ? name=text but when i log context.params in getstaticprops ( as above ) i only get { id : 1 } missing the name param i 'm doing something wrong ? i want to get access to the two params ( id , name ) but only get id . < code > const filter = { where : { tipooperacion : propiedad.tipooperacion , ciudad : propiedad.ciudad , tipopropiedad : propiedad.tipopropiedad } } const propiedadesparecidas = await getallpropiedadesparecidas ( filter ) ; return { props : { propiedad , propiedadesparecidas } }
hello , i 'm now learning next.js . i tried the with-tailwindcss example , one of the official examples . it was rendered on the development server correctly . then i generated a static site from it , but the css was not exported . thus the static site was not rendered correctly . i have avoided this problem by exporting css by the tailwind command and reading the generated css in the pages/_document.js , but this solution left a huge raw css in the html . this solution is not smart . are there better solutions to this problem ? thank you for your reading . < code >
hi ! sorry to bother you bout this small matter but i wan na clarify some things regards to the src directory . i had a custom _app and _document js file and i want to know if these two would be under the src directory or under src/pages directory ? if i put these just under src directory not src/page directory , will these two still override the default _app and _document js file ? < code >
i implement list of items with pagination using useswr and useswrpages . also i need to refetch list when prop changes . here is example : < url > if one or two items loaded and i click on filter buttons result is correct , because count of values is equal . but if i load more items , than it is in filtered list and then click on filter buttons the result is duplicating any ideas how to fix this or may be i should do it in another way ? < code >
location in react- router looks like this : previously with react-router i can pass any value in state using history.push and that values are not visible in url . how can i do it with next js ? also how can i get hash values in next js < code > { key : 'ac3df4 ' , // not with hashhistory ! pathname : '/somewhere ' , search : ' ? some=search-string ' , hash : ' # howdy ' , state : { [ userdefined ] : true } }
my next app uses dynamic paths and i 'd like to statically generate a subset of these paths . for the paths that are not generated , i want to use the fallback approach , but i do n't want a page built statically on the server . instead , i 'd like the web browser to make the request for the data itself . this would allow the browser to fill in the missing page data itself , rather than waiting for a fallback page from the web server , introducing an unnecessary middleman . is this functionality possible somehow ? l < code >
i 've found severals ways of doing middleware with nextjs eg : nextjs route middleware for authentication ( extending using _app.js ) < url > ( writting middleware in express server layer ) but out of my curiousity , may i know is there a possible way to do middleware using dynamic api routes methods ? eg : add a file on pages/api/auth/ [ ... middleware ] .js all the request from pages/api/auth/ * will handled by [ ... middleware ] .js recently i came across with a cool nextjs auth package : ( < url > ) i 've studied the source and try with below codes on pages/api/ [ ... middleware ] .js ideally when i try to fetch the url : < url > the terminal/console should output following console eg : 'auth folder middleware ' 'user ' may i know what did i miss ? thanks ! < code > // [ ... middleware ] .js export default async ( req , res ) = > { return new promise ( async resolve = > { const done = resolve ; console.log ( 'auth folder middleware ' ) return done ( ) ; } ) } //user.js export default ( req , res ) = > { console.log ( 'user ' ) }
i 've made a simple poc about bringing the power of mdx inside a next.js application . poc : see live demo only this page uses mdx , other pages use tsx see pr it 's really exciting to be able to combine this as a 3-in-1 file . mdx really brings something new by allowing to combine jsx ( react components ) with well-known markdown/html . this poc alone should help you get up to speed if you 're interested with mdx . but my end goal is to see if we can use mdx from a cms , and build pages using content ( mdx ) from an external system , like a cms . ( if possible , then i plan to make a poc , using airtable at first ) you can see my motivations and discuss this advanced use-case in this rfc this could lead to a very advanced level of customisation , for an end-user point of view ( content manager , writer , etc . ) , using a panel of pre-made react components as simply as writing html . related : # 12151 # 13901 mdx-js/mdx # 126 the official mdx doc seem to use a virtual file ( need to dig in , may be the solution ) : < url > < code >
my app needs to access email address pass to it via the url query string . in some case , a + will be present on the left side of the @ however when accessing the query object either via the context in a server handler or next/router on the client side , the + is always replaced with a space . not sure if this is a bug or not so figured i 'd post here before creating an issue to get some feedback from the community . < code >
i 'm trying to revalidate the page each new comments comes in . comments are hosted on firebase , and i 'm fetching them like this : and this is the getstaticprops return : i added a timestamp updated to get the time of the generated page still , the page never generate . the getstaticpaths function is defined like this : < code > export const getstaticpaths : getstaticpaths = async ( ) = > { const posts = getallposts ( [ `` slug '' , `` maintag '' ] ) ; return { paths : posts.map ( ( posts ) = > { return { params : { slug : posts.slug , type : posts.maintag , } , } ; } ) , fallback : false , } ; } ; const allcomments = await firebase .collection ( 'posts ' ) .doc ( params.slug as string ) .collection ( 'comments ' ) .orderby ( `` date '' , `` desc '' ) .get ( ) const docs = await allcomments.docs const comments = await json.parse ( json.stringify ( docs ) ) return { props : { comments : comments , updated : updated } , unstable_revalidate : 5 , } ; const updated = new date ( ) .tolocalestring ( ) ;
hey all , in the nextauth example ( < url > ) , the file pages/auth/index.js has the following code : this page works perfectly fine when running locally , but unfortunately fails when deployed to zeit using now . in the deployment , i get the following error : i tried troubleshooting this to no avail . i saw this note in the nextauth documentation : csrf , session and linked account endpoints are provided for single page apps . based on this , i had a suspicion that nextauth.linked and nextauth.providers should n't be called on the server and should only be called on the client , so i modified the code to only call these functions on the client . unfortunately , this did n't fix the problem . the page still shows a server error when it is loaded on the client . would appreciate any help , and would be great to find out if this is an issue with nextauth , next.js , zeit , or one of my minor modifications . thanks ! < code > import react from 'react ' import router from 'next/router ' import { nextauth } from 'next-auth/client ' import layout from ' .. / .. /components/layout ' export default class extends react.component { static async getinitialprops ( { req } ) { return { session : await nextauth.init ( { req } ) , linkedaccounts : await nextauth.linked ( { req } ) , providers : await nextauth.providers ( { req } ) } } render ( ) { ... } }
bug report webpack bundling taking too long to bundle ( some times up-to 30-45 minutes ) . describe the bug i am facing this issue in development , while working in nextjs ( on 9.4.4 ) with apollo micro server ( on 2.14.1 ) as backend and apollo client ( on 2.6.10 ) on client side . everything works fine at times and on some occasions server takes forever to bundle files ( some times up-to 30-45 minutes ) . i 've tried to find the solutions online or at repository but nothing seems to work . currently my next.config.js looks like to reproduce steps to reproduce the behavior , please provide code snippets or a repository : start project . npm run dev . at start it will take good amount of time to bundle files if it does not do some changes in js files and wait till hot module reload starts to bundle . now you are stuck with it taking good amount of time to finish or even show an error . system information os : [ windows 10 ] version of next.js : [ 9.4.4 ] version of node.js : [ 12.17.0 ] < code >
i am currently using tailwindcss and its great , but i was wondering if it is possible to have a critical css file and split the rest of the css on a per page base ? < code >
feature request is your feature request related to a problem ? please describe . i am using react-native-web to and wants to use react-native-vector-icons library . but it shows a invalid image . describe the solution you 'd like a clear and concise description of what you want to happen . describe alternatives you 've considered a clear and concise description of any alternative solutions or features you 've considered . additional context add any other context or screenshots about the feature request here . < code >
hi , i am trying out incremental static regeneration for the first time , and it 's super cool ! however , i am running into an issue where the incrementally generated route causes a refresh . to be more specific , i have a page with a couple of < link > elements that link to these incrementally generated routes . i do n't generate these routes at build ( because of api rate limiting and the fact that these routes may not be opened much by the user ) . when i click on these links , it navigates to the newly generated page , except it does not retain the state of the page , as it causes a refresh . is there any way i can make the navigations to the incrementally generated routes act like the `` usual '' navigation between pages within the app ? thanks ! < code >
hey , just want to know for next.js , is it necesary to build api endpoints for login etc ? why not directly work with database ? why do we need to fetch ( `` `` ) data when we can just get it by doing queries ... < url > thanks ! < code >
hi there , i 'm building a saas with a dashboard side ( admin ) and a landing side ( user ) . i started as one app then tried to divide both apps using multi zone . it works to some extents , but i have serious styling issues , coming from styled components i believe ( works fine on local ) . the docs mention that every page must be unique on each side . the thing is i have a _app.js needed for context and a _document.js needed for styled components to work on ssr . both can not be renamed and therefore exist in both apps ' pages folder . i feel this might be the source of my bugs . is there a way for me the fix this ? < code >
since there is currently no way to get source maps on a production build , how are we supposed to profile the application ? profiling in development mode is , obviously , not the same . and if you are in production mode , then you do n't get source maps to find where the problem lies . i know that there is an experimental feature , but is there anything more reliable , or any workaround for an older version of next ? i find it hard to believe that nobody has ever had to do this before 🤔 < code >
hello , global stylesheet does not loading on ssr . i am using custom server and custom document . when i disable javasrcipt ( for ssr loading ) . the global styles does not loaded . is there any extra configuration to load css on ssr ? best regards < code >
hello , friends . we want to share this tool we created using nextjs and gather feedback from the community to see what to change , what to improve , what is right , what is wrong . what does it offer ? integrated dynamic api and dashboard roles for the api and the client side content types with dynamic fields and dynamic forms comments and discussions web monetization layer ( on the client side ) set of coded components we wrote a post on dev.to to cover the launch and also on edge . here you can find more about what the project is about and all the features . dev to post post on edge demo site some feedback we already gathered from the community : change the name use typescript we would like to hear your ideas and critics , thanks ! < code >
i have a dashboard application , which i want to distribute via npm . it 's a traditional next.js app but i want to make it a package that exports a command to start the next.js based app . hence the consumer app would be able to do something like the following after installing my app as a dependency . how can i do that ? < code > `` script '' : { `` start '' : `` my-dashboard-app start '' }
title says it all , basically i need to setup webhooks from stripe , which post at mydomain.com/webhook how can i create an api route that 's not under /api/webhook but under /webhook hope that made sense , peace < code >
sorry for a very poorly worded question , but i 'm currently using apollo with next.js , and when the first page loads from the server that same page ( and it 's queries that are called on it ) are being called on every client page change with the link component . i 'm not sure where to start with debugging this one as i 've never had this issue . it would seem that the original page component is still mounted ? any help appreciated ! < code >
some of my pages use templates that load html that happen to reference static js . i have it working where i have those static js files in the public directory , but it seems weird especially because those static js files do n't get processed/minified like all of my other js does . should the public directory only be used for non js files ? < code >
with next js 9.4.0 , i am getting the following error for files served from the public folder : error [ index.js ] : path : images/xxx.svg | error : unable to resolve path /images/xxx.svg . is any additional configuration needed to serve up files from the public folder or is this a bug in next js ? < code >
i haved added the code in my _app.js useeffect method . but due to this lighhouse is showing unused javascript code . what should be the proper placement for the initialization of these 2 ? < code >
hi there , i 'm trying to render more than one page at the same time , this according to the path url . i need the routing to be dynamic , but based on the route , render more than one page . i made a demo of what i 'm trying to achieve : with secondary pages any ideas how could i build something like this with next and dynamic routes ? thanks ! < code >
hi all , most of the pages on my site ( probably all ) will share the same header and footer . so my plan is to create a mastertemplate component which will be used on all pages , the page content being inserted as props.childern . the template contains data from a csm ( category links etc . ) so am i going to need to go to the cms in the getserverprops ( or getstaticprops ) function of every single page and pass them down to the template ? ideally i 'd get the data inside the template component and if the template does n't change when the user navigates between pages then the data would only be fetched ne . however this is n't possible with next because data ca n't be fetched in child component ( not with ssr anyway ) . what do other people do , get all data in every page ? or maybe cache it in the browser ? < code >
a project i am working on has many components that omit the react import import react from `` react '' however when i try to test said components i get the following error . error ts2686 : 'react ' refers to a umd global , but the current file is a module . consider adding an import instead . has anyone here successfully configured jest for a nextjs project that omits the react import ? < code >
hi , in my react.js application , i have integrated with next.js . on button click action , i have written code to push to new route . behavior : on button click , its redirecting to dashboard route correctly . but , when i reload/refresh the page i am getting 404 error . not sure , why request url change is different here . request url after clicking button : < url > request url after page reload : < url > i am using like this to push the route . router.push ( { pathname : '/dashboard ' , query : { customerid : 100 } } ) ; < code >
i started writing an auth example that implements passwordless login with magic links . the user experience is nearly identical with magic.link , it just doesn ' t have the security implementations they have in place . anyone interested in such an example ? < code >
when navigating form one page to another page first loading error page and after some time loading my actual page . this is happening in fire fox browser only . < code >
if i want to query with mongoose/redis directly inside getserversideprops where should i connect to mongo/redis ? i do n't want to create connection every page . i want to run the next.js server ( npm start ) and create the connection before the client visiting . so , each page could use the same connection ? < code > export const getserversideprops = ( context ) = > { // do n't want to connect here ! const doc = await model.findone ( .... ) // or mayby redis query return { props : { ... } } }
i am trying to import a package into my next js project whose components import scss files . however , i get the following error : document is not defined referenceerror : document is not defined at i ( c : ode_modules path to imported libary\dist\main.js : ) it is very important to be able to import eternal packages that import scss files this way . is there any workaround or fix for this issue ? < code >
i 'm deploying my site with vercel and the now command line and using getstaticprops which gets content from my api + mongodb database . some of the text contains accents since the site is in spanish . this does n't occur with getserversideprops it seems the utf-8 strings are n't being rendered correctly during the build . any help would be much appreciated because it is the only thing holding me back from being able to use getstaticprops 🙏 < code >
i have a serverless function in a endpoint : and defined like this : and i would like to use this endpoint with amp , but amp accepts only xhr , instead of fetch . i could provide the mailchimp endpoint directly to the action-xhr property in the amp form , but again i need to provide cors headers . < code > export default async ( req , res ) = > { ... const response = await fetch ( ' phofurl { body : json.stringify ( data ) , headers : { authorization : 'apikey < cur > { api_key } ' , 'content-type ' : 'application/json ' } , method : 'post ' } ) ; ... } ; domain/api/subscribe
i have been using pm2 and i have configured environment variables in pm2 ecosystem.config.json . the values are correctly loaded in the server.js but the next js is not passing it down to the browser . sample ecosyste.config.js module.exports = { apps : [ { name : `` new-app '' , script : `` ./server.js '' , watch : true , env : { `` node_env '' : `` production '' , `` next_public_test '' : '' testing '' } } ] } < code >
hi , i 'm having issues with session cookies . on localhost everything works perfect but after deploying ( next build & & next start ) on page reload cookies are disappearing . i 'm using graphql client with next.js on front-end and node/express with graphq server on server side . deployed on same domain tried almost everything . app itself : < url > repo : < url > < code >
hi guys , i have a new web app i want to bring online quickly . it 's not too complicated but it needs to handles auth and user related data . this time i want to try next.js is there a boilerplate that gets me up quickly ? i do n't care about the type of db . i just want to deploy it to vercel when finished and it should work : d how are you creating this workflow these days with next.js ? thx so much ! < code >
bug report describe the bug i wanted to use a slug to fetch an api with it and return the result . i tried to use server-side rendering and react component but the data does n't appear on the page ( it 's not invisible or something ) . the layout is rendered but everything else not . i do n't know this is my fault or a bug . to reproduce make a page with the file name [ slug ] .js add this code to the file : expected behavior the json data from the api should appear on the page . system information os : windows browser : chrome version of next.js : 9.4.4 version of node.js : 10.14.02 < code > import axios from 'axios ' ; import { userouter } from 'next/router ' import layout from ' .. / .. / .. /components/layout ' ; function edit ( ) { const getpost = ( ) = > { const router = userouter ( ) ; const { slug } = router.query ; axios.get ( 'api/blog/ < cur > { slug } ' , { responsetype : 'json ' } ) .then ( ( response ) = > { return ( response.data ) ; } ) ; } return ( < layout > { getpost.title } < /layout > ) } export default edit ;
hi ! i am moving an app i built with react to next.js , and i ran into a really weird issue . i have a page that is literally just text content , with a few links . however , when i try to use < link > , i get the `` element type is invalid '' error . here 's my code : here 's the error : i am not sure what i am doing wrong , but removing the gets rid of the error . any pointers as to what i could be doing wrong ? thank you ! < code > unhandled runtime error error : element type is invalid : expected a string ( for built-in components ) or a class/function ( for composite components ) but got : undefined . you likely forgot to export your component from the file it 's defined in , or you might have mixed up default and named imports . < section > < p > ... < link href= '' /store '' > < a > on this page. < /a > < /link > ... < /p > < /section >
hi , i am working in next js project and i wan na passe data from page to _app . i have a header component inside my _app with a props ishomepage default to false and i want only set it to true in the index.js page . is there a way to send data to _app.js ? < code >
bug report i 'm currently working on my app build with kubernetes with a few services . one of them is the client side service build with next.js . when i 'm on my local dev everything is working fine ( see the screenshot ) . unfortunately after deploying to my digital ocean cluster my app is throwing an error : `` module not found : ca n't resolve ' .. /components/header ' in '/app/pages ' '' i 'm not that experienced with next.js so i 'm assuming that this may be some really silly fault on my side , but maybe not . that 's why i decided to ask it here .... describe the bug a clear and concise description of what the bug is . ( as above ) to reproduce steps to reproduce the behavior , please provide code snippets or a repository : go to < url > click on 'download zip ' run npm install install docker , login with your profile , change username to yours in yaml files . run `` skaffold dev '' expected behavior before i did some changes to the styling part of my app , everything was working fine . ( i had some very basic bootrstrap styling classes applied to a few components ) screenshots this is my local log from my terminal : this one comes from my digital ocean client pod log : system information macos 10.15.4 browser brave version of next.js : 9.4.4 version of node.js : 12.16.1 additional context add any other context about the problem here . < code >
hello , i have a client app using nextjs ( `` next '' : `` 9.1.5 '' ) and have implemented it using a custom server which also receives all my react native apps api requests . for deep linking in my react native app i 'm using a res.redirect ( appbundle : //deeplink ) but the request is being caught by nextjs and redirecting them to the client web app . i 've tried some logic i thought may work in my server.js , please see below , any input is greatly appreciated . //server.js// nextapp.prepare ( ) .then ( ( ) = > { const app = express ( ) ; if ( process.env.node_env === 'development ' ) { app.use ( morgan ( 'dev ' ) ) ; } usemiddleware ( app ) delegateroutesfor ( app ) app.use ( errorhandler ) app.get ( ' * ' , ( req , res , next ) = > { const parsedurl = parse ( req.url , true ) console.log ( `` next '' , { parsedurl } ) if ( parsedurl.pathname ! == '/api/auth/resetpassword ' ) { return handle ( req , res ) } else { next ( ) } } ) const port = process.env.port || 5000 ; const server = app.listen ( port , console.log ( server running < cur > { process.env.node_env } mode on port < cur > { port } .yellow.bold ) ) ; } ) ; < code > process.on ( 'unhandledrejection ' , ( e , promise ) = > { console.log ( e.message ) server.close ( ( ) = > process.exit ( 1 ) ) } )
i may be straying off the reservation here , but i wonder if it 's possible to generate x number of components during ssg ( export to html ) and have a page pull in a group of them as needed ? simple use case : pulling 5 random links to other blog posts from a pool of 5,000 pages . the two options i can see are : pull those five and render at build time pull and render all 5,000 at build time , and hide all but 5 on the client . problem with 1 ) is that you get the same 5 on every refresh of the same page ( reduces link `` discover-ability '' ) problem with 2 ) is that 's a lot of extra cruft to be passing with every page just to hide / remove all but five at display time . i 'm up for any exploration on how to do this , even if that means admitting i 'm going about it all wrong . ; - ) < code >
feature request is your feature request related to a problem ? please describe . right now you have to do this yourself and i 'd bet many forget this . it would be really nice to have this included in next/link by default . describe the solution you 'd like set a aria-current attribute on the active link ( s ) . i could work on this , but i might need some guidance on how this should be implemented since we probably have to wrap the link component in a withroute hoc . describe alternatives you 've considered n/a additional context < url > < code >
i wanted to ask if it 's nextjs problem , since i 've been looking for other alternatives and i ca n't find why the screenshot in google search console comes out without the styles , in other pages without nextjs i have n't had that problem . this is the screenshot generated by google from google search console . this is my website of posicionamiento web malaga < url > < code >
i am using both getstaticpaths and getstaticprops to query and pull in data from my sanity backend . in development , everything works great . but when i build my site , my props are all undefined for my dynamic pages only ... so clearly the query is not being run . i think this has to do with my environment variables not being read correctly . in development , i have a .env.development file and i have a similar .env.production to build . in vercel , i have my git repo hooked up and i have entered my keys and secrets and endpoints in the environment variables section under the production tab . i am not using a next.config.js file . i 've looked through the sanity example and while i do a few things different in regards to getting the data ... my getstaticpaths and getstaticprops methods are essentially the same . all of my errors are a typeerror saying i ca n't destructure `` variable '' from undefined . anybody run into this ... if not i will create a sharable example because i feel like i 've tried everything i can think of . thanks ! < code >
excuse me if i 'm missing something , but is it possible to have a command-line option if the port is taken ? seen it @ other apps so i thought it would come in handy . for example , if port 3000 is taken , you get a message - port xxxx is taken , do you want to use another port ? y/n currently , if the port is taken you get an error which also is okay , but i guess it would be even better if you can just click y and get the app launched at a different port . < code >
bug report describe the bug when using a custom server the new paths on that server work on development but when deployed with vercel they return a 404 to reproduce check this < url > ( it 's a 404 ) this is the code if you pull and run the project it 'll work expected behavior that works the same in prod as in devel aditional i tried multiple approaches : catch-all with * , next-routes , etc . but nothing seems to work . and , honestly , it 's kinda painful that fails after the deployment because testing it that way is harsh 😞 ty < code >
hi guys , has anyone deployed a ssg+ssr hybrid site on their own server or google app engine ? the big problem is that we are generating our ssg pages using strapi.js cms - so i would want the pages to be built as static html before deploying . i 'm not making strapi available on my server . however it seems that next export does not work for a hybrid site - and im not able to figure out how to do this . has anybody built and deployed this to their own server ? it can be running on docker , gae , etc . i think it will be a common issue for all these usecases . < code >
i'am using ssr and getting base64 images from api in getinitialprops . however , base64 images are also duplicated in props __next_data__ . this increases page size and has a bad effect on seo metrics . is it possible to remove duplicate images data from __next_data__ ? < code >
the code i am running in the getinitialprops of _app.js is sending a request to the server and returning the user . in sentry , the error is coming from /api/user request . _here is the getinitialprops in app.js and here is the api code in authcontroller.js_ now if anyone can help me figure out how to do this more elegantly and error free , it would really help because people are actually paying for a service on my website which is now giving them 404 errors when the response is ... if you need any more code or anything , please let me know . < code > exports.user = async ( req , res , next ) = > { if ( req.cookies.token ) { const decoded = jwt.verify ( req.cookies.token , process.env.jwt_secret ) ; if ( decoded.userid ) { const user = await user.findbyid ( decoded.userid ) ; return res.json ( { id : decoded.userid , name : user.first_name , last_name : user.last_name , email : user.email , } ) ; } } return res.status ( `` 200 '' ) .json ( null ) ; } ; static async getinitialprops ( { component , router , ctx } ) { const res = await fetch ( ' < cur > { environments.public_url } /api/user ' , { method : `` post '' , headers : { accept : `` application/json , text/plain , * / * `` , `` content-type '' : `` application/json '' , } , } ) .then ( ( res ) = > res.json ( ) ) ; console.log ( res ) ; let pageprops = { user : res , } ; if ( component.getinitialprops ) { pageprops = await component.getinitialprops ( ctx ) ; } return { pageprops } ; }
hi ! i am building a site with dynamic api routes . these routes connect to a database using typeorm . the server crashes when i use import statements , like this : i am not using a custom server , and my understanding is that nextjs would transpile the code so that require-statements are not necessary . does anyone know of an explanation ? thanks for any help ! 😄 olav < code > /path/to/entity.ts import `` reflect-metadata '' ^^^^^^^^^^^^^^^^^^ syntaxerror : unexpected string
i 've got an older nextjs site that 's currently on netlify . if i would like to update this site to use preview mode , do i need to switch to vercel ? i seemingly ca n't call res.setpreviewdata ( { } ) on anything other than vercel . < code >
bug report describe the bug after i upgraded next.js version 9.3.6 to 9.4.2 i got the error on ios 10 as following : system information os : ubuntu browser chrome , safari on ios 10 version of next.js : 9.4.2 version of node.js : 12.16.1 < code >
hey ! i have a pretty simple static site built with v9.3.6 , there 's a problem i 'm running into when adding to my pages/index.tsx . once deployed through vercel , navigating to the url 's / route leads to a page with no javascript . the html sent down is just my public/index.html with the root div not populated . strangely enough , if i navigate to the deployment url 's /index path , i see the page with the statically fetched data . i ca n't reproduce this locally - when going to localhost:3000/ i see the index page correctly . if i remove the getstaticprops ( ) export , the deployment 's / path begins to work correctly again . index.tsx looks like this < code > type props = { emptysearch ? : searchresultrow [ ] } function indexpage ( props ? : props ) { ... } export async function getstaticprops ( ) { ... } export default indexpage export async function getstaticprops ( ) { ... }
i 'm trying to fetch inside a getstaticprops : from the same domain as the client , using vercel functions . the problem is that i need change localhost with the corresponding deployment domain . and there is no way to know the deployment domain since vercel gives an arbitrary domain name . so at build time nextjs needs to know what domain vercel gave it . this is probably not the best approach , since i 'm gon na change the domain later . if only there was a way to pass relative url to fetch , like what swr does . if there is an alternative to fetch like this , that would be awesome < code > const res = await fetch ( ' < url > } ' )
as the title says , is there any way i can define a file that 's within a folder of pages , that gets passed a children prop with the content of the current child page . for example , lets say i have a settings folder . i want the settings folder to render some global stuff ( tabs for instance ) , when you go to settings/collaborators it passes the content of the collaborators page to the parent page . hope that makes sense and thanks in advance ! < code >
hi , in short here is my setup : index page - > load landing component if user is not logged in - > load dashboard component if user is logged in this works fine . i wanted to add a script in head only for the landing component which i added as following ( that works too ) the problem is that when someone goes from landing to login and then is logged in , then i need to remove the script from the head . ( it is a script that adds a third-party chat widget on the page and i do n't want it showing on dashboard / when user is logged in ) how do i do this ? the actual component is unmounted when the user is logged in but the script in head still remains . a hard page refresh solves the issue . < code > < head > < script // eslint-disable-next-line react/no-danger dangerouslysetinnerhtml= { { __html : ' the script i need ' , } } / > < /head >
thanks for maintaining this useful framework ! bug report describe the bug update : this bug only appears in the node-test . it does not appear when fetching from the browser . the dynamic query property ( [ id ] .ts ) is undefined . my file is located in pages/api/brands/ [ id ] .ts . i am reading the id like this : to reproduce create a dynamic api endpoint ( e.g . /pages/api/posts/ [ id ] .ts . write a jest test that fetches the endpoint . try to read the id from request.query . id is undefined expected behavior i expected the id to have the value in my url , e.g . /api/brands/some-id . system information os : macos browser : no browser , jest in node environment version of next.js : ^9.4.2 version of node.js : v13.13.0 edit : removed template text < code > const { query : { id } , } = request
does anyone know how to see the error page instead of the stacktrace in dev ? according to the documentation , it will show the proper error page in production : < url > is there a flag to see the error pages in dev ? < code >
hi folks ! as i port one of our apps to nextjs , i 'm noticing source-map errors when trying to load the page on firefox ( or firefox developers edition ) . it works great on chrome ! as i looked around , i saw one an unresolved bug report and an unanswered issue on stackoverflow . since it seems to be a production-stopper for us , i 'm curious if there are workarounds here and/or if anyone else experienced this ? < code > source map error : error : invalid url : webpack : // [ name ] _ [ chunkhash ] /webpack/bootstrap resource url : < url > source map url : dll_dc8ac110ce5d8530b237.js.map
hi there ! to anyone who would be willing to help me it would be amazing . i 'm trying to create a boilerplate that would be able to have two things . custom server using express ant design library i created a quick little dashboard with this and deployed it to heroku . i wanted to test out the performance with lighthouse . unfortunately i got a really low score with performance . here 's the link so you could check the performance using lighthouse - < url > do tell me if a repo would be helpful ! < code >
bug report describe the bug hi all ! , i try to navigate in my app but when i want to use the browser back button or router.back ( ) the url change but my app stays in the same place . what am i doing wrong ? to reproduce steps to reproduce the behavior , please provide code snippets or a repository : go to localhost:300 click on whatever video click on volver button or browser back button see error expected behavior the app should go back screenshots system information os : ubuntu 19 browser ( if applies ) : chrome , firefox version of next.js : 9.3.5 version of node.js : v12.13.1 additional context my code for navigation is the follow and then in my player i receive the id thanks for read < code > const parsed = querystring.parse ( window.location.search ) ; if ( parsed ) { setvideodata ( ( ) = > data.find ( ( item ) = > item.id === parsed.video ) ) ; } < link href= { props.streaming === `` 1 '' ? '/streaming ? video= < cur > { id } ' : '/player ? video= < cur > { source_id } ' } > < a > { titlevideo } < /a > < /link >
hello everyone , disclaimer : i am asking this question here because these concepts are heavily mentioned in ssr related topics . i am trying to wrap my head around to understand how ssr works in general , but whenever i read an article about it i see hydration or rehydration keywords . what is the difference between them . thanks ! < code >
i 'm on `` next '' : `` 9.1.5 '' , and this is my file structure for pages : i have this dummy navigation : when navigating from anywhere to a blog page , the following happens . the page is loaded and displayed correctly , but not via javascript . it does a full page load . i observed the following : when going to /home , it works fine : the thing that 's causing the problem is that the js file is called _next/static/development/pages/blog/show.js and not dummy-entry-1.js . what am i missing ? why is this happening ? whats causing this ? < code > const navigation = ( ) = > ( < > < link href= '' /home '' > < a > home < /a > < /link > < link href= '' /blog/dummy-entry-1 '' > < a > dummy < /a > < /link > < / > ) ; request url : < url > request method : get status code : 200 ok pages/ blog/ show.js home/ index.js request url : < url > request method : get status code : 404 not found
i have a link component that uses next/link and i 'm passing in a telephone number formatted like this : tel : < phone > however i get an error : are telephone numbers not supported ? < code > invalid href passed to router : tel : < phone >
i have a catch all route ( [ ... id ] in the pages folder . when getting data in getserversideprops the context object changes when another request matches the catch all route ( from the same page ) .in my case this is a favicon.ico request . this overwrites the data being passed as props in the associated component and errors out . below is a simplified version of the getserversideprops function i am using . is this expected behavior ? if so what may be a workaround i can try out ? if not let me know and i will create an issue . thanks in advance ! < code > export async function getserversideprops ( context ) { const getdatafromapis = async context = > { const data = await getdata ( context.req.url ) ; // same with context.params/context.query etc . const getdata = async ( path ) = > { const client = createapolloclient ( ) ; // just creates a client for graphql try { const { data } = await client.query ( { query : get_page , variables : { path : path } } ) ; if ( data ) { return data ; } } catch ( err ) { console.error ( err ) ; } } ; const data = await getdatafromapis ( context ) ; return { props : { data } } ; }
although the documentation states that we can write direct database queries in the getstaticprops method , it seems like querying the mongodb from a field other than the _id does not work . await client.db ( 'blogdb ' ) .collection ( 'posts ' ) .findone ( { 'urlname ' : params.meta } ) .toarray ( ) throws the the following error : but if i query from the id , it works await client.db ( 'blogdb ' ) .collection ( 'posts ' ) .find ( objectid ( params.meta ) ) .toarray ( ) if anyone came across this issue , please suggest a workaround for this , other than writing a separate backend api to fetch the data . < code > ./node_modules/mongodb/lib/url_parser.js module not found : ca n't resolve 'dns '
when user login , we set http only cookie with jwt from api server ( in private network ) when user making request from client side ( eg : /api with client axios instance ) we proxy request and attach token to header and send to api server . ( like we do in spa application ) but we have some restricted routes and we wanted to validate at the server side . in api server we have verify end point that will validate the token and respond user info . in order to validate protected end point from server side we decided to attach cookie from request . ( we can get cookie if we add domain ) my question is , this way of doing it correct way ? or any other better approach ? thanks . < code > server.use ( '/api ' , proxymiddleware ( ) ) ; proxyreqoptdecorator : function ( proxyreqopts , srcreq ) { proxyreqopts.headers [ ' x-auth ' ] = srcreq.cookies [ ' x-auth ' ] ? srcreq.cookies [ ' x-auth ' ] : 'none ' ; return proxyreqopts ; } static async getinitialprops ( ctx ) { try { const { req } = ctx ; const token = req.cookies [ ' x-auth ' ] ; // attach this cookie to server axios instance const res = await axios.get ( 'http : /api-server/verify ' ) ; } catch ( e ) { } }
bug report describe the bug i am using restrape tabs and i want different style on which tab that has only .active class but scoped style not working , i am getting stuck in this situation.here is simple scss code for active tab . .nav_item { width : 50 % ; a.active { color : # ffffff ; background-color : # 467c9c ! important ; border-color : # dee2e6 # dee2e6 # fff ; padding : 15px 15px ; text-align : center ; } } to reproduce steps to reproduce the behavior , please provide code snippets or a repository : simply use reactstrap tabs try to apply css only on active tab expected behavior it should work with active tab that must have different styles that was added on scoped style . additional context pls suggest me what should i do . i am trying to resolve since 2-3 days but still not got any solution . < code >
static file serving api does not work as you explain it here : < url > how does it not work ? it displays the browser 's default broken image icon reproduction steps ... i place image in /public sub-dir i call it using regular html < img element tag i reboot the local server after adding image to /pages jsx files i 'm on 9.3.4 so i 'm not using /static nor /public/static i even tried hard-pathing it to ' .. / .. /public/test-image.jpg ' ( i knew this would n't work , but i had to at least try it out any way ) for some strange reason though , the /public sub-dir is not serving files do i need webpack loaders ? ? ? the exact error is this : failed to compile ./pages/index.jsx module not found : ca n't resolve './test-image.jpg ' in '/users/home/projects/next-apps/project1/src/pages ' this could be the problem ... if you look at the path above , it 's resolving to the /pages sub-dir instead of the /public folder < code >
i 'm using api routes feature from next : < url > but faced an issue when doing next build because one of my pages are making request to that api route , which obviously is n't available during build , because there was no next start command before next build , so no server is running . how to deal with this ? page with request to api route : fetch client : error during next build : < code > export const api = new graphqlclient ( ' < url > ) ; export const getstaticprops : getstaticprops = async ( ) = > { const dicts = await api.request ( dictionaries_query ) ; return { props : { dictionaries : { total : dicts.dictionaries.total , items : dicts.dictionaries.items , } , } , } ; } ; error occurred prerendering page `` /dictionary '' . read more : < url > fetcherror : request to < url > failed , reason : connect econnrefused 127.0.0.1:3000
hello ! 👋 i have an app that i want to wrap inside an electron wrapper . this app depends on the user 's local files he/she can generate with the app . it 's a dashboard-like app . this is an example of routes i have on my app : /welcome : onboarding wizard /settings : user form /drafts : list of local documents /publications : another list of local documents /editor/ [ id ] : local generated document for the /editor/ [ id ] route , i ca n't generate those pages because the user needs to create them while using the app , so i ca n't use any of the build time apis to optimise those pages ( right ? 🤔 ) ❓is it ok to ship the electron app and let the app run next start to use it ? ? ❓do i need to `` export '' all the pages and mark the dynamic routes somehow so it will not try to generate those ? ❓is nextjs maybe too overkill for my use case ? thanks in advance ! 👍 < code >
i faced the situation when the same component shows mixed data when randomisation involved , html get jumbled data partially from ssr and partially from client rendering . here is the code : the result is following . ssr : ========================== 0.30408232064749563 client rendering : ========================== 0.6842738761932372 result html : < a href= '' 0.30408232064749563 '' > 0.6842738761932372 < /a > so the a tag get old ssr value in href while text value get updated . < code > const component = ( props ) = > { const rand = math.random ( ) ; console.log ( '========================== ' , rand ) ; return < a href= { rand } > { rand } < /a > }
every thing was working fine on local development , once my app done i run the next build once it done and when i tried build on browser most of the dynamic routes were throwing 404 and that was very weird . to reproduce have some dynamic page ( multi level ) , run next build expected behavior should not throw 404 for dynamic routes . screenshots screen short of the build output screen short of the 404 output screen short of how i am using link tag screen short of how i have the folder structure system information os : [ e.g . macos , windows ] browser ( if applies ) [ e.g . chrome , safari ] version of next.js : [ e.g . 6.0.2 ] version of node.js : [ e.g . 10.10.0 ] additional context even tried changing sequence of href and as , also tried remove prefetch and adding but output remains same . is't it very strange , even though you are doing everything right but getting 404 in browsers for all the links . sad : ( # update i tired removing tag and tried to handle via router.push eg : opencouponpage = ( url ) = > { router.push ( '/coupon/ [ id ] ' , url ) ; } but this is also not working . < code >
hi , i have a custom component library in the node_modules folder ( or in .yalc ) , which i would like to compile together with the nextjs app . i am using yalc , to work with yarn/npm packages locally . before , i was using create react app , and was able to accomplish that with customize-cra : without configuration it appears that the libraries ' components ( located in .yalc/my-module/src ) ca n't find imported components ( such as react , or a sibling component in the same library ) . now i would need to do a custom-webpack-config in next.config.js ? do i need to modify defaultloaders.babel directly or add a plugin ? i would appreciate any input on how to accomplish that . < code > module.exports = function ( config , env ) { return object.assign ( config , override ( disableeslint ( ) , adddecoratorslegacy ( ) , / * make sure babel compiles the stuff in these foldersr * / babelinclude ( [ path.resolve ( 'src ' ) , // do n't forget this path.resolve ( '.yalc/my-module/src ' ) , path.resolve ( 'node_modules/my-module/src ' ) ] ) ) ( config , env ) ) }
i have nextjs app . and it 's running at port 3000. and i have its graphql server . and this is running apt port 4000. and another nginx server to serve ssl , < url > when i access example.com , it serve nextjs app well . but the api request in it are failed . because of mix content error . requesting https ==== > http not allowed in browser . ' ( server { listen 80 ; listen [ : : ] :80 ; server_name < url > example.com ; return 301 < url > _uri ; } server { listen 80 ; listen [ : : ] :80 ; server_name example.com ; } ) ' i have no idea to handle this . < code > location / { proxy_pass < url > ; proxy_http_version 1.1 ; proxy_set_header upgrade < cur > http_upgrade ; proxy_set_header connection 'upgrade ' ; proxy_set_header host < cur > host ; proxy_cache_bypass < cur > http_upgrade ; } listen [ : : ] :443 ssl ipv6only=on ; # managed by certbot listen 443 ssl ; # managed by certbot ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem ; # managed by certbot ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem ; # managed by certbot include /etc/letsencrypt/options-ssl-nginx.conf ; # managed by certbot ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem ; # managed by certbot
when i do yarn run build & & yarn run export , it does n't seem to be including my styles imported in _app.js . os : [ lubuntu ] node v12.16.1 repo < code > dependencies '' : { `` classnames '' : `` ^2.2.6 '' , `` next '' : `` 9.4.4 '' , `` react '' : `` 16.13.1 '' , `` react-dom '' : `` 16.13.1 '' , `` serve '' : `` 11.3.1 '' , `` tailwindcss '' : `` ^1.4.6 '' } ,
so trying to ramp up on the framework and new to react and next.js . we are looking at running our application as ssg with fallback=true vs ssr . so i am trying to understand what runs on the server or does everything run on the server except for what is in the public folder ( or built during build time and then ran as static assets ) . i ask these questions just so i can be clear about a few situations : trying hooks for state management . useeffect works with localstorage.setitem only if i wrap localstorage it in a check to see if ( typeof window ! == 'undefined ' ) . while usest.ate in the component does n't work with localstorage.getitem ( i get an error ) . then on logging side , i was messing with winston logger . it worked fine but when i put it in the component , it did n't work and winston errored out because it needed the 'fs ' library . since we are using ssg with fallback='true ' , need to support what happens if a url is entered that does n't resolve to a valid content item . how do we redirect when this decision is determined in getstaticpath . if getstaticpath does n't return a valid path for content , we want to direct the user to another page . so i think most of my confusion on these items is not clearly understanding where code is run and whether that depends on ssg vs ssr vs ssg w/ fallback . trying to bridge react lifecycle methods and where they operate in next.js . hope i was able to explain it okay . < code >
hello , im trying to use vercel.json rewrites to direct urls to a specific file in my next js static folder with no luck . the vercel.json file the repo structure do i need to be using the dist folder as the destination ? if so , i am not seeing the file.txt being outputted to the dist static folder ? thanks in advanced < code > { `` version '' : 2 , `` rewrites '' : [ { `` source '' : `` /static/file.txt '' , `` destination '' : `` /src/public/folder/file.txt } ] } src components pages public folder file.txt vercel.json next.config.js package.json
hi guys ! is there an official way to use i18next or another translation lib ? ( i have all languages in a key / value table ) . is there an official way to do this ? or are there plans to have an official way in the future ? what is the best way . i 'm using next for ssr . thans so much ? < code >
is there an option to get source maps generated for 'next export ' ? i would like to enable source map and easy debugging for exported static app that i plan to be served by a flask server , but i found i can not easily debug and trace my js code in such a deployment . any pointers appreciated . < code >
when i test in my browser getinitialprops when i navigate to other page and press back button it got fetch the data ... but when i test in mobile browser it gave me 500 error ... what the hell is wrong with it i have been debugging a lot of time alrdy still cant figure it out why . in website works perfectly but in mobile is like shit it keep giving me 500 error ! ! ! < code >
hi ! in our app , we need to fetch categories to build the app-wide navigation . this data needs to be present on all pages . so the perfect location for the data fetching would be app.js . since _app.js only supports the getinitialprops method . this would disable all benefits from static generation you get by using getstaticprops . whats the recommended way to fetch data statically when it 's needed on every page ? did you find solutions for this ? thanks ! < code >
this is my .babelrc file it does n't work , and the project still warn ' you are using a whole package of antd-mobile ' i think maybe i can resolve this problem if i use the ts-import-plugin , but nextjs @ 9 is zero typscript config , i ca n't find where to use it , here 's some ts-import-plugin api : and what can i do next ? < code > // webpack.config.js const tsimportpluginfactory = require ( 'ts-import-plugin ' ) module.exports = { // ... module : { rules : [ { test : /\ . ( jsx|tsx|js|ts ) < cur > / , loader : 'ts-loader ' , options : { transpileonly : true , getcustomtransformers : ( ) = > ( { before : [ tsimportpluginfactory ( / * * options * / ) ] } ) , compileroptions : { module : 'es2015 ' } } , exclude : /node_modules/ } ] } , // ... } { `` presets '' : [ `` next/babel '' ] , `` plugins '' : [ [ `` @ babel/plugin-transform-typescript '' , { `` allownamespaces '' : true } ] , [ `` import '' , { `` libraryname '' : `` antd-mobile '' , `` style '' : `` css '' } ] ] }
hey y'all ! just installed a brand new with-typescript-eslint-jest app with yarn create next-app and uncommitted the prettier extensions so my .eslintrc.json file looks like : then i went into pages/index.tsx and added ; ; to the end of the first import and then ran yarn run lint and eslint did n't detect any errors . i thought vs code eslint plugin was being wacky but the cli returning no errors makes me super confused . i 've had the most frustrating time implementing eslint and prettier with my next.js project so i thought this starter would work out of the box . < code > `` extends '' : [ `` eslint : recommended '' , `` plugin : react/recommended '' , `` plugin : @ typescript-eslint/recommended '' , `` prettier '' , `` prettier/ @ typescript-eslint '' ] ,
hi there ! i just started out with styled-jsx and like it a lot . however , i was noticing that the styles i defined would not always take effect , and realized that i am unable to style custom components with hyphens in the name . for example , here 's a component i am trying to style : i can name the root element something like div or foo and the style will work , but if the name has a hyphen the style will not apply . are custom element names supported ? thanks ! < code > export default function test ( ) { return ( < my-test classname= '' root '' > < style jsx > { ' .root { margin : 0 ; width : 100 % ; height : 100 % ; } < /style > < /my-test > ) ; }
i started a next.js app with drupal cms as backend . so i need to catch all routes from backend dynamicly . for this i have an endpoint which return all routes on the site : i used this request in a file with name [ ... slug ] inside pages directory . result on build : the problem is that when i am trying to change params for specific page , the entire page is reloated with losing of previous state . for example on page forum i have a param named tab , which indicates number of the tab that should be opened as default . when i change it with router.push ( < cur > { path } ? tab=2 ) ; the entire page is reloaded . but if i create specific page file for forum route , there is no reloading . < code > const data = await fetchapi ( ' query { routes } ' ) ;
next 9.3 currently when i attempt to link to a page inside my pages directory , it does not work . in example the following code : should go to the page located in /pages/products.js but it does not . the url appears to change to localhost:3000/products but nothing gets loaded . when testing with this : it gives 404 because testme does not exist . it appears when the page does exist that it 's not routing to that page . when i manually go to the browser url and input localhost:3000/products it does load the page . < code > < link href= '' /products '' > < a > test < /a > < /link > < link href= '' /testme '' > < a > test < /a > < /link >
we 're planning to migrate an existing site to next and therefore we 're looking for a way to map/reuse our old amp-query parameter ? output=amp for all routes . is it somehow possible to modify the next amp query param ? or would a custom rewrite be an option ? something like < code > module.exports = { experimental : { async rewrites ( ) { return [ // rewrite output=amp to amp=1 ] ; } , } , } ;
when using < head / > from next/head in the /pages directory and using data from getinitialprops , the html head tag is not rendering with code in the /pages folder . the only time this seems to work is when < head / > is used in the _app.jsx file . the problem with this approach though is that all pages will undergo server-side rendering . i would only want the afore mentioned page to have custom values in the html head tag . < code >
hello guys and thanks a lot for the good effort put on nextjs ! : ) i tried to find answers for the following without much success . we are working on a dockerized nextjs application that is thought to be built once and deployed to several environments for which we will have different configuration . this configuration is to be set in the docker container when deployed as environment variables . in order to achieve this , we are using next.config.js file , splitting the vars on serverruntimeconfig and publicruntimeconfig as suggested here , and we are getting the values for the environment variables from process.env . i.e . : the problem we have is that these variables are not set on build time ( when we run next build ) , as they are environment specific and supposed to be set on deployment . because of this , the build fails complaining about the missing variables . making a build per environment is not an option : as referred before , we want to build it once ( with next build ) , put the output of the build in a docker container , and use that docker container to deploy in several environments . is there any way to solve this so that the application builds without environment vars and we pass them afterwards on runtime ( deployment ) ? thanks in advance ! < code > module.exports = { serverruntimeconfig : { mysecret : process.env.my_secret , secondsecret : process.env.second_secret , } , publicruntimeconfig : { staticfolder : process.env.static_folder_url , } , }
the syntax is < code > < link href= '' / '' > < a > < h1 > { titleroot } < /h1 > < /a > < /link >
nextjs version : 9.4.0 hi there , i have a basic app running which uses : a global sass import in _app.js css modules imports per component i notice that on first render of the app , the components are rendered without the sass stylings , both global and local . wait 1 to 2 seconds , and the sass styles start to apply on the browser . styles props are happening on first render though . app continues to work as expected after that first render . have not dig deep yet , but i suspect its something simple i did wrong . like maybe a config i missed out ? < code >
i am primarily asking this because i 've spent a lot of time reading about how csr or ssr works but still ca n't figure out what the different client and server bundles generated on build are , what is used when and and how it really works in a real world scenario . any help would be greatly appreciated . < code >
hi guys ! we 're migrationg our web app to next , in our current app we uso a lot of scss ... what is the best way to handle styles on next.js ? can we use scss without any performance threats ? is this ok , or you consider a bad practice ? thanks so much ! ! < code >
the app based on create-react-app , i can build client code and without its server , i can run this app with just one express server ( express will serve /build/.html ) . in next.js , i read some official documents , it 's seem to i should run next.js server . ( npm run build = > npm run start ) . so , should i run at least 2 node.js instance for running next.js based app ? < code >
in old projects i used getinitialprops to do my api requests , and this one did both when on the server and on the client-side ... i saw that now we should use getserverprops , but by the name it seems to me that when i 'm only on the client-side , when the user comes from another screen , it will not be executed on the client ... or will it be too ? an example : the details screen where i get all the data from a movie for example . thank you ! < code >
i am using getstaticprops and getstaticpaths and next build & & next export to deploy my site via netlify using ssg . however , i noticed after recently updating to next 9.3 that my pages that are using next/dynamic are no longer rendering those dynamically imported components . is it impossible to use next/dynamic with ssg and next build & & next export ? < code >
the page folder structure : if the language is english the url should be : /en/content/this-is-a-content if the language is hungarian the url should be : /hu/tartalom/ez-egy-tartalom any possibility to dynamically change the content folder name based on language in the export ? yes , i know the content folder can dynamic [ content ] , but same level there is another folder with same behavior . which causes the following : `` you can not use different slug names for the same dynamic path '' in older version i can set the alias folders to the exportpathmap . what are the options in the new version ? < code > /pages [ lang ] content [ slug ] .js
i think i might have found an issue with < url > but i could n't find any appropriate place to report it ! i was trying to find the < url > page via google as i could n't remember the domain but i could n't find it , so i tried the following google searches : site : < url > ( many results ) site : < url > ( 0 results ) `` design '' site : < url > ( 0 results ) quotes ( `` '' ) around a keyword mean must include . also tried site : < url > ( 0 results ) it seems like some pages on vercel.com are n't indexed by google which seems to be unintentional . pages like vercel.com/docs are indexed but pages like vercel.com/home or vercel.com/design are n't . reproducing use google with the following keywords : site : < url > `` design '' site : < url > site : < url > expected to see results for the relevant pages but got 0 results . < code >
is there an example of next.js dynamic routes using component class ? i 've read this part in next js docs : < url > and i found this `` principles '' : but why would i want to give statically bind ? i 'll need to check in my server-side if the id is valid no ? in which function should i check it ? at first , i thought of didcomponentmount but i 'm not sure anymore . < code >
hey , i 'm using next js for my own project and i use it with material table , when i create an element and redirect to my home page which contain my table , my element did n't show in my table ( next does n't call getiinital props ) , for the moment i need to refresh my page to see my new element in my table , should i get help please , just to understand why js import layout from `` .. / .. / .. /components/layout '' import link from 'next/link ' ; import cattable from `` .. / .. / .. /components/categorytable '' import { usestate , useeffect } from 'react ' const index = props = > { return ( < layout > < h3 > < div > < p > category < /p > < link href= '' /dashboard/categories/new '' > < a classname= '' btn btn-sm btn-secondary ml-3 '' > creer une categorie < /a > < /link > < /div > < /h3 > < cattable categories= { props.data } / > < /layout > ) } index.getinitialprops = async context = > { if ( ! context.req ) { return { data : [ ] } } const res = await fetch ( ' < url > { method : `` get '' , headers : { accept : ' * / * ' , 'content-type ' : 'application/json ' , 'access-control-allow-origin ' : ' * ' , mode : `` cors '' , } } ) const dt = await res.json ( ) return { data : dt } } ; export default index ; < code >
i was using next 8 when i installed next-routes to handle these routes . can i replace it with native next.js nowadays ? < code > const routes = require ( `` next-routes '' ) const routes = new routes ( ) .add ( `` invite '' , `` /invite/ : inviteid '' ) .add ( `` team '' , `` /team/ : teamid '' ) .add ( `` review/master '' , `` /review/master/ : reviewmasterid '' ) .add ( `` user '' , `` /user/ : userid '' ) .add ( `` login '' ) .add ( `` leaders '' ) module.exports = routes
i have a page i would like to statically render ( i.e . /page ) . on that page it is possible to set filters , which set the query strings in the url ( i.e . /page ? filter=a ) . in case someone would access an url with query strings he would get the statically rendered website , which does n't represent the filter . therefore i would like to force the preview mode in case query strings are used . is that possible ? < code >
bug report describe the bug it seems that the static generation feature is not properly supporting open graph meta tags . a 502 status code is thrown when trying to share the link over social networks for example . to reproduce go to the next blog starter < url > click any of the blog posts , for example < url > copy the url from the step above go to you twitter or linkedin page ( i prefer linkedin just because there 's a feedback that something went wrong ) paste the url form step 3 sample repo : < url > every page renders this component expected behavior i can see the preview of the link i pasted . screenshots linkedin link sharing error from vercel 's console the screenshot above is from my own blog but i believe that the blog-starter 's log will have the same as mine . system information os : macos browser : chrome ( but i believe it is happening in all browsers ) version of next.js : 9.4.1 version of node.js : 10.17.0 < code >
we want to return 404 status codes when a dynamic page ( ie /expense/ : id ) is not found . we are using next-routes for the routing and the data is fetched by apollo , thanks to the getdatafromtree helper . queries are plugged to components with the graphql helper from @ apollo/react-hoc . i 've read and tried the solution proposed in the spectrum chat , but it expects you to fetch the data from getinitialprops , and that 's not how things work for us : because we use graphql/getdatafromtree , the best moment to trigger this error is during rendering . we used to achieve this with this code , but it does n't work in newest versions ( for a good reason ) : the code as it is today : withdata ( where we do the getdatafromtree ) _app.js example of a page that uses the graphql helper i 've tried multiple approaches to fix the way we handle that , mostly inspired by the spectrum discussion above and some others in here , without success . my question is : what would be the best way to raise a 404 status code from the render or ( if not possible/too hacky ) should we revamp the way we fetch data in our pages ? < code > if ( ! process.browser ) { const err = new error ( 'not_found ' ) ; err.code = 'enoent ' ; throw err ; }
imagine you have a site with two different layouts with different css files . you ca n't import them both in _app.js because of css conflicts . and creating them as layoutx.module.css does n't work because they contain `` impure '' selectors to apply global styles . is there some way to have _app.js do a selective global import depending on the layout or route ? any other approach to this that i 'm missing ? < code >
when i sen a file and text to the api , it saves the file in the file system ( like in : public/news ) and takes it 's file path and stores it to the db ( like this : /uploads/news/ ( 1590330102136 ) -- anykey.png ) and the i just render this element : but after i do a next build and upload a new file with text ; it renders out the text but the image is giving me a 404 error , despite it having the exact same path as other images that were uploaded before the next build command < code > < div classname= '' news_card__image '' style= { { backgroundimage : 'url ( `` < cur > { path.join ( __dirname , props.imageurl ) } '' ) ' } } alt= { props.title } > < /div >
hey folks , i 've been struggling with an issue which i 'm not sure if it is the expected behavior . when i inject html using dangerouslysetinnerhtml and when i go to view source in the browser , the html element is empty although it is displayed properly in the ui . can anyone please confirm if i dangerouslysetinnerhtml , that is it not rendered server-side ? < div class= '' content '' > < /div > < code >
i know how to do that on the server side with node js ( with process.env.node_env ) , but not sure how this can be achieved on the browser . for context , i need to know this to be able to set my google analytics plugin to either debug in dev or ! debug in prod . any help ? < code >
hey , i 'm building an ecommerce like website using next.js and firebase , however i have a question for someone with more experience in next.js , as i 'm just starting out . when serving a product ( ie : product details page ) should i : grab all the products from the database using a firestore snapshot , store all of them inside react context ( or redux store ) and finally serve the product via a find/filter use /pages/api/products/ [ name ] .js and individually grab the product details on page level ( /pages/products/ [ name ] .js ) using getstaticprops with fallback : true ? what is the best practice for this use case ? or is there a better way to do it ? i 'm mainly concerned about seo and speed of course . many thanks ! < code > ... const { products } = usecontext ( firebasecontext ) const productdetails = products.find ( product = > product.slug === name ) ...
i am able to login the user and persist his session using the express-session package . now the issue i am facing is when i navigate from page x to page y how am i supposed to know if the session is still active since request , response parameters are available in getinitialprops only on the first load ( custom server ) . i am however able to find if the session is active on the server when apis are beginning called and can return a 403 back to the client . also , i am using redux which is difficult with next js cause i am not able to figure out how to persist data on the client ? < code >
i made a simple api that takes text and image , uploads the image to public/uploads/news and saves the file path ( example : /uploads/news/ ( 1590330102136 ) -- anykey.png ) , when in development everything works fine but after i do next build and next start everything works fine at first also , but when i want to upload something like an image and a text with my api ( which uploads it to the file system in public/uploads/news ) text from the api is rendered , but the background-image shows me a 404 error and tells me that the image does not exist , even thou i see it 's saved in the file system if i do a next build the image appears again this is the element i 'm rendering < code > < div classname= '' news_card__image '' style= { { backgroundimage : 'url ( `` < cur > { props.imageurl } '' ) ' } } alt= { props.title } > < /div >
as stated in title , in this case , is this ssr or ssg ? will their output be merged ? and how about getstaticprops and getinitialprops both exist ? thanks < code >
i 'm working on a pull request that changes the next.js core . i 'd like to be able to inspect the value of different variables at runtime . a console.log inside for example next.js\packages extuild\webpack\configlocks\css\loaders\client.ts does not work , and i 'd like to use the vscode debugger and set breakpoints . i 've noticed that the root of the project does contain a .vscode/launch.json file ( this suggests debugging is possible ) . running yarn dev does not work , i suppose because it builds the code and does n't execute it ? i 've read the contributing guide and the debugging guide ( that is meant for bugs inside my next.js app , not the core ? ) , but the contributing guide does n't say anything about debugging the core . any help with this would be appreciated . thanks in advance ! < code >
i 'm wondering if it 's possible to change the current page query without reloading it . i 'm asking this because i would like to access a query param from another component . here 's a preview of my code : < code > const router = userouter ( ) ; const handleclick = ( e ) = > { e.preventdefault ( ) ; router.replace ( { pathname : router.pathname , query : { job : title } , } , ' < cur > { router.aspath } ' ) ; } ;
using a simple next js set up ( same as custom-server-typescript but with an added public directory ) i am trying to build and run it within a docker container . i can get everything working with this dockerfile however my app requires a multistage build so i am trying to copy over the build assets with this dockerfile this appears to work just fine at first but files within my public directory are no longer being served when ran . i 'm wondering if i need to copy over some additional folders besides the dist and .next to get my static/public assets working . < code > from node : latest workdir /app copy ./package.json ./package.json copy ./yarn.lock ./yarn.lock run yarn install copy . . run yarn build cmd [ `` yarn '' , `` start '' ] # # build phase # # from node : latest as builder workdir /app copy ./package.json ./package.json copy ./yarn.lock ./yarn.lock run yarn install copy . . run yarn run build # # run phase # # from node : lts-alpine workdir /app copy -- from=builder /app/package.json . copy -- from=builder /app/yarn.lock . run yarn install -- production copy -- from=builder /app/.next ./.next copy -- from=builder /app/dist ./dist # do i need to copy something else from the build output here ? ? ? env node_env production expose 3000 cmd [ `` yarn '' , `` start '' ]
hello , the community ! i 'm implementing a multi-step form with submission between steps . that makes it impossible to use link component for navigation between steps . i use imperative router.push . i have a bunch of dynamic paths , that handle the regular path of a user , but for certain paths i want to show a custom page . for that , i added a more specific path that overlaps with the dynamic : so when a user moves from / [ country ] / [ type ] /step4 to the next step , i want nextjs to use more specific path / [ county ] /awesometype/step5 instead of / [ country ] / [ type ] /step5 . i tried the following , none works as expected : call router.push ( page , as ) ; with the most dynamic page . of course , it leads to this page to be opened call router.push ( as ) ; , where the as is the destination url . it tries to request the static page from nextjs because it is considered as the page name . then the entire page reloads and shows the target state . ❓ is there a known way to achieve the described behavior or it is considered bad practice ? < code > - [ country ] / - [ type ] / - step1.js - step4.js - step5.js - confirmation.js - awesometype/ - step5.js
hey guys ! today while developing a project for a client i just realized i could use [ type-of-page ] / [ slug ] .js , i was planning to have these ssg 'd but the getstaticpath does not provide any context for the request as in getstaticprops . so what i 'm trying to do is : my main reason for this is so my client can create pages on the cms and then next.js can catch it and generate the page . have someone encountered a case like this ? ps : while writing this it just came to my mind that i can just render them all ( which is not as optimized as i wish ) . < code > export async function getstaticpaths ( ) { const data = await getallrelatedpages ( / * [ type-of-page ] * / ) ; // 😔 this function would like to receive [ type-of-page ] param from the context as in getstaticprops const paths = data.map ( obj = > ( { params : { slug : obj.slug } } ) ) ; return { paths , fallback : true } ; }
after upgrading next js to 9.4.2 i 'm having issues with ag grid tables . the issue seems to be with the fact that @ ag-grid-community/core is 'implicitly ' available but i 'm required to include it in package.json as i 'm using yarn pnp . typescript gives me this error : so it 's trying to load a package as a sub-package of ag-grid-enterprise .... which i 'm guessing would work if i did n't have to include ag-grid-community/core in my package.json since it 's trying to load from that ? but i ca n't not have it there since pnp complains . i realize this is most likely an issue that needs to be fully resolved on the ag-grid side of things , but i 'm wondering if there is a way i can hack it for now in next.config.js where i can alter the webpack config to resolve the package automatically ? < code > import ( `` /users/nodeworks/documents/projects/crimson/node_modules/ @ ag-grid-enterprise/all-modules/node_modules/ @ ag-grid-community/core/dist/cjs/interfaces/imodule '' ) .module [ ] ' is not assignable to parameter of type 'import ( `` /users/nodeworks/documents/projects/crimson/node_modules/ @ ag-grid-community/core/dist/cjs/interfaces/imodule '' ) .module [ ] '
in my use case , i need https for the webcam ( getusermedia ( ) ) . i know it 's possible using a custom server.js but the docs say : before deciding to use a custom server please keep in mind that it should only be used when the integrated router of next.js ca n't meet your app requirements . a custom server will remove important performance optimizations , like serverless functions and automatic static optimization . i 've also read in some issues that vercel will not include https in the core . i do n't think i fully understand the implications of creating my own server.js , maybe you can help me with this . i 'm moving in from cra and preact which both make it simple to use https with a flag . would it be unreasonable to ask vercel to add a configuration option in which i can pass a certificate ? it seems to me that getusermedia ( ) is part of the modern web and it 's very limiting not to be able to test it . something like this : i 'm open to any other suggestions , i just need to use the camera and test it in dev . < code > `` scripts '' : { `` dev '' : `` next -https path/to/my/cert '' }
i call an api route in my getstaticprops . how do i make sure the server is started which serves the api route ? it 's unreachable . i want to use next export later . < code > export const getstaticprops = async ( ctx : nextpagecontext ) = > { const res = await protect < axiosresponse , axioserror > ( axios.get ( `` < url > ) ) let entries : blogentry [ ] = res.ok ! .data return { props : { entries } , } }
i have started doing som web dev for my personal project and figuring out how to implmenet a dark mode for the next.js with styled-jsx . i have n't come across any exmaples . any idea help me figure out this would be of great help . < code >
i have a markdown blog running with the mdx plugin . i want to create a json with some data from all the blog pages so i can implement a basic front-end search . is there any way that i can hook into what nextjs uses to create its pages or should i build something custom for this ? < code >
feature request is your feature request related to a problem ? please describe . i created a website where you have a link component which goes to a new page ( in /pages directory ) . by default the page scrolls to top , this is fine by me . but i would like to trigger some animations after the scrolling is finished . i read the docs and could not find a way to do this ? describe the solution you 'd like it would help me if there was another event on the next/router for example : `` routechangescrollcomplete '' describe alternatives you 've considered triggering the animations with the useeffect hook triggers them too early , and so does the routechangecomplete event of the next/router ... additional context you can see the behaviour by clicking the cv link on my website : < url > . the github repo behind this website is : < url > < code >
i have a navigation component that needs to lock the body scroll with overflow : hidden when the navigation menu is open . i 'm converting my project from styled-components to css modules and i 've come across this piece . how can i apply styles to the body conditionally from my navigation component that has a style file navigation.module.css ? i 've read that global styles that apply to the body or # __next are only possible by importing a stylesheet into _app.js . but how would i manipulate these styles from a child component ? i 've read through pretty much all the content there is about css modules and next.js . @ timer mentioned in an issue that vercel is refactoring their styling to use the built in css support too . they are a large company so they must have solved this problem somewhere . i 'm looking for some advice from people who have solved this issue . < code >
hi , just completed next.js tutorial and deployed on vercel.com thought the experience was excellent . i am now looking for a good example of a next.js app using bootstrap4 . i appreciate any suggestions < code >
hi all , i have a site composed of the following : product pages accessible to both logged-in and logged-out users a navbar with 'log in ' or 'log out ' state based on the user session in the past , i 've run into strange behaviors when server-rendered dom does n't match the client-rendered dom ( seems like the trees get merged somehow ) . however , i want to ssg my product pages and also have them accessible logged-in . what 's the best-practice way to ssg the page with the logged-out state , then replace it client-side with the correct state without doing any sort of diffing ? ( i realize this will cause render flash , but seems like the only way ) . thanks for the help ! < code >
hi all , i 'm using nextjs targeting 'serverless ' and i 'm trying to find a solution for including a compiled library in my final bundle . my problem is with a route api and the library tesseract-js where i need to specify a path for the file that was included in the node_modules but with the optimization and bundling in one file the library ca n't find it , i can specify a path for the file but i need to copy the compiled file on my final build any idea how can i achieve this ? < code >
this aplication is made with nextjs 9.3 < url > i have ssr in some pages , every now and then i have an error in the api , or the user himself has no answer for being offline , leaving the `` app '' screen , how could i handle this ? repo : < url > < code >
i am deploying a next js application on ec2 t2.micro instance via docker . 'next build ' command takes a long time & i suspect with increasing page numbers it will probably stall as there is only 1 gb ram available on a t2.micro instance . one possibility is that i run 'next build ' on my local machine and then push .next folder to the ec2 instance via git , that way i can skip the 'next build ' step on the instance itself . is this is reasonable course of action or 'next build ' should be run on the ec2 instance ? my docker file is as follows : my relevant docker compose section is : also as the ec2 instance deployment is production , please suggest any changes in the docker file that my not be required in prod , such as the volume creation . < code > version : ' 3.2 ' services : webapp : build : context : ./ dockerfile : dockerfile image : my-web-app container_name : webapp ports : - 3000:3000 volumes : # to sync file changes . - ./ : /app # to not break node modules . - /app/node_modules # for next build . - /app/.next restart : unless-stopped networks : - app-network from node:10.15.3-alpine run apk add -- no-cache tzdata env tz australia/sydney # create app directory workdir /app copy package * .json /app/ # installs everything from package.json run npm install # will copy all files except node_modules copy . . # building app , ( can this be done locally & push .next folder on instance ) run npm run build # even though port is being exposed it will # be overridden by docker-compose port expose 3000 cmd [ `` npm '' , `` start '' ]
i want to have a few pages generated statically and a route at /app which is a client-side react app ( no need for seo ) . in gatsby there is gatsby-plugin-create-client-paths is there an equivilant / a solution ? bonus points if there is n't any noticable page reload < code >
i am trying to reproduce a bug in codesandbox but i came to the conclusion that it must be performing customisations on top of the next dev that interfere on the behaviour i want to reproduce . i noticed that the exact same code in my machine would show the prerendered page badge , but in codesandbox it would not . checking window.__next_data__ confirms my suspicions . codesandbox : dev machine : why are n't autoexport and nextexport present in any of the codesandbox exports ? < code >
i 'm new to next.js ( i use 9.4 ) and currently i try to get an better understand on how it works . in my /pages components i use getstaticprops and getserversideprops . from the documentation i understood that these never run on the client . getstaticprops is used when it is rendered statically and getserversideprops is used on every request . besides these functions i use getinitialprops in my extended app component in _app.js . i use it in order to fetch the localization strings and pass it to the components . i would assume that getinitialprops runs only once during build and then the information is made available to the pages statically . is that assumption correct ? < code >
bug report describe the bug when using the parsed query object from userouter the initial value is always { } . when a next.js app is opened with url query parameters it should instead return the correct query , otherwise some imo unnecessary state logic has to be built around . i would imagine that it should be possible to read and parse the url query before first render , so that userouter can expose the correct query on first render . to reproduce steps to reproduce the behavior , please provide code snippets or a repository : go to < url > open browser devtools console you should see 3 logged items : initial query : { } subsequent query : { } subsequent query : { abc : `` def '' } the corresponding codesandbox is here : < url > expected behavior the initial query should already contain { abc : '' def '' } system information os : any browser : any version of next.js : 9.4.2 version of node.js : probably does n't matter additional context i 'll have to read a token from the url when the application launches on any route and decide ( based on the token and its validity ) wether or not a redirect should happen . i could solve this with some additional state ( something like istokencheckpending ) , but this is surely a workaround and does n't compliment the overall ergonomics . < code >
uikit dom added links to area-expanded props . how to avoid this kind of dom conflicts ? because uikit library using the data-attribute for adding some classes for elements . example : grid actually adding the classes etc . actual error : warning : failed prop type : link : unknown props found : thanks . < code >
our project has around 50 pages and multiple components . doing any ui/text changes to any component , fast refresh takes around 30 seconds . each time i make changes , on the terminal i can see it 's compiling ... for so long and then refreshes the component . any idea what 's happening ? i 'm on 9.4.1-canary.5 and here is my next.config.js < code > // next.config.js const withcss = require ( ' @ zeit/next-css ' ) ; const withsourcemaps = require ( ' @ zeit/next-source-maps ' ) ; const withoptimizedimages = require ( 'next-optimized-images ' ) ; const withbundleanalyzer = require ( ' @ next/bundle-analyzer ' ) ( { enabled : process.env.analyze === 'true ' , } ) ; const withtm = require ( 'next-transpile-modules ' ) ( [ 'common ' ] ) ; // pass the modules you would like to see transpiled module.exports = withbundleanalyzer ( withtm ( withcss ( withoptimizedimages ( withsourcemaps ( { experimental : { granular_chunks : false } , compress : true , devindicators : { autoprerender : true , } , assetprefix : process.env.assetprefix ? ' phofurl : `` , webpack : config = > config , // env : { // stripe_key : process.env.stripe_key , // } , } ) , ) , ) ) , ) ;
hei i work with sass and there with the css modules part . in my next.config.js i have this to import my variables and mixins global . is there any issue in my config ? because the mixins and variables do not work . i get this error < code > const path = require ( 'path ' ) ; const dotenv = require ( 'dotenv ' ) ; dotenv.config ( ) ; module.exports = { sassoptions : { includepaths : [ path.join ( __dirname , `` app/styles/_variables.scss '' ) , path.join ( __dirname , `` app/styles/_mixins.scss '' ) ] , } , usetspathsasalias : true , publicruntimeconfig : { // will be available on both server and client api_url : process.env.api_url , app_url : process.env.app_url , web_url : process.env.web_url , cms_url : process.env.cms_url , ga_tracking_id : process.env.ga_tracking_id , } , } ; error - ./app/styles/_global.scss ( ./node_modules/css-loader/dist/cjs.js ? ? ref -- 5-oneof-6-1 ! ./node_modules/next/dist/compiled/postcss-loader ? ? __nextjs_postcss ! ./node_modules/resolve-url-loader ? ? ref -- 5-oneof-6-3 ! ./node_modules/sass-loader/dist/cjs.js ? ? ref -- 5-oneof-6-4 ! ./app/styles/_global.scss ) sasserror : no mixin named gradient-primary on line 11 of /users/yannickwittwer/www/projectname/app/styles/_global.scss @ include gradient-primary ;
we are under development for amp page . we use hybrid option for our pages where we have separate components for amp pages . we are trying to make amp-ad work as per documentation on amp.dev . we are only seeing blank div and no ads get render at all . we are using google adsense and followed every bit of instruction . thanks in advance < code >
hi , i 'm working with canvas and in someplace in my code i needed to make an instance of image : const e = new image ; but it says that image not exists , after some searching on the internet the reason might be that it tries to run in on the server-side ? < code >
this is my use case : my website buttons have a default button colour of green my website can receive a query string ? buttoncolour=red this query changes all of our buttons to red across the app expectation : the colour is persisted across the application , even when i navigate between pages the colour is persisted when the i refresh the page reality : the colour is persisted across the application , even when i navigate between pages the colour is not persisted when i refresh the page , as navigating between pages wipes out the query strings in the url any ideas ? i do n't really want to save this queries in cookies < code >
i would like to know about how to use 'fetch ' without installing another package in express server . i think it should but can we ? currently i 'm using axios package and get rid of it from project if i can use directly 'fetch ' from nextjs 9.4 . < code >
hello , we got strange question . we had rest api and that gives us html content but somehow we need to insert 1 div into the rest api content . example : thanks . < code > < div > < div > come from api 1 < /div > < div > our div from react component < /div > < div > come from api 2 < /div > < /div > < div > < div > come from api 1 < /div > < div > come from api 2 < /div > < /div >
currently i have some kind of data fetching for each of my page via getstaticprops . this data is provided to the client and my page can get rendered . during render a lot of further data need to get fetched . this are small pieces of data which require an api call . i do this by using useswr . the problem is that this small pieces are not yet available on the static rendered page . when the server send the page to the client this information is not available , the have to be fetched by the client . what i would actually like to do is , that when the server renders the site , the server also fetches the small pieces of data , so that they are rendered . then this data need somehow to be collected in a store and needs to be send to the client , so that the client do not need to fetch them . actually this is how i solved this issue with another framework . all the data is fetched on the server and then i send it as part of the fully rendered page to the client , after hydration the client pick ups the data and stores it in a redux store . what would be a good approach to do this in next.js ? < code >
i 've built an api using next.js ' api functionality . it 's great when i need to call it client side as i can just call /api/route/ and i do n't have to worry if it 's running in localhost or on my server as it will work either way . however when calling it on the server , in getinitialprops for example , i need to use an absolute url or it wo n't work . my current solution is something like this : this gets really verbose , is there a better solution i 'm missing ? < code > const pagerequest = process.env.node_env === `` production '' ? ' < url > : ' < url >
hey guys , i just published a new video on youtube about the tools i use to make my nextjs projects , while building a job-finding app . hope you 'll enjoy it : ) < code >
i follow with this `` < url > i config 'next.config.js ' with this code 'const nextbuildid = require ( 'next-build-id ' ) const isprod = process.env.node_env === 'production ' // enable importing of css stylesheets const withcss = require ( `` @ zeit/next-css '' ) const withimages = require ( 'next-images ' ) / * gets the base_path from the command used to start this app . if base_path is specified but it does not start with a `` / '' then add it . * / function getbasepath ( ) { const basepath = isprod ? '/purchases/ ' : `` console.log ( 'process.env ' , process.env ) console.log ( 'process.env.base_path ' , process.env.base_path ) console.log ( `` getbasepath ( ) : isprod = `` + isprod ) console.log ( `` getbasepath ( ) : basepath = `` + basepath ) return basepath } module.exports = withcss ( withimages ( { generatebuildid : ( ) = > { if ( process.env.source_version ) { return < cur > { process.env.source_version } } else { return nextbuildid ( { dir : __dirname } ) } } , assetprefix : getbasepath ( ) , publicruntimeconfig : { basepath : getbasepath ( ) , } , } ) ) ; ' and i built success on the server , but when access to url found 404 error all url sample pattern url < url > < url > < url > could you help me with this issue ? < code >
hello ! i am experiencing an issue where builds triggered by the now ( /vercel ) git integration error each time . the specific build problem does not seem to be the issue though , because running now -- force with the now cli builds my site successfully . this leads me to think the main problem is cache related . i have seen mentions of this issue before , with recommendations to remove the git integration ( from vercel admin ) and re-instantiate . is this still the best way or are there any alternatives ? < code >
i want to use next.js to generate all of the pages of my web site statically . however i need to modify the structure of my document depending on the page that i am working . i want , for example , to load the facebook sdk ( according to facebook must be located after the opening < body > tag ) using one language in one page and other language in the other page . i also want to modify the lang prop of < html > depending on the page . if i modify the _document.js i have the same document for all my pages . can i use different document configurations for different pages maintaining them static ? < code >
hi , i 've been using next.js for a while now . dope stuff , kudos to the team . though i think there 's something i do n't quite understand for builds . so i ca n't run next build in production without getting : so i have to run the command in development and subsequently run it in production for it to do what it should . but obviously , that 's impractical for my ci setup . as i said , i 'm sure there 's something i do n't quite understand but i 'd really appreciate some insight and/or advice . thanks in advance ! < code > > build error occurred error : could not find a valid build in the ' < cur > root/src/.next ' directory ! try building your app with 'next build ' before starting the server . at server.readbuildid ( < cur > root/src/node_modules/next/dist/next-server/server/next-server.js:971:23 ) ...
do n't know if it 's nextjs related or not . i 've searched around and do n't see anything here on it and tried so that suggested updating node ( i did ) , removing package.json , i did . any suggestions ? i get this warning exactly : < code > [ wait ] starting the development server ... [ info ] waiting on < url > ... browserslist : caniuse-lite is outdated . please run next command 'npm update '
i am currently automating my deployment process with github actions which i am stripping off all the devdependencies but kept on having issues with next plugins not installed . so i want to know if those plugins are required after build < code >
i 've noticed that i have a runtime javascript error on any route in my app , the `` npm run build '' fails with an error . what intelligent statement can i make if `` npm run build '' runs without an error ? < code >
hi all , i 'm having an issue where links in a custom express server with the experimental basepath are only working in dev . when doing a production build , the basepath is not being pre-pended to the pages . here 's a repo with a minimal setup to reproduce the issue . < url > any help will be greatly appreciated ! < code >
hello guys , when i use proptypes for components , i am not able to any warnings or errors . does anyone know how to use proptypes in a next app . please help me out ! < code >
we had a nextjs app on v9.3.6 packaged with the pkg . we have 1 server side rendered page and 3 static pages . when we upgraded to version 9.4.0 the app seemed to worked perfectly on dev mode . but when we packaged using the pkg we could n't access the 3 static pages anymore . we got a 404 when we tried . we converted those static pages into server rendered by adding an empty getinitialprops into them and the problem was gone . we did n't get 404 when we tried to access them . this is not a solution that we liked and also did n't work well for our custom 404 page because of this issue has anybody faced something similar ? any help would be much appreciated < code >
question supposi i have a component : and i 'm resolving @ best-lib/fruit through a webpack alias , should i expect my server to also be able to resolve @ best-lib/fruit ? in other words , does server code use webpack aliases , or should i be using babel import transforms ? alternate angle on the sasme consideration , what if i 'm writing an api route in next , and i want a getbananas resolved in both an api route and a ui route -- will webpack aliases do all the good stuff ? < code > import getbananas from `` @ best-lib/fruit '' export const fruit = > < pre > { getbananas ( ) } < /pre >
greetings . i 'm porting an application that has a python 2.7 back standalone rest service . it only exists to service the frontend ( which has now been fully ported to next.js ) . i 'm starting to look into porting the rest service . i 've leveraged next.js api routes for a few things and it seems promising for my needs . however , i really like rest frameworks like fastapi ( python 3 ) . is there a powerful rest api framework for node ( preferably typescript ) that plugs in easily with next.js api routes ? i 've looked a bit at nest.js but could n't find anyone using next and nest together easily . < code >
i am working on a blog using next ssg . i want to have a folder the will contain images and a .md file like content.md . the images are not showing . how can i load images directly from the folder . i do n't want to move my images into public folder . < code >
i recently tried to make my project work with the new environment variables support from 9.4. i removed the next.config.js file but it 's not working . i have a regular .env file with variables that i want to keep private . i 'm probably missing a concept here , but when i start my app in dev with next dev , i get the following error in my browser : `` uri malformed , can not be parsed '' . < code >
i 'm working on a new nextjs project , and it works great on my macbook , but on my windows computer i 'm getting the following error . the reproduction steps are simple . yarn create next-app - > select default cd [ project-name ] yarn dev > navigate localhost:3000 error i 've spent probably 2-3 hours trying to solve this , and am going a bit crazy . any insight and suggestions would be appreciated . running node v12.13.1 < code > module parse failed : unexpected token ( 5:4 ) you may need an appropriate loader to handle this file type , currently no loaders are configured to process this file . see < url >
i have deployed the next app but somehow there was some issue and i got the error log which contains the code on production . i am on the latest nextjs version , i am using the following command to build the app and run the app . so i doubt that it 's not properly built and still behaving as development mode . npm run build - > next build npm run start - > set node_env=production & node start-server.js < code >
this error does n't appear and working in version 9.3.6 but when i upgrade current next version to latest , then i got the error . is it my coding mistake ? here is my code these 2 files basemap.js map.js . basemap component is map component 's child < code >
hi all , i am developing a pwa and using the next-css plugin . when the page is loaded for the first time , the page without css is displayed for a second , and then css is applied . how to avoid this ? is this regarding media query css ? because css i have written is @ media screen and ( min-width : 769px ) { .logo { max-height : 12rem ; } .background { background-image : url ( '/static/background.jpg ' ) ; } } < code >
hey there , i got a problem with next.js on firebase functions/hosting and was wondering why modules used in getstaticprops ( ) are bundled in the final static output . in my getstaticprops ( ) functions i load , transform and store images from a headless cms . i thought , next will do this only during build phase and only once . after this all the code within the getstaticprops ( ) is not required anymore . but if i go to the dist folder i can see that there is a pagename.js where all the modules from my getstaticprops ( ) are required . the firebase problem : testing , building and even emulating with firebase emulators works great . only the deployed version throws internal server errors , complaining that a required module is missing . and that module is used within getstaticprops ( ) , that 's why i 'm having a really hard time to debug this issue . can someone explain what i 'm doing something wrong ? : ( < code >
has anyone successfully been able to use ngrok to tunnel to a mobile device for a project with a stack that includes docker and next.js ? our experience has been that all client-side requests fail from mobile devices and external laptops , but server-side request work properly . this is making it impossible to locally develop and test on mobile before we deploy . the end goal is a local development environment that allows us to test on a real phone ( emulators and chrome dev tools are not sufficient ) . i have had success doing this in other projects but this is the first time i have used next.js and it does not appear to work . any advice would be welcome . < code >
hi , i try to run multiple build 's and it 's work . my build yarn concurrently `` site=site1 next build '' `` site=site2 next build '' my next.config.js now , i need change dir in run time by request domain , because site1 and site2 respond to the same server i try this , but do n't work ... < code > const customserver = ( ) = > { const server = express ( ) ; const setdirectory = ( ) = > { return ( req , res , next ) = > { const site = converhostbysite ( req.get ( 'host ' ) ) ; express.static ( 'build/ < cur > { site } ' ) ; } ; } ; server.use ( setdirectory ( ) ) ; return server ; } ; const nextconfig = { env : { environment : process.env.environment } , distdir : 'build/ < cur > { process.env.site } /.next/ ' , ... const site = 'site1 ' ; // i need this value dinamic by request domain const dir = './build/ < cur > { site } ' ; const dev = process.env.dev_server === 'true ' ; const app = next ( { dev , dir } ) ;
i can not get the reactcomponent property when i do a regular svg import . for example : import imagesrc , { reactcomponent as image } from './image.svg ' ; imagesrc would end up with a base 64 data url but the reactcomponent will be undefined . normally , the import value for reactcomponent is defined correctly on regular react project but does not work in next @ 9.3.0. i have attempted adding @ svgr/webpack , svg-inline-loader , react-svg-loader , next-react-svg and file-loader to my next.config.js file with no luck . < code >
imagine the case when a user submits their login form . i want to be able to redirect on the api route on the server to a logged-in page . how do i achieve this ? right now , browser sends a fetch with post to the api router /login . the api returns a res with status 200. i check if response.ok ? then i do a router.push ( '/logged-in ' ) < code >
we have extracted some heavier components into separate chunks using dynamic imports ( for example , a quick search component ) . we still render these on the server to prevent content from shifting around . using tools such as webpage test we notice that js execution appears to be waiting on these components before rendering them when getting that page from the server . when putting ssr false this no longer is the case . is this the expected behavior , as i would have assumed nextjs would wait with hydrating that specific part of the application until the chunk is available , but still execute the rest of the application . if this is the expected behavior , how would you improve the startup time of an app with some heavy components , as dynamically loading them does not help when the user lands on a page with such a component . < code >
using the following innext.config.js when i go to < url > i get redirected to < url > but i 'd expect to be redirected to < url > when i go to < url > i do n't get redirected at all and it displays a 404 page . am i doing something wrong ? i want that to redirect if the url does n't start with /fr or /en . < code > experimental : { redirects ( ) { return [ { source : '/ : lang ( ( ? ! fr|en ) ) / : path * ' , destination : '/api/autoredirecttolocalisedpage ? path= : path * ' , // permanent uses 308 , otherwise uses 307 - see < url > permanent : process.env.app_stage === 'production ' , // do not use permanent redirect locally to avoid browser caching when working on it } , ] ; } , } ,
it is possible to parse request headers in app.getinitialprops to detect device type but it makes all pages ssr which is pitfall . i want device-specific layout ( possible with ssr ) , also possible with static gneration but there are certain animations and styles that render on first render and then client-side code kicks in and renders again which is bad for module splitting and ux . any ideas ? < code >
hi there , i am new to nextjs and attempting to migrate my cra project to it . stumbled upon an issue with asset loading when using dynamic routes . images and fonts , when loaded in a route component , lets say home.tsx , are working correctly and the url would be something like < url > however when using a route such as search/ [ param ] .tsx , the base url for all asset imports changes to /search and therefore does not point at the public folder . looks something like this - < url > all these assets are imported at the app level , eg in _app.tsx could someone please explain what i 'm doing wrong in terms of setting up this route ? any help is much appreciated . thanks ! < code >
hi ! from the announcement blog post of version 9.3 i can see that the framework will now handle split bundles into module/no-module versions , with polyfills added to the no-module version . question is it still necessary to add own polyfills/transpile code with babel afterwards ? at the moment , we use next-transpile-modules to transpile specific node-modules , and use this babel.config.js to transpile out application code : will this actually make the situation worse ? would appreciate to have some information about this topic ! we need to support ie11 🙅‍♂️ . documentation it would be nice to add the topics transpiling and polyfilling to the next.js documentation . i would like help with this for sure if someone who knows more about this will point me to the correct resources . thanks for the great work with the new update , keep it up 👍 < code > module.exports = { plugins : [ ] , env : { development : { presets : [ `` next/babel '' ] , } , production : { comments : false , presets : [ [ `` next/babel '' , { `` preset-env '' : { debug : true , usebuiltins : `` usage '' , } , `` transform-runtime '' : { } , `` styled-jsx '' : { } , `` class-properties '' : { } , } , ] , ] , plugins : [ `` @ babel/plugin-transform-arrow-functions '' ] , } , test : { presets : [ `` next/babel '' ] , } , } , }
i 'm forcing authentication in my getinitialprops function in _app.js . if auth token does n't exist , i stop rendering the page and do a 302 redirect to the login page . i 'm trying out getstaticprops , and this prevents my _app.js getinitialprops function from running . besides running a custom express server wrapping my next.js app , is there a way to take advantage of getstaticprops but also prevent access for unauthenticated users ? < code >
i am trying to implement react-infinite-scroller into my nextjs app . does anyone know of any good tutorials or examples to share ? i got stucked at state management . < code >
bug report while using router.query , i 'm unable to select query values which are contained within square brackets describe the bug while receiving a response from an oauth provider , i receive a query string with an access token , token type and expiry . while the first parameter is named normally ( access_token ) the others are encapsulated in square brackets ( [ expires_in ] ) because of this , i 'm unable to select them . to reproduce query string is different depending on supplier router.query.access_token = works router.query.raw [ expires_in ] = does not expected behaviour i should be able to select query parameters which are wrapped in square brackets , same as any other parameters . if needed , i should be able to supply a string to router.query.raw [ access_token ] as to be able to select such params screenshots na system information os : [ macos ] version of next.js : [ 9.3.6 ] additional context if there is a way to do this already , please let me know . < code > code : router.query = { access_token : some string raw [ access_token ] : some string raw [ token_type ] : bearer raw [ expires_in ] : some number }
hi , i am trying query database in getstaticprops , it worked ok. but i wonder can connection string run on client too ? : < code > import mongoclent from 'mongodb ' ; // i wonder is this import safe ? we do n't want client side get our connection string , right ? const mypage = ( props ) = > { //render page } export const getstaticprops = async ( context ) = > { //import mongoclent from 'mongodb ' ; // can i put in here ? const products = mongoclient.db.collection ( `` product '' ) .find ( { } ) ; return { props : { products , } , } ; } ;
bug report describe the bug hi , how can solve link with / ? example : i goto < url > = > it will work but with < url > = > not found : s after products/ [ item-id-can-be-here ] is there any idea to solve all link for this ? to reproduce expected behavior goto url abc.com/products * * / * * and we will get abc.com/products without error 404 < code >
i want to have a page that is render staticlly and dynamiclly . the reason i want to do this is because i want to have the http cache offer a stale-while-revalidate strategy . if user vists / [ .. slug ] i want to send them the default page ( and the api request will be made on the client ) . the next visitor will get the cached version so they can skip the api request , but will again update the content after the request has been returned . in addition , i do not want the client to call on routing getserversideprops ( ) over http , i want it to fallback to it 's client-side request . to put it another way , i want to force static generation , but when requested through the server , i want it to get the props . is there a way to do this ? i thought about using the fallback option on getstaticpaths ( ) but i do n't actually want it to generate new html pages , i just want it to run getserversideprops ( ) if that is present . < code >
hello there - i have a custom server i 'm using with nextjs for the client-side frontend . i 'm trying to have my code reload quickly during development . from # 791 , nodemon seems to be the solution for the server code . however , to use any changes in the client-side frontend in pages/ , it seems i still need to do next build -- - which is achingly slow for me . is there a configuration that achieves the combination of next dev for the frontend changes and nodemon for the custom-server changes ? < code >
hello guys , i am using < url > with express proxied through nginx mostly because of custom routing . when i build and start the server , i am able to view the page on < url > but when i deploy it to the cloud , i am getting error 500 on static pages . is there anyway i could use automatic static optimisation with custom server . thank you < code >
the docs clearly state before deciding to use a custom server please keep in mind that it should only be used when the integrated router of next.js ca n't meet your app requirements . a custom server will remove important performance optimizations , like serverless functions and automatic static optimization . is using the custom server for additionally providing an api the right thing to do or would it be better to create the server completely independent from next.js ? since lots of the pages i 'm going to create will be server-side rendered i thought it might be a good idea to integrate the api directly into the next.js app , but everytime i read this statement i become unsure . < code >
hey guys , i like how nextjs has it page routing system with file names . one thing i am trying to figure out is how to send data to another page without it being seen in url params and not using redux . < code >
current apollo+api routes example is written in js : < url > can someone make a ts version of this example ? i 'm specifically interested in how to rewrite this , so eslint + ts would n't throw any errors : i 've tried to use : const { schemalink } = await import ( 'apollo-link-schema ' ) ; but this causes issues with client bundling , it will be bundled in a final bundle no matter the condition typeof window === 'undefined ' , but with require ( ) it does work as intended . < code > // eslint-disable-next-line @ typescript-eslint/explicit-function-return-type const createisomorphlink = ( ) = > { if ( typeof window === 'undefined ' ) { // eslint-disable-next-line @ typescript-eslint/no-var-requires const { schemalink } = require ( 'apollo-link-schema ' ) ; // eslint-disable-next-line @ typescript-eslint/no-var-requires const { schema } = require ( ' .. /pages/api/graphql ' ) ; return new schemalink ( { schema } ) ; } else { // eslint-disable-next-line @ typescript-eslint/no-var-requires const { httplink } = require ( 'apollo-link-http ' ) ; return new httplink ( { uri : process.env.api_url , credentials : 'same-origin ' , } ) ; } } ;
i am looking to write a plugin to inject the meta tags needed for a pwa into the head . i have over 200 lines worth of meta tags and it looks messy in my _document.tsx . i have seen the next-plugin-google-analytics that injects into the head too . there does n't seem to be any documentation about how this works ( there is no index.js for example ) and the readme says it 's still experimental . my question is : what 's experimental about it ? can i write a plugin just like it and use it ? all my plugin needs to do is inject into the next.js head inside the document . < code >
both english and next.js are beginners . sorry . i want to refer to cookies on all pages . the library for using cookies wants nextpagecontext . in getinitialprops in _app.tsx , the type of context is appcontext instead of nextpagecontext . is there a way to access cookies using nextpagecontext on all pages ? < code > myapp.getinitialprops = async ( ctx : appcontext ) = > { const token = parsecookies ( ctx ) [ 'api_token ' ] // = > error : argument of type 'appcontexttype < router > ' is not assignable to parameter of type 'nextpagecontext ' . store.dispatch ( authslice.actions.login ( { token : token } ) ) const appprops = await app.getinitialprops ( ctx ) return { ... appprops } }
i am using 9.3 version and when i click the browser back button in the mi note 6 pro phone browser , it just keeps on loading . routechangestart is triggered but not routechangecomplete or routechangeerror . this is happening when the browser is trying to go back to the page which uses getserversideprops i think . is there any place that lists the browsers supported by next js . < code >
hi there ! this might be a very left-field requirement , but currently i 'm working on a site that contains some pages that only require server-side rendering . for instance , some screens contain a html < form > and < input type= '' submit '' > buttons that must do a http post to the server ( like more traditional web 1.0 applications ) without any javascript running in the browser . so , it would be nice to have the browser only load the html and css it needs for that initial paint , since we know the button press will result in a full post-back and page refresh anyway . this would save us several hundreds of kilobytes in the initial download from our servers . unfortunately , it appears that every page in the application also loads up js chunks and framework code to the browser , despite the delivered content not needing any client-side functionality . i 've been through the documentation a few times and ca n't see any way of doing this whatsoever . note that creating a static-site is also not an option since some data must be loaded up at run-time before the html is rendered . in these cases we 're essentially using nextjs as a rich templating engine . is there a way that we can turn-off any client-side rendering , or only have server-side rendering enabled in a project , or even better within just some pages of a project please ? any tips or suggestions would be greatly appreciated . thanks . < code >
well it was fine in 9.4.0 i changed to 9.4.1-canary.5 to get the hot reloading solved , while hot reload is fine now the env vars have stopped working : - ( < code >
hi folks , basically what i want to do is build a dashboard . i want to statically generate the placeholder content , and then on the client side hydrate it with actual data from a graphql server . eventually authentication will be added . ( so basically the zeit dashboard approach , if i 'm correct ) . at the moment i 'm playing with swr which seems to do the job . but of course i also want to do mutations , and a lot of articles out there suggest apollo is a better fit for that task . so i started looking through the apollo examples , but i believe none of them are up to date yet with the new getstaticprops/getserversideprops ( # 11014 ) . so at the moment i 'm wondering 2 things : is apollo indeed the best ( or let 's say , better than swr ) tool for the job , and why ? if i where to use apollo , what would be the approach to succeed in this goal of statically serving a placeholder and hydrating on client side ? if somebody could point me to , or give , some reading material that would be great ! < code >
hi , does anyone know of an up to date guide to using aws amplify and nextjs ? is it even possible with graphql and ( cognito ) auth . i 've gotten a variety of errors from css issues with aws-amplify-react to not being able to figure out how to have public and logged in pages . any guides , tips , pointers are appreciated . thanks . julio < code >
hi , i have built my solution around this example - < url > that makes use of an hoc ( withapollo ) to add the apolloclient to the page . now on the page , if i want to use getserversideprops , it is not possible because the two can not work together . any suggestions ? if i keep using getinitialprops on my pages , is it a problem ? < code >
i 've noticed the componentdidcatch method is now deprecated . < url > but , it 's still used in the with-sentry example : < url > should we stop using it ? i 'm wondering because i 'm also using sentry with the following code : is the above way outdated ? do you recommend a new way of catching errors as of next.js 9.3.6 ? < code > componentdidcatch ( error : error , errorinfo : errorinfo ) : void { // eslint-disable-next-line no-console console.debug ( '_app.componentdidcatch - unexpected error caught ' , error , errorinfo ) ; sentry.withscope ( ( scope ) = > { object.keys ( errorinfo ) .foreach ( ( key ) = > { scope.setextra ( key , errorinfo [ key ] ) ; } ) ; sentry.captureexception ( error ) ; } ) ; // this is needed to render errors correctly in development / production super.componentdidcatch ( error , errorinfo ) ; }
i have a simple project with monorepo setup . when i try to use/import a shared module inside web next js project am getting the below error please help < code >
i have my simple application that use to work with getinitialprops , following the recommendations on the doc page , i changed it getstaticprops and getstaticpaths . the problem now is , while bot the two functions get executed , the new props returned by getserversideprops , getstaticprops does n't get passed unto my page/component . i have a _app.js with little implementation of getinitialprops like below the above use to work for me and the new props from getinitialprops get passed . however , it does n't work with getstaticprops and getserversideprops , please how do i enhance my implementation to allow passing of such props ? any hep will be appreciated . < code > class myapp extends app < myappprops , { } > { static async getinitialprops ( { component , ctx } ) { return { pageprops : component.getinitialprops ? await component.getinitialprops ( ctx ) : { } , } ; } render ( ) { const { component , pageprops , router , store } = this.props ; const persistor = persiststore ( store ) ; return ( //some providers etc . < component router= { router } { ... pageprops } / > ) } }
hi , i have been trying to learn nextjs for a project , i have been told to make sure the project is web scrapable , and has dynamic titles , from h1- h4 , i read up on next/head and was able to integrate it for seo purposes , but i was told its still not fully web scrapable . i do n't know much about this and the google searches are confusing me , i 'd appreciate if anyone could help me in this , what else should i include in the project ? < code >
my app seems to be able to access environment variables just fine when i start the app with npm run dev , but it does n't have access to it when i run npm run start . i set the env vars using export x=y on linux any idea why ? am i missing a step ? < code >
upgrading to next 9.4.0 , i had to remove all environmental variables in next.config.js . but i am unable to access the env variable on the client . console logging process.env logs the variables on the console but logs undefined on the browser < code >
does fast refresh work for components located outside the root of the project ? i have the following setup : if i make a change in the web folder i get the new fast refresh , but changes in otherlib/components cases a full page refresh . < code > - web - pages - components - otherlib - components
bug report describe the bug hello ! i upgraded from 9.3.5 to 9.4.0 and decided to start switching from getinitialprops to getstaticprops and getserversideprops . i have styled-components in _document.js injected exactly like in the example . i 'm using firebase hosting , so i have to keep functions folder with its own node_modules . when next.js starts logging automatically optimizing pages message , react throws error about 'invalid hook call ' . i tried to modify next.config.js with ... but no luck . of course , i 've checked versions of react : they are the same . to sum it up : my _app.js file is very simple . export default ( { component , pageprops } ) = > < component { ... pageprops } / > my _document.js file is the same as in official example here i use firebase , and have subfolder functions with node_modules it runs in dev mode well when i run next build it fails after compiling on automatically optimizing pages stage if i put async getinitialprops to _app or remove server-side styles from _document it works again . if i remove sub-node_modules folder and keep server-side styles , it works too system information os : windows browser ( if applies ) [ e.g . chrome , safari ] version of next.js : 9.4.0 version of node.js : 12.11.1 additional context how can i fix this issue using externals or via other features that comes from next.js ? what kind of best-practice approach should i take ? thank you ! < code > if ( options.isserver ) { config.externals = [ 'react ' , 'react-dom ' , 'styled-components ' , ... config.externals ] ; }
i am on version `` ^9.2.1 '' of next in my project : and i 'm also using dependencies : so does would upgrading to 9.4 to take advantage of some yummy new features like new environment variables support break my app ? are there docs that explain that explain that ? also i realized next-authentication , next-page-transitions , next-redux-wrapper are packages are supporting packages that work with next.js but are not part of core , but what about next-server ? btw i love that discussions are here now . something felt off with the whole spectrum platform ... < code > `` next '' : `` ^9.2.1 '' , `` next-authentication '' : `` ^0.1.1 '' , `` next-page-transitions '' : `` ^1.0.0-beta.2 '' , `` next-redux-wrapper '' : `` ^3.0.0 '' , `` next-server '' : `` ^9.0.5 '' ,
i have a single nextjs app serving multiple domains . i want to be able to serve different versions of /sitemap.xml depending on which domain the request is from . i have the actual sitemap files in the public dir , like public/sitemapcom.xml , public/sitemapde.xml etc i 've tried to do this by adding the following to express in server.js server.get ( `` /sitemap.xml '' , ( req , res ) = > { const domain = req.headers [ `` x-forwarded-host '' ] .split ( `` . `` ) .slice ( -1 ) [ 0 ] .touppercase ( ) if ( domain === `` com '' ) { app.render ( req , res , `` /sitemapcom.xml '' ) ; } else if ( domain === `` de '' ) { app.render ( req , res , `` /sitemapde.xml '' ) ; } } ) i end up with getting a missing page ( 404 ) is there any other way of accomplishing this ? any help would be greatly appreciated < code >
i am quite new to nextjs and have to implement a step-by-step process and would like to display each page of the process , e.g . step1 , step2 , step3 , under the same url `` /process '' . i found out that this can be done with router = userouter ( ) ; router.push ( url , as ) , where url is `` process/step1 '' , `` process/step2 '' , or `` process/step3 '' and as is `` /process '' . however , i wonder if this has any major drawbacks and if there is a better alternative , which is as simple as the use of router.push ( ... ) with aliasing . thx in advance . < code >
after upgrading from 9.3 to 9.4 , i 'm now getting a modulenotfounderror for 'fs ' in getstaticprops . has anyone an idea what might cause it ? < code >
i do n't know this is a bug or not , i add following options to tsconfig.json . but it seems nextjs does n't respect the noemitonerror , noemit , eveything just stopped when we have typescript error , which is quite frustrating . < code > { `` compileroptions '' : { `` module '' : `` esnext '' , `` target '' : `` esnext '' , `` lib '' : [ `` es2017 '' , `` dom '' ] , `` sourcemap '' : true , `` baseurl '' : `` . `` , `` jsx '' : `` preserve '' , `` allowsyntheticdefaultimports '' : true , `` moduleresolution '' : `` node '' , `` forceconsistentcasinginfilenames '' : true , `` noimplicitreturns '' : true , `` suppressimplicitanyindexerrors '' : true , `` nounusedlocals '' : false , `` allowjs '' : true , `` experimentaldecorators '' : true , `` skiplibcheck '' : true , `` esmoduleinterop '' : true , `` resolvejsonmodule '' : true , `` isolatedmodules '' : true , `` strict '' : true , `` noemit '' : false , `` noemitonerror '' : false , `` paths '' : { `` @ / * '' : [ `` ./src/ * '' ] } } , `` exclude '' : [ `` node_modules '' , `` build '' , `` .next '' , `` next.config.js '' , `` scripts '' , `` acceptance-tests '' , `` webpack '' , `` jest '' , `` src/setuptests.ts '' , `` tslint : latest '' , `` tslint-config-prettier '' ] , `` include '' : [ `` next-env.d.ts '' , `` * * / * .ts '' , `` * * / * .tsx '' ] }
hello there , i 'm currently investigating whether i should switch from meteorjs to nextjs . currently i use these packages and features : meteorjs redux for state management mongodb as my database react-intl to support multiple languages , each language has it 's own path i.e . domain.com/fr i make use of meteors live update semantic ui as my css framework i 'm looking to switch to : nextjs apollo/graphql i want to keep mongodb tailwindcss the site should be available for multiple languages my questions : is there some nextjs starter-kit available , which fits my needs ? how do i achieve live updates on nextjs ? how do i build a multi language site with paths for each language ? i guess there is no need for redux if i use apollo/graphql ? best regards , hk < code >
hello , as it must compile the whole page before refreshing it , you 've got a certain lag ( like 4-5s ) between your editor in a .mdx file and the display on your browser . is there a way to accelerate this ? for instance i use vs code in .mdx + mdx preview , and it 's really fast . i know it 's not the same thing as it only renders the mdx itself and not the layout in react you 've got , but i 'd love to have a real hot reload in mdx instead of refreshing the whole page . possible you think ? thanks . < code >
hi , we need to pull content at run-time from a headless cms ( data that could change at any point ) , and i 'm wondering about caching the api responses on redis and invalidating using ttl to improve response time . is this something that i can do in getinitialprops or getserversideprops ? or if i wanted to interact with a redis server , would it be better to do this on our custom server ? thanks : ) < code >
pulling the hair i do n't have out with ubuntu 18x ( digital ocean ) & next : 9.4 set up . getting a 404 code on all the js & css and after messing with these all day feel like its the web server . i 'm not versed very well with nginx but feel like something must be off there ( i have no idea honestly lol ) 'server { } http redirect server { listen 80 ; server_name my.site.com ; } ' < code > listen 443 ssl ; server_name my.site.com ; # ssl ssl_certificate /etc/letsencrypt/live/my.site.com/fullchain.pem ; ssl_certificate_key /etc/letsencrypt/live/my.site.com/privkey.pem ; ssl_trusted_certificate /etc/letsencrypt/live/my.site.com/chain.pem ; # logging error_log /var/log/nginx/my.site.com.error.log warn ; location /_next/static/ { alias /var/www/.next/ ; expires 30d ; access_log on ; } # reverse proxy location / { proxy_pass phofurl proxy_http_version 1.1 ; proxy_set_header upgrade < cur > http_upgrade ; proxy_set_header connection 'upgrade ' ; proxy_set_header host < cur > host ; proxy_cache_bypass < cur > http_upgrade ; } location / { return 301 < url > _uri ; }
i search a lot for this on the internet but i do n't find any article related to it . like i have a folder called pages in the root of my project and below tree is files of it . next.js gives default behavior when someone opens project.local:3000 it will open index.js and project.local:3000/app it will open app/index.js but i want that when someone open app.project.local:3000 it will open app/index.js . my hosts file 127.0.0.1 project.local 127.0.0.1 app.project.local < code > | 404.js | auth.js | index.js | _app.js | _error.js \ -- -app index.js
on the next.js 9.4 blog post it did n't give upgrade instructions but the next 9.3.5 blog post did . i normally would have just npm install next but on the 9.3 blog it said to use @ latest . does n't running npm i always install the latest , how come we need the @ latest flag at the end ? and what do the little ^ carets do on my new package.json ? old : new with carets : just curious , thanks . < code > `` dependencies '' : { `` next '' : `` 9.3.5 '' , `` react '' : `` 16.13.1 '' , `` react-dom '' : `` 16.13.1 '' , } `` dependencies '' : { `` next '' : `` ^9.4.0 '' , `` react '' : `` ^16.13.1 '' , `` react-dom '' : `` ^16.13.1 '' , }
my teammates and i are currently working on creating an example using next.js with mongodb . we basically finish it . it 's running successfully on localhost . however , 500 internal server error shows up when i try to deploy it on zeit . it has to do with fetching data from localhost . since we are new to all of these things , we are not sure on how to fix it . can someone please take a look at our example ? one possible solution is to put the db connection into getstaticprops directly and get the data from there directly . we are confused on how to do that . help wanted . thank you . @ michellelucero @ sdhani @ chislee0708 < code >
i 've tried to dig around nextjs issue archive as well as google a lot , but ca n't find the correct answer to make it works . i just want to customize the border-radius from material 's shape module , and according to the doc , all i have to do is call but it will crash with error : please help . i 'm hitting the head to the wall almost 3 days . i 'm using : next : 9.3.3 react 16.13.1 node : 12.14.1 node-sass : 4.13.1 sass : 1.26.3 update : ok , seems like i missed the very big notice about dart sass : < code > sasserror : invalid css after `` @ include shape '' : expected `` } '' , was `` .radius ( 0 ) ; '' on line 5 of /users/sangdth/projects/saduak/front-end/assets/scss/global.scss > > @ include shape.radius ( 0 ) ; @ use ' @ material/shape ' ; // warning : unknown at rule @ use // then use it @ include shape.radius ( < cur > radius ) ;
hi , updating to newest version 9.4.0 does n't work for me . any suggestions how to solve this `` semver '' thingy ? thanks in advance . npm outdated package current wanted latest location next 9.3.5 9.3.5 9.4.0 xxxx.xx npm update -- dd npm info it worked if it ends with ok npm verb cli [ '/usr/local/bin/node ' , '/usr/local/bin/npm ' , 'update ' , ' -- dd ' ] npm info using < email > .5 npm info using < email > .3 npm verb npm-session 6100331aa89b2924 npm verb update computing outdated modules to update npm http fetch get 304 < url > 215ms ( from cache ) npm http fetch get 304 < url > 236ms ( from cache ) npm http fetch get 304 < url > 260ms ( from cache ) npm verb outdated not updating next because it 's currently at the maximum version that matches its specified semver range npm verb exit [ 0 , true ] npm timing npm completed in 1554ms npm info ok < code >
i understand that we can import global css in _app and the built-in css module support . but neither of these approaches solve my problem : i 'm using a third party image gallery and it requires to import a .css file , but it 's not good practice to import it in _app because the gallery is only used on one page . what 's the best way to import it just for that page ? related to # 10665 < code >
hello , i 'm new to next and trying to display an image and make sure it can render server side . my image is location : in my page : this displays fine in the browser , but when i look at the network tab i see that it did not load server side : however , it works correctly , rendering both client and server side , if i specify the full path : is there a way to avoid specifying the full path and still have the images load server side ? < code > < img src= '' < url > alt= '' placeholder '' / > public/images/pick2.png < img src= '' /images/pick2.png '' alt= '' placeholder '' / >
hi ! so i have been told to create a project in nextjs , but in which , when you view the source in browser , you should be able to see the tags as they are , for example , h1 , or other tags , right now i am not able to see them , but they are in a different format , can anyone please help ? is it possible that view source shows us almost the same code as it were in dom ? i 'm sorry if its a bit vague , let me know i will do my best to explain it better . < code >
i 'm new to next js and was playing around with ssr . i have the following component . when i checked the source of the page , i do n't see the actual content but the loading state . is getserversideprops a must use , to render everything at the ssr completely ? the problem i see is that i wo n't be able to use hooks ( especially apollo ones with getserversideprops ) is there a nice way around this ? < code > const userprofilepage : react.functioncomponent = ( ) = > { const router = userouter ( ) const { data , loading , error } = usequery ( user_query , { variables : { username : router.query.userid } , } ) if ( loading || error ) { return ( < layout title= '' social bookmarking and curated lists of everything | sav.to '' > < div classname= '' mt-4 '' > < pageloading / > < /div > < /layout > ) } if ( data ) { const user : user = data.user return ( < layout title= { ' < cur > { user ? user.name : `` } | sav.to ' } > { user & & < userdetail user= { user } / > } < /layout > ) } return null }
hello , i have a page with the url /customers that simply lists customers . when the user clicks on a customer , i want to navigate to /customers/ < id > which is the same page with a side panel opened displaying the relevant customer information . i want the navigation to be seamless ( client side , without ssr , so shallow navigation ) , but i ca n't do it with this setup because the way shallow navigation works . i can do it if i use /customers ? id= < id > syntax , but i want my urls to follow the restful convention . is there a way to achieve this ? thanks . < code >
i need to use an external script instead of adding script tag in _document.js i need to add it in page where script is required . i have added script tag inside < head > in my page and handled configuration of external script inside componentdidmount but the page is crashing with error the variable is not defined the error is occured because the variable is defined inside script and the script is not loaded to reproduce in above code myplayer is defined in external script if you run this first time it will say myplayer is not defined and the title will also wo n't set but after reloading the page it works expected behavior componentdidmount need to execute after script loads so that i can get myplayer object system information os : macos version of next.js : 9.3.4 < code > import react from 'react ' import head from 'next/head ' export default class video extends react.purecomponent { componentdidmount ( ) { var element = document.queryselector ( `` .player-container '' ) ; var player = new myplayer.player ( element , { location : `` < url > '' } ) ; } render ( ) { return ( < div > < head > < title > play < /title > < script type= '' text/javascript '' src= '' //www.example.com/cast_sender.js ? loadcastframework=1 '' > < /script > < script type= '' text/javascript '' src= '' < url > < /head > < div classname= '' player-container '' > < /div > ) } }
hi , i 'm new at nextjs so i 'm taking the simple blog tutorial . as i reach this step : < url > i 'm facing this issue here : ./pages/posts/first-post.js module not found : ca n't resolve ' .. / .. /components/layout ' ( ... ) already tried different approaches on how to write the path , but nothing solved the problem and i ca n't move on the tutorial . could you help ? thanks ! < code >
while developing locally i 'm encountering two situations that are undesirable and make me want to disable hmr altogether , but i wonder if i 'm just doing something wrong , so looking for advice here . if i make 3 independent edits and click save in my editor and come back to my app it reloads three times ( and fires off three network requests since i 'm fetching data immediately in an effect . is that sort of time-travel reload intentional ? apologies if this is just how hmr is supposed to work and i 'm asking here on the nextjs forum ; ) but still , maybe you 've got some advice ? more challenging is that when i create an error ( quite often a referenceerror to an undefined variable while refactoring or fat fingers ) i 'll come over to my browser and it goes into a death refresh loop , just reloading over and over and over ( and firing network requests ala above ) . i usually ca n't keep up with the console logs and then just kill the chrome tab in the task manager because my laptop is starting to get overworked . in that case i lose the error as well , so it 's a pretty rough developer experience . thoughts ? thank you ! < code >
just starting out on building a production ready next.js app and i 'd love to have a link to an up to date repo on next.js 9.3 setup using redux and reselect libraries . < code >
as per the postgres docs i have something similar to this in ./db/index.ts : the problem is when i try to use it in a page . i get the following error module not found : ca n't resolve 'dns ' in '/path/to/project/node_modules/pg/lib this is because the import pg from `` .. /db '' and therefore import { pool } from 'pg ' ; is running client side and failing . how can i fix this without doing the old method of creating a client side api request for this ? < code > import { pool } from 'pg ' ; const pool = new pool ( ) module.exports = { query : ( text , params ) = > pool.query ( text , params ) , } // somepage.ts import pg from `` .. /db '' ; export async function getserversideprops ( ) { const { row } = await pg.singlerow ( `` select * from user where email = < cur > 1 '' , [ `` < email > '' ] ) ; return row ; }
i am using nextjs with expressjs custom server . expressjs set up session cookies for my nextjs app . i can get session information in getinitialprops which works well when i am using server-side routing ( like normal page load ) but when using client-side routing with next/link link i can not get session information . please suggest how i can get session information stored in cookies when using client-side routing and cookies can not be accessed on client-side . < code >
i 'm setting up sentry for error logging following the with-sentry-simple example . it seems that i should be receiving an error object via app 's props . < url > but by logging this err object it seems to be a plain object instead of an actual error instance ( which would have a full stacktrace ) : my page looks like this : is this expected behavior ? < code > { name : `` internal server error . `` , message : `` 500 - internal server error . `` , statuscode : 500 } import { nextpage } from 'next ' ; const errortest : nextpage = ( ) = > { throw new error ( 'test error during rendering . ' ) ; } ; export default errortest ;
hi guys , is anybody else experiencing an issue with using babel-plugin-module-resolver on zeit/now ? getting this error : module not found : ca n't resolve ' .. / .. / .. /layout/main ' in '/zeit/7b754faf/pages/ [ id ] /settings ' running build locally or running now dev works like a charm . i 've also tried removing package-lock.json and node_module and doing a clean build , the problem still remains . this is the specific module on pages/ [ id ] /settings : import main from 'layout/main ' ; and this is how module-resolver is specified : < code > { `` root '' : [ `` ./ '' ] , `` alias '' : { `` components '' : `` ./components '' , `` contexts '' : `` ./contexts '' , `` hooks '' : `` ./hooks '' , `` hoc '' : `` ./hoc '' , `` lib '' : `` ./lib '' , `` layout '' : `` ./layout '' , `` mutations '' : `` ./mutations '' , `` queries '' : `` ./queries '' } }
i am using a custom server with nextjs to inject some serversideprops / getinitialprops into files . what i am doing is having something on the server update a json file every minute or so and then the getserversideprops/getinitialprops functions read the json file from disk to populate data quickly ( without having to do a network request for data ) . everything works great in localhost and when doing a build/running the build locally . in production / after deploying to vercel i get the error : internal server error when trying to open a page . vercel offers build logs but not any logs for the running custom server . is this likely a problem to do with unable to write to disk in the vm 's that vercel uses to deploy apps ? is there an example out there of how i can read/write to disk with a custom server in nextjs for this purpose ? < code >
hi there , i am looking for some help with an issue i am facing . i am building a small application that uses nextjs v9 and i am using now cli for deploying and for local development . i am trying to create a simple profile page that has the route < url > i have followed so many guides and all of them suggest to use the following different page setups pages/profile/ [ id ] /index.js pages/profile/ [ ... slug.js ] pages/profile/ [ idj.s ] i have used all of the above in trying to create a route where i can access the route params . i can use query params but i really want to try and have it like < url > rather than < url > it seems to work fine when i use next cli but not now dev cli i just get a 404. am i missing something obvious with how next and now dev differ ? if i have forgotten any information that someone might need to help please ask and i will provide . thanks in advance . < code >
we are currently using an exportpathmap which looks roughly like this : in the /content page we are using getinitialprops to fetch the correct information depending on the query parameter . now we wanted to migrate to getstaticsprops . with getstaticpaths we are not able to create that without creating a lot of `` empty files '' . sadly using getstaticprops overwrites the exportpathmap : < url > i was wondering about the future of exportpathmap will it be removed soon ? or would it be worth creating a pr to get both working at the same time ? is there maybe already an initiative to do that ? < code > { `` / '' : { page : `` /content '' , query : { foo : 'bara ' } } , `` /product/ '' : { page : `` /content '' , query : { foo : 'barb ' } } , `` /landingpage/ '' : { page : `` /content '' , query : { foo : 'barc ' } } , `` /landingpage/info/ '' : { page : `` /content '' , query : { foo : 'bard ' } } , `` /order/ '' : { page : `` /order '' } , `` /about-us/ '' : { page : `` /about-us '' } , }
i created a nextjs site . it has a sitemap all of which i can see in my google console . when i go to site : mysite.com i can see all my pages indexed but when i do a search for my site on google , i cant find it . i have meta keyword and meta descriptions and ive verified my domain with google . any help ? < code >
i posted this question here ( vercel/swr # 362 ) 2 days ago but did n't receive any response , hence posting here . i am trying to use onsuccess callback function on useswr with no success , here is the simplified but reproducible code : /api/data.js : package.json : here is the codesandbox showing the problem : < url > < code > export default ( req , res ) = > { res.statuscode = 200 ; res.setheader ( 'content-type ' , 'application/json ' ) ; res.send ( { firstname : `` john '' , lastname : `` doe '' } ) ; } useswr ( `` /api/data '' , fetcher , { onsuccess : ( data , key , config ) = > { console.log ( 'entered onsuccess ' ) ; console.log ( { data } ) ; //this always prints undefined . } } ) ; `` next '' : `` ^9.0.6 '' , `` swr '' : `` ^0.2.0 ''
newbie question . we normally have separate development teams that build the client-side layer from the server-side integrations into cms , etc . in other frameworks , i could see them wanting the client-side team to utilize a ssg to build those assets and then the other team would utilize express/node to build apis like those that interact with the cms . in next.js , is that possible to separate out a server-only layer in one project/deployment that runs apis and provides integration into a cms ... while another project ( targeted for client ) builds the actual pages and leverages ( ssg and/or ssr ) ? does doing this effect things like incremental builds and/or preview mode and ssr ? i assume if you had a next.js api layer project and then an instance of next.js project for only building ssg , then you would lose benefits of ssr . so you would really have to have a next.js server to be that api layer and then a separate next.js server to build the ssg and to handle ssr for the client-side resources that are n't generated . hope i am making sense , and if not , sorry ... i come from a java server-side background . < code >
if there is dynamic link on the page and on click of that link , the new page is full page load instead of loading as is like router.push way . to reproduce git clone < url > cd next-routes-bug & & npm install & & npm run dev open < url > on the browser with developer tools open in network tab . click the link it reloads full page on the page . observer the network tab of developer tools , it is full page reload . expected behaviour it should load the dynamic route as is like how spa page open ( like how route.push works ) system information os : mac os browser : chrome version of next.js : 9.3.6 version of node.js : v13.8.0 version of react : 16.13.1 additional context this bug has been happening on our live website as well . it does n't happen when the route is not dynamic . < code >
hey guys , i 'm writing an api route that will call github api and return my user with github 's response . my api is essentially a proxy . however , my server in the terminal is crashing with error [ err_http_headers_sent ] : can not set headers after they are sent to the client . what am i doing wrong ? appreciate your help , thanks ! < code > const https = require ( 'https ' ) export default ( req , res ) = > { const options = { host : 'api.github.com ' , path : '/search/repositories ? q=tetris ' , headers : { 'user-agent ' : 'gohyifan ' } } https.get ( options , ( ghres ) = > { ghres.on ( 'data ' , ( d ) = > { res.json ( d ) ; } ) ; } ) .on ( 'error ' , ( e ) = > { console.error ( e ) ; } ) ; }
we are using getstaticprops and statically rendering few paths some on run time as we are using fallback : true . this works perfectly for any new items those gets requires by the user and they get statically rendered and next requests are servers from these files instead of server call . but when we update a cms asset , those changes need to be reflected on the statically rendered pages , we are capturing the cms changes using webhooks and hoping to regenerate the files again or at least delete the existing copies in .next/server//pages of the static rendered files so that next request will regenerate them when the next request comes . when we delete the json and html files from .next folder they are getting server out of the in-memory . is there a way disable in memory and regenerate the files . please let us know . < code >
please help me to load modified cache logic but not the core spr-cache.js from nextjs . i need to modify the line : 121 the logic is if date is not matching we do n't want to write json file in cache . < code > if ( data.pagedata.pageprops.publish_date ! == data.pagedata.pageprops.updated_date ) // logic cache.set ( pathname , object.assign ( object.assign ( { } , data ) , { revalidateafter : exports.calculaterevalidate ( pathname ) } ) ) ; // todo : this option needs to cease to exist unless it stops mutating the // 'next build ' output 's manifest . if ( sproptions.flushtodisk ) { try { if ( data.pagedata.pageprops.publish_date ! == data.pagedata.pageprops.updated_date ) { //logic const seedpath = getseedpath ( pathname , `` html '' ) ; await mkdir ( path_1.default.dirname ( seedpath ) , { recursive : true } ) ; await writefile ( seedpath , data.html , `` utf8 '' ) ; await writefile ( getseedpath ( pathname , `` json '' ) , json.stringify ( data.pagedata ) , `` utf8 '' ) ; } } catch ( error ) { // failed to flush to disk console.warn ( `` failed to update prerender files for '' , pathname , error ) ; } }
my code worded very well before . but now it got status 500 : | i ca n't see any error on console log client or server . is there anyway to know what tool can detect error for nextjs ? or somewhere i can check for it ? : ( < code >
i noticed that in my production deployment if i navigate to an api route ( for instance /api/user ) i get back a json object with user information . i want to be able to call this route to fetch user information but i do n't want users to be able to navigate to the url directly either on accident or on purpose . is there anyway to not expose the api routes and only allow the hook to access it ? < code >
i 'm wondering if there are best practices or experience feedback regarding how to handle data that are specific per-page , compared to data that are common to all pages . obviously , in any next.js app , there are props shared across all pages ( through getinitialprops , getstaticprops and getserversideprops ) . those data live in props.pageprops in _app.render . now , i have some data that are dynamic ( fetched from an api/db ) and page-specific , such as : all pages have a props.pageprops.customer object ( needed in shared part of the app like head/footer ) some pages have a props.pageprops.products array ( display products ) right now , those data live in props.pageprops directly , but i wonder if some rules should n't be enforced , and if they should n't be rather available under props.pageprops.data/pagedata ( `` data '' feels too-wide of a term , `` pagedata '' feels somehow redundant ) my concerns are : props name collision ( multiple pages using the same variable name with different meaning , could potentially cause havoc if those props are used by shared components ) regression ( some page using `` x '' props , then someone adds a new common variable to all pages named `` x '' and overrides the old `` x '' on that specific page ) clarity ( needs to be obvious , no-brainer ) did you encounter those situations ? how do you recommend to go about that ? < code >
is there a way to access the store outside the react component ? in the traditional react app we are initialized redux store in front end and we can get this variable form any file . but in case of next , we are doing on server-side and just passing this data to main app component _app.js as props so i ca n't manage to get this outside of component as i already mentioned < code >
hey , i just set up getserversideprops now in my index page ( home ) . above my stateless component , i have the following simply example straight from the website docs : in my backend which is in /db/router.js i am using a mongodb mongoose set-up . here is the api route : i amn simply trying to return an api key from the server to keep it serverside . all i am getting in response though is a html doc , thus , the following error : fetcherror : invalid json response body at < url > reason : unexpected token < in json at position 0 any idea what 's going on when i simply want to respond with some json ? ? < code > router.get ( `` /keys '' , ( req , res ) = > res.json ( { google : `` < myapikey > '' } ) ) ; export async function getserversideprops ( context ) { // fetch data from external api const res = await fetch ( ' < url > ) ; const data = res.json ( { } ) ; return { props : { data } } ; }
problem page router hooks object does not receive a populated query object . when i use the < link href= '' ... '' as= '' ... '' > trick to pass parameters to a page , along with koa listening on the exact route , such as the following , an empty query object is received in the router hooks to reproduce < url > issue : the router hook received in zpage page contains an empty query object expected : whenever zpage is refreshed , should receive correct query object the following is observed system information os : [ windows ] browser ( if applies ) [ chrome ] version of next.js : [ 9.3.6 ] version of node.js : [ v12.16.1 ] < code >
i have an interactive web application , where user can upload face and to fun stuff but due to hmr reloading it reloads stylesheet within 30 seconds and whole user data losted . i am trying pretty hard to do this but not getting way to fix this < code >
hello y'all , i have a getserversideprops method fetching a quite big object ( 12mb ) . but when i return this object the request becomes extremly slow even without building the component with this data . the query of that object is n't the issue here . as you can see ( i added the results in the code ) the query itself is quite ok if i dont pass the object as prop . < code > export const getserversideprops : getserversideprops = async function ( params ) { const res = await fetch ( ' < cur > { server_domain } /api/list ' ) ; const data = await res.json ( ) ; console.log ( memorysizeof ( data ) ) ; // 12mb // this takes 25 to 40 sec to load with next dev // this takes 1.4 sec to load with next build & & next start return { props : { data } } ; // this takes 1.55 sec to load with next dev // this takes 1.11 sec to load with next build & & next start return { props : { ok : `` ok '' } } ; } ; export default function home ( ) { return < div > ok < /div > ; }
hello ! this has been on my mind for some time now . i 'm wondering if you have to build your site again for each blog post . let 's say i have a headless cms where i publish some blogs posts from time to time . do i then need to run next build everytime i publish a new post ? i took the tutorial from < url > and the getstaticprops function seems to only run at build time . how would it then be possible to read the posts that i publish in the future ? i guess i 'm missing something here . would love to hear your feedback ! < code >
i restored some files from previous commits before big refactoring , which obviously contained some errors and wrong paths in them . what happened is that my homepage started triggering 404 without any errors or warnings either in console or in browser console when i run next . after running next build i finally got my errors and found what i need to fix so everything starts working again . what is not clear to me is how to prevent this situation in future - i 'm running dev mode , i expect not only get errors but any warnings , instead i was given no information at all and just 404. i was n't even opening that broken page , just trying to open homepage , and getting 404 instead . why 404 ? i tried to look up how to list all routes , but it seems not possible ? how do i know why 404 is happening if i do n't have this information ? it was n't 404 so why it 's silenced and i get no error . i have n't used any -- no-verbose flags afaik . is this a bug or it 's how it 's supposed to work ? < code >
i have recently started learning next.js and integrating it with firebase . so , i might be wrong but this is my take : suppose we have next.js website which does not use getserversideprops and getinitialprops . we now configure firebase to serve our next.js website from firebase cloud functions instead of firebase hosting and suffer from these : we lose all cdn page caching benefits because now pages are built at server during run time by firebase functions and then sent to user i.e . when user visits website . ( please correct me if i 'm wrong ) firebase functions are slow as compared to firebase hosting and also suffers from cold start when not enough active users . i.e . first visit will takes time , sometimes 5 seconds . i 'm not sure if it also affects seo ? almost all articles on the web including next.js and firebase are about setting up firebase functions to host next.js website . i just do n't get it ! why ca n't we use firebase hosting and to show personal data ( user profile , dashboard ) show a static page first and then fetch the personal data from client side using rest api . examples from next.js repo suggesting to use firebase functions for hosting next.js : < url > < url > on a seperate note , it 's way too complicated to setup firebase like this . even the official repos are outdated and does n't work for latest version . < code >
how can i access the server port number ? the default next js port is 3000. this port port does not exist in process.env object . it also does not exist in process.dev when i attempt to set it either by running `` next -p 3000 '' or `` cross-env port=3000 & & next dev '' background : i am getting `` 127.0.0.1:80 econnrefused '' error when running api calls in the server . i do not know where port 80 is coming from : the server port is 3000. my workaround idea is to use the absolute url . but the process.env.port is undefined . as per @ leerob request , following is a relevant snippet of the app architecture provided . api fetch modules are placed in a single utils folder . all remote api requests like those from redux actions and getinitialprops are made to the fetch modules . fetch module constructs axiosrequestconfig config object based on the params submitted . i think that this is part that causes the econnrefused error during api fetch in the server . i would like to set the axios config baseurl property manually using env calibrated means . the idea is to add getbaseurl ( ) to browser and server properties where browser.getbaseurl ( ) : location.origin while server.getbaseurl ( ) : '/ < cur > { process.env.port } ' . considering that the browser and server properties are modules located in properties folder which contains an index module that requires the proper properties module depending on whether the build is for the browser or for the server . the axios baseurl property could then be set to properties.getbaseurl ( ) . < code >
hi 👋 i have a simple page that i 'm trying to protect with this useeffect ( ) : if ( ! user ) { router.replace ( { pathname : '/ ' , query : { sidebar : 'login ' } } i 'm trying to wrap my head around this : when i open my site with , let 's say , google chrome together with the debugger , what 's stopping me from editing the 'pathname ' or 'query ' string to bypass this block ? i tried doing this in my browser and the router still directs me to the initial page . is it even a valid concern , presuming i 'm using dynamic imports for all my protected content ? < code >
dynamic contents are not rendering in head in view page source , all meta tags are empty . that defeats the purpose on seo in ssr please , help . repo : < url > page source screenshot code . content are from a graphql query in a dyynamic page [ id ] .js < code >
i have a page that shows a bunch of movies . the user is able to save specific movies to their favorites list . if i click on the `` my favorite '' button i would like to show only the movies which are selected as favorites . should i for this case create a new page inside movies/ [ favorites ] .ts or should i add a query to the url like this ? favorites and resort the list ? i would actually prefer just to query and resort the list but i read somewhere on github or stackoverflow ( not sure forgot the resource ) , that one should create a new page inside pages . but that would lead to code duplication i think since it is the exact same style on the default movie list . < code > export const getstaticprops : getstaticprops = async context = > { const query = context.params ; const { data } = await axios.get ( getgamesroute ) ; return { props : { games : data } , } }
i was new to nextjs and have a puzzle about how nextjs trigger a http call for content of next page ? i read the source code of link and router but have more question ... in router component i ca n't find where the router events defiend , e.g . routechangecomplete : < url > and i wonder if the http request for content of next page is just excuted in the router event ? < code >
hello everyone . this question is to help me understand what is the performance cost of , for example , using express in a serverless function vs using the standard nextjs way . at the first sight , express api is simple , but you have to end up creating a lot of abstractions to reuse code in a large next project . using express would simplify the routing and some other things . my questions are : what are the best practices for large projects with many api routes ? is there any performance impact using express in serverless vs next normal api ? any other tips ? example : express function /api/auth/ [ action ] with next < code > export default async ( req , res ) = > { const { query : { action } , } = req if ( req.method === 'post ' & & action === 'login ' ) { // do something } } import express from 'express ' const app = express ( ) app.disable ( ' x-powered-by ' ) app.use ( passport.initialize ( ) ) app.post ( '/api/auth/login ' , async ( req , res ) = > { // do something here } ) // add more routes if needed , easy export default app
i 'm currently rebuilding the api for my personal site . in doing so , i did the following ( generally ) : created a new pages/api/graphql.ts route created a new pages/index.tsx page in the view , use getstaticprops to fetch from /api/graphql i 'm confused about how to think about the right way to deploy this . it seems that the getstaticprops would need to read data from an api route that does n't exist yet , or is being simultaneously built . this caused me a lot of frustration as i basically had to comment out a ton of code , deploy the api routes , then rebuild my client side data fetching . any suggestions on this would be great ! < code >
is there any way to optimally translate the code of a custom server through babel ? i also need the server-side es6 syntax . i 've seen all topics about this problem , but none of them satisfy me . < code >
hey , guys . i 'm learning next and to do that i 'm building a blog . to give you context of what i 'm trying to achieve - each blog post page would have a recent posts tab . i want to pull the 5 most recent posts once at build time and share that data between my post pages . here 's what i tried unsuccessfully until now : top level context.provider in the _app.js file that fetches the data on componentdidmount and pages get it as a context.consumer - runs each time a new page is accessed . getinitialprops in the _app.js file - does n't work , runs each time a page is requested . i feel like getstaticprops would work but seems like it 's not compatible with _app.js . can any of you guys give me a suggestion on how i could achieve what i 'm trying to do ? < code >
i 've implemented this authentication method on my web application and it worked just fine on pc and mobile phones , but when i try to login in on my tablet it does not work . after inspect the cookies i realized that it was not saving the token that was created to make login possible . how can i solve this ? < code >
hello everyone , first i would like to thank you for the documentation you 've made , it is really easy to browse and read even for a noob like me : ) i 've followed the entire tutorial , but i 'm still having this question : can i build a complete website in next ? it seems to be that it is designed for simple websites - but once again i think i missed the point . i have seen in an older discussion that express was n't needed anymore since the version 9. so can i build a complete website like i would have with express ? thank for your time and your product . i 've worked on react for a long time and i 'm happy to get ssr back ! bests , yoann < code >
i 'm working on a codebase with next.js version 9.3.0 and graphql . to get the benefits of next.js optimizations , we are wrapping each page in withapollo , so inside the pages we can make use of usequery , usemutation . the issue i 'm facing is that i need to use mutation in the header component which is outside the page , which does n't have access to apolloclient because the app is not wrapped in withapollo . the error i 'm getting is this could not find `` client '' in the context or passed in as an option . wrap the root component in an , or pass an apolloclient instance in via options . the header component is inside the layout component like this : instead of using usequery in a component without withapollo is easy you can use is there an alternative solution for usemutation in a component not composed with withapollo ? < code > import { createapollofetch } from 'apollo-fetch ' ; const fetch = createapollofetch ( { uri : process.env.graphql_server , } ) ; const userinfoquery = ' { userinfo { loggedin basketcount wishlistcount } } ' ; const userinfodata = fetch ( { query : userinfoquery , } ) ; < > < meta / > < header/ > { children } // pages which are composed with withapollo < footer / > < / >
i am developing a website using nextjs with both ssg and ssr . my ssg needs access to my server 's internal net , which does not export to others . so how can i do ci/cd with my project ? maybe next cli can export a compile option for test ci , which does not build the page and only tests if the project compiles successfully . < code >
dynamic routes works well but strange error appears in console . it occurs only in production . < link href= '' /tasks/ [ taskid ] '' as= { /tasks/ < cur > { task._id } } > after click there is correct path in browser : < url > but in console window there is a strange 404 error : get < url > net : :err_aborted 404 ( not found ) to reproduce steps to reproduce the behavior , please provide code snippets or a repository : go to ' < url > or simply 👇 clone repository - git clone < url > switch to taskie branch - git checkout taskie install dependencies - npm install build and run - npm run build , npm run start open browser and run < url > click any card on main screen open dev tools and see an error expected behavior no console errors . screenshots system information os : macos browser ( if applies ) any browser version of next.js : 9.3.6 version of node.js : v10.15.3 thanks ❤️ < code >
hi all . how can i get client 's ip address . for now , this is my code in middleware to check this const ip = req.headers [ `` x-real-ip '' ] || req.headers [ `` x-forwarded-for '' ] || req.connection.remoteaddress ; console.log ( `` ip : `` , ip ) ; console.log ( `` req headers : `` , req.headers ) ; and this is log from my server ( not local ) ip : : :ffff:127.0.0.1 req headers : { host : '127.0.0.1:8891 ' , connection : 'close ' , 'cache-control ' : 'max-age=0 ' , 'upgrade-insecure-requests ' : ' 1 ' , 'user-agent ' : 'mozilla/5.0 ( macintosh ; intel mac os x 10_15_4 ) applewebkit/537.36 ( khtml , like gecko ) chrome/84.0.4136.1 safari/537.36 ' , accept : 'text/html , application/xhtml+xml , application/xml ; q=0.9 , image/webp , image/apng , * / * ; q=0.8 , application/signed-exchange ; v=b3 ; q=0.9 ' , 'sec-fetch-site ' : 'none ' , 'sec-fetch-mode ' : 'navigate ' , 'sec-fetch-user ' : ' ? 1 ' , 'sec-fetch-dest ' : 'document ' , 'accept-encoding ' : 'gzip , deflate , br ' , 'accept-language ' : 'en-us , en ; q=0.9 ' } how can i get ip address from visitor . many thanks < code >
i do n't know anything about next.js 😭 ( it 's a college team project . t^t ) it sounds crazy , but ..... my team project has four projects in one git repository . so ..... i need four css file . 😭 is it possible to do this ? i need your help < code > < link rel= '' stylesheet '' href= '' dist/css/a.css '' / > < link rel= '' stylesheet '' href= '' dist/css/a_mobile.css '' / > < link rel= '' stylesheet '' href= '' dist/css/b.css '' / > < link rel= '' stylesheet '' href= '' dist/css/b_mobile.css '' / >
hi , i implement preview mode over prismic cms as in tutorial i use getstaticprops . but now when i update some content on cms , content on site still old . so i should use getserversideprops ? if yes how implement preview mode with getserversideprops ? thx < code >
hey everyone , was n't sure if this was a bug or i am just doing something wrong . i am pushing a user to a new page using : when user gets to that page i console.log out the query strings and they are all there , but some of them are missing from the url . this means that if the user refreshed the page , it would n't have all the required data . this also only happens when i build the site , locally it runs as expected . any i missing something here ? next version : 9.2.2 < code > router.push ( '/page ? foo=thing & bar=stuff & baz=others ' , addurlprefix ( '/page ? foo=thing & bar=stuff & baz=others ' ) )
i use an npm module ( react-images-upload ) that uses an svg icon internally . the package works fine with the svg icon , unless i reload the specific page where that pachage is used , or write its url directly . the error : unexpected token ' < ' i thought it might be a problem with the svg file itself , so i tried to replace the .svg file in the package with a .png file , but still gives me an error when i reload the page . to reproduce repo : < url > clone the repo : git clone < url > install required packages : npm install run : npm run dev write the url direclty for the page that uses the package : < url > expected behavior the package displays with the icon when i reload the page or enter its url directly in search tab . screenshots system information os : windows browser : chrome version of next.js : latest < code >
we are using ssr for virtually all of our pages , because we fetch content dynamically . that 's why there 's also no need to resolve environment variables at build time . how can i specify environment variables to be resolved not at buildtime but at runtime ? those variables would be used on the server and client side , but can be different for different environments . < code >
obviously api keys are secret , so we need to be able to ensure that they 're not accessible to the public . but sometimes we will need to fetch from an api using frontend code , and we will need the api key when doing so . however , due to not being in a nodejs environment , we can not use process.env . therefore , i am not able to access environment variables stored on the server . what is best practice for retrieving api keys on the frontend ( specifically in a next.js app ) ? < code >
i 've a nextjs project proxied by nginx . i 'm consuming a rest api served by nextjs itself that takes more than 2 minutes . first error i get was 504 timeout by nginx so i added some additional directives : then the error code becomes 502. looking at proxy_error_log file the error is upstream prematurely closed connection while reading response header from upstream . in my project i 'm not using express or any other server explicitly so i do n't know how to set http server timeout . any way to set timeout from next.config.js file or globally for node js ? < code > proxy_connect_timeout 600s ; proxy_read_timeout 600s ; proxy_send_timeout 600s ; fastcgi_send_timeout 600s ; fastcgi_read_timeout 600s ;
i have 2 use cases where i have script that needs to be compiled and run only once . a mongoose schema definition , that if it gets recompiled with a file change in dev mode , will throw errors because it `` the schema has already been defined '' an instance of sulla a node js whatsapp client , that launches a puppeteer instance which just takes forever and is annoying to wait for with every file change i am wondering if there is any way to prevent these things to be recompiled and executed with every file change in dev mode 🤔 < code >
is it possible to force next.js to allow duplicated meta tags ? according to swiftype meta tags i need e.g . what i have tried so far : when i inject the meta tags in a layout wrapper with next/head only the last tag ( tag2 ) is been taken react-helmet works but i need a ssr approach ( so it could be read by the swiftype bot ) with dangerouslysetinnerhtml i got an error message : < url > is there a better approach ? thanks in advance ! < code > < head > < title > page title | website name < /title > < meta class= '' swiftype '' name= '' tags '' data-type= '' string '' content= '' tag1 '' / > < meta class= '' swiftype '' name= '' tags '' data-type= '' string '' content= '' tag2 '' / > < /head >
is it possible to determine whether a call to getserversideprops comes from the initial load of the page or from a page navigation ? we are caching client-side some parts of the data returned from getserversideprops as it is used on all pages . some data is different between pages , so on a page navigation we would like to return only the data specific to each page . < code >
i read this awesome post from cassidy williams and was motivated to create my own personal blog . however , i 'd like to use mdx instead of regular markdown , to have more control on what is the output and be able to use react components . is there anyway i can implement this approach without having to have a /pages/blog1.mdx /pages/blog2.mdx and so on ? < code >
i have a < layout > { children } < /layout > that i want to put on my /pages/_app.tsx . the problem , however , is < layout > needs a bunch of props like aboutmelinktext and portfoliolinktext etc , which i get from my headless cms . seeing as how getinitialprops is not recommended , and i prefer all my sites to be statically generated , what is the best approach to this ? < code >
i 'm trying to remove next-css plugin in favor of built-in css support . so : i removed withcss from my plugin list i upgraded to next 9.3.0 but whenever i attempt to import a global css file , ( eg . import 'foo.css ' ) i get an error : [ error ] ./src/test.css 1:0 module parse failed : unexpected character ' @ ' ( 1:0 ) you may need an appropriate loader to handle this file type , currently no loaders are configured to process this file . see < url > < code >
hi , after sucessfully used the styled-components-breakpoint in react in the past , i wanted to add styled-components-breakpoint to my components in nextjs . when i use it , it throws an webpack error : typeerror : styled_components_breakpoint__webpack_imported_module_4___default ( ... ) is not a function component : next.config.js : why is it throwing an error ? i can use styled-components perfectly without breakpoints and webpack compiles ... < code > // next.config.js const withoptimizedimages = require ( 'next-optimized-images ' ) ; const path = require ( 'path ' ) ; module.exports = withoptimizedimages ( { webpack ( config ) { config.resolve.alias.images = path.join ( __dirname , 'public/images ' ) ; return config ; } , } ) ; import breakpoint from 'styled-components-breakpoint ' ; const logo = styled.img ' display : block ; < cur > { breakpoint ( 'mobile ' ) ' width : 100 % ; ' } < cur > { breakpoint ( 'tablet ' ) ' width : 60 % ; ' } < cur > { breakpoint ( 'desktop ' ) ' width : 30 % ; ' } ' ;
when i click the link href to normal file like about.js and then when i click back the beforepopstate trigger ... but when link to dynamic routes like feed/ [ slug ] .js , and then when i click back the router.beforepopstate is not trigger why is that yeah .. that is very weird ... < code >
in my nextjs app , i 'm making an api call to fetch data in a .js file in my pages directory , but would like to pass that data into my _document.js so i do n't have to make the api call twice . is this possible ? < code >
i 'm wondering if it 's a good idea to merge the cookie handling of the example with-iron-session to the with-passport example . for example , there are extraneous work done in the passport example ( here ) that is already covered by the library next-iron-session . i 'm not talking about merging both examples , but only to use next-iron-session in the with-passport example . as a side question , i was wondering why the example is not using passport 's session implementation . there are some examples out there ( < url > ) and i ca n't tell why the with-passport example is using a custom cookie . if there are an auth expert passing by , i 'd love to know ! pinging the iron-session author ( @ vvo ) , the passport example author ( @ lfades ) and @ hoangvvo . thanks ! < code >
hey guys , i 'm just started getting to know nextjs . i would like to do a small research to understand the migration steps . we also have a none-dev team that supports landing pages with html and small scripting side . how convenient it 's gon na be for them to use nextjs but not a simple html . our current project has the following structure . for deployment , we run domain=ca.cdn.domain-1.com npm run dev gulp takes all the pages from a certain domain and puts it into the dist folder . after the deployment , the urls look like : < url > < url > < url > < url > all pages have different templates . what the structure with nextjs is going to look like ? how to access < url > locally ? will it be then < url > maybe you could also describe the jenkins deployment issues with that . thank you < code > src scripts components domains ca.cdn.domain-1.com global pages page.html page-2.html m.cdn.domain-2.de global pages page.html page-2.html
currently , i generate my static website , and i get its information from a headless cms called strapi . if someone were to make a change in the headless cms , what is the best way to rebuild the website without any developers touching it ? < code >
i would like to use next with an external api . i want to inject the api_url into the next application . one way to achieve this is to use publicruntimeconfig as described here : < url > in my next.config.js i added the following code : publicruntimeconfig : { api_url : process.env.api_url } and in my __app.js : const { publicruntimeconfig } = getconfig ( ) openapi.options.url = publicruntimeconfig.api_url it works well , besides if you do that , your build is not stateless anymore . indeed , static pages are rendered at build time with the api_url that was in your environment variable making your build statefull . some platform like heroku proposes interesting features like promoting a build from staging to production , but it requires a stateless build . now suppose you want a stateless build , but you still want to inject the api_url into the client , even for statically rendered pages . under the hood , when you run your nextjs server it would load your environment variable , and serve it to the client along with the pages , and the pages will use that even they were statically rendered . is there any way to achieve this ? < code >
hello everyone . big fan of next.js here ! i 've recently discovered next.js api routes and instantly fell in love with it . i have one issue with them though : i usually host my next.js applications as separate subroutes of one big platform . so let 's say i have a domain `` foobar.com '' , where on the index ( `` / '' ) i host a website completely independent from next.js . then i have a subroute/helloworld , where i host the next.js application . so it 's : foobar.com < - irrelevant website foobar.com/helloworld < - next.js app assetprefix solved the majority of my problems related to that structure until i introduced the api routes . inside the helloworld next.js app i have the following api route : what [ ... slug ] .ts does is redirecting the requests to specific endpoints . it 's like an api proxy in my app . when i run the requests locally everything is fine , they look something like : < url > the issue is the api route on production does n't acknowledge that it 's hosted on foobar.com/helloworld , not foobar.com . so instead of : < url > i have : < url > which obviously does n't work . is there any solution to that which does n't require writing a custom server ? cheers ! < code > pages/ -- api/ -- -- main/ -- -- -- [ ... slug ] .ts
hello ! is there a way to have the same page served in two ( or more ) different routes without having to duplicate its contents in both directories ? something like : / [ location ] /properties/ [ property-slug ] /properties/ [ property-id ] < code >
hi , after building with next build pages are exported as lambda functions which can run itself . how can i run a page locally ? imagine a very simple scenario . i have a page with getserversideprops and i would like to execute it like serverless function . < code >
i 'm trying to upgrade to 9.3.7-canary.7 but it 's not showing as available in npm and in package.json install . is it a cache issue with npm ? < code >
hello , i 'm using dynamic routes : < url > i 've created the /articles/ [ slug ] .js file and everything works like a charm except unfortunately google thinks that e.g . phofurl is a regular url and it is showed within the google search results and links to 404. do you have any experience with this ? what is the best approach to avoid this ? < code >
hi all , i 'm trying to get dynamic app layout example working with my page wrapped in hoc . my page export is like this -export default connect ( ) ( withauth ( profile ) ) ; in this case , i 'm getting wrappedcomponent instead of profile which makes sense but how can i access the layout property from the profile component in _app.js ? i 'm looking for a generic solution which can work with any number of hocs thanks ! < code >
hi folks - i 'm not sure if this is a zeit configuration issue or a next export issue , so please excuse me if i 'm posting in the wrong place . i have a pr branch that is working fine with both next dev and next build/export/serve . however it is not working on zeit . my configuration is pretty straightforward : i have some new static build config in one page here : < url > i have tried this with both next 9.3.0 , 9.3.4 and 9.3.5. all of them fail to deploy on zeit with error : a routes-manifest.json could n't be found . this could be due to a failure during the build .. some variance that might be a red herring : however , with the later patch versions the build takes a very long time - going from < 2 minutes to over 20. these now.sh log lines are separated by 3 seconds using 9.3.0 but over 20 minutes with .4/.5 . i get similar results locally : here is the end of the failing preview deployment logs : < code > 08:03:07.859 > using build directory : /zeit/2def63aa/.next 08:03:07.862 copying `` static build '' directory 08:03:07.865 > no `` exportpathmap '' found in `` next.config.js '' . generating map from `` ./pages '' 08:03:07.866 launching 3 workers 08:03:07.866 exporting ( 0/4 ) 08:03:07.866 copying `` public '' directory 08:03:07.975 ... export successful 08:03:08.103 error : a routes-manifest.json could n't be found . this could be due to a failure during the build 08:03:08.103 at object.getroutesmanifest ( /zeit/1bc6bc026129a8fb/.build-utils/.builder/node_modules/ @ now/next/dist/index.js:6113:15 ) 08:03:08.103 at async object.module.exports.178.exports.build ( /zeit/1bc6bc026129a8fb/.build-utils/.builder/node_modules/ @ now/next/dist/index.js:3764:28 ) 07:42:41.127 automatically optimizing pages ... 08:03:05.985 page ( ... the exported page map )
in react i do it this way : < route path= '' / : param ( value ) ? '' component= { maincomponent } / > is it achievable in next ? my goal is to check if the param language is `` ge '' , if it is `` ge '' then pass it in the route , otherwise pass nothing , but still redirect . final urls should look like this : if `` ge '' passed - /ge/news ( get data in georgian ) , if not - /news ( get data in english ) . < code >
i 've been googling for a while now , trying to figure out how to proxy certain urls to a separate api , not hosted by next.js . my current attempt was to edit the webpack config , because that 's wat some issues in this repo said to do . so i had the following in my next.config.js but that does n't work . when i go to /api/ on my page , it returns the 404 route . so what would be the best way to proxy /api to < url > ( no rewrite ) using the next dev server ( npm run dev where dev is next dev ) . < code > const { phase_development_server } = require ( 'next/constants ' ) ; module.exports = ( phase , { defaultconfig } ) = > { if ( phase === phase_development_server ) { return { / * development only config options here * / webpack : ( webpackconfig ) = > { const newconfig = { ... webpackconfig } ; newconfig.devserver = { ... webpackconfig.devserver , proxy : [ { context : [ '/api ' , '/admin ' , '/staticfiles ' ] , target : ' < url > ' , } ] } ; return newconfig ; } , cdn : false , } } }
the reason why i 'm asking is because in the next.js issues : # 2252 ( comment ) there 's a comment around storing a cookie in a custom script tag and i know next.js public runtime config already does this by default , can i use the apis next.js uses to pass values into the runtime config ? < code >
hello , i was wondering what is the best way to handle this case , call first api using store.dispatch in getinitialprops . 2.wait for first api response . use the first api response as payload for second api call the second api through getinitialprops . is there any way to wait till first api response and use it for second api and using redux i need both apis data to be server rendered . 'dashboardpage.getinitialprops = async ( { store , res } ) = > { const getstate = await store.getstate ( ) ; const userid = getstate ? .profilereducer ? .profile ? .userid ; if ( userid ) { const payload = { userid , } ; await store.dispatch ( getinvestorbycontactperson ( payload ) ) ; } return { } ; } ; ' < code >
here 's my next.config.js : in the root directory i have a file .eslintrc.js with certain settings , like eslint-plugin-react-hooks , but i do n't see errors regarding this , though in vscode i can see all errors . why does eslint-loader ignores my .eslintrc.js ? < code > const path = require ( 'path ' ) ; module.exports = { webpack : ( config , { buildid , dev , isserver , defaultloaders , webpack } ) = > { if ( dev ) { config.module.rules.push ( { enforce : 'pre ' , test : /\ . ( j|t ) sx ? < cur > / , exclude : /node_modules/ , loader : 'eslint-loader ' , options : { configfile : path.resolve ( '.eslintrc.js ' ) , } , } ) ; } return config ; } , } ;
i 'm trying to create a root level catch-all route using [ ... slug ] . the idea being that whatever request comes through i can pick up the content from the cms based on pathname and use the same `` page '' to render them all . but , it looks like this is catching more than it should and causing a lot of problems : is there a way i can have it ignore requests to paths like /src , /test , etc. ? < code >
after upgrading to 9.3.1 from 8.x we noticed a performance issue with drag and drop . ui starts to flicker , scroll is not responding etc ... trying to get some data from chrome performance tools slows browser tab to the point that entire chrome ui becomes unresponsive . by going back and checking releases we found that issue was introduced with pr # 9026 , support concurrent mode in loadable . i would like to understand what was gained by using use-subscription lib ? according to their website , this lib has a limited use case and it 's probably better to avoid it for frameworks like next imo . < code >
hello folks - i 've noticed there are few examples of next.js setups that include a jest configuration , so after doing a good amount of research i 've made a pr with my own tooling setup . the pr is # 12025 , and i 've made a few tweaks ( removing references to husky + a conflicting eslint-prettier-config so it did n't need to be added to root ) so far but am unsure how to move it forward as it still seems to be failing on a single azure pipeline and i have no idea how to debug it . apologies if this is n't the place to raise the question . < code >
i have a link that looks like this , seems ok : on a next dev server , it works fine . on a production server , nothing happens . so i added some console.log statements to routechangestart routechangecomplete routechangeerror getinitialprops for pages/ranking.js that i 'm linking to . on the dev server , everything fires as expected ( except routechangeerror because there is no error ) . on the production server , i see routechangestart then ... nothing . routechangeerror does n't fire . chrome dev tools does n't detect any errors , not even caught errors . i 've tested various combinations of strings and objects for the link 's href and as but always get the same behavior . it might be something obvious but i 've been using next for a while and i 'm pretty sure i 've covered all the basics . that said , this codebase started with next v5 and i 've been bringing it gradually up to current standards . way to go with backwards compatibility ! ( it 's probably something obvious 🤦 ) < code > < link href= { { pathname : '/ranking ' , query : { location : defaultlocation } , } } as= { '/ranking ' } ' > < a classname= { styles.link } > rankings < /a > < /link >
hi , i 've a ssg site and i 've implemented the react-ga support like in your example , adding the listener to the routechangecomplete event on the _app page . i added a check to the isfallback status too so i do n't count this page views but i ca n't exclude the double page render when i set a query string , for example in the search ? q=test page ... this is because the query is populated in the second render . any suggestions ? thanks < code >
i am trying to figure out the best approach to include a navigation that requires an api call to be rendered that exists on all pages and still be able to ssg . i see two ways of accomplishing as of now : include the api call in the getstaticprops export in each page . include the api call in getinitialprops in _app.tsx and then include an empty getstaticprops export in each static page , triggering ssg . the second option is the cleanest as of now , but i was wondering if there is a way to accomplish this `` globally '' . ideally , including getstaticprops in _app.tsx is how i 'd imagine it could work ? < code > export const getstaticprops : getstaticprops = async ( ) = > { return { props : { } , } }
i 'm not sure if this belongs here . i 'm using node-cache for caching data on /pages/api it works fine on my local but cache never resets when deployed on now.sh . and on patch : some idea why this might be happening ? < code > return api.update ( tenant ) .then ( ( ) = > { cache.del ( tenant.slug ) ; return res.status ( 200 ) .json ( tenant ) ; } ) ; fetch : async ( slug : tenant [ `` slug '' ] ) : promise < tenant > = > { if ( ! slug ) return promise.reject ( { statustext : `` llamada incorrecta '' , status : 304 } ) ; const cached = cache.get < tenant > ( slug ) ; return ( cached || // fetch from the database
when navigating to a page that contains a route param , next will remount the entire layout . if there are any animations present this will trigger them on every page navigation instead of on initial site load . to reproduce my _app.js 'class customapp extends app { render ( ) { const { component , pageprops } = this.props ; } ' link that will trigger a remount < link href= '' /product/handle '' > < a > { props.link_text } < /a > < /link > link that will not trigger a remount < link href= '' /product '' > < a > { props.link_text } < /a > < /link > expected behavior the shared layout should not remount on navigation with route params . system information os : ubuntu browser : chrome version of next.js : 9.3.6 version of node.js : 12.16.1 additional context it appears # 4653 is a similar issue . there are suggetions to use a query or to handle the route programatically . they appear to be working but the link component should provide this functionality as well . < code > return ( < div classname= { 'page page -- < cur > { pageprops.slug } ' } > < header / > < main classname= '' main '' role= '' main '' > < component { ... pageprops } / > < /main > < footer / > < /div > ) ; }
hello , i have /path/ [ placeholder1 ] / [ placeholder2 ] i want to have redirect of the user lands on /path - > /path/value1/value2 - this is something i 've managed to do by putting index.tsx under /path folder and did manual redirect using router.push what i have noticed is that for the given paths : /path/ /path/value1 /path/value1/ i keep receiving 404 i would like for all those scenarios the redirect to be /path/value1/value2 . how should i do that ? < code >
i want to make a login in my web app , using an endpoint in another server ( other domain ) . i ca n't save httponly cookies in the domain of my app , then i need to make something like a reverse proxy in the same server of the webapp . before , i did it with express , can i do it with api routes or something without express ? or maybe using serverless functions of vercel ? < code >
we are looking to build a site using next.js for static site and server side generation . one of the internal suggestions is to run next with express on node . is there a reason you would pair next.js with express ? i have n't found any really good resources except one blog post from logrocket . thanks in advance . < code >
while using express , one of the easy ways to reuse a mongodb connection was to open a new connection when the node.js application starts and attach it to app.locals . something like this : /server.js and then i can reuse this db connection wherever i need : const db = req.app.locals.db so , how do i do it in next.js without express server ? i do n't think it 's a good idea to just open mongodb connections in every api route . there should be a good way to cache that connection and reuse it between api routes . i could n't find a good explanation regarding my question . i would appreciate any help or clarification . thank you ! < code > import express from 'express ' ; import logger from 'winston ' ; import { mongoclient } from 'mongodb ' ; import config from './config ' ; const app = express ( ) ; app.get ( '/ ' , ( req , res ) = > { res.send ( 'hello world ' ) ; } ) ; // create a mongodb connection pool and start the application // after the database connection is ready mongoclient.connect ( config.database.url , ( err , db ) = > { if ( err ) { logger.warn ( 'failed to connect to the database . < cur > { err.stack } ' ) ; } app.locals.db = db ; app.listen ( config.port , ( ) = > { logger.info ( 'node.js app is listening at < url > : < cur > { config.port } ' ) ; } ) ; } ) ;
hello . i want to put request data in my redux store and getinitialprops . how can i do ? i 'm using next-redux-wrapper . my actions.js < code > import axios from `` axios '' ; const base_url = `` < url > '' ; export function fetchmain ( ) { return ( dispatch ) = > { dispatch ( { type : `` main '' , payload : axios.get ( ' < cur > { base_url } /api/main ' ) .then ( response = > response.data ) , } ) ; } ; }
hello all , i have recently started working on next.js and i have created a react component and using that on the next page . and component is working as expected that it 's fetching the data from api and shows in the page but it 's only rendering on client-side , i wanted to see the actual content when i do the view source of the page , how i can achieve this to do in server-side rendering as i ca n't use in the components getserversideprops * which should be used in pages only , below is my code component and i am using this component in my nextpage as regular < code > return ( < usercomments / > ) ; import react from 'react ' ; interface iuser { userid : number ; id : number ; title : string ; completed : boolean ; } export default class usercomments extends react.component < { } , { users : iuser [ ] } > { constructor ( props ) { super ( props ) ; this.state = { users : [ ] , } ; } componentdidmount ( ) { fetch ( ' < url > ) .then ( ( response ) = > response.json ( ) ) .then ( ( users : iuser [ ] ) = > this.setstate ( { users } ) ) ; } render ( ) { const { users } = this.state ; return ( < div > { users.map ( ( user ) = > ( < div key= { user.id } > < h1 > { user.title } < /h1 > < /div > ) ) } < /div > ) ; } }
hello . i use next.js with express.js in my application . i wan na use dynamic page `` /pages/ [ post ] '' and `` /pages/post1 '' . when i click on link with `` /pages/post1 '' application make request `` /pages/post1.js '' with response 404. after , my application reload page and i get `` /pages/post1 '' . how can i use dynamic page without request `` /pages/post1.js '' and reloading page ? < code >
we 're fetching page data from a headless cms so all our pages use getserversideprops . our pages directory looks like this : we have a dynamic route for custom pages created by the cms editors . when i refresh or server-side route to the home page , news , or about , getserversideprops in [ custom ] .js is also called . even stranger , when i log the context.params in [ custom ] .js i get { custom : 'sw.js ' } . i 'm not too familiar with service workers , but i 'm guessing that 's what that is ... we basically want to use [ custom ] .js as a catch all route , i tried [ ... custom ] .js but it did n't make a difference . i 'm guessing having a dynamic page in the root of pages is just a bad idea ? hoping i can find a solution that does n't involve a custom server .. on nextjs 9.3.3 < code > pages/ index.js news.js about.js [ custom ] .js api/ email.js
i have set up a next site with a caas that supports webhooks ( prismic ) and i 'm trying to set up a system where i create a new static build and upload that to my website every time my content changes . my git repository is stored on gitlab . has anybody done that before and would that person care to share how it 's done ? or give me a pointer in the right direction ? < code >
i have a header shown in all pages ( via _app.js ) , which uses the userouter hook to customize the heading title . how can i get the status code of the current page ? i would like to differentiate between 404 and other errors . i do n't find any props in the router to accomplish this . < code >
hi i get this error in console net : :err_aborted 404 ( not found ) for all dynamic pages i am trying to assess by link i put link in this way < link href= { / < cur > { props.model } / < cur > { props.slug } } as= { / < cur > { props.model } / < cur > { props.slug } } > and i have file [ slug ] .js i works but i get the error in console because browser request file as static files i am using next 9.1 i need to know best way of writing slug to get dynamic pages < code >
how can i load font without blocking rendering ? i checked my website with google pagespeed and apparently my fonts block the rendering . the code i use , in pages/_document.tsx : the only discussion i found is this old issue from 2017 : # 512 < code > ... < head > < link href= '' < url > rel= '' stylesheet '' / > < link href= '' < url > rel= '' stylesheet '' / > < /head > ...
has anyone successfully implemented one of the two different versions of swiperjs in next 9.3 ? i 'm a bit new to nextjs ( and webpack in general ) , and am not able to get the next.config.js set up correctly to add the necessary babel-loader for swiper . i see that nextjs provides a way to extend and customize webpack here : < url > and swiper requires this change in your webpack.config.js like this : all my attempts seem to break the application . i get the error , [ event ] build page : /next/dist/pages/_error hopefully , someone in the community has accomplished this and can point me in the right direction in terms of modifying next.config.js appropriately . < code > module : { rules : [ { exclude : [ /node_modules\/ ( ? ! ( swiper|dom7 ) \/ ) . * / , /\.test\.js ( x ) ? < cur > / ] , test : /\.js ( x ) ? < cur > / , use : [ { loader : 'babel-loader ' } ] , } ] , }
figured i start a discussion first instead of submitting ( if ever ) any bug reports . not sure whether this is a problem with either vercel ( zeit ? ) nor next . i suspect that this only occurs because the `` web-app '' node_modules is uploaded and not the root modules . is that why the module is n't transpiling ? or am i missing something ? tried to get this running since i could n't get my own workspace to deploy . to reproduce fork with-yarn-workspace example ( < url > ) deploy to vercel . notice the build error . screenshots remote build error : < url > < url > < code >
since 9.3 , 3 new utility functions are available . < url > but getinitialprops is mentioned nowhere . is it meant not to be used anymore ( in newer projects ) ? or is it still useful for some use cases ? i 'm in the process of migrating a next.js app that uses getinitialprops in _app ( ssr enabled for every page ) to a hybrid app with per-page ssg/ssr . i 'm not exactly sure what to do . also , does _app supports getstaticprops , or must it be added for each page ? it 's not stated in the doc . < code >
in _app.getinitialprops , it 'd be useful to know wether the page is using ssr or ssg , in order to perform some automated processing . one example would be to bypass most of the work related to ssr pages , when building ssg pages . see # 10909 ( reply in thread ) i 'm thinking the props provided to getinitialprops could contain such information . < code >
i need to install more than one example initially but it seems some need extra webpack configuration that you do them internally . how to do it ? ? for example , i need tailwind + absolute-import . when i install with-tailwind then i have to set with-absolute-import configs manually but it does n't work . < code >
i am not criticizing the change , just curious about the reason since getinitialprops is a static property in the page component and now we have named exports for the new methods . is it for code elimination ( libs utilized only in server-side methods , for example ) , easier to type , or perhaps a more semantic usage of modules ? ( i am not sure this last thing i said makes sense lol ) < code >
as the title says , the dynamic url works when redirected after a click , but when the dynamic page is reloaded , it shows a 404 error ( after deployment on netlify ) . tried deploying it on zeit , and it works ! i guess i need to configure something for proper deployment in netlify . kindly help : ) the clean url defeinition : the dynamic page : < code >
i am trying to rerun an external script in the head tag . but it does n't work . does someone know how to do it ? < code >
hey guys , i have a blog and i want it to be dynamic but as the docs say : you can use static generation for many types of pages , including : marketing pages blog posts e-commerce product listings help and documentation should i build the app , again and again , every time i want to add a post to it ? so how it is gon na be good for blog posts when i should build every time after adding a post ? ? ? < code >
hi live demo could be found at < url > . when i scroll to someplace down the page and add some pages to the history stack repeating so and if i come back , rather than persisting the position where it was last left , it takes me to the bottom of the page somewhere in the range of the website footer . thanks ! < code >
hey there , i started building site using cms-datocms example and i 'm really struggling with dynamic routes . i would like to deploy to netlify which is supporting only deployments using `` next export '' command , and whenever i do such export , the /posts folder is never created . is there any way around that ? calling @ chibicode since you were the one working on that datocms example . would really apprentice some help ! < code >
i 'm not sure if i understand how custom _error page works . the way i think it 's supposed to work is that if ( and only if ) an error is thrown in the application , it should render the _error page ( and call the getinitialprops method ) . what i 'm not getting is that when i have a custom _error page that looks like this : it calls both the console.log ( `` error getinitialprops '' ) and console.log ( `` error render '' ) no matter whether an error is actually thrown . it does n't display the error page in the ui , but the getinitialprops is called and the component is instantiated somewhere . i doubt this is a bug in next.js ( it 's rather a bug in my mental model 😃 ) but i ca n't wrap my head around how it works right now : ) < code > import react from `` react '' ; function myerror ( ) { console.log ( `` error render '' ) ; return < div > error < /div > ; } myerror.getinitialprops = ( ) = > { console.log ( `` error getinitialprops '' ) ; return { } ; } ; export default myerror ;
i have turned on the experimental feature polyfillsoptimization , and on ie11 the app crashes with the following exception : not sure how i can help out debugging this , but i can provide more information if needed . < code > syntaxerror : syntax error in regular expression at ln ( < url > ) at anonymous function ( < url > ) at anonymous function ( < url > ) at anonymous function ( < url > ) at anonymous function ( < url > ) at .. / .. /node_modules/next-i18next/node_modules/core-js/modules/_fix-re-wks.js ( < url > ) at __webpack_require__ ( < url > ) at fn ( < url > ) at .. / .. /node_modules/next-i18next/
hi , there . i decided to try brand new example with integration of prismic cms . main page looks good , but when i try to open some post it gives error 404. debugger shows only empty objects . it 's probably because of broken query . < code >
i am using the next.js custom server with koa in my project and trying to turn off usefilesystempublicroutes . but then i could not make the preview mode works properly . in the custom server file i have this router for api/preview . this is the /api/preview.ts file : i got typeerror : res.setpreviewdata is not a function and the req value is { } . now i have to use both custom server and enable usefilesystempublicroutes . did i miss anything ? < code > app.prepare ( ) .then ( ( ) = > { const server = new koa ( ) ; const router = new router ( ) ; router.get ( `` /api/preview '' , async ( ctx ) = > { await app.render ( ctx.req , ctx.res , `` /api/preview '' , ctx.query ) ; ctx.respond = false ; } ) ; ... } ) ; export default async ( req , res ) = > { res.setpreviewdata ( { previewtoken : req.query.token } ) ; ... }
example code : < link href= { /shop/product-basic/ [ slug ] ? slug= < cur > { product.slug } } as= { < cur > { process.env.public_url } /shop/product-basic/ < cur > { product.slug } } > i want to navigate to the dynamic page without reloading . the example above is the way i made the link . in the local environment , it works fine . but when i deploy to apache server the page reloads . the value of public_url for local is `` '' and for the server is `` /subfolder '' . because i have to put this project under a subfolder . other links work fine but i only face the problem with dynamic pages . note : if i put the project in the root domain , all links work fine . i only face the issue with a subfolder . thanks < code >
we are currently working on pwa web app with offline support and come to interesting problem about data loading . the app is < url > quite large catalog of movies and the goal is to load the app immediately without content when service-worker is registered , show some skeleton loading and request only graphql data from server and render on client . while keeping ssr for users that do n't have sw active and hit the actual next with request . this approach can save precious time when loading page as less data are transferred over network , react will render only once ( cause apollo ) , and hydration wo n't be needed . that can result to saving several seconds to time to interactive . user a ( has been on page previously and have active sw ) opens /title/movie/123 sw serves cached full app with skeleton loading some component inside the app loads the data using apollo usequery and re-renders actual with content when done user b ( never been to iflix ) opens /title/movie/123 and next server serves full page , ssred , hydrates and then service worker gets registered so next time it is user a originally we thought it could be done by getserversideprops but the current behaviour is that if it is hit on client it does the request to the server to get result from this function . a `` ignoregetserversidepropsonclient '' config that would allow not to request that and pass undefined in props could solve this issue . doing all of that in getinitialprops should be possible but prevents code splitting and other optimizations . < code >
i 'm having an issue that is making my google tag manager triggers behave inconsistently . basically , in firefox a history event is fired on initial/landing page load . however , this is n't happening in chrome . is this happening for anyone else ? < code >
hi there , thanks for maintaining this framework , it 's a pleasure to use ! i 'm lost on file loading : i 'm trying to write an api endpoint that loads a pdf file as binary data , process it , and sends it to the user . i would like to load my template data as a byte buffer , something like : i had an error , i tried to add file-loader to my next.config.js : but it looks like all i get is a name / url , is there a recommended way to load data in the api ? < code > webpack : ( config , options ) = > { config.module.rules.push ( { test : /\.pdf/ , loader : 'file-loader ' , } ) return config import pdfbase from './template.pdf ' const existingpdfbytes = pdfbase.arraybuffer module parse failed : unexpected token ( 1:0 ) you may need an appropriate loader to handle this file type , currently no loaders are configured to process this file . see < url > ( source code omitted for this binary file )
the new preview api allows you to set some preview cookies . currently , when i 'm calling my enable-preview endpoint , i 'm returning the same data as json that i set as my previewdata . this allows me to store those values inside the local storage for my client . now since the cookies might time out after a while , my client still has the local storage values set . is there some way of accessing the cookies directly from the client-side , which would mean i would n't have to store anything inside local storage . currently , the cookies seem to be encrypted and i do n't know how to access the data stored inside it . < code >
i 'm working on a project , where i 've split some logic into a separate package . as it is conventional , inside that separate project i export all components and utilities through the main entry file , so i can have clean imports on my nextjs project again . now i have some utils inside my splitted package , which use the node package `` fs '' for instance . this will cause a build error , even though i never import the said util into client-side components or pages from my project . my util is only used inside the getstaticprops and paths methods , which is okay since node packages are available inside those . the current workaround i 'm using was to move the utils which rely on node packages into a separate file , so webpack will never go there form the nextjs project . this forces me to have some rather `` ugly '' imports through a build folder , since i 'm working with typescript . it would be nice if nextjs would not detect methods which work with node packages , unless they are getting imported . < code >
i just followed the entire official tutorial series . < url > now the url is example.com/posts/file-name but how can i change the url to this format example.com/category/file-name < code >
hello is been some days now that am trying to use a react-package in my next project but each time , time i wish to import i get this error please can someone tell me how i can go about using this component with having this error ? < code > global css can not be imported from within node_modules . read more : < url > location : node_modules/react-images-upload/compiled.js
in my next.config.js i have : it copies i18n files ( en.json , es.json , etc ) to a public folder appending [ contenthash ] . so the question is how to get access to [ contenthash ] part in my custom _document.js file ? < code > config.plugins.push ( new webpackcopyplugin ( [ { from : path.join ( __dirname , 'src/i18n/phrases/ * .json ' ) , to : path.join ( __dirname , 'public/static/i18n/ [ name ] - [ contenthash ] . [ ext ] ' ) , flatten : true , } , ] ) ) ;
hi there , i have an endpoint that is very slow and can potentially return a lot of objects . currently , in my application this is what i 'm doing : for my page , i define getserversideprops . in getserversideprops , i do all of my slow stuff and return a props object for my page component to consume . for the end-user , this turns into a potentially very slow experience because the page wo n't load until everything has been loaded . it can take up to 30 seconds sometimes . ideally what i would like is the following : following the advice on the next documentation , i load the page with loading states for the items that have n't been retrieved yet . each individual item is fetched , return it immediately to the frontend and have the frontend render it . this allows the end-user to see things as soon as they have been fetched . this feels like a better user experience , even if there is some slow stuff going on behind the scenes . what i think i need here , is some sort of socket-like mechanism that can pass through objects as they 're retrieved . i might be wrong about this though 😂 would anyone be able to point me in the right direction here ? i 've taken a look through the documentation and had a google , but am unable to find exactly what i 'm looking for . thanks ! -dave < code >
example : i have flatpickr css that only used in particular component . why do i have to put it on global , because on global css its requested on every pages . < code >
bug report describe the bug when using api-utils.apiresolver with jest to test my endpoints , i can not get a json body to pass through to the handler . to reproduce use in a serverless now / nextjs project with pages/api component jest test like this : expected behavior when handlercomponenttotest gets the req , it should have a body with above values . system information os : [ e.g . macos , windows ] browser ( if applies ) [ e.g . chrome , safari ] version of next.js : [ e.g . 6.0.2 ] version of node.js : [ e.g . 10.10.0 ] additional context if i add lines to api-utils.parsebody function to convert req.body to a stream and pass only that to raw_body_1 call , it works as expected . other blockers on the way here were had to define and parsebody only looks for lowercase 'content-type ' < code > const contenttype = content_type_1.parse ( req.headers [ 'content-type ' ] || 'text/plain ' ) ; let buffer ; var readable = require ( 'readable-stream ' ) .readable var stream = new readable ( ) stream.push ( json.stringify ( req.body ) ) stream.push ( null ) try { buffer = await raw_body_1.default ( stream , { length : null , encoding , limit } ) ; const requesthandler = async ( req , res ) : void = > { req.method = 'post ' req.body = { test : 'body ' } req.headers = { 'content-type ' : 'application/json ' } return apiresolver ( req , res , undefined , handlerpagesapicomponenttotest ) } export const config = { api : { bodyparser : true } }
feature request is there option to have a static page ( that was ssg-ed in build ) but having a dynamic props for it ? i 'll explain my situation - i have world wide users and i want some < select > s to be auto selected to the user 's region & currency - so i would like add the geoip data in the props . it 's not a page i would like to ssr . i believe it can be pretty useful in lots of cases ( mostly related to fields initialization ) that the ssr is just too much i would think that that function like getserversidestaticpageprops ( or something bit shorter ) that tells us we can still ssg it still would let us do some processing when the request arrives i ca n't think of real workaround with the current configuration . only ssr ( which will increase load time ) or an xhr ( fetch ( .. ) ) request when the page starts ( which will make the web page to behave weird .. ) . cheers : ) < code >
i am deploying a next.js app to a google app engine ( standard ) but i am having trouble with cold start times . i am building locally then deploying the .next folder to gae . on the first boot it takes 15-25 seconds to boot up . looking at the logs i can see a log for a very long get 200 request but there 's not really any information about what is going on . see log below : when i run yarn start locally it boots up in < 1 , which as far as i understand is running the same production build ? it is almost as though gae is doing a build before it eventually deploys .. any pointers would be immensely appreciated ! alex < code >
i want to remove axios from my site , before i will install any polyfill i want to know that did nextjs polyfill fetch ( ) on server side too ? < code >
hey there , we are writing an application hat has a big emphasis on page load performance . we 'd like to ship that same page to amp . i can see that woth next.js we can export a config like so ... and we would have a component that uses the useamp hook , like we can enable amp . 👉 < url > but if we do that and we have a lot of those things , we 'll ship lots of unused amp code to the normal web and have an unnecessarily big bundle size . is that true ? thanks , lukas < code > export const config = { amp : 'hybrid ' } ; // or // export const config = { amp : true } // components/embed.tsx import { useamp } from 'next/amp ' ; export default ( ) = > { const isamp = useamp ( ) if ( isamp ) { return < iframe src= '' ... '' > < /iframe > } return < script src= '' ... '' > < /script > }
i 'm using getinitialprops for ssr to speed up the feel of the site i 'm rendering a version of the page being navigated to onroutechangestart with loading skeletons , which is working quite nicely . the only issue is that the visible url does n't update until the route change is complete - so it appears to lag behind the page change . has anyone found a workaround for this ? i 've been trying with window.history.pushstate ( null , null , path ) which works but breaks the history . can i use it in conjunction with router.replace or route.beforepopstate to force the url change at the start of the transition but maintain the integrity of the history stack ? < code >
i 'm using next-stylus with css modules enabled . need to import third party global css . what is the easiest and less troublesome way of doing it ? is there any docs that clearly explains how to handle that ? p.s . : i 've searched docs , github , stackoverflow , google , whatever . i 'm messing up with next.config.js . i will probably come up with some workaround , but i 'm wondering if there 's an easy solution hidden in plain sight ? p.p.s . : also i 'm wondering why the * .module.css convention is not implemented for the .stylus ? < code >
i have this in next.config.js i have this configuration but ca n't be loading css from saas files , for instance , i made import `` ./main.scss '' ; and is not loaded next js : 9.3 ./components/landing/main.scss moduleparseerror : module parse failed : unexpected character `` ( 1:0 ) you may need an appropriate loader to handle this file type , currently no loaders are configured to process this file . see < url > ( source code omitted for this binary file ) can someone help with the right configuration ? thanks in advance carlos vieira < code > const withsass = require ( ' @ zeit/next-sass ' ) ; const withcss = require ( `` @ zeit/next-css '' ) ; module.exports = withcss ( withsass ( { webpack ( config , options ) { config.module.rules.push ( { test : /\ . ( png|jpg|gif|svg|eot|ttf|woff|woff2 ) < cur > / , use : { loader : 'url-loader ' , options : { limit : 100000 } } } ) ; return config ; } } ) ) ;
so i am trying to deploy a nextjs app with a graphql api endpoint ( docker image ) behind nginx with a different base path and running into different issues . first as some context , the basepath im testing is zone and this is the nginx config : have added the base path to different parts in the app . for example : for all the links for graphql : for graphql frontend : for next.config.js also i have fonts and images inside the /public folder . when i deploy the application , routes are working but still have multiple issues . all assets in the /public folder do n't get the assetprefix attached so they are not found link prefetching is n't working , all requests fail and the request url seems to have the prefix in 2 locations . here an example with zone at the beggining and end : < url > api routes are not being found even though they have the correct assetprefix . here an example url : `` < url > gives 404 error any idea or suggestion to get this working would be awesome and will also update if i have any progress < code > location /zone/ { rewrite ^/zone ( . * ) < cur > < cur > 1 break ; proxy_pass phofurl assetprefix : basepath const handler = apolloserver.createhandler ( { path : ' < cur > { basepath } /api/v1 ' } ) ; < link href= { ' < cur > { basepath } < cur > { to } ' } > const link = new httplink ( { uri : ' < cur > { basepath } /api/v1 ' , credentials : 'same-origin ' , fetch , } ) ;
i would like to get the html result of a render of page components that use getserversideprops , but there is a check in rendertohtmlwithcomponnets ( ) ( packages/next/next-server/server/next-server.ts , line 996 ) that forces the response to be sent immediately instead of being returned . my hope was to cache the result . can someone help me figure out why this is desirable as designed ? it seems to be on purpose , so it feels like i 'm using it wrong . < code > if ( html & & isserverprops ) { sendpayload ( res , html , 'html ' , { private : ispreviewmode , stateful : true , // gssp request } ) return null }
i have an application that uses multiple url slugged routes i.e . localhost:3000/ [ id ] and localhost:3000/ [ id ] / [ otherid ] for example . i take these url slugs and make requests to my server with them . i 'm getting a ton of server requests where the slugs are static assets so id for example will be static and otherid will be favicon.ico . logs in _app.js : console output : i apologize in advance for the limited info , this is a closed source project but please let me know if you need more information < code >
hi all ! today i put out a code generator tool for next.js called next-codegen . i posted on twitter about it here , you may have seen : < url > anyway , i just wanted to get feedback from anyone , if you think a tool like this has merit or if you have feature ideas . on thing i was thinking of was a -- docs flag that would heavily annotate the generated components with descriptions and links to the next.js docs for components , api routes , and the data fetching methods . could be useful for beginners to the framework . anyway , thanks for listenin ' , and let me know if you give npx next-codegen a shot and have any feedback ! < code >
hi everyone ! i 'm trying to setup a static documentation with authentication . i use mkdocs for building my doc ( its a static site generator ) . the output is a static website containing html , css and js files . until now i handled authentication with an express server . as i 'm a big fan of zeit/now i would like to use it for deployment . i first tried to deploy an express server alongside my static folder on now . it worked fine on localhost but i was unable to fix some issues on preview deployment with now . after reading a lot of discussions on spectrum , i learnt that express was n't a great option if i wanted to deploy serverless because of how lambda function works . then i decided to try next.js because of the api routes and static file serving features . thanks to the awesome `` next-connect and passport '' example i could manage authentication . however i 'm not sure if what i 'm trying to achieve is the proper way or even possible . is it possible to prevent a user to access public assets served by nextjs ( while he 's not authenticated ) ? is it possible that next.js looks for the static html file based on request . for example , with the route `` /docs/about '' , it will serve `` /docs/about/index.html '' ? i would be grateful for any advice or comment on the matter : ) < code >
the problem i 'm having is that i created this however the data from usercontext and listcontext is being shared across requests , even for different browsers how can i make them be new instances for each request ? < code > import { usecontext } from `` react '' ; import { usercontext } from `` .. /lib/context/usercontext '' import { listcontext } from `` .. /lib/context/listcontext '' export default function rankerapp ( { component , pageprops } ) { const [ userstate , setuserstate ] = usecontext ( usercontext ) ( ) ; const [ liststate , setliststate ] = usecontext ( listcontext ) ( ) ; if ( pageprops.user & & ! userstate.loaded ) { setuserstate ( { ... userstate , ... pageprops.user , loaded : true } ) } if ( pageprops.list & & ! liststate.loaded ) { setliststate ( { ... liststate , ... pageprops.list , loaded : true } ) } return ( < listcontext.provider value= { [ liststate , setliststate ] } > < usercontext.provider value= { [ userstate , setuserstate ] } > < component { ... pageprops } / > < /usercontext.provider > < /listcontext.provider > ) ; }
we have pretty big next.js project with postcss styles in old manner - we simply import css files in components and use bem name convention . now we want to switch to built-in css support ( global stylesheets + modules in components ) . but we ca n't just start using it for some components , we have to refactor all of our components , migrating them to css modules . am i right ? is there any way to achieve it with minimal effort ? thanks < code >
it 's not possible to calling dynamic api routes in 'getserversideprops ' . a 404 error is returned instead . steps to reproduce : create an /api/products/data.js etc . call endpoint ' phofurl in getserversideprops . 404 returned calling the api endpoint in a browser works as expected . < code >
hi , i was previously using gatsby for our static site generation but we moved to next js recently to create dynamic pages with ssr for better seo . in our gatsby site , we had 20-30 pages created using json data and around 5.5k pages created using excel sheet data which was statically generated during the build time . since we completely moved to next js so we want to create those pages in next js via json or excel sheet . so how to create that . i googled it and could n't find any proper solution to this hence asking it here . any help would be much-appreciated guys . < code >
hi everyone , i am new to next js.i have been integrating a custom node server with next app . as a follow up i have tried to integrate next js and am quite successful with react components inside pages folder . but i struck with files inside pages/api folder where next provides support to build apis.i can not able to get redux state into those apis . can anyone help me out on this . thanks in advance . < code >
hi , i am working on a site where we need to have dynamic urls as follows : pages/ [ username ] pages/ [ jobcategory ] / [ jobtitle ] pages/ [ groupname ] / [ postid ] how to create these pages as dynamic routes at the root . i 've tried creating multiple dynamic routes but it gives error as you can not use different slug names for the same dynamic path . i am new to next.js and any help would be greatly appreciated . < code >
debug start : it goes to getserversideprops ( ) function . there i wait for some api call . then i get that information in my _app.js then it goes to the page again , to render ( note that currentloggedinusername is set with a value that is not guest ) but when page finishes loading , i get this : if i go to page2 then back to page1 , i get the correct result . what is going on ? < code >
i ca n't for the life of me figure out the proper setup for running next in docker , so that file changes are actually watched and reloaded . has anyone manged to get this working ? for reference , i have the docker setup below : docker-compose.yaml dockerfile and get this error log : < code > from node:12.16.1-stretch env app_home=/app run mkdir < cur > app_home workdir < cur > app_home copy . /app run yarn expose 3000 cmd [ `` yarn '' , `` next-dev '' ] version : ' 3.6 ' services : postgres : image : postgres:12 restart : always volumes : - db_data : /data env_file : - .env graphql-engine : image : hasura/graphql-engine : v1.2.0-beta.2 ports : - '8080:8080 ' depends_on : - 'postgres ' restart : always env_file : - .env nextjs : container_name : nextjs build : . ports : - '3000:3000 ' restart : always env_file : - .env volumes : - ./nextjs : /app - /app/node_modules volumes : db_data : nextjs | yarn run v1.22.0 nextjs | error could n't find a package.json file in `` /app '' nextjs | info visit < url > for documentation about this command .
hi , we have been using this very old version of next.js for quite some time now and have been wanting to upgrade it to latest , given the documentation only supports upgrades from 8.x.x to latest , i had no resort but to post this query here since it is n't an issue to report . thanks ! < code >
hi folks , i 'm building a small app , based on the auth0 sample . what i have n't found out how to do is how to redirect to an arbitrary route in the post-login callback . for example , assume there is a protected route /account that i redirect to /api/login as in the sample . i would like to pass a url parameter ( e.g . ? redirect=/account ) that the /api/callback route takes and redirects me to /account . is that possible ? it 's a pretty common pattern in many web apps . < code >
recently i need to make a static official website with nextjs , and i am asked to do with ssr for a better seo . but nextjs tell us that static generation pre-rendering is faster than ssr . so how should i choose now ? anybody could help me to explain about these concepts ? thanks so much ! my product requirements : a static official website , ssr , better seo < code >
our application renders a tracking page at two urls < url > < url > when i submit this form < url > , i 'm trying to redirect ( client side ) but it does n't work . rewrites config i tried router.push ( '/tracking/ [ id ] ' , '/tracking/ < cur > { ordernumber } ' ) , but it is preferable to use without the prefix . could anyone help ? < code > < form onsubmit= { e = > { e.preventdefault ( ) setloading ( true ) router.push ( '/ [ id ] ' , '/ < cur > { ordernumber } ' ) } } > const nextconfig = { experimental : { async rewrites ( ) { return [ { source : '/ : id ( [ 0-9 ] + ) ' , destination : '/tracking/ : id ' } ] } , } }
i 'm new to github and web development in general , so please bear with me if i make trivial mistakes . i currently have an express backend that uses an auth middleware on protected routes to redirect users to my login page if no jwt cookie is detected . if possible , after successful login , i would like to redirect the user back to the page that requested the login ( profile page , no token - > login , receive token - > back to profile page ) . however , i can not think of any way to do this without using ssr in order to read either custom headers or query strings . i 'd rather not regenerate the html on every request to my login page . is there any way to accomplish this ? for example , can i pass the api response as props to my static login component ? < code >
i am using a package that exports es modules , these are correctly imported in the browser bundle thanks to the module field in the package.json of the dependency the problem is that if i want to import es modules from a folder like package/esm/folder i get an error because of the export import syntax not supported in node , the error will be something like syntaxerror : unexpected token import i think this is because nodejs can not use es modules and the package is not transpiled by webpack in the nodejs process , is this correct ? one solution would be to not use es modules and instead use only commonjs for subfolders imports ( but then i can not tree shake ) , or create a separate package and take advantage of the package.json module field is there a better solution ? < code >
i am trying to build a fully static site with pages build using getstaticprops / getstaticpaths with content from a cms . i am using redux and saving its state in localstorage but i am running into an issue where pages with dynamic routes are not displaying the right ui , specifically while using styled-components . this code sandbox demonstrates the problem i am running into . follow these steps : click a `` product '' and you will be directed to its page ( products/ [ id ] ) made with getstaticprops / getstaticpaths . click the heart icon and the item will be added to the redux store and local storage . click `` go back home '' . you will see that the heart for the `` product '' is correctly filled in on the home page . click the `` product '' again to go back to its page , the console will display an error `` props do n't match server '' and the heart will not be filled in as it should . but the state will be correct . when you click the heart it will remove the item . this may be a problem with styled-components , but i am wondering if any of you have created a static site with redux and how you achieved it . < code >
how can we integrate .mdx files using the new ssg functions ? i 've tried using these examples , but there 's some glue missing to set up a blog with custom files , gray-matter , etc . : < url > < url > if we try to replicate a setup like < url > ( uses gatsby ) are we missing some functions , or am i just missing an example that wires it all up ? < code >
i come from angular . i have started developing in react just months ago . i like both angular and react . each has its own pros and cons . but i 'm not here to make a discussion of that . my point is , in angular , style encapsulation is by default . meaning , i do n't have to import the style to the component and pass styles.sidebar in classname . instead , i write the name of the class as a string ( the vanilla way ) , and angular knows to match it with the given style . now , i know angular uses lots of magic behind the scene to make such a thing work , and i know that in css modules does n't work that way , but i find it tedious to pass a variable for each element i want to cast a style . so i 'm having hard time with two issues : i ca n't write plain css without making it global ( if i try to import .css file which is not a module i get an error ) . i have to pass a classname for each element that i want do style . meaning , i ca n't write .sidebar > ul . i know that nextjs did n't invent css modules , but at the same time , they do n't allow me to create a plain css files that gets minified to many files ( just like they do with css modules ) . any suggestions ? < code >
i am getting this error index.js:1 warning : function components can not be given refs . attempts to access this ref will fail . did you mean to use react.forwardref ( ) ? i have this snippet of code provided : i have the inside the tag just how it is describe in the example < url > not sure what i am missing and why i am getting the warning ? the href is being pass to the link and i can see it . thanks < code > < link key= { math.random ( ) } href= { uri } passhref > < text as= ' a ' variant= { { _ : 'link3mobile ' , m : 'link3 ' } } classname='footerbottomlink ' > { title } < /text > < /link >
is it possible to initialize next without wrapping the entire koa server in it 's .prepare ( ) statement ? without a synchronous server variable , it 's not possible to integrate with an integration test suite like mocha + mocha-http or supertest . official documentation links : < url > < url > < code >
i was wandering what 's the best practice there , i wrote password auth from scratch but when i want to use auth providers i should probably use passport , or ? it 's just that passport feels like it 's really not designed to be used in a serverless environment . is it still the best way to do it when you do n't want to use services like auth0 or are there some new developments that i should know about ? really curious about your answers ! < code >
hi ! i noticed the generated of css module class names include the filename of the css file , even in production , for example : i wonder if there 's anything i can do/config to prevent `` refractor '' nor `` comment/keyword/etc '' from showing up in the generated class names . the filename nor the original class name are not something i hoped to be exposed in production . thanks ! < code >
i have a scenario similar to this : < url > - > nginx reverse proxy < url > - > next.js app a < url > - > next.js app b < url > - > next.js app c all apps : share the same exact configs ( next.config.js and babel.config.js ) use the same next , react , react-dom versions runs on the same node versions ( 10 ) only ssr ( because of user authentication ) statics are exported and published to the same s3 bucket this already works in next 9.1 , but with the introduction of granular chunks ( specially the framework chunk ) it means that two or more apps can generate the same exact chunk . is this a foreseen scenario ? is it safe for an app to use chunks generated by another app ? < code >
i have a next.js app with a redux store ( using rematch ) . when the page loads , the client is currently making some initial api requests to set the initial store state . is it possible to do this on the server side and pass this data down to the client in an elegant way ? < code >
gatsby.js has a feature where it saves the scroll position on every visited page which persist for the current session ( test by opening any gatsby page , scroll anywhere , navigate to another page , and go back which will restore the scroll position ) . this feature has been discussed years ago on # 3303 but none are similar what gatsby does . same as the discussion title , is there any equivalent solution for next.js ? < code >
i have a new nextjs project that i 'd like to point to from a different domain and directory using a reverse proxy . so for instance , maindomain.com/path/site/ will point to the root at whatever.now.sh . and i have dynamic routes setup for all of the content , under page/ [ id ] .js . i have configured assetprefix and used publicruntimeconfig to get all of the assets loading correctly . the one issue is dynamic routing , as adding the base path prefix to the dynamic routes , while it sort of works , causes a hard page refresh and is n't loading the route via client side correctly . my links are done via onclick like so : router.push ( / ? id= < cur > { id } , < cur > { basepath } /page/ < cur > { id } , { shallow : true } ) getstaticpaths looks something like this : index.js and page/ [ id ] .json share most of the same code , with the exception of getstaticpaths my dynamic routes are built using the page/ [ id ] .js paradigm and getstaticpaths . would just using exportpathmap in next.config.js make any bit of difference ? what would cause a hard refresh to occur and not a client-side only route change ? < code > export async function getstaticpaths ( ) { const data = await dataloader.fetch ( 'pages ' ) // returns a content array with unique ids const paths = data.map ( ( { id } ) = > ( { params : { id } ) ) return { paths , fallback : false } }
hey , what is the best solution to get a setup where i can set different env variables for the different environments and can deploy them to different urls such as < url > , < url > ... ideally if i push the dev branch into the staging branch it will push it to < url > how do you guys do it ? < code >
whats the best place to find nextjs experts interested in a few hours a week of project assistance ? we have development capabilities , recently transitioned to nextjs and are pushing the boundaries of whats possible and are looking to accelerate progress . in short , a high hourly rate will be offered for efficient , on-demand bottleneck assistance as problems emerge . if anyone reading this is interested , let me know ! < code >
i am currently using require ( `` some/blog/post '' ) within the body of a ssg ( getstaticprops ) rendered component like this : the reason for that is that i want to be able to use the same existing mdx webpack loader pipeline in my dynamic path component . in the official nextjs blog-starter example , the html was directly generated in the getstaticprops and then passed as a string prop . i 'd like to avoid that , since i rely on the component injection model of mdx , and as far as i know , passing more complex data structures like mdx component trees as props will not work . anyways , the approach with require as outlined above seems to work . my general question would be if there are any obvious downsides doing that ? the only downside i saw so far is that i had to overload the fs module , since i was using fs functionality in the getstaticpaths function . any feedback on how to approach this kind of problem would be helpful ! < code > // pages/blog/ [ slug ] .js function page ( props ) { const router = userouter ( ) ; const { slug } = router.query ; // trying to simulate what i would usually get from creating a concrete file in 'pages/blog/my-post.mdx ' const { default : component } = require ( ' .. / .. /_blogposts/ < cur > { slug } .mdx ' ) ; const frontmatter = component.frontmatter ; return < component frontmatter= { frontmatter } / > ; } // i am leaving out getstaticprops / getstaticpaths since it 's not relevant for the question
i was wondering if there is a way to know inside getserversideprops if it is currently being used used to ssr the page , or if it is being called from the client as an ajax request . my particular use case i have quite an expensive operation that i only want to do on the initial ssr . for subsequent calls from the same client i do n't want to redo the same operation as it will likely return the same result , so i have cached it on the client . < code >
is there any way to create a dynamic route after / i have created dynamic route inside page directory like below pages - [ username ] .js when someone visits < url > i get the username from get initial props and show them relevant content problem is when i visit my other routes like /home/preview or /contacts it gives me the right page but [ username ] .js page run as well i have some code that should only run for [ username ] .js not for another route routes structure pages contact.js inex.js [ username ] .js home preview.js we can not create dynamic routes for after root to reproduce create a directory structure like above create the file and create react component for each page console log the query . username inside get initial props of [ username ] .js visit localhost:3000/myusername , you will see the log of my username there now visite another route like localhost:3000/contact it will result in you your contacts.js react component but it will also run the [ username ] .js file 5 likely you can also visit /home/preview and it will again run the file expected behavior it should not run the [ username ] .js file < code >
i had a function which will upload images from front-end and at the back-end will save the images to the static folder . after i updated next package from 9.1.2 to 9.3.2 front-end request the image file util i restart the next server < code >
i am finding the docs a little ambiguous . given a list franchises , we would like to render out the relevant franchise detail pages at build time to avoid hitting the cms/api at run time as these do n't change frequently . however , it seems that even if the relevant pages are generated at build time , they still require the calls in getstaticprops to be executed at runtime . this defeats the purpose of generating static pages . perhaps , i am doing something wrong , but i am looking for some docs/demo on how to generate static pages at build time using data from api that do not require any further calls at runtime to populate props . < code > import { withlayout } from ' .. / .. /components/layout ' ; import { getfranchises } from ' .. /api/franchises ' ; const franchise = ( props ) = > { console.info ( props ) ; return ( < > < h1 > { props.name } < /h1 > < / > ) ; } ; export async function getstaticprops ( { params } ) { let data = await getfranchises ( ) ; let franchise = data.find ( x = > x.id === params.id ) ; return { props : franchise } } export async function getstaticpaths ( ) { let data = await getfranchises ( ) ; // get the paths we want to pre-render based on posts const paths = data.map ( post = > ( { params : { id : post.id } , } ) ) ; // we 'll pre-render only these paths at build time . return { paths , fallback : false } } export default withlayout ( franchise ) ;
hi ! is there a way to remove the vieport tag of head . i find the viewport tag will antomatically be added to the page no matter what way i use . so , is there a way to remove the viewport tag of page ? thanks ! < code >
some of my website 's users reported a bug telling me they keep getting `` an unexpected error has occurred '' error.i could n't find any way to get exception detail from their devices.the only thing come to mind is checking application error log file to get stack trace , but could n't find nextjs error log file either.could you please tell me how can i debug my application ? < code >
when i generate my static html pages , i see that both on the home page and in the privacy policy , it is adding the same js and css files , is there any way to control that ? i apologize if this is a very basic question . < code >
bug report describe the bug a clear and concise description of what the bug is . similar issues have been extensively discussed , but i have n't found a concise answer for my particular quandary yet . i am managing this next.js project and want to use lerna to keep each component as a separate npm package within the src/ directory : expected behavior a clear and concise description of what you expected to happen . we should be able to ignore screenshots if applicable , add screenshots to help explain your problem . those lerna-generated symlinks have some issues though as users can access the individual components : system information os : ubuntu 18.04.2 version of next.js : ^9.3.4 < code > . form index.module.scss index.tsx node_modules @ tutorbook animated-checkmark-overlay - > .. / .. / .. /animated-checkmark-overlay arrow-btn - > .. / .. / .. /arrow-btn covid-fonts - > .. / .. / .. /fonts spinner - > .. / .. / .. /spinner package.json package-lock.json pages about.tsx _app.tsx index.tsx node_modules @ tutorbook covid-about - > .. / .. / .. /about covid-footer - > .. / .. / .. /footer covid-header - > .. / .. / .. /header covid-pupil-form - > .. / .. / .. /pupil-form covid-styles - > .. / .. / .. /styles covid-tutor-form - > .. / .. / .. /tutor-form next-firebase - > .. / .. / .. /firebase package.json package-lock.json pupils.tsx tutors.tsx
i am getting image path from the database which is { item.imagepath } , you can see in the img tag . it is not working , it says could n't find that module . `` ... path '' but when i put that hard corded path on the place of variable , it shows an img . mean with hard corded value it 's working and with variable it 's not . how could i solve it ? this error comes ! ! ! < code > { storedfiles.map ( item = > { // return < li key= { item.id } > { item.imagepath } < /li > return ( < div > < li key= { item.id } > { item.imagepath } < /li > < img src= { require ( ' < cur > { item.imagepath } ' ) } style= { { width : '' 100px '' , height : '100px ' } } alt='pics ' / > < /div > ) } ) }
hi everyone , i try to create a nextjs app with redux and redux-saga follow every guide and example i found but somehow it does n't work for me . whenever i reload my page every single api call i define in redux-saga will run without any action dispatch and no error found . i do n't know where it goes wrong , here the version i use : next : 9.3.4 redux : 7.2.0 redux-saga : 1.1.3 next-redux-wrapper : 5.0.0 next-redux-saga : 4.1.2 here is my repository if you want to see the error in detail github repo . thank you ! < code >
hello , i have a current legacy .net mvc application that we are looking to slowing upgrade . we are looking into using next.js . how do we create a link inside of our current application to open a new page built with next.js without leaving the current application . more so i would like to run the js files in a .cshtml file . is that possible and if so how ? < code >
it would be possible that next.js in dev mode could obtain the port from the environment if it existed and was not indicated by the -p ? example : docker-compose.yml package.json `` dev '' : `` next '' , < code > client : environment : port : < cur > { port_client } node_env : < cur > { node_env }
every now and then , our next.js app running on heroku will go down for no apparent reason . we reached out to heroku and the gist of what they said is that : our application most likely had a long running task going the heroku router ended that request dyno kept working on that task the router sent another request to the stuck dyno compounding effect occurred the heroku rep suggested the express timeout library which would help . without having to use our own express server , is there a way to tell next.js `` cancel any server side processes that take longer than x seconds and respond with a 408 '' ? < code >
hi , i 'm trying to log the request url that 's made that results in a 404 error . when i deploy my nextjs app with next start , i do n't get any request logging , so if someone requests a missing page , all i can do is log from a custom 404 page . so i can find out when the 404 happens , but i want the actual url that was requested . if i use userouter and log the request on the 404 page , of course the only path i can access is /404 , as that is what they got routed to . i tried seeing if getinitialprops or getserversideprops could tell me the actual requested url , but these are not permitted on the /404 page . how can i actually find out the actual requested url for a 404 ( or any other request for that matter ) ? or does anyone know a way to increase some existing logging that would tell me ? thanks < code >
hello ! why some chunks added twice : with rel= '' preload '' and rel= '' prefetch '' ? i think it 's caused these warnings from lighthouse < code >
after updating to 9.3.4 , the following dependency error occurred . as far as i know , plugins like postcss-flexbugs-fixes are built into nextjs by default , but should i explicitly install them now ? < code > > ready on < url > [ ready ] compiled successfully [ event ] build page : / [ wait ] compiling ... [ error ] ./assets/global.scss error : loading postcss plugin failed : can not find module 'postcss-flexbugs-fixes '
i 'm interested in using next.js for ssr , but i 'm not a big fan of javascript for api code in general . how easy is it to use next.js with an api server in ruby or flask ? what functionality is lost by using my own api server ? < code >
i need to build upon a external component , and i need to customzie its style . ideally , i should wrap that external component in a customized class , but at least right now , it is impossible to change the style of its children because the classnames are automatically hashed , and does not have a static name which the external library uses . if i were to import the .scss file in that component , next.js will alert me that i have to import global css in _app.jsx my current solution is to add that customized style sheet to _app.jsx . it works but is n't ideal . that stylesheet is relevant to that component only , and should n't be considered `` global '' < code >
i noticed that with the last version of next.js ( 9.3.3 ) the `` first load '' of all chunks is bigger than 9.3.1 does anybody have the same problem ? is it something normal or is my problem ? < code >
< url > when you go to /404 , then 404.js page is rendered . when you go to /doesnotexist , then the standard next.js 404 page is rendered . i 'm not sure what else i 'm supposed to do . the documentation ( < url > ) says to create pages/404.js which is what i did . < code >
hey , i am relatively new to web development and wanted to start a site with zeit.co and takeshape . i followed the documentation until the end and thought i did everything correctly , but i ca n't get the app to run even locally . this is the error message i get : `` error serializing .allposts returned from getstaticprops in `` / '' . reason : undefined can not be serialized as json . please use null or omit this value all together . '' i ca n't figure out what that means because i do n't yet understand the concept of staticprops . any help would be much appreciated ! < code >
the title of the discussion pretty much sums up what i want to do . but let me go into some more detail : with gatsby , inside your gatsby-node.js file you can automatically create pages using a page template and pass data into the template from a graphql query . i have had a look around and i ca n't seem to find any way to do this in next.js . /cc @ nikitavoloboev < code >
hi guys . first i would like to say how amazing the updates in v9.3 . i applied it immediately to my site and the results are blazing fast ! however , i got some confusion when i updated content for an existing blog article ( /post/ [ slug ] with getstaticprops + getstaticpaths ) . supposed i added new images and texts in cms side , how do i make sure those changes get reflected in production ? in development ( now dev ) the changes are instant without me needing to do anything . i followed the docs and i hope i did n't miss the instructions . i 'd be happy if someone could point , e in the right direction . cheers ! < code >
hey ! due to this < url > i 'm trying to upgrade to 9.3.2. however , after upgrading , our app does not start , because of a missing dependency : any clue about why this happens and how to resolve this ? < code > node_modules/next/types/index.d.ts:8:21 - error ts2307 : can not find module ' .. /lib/load-env-config ' . 8 import { env } from ' .. /lib/load-env-config ' ~~~~~~~~~~~~~~~~~~~~~~~~ yarn why load-env-config ~~~~~~~~~~~~~~~ yarn why v1.21.1 [ 1/4 ] why do we have the module `` load-env-config '' ... ? [ 2/4 ] initialising dependency graph ... [ 3/4 ] finding dependency ... error we could n't find a match !
hello , i have n't used the ssg on nextjs yet , but i have read about it and its really cool . i was wondering what would be the build time if i had to ssg for ~50k blog posts . i assume its gon na take ~30 mins based on server configuration ... but also , i was wondering if it was possible to ssg recent 100 blog posts and ssr the remaining blog posts. ? < code >
hi , is there a particular reason why the test coverage is not being measured in the ci pipelines ? from what i can find , next.js at one point in time did have support for measuring code coverage ( # 244 and c56fde89 ) and also published the results to coveralls , but this was eventually removed from the repository ( # 7689 ) . is there any reason for this ? < code >
bug report describe the bug next start a serverless build , still prompt me the error that require 'react ' , 'react-dom ' . i thought the react is inlined with the output , is n't it ? < code >
feature request is your feature request related to a problem ? please describe . i 'm trying to catch all errors in my website and sent them to slack so i 'm aware of all errors . i created an _error.js file and in getinitialprops i 'm sending the error to my back-end . it looks like this : pages/_errors.js now this works and is great , but most of the time i have no idea were the error comes from . i 'm missing information like in which file and line number the error took place . is n't this possible to retrieve this from err ? describe the solution you 'd like i would like to have more information from the error available like : < code > err.filename err.linenumber error.getinitialprops = async ( { res , err , req } ) = > { axios.post ( '/api/notifications ' , { notification : 'front-end error ' , url : req ? req.path : router.aspath , message : err ? err.message : 'something went wrong ' , status : err & & err.statuscode ? err.statuscode : res.statuscode } ) } )
bug report describe the bug hello everyone , in the project i 'm working on we require on a file which might exist or not : this causes a lot of module not found : ca n't resolve ' .. / .. /config/colors ' in ... warnings on the console . i tried to suppress these warnings by adding this line of code to the next.config.js config.stats = { warning : false } : expected behavior i expected , that config.stats = { warning : false } will prevent the warning from being displayed ( as mentioned here webpack/webpack.js.org # 147 ( comment ) ) system information os : ubuntu version of next.js : 9.3.2 thanks for your help ! < code > // imports ... module.exports = withstylus ( { webpack : config = > { config.plugins = config.plugins || [ ] config.stats = { warning : false } config.plugins = [ ... config.plugins , // read the .env file new dotenv ( { path : path.join ( __dirname , '.env ' ) , systemvars : true , } ) , ] return config } , } ) try { projectfonts = require ( ' .. / .. /config/colors ' ) } catch ( ex ) { // we dont need a catch handler here as the projectfonts are optional }
hello everyone , i am new to the whole react world and next.js however i have a lot of experience working with vue.js and nuxt.js ( vue 's alternative to next ) . there we have a function called nuxtserverinit which will only trigger when page is reloaded , or on initial application load . this means that when i am on some page and reload that function gets called and then the page specifics ssr method . i was wondering if there is something similar i can achieve here ? < code >
cache issue . no update after next-pwa implementation . need every time api should hit get latest data and update . after clear cache its called api . can anyone help how i fix this issue with next-pwa ? < code >
< url > following the with-firebase example , usercontext.js inits firebase and returns the user as expected when running in development mode with next , but when serving the output of next build , firebase inits , but user returns null . i 'm using ssg for most pages , so not sure if that has some effect . < code >
hi i was looking for a possibility to share props between pages in the ssg context . i read this comment : # 10933 ( comment ) and followed this discussion : # 11370 my request is slightly different : i use headless cms and the payload for each page consist of a json response similar like this : the only data which is unique for each slug is page whilst settings , staticelements , routes will not change . is there a way to write settings , staticelements , routes as static json into the cache and make it available inside of my app component on client render ? < code > export const getstaticprops = ( props ) = > { const { page , settings , staticelements , routes } = await getcontentfromstoryblok ( props ) return { props : { page , settings , staticelements , routes } } }
summary : our `` hero '' component has two states ; initially it gets fed with nulls and undefineds while the data/text is loading and then as the data has loaded , it renders the images and text in the data . we are using apollo-client with ssr , so it does a double-pass over the react tree to 1 ) trigger the download of the headless cms data and 2 ) render the react tree with hydrated data . however , on one of our pages ( only one of them ) we have this error on load : index.js:1 warning : prop classname did not match . server : `` jsx-349921261 '' client : `` jsx- < phone > '' all other pages work , but the data is obviously different between them . how do i debug what causes the different jsx class to be applied ? i get good output from the server ( as far as i can ascertain ) but this causes a re-load of all the headless cms data on the client , probably because the react tree ca n't properly re-hydrate . the code in question looks like this rendered : and this in source form ( appendix a ) . react messes up box tracking this would n't be a super-huge issue , had n't it affected the layout in a very strange way ; when the above warning happens , react messes up and loses track of the content in two boxes , so that it looks like this : when it really should look like : ( which it does when client-side navigating to it ) how do i debug/resolve this ? appendix a - source code appendix b cross posted here < url > < code >
let 's say i want to build a page such as /pages/article/ [ id ] , where the page in question will be server-side rendered based on dynamic data related to the article 's id fetched from a cms . i want data fetching to happen only on the server , so i 'm probably using getserversideprops or getstaticprops . let 's say each article has different kinds of data related to it , such as title , author , text , references or something like that , but i do n't want to fetch it all in one big lump at the page level . i want to fetch the data within each of the different components , so that i do n't have to pass props around , and can keep my page component something along the lines of : ... where title , author and references each get the [ id ] from userouter ( ) , and fetch the needed data by themselves . i know it 's possible to do something similar with apollo and usequery , where data fetching somehow is hoisted up to getinitialprops . so i guess i want some of the same , but with getserversideprops or getstaticprops instead . is this possible ? < code > const article = ( ) = > ( < div > < title/ > < author/ > < references/ > < /div > )
if i use graphql for instance inside the getstaticpaths only , will it get bundled into the production anyways even if it 's never used somewhere else at runtime ? the same thing for getstaticprops ofc , with the exception , that modules should get loaded when preview mode is entered , right ? < code >
i 'm working on debugging a nextjs project which i have downloaded from git . when i try to install its packages i get the error below : `` ./utils/validator.js module not found : ca n't resolve 'ree-validate ' in '/project/path/utils ' `` . i have tried installing the `` ree-validate '' separately but i still get the error above . how can i fix this issue ? < code >
i made an application with next.js and used node.js in the api part . i had no problems using it on my own computer , but when i run it on my server in digitalocean , the photos i uploaded from the administration panel are not shown . when i check the database and directory , there is no problem . the photo is being recorded there . section is correct when i enter the site and check it . when i wear path / file.jpg it gives 404 error . there is no problem in the previous recordings and it shows the photos . the photos do not show after running on the server . i made folder permissions 777 , but nothing else came to my mind . i did n't add code because i did n't think there was a problem with the code . < code >
router jump will send a request of json file , but the request path is loaction.origin + _next ... in this case , the server ca n't be send to right server by nginx , so router ca n't workhope router can support config request path < code >
i made an attempt at this in # 11453 , however i do n't think i 'm there ( the pr also addresses a different bug , `` shallow routing never happens unless the new route is the existing route '' ) i have n't found a way to not run getserversideprops . even if a route is cached , there is no way to disable it from running . is this by design ? < code >
this combination of packages is very shaky . both emotion and styled-components run into error : can not find module 'react-native ' with react-native-web . i am not sure yet what exactly is going on and how to fix it . looks like i need to tell babel / webpack to alias the `` react-native '' package to `` react-native-web '' inside node_modules/styled-components / node_modules/ @ emotion/native . i will look into it asap , if anyone has another idea , i 'd greatly appreciate it . would be also cool to have this extended in the with-react-native-web example other places talking about it : emotion-js/emotion # 1199 styled-components/styled-components # 2624 ( partly related ) < code >
hi , i would like to know the difference between _app with componentdidcatch ( err ) { ... } _error with getinitialprops ( { err } ) { ... } and where should i put my code for error logger ( i 'm using sentry ) ? < code >
what is this new `` discussions '' tab ? i 've never seen this github feature , it seems to be a beta feature , would you have any github official documentation about it ? ( i 'm interested for other projects ) also , is it meant to replace spectrum community ? or are you just trying things out ? < code >
so , i was using lighthouse today and something weird appear , the file styles.js takes 2.2 seconds to evaluate the content of the file is really small , < url > < code >
i have two page that need to get store information from the api ( i do n't think i can use getstaticprops because i have hundreds of stores all on different domains all using the same page ) . i want the / and /cart pages to both request the store info . currently i have them both hitting an api endpoint in getserversideprops , however even though its the exact same request , they both run it , and it delays render . is it possible to only run one , and disable the call to the other if the client already has the data ? alternatively is there a way to do this efficiently without getserversideprops or using getstaticprops with hundreds of stores using the same page ? < code >
`` getserversideprops always runs server-side and the code is automatically tree-shaken from browser bundles , ensuring that less code is sent to the browser. `` anyone have recommendations on tools or approaches to make sure server-only code ( esp . secrets ) have been properly excluded from client bundles ? < code >
hi guys , due to < url > i have on large websites a very high amount of prefetched data in my production build . it would be great if it would be possible to leverage the behaviour to change `` in-viewport '' to `` on-scroll '' . i 'm requesting this this mainly because i use intersection-observer for delaying images on my websites . now the data of prefetched pages are requested before my images and this results in a worse user experience than to disable prefetching . is there a solution to change that behaviour ? thanks for any input < code >
in the api-routes-graphql example , apollo-server-micro is used . i have also implemented this and it works perfectly fine as far as i can tell . however , recently the use of micro middlewares was discouraged in favor of using connect/express middlewares , which adds the need to write some boilerplate code to promisify express-style middleware . now , i 'm wondering if in above 's example apollo-server-express should be used or if there is a better solution ? < code >
i have read # 9524 and understood static and hybrid advantage . to use redux , i use next-redux-wrapper now . kirill-konshin/next-redux-wrapper : redux wrapper for next.js this library is not compatible with auto partial static export feature because of getinitialprops in _app.js in the future , i want to use getstaticprops and getstaticpaths to build a hybrid application ( jamstack ? ) . is it better not to use getinitialprops in _app.js ? is using redux incompatible with hybrid applications ? i 'm excited about ssg improvements and new apis . 👍 < code >
i have a app which bases on nextjs framework everytime i run syntax `` npm run build '' , the app will generate static files ( html and css ) . and put it to folder `` out '' . this is my app and structure : < url > this is my process : < url > but the process is really slow . it spent 4 hours for export 1815 pages . and i have no idea how to optimize process speed . thank you everyone . < code >
hey , my dynamic routes work fine locally , but when i deploy my project to zeit now , server-side rendering of my dynamice routes does n't work and i get the 404 : not_found screen from now . they work however when accessed through the client-side . i will be happy to provide additional info . < code >
bug report describe the bug i have a nextjs application , which supports pretty url like : < url > or < url > it is exported to work behind gitlab pages . the slugs are loaded from the backend over a request . the home page lists them . when going from the home page to the slug based url , the pages are working . however , if i refresh the browser when already on the above mentioned url , it shows a 404 page instead . to reproduce steps to reproduce the behavior , please provide code snippets or a repository : go to < url > click on balance or learn images shown after the page is rendered , refresh the browser tab . it should display a 404 error on refresh . expected behavior instead of the 404 page , i 'd assume that the dynamic routes would come into play and render the actual content . additional context it is a closed source application ; i 'd not be able to share code snippets . < code >
hi guys , i read through the new exciting 9.3 release and i am wondering how i would get these goodies into my current ssr rendered website kit ( storyblok cms + nextjs ) . what would be the best practice to get this seamlessly integrated into project - for example to run a build task if a cms admin decides to bring changes online and hit a ready to release button somewhere in the headless cms . i want to continue using zeit/now for my websites so i am curious how that would look like . thanks for any hints ! < code >
hello , i 'm having some problems trying to disable the ' x-powered-by ' header . i do n't have a custom server and i 'm using next 9.3.1. next.config.js file when i do npm run dev when i do npm run build and npm start any solution or idea ? thanks . < code > module.exports = { webpack : ( config , { webpack } ) = > { config.plugins.push ( new webpack.ignoreplugin ( /\/__tests__\// ) ) ; return config ; } , poweredbyheader : false , env : { bff_url : process.env.bff_url , bff_token : process.env.bff_token , recaptcha_key : process.env.recaptcha_key , } , } ;
i could n't find anything about thrown errors in getstaticprops in the docs . for example when an api request fails . i hope that this would cause a build error ? if not , that could cause compiling an error into the static page undetected , being fatal on deployment . if it would cause a build error , still we would need to not use try/catch for api calls , otherwise we would run into the same issue . < url > < code >
feature request using next for server-side rendering or api routes must be done in a node.js runtime . this is because the next package is tightly bound to node.js preventing using other runtimes like deno , electron or even the browser ( which now has things like native filesystem support ) . it would be helpful if the core functionalities of next were abstracted from node.js . this would be similar to the way a database abstraction layer would work . effectively next would have `` adapters '' ( or something like that ) for different runtimes . the default adapter ( and the only one in core ) would be a node.js adapter , but other adapters could be created in userland . the next app would receive its necessary dependencies from the adapter . for instance it might get the parsed url and a list of routes with regexes and callback functions to call to get the component for that route . the adapter might also provide a callback to determine the proper _app.js and the like . having a clear and documented interface for what an adapter should look like ( and obviously a node.js example ) would be really helpful as well . : ) describe alternatives you 've considered reimplementing all of next for a different environment seems like a ton of work . : ( perhaps shimming the node.js apis for a different environment , but that 's also a can of worms . < code >
i want to test redirection of page when click on div wrap by next/link my test file looks like this im still not expect anything but it still this error error : uncaught [ error : no router instance found . you should only use `` next/router '' inside the client side of your app . ] i 'm looking for and appreciate your helps , thanks < code > import link from 'next/link ' < link href= '' /home '' > < div classname= '' test '' > home < /div > < /link > import { mount } from 'enzyme ' ... wrapper = mount ( < testheadercomponent / > ) ; await wrapper .find ( ' . test ' ) .at ( 0 ) .simulate ( 'click ' ) ;
hello ! first , thanks for this amazing project ! it looks really awesome and i 'm loving it ! ! however , i 'm having lots of troubles setting up adonisjs ' websocket client library in the documentation says but how do i do that ? right now i 'm trying in .babelrc but that throws me an error saying : can not find module '/users/mike/batcave/workolam/frontend/.next/server/static/development/pages/_document ' so , how should i import it ? question number 2 : once i resolve that ... how do i import the library so it only loads in the client ? i would really like to be able to use nextjs as a frontend with adonisjs as a backend . but this configuration error is tearing me down : ( if anyone could indicate me what steps i should follow , that 'd be amazing ! thanks in advance < code > the module build requires the regenerator-runtime polyfill ( add it via babel ) . { `` presets '' : [ [ `` next/babel '' , { `` preset-env '' : { } , `` transform-runtime '' : { } , `` styled-jsx '' : { } , `` class-properties '' : { } } ] ] , `` plugins '' : [ `` @ babel/plugin-transform-regenerator '' ] }
hey team , i 'm hitting some issues with swr not running on the initial mount of a next.js application running with getstaticprops for ssg . here 's a video of this in action : < url > what i 'm doing : load < url > initial render is old data that was computed at build time see the ( expired ) first link unfocus / refocus the tab and you can see swr kick off and get fresh data from the database my question is why is swr not getting fresh data on the initial mount , and only on refocus ? my impression is that it should run for both events . url where it 's happening : < url > code : page : < url > fetcher : < url > edit : it seems entirely more simple to just migrate this specific page to use getserversideprops in fact , i 'll probably make this change right now . but the question still stands , especially as static generation becomes more common in next.js land , so i 'll leave this post up for possible tips on making these two tools work better together ! < code >
i have a custom _app used in numerous projects so i wanted to move it to an external package . all of my apps would look like this : _app.js i ca n't seem to get this working if i have global css inside of the customapp due to this error : has anyone been able to get around this ? i found numerous related issues but not quite the same as this one . thought i would ask here first . < code > global css can not be imported from files other than your custom < app > . import customapp from 'package ' ; export default customapp
i 'm deploying a next.js to google cloud app engine . whenever i deploy the project to ae with multiple instances , it throws this error : net : :err_aborted 404 for one of the core files . any advice ? this is a huge problem . < code >
hi , i have a dashboard section in my next app i want to serve as a static page . the dashboard implements client-side routing so i have paths like /dashboard/path/ .. /to so my folder structure is pages/dashboard/ [ ... all ] .js and that file handles the routing the dashboard needs some data i am currently fetching with getinitialprops . but in this way the page is interpreted as server side rendered . since the data is always the same ( for every user ) i am trying to use getstaticprops to serve the page as static . but due to the folder structure next thinks i need the parameters to fetch data so i must provide a getstaticpaths function and since [ ... all ] changes every time my page will be rendered again on each request . does anyone know how to solve the issue or some workaround ? thanks < code >
thanks a lot for the great example : with-next-sass . i was wondering if there is a way to use the global variable < cur > backgroundcolor ( styles.scss ) inside 'hello-world.module.scss ' ? < code >
hi how i can send a custom response and message on status 400 , on front-end , i do n't receive the payload data if not status 200 < code > try { let response = await.post ( ... ) console.log ( response.data ) } catch ( error ) { console.log ( error ) // i cant get the payload passed here if not status 200 } export const ( req , res ) { // external api call const response = await axios.post ( ... ) //handle response res.status ( 200 ) .json ( response.data ) // if has an error res.status ( 400 ) .json ( response.data ) }
i have n't ran into this before . i 'm setting up a new project using next v 9.3.1 , and i 'm getting this error when trying to use react fragments . it was n't a problem on my last project in next v 9.1.1. has something changed ? i have no .babelrc file . i 'm using typescript v 3.8.3 and react v 16.13.1. i can provide more context if yall think its an app setup issue . i just want to make sure this is n't `` expected '' or something . < code > transform-react-jsx : pragma has been set but pragmafrag has not been set
hi , i have created a file env.js with variable eg : api_url = `` < url > '' in next.config.js , i have used as require ( 'dotenv ' ) .config ( ) const path = require ( 'path ' ) const dotenv = require ( 'dotenv-webpack ' ) webpack ( config ) { config.plugins = [ ... config.plugins , new dotenv ( { path : path.join ( __dirname , 'env.js ' ) } } ) ; after that , when i do console , its not printing the variables defined in env.js console.log ( process.env ) can someone help on this ? < code > } ) ] return config ;
i have a working api route ( confirmed with postman ) at `` /api/auth/emailavailable '' i want to call this api route from another api route , `` /api/auth/register '' , so i did this : for some reason the response is always either a 400 with error , or an empty object . i also get this message in the console any idea what could be wrong ? < code > api resolved without sending a response for /api/auth/register , this may result in stalled requests . api resolved without sending a response for /api/auth/emailavailable , this may result in stalled requests . handler.use ( async ( req , res ) = > { axios.post ( process.env.root_url + `` /api/auth/emailavailable '' , { email : req.body.email || ' ' } ) .then ( subres = > res.json ( subres ) ) .catch ( e = > res.json ( e ) )
hi all , i have been working on a rather large nextjs application and wonder if this discussion has come up before . i have a lot of different pages , and am interested in moving my api routes outside of the pages directory to help better organize the project . is there any way currently to do this , perhaps through next.config.js ? < code >
i 'm wondering if there 's a way to use the same configuration used to import css as next.js uses within storybook . currently , i 'm using a custom webpack config but maybe one of the maintainers of next.js can point me to a place where i could potentially use both the proper babel config and webpack config to get the css to load . < code >
i 'm using next.js 9.3 and getstaticpaths with fallback : true . in my page component i 'm checking for isfallback and rendering a spinner on fallback and an 404 error page if props are missing : while development opening an uncached pages shows the spinner and after loading everything my component , but on production the 404 error page is shown instead of the spinner . how can i make sure that my component is build with the spinner as default ? < code > const location : react.fc < locationprops > = ( { location } ) = > { const router = userouter ( ) ; // fallback if ( router.isfallback ) { return ( < spinner / > ) ; } // no location found if ( ! location ) { return < error statuscode= { 404 } / > ; }
i have a node.js server ( which is primarily just responsible for authentication via passport . running locally i use next build and i build my own app , which is in typescript , and everything works perfectly . i 'm trying to deploy to ibm cloud and no matter what i 've tried , deploying the app has been a massive pain for me . using cf push locally pushes all files ( including .next ) and tries to start the app but i always get the following error : error : could not find a valid build in the '/home/vcap/app/next ' directory ! try building your app with 'next build ' before starting the server . the only workaround i could find was to hackily move all my dev-dependencies to dependencies and then add next build to my start script . that was working ( albeit incredibly janky ) but as of yesterday , i 'm now getting a different error : error : /home/vcap/app/src/components/layout.tsx : transform-react-jsx : pragma has been set but pragmafrag has not been set what is the right way to build my app and deploy ? was that first error being caused by something being different like the node version or the target ( i.e. , macos to linux ) ? thank you for the help ! < code >
i 'm writing a multi-tenant application that needs to support custom skins for each different property . one of the things that makes that skin work is custom css includes ... i can get the necessary content as part of getinitialprops in my _document.js file , but i ca n't figure out how to inject the content into the page . my first thought was to use a fragment inside the < head > element , with a __dangerouslysetinnerhtml attribute , but as far as i can tell fragments do n't support any attributes . it 's starting to feel like i 'm barking up the wrong tree . i assume there 's got to be a way to accomplish what i want to do . what 's the next.js way to do it ? < code > < link type= '' text/css '' href= '' ... '' / >
i installed the socket.io example and i noticed that the socket instance is made in two places , on the hook and also on the _app.js the thing is that whenever i import the hook it will make a connection automatically and it will also make a connection because of _app.js ( the server receives 2 connections ) , what is the reason to use in both places ? < code >
thanks for an amazing library ! i 'm new to next.js so i 'm looking to start a discussion for what 's the best way to solve this : i 'm using persisted redux using next-redux-wrapper with localstorage and until now most components connected to redux with mapstatetoprops and selected data using reselect . what i have now is a dynamic article page which should be seo friendly but which can also show client specific info if the user is logged in like save article / article already saved . how can i properly return the page info using getserversideprops when landing on the page , but when using transitions from other pages use the data that is already available in redux store ( get articleid from query and use a selector for getting data and pass it to props with mapstatetoprops ) and not let next.js make a new request like it is mentioned in the docs ? 1.1 also if the user has already logged in and the data is persisted in localstorage , how can i get that data instead of making a new request on server side ? if i have thousands of article pages and also if i want to create client side features ( save article ) is it feasible to use ssg ( getstaticprops and getstaticpaths ) ? < code >
hey guys ! some background : we use next.js with a custom express server & have cloudfront configured to hit the next.js app . was wondering if the contents of the `` out '' folder after doing next build & & next export can safely be cached `` forever '' ? had some concerns since i do n't see a hash on some of the files .. for example : the [ 0-3 ] .js chunks : - the specific issue we 're having is that after a new deployment , some users start seeing 404s on the old server 's assets ( since that server is brought down ) . came across this gist but not sure if this is up to date ! < code >
hi there , i essentially want to know how would you implement a statically generated website/app where you would have routes like : /app/ [ slug ] /dashboard /app/ [ slug ] /settings /app/ [ slug ] /team knowing that dashboard/settings/team all share the same layout/nav and only the content changes . i am trying to wrap my head around the right solution but unsure if it should be : app/ [ slug ] /dashboard.js and app/ [ slug ] /settings.js or app/ [ ... slug ] .js where in slug.js i would switch/case then for the layout itself , in both solutions , not sure what to apply . let me know ! < code >
hi guys i am using currently ssr but might will switch to ssg . i have a few deep nested components which requires a fetch call to an api . how could i solve this ? for seo reasons it would be important that the nextjs render waits till all data is present . inside of pages i make use of initialpageprops but how to do this outside of the pages ? thanks < code >
is it possible the consume an internal api of a next.js project ( e.g . : pages/api/post.js ) inside getstaticprops ? if yes ; how ? example : before ( in getinitialprops ) we had the request object of node ( ctx.req ) that allowed us the retrieve this url from some headers . < code > export async function getstaticprops ( context ) { // the following url must be absolute // but what is the correct origin/port ? const url = '/api/post ' return { props : await fetch ( url ) .then ( res = > res.json ( ) ) } }
hi , after dealing with the # 10148 error using css modules with a global style , we moved trying styled-jsx ( with sass ) . i noticed that in production mode using the 9.3 version the style tag rendered in the head missing , applying the style only after rehydrate the page with a terrible initial effect ... upgrading to 9.3.1 all start working fine but i ca n't understand why 🤔 < code >
we have a yarn dev script like this : the -c flag of pino-pretty means `` colorize output '' , but i still do n't see the colors : vs. plain next dev which is colorful : is it next cli that 's not sending the escape sequences when piped into pino-pretty ? < code > { `` scripts '' : { `` dev '' : `` next | pino-pretty -t -c -s `` level > '30 ' '' '' }
hello , is it possible to display _error.jsx without reloading the entire page ? apparently it has been patched , but i still have this problem . < code >
feature request is your feature request related to a problem ? please describe . what i 'm trying to accomplish is with dynamic routing have a substructure as so : full path - for each subroute we would need a seperate page ( specific page component as well ) / [ lang ] / [ overview-slug ] / [ brand ] / [ model ] / [ id ] note that overview-slug is language specific /nl/overzicht /nl/overzicht/audi /nl/overzicht/audi/a3 /nl/overzicht/audi/a3/ < phone > -123123-123 describe the solution you 'd like previous question describe alternatives you 've considered used to work with next-routes , but currently unable to export additional context basic repository for reproduction : < url > < code >
imagine i have a search result page with first 5 results on ssr next each 5 items are lazy loaded ( infinite scroll based on intersection observer ) from client side , all being pusehd into a redux store . now lets say i have clicked on 22nd item after few page scrolls and it takes me to a product page . when i click mobile native / browser back button , i want it to take me to the same item with same results without rerendering . codesandbox < code >
i have about 40,000 movie . each movie has it 's own dedicate page . with url like this : < url > that dedicated to movie number one . most data of this page are static . title , image , movie info , people comments and ... .but some data are about user like : user name , profile image , is he/she liked this movie ? , is he/she bought this movie ? and so on . i have 2 big challenge here : how to create static pages that have static info ( movie info ) and then get user info in client side . if one movie added or one movie updated , how to add or update only that page ? and not build all of them ? thanks for your patience . < code >
according to the docs : < url > the data required to render the page is available at build time ahead of a user 's request . it sounds like that getstaticprops should fetch the data at build time . in the beginning , there is no corresponding data ( json ) in the build folder for a page . on the first request ( while running with next start ) , i go and fetch it from my data source first , populate a file then only after that , the subsequent requests will use this file . i have more details on the issue , but first i would like to clarify if this is intentional behavior , or i do something wrong ? in the latter case , i can try creating a reproduction example . < code >
feature request currently , for hybrid pages , i think ? amp=1 is the only way to tell next to do all the amp goodness . wondering if it 's a good idea to be able to override this behavior . if there is another way please let me know ! is there somewhere we can rewrite query params more generally ? is your feature request related to a problem ? please describe . we have various apps that are all behind the same cdn / origin that use a different url parameter to know whether to render amp or non amp . not all of these applications use next and in general we 'd like to be able to customize the behavior of next to continue using our internal conventions that differ from ? amp=1 without handling nextjs traffic too differently . describe the solution you 'd like new to looking at this code in too much depth , but it looks like this bit here would have to change . i 'm not sure whether this is best to be configured in the userconfig ( next.config.js ) or on the pageconfig . < url > describe alternatives you 've considered i think we could probably solve this problem by doing url rewrites etc . at our cdn / nginx or whatever to hide this bit of nextjs behavior from the rest of our stack but i 'd like to be able to use the same url scheme 's in development that we do in production without jumping through hoops . willing to try pr'ing this if it sounds like a good idea . < code >
so in your custom app and document examples , the getinitialprops method is used . but the two new methods ( getstaticprops and getserversideprops ) is preferred instead of getintialprops when using next js version 9.3 or newer . so what is the `` new right '' way to implement server-side data fetching in the custom document and app component using next js 9.3 ? < code >
i have .ts modules in pages/api and next dev ( v9.3.0 ) is evaluating them as expected , but breakpoints are not being respected . has anyone else figured this out ? might need to tweak the webpack config to support source maps for the compiled serverless functions ? edit : hmm , guess not . < code > node_options= '' -- inspect '' node_modules/.bin/next dev
in < url > it is stated , that `` the page has an user-accessible ( optimized ) version of the page and a search-engine indexable ( unoptimized ) version of the page '' . how can i access the unoptimized version ? how does this work ? is it dependant on user-agent or just not having js enabled ? < code >
this is how i am currently accounting for different types of api requests . /pages/api/user.js it works fine but the file can get quite large after adding a bunch of stuff , most of the time unrelated . has anyone been working with a better organizational structure ? < code > export default ( req , res ) = > { if ( req.method === 'post ' ) { // process a post request } else { // handle any other http method } }
hi , so currently i have an issue with importing css from node_modules only where i need it . in my _app.js i import the global css , but i need to import a css file from a package in node_modules only in a certain page which is rarely opened . without using modules i have no other way but to import it also globally in _app.js and thats a problem since the css is quite big and loads on every page . so my question is how can i import 'node_modules/package/index.css ' only on the page i need it to without using modules . using next-css works but breaks some of the features of the canary release im on ( 9.3.1-canary.6 ) . < code >
i was glancing through css documentation for global css < url > and there is a section there mentioning following : in production , all css files will be automatically concatenated into a single minified .css file . i wanted to start discussion and ask why this is done , as i was under assumption that due to http2 it is better to keep them split into more files . or is my assumption wrong and for css it makes sense to keep it as one file ? also , i wanted to check if we already have some sort of setting that can disable this and keep css files as separate , if not , should this be considered ? < code >
e.g . if i have a page called a.js , b.js , and c.js in each file it looks like this a.js b.js c.js each page will fully reload regardless of the shallow prop on the link and the state is lost . i would assume pages should be diffed so how can i get this behavior to work ? < code > import progress from `` .. /components/progress '' ; import link from `` next/link '' ; export default ( ) = > { return ( < div > < progress value= { 1 } / > < link href= '' /a '' shallow > < a > next < /a > < /link > < /div > ) ; } ; import progress from `` .. /components/progress '' ; import link from `` next/link '' ; export default ( ) = > { return ( < div > < progress value= { 0 } / > < link href= '' /b '' shallow > < a > next < /a > < /link > < /div > ) ; } ; import progress from `` .. /components/progress '' ; import link from `` next/link '' ; export default ( ) = > { return ( < div > < progress value= { 0.5 } / > < link href= '' /c '' shallow > < a > next < /a > < /link > < /div > ) ; } ;
i am trying to export static site to a set of * .html files . they can later be served by any http server . the problem is that from a client view everything works , and requests to /somepage result in fetching /somepage.html . but if i refresh such page to get it from server directly , i have 404 error unless i add the html extension like /somepage.html . in same cases it is possible to instruct a server to try known extensions like html or htm for requests without extension ( multiviews for apache ) . sometimes it is not possible . is there any recommended way to refer to pages with full names ( with .html extensions ) when exporting a static site ? ps . sufficient option could be to generate files without extension , that is , not page.html , but just page . how ? < code >
qquestion description : if i 'm using a third-party component with a global style , all third-party components are bundle into chunks . example : i have a component library styled-jsx-lib-app ( demo ) after running next dev , you can see that the global style is directly rendered : when i publish the library to npm and use it in another project : styled-jsx-user-app : this third-party library will always be in the chunk : i want : i want to include this base style component when rendering on the server , what should i do now ? some of the solutions i 've tried : publish .css file to npm , and import in the _app.js of next.js . this works , but i still want to publish a component if possible . use flush from styled-jsx/server in _document.jsx . not work , flush always return [ ] . < code > import { basecsscomponent } from 'styled-jsx-lib-app ' const home = ( ) = > ( < div > hello , i am using library 'styled-jsx-lib-app ' . < basecsscomponent / > < /div > ) const basecsscomponent = ( ) = > { return ( < div > < style global jsx > { ' html { font-size : 30px ; } ' } < /style > < /div > ) }
this post heavily references this closed bug : # 8119 i found the above github issue when searching for an answer to that question . i implemented the solution mentioned by @ devisscher ( utilizing exporttrailingslash ) but as @ jaredpereira noted , this results in more files than ( at least i ) expected being created : notably , in my project : out/index.html and out/index/index.html out/404.html and out/404/index.html @ timer mentioned something was intended behavior but i 'm not sure if they were referring to these duplicate files or just that `` an index file does not imply a trailing slash '' . is my output described about actually intended ? if so , is there a way to get a /about type of route without getting duplicate pages ? thanks ! < code >
i could imagine being able to remove paths based on preview mode would be useful for build-time optimization . eg . working on notion-blog ijjk/notion-blog # 22 it became clear that you would want to fallback in the case of an unpublished post so that time was not wasted on the production build generating pages for unpublished posts . < code >
almost 20 of the running node processes are fork-ts-checker-webpack-plugin and it making my development experience terrible because my computer of 12gb ram kept on running out of ram memory every now and then is there anything that i can to stop this ? < code >
add page/index.js to empty project , and includes these code : then i use next build command , it 's print correctly in console . next start also work well but when i request < url > in browser , the console log repeat every request except the first request . i check .next dir , the index.html generated correctly , but why the request trigger it generate again ? but when i copy the code to any other page , there is no problem , no console words out did i miss something ? < code > export default ( { number } ) = > { console.log ( `` index render '' ) ; return ( < div > < h1 > index : { number } < /h1 > < /div > ) ; } ; export async function getstaticprops ( ) { console.log ( `` index getstaticprops '' ) ; return { props : { number : 1 } } ; }
hi , for my project i needed to pass a variable from webpack to scss which i managed to do in v9.2.2 but since updating to 9.3.0 it does n't seem to work . this is my current code : webpack ( config ) { let isdev = environment ! == 'production ' ; config.module.rules.foreach ( rule = > { if ( rule.test & & rule.test.tostring ( ) .includes ( '.scss ' ) ) { rule.use.foreach ( el = > { if ( el.loader & & el.loader === 'sass-loader ' ) { el.options.data = ' < cur > isdev : < cur > { isdev } ; ' ; } } ) } } ) ; return config ; } < code >
hi. ! i want to take a look on hydration process in next.js , but there is n't any kind of docs for that 😢 so i wanted to take a look on hydration in the source code . i am mostly interested into the part , where next compares the prerendered html from server to the frontend html generated by js . any suggestions would be helpful . ✌️ thanks and have a beautiful day 🦋 < code >
i 'm curious , is the plan to replace the spectrum community with this new github tool ? i like that it would keep everything centralized , but at the same time feel like the feature is still kind of raw , which is expected since it 's an experiment . also , is the plan for discussions to be like a forum board with categories and everything ? < code >
we need to display the origin on our page . but we find that it is no way to get the protocol ( http or https ) on server side in getinitialprops . then we find next-absolute-url . but it can only deal with 'localhost ' . if we add '127.0.0.1 < url > ' into host file and we type ' < url > in browser , we get https returned by next-absolute-url . so , is there a easy way to get the true protocol ( origin ) in getinitialprops ( return exactly the same to location.protocol on client side ) ? < code >
from the documentation i understand that getserversideprops causes more requests to the next server : when you request this page on client-side page transitions through next/link ( documentation ) , next.js sends an api request to server , which runs getserversideprops . it 'll return a json that contains the result of running getserversideprops , and the json will be used to render the page . < url > i would need to measure , but it sounds like this could make scaling up the next servers necessary on high-traffic websites , going along with higher costs . i understand that it provides different benefits , like smaller response payloads , and not having to have isomorphic code in that function . in the end it 's a tradeoff . since getinitialprops is now discouraged , will users of the framework be able to decide which end of the tradeoff they want to use in the future ? < code >
i think that this paragraph in the docs is incomplete : [ ... ] time to first byte ( ttfb ) will be slower than getstaticprops because the server must compute the result on every request , and the result can not be cached by a cdn without extra . i wanted to open a pr but i do n't know what the author wanted to say here . maybe @ chibicode and @ timneutkens , or anyone else , can answer this . here is the link to the docs paragraph and a screenshot : < code >
bug report describe the bug i am trying to import a custom element written in preact using dynamic import . the custom element is loaded into the dom but the page does not seem to get hydrated . to reproduce if you open the sandbox the page gets loaded , but it should print `` mounted '' in the console . it should also console if you click on `` click me '' . < url > expected behavior loading custom and javascript gets hydrated without errors . system information version of next.js : 9.2.3-canary.28 ( also tried 9.2.2 ) preact : 10.3.3 react : 16.13.0 how do you recommend loading an external custom element inside a .js/.ts file ? < code >
in the getting started docs the setup section says : - instead of create-next-app while a line above it says create-react-app . i think it is wrong ? < code > npm init next-app yarn create next-app
hello ! i have an app that uses withauthsync from the [ next-cookie-auth example ] ( < url > ) . this works to ensure all of my wrapped components have user data at render , but how do i access user data when i 'm doing data fetching ? for instance , i want to pass along user data ( like a user id , or a role or type etc , in my case it 's an array of languages the user can translate ) while calling getinitialprops . my question is : how do i make use of component props in a data fetching call ? that function only receives a context object , which has no props . is the issue that this function is running on the server and therefore has no notion of component props ? what 's the recommended way to use user data , or any props for that matter , when fetching data for components ? what i 'm doing now feels hacky , i essentially check if we are in the browser , if so , get the user data from local storage , otherwise , check for a cookie token then and call a function to refetch user data from the db ( this only happens when the refresh button is used , from what i can tell ) . any help appreciated ! thank you < code >
in next ( react ssr ) , i try to render a page use like this in server side , correct render and console is in webside dom render correct one time , but soon throw error to empty page , console is so , how to keep correct to render the common element . < code > { ' < cur > typeof ' : symbol ( react.element ) , type : [ function : header ] , key : null , ref : null , props : { result : 10 } , _owner : null , _store : { } } // this common element , so much project use this , in my private node_modules const header = ( { result } ) = > < div > { result } < /div > ; const rendercomponent = async ( ) = > { // mock some request const result = await promise.resolve ( 10 ) ; return < header result= { result } / > ; } ; static getinitialprops = async ctx = > { return { element : await rendercomponent ( ) } } render ( { element } ) { console.log ( element ) return element } { key : null , ref : null , props : { } , _owner : null , _store : { } } key : null ref : null props : { result : 10 } _owner : null _store : { } __proto__ : object
next.js list of links and resources . repo nextjs repository ( you 're here on its discussion tab , inside a discussion . ) docs nextjs docs showcase showcase examples using nextjs companies / sites using nextjs disccussion blog official blog blogposts next.js 9.2 next.js 9.1.7 learn nextjs basics getting started navigate between pages using shared components create dynamic pages clean urls with dynamic routing fetching data for pages styling components api routes deploying a next.js app excel export into a static html app typescript lazy loading modules lazy loading components create amp pages automatic static optimization p.s : this might somewhat be redundant to awesome-nextjs i guess . but i 'm gon na go ahead anyway , it 'll be useful for me myself at least , hope it is also useful for the community . please do share your links and i 'll do my best to keep the index/first post updateed < code >
i 'm thinking about a use case where i want to use ssg for high-traffic landing pages for seo and for reducing the server load , but still want current data to be used after hydration , and on client side routing to this page . would that be possible ? so basically on client side routing to this page , the behavior should be like getinitialprops ( current data is fetched before the page becomes visible ) . and on server side routing to this page , the static html should be served and hydrated , and then ( optionally ) some api responses fetched to update some data on the page . < code >
i have analyzed my pages and noticed that iconv-lite is actually the nearly a half of my pages bundle size . nextjs has enabled tree shaking as default , what i have gathered from several topics , but i have the feeling something is not right . i setup an empty page . i have no imports in _document or _app , and this is enough for the following content : is this the normal page size ? or did i miss anything out there ? i have no .babelrc or anything else . my source code from the analyzed image above is here : < url > the page is at src/pages/event/ [ eventid ] .tsx my build output for this page : i have the feeling that something is not correct there , but it is just a guess . when using gzip compression , the iconv-lite is actually more than the half of the my bundle : i 've also looked thru the json files , they are mostly some chinese/japanese characters , i 'm pretty sure i do not need them at all in my app or require any encoding for them . < code >
hi , i want apply feature static exporting for static-fun project ( < url > ) ex : i have a add a button `` deploy page '' in static-fun backend pagelist : subdomain1.static.fun | deploy page subdomain2.static.fun | deploy page subdomain3.static.fun | deploy page when click deploypage button on subdomain1.static.fun system will run a service to export static for subdomain1 when click deploypage button on subdomain2.static.fun system will run a service to export static for subdomain2 after , when user open subdomain1.static.fun on browse . if it static file exits page will load from this . else page will get page info from database . how i cant do this . thank you so much ! < code >
hi there , in my front page , i have made query data from cms and passed to the front page : below is the piece of code in my exportpathmap function : and in my index.getinitialprops ( ) function , i did the same api call and return it as the initial props : coz i have followed the tutorial from here : fetching data for pages < url > i 've checked the server request logs and found that during the page is rendered in server side , the api will be requested . it 's fine . when jumping to other page and going back to the front page ( using < link > not < a > ) , the index.getinitialprops ( ) gets called again and so does the api endpoint call . is this the normal usage ? i think it 's not 100 % static . suppose the api end point can not be accessed for the public . it must be used during the build and export phase . the index.html must be generated in early time and content should be generated to meet the seo purpose . so what is the recommended and correct usage in my case ? thanks ! ! ! ! ! < code > index.getinitialprops = async ( ctx ) = > { const res = await fetch ( some_endpoint ) ; const data = await res.json ( ) ; return { data } } const res = await fetch ( some_endpoint ) ; const data = await res.json ( ) ; const paths = { '/ ' : { page : '/ ' , query : { data } } } ;
hi ! i 'm trying to host a fully statically exported next.js site on both dns as well as ipfs . so far , i 've achieved this by using a build-time flag , and optionally prefixing a tag hrefs , img tag srcs , etc. , with ' . ' with a custom base tag so that my site can be served on e.g . < url > i also have to make assetprefix ' . ' when building for ipfs . the problem is that once i 'm > 1 route deep , assetprefix breaks , as it begins looking for shared _next resources relative to the current path , whereas it should actually be looking relative to my custom base tag . one solution to this may be a dynamic assetprefix , but as far as i can tell this is impossible in statically exported sites . is there another possible solution that i 'm missing ? < code >
as i 'm relative new to react/nextjs , i 'm wondering what options do i have to optimize my app , so any help is really apperciated , i 'm happy to learn new stuff and things ; - ) my target groups are currently mobile users . as i have a lot of repeating stuff over the pages , i am using the next-redux-wrapper and limited everything to the data that is required to be loaded . to handle network issues , i am using additionally next-offline to provide a service worker . my website and the related source code my only concern is the first , non-cached , page load . for desktop everything appears to be fine , but looking over on mobile devices the page appears to be slow . i have frequently 4s+ load times as the load on the parsing/main-thread work takes too long . i have reduced the bundle size by over 50 % the recent two days just by upgrading antd and removing any icons and replaced them with inline svg 's . i have still a lot of weird stuff in my bundle that ships with antd but i am not using ( i am using tree shacking ) , but i think that further reducing will not resolve the issue completely . i'am mostly wondering whether the opt out from automatic static optimization is causing this issue ? is the optimization that good , that it can change over 4 seconds load time ? i have another page which is using it ( no redux ) and it has skyrocking performance on mobile devices comparing to this website ( i 'm only talking about the first , non-cached load ) . < code >
feature request is your feature request related to a problem ? please describe . when running the application in docker , it 's common to access the container using their names , either by having them on the same network or using the link option . for the requests that do n't go through ssr , the value of the environment variable defined with publicruntimeconfig will also be used even when requests do n't go through nodejs . not always the value defined there ( for example , a backend url ) will be accessible from the host . describe the solution you 'd like i would like to split the publicruntimeconfig configuration option ( or introduce a new ) that allows different values to be configured , depending on if the request is going to be sent from the browser or from the next server for ssr . describe alternatives you 've considered use docker inspect on the container and pass as environment variable the ip , which is the same either from inside another container or from the host . add an alias to my container name on my /etc/hosts file < code >
i am using react concurrent mode , when route changes , i 'd like to stay at current page for a while and also show a progress bar at the top of the web page . any way to use router.push with usetransition < code > const usetransition = react.usetransition ;
in the catch all example you have a structure like this post/ [ ... slug ] .js and it says it can capture urls like post/1 , post/2 , but if you try to access post/ directly as a root you get 404 , i have a similar scenario like this and i want to be able to handle the root post/ with the catch all route , i tried adding an index.js that is exporting [ ... slug ] .js but the issue with this is that generates 2 separate lambdas one for index.js and one for [ ... slug ] .js as well . how can i handle this ? < code >
i have tried to add a style to react spring animated component , but the classname was not transformed . < code > import react from `` react '' ; import { animated } from `` react-spring '' ; const test = ( ) = > { return ( < div > < animated.div classname= '' container '' > < animated.div classname= '' card '' > a < /animated.div > < animated.div classname= '' card '' > b < /animated.div > < animated.div classname= '' card '' > c < /animated.div > < /animated.div > < style jsx > { ' .container { position : fixed ; top : 0 ; left : 0 ; width : 100vw ; height : 100vh ; will-change : transform ; display : flex ; align-items : center ; justify-content : center ; } .card { background-color : white ; background-size : auto 85 % ; background-repeat : no-repeat ; background-position : center center ; width : 45vh ; max-width : 300px ; height : 85vh ; max-height : 570px ; will-change : transform ; border-radius : 10px ; box-shadow : 0 12.5px 100px -10px rgba ( 50 , 50 , 73 , 0.4 ) , 0 10px 10px -10px rgba ( 50 , 50 , 73 , 0.3 ) ; } ' } < /style > < /div > ) ; } ; export default test ;
hello , guys ! i want to store some data for every single request , so that i can using these data at other files , currently i stored at ctx , but data crossover occurs when concurrent requests , so where is the best place to stay independent while concurrent requests ? < code >
i need to redrect to login page if a 401 error is catched . i did this with react error boundary . the router.push is not supposed to be used imperatively . < code > class errorboundary extends react.component < any > { state = { error : null } ; componentdidcatch ( error ) { this.setstate ( { error } ) ; } render ( ) { const { children , fallback , router } = this.props ; const { aspath } = router ; const { error } = this.state ; if ( error instanceof rrnlrequesterror & & error.res.status == 401 ) { router.push ( '/login ? redirect= < cur > { aspath } ' ) ; return ; // < redirect to= { '/login ? redirect= < cur > { aspath } ' } / > } if ( error ) { return react.createelement ( fallback , { error } ) ; } return children ; } }
i use nprogress ( a fake progress bar on top of the page ) for user feedback while they wait for page transitions . i use it like this right now thing is i only need it when i go to a dynamic page since navigating to statically optimized pages is instant anyways . is there a way i can listen to either the start/end of getinitialprops or otherwise recognize if the page i 'm navigating to is a dynamic page ? < code > router.events.on ( 'routechangestart ' , nprogress.start ) router.events.on ( 'routechangecomplete ' , nprogress.done )
is sub navigation even possible in nextjs and this or am i missing something ? i can not figure out how to have a menu like this : home -- > subpage -- > subpage -- > -- > subsubpage main page contact page i want to be able to track which option is pressed for example if subpage is selected then home would be highlighted because it is the parent . is this possible ? if so how ? < code >
use case : a site with dynamic routes ( catch-all case ) . deployed onto a subpath on the production server . static export non-production builds ( works ) with a non-production build , this is the exported path map : production builds ( fails ) however for production builds we add an assetsprefix so the export path map ends like so : the first ( regular ) entry is fine , the second on ( the dynamic one ) fails with : any idea how this can be done ? < code > error occurred prerendering page `` /subpath/dyn/what/ever.html '' < url > error : the provided export path '/subpath/dyn/what/ever.html ' does n't match the '/dyn/ [ ... slug ] ' page . { '/grid.html ' : { page : '/grid ' } , '/dyn/what/ever.html ' : { page : '/dyn/ [ ... slug ] ' } } { '/subpath/grid.html ' : { page : '/grid ' } , '/subpath/dyn/what/ever.html ' : { page : '/dyn/ [ ... slug ] ' } }
hey , i 'm pretty new to react & nextjs and just started my second project with it . i have sometimes the issue that the page is freezing for some seconds when i 'm clicking a link to another page . as i can not reproduce it consistently and happens rarely , i have not paid attention on this topic yet . maybe someone can relate the issue and knows what is causing it , i was going through the issue list , but could not find any connection . i am using the next-redux-wrapper which is might not directly visible as it is used in _app.js . the current website can be found here : < url > and the source code is located here : < url > any help is really apperciated . thanks < code >
i was willing to try the usage of zones . but i realised they are not present on the most recent docs . please , are they gon na be discontinued ? < code >
i 'd like to pass all csvs in a data/ directory into individual statically-exported pages , but i 'm not clear on the best way to do it . in pseudocode terms i 've been doing something like this : then in my getinitialprops i do more complicated logic on the csv string , parsing it into an object and so on ( this is not easy to do from next.config.js due to the stripped-down node environment ) . that said , this all feels weird . i 'm coming from a gatsby background in part but wanted to try next since these csvs felt like they did n't call for a full graphql type system , but it feels like i 'm doing something wrong to be assigning csv to a 'query ' object . am i missing something ? is there a much easier way to do things ? should i be waiting for the getstaticprops method ? ( also sorry for asking back-to-back questions ) < code > exportpathmap ( ) { const paths = { } datafiles.foreach ( file = > { const csv = fs.readfilesync ( file + `` .csv '' , 'utf-8 ' ) paths [ `` /results/ '' + file ] = { page : `` /results/ [ result ] '' , query : { csv } } } return paths }
regarding next.js 9.2 built-in css , is there any way to make component styles not inserted after tailwind css ( global css ) ? i would like tailwind classes to be more important than any other class since they are used explicitly . < code >
hello in development mode , i have the relative paths as in the following example : background-image : url ( /images/bg-header.png ) ! important ; but in production mode i 'm going to upload the website to a subdirectory of the domain , example : < url > i need it to build like this : background-image : url ( /subdirectory/images/bg-header.png ) ! important ; how can i get it ? < code >
i noticed react-loadable has been effectively copied and updated with new features . the last time an official version of react-loadable was published was over 2 years ago and it will eventually be unusable as it contains deprecated component lifecycle methods . since the current maintainer of react-loadable does n't seem interested in making any improvements to the library and does not have any open channels for discussing fixes for these issues does anyone else think that a fork should be created and namespaced as @ next/react-loadable ? < code >
i 've been reading up about google 's closure compiler and to my understanding it can produce more performant and smaller javascript bundles . it looks like it is relatively easy to add alongside next js via < url > however there will probably be multiple places where babel config needs to be adjusted , hence i wanted to ask if it makes sense to try this out , would it improve performance / bundle size at all or is next js already doing better job here ? < code >
hello , i 'm using express with nextjs , the express app has these routes : / : lang/yyy / : lang/xxx / : lang/xxx/xxx . / : lang/xxx/xxx/xxx . all my pages has the meta base with this url : < url > } / while all the links in the pages are < link href= '' my-page '' / > . if i 'm in this page : < url > and i click a link like < a href= '' yyy '' > < /a > i navigate to the right page < url > but if i 'm in this page : < url > and i click a link like < a href= '' yyy '' > < /a > instead of navigate to the right page < url > i 'll land in this page < url > when i hover the link i can see the right url , indeed if i open the link in a new page is working fine . i 'm doing something wrong ? many thanks < code >
all browsers ( including microsoft edge ) work , except for internet explorer when navigating an _error page . if a user tries to navigate to a route that is not supported localhost:3000/banana then nextjs will call _error to render the page . however , in ie , this fails . console will error the following : the problem this only happens when using basic auth . so looking into the network logs i find that the get request to _error is denied and a 401 response is sent . however , this only happens for the error page , not for any other page in nextjs . looking at what happens when loading any other page , this is the result - one get request that is a 401 , and then another immediately after that is successful . like the request for _error page , the first request contained no authorization in the header , but the successful request did have it . < code >
hey folks ! i 'm looking to use next to build a blog . here 's what i have in mind : some folder that i can add md/mdx files to , with front matter to define author , timestamp etc . a homepage that automatically picks up the 3 to 5 most recent posts and shows an abstract a posts page that shows , well , all posts a post page that shows a full post with header etc . i should not have to update the homepage manually when i publish a post . that should happen dynamically . now , there 's several starter kits out there that do just that , but most of them seem either pretty over-engineered , not particularly nice to use , or using an archaic version of next . i was wondering if there 's some a recent , authoritative example out there for a use case like this ? the next docs start building a blog , but unfortunately do n't go far enough to get to the point where it 's fully dynamic , unless i missed some part . is that by design , and next is completely unopinionated in that regard ? are there any `` best practices '' ? thanks a ton ! < code >
i have raised an issue here # 10678 and also posted a question in stackoverflow , < url > but i could n't get any relevant help .. can anyone help me to implement adobe analytics in nextjs project with appropriate examples ? < code >
hi , i have this test site : < url > and i have a route /comentarios if you try to enter directly from the url to : < url > it will display an error 404 page . but if you access : < url > and since you access the link `` comentarios '' works . my server is nginx with pm2 and reverse proxy config : system information nextjs : 9.2.2 < code > # -- - next.js ( next.trejocode.me ) -- - # aplicacion location /_next/ { alias /projects/next-vs-cra/users-next/.next/ ; expires 15d ; access_log on ; } # favicon location /favicon.ico { alias /projects/next-vs-cra/users-next/public/favicon.ico ; access_log on ; } # manifest.json location /manifest.json { alias /projects/next-vs-cra/users-next/public/manifest.json ; access_log on ; } # proxy inverso location / { try_files < cur > uri < cur > uri/ =404 ; proxy_pass < url > proxy_set_header upgrade < cur > http_upgrade ; proxy_set_header connection 'upgrade ' ; proxy_set_header host < cur > host ; proxy_cache_bypass < cur > http_upgrade ; }
hello there , we have a fairly complex application and we 've seen drastic performance gains from including the entire redux workflow inside a web worker , but that created some maintenance concerns . is there a way to tell next.js to build a portion of the app as a web worker ? in other words , we need a `` web worker bundle '' and an `` app bundle '' . we will most likely use : < url > < code >
i have a website where all pages are amp pages . currently , i need to mark every single page with : i was unable to find a way to set this globally for all pages . so , it would be nice to specify amp : true in next.js.config . < code > export const config = { amp : true } ;
i know it 's been asked a million times before , so if the answer is the same i understand , but looking at the issue # 4998 ( basepath support ) i noticed a recent pr land with experimental support for basepaths ( # 9872 ) and then a follow up pr ( # 9988 ) which fixed a couple bugs . i know in the original pr it was mentioned that this feature very well could never see the light of day outside of behind the experimental flag . so my question is , is that still the case ? if so , any particular reason it might not stick ( i.e . support nightmare ? complicates routing ? something else ? ) ? i 'm always interested in hearing some of the behind the scenes discussions of the roadmap and also would love to see this feature land 😄 < code >
feature request is your feature request related to a problem ? please describe . handling various methods in api routes is tiresome . if i only want to handle post , i have to do something like if i want to handle multiple methods i either have to inline them all or break them into separate functions . describe the solution you 'd like i like having the default export as a generic request handler . expanding on that , it would be nice to have named exports for the various methods supported . so my above example would become , < code > export const post = async ( req : incomingmessage , res : serverresponse ) = > { // handle post } export default async ( req : incomingmessage , res : serverresponse ) = > { if ( req.method ! == 'post ' ) { res.status ( 405 ) .json ( { error : 'invalid method ' , } ) return } // handle post }
as i understand it there is quite a bit of overlap / duplicated code between each serverless page bundle , where each base file at least includes react and react-dom . adding external libraries also leads to an increase in each page bundle size . this does not pose a problem when you deploy one lambda fn per serverless page bundle ( like now and serverless-nextjs-plugin do . however for this project i 've been maintaining for a while now is not possible to deploy one lambda fn . per page as it uses lambda @ edge behind the scenes where doing this is n't possible . an example of the issue can be found in serverless-nextjs/serverless-next.js # 236 where a user hit the limit of how big the lambda artifact can be . is it possible to output common chunks between sls page bundles ? this would considerably reduce duplication . considering the next framework is pushing so much for serverless this change would give library maintainers like myself the flexibility to take even further what 's possible in this area . i 'm more than happy to look into it myself , all i 'd need would be a bit of initial guidance 🙌 < code >
feature request is your feature request related to a problem ? please describe . i 'm using a custom express server inside an electron app . when i load the electron app i see when i make a change to any file in the electron app ( for example in the main process , which kicks off the server ) , the app restarts ( with electron-reload ) , and it boots up the custom server again . i then see the exact same output . if the server is restarted , next.js is recompiling pages unnecessarily . describe the solution you 'd like only compile pages if something relating to the server has changed , not on every restart of the server . describe alternatives you 've considered none are apparent to me currently , but i 'm open to ideas . additional context reproduction steps : start a custom server let it build some page . shut the server down with something like ctrl^c restart it wait for it to build again , despite no code being changed . < code > [ elec ] > using external babel configuration [ elec ] > location : `` /app/babel.config.js '' [ elec ] [ ready ] compiled successfully [ elec ] [ event ] build page : / [ elec ] [ wait ] compiling ... [ elec ] [ ready ] compiled successfully
feature request is your feature request related to a problem ? please describe . next.js has api routes with built-in middlewares , such as bodyparser . when an error is thrown by those middlewares , next.js sends an error response , handled by senderror . the current implementation sends a json response with the error message as the body . as an example : if we send request , with content-type : application/json with an invalid json request body , the server responds with invalid json . however , usually apis that i develop have a standard envelope for errors , like : i would like to be able to keep the same response envelope for built-in middleware errors . describe the solution you 'd like perhaps , we could somehow be able to tweak the senderror by including it in the config exported in api routes ? describe alternatives you 've considered i 've looked into the code to see if i could somehow monkey-patch to get around the issue temporarily , but i could n't find a way . another solution is to turn off all the middleware and use something like micro to have full-control , but seems overkill . additional context < code > { `` statuscode '' : 400 , `` message '' : `` invalid request body '' , `` other '' : `` optional stuff here '' } export const config = { api : { senderror : ( res , statuscode , message ) = > { } , } , } ;
after experimenting with the new static gen api discussed in # 9524 , i 'd like to suggest a better approach to developing using the dev server . the problem is , at present , navigating between getstaticprops routes causes the dev server to request the results json over and over . this is contrary to production behavior , and it also slows down the development process with extra delays . @ timer argued that during development , it 's in the developer 's interest to see the most up-to-date data , and thus , the server request is useful . but i do n't see a use-case where this would come into play . if you 're adjusting code , the dev server is going to hot reload anyway , negating the need to navigate around the app to re-request the json response . if you 're clicking around your app , it 's likely because your testing behavior , which is slowed by re-requests . and if you 're adjusting content that is n't tracked by the dev server ( e.g . markdown or some headless cms content ) , then you 're going to have to refresh the browser anyway to see the results of the updates . in this case too , re-requesting the json response does n't help . are there use-cases for re-requests i 'm not considering ? either way , i think we should have the discussion on two fronts : what should be the default behavior ? should there be a config option to choose between modes ? thanks . : ) < code >
feature request problem our selenium tests rely on a specific naming of class names in the html . e.g . class= '' header__link '' , where header is the name of a component , and link is a class in the component 's css module ) . with the current experimental css support in next.js , there 's no apparent way to customize the outputted css identifiers . with next-css , we used to simply override the webpack config with our own css-loader options localidentname and getlocalident ) . proposed solution please allow to override the webpack config like it was the case with next-css . thanks ! related to # 8626 . < code >
mock withrouter what we need an easy way to mock withrouter and other context related stuff . what it currently breaks if you create a component utilizing withrouter , you 're not able to render it on its own any longer , as it 's dependent on a global context . this mainly breaks : tests component based ui libs like storyboard or react cosmos . trying to work around it a simple , manual mock for example via : will throw an error ( typeerror : can not set property ) , like this one babel/babel # 8363 . this is a related issue , where this approach was suggested : # 1827 this suggestion ( # 1827 ( comment ) ) is a monstrosity for a simple thing . and as the author , @ ssylvia , correctly remarked - relies on the legacy context api . but i will use it in the meantime . what i 'd like some way to replace the whole next context or pieces of it , without having to know how next is creating and providing context internally . < code > import { withrouter } from `` next/router '' ; withrouter = component = > props = > < component { ... props } router= { mockedrouter } / >
next.js should emit linting and non-critical build errors in an unobtrusive toast instead of a full-screen error overlay . notably , this is desirable for typescript since some users rely on typescript as a linter instead of type checker . closes # 8060 < code >
i use 2 native modules pkg output how to put module_a 's node_napi.node and module_b 's node_napi.node into prebuilds dir ? # 950 there is a closed issue , but no solution < code > > warning can not include directory % 1 into executable . the directory must be distributed with executable as % 2 . % 1 : node_modules/module_a/prebuilds % 2 : path-to-executable/prebuilds > warning can not include directory % 1 into executable . the directory must be distributed with executable as % 2 . % 1 : node_modules/module_b/prebuilds % 2 : path-to-executable/prebuilds node_modules/ module_a/prebuilds/win32-x64/node.napi.node module_b/prebuilds/win32-x64/node.napi.node
hello . to deploy `` compiled\packed '' version app as i understand before we can convert es6 code to simple js code with babel and pkg after maybe someone have such template project ? share please if it possible . < code >
i 've updated to the newest version 5.0.0 and when compiling , i get the same errors every time : this was not an issue with the previous v4 . any idea what 's happening ? < code > /tmp/cc9bmn7v.s:61042 : error : invalid literal constant : pool needs to be closer make [ 2 ] : * * * [ /tmp/ccmjn8bv.mk:53 : /tmp/ccbfue6h.ltrans17.ltrans.o ] error 1 make [ 2 ] : * * * waiting for unfinished jobs .... lto-wrapper : fatal error : make returned 2 exit status compilation terminated . /usr/bin/ld : error : lto-wrapper failed collect2 : error : ld returned 1 exit status make [ 1 ] : * * * [ tools/v8_gypfiles/mksnapshot.target.mk:189 : /tmp/pkg.095e61017e88b25f94aec075/node/out/release/mksnapshot ] error 1 rm 0795beb448b2170286fa26d7ad0420ed0b0753aa.intermediate d7f3d0a95c5bdccdd9a7e59b2f66020c439261b7.intermediate make : * * * [ makefile:104 : node ] error 2 strip : '/tmp/pkg.095e61017e88b25f94aec075/node/out/release/node ' : no such file > error ! error : enoent : no such file or directory , open '/tmp/pkg.095e61017e88b25f94aec075/node/out/release/node '
hi , i would like to now how the pkg library compile files in to a single exe file ? nodejs project files resources node native modules etc . thank you . < code >
i built a next.js app that uses prisma for database access . after packaging it up and running it , i get the following error : i installed prisma on 64bit windows with node v.16.14.2 and compiled it against the same : what am i doing wrong ? < code > `` bin '' : `` ./server.js '' , `` pkg '' : { `` assets '' : [ `` .next/ * * / * `` , `` ./node_modules/.prisma/client/query_engine-windows.dll.node '' ] , `` scripts '' : [ `` .next/dist/ * * / * .js '' ] , `` targets '' : [ `` node16-win-x64 '' ] , `` outputpath '' : `` pkg '' } , prismaclientinitializationerror : invalid 'prisma.match.groupby ( ) ' invocation : unable to load node-api library from c : \snapshot lp-webapp ode_modules\.prisma\client\query_engine-windows.dll.node , library may be corrupt at object.request ( c : \snapshot lp-webapp ode_modules\ @ prisma\client untime\index.js:45411:15 ) at processticksandrejections ( node : internal/process/task_queues:96:5 ) at async prismaclient._request ( c : \snapshot lp-webapp ode_modules\ @ prisma\client untime\index.js:46301:18 ) at async handler ( c : \snapshot lp-webapp\.next\server\pagespi\overview.js:56:30 ) at async object.apiresolver ( c : \snapshot lp-webapp ode_modules ext\dist\serverpi-utils ode.js:185:9 ) at async nextnodeserver.runapi ( c : \snapshot lp-webapp ode_modules ext\dist\server ext-server.js:395:9 ) at async object.fn ( c : \snapshot lp-webapp ode_modules ext\dist\serverase-server.js:496:37 ) at async router.execute ( c : \snapshot lp-webapp ode_modules ext\dist\server outer.js:226:36 ) at async nextnodeserver.run ( c : \snapshot lp-webapp ode_modules ext\dist\serverase-server.js:606:29 ) at async nextnodeserver.handlerequest ( c : \snapshot lp-webapp ode_modules ext\dist\serverase-server.js:321:20 ) { clientversion : ' 3.14.0 ' , errorcode : undefined }
the error prebuild-install failed [ d : \projects\galaxy108\game ode_modules ode-datachanneluild\release ode_datachannel.node ] : spawnsync d : \projects\galaxy108\game ode_modules\pkg ode_modules\.bin\prebuild-install enoent seems it is about prebuild-install of the node binary file , i cloned the node_datachannel module project , and did prebuild-install , which downloaded the node_datachannel.node file if it is missing . no idea why it is reporting this error . in the pkg build app ( window and macos ) , the app closed itself immediately , without importing the module referenced the '.node ' file , the app terminal at least remain on the screen with some console.log msg . i also find the pkg source code where report this 'prebuild-install failed ' message , but dont know how to debug this to find out more . there are some issue discussion mentioned about this error and no solution for it yet , hope someone could help us~ thanks < code >
my script depends on puppeteer and when i package it , i get the following error pkg @ 5.7.0 targets not specified . assuming : node16-linux-x64 , node16-macos-x64 , node16-win-x64 warning can not include directory % 1 into executable . the directory must be distributed with executable as % 2 . % 1 : node_modules\puppeteer.local-chromium % 2 : path-to-executable/puppeteer i tried copying chromium to the root directory and then modifying puppeteer 's executablepath , but it did n't work const browser = await puppeteer.launch ( { headless : false , executablepath : '/chrome-win/chrome.exe ' } ) < code >
hoping someone might be able to help me out here . i 've built a system macro using nodejs and using pkg to distribute it . in pre exe state the code works as expected , however after compiling it : when attempts to run it , it hangs for a bit , comes with with `` access denied '' and then deletes the executable . i have no idea what 's going on here . i 've tried running it as admin get the same result . any ideas ? < code > pkg -t node16-win-x64 -- out-path ./dist src/mybillingtransform.js
is there a way to dynamically generate the file names of the executables ? i would like to add the version number to the file name , so cli-1.5.4-macos . thank you ! < code >
practically , the only time you want to distribute a commercial app and use some sort of code protection is with desktop apps . so it would make a lot of sense to combine this with electron . are there any plans for that ? < code >
i have created an executable of an express app using this package . how can we run the executable in cluster mode ? running pm2 start pkg_exe -i 2 gives port already in use error for one of the instances . < code >
i 'm trying to generate a lightweight bundle , excluding non-production dependencies and more not useful files like readme.md , .eslint , etc . i generated a tooling for doing that called untracked , it will create an array of git ignore pattern matching . the point is , how i can connect this with pkg ? i suppose that you are not exposing something like .pkgignore because actually , you do n't follow this approach ; i think you are trying to follow require ast , is this correct ? and , in this case , are these files being excluded from the output ? < code >
hello everyone , i 'm trying to use pkg to package a project i 'm working on in order to ship it without the source code . i stumbled upon an issue with a liquibase dependecy we have . everytime our project goes up we run an update command in order to keep our database schema up to date . the problem is that this update command internally uses a .jar from one of the project 's dependencies to perform the operation and this .jar is located inside the dependency path : node_modules/node-liquibase/dist/liquibase/liquibase.jar when i run before packaging it goes smoothly , however when i run my project after packaging i get : error : /snapshot/my-project/node_modules/node-liquibase/dist/liquibase/liquibase : not found is there any way or configuration i can set in order to make it possible for my packaged project to be able to run the .jar command ? i 'm packaging my project simply with : pkg index.js . thanks in advance ! < code >
see < url > on nixos , the executable has to have a different path for the interpreter . this makes pkg fail to start with pkg : error reading from file . is there a way to patch ? < code >
there are two different nodejs apps . one will import the other one dynamically and invoke an exported function from it . when both the apps are bundles with pkg how can we achieve it ? < code >
most of you have probably heard of the amazing speedups provided by native tools such as swc or esbuild , compared to babel . is it under consideration to implement use one of them in this project ? looking at my docker builds , creating the executable with pkg seems to take by far the longest time and i believe i 'm not alone in that . what do you think ? are there some major obstacles in how pkg works ? or maybe these technologies are not mature enough ? < code >
hello ! my application use a config file that i import in my application . i would like to know if it 's possible to exclude this config file from binary ? thank you for your answer in advance . if you need more information , please let me know . < code >
i 'm currently building an application using node.js 16 , fabric.js , & canvas element but whenever i tried to package this application i 'm getting this error [ debug ] prebuild-install failed [ d : \users\wayne\instabot\node_modules\canvas\build\release\canvas.node ] : spawnsync d : \users\wayne\appdata\roaming\npm\node_modules\pkg\node_modules.bin\prebuild-install enoent [ debug ] prebuild-install failed [ d : \users\wayne\instabot\node_modules\canvas\build\release\canvas.node ] : spawnsync d : \users\wayne\appdata\roaming\npm\node_modules\pkg\node_modules.bin\prebuild-install enoent [ debug ] prebuild-install failed [ d : \users\wayne\instabot\node_modules\canvas\build\release\canvas.node ] : spawnsync c : \users\prasheel\appdata\roaming\npm\node_modules\pkg\node_modules.bin\prebuild-install enoent ps c : \users\prasheel\instaprint-bot-node > it seems like pkg ca n't be able to package node-canvas or fabric.js related application i 'm using `` pkg '' : `` ^5.5.2 '' , `` fabric '' : `` ^5.2.1 '' , < code >
everytime i run exe file , powershell turns on . i would like to change that terminal on cmd . can it be done at a low cost ? < code >
hey , we need to download a file from a server when running our package application , and then execute that file . currently we are getting such an error though : the problem is of course that the file does not exist when compiling , as different files are downloaded depending on the operating system and phase of the moon . so we can not just include it as an asset . is there a way to make pkg ok with the downloaded file ? < code > error : file or directory '/ * * /node_modules/foo/bar ' was not included into executable at compilation stage . please recompile adding it as asset or script .
different in linux and windows10 same code , pack to executable program , but has different performance different in windows same code , run use node and run use pkg program what else can i do to solve this problem ? < code >
really dumb question but i could n't find out how pkg changes stack path for function replacing it to pkg/prelude/bootstrap.js how pkg does it ? why i 'm asking : that would be nice to replace c : /snapshot/myapp to something similar like pkg did when working with stack traces < code >
hi ! just done a quick test on windows builds . bundle size can be reduced from 24,964 kb to 6,646 kb ( 3.75x smaller ) with doing simple xz compression . this may even help more when having more npm dependencies . adding this option may be super useful for small and embedded cli/webservers : ) i 've just opened this discussion before going further to know others idea on this . update : to be clear , this topic and what i am talking about is sfx packages not js minification & optimizing . < code >
so im working on some app that hides to tray once you said so . however when i export it the tray icon doesnt load the icon is in ./assets/logo.ico my package file : my code : does anyone know how to resolved this issue . if needed this is the source code < url > < code > const consolewindow = require ( `` node-hide-console-window '' ) ; const image = require ( './assets/logo.ico ' ) ; let tray = require ( `` ctray '' ) ; let tray = new tray ( image ) ; // where the image should be tray.tooltip = `` mezo management rpc '' ; // sets the tooltip to display tray.menu = [ // sets the tray menu `` mezo management rpc '' , `` - '' , { text : `` hide '' , callback : _ = > consolewindow.hideconsole ( ) } , { text : `` show '' , callback : _ = > consolewindow.showconsole ( ) } , { text : `` quit '' , callback : _ = > tray.close ( ) } ] tray.on ( `` close '' , ( ) = > process.exit ( ) ) ; `` pkg '' : { `` scripts '' : `` '' , `` assets '' : `` assets/ * '' , `` outputpath '' : `` dist '' }
i notice that the next.config.js seems to be missing from my executable as i could not fetch images from defined domains . i try to include it in the scripts section , but i 'm getting a load error as shown below . is this the correct way to include next.config.js into the exectuable ? has anyone seen this error before ? < code > `` assets '' : [ `` .next/ * * / * `` , `` public/ * * / * `` ] , `` scripts '' : [ `` .next/ * * / * .js '' , `` next.config.js '' ] , `` targets '' : [ `` node16-linux-x64 '' ] } /snapshot/frontend/node_modules/next/dist/server/config.js:413 userconfigmodule = await import ( ( 0 , _url ) .pathtofileurl ( path ) .href ) ; ^ typeerror : invalid host defined options at object.loadconfig [ as default ] ( /snapshot/frontend/node_modules/next/dist/server/config.js:413:78 ) at async nextserver.loadconfig ( /snapshot/frontend/node_modules/next/dist/server/next.js:116:22 ) at async nextserver.prepare ( /snapshot/frontend/node_modules/next/dist/server/next.js:98:24 )
hi can anyone help me with this error when running pkg . not suer how to enable the parser plugin warning babel parse has failed : this experimental syntax requires enabling one of the following parser plugin ( s ) : 'jsx , flow , typescript ' ( 7:2 ) thanks gary < code >
as i know , pkg use pkg-fetch to get vercel 's prebuilt nodejs binaries . although the nodejs binaries are hosted in release section of pkg-fetch github , i believe the mit license for pkg-fetch does not apply to those prebuilt nodejs binaries . is there any documentation from vercel mentioning about commercial use of those nodejs binaries ? as the vercel 's prebuilt binaries are a blackbox to me and may have security concerns , is it possible to build my own nodejs binaries for pkg using the official nodejs release ? < code >
egg : v2.15.1 node : v14.17.0 the above is my system configuration . when i use the packaged file , he prompts me ( can not find module ' c : \users\d\desktop\my\simple -- no -deprecation ' ) i do n't understand why there is such an error . < code >
i am trying to sign and notarize a node.js 16 app which has been packaged using pkg 5.3.0. it 's a tiny cli app that just prints a line using console.log - super basic just to test the concept . the signing process follows this concept pretty closely . i have a proper apple `` developer id application '' certificate . doing things locally on a mac bigsur 11.6.3 ( which is latest at time of this writing ) everything works it seems : the pkg part , signing and notarization all return ok. but the files i get back from apple ca n't be executed . getting a kernel error when i try to run them . now , this could be/probably is an issue with the gon tool that i use . but all this aside - has anyone a working solution for apple signing of pkg packaged macos console apps ? preferably something that can be deployed in the form of a github action .. thx < code > ./pkg-lab [ 1 ] 10763 killed ./pkg-lab
hello , i have a little problem with a .exe file created by the library . the problem is that when i try to run the executable with the task scheduler , the program wo n't run . it works totally fine when i run it manually ( in the same machine ) , but with the scheduler i do n't get any errors , the system just wo n't run . any help ? thank in advance < code >
hi guys , first of all thank you for this package , it looks awesome . i would like to build my nodejs app for my raspberry pi , working on armv7l . i 've been trying to do that for a week , no success . i am pretty new in this world , so any help is really appreciated . currently i 'm working on macos , but if needed i can move to a linux machine if it 's simpler to do it . i tried to compile directly via a rpi , but it takes endless hours , and my rpi is hot as hell . then i tried to emulate a rpi with qemu , i did not succeed . i 'm stuck , i do n't know what to do . thanks for your help ! < code >
i 'm trying to build a node application with pkg on linux s390x but the compilation is always failing . node installed version 16.13.2 the pkg node target is node16-linux-s390x i 'm on ubuntu 20.04 arch s390x : i 'm using gcc ( ubuntu 11.1.0-1ubuntu1~20.04 ) 11.1.0 , python 3.8.10 , gnu make 4.2.1 , this is the compilation error is this platform supported ? < code > lto1 : internal compiler error : compressed stream : data error executable file is not elf please submit a full bug report , with preprocessed source if appropriate . see < file : ///usr/share/doc/gcc-9/readme.bugs > for instructions . lto-wrapper : fatal error : /usr/bin/g++ returned 1 exit status compilation terminated . /usr/bin/ld : error : lto-wrapper failed collect2 : error : ld returned 1 exit status make [ 1 ] : * * * [ overlapped-checker.target.mk:122 : /tmp/pkg.b67e578d00f6f26a32349832/node/out/release/overlapped-checker ] error 1 make [ 1 ] : * * * waiting for unfinished jobs .... rm 24bf4faf5354deea751d137a86edfcdf5f2903a4.intermediate make : * * * [ makefile:110 : node ] error 2 name= '' ubuntu '' version= '' 20.04.3 lts ( focal fossa ) '' id=ubuntu id_like=debian pretty_name= '' ubuntu 20.04.3 lts '' version_id= '' 20.04 '' home_url= '' < url > support_url= '' < url > bug_report_url= '' < url > privacy_policy_url= '' < url > version_codename=focal ubuntu_codename=focal
hi , specifying an arm linux target seems to make pkg want to download a macos equivalent , which of course does n't exist . it then tries ( and fails to build an arm macos binary . is it possible to stop pkg even worrying about the macos-arm target , as i do n't want it anyway ! < code > pkg run.js -t latest-linux-armv7 > pkg @ 4.3.3 > fetching base node.js binaries to pkg_cache_path fetched-v10.4.1-macos-armv7 [ ] 0 % > error ! 404 not found < url > > asset not found by direct link : { `` tag '' : '' v2.5 '' , '' name '' : '' uploaded-v2.5-node-v10.4.1-macos-armv7 '' } > not found in github releases : { `` tag '' : '' v2.5 '' , '' name '' : '' uploaded-v2.5-node-v10.4.1-macos-armv7 '' } > building base binary from source : built-v10.4.1-macos-armv7 > error ! not able to build for 'armv7 ' here , only for 'x64 '
why do we need to provide `` bin '' in package.json ? if we use command line options to pkg you can specify an entry point instead . to be consistent there should be an `` entry '' possible to specify under `` pkg '' so that we can provide the exact same options as we do on the command line but can put it in package.json so we do n't need to specify it every time . < code >
i am using pkg to bundle my node.js project code . happy with its functionality . however , i have one doubt . is there any way to reverse engineer the .exe file to source code js files ? < code >
simple code as follow : package it with v8-options : error : ps : < code > node version : v12.22.8 internal/modules/cjs/loader.js:818 throw err ; ^ error : can not find module '/git/test/ -- max-old-space-size=3072 ' at function.module._resolvefilename ( internal/modules/cjs/loader.js:815:15 ) at function._resolvefilename ( pkg/prelude/bootstrap.js:1819:46 ) at function.module._load ( internal/modules/cjs/loader.js:667:27 ) at function.runmain ( pkg/prelude/bootstrap.js:1847:12 ) at internal/main/run_main_module.js:17:47 { code : 'module_not_found ' , requirestack : [ ] } pkg -t linux index.js -- options max-old-space-size=3072 const cluster = require ( 'cluster ' ) ; if ( cluster.ismaster ) { for ( let i = 0 ; i < 2 ; i++ ) cluster.fork ( ) ; } else if ( cluster.isworker ) { console.log ( `` create worker_ % d ( % d ) '' , cluster.worker.id , process.pid ) ; }
i am integrating my node js application with appdynamics ( docs ) before that am using pkg to bundle my node js application and making it a windows executable . so when i try the run the application i am getting the below error when am trying to run the application without packing , then am not facing any issue and am able to receive the metrics in appdynamics dashboard perfectly so i think this has something to do with pkg packaging node version v14.15.5 appdynamics agent version ^21.4.0 < code >
hi there , i have a working app that launches the playwright cli like this : an express server executes an npm script found in the package.json file it works fine , but if i turn node off ( nvm off ) , the server starts but the npm run codegen does n't work anymore . i 'm fine keeping the executable in the folder with many dependencies all around it . do you have any idea ? thanks ! < code > `` codegen '' : `` playwright codegen my-website.com '' , // index.js exec ( 'npm run codegen ' ) ;
so , i 've updated node to 17 on my system , 17 is n't available for pkg yet , but that makes node_expat compile against node_module_version 102 , whereas node16 target is node_module_version 93 is there any way i can have pkg recompile modules for the target version or something ? < code >
good day , i would like to make an executable to open playwright 's codegen windows for my not-tech-savvy coworkers . they are all working on windows . so i 'm trying to package this super simple application : < url > but : on linux , the executable works only when it is launched from within the /dist folder . if i move it elsewhere on my system , it stops working . on windows , the same thing happens , even when i try to copy manually all missing dependencies in the /dist folder . do you have any idea to make this poc work ? thank you in advance ! < code >
in the resulting executable , the source code of index.js is visible in a hex editor , and adding `` private '' : true '' to package.json makes no difference . < code >
the background is , that i have cross-compiled a specific nodejs version ( v12.22.6 ) and put it in the `` .pkg-cache '' -folder . but when i try to build a project with pkg , it automatically trys to fetch the version v12.22.7 . and of course it is not able to find that version in the cache folder . is it possible to specify the while version of node for pkg ? thanks . < code >
i am happy to have found this toolset to solve an issue i was having with bundling a node app for a server . the opening disclaimer in the readme.md states that `` pkg was created for use within containers and is not intended for use in serverless environments . '' is this referring to the process of bundling/building the single executable ? or that the executable is intended for execution in a container ( and not it typical user-land or server-land ? ) will i be skimming past icebergs if i distribute a classic node/express server binary to a container-less machine ? < code >
a simple hello world script compiled with pkg will take around 0.6-0.7 seconds to run . running the source in node takes less than 0.1s . i tried different targets , compressions options , etc - but the startup always takes longer by a seemingly fixed amount of time ( note : tested in alpine and debian containers ) . is there any thing that can be done to improve this ? in my application , the startup latency should be as minimal as possible . possibly related issue : # 859 - note that the issue mentions large files , but it happens with a single-line hello world too . < code >
hello , our application forks on startup a javascript node module ( let 's call it `` script.js '' ) using nodejs `` child_process.fork ( script , args ) '' method . `` script.js '' uses addition module `` diskusage '' . we are not able to embed the forked script into main application executable . at present we are deployng application.exe with `` script.js '' ( and relative modules needed by script.js in `` node_modules '' folder ) this works well but it is not optimal . the command `` pkg . '' gives this output : pkg @ 4.2.4 warning can not include addon % 1 into executable . the addon must be distributed with executable as % 2 . c : \wamp64\www\playout_service ode_modules\diskusageuild\release\diskusage.node path-to-executable/diskusage.node adding `` script.js '' into `` pkg.scripts '' section of package.json did not helped . we would like to know how to properly handle this issue . thanks < code >
hi , i have the following folder hierarchy ( printed using debug_pkg=1 ) with this in packages/desktop/package.json : till now i was only packaging desktop into a binary file using pkg but now i need to include server as well which is just an express server with some apis ( and run the server ) i tried using import ' .. / .. /server/app.js ' in packages/desktop/src/index.js . it works but it breaks the relative imports used in the server directory . so what 's the proper way of doing this ? please comment thanks ! < code > `` pkg '' : { `` options '' : [ `` experimental-modules '' ] , `` assets '' : [ `` .. / .. /node_modules/ * * / * .node '' , `` .. /server/ '' ] , `` targets '' : [ `` node14-win-x64 '' , `` node14-linux-x64 '' , `` node14-macos '' ] , `` outputpath '' : `` build '' } -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- - virtual file system /snapshot project < phone > node_modules < phone > packages < phone > desktop 8694 server 24646 ui 756804
afaik walker is actually used to get all the files needed by the runtime to run , including node_modules , this is exaclty what nft does . this could fix some issues that we are having like : # 1130 # 1135 # 1072 /cc @ jesec @ leerob @ erossignon @ hipstersmoothie thoughts ? we could also consider something with ncc < code >
hey guys , im pretty new to this i want to get data with useswr , but i need to pass in headers to my endpoint . i 've tried this as my fetch and my url looks like this is this the right way to do this ? < code > const fetcher = async ( ) = > await fetch ( { method : `` get '' , headers : { latitude : `` 34.211822 '' , longitude : `` -118.646435 '' } } ) .then ( response = > response.json ( ) ) ; const url = `` url '' ; const { data , error } = useswr ( url , { fetcher } ) ;
i 'm using swr as a global cache for an app where i leverage < url > to implement a drag and drop based list reordering . as explained in the doc , it works well when using usestate 's setter to update the list order on drag-drop since it is batched in the next react render . when using swr i 'm getting a flickering effect that i suspect is due to the `` asynchronous '' nature of the mutation . see below : is there a way to run a mutation synchronously so that the change can be batched by react and avoid flickering ? < code >
the question i 'm trying to use the swr hook with a fetcher that 's not a promise but rather accepts a callback as the last argument of the function . is it possible to use useswr ( or maybe another hook ) that would work with a callback fetcher ? my use case i 'm using firebase/firestore to store the data and i 've separated the business logic from the view and the services/ are responsible for updating and getting the data from the firestore . right now my services accept arguments like query parameters , ids , etc along with a callback function that would return the new data when a new data snapshot is available . i wanted to somehow wrap the useswr hook or maybe use another hook to be able to get the data from the service with a callback but was n't able to do so . maybe someone has already figured it out and knows how to use swr with callback-based fetchers ? < code >
i want to be able to use revalidation techniques with the getdoc method from firestore . is this possible ? in terms of what 's confusing me , what would be the fetcher ? i need this to work with react native btw . i do know of swr-firestore , but i 'm trying to find a way to get this to work without using this library . < code >
i am trying to create a `` global '' error handling so that if either an useswr or an mutate fails a notification will be shown . however , i am not able to get the bound mutate to cause an error that would be caught be the onerror-handler in the swrconfig that wraps the application . i have a reproduction here : < url > as you can see the error thrown inside the fetcher in useswr will cause the onerror handler to log the error in the console . however the error thrown inside the mutate is not showing up in onerror . however the error-object returned from useswr call is returning the error that was caused by the mutate . is it possible to get the errors from bounded mutations to show up in onerror-handler ? < code >
i am making an swr call to an api and in the query params i am sending a users user_id which is coming from usecontext . my issue is the swr hook is running before context is loading the user 's id , meaning that the first swr call is sending a user id of undefined , therefore a subsequent swr call is made . what is the best way i can avoid this happening ? is there a way i can allow context to load before the swr call is made ? < code >
i 'm getting 2 different data at the same time from 2 different async function . this console logs nfts data , not transactions . this is the async functions i used . obviouse these 2 functions return different data . but i always get data from the first one-gettokens . if i change the order of the 2 useswr hook , then get data from gettransactionhistory i never get real data from second one . is n't it possible to use 2 different async functions at the same time ? < code > const { data : nfts } = useswr ( key , gettokens ) ; const { data : transactions } = useswr ( key , gettransactionhistory ) ; console.log ( { transactions } ) export async function gettokens ( key ) { const client = new xrpl.client ( ripple_test_net_url , { connectiontimeout : 10000 } ) await client.connect ( ) const res = await client.request ( { method : 'account_nfts ' , account : key } ) client.disconnect ( ) return res.result } //end of gettokens export const getaccounttxhistory = async ( key ) = > { const client = new xrpl.client ( ripple_test_net_url ) await client.connect ( ) const transactionblob = { `` command '' : `` account_tx '' , ... `` binary '' : false , `` forward '' : false } const txhistory = await client.request ( transactionblob ) client.disconnect ( ) return txhistory.result.transactions }
remix has a feature that automatically re-runs ( revalidates ) `` loaders '' after any `` actions '' ( mutations ) . that 's what enables the automatic refresh after form submissions : < url > this got me thinking - can useswr do the same by listening for 200s on post/put/patch/delete requests and automatically triggering revalidation after they run ? ( it 's worth mentioning that there 's no obvious `` best '' implementation for this , since javascript does n't have a way to listen to requests . two approaches are : 1 ) override window.fetch , and 2 ) ask developers to import a fetch from swr ) < code >
hey folks , i have the following scenario : my nextjs project uses ssr to query some data and populate the fallback data as described in the docs . on the client , the fallback data is then passed to the swrconfig component . when i 'm in dev mode , i 'm running into the following case : i reload my page getserversideprops gets the most recent data from the db and populates the fallback client receives the server-side rendered page with the most recent data ( based on the fallback ) useswr hook tries to update data on the client useswr hook has a cache hit = > this cached data is now older than the data in the fallback , i.e . the data computed on the server browser flashes the old content for a millisecond , then falls back to the cached data i do n't know if i 'm doing something wrong but right now , the only way to then resolve this and get the most recent data is to manually clear my browser 's cache . is there support to automatically invalidate the client cache if page is rendered server-side with the most up-to-date value to prevent this regression to older data ? < code >
i really like this compact library and i 'm looking for if there is any way to prefetch data like getdatafromtree in @ apollo/client . anyone can help me ? < code >
the data acquired with useswrinfinite needs to be reordered using react-beautiful-dnd , etc. , or some of the data needs to be deleted , but it is not easy to rewrite the original data . if you retrieve the next page after reordering or deleting , the reordered data will revert to the data before reordering . is there any way to fix this ? < code > const { data , error , isvalidating , setsize , size } = useswrinfinite < response > ( ( _ , previouspagedata ) = > { if ( previouspagedata & & ( ! previouspagedata.next || ! previouspagedata.results.length ) ) return null ; return previouspagedata ? .next ? ? initialdata.next ; } , fetcher , { initialsize : 0 , revalidatefirstpage : false , revalidateonfocus : false , shouldretryonerror : false , } ) ; const flattenpages : t = data ? .length ? initialdata.results.concat ( data.flatmap ( ( page ) = > page.results ) ) : initialdata.results ; const isfetchinginitialdata = ! data & & ! error & & ! initialdata.results ; const isfetchingnextpage = isfetchinginitialdata || ( size > 0 & & data & & typeof data [ size - 1 ] === 'undefined ' ) ;
bug report 👋 , i 'm using useswrinfinite to build infinite scrolling and saw that it does n't support arrays that are nested in an object . description / observed behavior for example , the api that i 'm using does the following : [ api-url ] / ? page=1 [ api-url ] / ? page=2 useswrinfinite tries to append these two objects , which does n't work , instead , it should attempt to append array of request 2 to array of request 1. there seems to be no way to support this atm . additional context swr version : 0.3.0-beta.6 < code > { meta : { } //meta data array : { } // data for page 1 } { meta : { } //meta data array : { } // data for page 2 }
currently fallbackdata is treated as stale data , so swr will not revalidate when revalidateifstale is set to false at the same time . in this way , no request is sent and we can only get the fallbackdata . this is what i expected : harrisoff @ 775646c < code >
hi , not sure if this is possible , but how can i use useswrinfinite to be able to query pages based on their index without downloading all previous pages in sequence ? so in effect , calling setsize ( 40 ) and getting a single api call for that page , instead of refetching all previous pages up to page 40. thank you . < code >
hi everybody , i hope that someone can help me here . i 'm using next with ssr and ssg , and for the normal useswr hook i set all the initial data returning the props with the fallback object like this : and then , in the _app file , i wrap the page components with the swrconfig provider so the fallback data is set for every page , like this : this is working and i have no problem at all . but i 'm using now this useswrinfinite hook , and the initial data is not getting loaded . i 've tried returning the fallback like this : [ unstable_serialize ( key ) ] : data or like an array : [ unstable_serialize ( key ) ] : [ data ] and neither of them work . the keys are the same , so it should get the initial data . is there maybe another swrconfig provider for the infinite hook ? . i 've been looking in the documentation but it did n't find anything . < code > return { props : { fallback : { [ unstable_serialize ( key ) ] : data } } const { fallback , ... restprops } = pageprops < swrconfig value= { { fallback : fallback ? ? { } , } } > < component { ... restprops } / > < /swrconfig >
swr is a great tool and i want to use it as a low-level data fetching api in my application . as far as i know , swr will cache data per different key . so i wonder if a lot of useswr is used , eg . there are many product detail pages in an app , will it cause excessive memory usage ? < code >
currently useswrinfinite only revalidate the first page . this is okay when we sort pages by latest to oldest . if it 's the other way around useswrinfinite only revalidate for a page which is not going to change . ( most of the time ) i think it 'll be great , if there 's an option to revalidate the last page & the first page . here 's i 'm talking about the last page of the whole list . not the last page at a given time . if that 's the case , maybe we can revalidate it automatically without passing any option . < code >
i am using supabase . insert updates , but mutate does not work with update . how can i reflect the array update ? < code > import useswr , { useswrconfig } from `` swr '' ; const { mutate } = useswrconfig ( ) ; import { supabase } from `` src/lib/initsupabase '' ; import { fetcher } from `` src/lib/fetcher '' ; useeffect ( ( ) = > { supabase .from ( `` comments '' ) .on ( `` insert '' , ( ) = > { mutate ( comment_api_url ) ; } } ) .on ( `` update '' , ( ) = > { mutate ( comment_api_url ) ; } ) .subscribe ( ) ; } ; } , [ ] ) ; const { data : commentsdata } = useswr ( comment_api_url , fetcher ) ;
hi , i have an upvote button that calls my upvote function with argument of type upvote or downvote . then i make a post request to my api . i ca n't use useswr in this function since hooks cant be used inside functions . how can i : run the post request only when i click on the button pass in the type prop to my fetcher through useswr i want to use swr for deduping . so when the user clicks 10 times very fast on the vote button it just refetches it after few seconds and just mutating the local cache . thank you guys ! < code > const { data } = useswr ( `` /api/post/vote '' , ( url ) = > postdata ( url , { postid : post.id , type } ) // ca n't use because type is a function argument that i just have when button gets clicked ) ;
i have something like this : and whenever user types in foo , this will make 3 requests , for 3 urls : obviously user does n't care about results from f and fo , but requests were made , and backend is now building the results . dedupinginterval is set to 2000 by default , but that would dedupe requests for the same key . how do i dedupe requests for any key for this instance of useswr ? < code > const [ query , setquery ] = usestate ( `` '' ) ; const { data } = useswr ( '/search ? q= < cur > { query } ' ) ; /search ? q=f /search ? q=fo /search ? q=foo
as everyone knows , useswr caches fetcher results based on the key . i used a custom fetcher to handle asynchronous requests . the key is passed to the argument of the fetcher . there is some inconvenience in this process . if using the same arguments , you will use the same key . using the same arguments will use the same cache even if the fetcher is different . even if the keys are the same , if the fetcher is different , i think the cached data should be separated . in my opinion , there is no reason why the results should be the same if the fetcher is different . to fix it , what do you think about using the fetcher on serializing the key ? < code >
i have been stuck on this problem for 6 hour finally able to solve it i thought i share it with the community so i have parent component a and child component b when i post data to database will led to the parent component a to render and lead to child component to re-render and lose all the data so this a key point to consider 1- swr is sync with db when change made to the db the swr will reload data 2- swr is sharing data across the app using appcontext so iam fetching the same url ex { url : /orders } in parent component and child component ( my bad ) so when i post data to server the swr will notice and reload the new data and because the data is shared across the app every component fetching the same data will rerender do to state change < code >
description i am trying to avoid revalidation at first when the setsize function asks for more rows of data . i understand this is the expected behaviour if i set revalidateall : true ( swrinfiniteconfiguration ) . the problem is that doing this , every time i ask for more rows it revalidates all the previous request . however , i would like to revalidate 2 , 4 and 6 every time i upload some data ( onfocus , for example ) but do not do it the first time i ask for data . example ( asking for two rows every time i invoke setsize ) asks for 2 asks for 2 asks for 4 asks for 2 asks for 4 asks for 6 expected behaviour when more rows are required or re-focusing a page ( with revalidateonfocus : true ) asks for 2 asks for 4 asks for 6 i would like to know if i can specify some options or any implementation to avoid this behaviour . thank you in advance . < code >
now that react 18 has been released , we will need to complete some tasks : update callouts in vercel/swr-site that say suspense is in beta increase prominence of suspense related documentation discuss whether suspense should be used by default in swr < code >
hi guys , thanks for the awesome lib . if i use redux + react . the usual flow is , dispatch action - > redux saga or redux thunk - > api call set the response data to global sate get the state as props in the target component boring job ... ☹️ but ! if i use swr , smells like no need these steps any more . i just have to call useuser ( ) in every component where i need . no worries about multiple duplicated request , no need to handle global state or context any more . no need all that kind of annoying actions , constants , reducers , sagas and etc redux family . am i right ? or is there exception cases to use redux or other state managing lib ? so excited to try this in next project : ) < code >
hi , i have two components . with the first one , i can upload files . in the second one , i list them in a table using paging . in my second component , i am using useswr this way : there is nothing special about this i believe , and it works . however , how can i invalidate all the /api/uploads from my first component , so that the second component can refresh itself ? i really do not want to have a context between those components , or some kind of parent to both of them to hold the total values and invalidate by looping over all the pages . ideally , i would do this in the first component , and that would do it : mutate ( '/api/uploads ' ) ( it could be a regex also , but i am basically just looking for a solution around this idea ) thanks for your help : ) < code > useswr ( [ '/api/uploads ' , itemsperpage , ( page - 1 ) * itemsperpage ] , ( url , limit , skip ) = > fetch ( url + ' ? limit= < cur > { limit } & skip= < cur > { skip } ' ) .then ( res = > res.json ( ) ) ) ;
i 'm trying to clear swr cache on logout and i can see it clearing out all items on the cache.clear ( ) call but upon navigating to the sign-in page the cache seems to be back . am i missing something ? i am on swr version 1.2.2. i 've followed the guide here - < url > my sign-out button code looks like this : when i break on ( swrcache as any ) .clear ( ) ; i can see items in there and the clear ( ) does clear it out . however , on initialization of the sign-in view all of the cache is back ! there were no network calls at that point of the load . is it possible that i 'm clearing a copy of the cache and not the actual cache ? i have tried it with < swrconfig > in app.tsx and without it but same result : any ideas on what i 'm missing ? thanks . < code > // ... const { cache : swrcache } = useswrconfig ( ) ; // ... return ( // ... < div onclick= { async ( ) = > { await auth.signout ( { global : true } ) ; ( swrcache as any ) .clear ( ) ; navigate ( '/sign-in ' ) ; } } > sign out < /div > // ... ) ; < swrconfig value= { { provider : ( ) = > new map ( ) } } > // ... < /swrconfig >
can someone please explain if i could use useswr everywhere in my app . would that be okay to do so , or it may impact performance since swr will cache everything . < code >
i want to use swr to show and refresh every x seconds a conversation component between 2 users . but i do n't want that swr will fetch every time all the messages , but always fetch for new ones . how can i do it ? because every time new data arrives it will override the old one . any ideas ? btw , im using redux if it helps somehow another question , is it make sense to update redux state when fetching with swr ? it will not cause an infinite rendering loop ? < code >
i 'm trying to build scroll-based lazyloading , but always get stuck with the same problem : next page is fetched before previous rendered and in result - next page never appears . i 'm already wasted almost 6 hours and can not make it work . does someone have any examples of doing so ? < code >
i want to allow users to edit each item in displayed in a list . each < item > component has its own data fetching / mutation hitting the item endpoint /api/item/ [ itemid ] on load , does this mean that i 'd be kicking off a bunch of api calls to /api/item/ [ itemid ] for each item , in addition to the data i 'm already getting from /api/items ( to get the list of items in the first place ) . is there a more efficient way to do this ? how can i leverage an api endpoint where i get all the items ? for example , how can i share data from /api/items across the entire list of items ? < code >
i am short of a beginner here , so i would like to ask if i can use the useswr hook with my graphql api built with apollo . i would not like to use the apollo client on the front-end , so i am interested in using relay modern . i have seen various articles and it says it also in the documentation that swr works great with graphql . but does this means it works with a graphql api or just with the graphql-request package ? also , what should i do for fetching data inside the getstaticprops or getserversideprops methods , provided by next.js . will this technique boost my performance , or is it not going to make any change . or , should i only use it within a react.js component ( most likely in the useeffect ( ) hook ) ? note : i will be using issg a lot , so i am not going to use only the default ssg that would fetch the data at build time . thank you in advance for your help or advice ! omg , i love github discussions , you can now ask things or propose new ideas , without messing with a repo 's issues tab that is important to use only for bugs or errors . < code >
edit : the misbehaviour comes from the use of webpack , i have created an issue based on this discussion : # 1880 i try to implement the localstorage based cached as documented here : < url > i have three files : start.js this has the wrapper with the provider which call the newsapp component from the index.js index.js the exported newsapp component uses a reusable data hook called `` usearticles '' from the getdata.js , interactions in this component affect the key that is passed to useswrinfinite . getdata.js the reusable data hook exported from here uses `` useswrinfinite '' and the `` laggy '' middleware from the documentation ( slightly adjusted to work with useswrinfinite ) the map from the cache stays empty and does n't seem to get affected by any changes from the newsapp that are passed to the usearticles hook ... these are the three mentioned files and there connection : i tried useswrconfig in the index.js to check if the swrconfig from start.js properly works , this looks good : idk if this can have effects but im not using a spa ( like create-react-app or nextjs ) , in this case i have to work with a classic server side rendered site which initialises react after the site has loaded via plain js . thank you for you help ! < code >
i have the requirement in which , after a request fails 3 times , i should show a screen - > on that screen , there should be a cta which triggers the whole cycle anew . to achieve that , i have implemented the following code : i have two questions : is there a better way to acheive this ( the extra iserr state seems redundant ) ? can i somehow infer that onerrorretry is on pause from the existing data/error/isvalidating return values ? is there a way to retrieve the exponentiral backoff which is overriden by the custom onerrorretry functionality ? < code > const [ iserr , setiserr ] = usestate ( false ) ; const { data , mutate } = useswr ( `` id '' , fetcher , { onerrorretry : ( _ , __ , { errorretrycount = 3 } , revalidate , { retrycount } ) = > { if ( retrycount < errorretrycount ) { setiserr ( false ) ; settimeout ( ( ) = > revalidate ( { retrycount } ) , 5000 ) ; } else { setiserr ( true ) ; } } , // remove the err retry screen once we get the data onsuccess : ( ) = > setiserr ( false ) , errorretrycount : 3 , } ) ; if ( iserr ) { return < div > < button onclick= { ( ) = > mutate ( ) } / > ... < /div > } // error if ( ! data ) { return < div > ... < /div > } // spinner
i am wondering whether we use the swr hooks in the intended way . sometimes we use the same data in a parent and in nested child components . in such cases we fetch the data in the parent component and pass it via props to the nested child components . it looks as if theofficial swr documentation recommends using the hook locally in every component and fetching the ( already cached ) information there . i am aware of the caching part , but wonder how this affects the rendering . given i have one parent component p and two child components c1 and c2.if i fetch the data in p and pass it down , each component would render once.would n't the child components be rendered twice if each component fetches the data itself ? first due to the parent component being re renderedand againafter they receive the data itself . am i missing something ? < code >
react-navigation mounts each screen component only once ( by default ) . this poses a major problem when using swr because it causes massive re-renders of hooks that are mounted on each ( non visible ) screen . i have many hooks that are dependent on a usesession hook and need to update when a property of the session changes . all those hooks re-validate even when the component is not rendered ( by react-navigation ) . i know its not only an swr problem but do any of you have an idea how to solve this issue ? < code >
hello , i currently use graphql-request as my fetcher library , i am trying to make multiple requests to an api using the refreshinterval config . this works well right now , is it possible to change the input payload for each unique request to the api because currently it uses the input payload for all requests . i need to send a new recaptcha token in the payload for each request to the api . i do not know if this is possible with this library . < code > import { request } from 'graphql-request ' const fetcher = query = > request ( '/api/graphql ' , query ) const data = useswr ( 'query getlink ( < cur > email : string ! < cur > recaptchatoken : string ! ) { signinlinkforemailandotp ( email : < cur > email recaptchatoken : < cur > recaptchatoken ) } ' , fetcher , { refreshinterval : 2000 } )
i ran into an issue recently where i had a component that unmounted but on the unmount that cache in swr was also changed on the unmount , and on the mount again swr did not notice that the data it had was in fact incorrect . to remedy this i performed cleanup on my useeffect , which included setting my data to null . i was wondering if this is standard practice to have to reset the data , or if this could potentially be a bug ? < code >
the docs state swr only updates the states that are used by the component , how ? i fail to understand , how the object destruct ( which happens outside the realm of the useswr hook ) leads to less re-renders ? the swr hook still exports a new object on changes of its internal state , and it does n't know how callers of the hook will destruture it . so how does this magic work - javascript wise ? < code >
hello , i have below code for fetching data from the server , this works perfectly fine until there are no errors . then i added one more swr in the same component , now second swr throw error and then after first swr does not run again . it run axios call , but tabledataexpenses never returned any data , what is going wrong with this ? how to re-run first swr call again ? < code > const { data : tabledataexpenses , error , mutate } = useswr ( '/api/expenses/datatable ' , ( ) = > axios .get ( '/api/expenses/datatable ' ) .then ( res = > res.data ) , ) const { data : showexpense , error , mutate } = useswr ( // pass null when there is no id expenseid ? ( '/api/expenses/show/ ' + expenseid ) : null , ( key ) = > axios.get ( key ) .then ( res = > res.data ) )
i tried to use swr in my next.js app , but it 's not work . for excluding other variables , i install a pure page ( index.js ) from next.js example . and it 's fine to work , until i add a line on the head `` import useswr from 'swr ' '' . npm run dev console appeared : error - syntaxerror : the requested module 'react ' does not provide an export named 'useref ' my browser appeared : _server error syntaxerror : the requested module 'react ' does not provide an export named 'useref ' this error happened while generating the page . any console logs will be displayed in the terminal window . call stack file : ///c : /users/mark/downloads/react/fo/nextjs-layout/node_modules/swr/dist/index.mjs ( 1 ) modulejob.instantiate internal/modules/esm/module_job.js ( 92:21 ) async modulejob.run internal/modules/esm/module_job.js ( 107:20 ) async loader.import internal/modules/esm/loader.js ( 179:24 ) async importmoduledynamicallywrapper internal/vm/module.js ( 422:15 ) i have no idea to debug , can someone give me any suggestion ? my package.json : { `` private '' : true , `` scripts '' : { `` dev '' : `` next dev '' , `` build '' : `` next build '' , `` start '' : `` next start '' } , `` dependencies '' : { `` next '' : `` latest '' , `` react '' : `` 17.0.2 '' , `` react-dom '' : `` 17.0.2 '' , `` swr '' : `` ^1.2.2 '' } } < code >
first of all , thanks a lot for this library . i 've been using it for almost a year , and more intensively for several months , and i love it ! il like to create optimistic user interfaces , and the new optimisticdata option with its auto-rollback behavior is great ! i 'd like to push it a little further : could you support optimisticdata as a function ? i think it would be consistent with the mutate first argument and with # 1817. this function would take the cached data as parameter , and would allow : using the global mutate function extracting and test a pure function that makes the mutation i want , depending on the current data and the operation that is processed again , thanks a lot for your work < code >
i have a component in my next.js app which uses useswr to periodically update the data from an endpoint . this component is very much below the fold and only about 20 % of the users go that far . but the component starts updating as soon as the person lands on the page . is there a way i can make useswr only update the data when the component is actually in view ? i 've already looked at refreshwhenhidden flag but that does not help here . < code >
multiple swr hooks fetch function try to access an endpoint that requires authentication . not all hooks should try to authorize at the same time , but only the first hook . all other hooks fetchers should wait for the authentication to succeed ( or fail ) and then fire their actual request . how do you handle this ? < code >
i want to make a custom hook that adds isloading property to the response of useswr . i found this so post and tried as follows : but it does n't work well in typescript . i 'd like to know how to solve the problem . < code > // swrhook with 'isloading ' property in the response type swrhookwithloading = ( ... args : parameters < swrhook > ) = > returntype < swrhook > & { isloading : boolean ; } ; export const useswrwithloading : swrhookwithloading = ( ( ... args ) = > { const resp = useswr ( ... args ) ; const { data , error } = resp ; return { ... resp , isloading : ! error & & data == null } ; } ) ; const component = ( ) = > { const resp = useswrwithloading ( `` /api/users '' ) ; // expected 3 arguments , but got 1. const data = resp.data ; // typeof data === 'unknown ' } ;
hi guys , im confused , is swr hook only work with get method ? i 've tried alot to get data with post method in swr , but i coulnt , im using next js , i get data in getiinitialprops ( with post method ) and pass it to initialdata , it doesnt work when i change the routes ... how can we use it with post method to cache api ? < code >
i 'm confused , i 've set up an end to end test . my app is using swr hooks and it seems that at some point , when i navigate to the home page , the initial requests are not triggered if i do n't wait at least for 1.5 seconds on the page before . let me illustrate . on this video , the test is running at full speed and you can see that , at the end , when we 're going back to the home page , initial requests ( /typebots and /folders ) are not triggered : < url > here is the expected behavior : < url > /typebots and /folders requests are triggered . i 've set a waitfortimeout of 2 seconds before going back to the home page ( 1 second does n't work ( ? ! ) ) . why is it happening and why does n't it trigger the hooks . i 'm thinking maybe it pulls out data from cache , but why ? < code >
if i provide an empty string as the key argument , for example : am i correct in thinking that this essentially does nothing ? i.e . the fetcher is not called , nothing is cached , data remains unchanged ? maybe i 'm missing something in the docs but i ca n't find anything that addresses this . < code > const { data } = useswr ( `` , fetcher )
we call const { data , error } = useswr ( '/api/user/123 ' , fetcher ) and when not data ! data , we show loading and when data is fetched we show data . so how does it happen automatically ? does useswr use some setstate internally so that react component automatically updates ? < code >
essentially i want to do these do not retry if the status of the response is 404 retry for all other errors i am using onerrorretry in global swrconfig for this purpose . but it seems that i do not retry exponentially after i provide onerrorretry , and it is well documented too you can also override this behavior via the onerrorretry option : is there any way , that i can stop retrying for 404 errors without compromising on the exponential backoff algorithm for other types of errors click here for the codesandbox with demonstration < code > // _app.tsx < swrconfig value= { { fetcher : ( baseurl , config : axiosrequestconfig ) = > axios ( { ... config , baseurl } ) , onerrorretry : ( err ) = > { if ( err.response.status === 404 ) return } , } } > < component { ... pageprops } / > < /swrconfig >
i have a component structured like this with my errorboundary wrapping my suspense element . the mylist component includes an swr data fetching hook as follows : my fetcher method throws an error as follows : when the error happens , i do n't know how to have my ui show the values thrown ( that is , what is in the myerror class ) ( asked also on so but doubt will get answer there < url > ) < code > const rsp = await fetch ( url ) ; if ( rsp.ok ) { return await rsp.json ( ) ; } else { const myerror = function ( message , status ) { this.message = ' < cur > { message } from url < cur > { url } status code : < cur > { status } ' ; this.status = status ; } ; throw new myerror ( rsp.statustext , rsp.status ) ; } } const { data } = useswr ( '/api/mydata ' , fetcher , { suspense : true , } ) ; function app ( ) { return ( < errorboundary fallback= { < h2 > could not fetch cities. < /h2 > } > < suspense fallback= { < div > loading .. < /div > } > < mylist / > < /suspense > < /errorboundary > ) ; }
i 've been trying to implement a use case where i need the call to mutate ( ) to fail with the request error . i am aware that it 's been discussed that mutate should maybe only throw errors related to the act of mutating . however , i think this can be handled differently based on what type of parameter we send to mutate ( ) as the first parameter , and if we send shouldrevalidate as true/false . so what i 'm suggesting is that whenever we do not send anything as a param to mutate ( meaning that shouldrevalidate will be true , as it is by default , and that an api call will be made ) , mutate should throw any eventual api error . < code >
i 'd like to access the cache from an onerror handler so that i can invalidate previously cached values in response to certain types of errors . i see that onerror takes the config object as its third parameter , and in practice , the config object appears to contain a cache member . however , it does n't appear to be permitted by the typescript types or documented . is it permitted to access this member ? can/should the types be updated to reflect this ? or can/should swr add an alternative standardized way of accessing the cache for the current request ? thank you . < code >
continue from # 1764 😄 i want to return static data when useswr fetch error or data is undefined . i try this data type still static_data_type | undefined . any short way to get around this ? do n't know this way will also make useswr return data not undefined or not ? < code > // < parent / > export const getstaticprops : getstaticprops = async ( context ) = > { const planet = await fetch ( `` /destination '' ) ; return { props : { swrfallback : { `` /destination '' : planet ? planet : static_data , } , } , } ; } ; // < children / > const { data } = useswr ( `` /destination '' , { fallbackdata : static_data , } ) ;
hello ! i 'm using swr + supabase on nextjs . this is working well . now if i want to go to the edit page , i will require the data for that specific book : this is also working well , although i have a latency whereas the info should already be available in the cache ( because of the books query that retrieved all books ) . is n't it ? my questions are : how can i make the book query use the cache of books that already contain the book with the specified id ? could swr be `` aware '' of that ? is there a way to somehow `` link '' queries ? thanks for the help ! 🙏 < code > // /pages/books/edit/ [ id ] async function fetchbookbyid ( _key : string , id : string ) { const { data , error } = await supabase .from < book > ( `` books '' ) .select ( ) .eq ( `` id '' , id ) ; if ( error || data.length ! == 1 ) { throw error ? .message ? ? `` book not found '' ; } return data [ 0 ] ; // } ... const { data } = useswr ( `` book '' , fetchbookbyid ) ; // /pages/books async function fetchbooks ( _key : string ) { const { data , error } = await supabase .from < book > ( `` books '' ) .select ( ) ; if ( error ) { throw error.message ; } return data ; } ... const { data } = useswr ( `` books '' , fetchbooks ) ;
while there 's example of making optimistic update with two separate mutate calls , why not add a new mutate signature to act as a shortcut ? < code > mutate ( newuser , updateuser ( newuser ) , false ) // equivalent to mutate ( newuser , false ) mutate ( updateuser ( newuser ) , false )
i see that in source code has this line so the middleware code examples in typescript will be bug : the function name must be mymiddleware , not mymiddleware or react will throw hook violation error i ca n't find where the docs folder to make pull request 😃 < code > export declare type middleware = ( useswrnext : swrhook ) = > < data = any , error = any > ( key : key , fetcher : barefetcher < data > | null , config : swrconfiguration < data , error , barefetcher < data > > ) = > swrresponse < data , error > ; import { middleware } from `` swr/dist/types '' ; export const mymiddleware : middleware = ( useswrnext ) = > { return ( key , fetcher , config ) = > { // before hook runs ... // handle the next middleware , or the 'useswr ' hook if this is the last one . const swr = useswrnext ( key , fetcher , config ) ; // after hook runs ... return swr ; } ; } ;
so , imagine if you call api and cache the data , now if you want to update part of data how would you do that ? for example : - it 's react native project , there are 2 endpoints , /users/posts users/1/posts ( all post of user by id 1 , it 's logged in user ) now imagine we call first endpoint , get data and cache it , and then i go to my profile , and see all my post , now i update one of my post title , question is how am i gon na update all cached data , /users/posts also has my posts and there may be some other endpoints where the same post exists which is not updated , in graphql we can update fragment , i am not sure if it is even possible to do it with this ? < code >
hello , we are trying to migrate from ^0.3.5 to ^1.1.1 . according to the migration guide , it should be possible to replace all revalidate ( ) calls with mutate ( ) . however , mutate does not seem to update the data , in contrast to revalidate ( ) . 0.3.5 working : now , the old data is logged once as `` beforeupdate '' and the updated data as `` afterupdate '' 1.1.1 not working now , both `` beforeupdate '' and `` afterupdate '' log the old data . what am i doing wrong ? thank you ! < code > const settingsswr = useswr < settings > ( ... ) ; console.log ( 'beforeupdate ' , settingsswr.data ) await settingsswr.mutate ( settingspayload , false ) ; await settingsswr.mutate ( ) ; console.log ( 'afterupdate ' , settingsswr.data ) const settingsswr = useswr < settings > ( ... ) ; console.log ( 'beforeupdate ' , settingsswr.data ) await settingsswr.mutate ( settingspayload , false ) ; await settingsswr.revalidate ( ) ; console.log ( 'afterupdate ' , settingsswr.data )
the examples for providing initial data via the fallback option in the swrconfig provider make sense . but what if a request needs arguments such as , for example , when using a graphql api ? the above does not seem sufficient when a graphql query is used as part of the cache key . < code > fallback : { '/api/graphql ' : { data } } < swrconfig value= { { fallback : { '/api/user ' : { name : 'bob ' , ... } , '/api/items ' : ... , ... } } } > const { data } = useswr ( [ graphql_endpoint , graphqlquery ] , fetcher ) ;
hi ! i 'm experiencing this annoying issue on react-native and i 'm not sure how to tackle it . there 's a mode in our app where we set a refreshinterval on a couple of requests . this all works fine , until the user puts the app in the background . when coming back to the foreground a timeout error is triggered , thus triggering the onerror callback of swr . anything we can do to prevent this ? this illustrates what happens . there 's quite the time gap between the last two api requests , and this is when the user comes back from the background . < code >
swr would't send requests of same key anymore but return the cache of it within stale time when stale timer expires , swr would resend request of current page on mounted or when we mutate it manually is this feature needed and feasible ? < code >
if useswr gets an error after successfully getting data , it keeps the previously cached ( stale ) data while also reporting the error . this is normally okay , except for one scenario : if a useswr request results in an http 404 response , i want to treat it as an error , but i also want it to recognize the fact that the data no longer exists and remove it from the cache . is there a clean / recommended way of doing this ? the best approach i 've come up with so far is to hack together an onerror and onerrorretry handler , but it feels pretty ugly . < code > function onerror ( err : error , key : string ) { if ( err instanceof backenderror & & err.response.statuscode === statuscodes.not_found ) { // use mutate to clear the local data . first check the cache to avoid an infinite // loop . mutate clears the error , so pass shouldrevalidate true so that useswr // will retry and see a new error . if ( cache.get ( key ) ) { mutate ( key , null , true ) .catch ( promisecatchall ) ; } } } function onerrorretry < t > ( err : error , key : string , config : configinterface < t , error > , revalidate : revalidatetype , opts : revalidateoptioninterface ) { if ( err instanceof backenderror & & err.response.statuscode === statuscodes.not_found ) { // if we know that the item is n't there , there 's no reason to retry . return ; } // continue with standard isdocumentvisible ( ) , retrycount , exponential backoff ... } useswr ( key , fetcher , { onerror , onerrorretry } ) ;
the docs mention deep comparison should prevent unnecessary re-renders here < url > however , i am getting re-renders using code very similar to the next.js example here < url > when i log out data in the article component the data does not change but it is output twice indicating that there was a re-render . what is causing this to happen ? it seems data should only be output once since it did not change . i even mocked my fetcher to return like this and the problem still happens edit : here is an example forked from the next.js ssr example here < url > < url > the only update i made was to change const { data , error } = useswr ( api ) ; to const { data , error } = useswr ( api , fetcher ) ; this causes is data ready ? true to log twice < code > export const fetchlist = ( config ? : { ssr : boolean } ) = > { return new promise ( ( resolve ) = > { settimeout ( ( ) = > { resolve ( { test : 'sss ' } ) ; } , 30 ) ; } ) ; } ;
i have too many tracks , on click on each track button it should fetch that data using useswrinfinite if it is first-time clicked . if i revisit same track than it should not fetch it again is there any way to achieve this ? please help me this regards thanks in advance < code > function fetchtrainingdata ( ) { if ( preworkshop === true ) { return ( const { data : preworkshop , error } = useswrinfinite ( index = > '/api/training ? track=preworkshop & page='+ ' < cur > { index + 1 } ' ) ) } else { const { data : postworkshop , error } = useswrinfinite ( index = > '/api/training ? track=postworkshop & page='+ ' < cur > { index + 1 } ' ) } } < button onclick= { ( e ) = > { e.preventdefault ( ) ; setpreworkshop ( ! preworkshop ) } } > show { preworkshop ? 'show postworkshop ' : 'show postworkshop ' } < /button >
i am using middleware and add it this way : < swrconfig value= { { use : [ logger ] } } > .... < /swrconfig > what would be proper typing for middleware from example in the docs ? < code > function logger ( useswrnext ) { return ( key , fetcher , config ) = > { // add logger to the original fetcher . const extendedfetcher = ( ... args ) = > { console.log ( 'swr request : ' , key ) return fetcher ( ... args ) } // execute the hook with the new fetcher . return useswrnext ( key , extendedfetcher , config ) } }
currently , the only way to conditionally disable a swr hook is to pass a falsy key to useswr : however , we got feedback from users that it might be good to have an option for that : it 's something good to have , but also troubles me with two questions : if the key depends on something conditionally , wo n't it be unnecessary to use an option ? is it a good thing to have 2 ways of doing 1 thing ? < code > useswr ( key , { enabled : false } ) useswr ( user ? '/api/avatar ? id= < cur > { user.id } ' : null , { enabled : user ? true : false } ) useswr ( / * what should you use here ? * / , { enabled : user ? true : false } ) useswr ( null )
i have a load more button , within a brand new nextjs app , that uses useswrinfinite . every time i click it it makes 2 calls to my backend . the first call is with index 0 and the second is with the incremented index . here is my component : and here is my endpoint these are the logs after i 've clicked the button 3 times : why does it call the backend with page / index 0 and then again with the correct incremented index ? < code > function home ( ) { const { data , size , setsize } = useswrinfinite ( ( index ) = > '/api/user ? page= < cur > { index } & per_page=2 ' , ( url ) = > fetch ( url ) .then ( ( r ) = > r.json ( ) ) , { initialsize : 1 } ) return < button onclick= { ( ) = > setsize ( size + 1 ) } > { 'load more ' } < /button > } calling the backend with { page : ' 0 ' , per_page : ' 2 ' } calling the backend with { page : ' 1 ' , per_page : ' 2 ' } calling the backend with { page : ' 0 ' , per_page : ' 2 ' } calling the backend with { page : ' 2 ' , per_page : ' 2 ' } calling the backend with { page : ' 0 ' , per_page : ' 2 ' } calling the backend with { page : ' 3 ' , per_page : ' 2 ' } export default ( req , res ) = > { console.log ( 'calling the backend with ' , req.query ) res.send ( 200 ) }
i 'm trying to create a custom hook with muttate pattern but my updated data does not trigger a ui refresh . i ca n't find out why . if someone can help 🙏 here is my code : < code > export function usetasks ( user ) { const { data , error , mutate } = useswr ( user ? '/api/tasks/ < cur > { user } ' : null , fetcher ) ; const done = usecallback ( async ( task ) = > { task.when = format ( new date ( ) , 'yyyy-mm-dd ' ) ; task.done = true ; mutate ( ( tasks ) = > [ task , ... tasks.filter ( ( t ) = > t.id ! == task.id ) ] .sort ( ( a , b ) = > a.name.localecompare ( b.name ) ) , false ) ; await axios.post ( '/api/tasks/ < cur > { user } ' , task ) ; mutate ( ) ; } , [ mutate ] ) ; return { tasks : data , isloading : ! error & & ! data , error , done , } ; }
my problem : my pagination is based on http raw post data rather than the key ( url ) . since the key is the same , the pagination does not work well . my approach however , i do n't think it 's the good solution my question : what 's the best way to do ? < code > export const useproductlist = ( pageindex ) = > { const url = base_url + apipath.productlist ; const params = { h5urlprefix : `` 007 '' , pagesize : 5 , startindex : pageindex , status : `` sell '' , _type : `` pc '' , } ; const fetcher = ( ) = > axios ( { method : `` post '' , url : url , data : params , } ) .then ( ( res ) = > { return res.data ; } ) ; console.log ( `` pageindex = `` , pageindex ) ; const { data , error } = useswr ( url , fetcher ) ; return { items : data ? .data ? .list , } ; } ; const url = base_url + apipath.productlist + ' ? xx= < cur > { pageindex } ' ;
in useswr i can declare the type of the data returned with useswr < sale [ ] , error > .. however , i could n't find a way to tell the middleware i configured via { use : [ salesmiddleware ] } which i am using to transform part of the data fetched . i just declared it as : but i could n't find any way to override the declaration for the data . after several attempts at typecasting the data inside the middleware function , which looks awful , i ended up with // @ ts-ignore , which is not quite the proper thing to do but , by the time being , it looks less awful than all the messy type casting here and there . btw : it might be nice to add typings to the examples for the middleware . thanks in advance for the help . < code > const salesmiddleware : middleware = ( useswrnext ) = > {
hello ! thanks to all the people who develop swr ! in tsconfig.json in /examples/basic-typescript , strict : false is set , so there will be no error even if useswr is used incorrectly . like this if the first argument of useswr is set to null , an error will originally occur . this confused me when i was trying to fix issue # 1576 . can i create a pr where i fix it to strict : true ? < code > const { data } = useswr ( null , fetch ) // an error is expected , but no error occurs .
hi there , how are the release notes for this repo generated on github ? i would like to do something similar for a project , but ca n't seem to find a dependency or config somewhere that is generating them . do you mind pointing me to the right place to look ? thank you ! < code >
the goal is prefetching data for ssg pages ( swrconfig ) with data hydration using useswr on client side . the page has two api calls on it that use the context.params.id to query the api with . resource : < url > my issue is that i 'm not sure how to properly query the api for swrconfig to prefetch the data . < code > export const getstaticpaths = async ( ) = > { const res = await fetch ( `` < url > ) ; const posts = await res.json ( ) ; // generate the paths const paths = posts.map ( ( post ) = > ( { params : { name : post.city } , } ) ) ; return { paths , fallback : true , } ; } ; export async function getstaticprops ( context ) { const name = context.params.name ; const res_showroom = await fetch ( process.env.web_api_showroom + ' ? showroomname= < cur > { name } ' ) ; const posts_showroom = await res_showroom.json ( ) ; const res_location = await fetch ( process.env.web_api_location + ' ? locationname= < cur > { name } ' ) ; const posts_location = await res_location.json ( ) ; return { props : { fallback : { ' < url > } ' : posts_showroom , ' < url > } ' : posts_location } , } , } ; } '' '
take below codes for example : how can i take request data from the cache since the params of the request is dynamic , hence is not able to serialize into keys ? < code > < swrconfig value= { { provider : ( ) = > new map ( ) } } > < app / > < /swrconfig > ... const componentwithrequest = ( props ) = > { const { data , error } = useswr ( [ 'api/endpoint ' , props.params ] , fetcher ) // work with response data or error } ... const componenttrytousecache = ( ) = > { const { cache } = useswrconfig ( ) // try to get cached data from above request component // it 's supposed to be like : // cache.get ( serialize ( [ 'api/endpoint ' , params ] ) ) }
hi , i 'm trying to combine a zustand store with swr . i wish to dispatch a zustand action through onloadingslow , onsuccess and onerror , but this gives me the following error : invalid hook call . hooks can only be called inside of the body of a function component . is this possible somehow ? minimal repro codesandbox : < url > i used to do this with a redux dispatch which worked fine , but now when refactoring to zustand it does not seem to be possible anymore . here 's the code : help is greatly appreciated ! < code > export const swrglobalconfig : swrconfiguration = { errorretrycount : 3 , loadingtimeout : 2000 , onloadingslow : ( ) = > { usedisplaystate ( state = > state.activateloader ) ( ) ; } , onsuccess : ( ) = > { usedisplaystate ( state = > state.deactivateloader ) ( ) ; } , onerror : err = > { const e = err as axioserror ; if ( e.isaxioserror ) { const addnotification = usenotificationstore ( state = > state.addnotification ) ; addnotification ( { key : uuidv4 ( ) , message : e.message , severity : `` error '' , } ) ; } else { const addnotification = usenotificationstore ( state = > state.addnotification ) ; addnotification ( { key : uuidv4 ( ) , message : err , severity : `` error '' , } ) ; } usedisplaystate ( state = > state.deactivateloader ) ( ) ; } , } ;
is there a way i can re-fetch data and make the request all over again on a certain condition with swr ? i have a page where i 'm displaying a list of items and there is a dropdown on the page to allow users to filter results , depending on what the user chooses to be ordered by , i have to re-fetch data with the needed query parameters . is there a way i can re-fetch at the certain conditions when the user specifies a filter for example 'best-selling ' . < code >
is it possible to not cache particular api call ? data returned by this endpoint changes a lot on backend so when i call the endpoint second time , it returns me cached data which are already invalid on be . < code >
for example , in our app we have keys like /projects /client/ : id/projects /client/ : id/projects ? page=2 & page_size=20 we use modals to edit individual projects , but its pretty hard to pass all the possible mutates . is there a way where we can refetch every key that matches `` projects '' ? perhaps even better , only rerender those keys that are currently rendered . < code >
hello , i have fetcher functions . fetcher 1 data is used in fetcher 2. according to documentation i created 2 dependant hooks , i can see correct data from fetcher 2 in the console . but that data is not rendered on screen . anybody can helps please ? < code > const { data : stakedbystaker } = useswr ( 'stakedbystaker ' , ( ) = > fetcherstakedbystaker ( slice , accounts ) ) const { data : liststaked , error } = useswr ( ( ) = > 'liststaked'+stakedbystaker [ 0 ] .staker , ( ) = > fetcherstakedfights ( stakedbystaker , accounts , web3 ) ) if ( error ) return < div > failed to load < /div > if ( ! liststaked ) return < div > loading ... < /div > return ( ... )
hi there , we have a use-case which requires the data to be loaded onto the page as requests are returned ( not sequentially , not all at once , but load as data comes in ) . for example , there are 3 requests : request request time a 10s b 2s c 5s we would like to the data to be available immediately as follows : time data 2s [ null , b , null ] 5s [ null , b , c ] 10s [ a , b , c ] i have looked into useswrinfinite with both initalsize and setsize , however , it seems like all the requests have to complete before the data is returned . from my testing with useswrinfinite , if i put initialsize : 3 , all 3 requests have to complete before data is returned . if i put initialsize : 1 then subsequently call setsize ( 3 ) , it waits until all 3 requests are completed before returning data , not as they became available . could you please help me find an example / solution that could accomplish what i 'm proposing above ? update : looks like this use-case would be resolved by having a usequeries hook . as mentioned in # 1041 # 1038 < code >
i fail to understand how i would pass username and password to the useuser function . useuser.js the `` authentication example '' has this as login function which i find very diffuse . is my method of logging in weird ? am i allowed to think that the example is not complete / thorough enough ? i know i `` could '' pass username and password with useswr ( [ '/login ' , username , password ' ] , fetcher ) . but that does n't really help . since i 'm importing the useuser function from index.js . should i pass username and password through this ? it just doesnt feel right since im not seeing that anywhere in the tutorials . i 'm pretty lost , please help < code > export function login ( ) { // add cookie document.cookie = `` swr-test-token=swr ; '' ; } import useswr from `` swr '' const fetcher = ( username , password ) = > fetch ( '/login ' , { method : 'post ' , headers : { 'content-type ' : 'application/json ' } , body : json.stringify ( { username , password } ) , } ) .then ( res = > res.json ( ) ) const use_user = ( ) = > { const { data , mutate , error } = useswr ( '/login ' , fetcher ) const loading = ! data & & ! error const loggedout = error & & error.status === 403 console.log ( 'swr data ' , data ) console.log ( 'swr error ' , error ) return { loading , loggedout , user : data , mutate } } module.exports = useuser const { user , mutate } = use_user ( username , password )
hi 👋 i have a response interceptor that redirects user back to login if the token is invalid , but if the user login again before dedupinginverval ends my page 's content is not loaded . i 'm using a high value for dedupinginterval like 5000 ms to prevent multiple repeated calls while navigating between pages . so the first api call fails because of the token , then when the user gets back to the page it is not fetching data again ( even the first one failing ) . i tried calling cache.clear ( ) but dedup info is no on cache or mutate , is there a way clear all concurrent_promises ? i saw there is a new unmount on initcache response , is there a way to access it ? < code >
hey , i have an array of user ids and i need to make a request for each of them using swr . i 'm looking for an equivalent to the usequeries hook in react query . how do you achieve the same thing with swr ( each user should be cached individually ) ? < code >
hello ! i am having trouble creating a custom compare function when using useswrinfinite . if you looks at the console of a , and b when loading more items , the data that it compares changes . it first compares individual requests , then it compares the arrays of individual requests . this makes it difficult , for example , if i want to ignore a certain property that changes on every request ( like a timestamp ) , or reduce and only compare ids . is this intended ? any suggestion about how to handle ? < url > thank you so much ! gyles fohl < code > compare : ( a , b ) = > { console.log ( `` a '' , a ) ; console.log ( `` b '' , b ) ; return dequal ( a , b ) ; }
hi all , i have two pages home page - shows a list of items with a status . for example , let 's say all items have the status new . item 1 page - here we make a different api call to retrieve item details . you can also do a put request to update the status to `` not interested '' . scenario : user navigates freely between the pages . i want to cache the information since it will always be the same . i do not want to make any api requests when they click around . the only time i want to refetch on the home page is when the user has clicked `` not interested '' on the item 1 page . is there a way to do this ? i have used revalidateifstale : false and revalidateonmount : false . but this does not seem to be working at all . what is the best way to achieve this behaviour ? < code >
this library make fetching data easy . i would like to thanks everyone who maintain this library . i am facing an issue while when i use `` revalidatefirstpage : false '' option in useswrinfinte function . the typescript gave me following error . i am using 1.1.0-beta.8 version of swr . it seems there is no type definition added for revalidatefirstpage in swrinfiniteconfiguration . < code > - type ' { fallbackdata : any [ ] ; revalidatefirstpage : boolean ; } ' is not assignable to type 'swrinfiniteconfiguration < any , any > ' . - object literal may only specify known properties , but 'revalidatefirstpage ' does not exist in type 'swrinfiniteconfiguration < any , any > ' . did you mean to write 'revalidateifstale ' ?
hi , i am implementing a 'load more ' storyblok stories button . when the page loads i fetch stories 1 - 10 and display them . when the user clicks 'load more ' i want to display stories 1 - 20 and so on . i am using swr to help manage the fetching of the stories . my question is : i fetch stories 1-10. when i fetch stories 1-20 will swr return stories 1-10 from the cache and 11-20 from storyblok ? or because it is a different get query all 20 stories will be fetched ? < code >
good day , everyone ! : ) i 'm not sure if problem 's related to swr , but it happened after i migrated from ^0.5.6 to ^1.0.1 ver . the day before . i have an article page where i fetch article on server-side in getstaticprops , pass it as props to page and set it as fallbackdata . pages/articles/ [ slug ] .js : the page loads successfully but after a moment it becomes blank and says that data 's undefined : console shows that the data object becomes empty after re-renders ( unlike article and fallbackdata objects ) : when i downgrade swr to ^0.5.6 everything is okay . does anybody know why is it like that ? < code > ... export default function article ( { article } ) { const fallbackdata = article const { data , error } = useswr ( url , url = > fetch ( url ) .then ( res = > res.json ( ) ) , { fallbackdata , revalidateonfocus : false , revalidateonreconnect : false } ) console.log ( article , fallbackdata , data ) ...
with 1.0 the old revalidate was deprecated . we intentionally re-exported this function from our swr based hooks as refresh to update the data ( via flatlist pull to refresh ) . what is the recommended way of re-exporting mutate with the same signature as revalidate now ? verbatim exporting mutate risks accidental misuse , when its uses as a event handler where it is passed a nativeevent which would then mutate the data to be the events data . the only way i see at the moment is : but that introduces some boilerplate code now and it still changes the returned signature from promise < bool > to promise < data | undefined > < code > function myhook ( id ? : string ) { const { data , error , mutate } = useswr ( id || null , ... ) const refresh = react.usecallback ( ( ) = > mutate ( ) , [ mutate ] ) return { data , error , refresh ) }
i 'm using swr to fetch new data , but i want to show a notification when has new data was fetched . any idea for me . thanks < code >
hello ! what i do n't understand is the following part of the source . < url > the first argument of useswr determines the type of fetcher . if the first argument is null , it appears to enter the never branch in the fourth line from the bottom and cause an error , but in fact , even if null is entered , it enters the other branches and is valid . why does it behave this way without entering the never branch ? thanks in advance ! < code >
in an effort to increase performance in our app , we are monitoring the js thread via the performance tab in the google dev tools . while the app was idle , i took a performance recording for 13 seconds and noticed that about every 3 seconds , there was a bunch of processing/activity by swr . i disabled all of our polling in our app . these tasks total up to about 12 milliseconds worth of cpu time but at 6x slowdown that 's 72ms every 3 seconds . any ideas what these might be and is there a way to disable them ? < code >
like the useswr hook , useswrinfinite has an isvalidating property , which can be used to notify the user when the hook is fetching new data . is it somehow possible to differentiate the state of when a new page is fetched ( and has n't finished yet ) from when revalidation happens e.g . due to focusing the window ? i 'd like to use this to show a loading indicator below my list when the user has reached a scroll position that triggers the fetching of the next page , but i do n't want it to show when revalidation happens after re-focusing the window . many thanks for your help ! < code >
i would like a page that displays some feed , and refresh it automatically . however , it should not refresh while the user is active on the page , because it would be disturbing . is there a way to have a refresh interval , but only if the user is not doing anything e.g . scrolling the page , dragging mouse , typing something , etc. ? i could use the new idle detection api or listen for mouse and scroll events , but is n't there already a such feature in swr ? < code >
i have two request , the second request rely one first request result , follow the swr document : const { data : user } = useswr ( '/api/user ' ) const { data : projects } = useswr ( ( ) = > '/api/projects ? uid= ' + user.id ) if condition changed , i need refresh , how could refresh follow this a- > b flow ? and do i have the same loading status flow : a data loading -- - > a data fetch suc -- - > b data loading -- -- > b data fetch suc ? < code >
i have been using looking to upgrade my swr version however noticed after changing initialdata to fallbackdata the hook would recall the endpoint client side . is there a way to achieve what initaldata originally did to prevent the duplicate call ? < code >
hi everyone , i am trying to display multiples graphs in a single chart . to update the chart , i have a setstate hook setchartoptions which include the serie i want to display . with my code below , the chart stays empty . very likely because the initial state of the hook is not refreshed after data is loaded ; data remains undefined . could you explain me what is the best way to define a state based on data fetched from swr ? ( any example code would be very helpful ) thank you so much < code > const [ chartoptions , setchartoptions ] = usestate ( { series : [ { id : 'stockvalue ' , data : mydataobject [ 'stockvalue ' ] .data } ] } ) ; function loaddata ( id ) { const { data , error } = useswr ( 'api/stock ? id= < cur > { id } ' , fetcher ) ; return { data : data , isloading : ! error & & ! data , iserror : error } ; } const mydataobject = { stockvalue : loaddata ( 1 ) , graph2 : loaddata ( 2 ) , graph3 : loaddata ( 3 ) } ;
how github issues reactions live update the likes count & comments in the webpage on any devices opened the page , may i know what stacks or technology being used in the github issues frontend ( izit using swr ? ) & backend ? its like magic to me , that github able to push the update of content to the issue page without websocket & sse . how does it identify the client & update the client 's webpage ? my question is does the github using swr to achieve live comments update ? < code >
hi ! so i have this swr userequest function that is supposed to do some internal remapping of the values i get from useswr . i plan to use it like const useprojects = userequest < projectsresult > ( '/projects ' , 'projects ' ) and have it return type unfortunately , the best i can get from it is any ideas on how to solve this ? it would be greatly appreciated ! < code > { [ x : string ] : any , ... } { projects : project [ ] , ... } export const userequest = < t extends apiresult > ( url : string , collectionname : string ) = > { const { data , error , mutate } = useswr < t > ( url , fetcher ) return { [ collectionname ] : data [ collectionname ] , isloading : ! error & & ! data , iserror : error , empty : data [ collectionname ] & & ! data [ collectionname ] .length , mutate } }
hey guys , i 'm facing an issue with mutate in swr i 'm using the mutate that exists inside useswr hook and after updating the data as im showing in the picture the scroll position scrolls to down i tried many things to solve it but nothing worked ! ! here when i replaced the res.data to first like so mutate ( [ res.data , ... filteredreviews ] ) ; it worked but if i tried to edit something in the middle same problem returns back < code >
hi there , is it currently possible to know if the response came from a polling request ? i want to differentiate error handling on automatic requests made by refreshinterval and manual revalidates . < code >
i have 3 useswr call : and all these three requests are revalidated by the same event . then i found in our application , a and b will return data returned by c. if i change to the problem is gone . i wonder if useswr does n't use the fetcher as one of its cache keys . furthermore , what if the fetcher changes every call ? ( inlined function fetcher : ( ) = > ... ) i use `` query '' cause getdataa/b/c does not need any parameters so the first argument of useswr makes no sense for the fetcher < code > const a = useswr ( 'get-a ' , { fetcher : getdataa } ) const b = useswr ( 'get-b ' , { fetcher : getdatab } ) const c = useswr ( 'get-c ' , { fetcher : getdatac } ) const a = useswr ( 'query ' , { fetcher : getdataa } ) const b = useswr ( 'query ' , { fetcher : getdatab } ) const c = useswr ( 'query ' , { fetcher : getdatac } )
hello , i am trying to build a react ssr on azure function for javascript with express . however , azure function for javascript does n't support any es6 or above . i have to use es5 syntax . could i use swr in this environment ? here is what i tried : async function getchecklistdate ( ) { const useswr = require ( 'swr ' ) .useswr ; const commonfunctions = require ( ' .. / .. /components/commonfunctions/commonfunctions.js ' ) ; const { request , gql } = require ( 'graphql-request ' ) ; async function getchecklistdate ( ) { const { data , error } = useswr ( query backuprestorechecklistgetcheckdateallquarter { backuprestorechecklistgetcheckdateallquarter } , query = > request ( '/api/graphql ' , query ) , ) console.log ( data ) ; console.log ( error ) ; return `` data '' ; } when i ran it , it gave me this error : ( node:23177 ) unhandledpromiserejectionwarning : typeerror : useswr is not a function thanks < code >
as far as how i understand swr , it 's work pretty neat with direct communication . but i wonder what happen if swr can only contact with a `` pseudo '' proxy middleware . for example , swr - > next.js api - > next.js api will use ( for example ) axios call remote backend api , the data from backend api will be passed all the way back to client side via next.js api . assume we can not directly call remote backend api via swr . will this still make swr viable comparing to regular fetching api like axios . < code >
i was implementing likes feature in my blog post using swr and i used two separate fetcher , one for /api/views/ and other for /api/likes in their respective file and it seems that swr returns only one data as an object ( either the likes or the views depending on which data is fetched first ( i hope ) ) . the problem got solved when i used a global fetcher and passed is through swrconfig . so can anyone explain me what actually i did wrong .. or how swr works with the fetcher function ? < code >
hi , i have a simple swr like this but i get page=0 called multi times when i click to load more button did i do something wrong ? < code > const { query } = userouter ( ) const { data , setsize , size } = useswrinfinite ( query.categoryid ? ( pageindex , previouspagedata ) = > { console.log ( 'previouspagedata ' , previouspagedata ) console.log ( 'pageindex ' , pageindex ) if ( previouspagedata & & ! previouspagedata.length ) { console.log ( 'return null ' ) return null } return '/api/category ? page= < cur > { pageindex } & limit=8 & category= < cur > { query.categoryid } ' // swr key } : null , query.categoryid ? fetcher : null )
i have a hoc to encapsulate form components in order to not render them until the validation has been run , because if the form component gets initialized with cached data it wo n't be reupdated after the revalidation , something like this : the idea is that when the isvalidating turns true and then false , a validation has happened . i previously had implemented with a single boolean state variable `` hasvalidatedatleastonce '' and i thought it worked fine , but then i noticed that even when i use mutate ( ) the isvalidating becomes true and false one time before the fetcher function runs . what is that supposed to mean ? why is it that isvalidating becomes false if the fetcher has n't been run ? what is being validated then ? is this behaviour consistent enough that i can safely implement this just raising the required number of times to 2 ? setting `` shouldrevalidate '' on mutate to true does n't seem to make a difference either . < code > useeffect ( ( ) = > { if ( isvalidating ) { setnumberoftimesthathasbeenvalidating ( ( n ) = > n + 1 ) ; } } , [ isvalidating , setnumberoftimesthathasbeenvalidating ] ) ; const requirednumberoftimes = 1 ; const hasvalidatedrequirednumberoftimes = ( numberoftimesthathasbeenvalidating > = requirednumberoftimes & & ! isvalidating ) || numberoftimesthathasbeenvalidating > requirednumberoftimes ; if ( ! hasvalidatedrequirednumberoftimes ) { return < > { fallback } < / > ; } return < realcomponent / >
i tried mutating a parent url eg : url= { /users ? type= < cur > { type } & paginate=10 & page= < cur > { page } } in a child component by doing import { mutate } from `` swr '' ; mutate ( url ) ; but it does n't revalidate . please am i doing something wrong ? i said the documentation is old because i also tried to use the documentation 's import useswr , { useswrconfig } from 'swr ' function app ( ) { const { mutate } = useswrconfig ( ) but useswrconfig does n't seem to appear < code >
hello guys ! i have a question about cache . in the old version i used this import : import { cache } from 'swr ' to use it in redux action ( for logout ) . but now cache can be used only in components with hook useswrconfig . i ca n't use hooks inside redux action ... what can i do in this situation ? is any solution for this case ? thanks for your help ! < code >
i want to read a cache key that 's supposed to be a boolean . but when i use : isdataloading has 'any ' type , obviously because i have n't informed swr anywhere that it 's supposed to be a boolean . is there any way to inform this so that it 's enforced everywhere ? useswrconfig does not accept any generic types . < code > const { cache } = useswrconfig ( ) ; const isdataloading = cache.get ( 'contexts-selector-loading ' ) ;
just asking out of curiosity , my project has a bug that appeared to be magically `` fixed '' after upgrading the swr package to version 1.0.0. however , after a deeper inspection , i found the bug is still there . the bug is caused by mutating a cache with a null value , causing a downstream component that expects the cache value to be an object and access one of its properties to crash . on the swr package version 1.0.0 , the mutation with a null value now keeps the previously cached value , so the downstream component no longer crashes . is this something intended ? < code >
hello to all , i have few small questions i did n't find an answer in your documentation . the major question is about useswr and seo : does useswr is adapted/suits seo requirements ? here is use-case : web page has few date sources loaded by api . ( example , i have `` product '' page , and i have 3 api paths to get data : productinfo , productcomments , productratings ) web page loads the first bunch of information server-side ( example , productinfo ) web page gets productinfo and got renderer , but still need to get productcomments and productratings via api . web page has 2 empty blocks ( divs ) reserved for productcomments productratings web page loads productcomments productratings using useswr ( imagine to load all data we need to spend 3 seconds ) web page completely loaded with all data . questions : does google , bing etc , will get the data about productcomments productratings , loaded by useswr , and will it `` reference '' this data ? can we useswr to create web pages with good seo ? i like to load all data by useswr , and not , for example with getserversideprops . i know this is kind of strange in the context of nextjs ( for better seo they recommend to use getstaticprops ) , but i like to have some kind of loaders on each page with huge amount of data . for example , in my context this page can be `` listofproducts '' - data can be up to 5mb to load . using : useswr , nextjs , vercel . thanks for your help ! < code >
with the new cache provider + global fallback , we now have a good way of fetching data on the server side & bootstrapping the application on the client side with the relevant data . however , this opens up another problem i 'm starting to consider : how do we tell the server the client has a particular set of data and not to refetch it ? we 're using nextjs , and with the ssg , this is admittedly not really an issue , but we 're building a logged-in app that fetches the authed user 's info in getserversideprops on initial load , so we can bootstrap the app as quickly as possible . however , if the user navigates to another page that also needs that same info , that data is reloaded on the server , even though the client already has it . has anyone started to look at/consider how we might be able to tell nextjs `` hey , we have the data for this key , you do n't need to reload it for me '' ? < code >
i use < url > example from swr official documentation . on that page it seem fine , when i change path to / it redirect immediately to dashboard without even showing a moment of login page . but when i used it on my project , it show index page for a moment . how to fix this ? this is my useuser ( ) hooks . i can not use loggedout the same way in the example because fetch wo n't return error even with my api returning 401 http response . instead it return the data as text . any idea how to fix this ? < code > import useswr from 'swr ' export default function useuser ( ) { const { data , mutate , error } = useswr ( ' < url > ) const loading = ! data & & ! error const loggedout = data === 'unauthorized ' return { loading , loggedout , user : loggedout ? null : data , mutate , } }
would y'all add a link to the migration guide y'all released on your blog to the 1.0.0 github release ? < url > i stumbled on it only after upgrading a project of mine and knowing this existed would have been helpful : ) thanks , and congrats on the milestone ! < code >
let 's suppose the user made an action that changed a big part of the page . how do i refresh everything , without calling `` revalidate '' or `` mutate '' on every single hook ? i thought of simulating a focus on the page , but is there a cleaner way of doing this ? < code >
the problem i am trying to solve : if you have some sort of data table with sorting , filtering , pagination functionality implemented through the backend . using swr library you would create multiple diferent fetch requests . for example like so : all these requests would create separate keys in the cache . the question is when i update the data table ( e.g . add a todo ) how can i clear all this cache ( everything asociated with /api/todos request ) so as to force refetching ? potential solution : the only way i can think of is to get the cache object directly , iterate over the cache keys manually , check if they start with /api/todos and clear if they do . is there any other ( simpler ) way i am not seeing , or is this the way to go ? < code > const { data } = useswr ( [ '/api/todos ' , page ] ) const { data } = useswr ( [ '/api/todos ' , page , sortby , sortorder ] ) const { data } = useswr ( [ '/api/todos ' , page , sortby , sortorder , filters ] )
please consider such component . i sucessfully get image from server but i can not see any data in console log . also i ca n't access swr 's error - it tells me error is not defined . and if i move const { data , error } = useswr ( imageid & & 'someurl\getimage ' , getexistingfile ) ; above it tells me that getexistingfile function is not defined . also i wonder how could i implement cache for my images in future - to avoid downloading them again and again < code > const image = ( { imageid } ) = > { const getexistingfile = ( url ) = > { axios .get ( url , { responsetype : 'blob ' } ) .then ( response = > response.data ) // .catch ( error = > error ( error ) ) ; -- - it tells me it can not access it ! } ; const { data , error } = useswr ( imageid & & 'someurl\getimage ' , getexistingfile ) ; console.log ( `` data '' , data ) // here is undefined return ( < > < / > ) ; } ; export default image ;
we are using the useswrinfinite in our project . this is an example of our code . const { data : initialdata , error : networkerrormessage , isvalidating , size , setsize , } = useswrinfinite ( ( idx , previousdata ) = > { if ( ! isready ) return if ( previousdata ? .data ? .error ? .code === 1 ) return null else if ( ! payload ) return null returnapi address~~ ' } , { initialsize : 2 } ) in some cases , we get the initialdata : 1. but we already catch that error to make undefined . but its still make some problem . plz help us and is it bug in useswrinfinite ? < code > if ( number ( initialdata ) === 1 ) { return { data : undefined , error : undefined , } } return { data , error , count , size , isvalidating , setsize , } '
on the main page we read : with swr , components will get a stream of data updates constantly and automatically . and the ui will be always fast and reactive . this is cool in many cases , but for some use cases , it 's scary . a key example would be e-commerce : displaying a stale price or offer may constitute deceptive marketing . this was a real issue for swr at a company where i worked . is there a way to easily say `` do n't cache this property , request , or object ? '' for example , display stale products but hide their prices until revalidate is done . if this feature does exist then we should brag about it on the front page ! < code >
hi , i was wondering if anyone has any idea on how to integrate something like class-transformer ( or similiar solutions ) with swr ? if we 're talking about using swr on the client-side , this is pretty straightforward i 'd say ( a mapper incorporated in the fetcher ) ... but , if i were to use next.js with ( for example ) ssr ( getserversideprops ) and the data is populated in the following manner ( like in the docs ) : how would you recommend approaching this ? < code > export async function getserversideprops ( ) { const posts = await fetcher ( '/api/posts ' ) return { props : { posts } } } function posts ( props ) { // here the 'fetcher ' function will be executed on the client-side . const { data } = useswr ( '/api/posts ' , fetcher , { initialdata : props.posts } ) // ... }
hi ! it is actually possible to do something like that : the problem is i ca n't see any documentation about that , except in the beta swr version , which i do n't use and me i my team do n't want to use something that is n't documented as it would mean that it 's not the good way to do things . do i miss something here ? < code > import { cache } from `` swr '' cache.set ( key , value )
hi ! i was looking in the docs but i did n't find anything related to ti , or maybe i 've missed it . is there a way to set a minimum delay in which swr will update the cache after a request ? for example , if i make a request and i show a loader skeleton but the server answer is very quick , i could end up with a not-so-good ux , because things will appear and disappear very quickly . by setting a minimum delay , i 'll make sure that i 'll show the loader skeleton , at least , for a minimum amount of time . thanks ! < code >
since i would like to avoid using redux or other state manager , i am trying to implement the state sharing strategy ( using useswr ) published by @ pacocoursey ( ) is his article i am trying to implement it but i struggle in undertanding how i can catch the state from one component to the other since it takes the initialdata ( using usesharedstate ) for which i do not want to give a value . i just want to pull the state from one component to one other without giving an initial value . any idea about that ? here is the situation : component a : using getserversideprops to inject it in usesharedstate const [ user , setuser ] = usesharedstate ( `` connecteduser '' , props.user ) ; component b : here i am trying to `` pull '' user value but i do not know what to put as initialdata ( `` ? ? ? ? ? '' ) const [ user , setuser ] = usesharedstate ( `` connecteduser '' , ? ? ? ? ? ? ? ) ; < code >
in a page that uses ssr + infinite scroll , is it possible to retain the scrolling position + the first data retrieved when the browser backs up ? i only have information on examples that do not use ssr , so i would appreciate it if you could tell me how to do this . < code >
hi guys . i 'm having trouble understanding how to use the fetcher aspect of useswr in a dynamic next.js page as a new developer . my api calls are abstracted out in other functions , and that response data is then processed in additional functions ( for reasons such as formatting strings before calling as props to render and to call subsequent api 's based on the data ) before being returned to awaiting variables in the page 's getstaticprops that are part of a promise chain . should i be designing my code differently ? some of the api fetches require inputs that are cross-checked from another api , and based on the page slug , so i 'm unable to call them straight away . the useswr examples i 've seen all show fetching from an endpoint and immediately using the data in page render . what is the best practice in terms of processing response data ? should i be using a global state or somehow create my own endpoints to organize data after processing and call swr ? thanks ! < code >
hello everyone . i want to make the same request in two different components to avoid prop drilling . will it make 2 separate requests ? or just one and then the second will get the data from cache ? < code >
i need to be able to do a bunch of useswr calls from a list of ids ( size is unknown and can change ) . i ca n't put them in a for loop because it 's a hook , and i also want to know when all are finished , similar to promise.all ( ) . i 'm confused by useswr in this situation because it 's a hook and it does n't look like it returns a promise so how do i batch all these calls ? what 's the best way to do this ? < code > const ids = [ '123 ' , '456 ' , '789 ' , / * ... there could be many more * / ] ; useswr ( 'api/ { ids [ 0 ] } ' , fetcher ) useswr ( 'api/ { ids [ 1 ] } ' , fetcher ) useswr ( 'api/ { ids [ 2 ] } ' , fetcher ) // ...
what it 's the best way to refresh the entire list , if i need to trigger it from another component ? for example : @ shuding , is there a workaround that i 'm missing out ? < code > < addcomment / > // ^^^^^^^^^^ i need to refetch entire list after successfully adding < comments / > // ^^^^^^^^ i have 'mutate ( ) ' from * useswrinfinite * hook
i have this code : when it does auto-revalidate , the data statement never runs . on page load it never fetches the data needed , leaving an infinite load . what do i do ? ( i can provide more code as needed ) < code > const discordfetcher = ( url : string ) = > { fetch ( ' < url > } ' , { headers : { authorization : 'bearer < cur > { user.accesstoken } ' , } , } ) .then ( async ( r ) = > { const d : apiguild [ ] = await r.json ( ) ; return d ; } ) ; } ; const { data } = useswr < any , any > ( '/users/ @ me/guilds ' , discordfetcher ) ; if ( data ) { console.log ( data ) ; const temp = data.slice ( ) ; setserverdata ( temp.map ( ( server ) = > { // eslint-disable-next-line no-bitwise if ( ( server.permissions & 0x32 ) === 0x32 ) { return < servercard image= { server.icon === null ? 'assets/img/logo.svg ' : ' < url > } / < cur > { server.icon } .png ' } name= { server.name } id= { server.id } / > ; } } ) ) ; }
is there something similar to the usemutation hook from react-query or someway it can be replicated ? basically what i want is to have loading state while a post request is happening < code >
do we have an option to only refresh ( with refreshinterval ) while the windows is focused ? similar to `` refreshwhenhidden '' , but it would be something like `` refreshwhenfocused '' ... < code >
the conditional fetching docs state : use null or pass a function as key to conditionally fetch data . if the function throws or returns a falsy value , swr will not start the request . and the example goes : but looking at the code , a false value will do just as much as null ; this allows a slightly less verbose syntax : is null some future-proof value ? should we update the docs ? < code > // conditionally fetch const { data } = useswr ( shouldfetch & & '/api/data ' , fetcher ) // conditionally fetch const { data } = useswr ( shouldfetch ? '/api/data ' : null , fetcher )
i have written a reusable hook as follows : i am trying to mutate the data directly with data returned from a post request rather than simply forcing a revalidation since i already have the new data from the post request : but the setdata bounded mutate from my hook does n't appear to be updating/refreshing data on my page when i import this hook directly in to child components and call the bounded mutate when mutating the data correctly . however it works if i import the hook to the parent and pass setdata down as props to all the children . but this is not ideal as some of the children that use this are quite deep . < code > setdata ( ( prevdata ) = > { return prevdata.concat ( { ... response.data.result , } ) ; } , false ) ; import useswr , { cache } from `` swr '' ; const revalidationoptions = ( url ) = > ( { revalidateonfocus : false , revalidateonmount : ! cache.has ( url ) , revalidateonreconnect : false , refreshwhenoffline : false , refreshwhenhidden : false , refreshinterval : 0 , } ) ; function usedata ( id ) { const { data , error , mutate } = useswr ( [ `` /api/v1/data '' , id ] , fetcher , revalidationoptions ( [ `` /api/v1/data '' , id ] ) ) ; return { data : data , setdata : mutate , isloading : ! error & & ! data , iserror : error , } ; }
hello there , i currently have this kind of code : i would like to know how to revalidate my call using mutate but with some query parameters to filters my events ? however , when i wrote this code mutate do nothing because the cache key seems to not exists . i also tried to write this code , without success : mutate ( '/events ' , queryparams ) queryparams has values like : country [ ] =ca and when to invalidate url like : /event ? country [ ] =ca by example < code > const { data } = useswr ( '/events ' ) const [ queryparams , setqueryparams ] = usestate ( `` ) useeffect ( ( ) = > { const events = mutate ( '/events ? < cur > { queryparams } ' ) } , [ queryparams ] )
i have a functional component and an swr fetch wrapped in a hook as follows , this hook is used in a functional component which is initialized with useeffect ( .. , [ ] ) which is the standard react way of component mounting . i am noticing that swr fetches before this useeffect [ ] initialization , and does not fetch or re-fetch after it : so is useeffect ( [ ] ) insufficient for swr to re-validate ? when exactly does swr decide when to validate , given the above definition ? what should i do to make it aware of useeffect [ ] re-fetching ? < code > // declare hook at the very top const { teleworkinfoswr , teleworkinfoswrisloading , teleworkinfoswrerror , teleworkinfoswrmutate } = useteleworkinfoswr ( ) ; // component initialization useeffect ( ( ) = > { fetchuserinfo ( ) ; // after this init fetch i need swr to re-fetch } , [ ] ) ; const fetcher = url = > axios.get ( url ) .then ( res = > res.data ) ; export default function useteleworkinfoswr ( ) { const { data , error , mutate } = useswr ( '/teleworkinfo ' , fetcher ) ; return { teleworkinfoswr : data , teleworkinfoswrisloading : ! error & & ! data , teleworkinfoswrerror : error , teleworkinfoswrmutate : mutate } }
hey all , just want to give some feedback/idea about the new incoming custom cache provider feature . i was trying to build a custom cache to add some initial data for every page . that way , if for any reason an api request does n't work i can fill my components/pages with something , and also do n't need to be always worrying about null checks . but to do that i needed to build some fallback feature , so if i make a request using the key /api/example/1 i can fallback to /api/example/dummy . i think it would be awesome if we had something like that out-of-the-box . also , since you 're making cache more flexible , i think it would be a good idea if we had an unserializable function to get the key 's original value . let me know what you guys think ! < code >
i was asked a question regarding swrs `` loading '' state : how do you create a loading state from swr between different url fetches ? the docs make it appear straight forward : however , this logic fails after the first render of the hook/component . on the first render data is undefined . then response is completed , and data becomes a value to consume in the ui . let 's say i change the id via the ui and want to show loading indicator . because data is no longer undefined , the same logic fails . there is an additional item returned isvalidating . so i updated my logic : however , this could be true when : there 's a request or revalidation loading . so in theory something else causes my component to rerender . this could inadvertently cause a `` revalidation '' and trigger loading state gets shown . this could break the ui temporarily , by accident . so how do you derive `` loading '' between url changes without revalidation ? i am trying to replicate how graphql apollo client returns const { loading , error , data } = usequery ( get_dogs ) ; < code > const { data , error } = useswr ( '/api/user/ < cur > { id } ' , fetcher ) const isloading = ! error & & ! data ; const isloading = ( ! data & & ! error ) || isvalidating
hi there , i have an issue where i update a record - a field within a record . the update displays fine as long as im on the page . i navigate to another page on site by clicking a router link i return to the page with back or a backlink sometimes , the update has disappeared - maybe 50 % of the time also , revalidateonmount doesnt seem to work reliably - i had to add a useeffect hook to force it to run on mount when i subscribe to cache changes , i can see that at some point after navigating back , the update simply disappears . i have done the following to troubleshoot monitor cache changes and print record for each one lots of logging to make sure any possible mutate or revalidate locations arent at issue when the field is reverted , there are no db fetches happening , no evidence at all of some external event causing this any idea if this is a known issue ? am i doing something obviously wrong ? thanks ! < code >
currently i 'm experiencing some unexpected behavior . i 'm using useswr with a custom fetcher . it returns isvalidating as true , and then returns isvalidating : false before the data is populated . is there any insight into why that might be ? i know it 's hard without code examples , i 'll work to get a reproducible example . in short , would it be safe to assume that data should exist in the same life-cycle as isvalidating becoming false ? i would expect the following order : the call has n't been made due to a tertiary . that value changes , swr sets isvalidating to true , makes the call the call resolves : swr returns data and isvalidating is set to false instead , number 3 is two steps.isvalidating is false , and then step 4 is the data being populated . < code >
my api returns http 204 on a bunch of occasions . this type of request does n't have a body . for example , if i do a get request of entities and there are no entities , it returns 204. what should i do in this case ? here 's what i tried : the problem is that returning null does n't work as nextjs seems to be hanging forever . so i have to return a valid json , even if empty . if i do this , the problem is that i 'm tying this to all requests that use this fetcher and they might not expect the same object . what should i do ? < code > export const fetcher = async ( input ) = > { const res = await fetch ( input ) const data = res.status === 204 ? null : await res.json ( ) return data }
hey everyone ! i 'm currently implementing useswr and am running into an issue where during the first load , the page stays blank rather than showing anything . here 's my code for reference : this only occurs during the first load and only on production ( locally it always works ) . my project is deployed on vercel using nextjs . has anyone experienced this before and knows a solution ? thanks ! < code > const campaign = ( props ) = > { const { data , mutate } = useswr ( '/api/campaign-dashboard/ < cur > { campaignid } ' , fetcher ) ; const [ isrefreshing , setisrefreshing ] = usestate ( false ) ; const handlerefresh = async ( ) = > { mutate ( ) ; setisrefreshing ( true ) ; await timeout ( 300 ) ; setisrefreshing ( false ) ; } ; return ( < > { ! data ? ( < campaigndashboardskeleton / > ) : ( < campaigndashboard refreshstatus= { isrefreshing } campaigndata= { data } handlerefresh= { handlerefresh } / > ) } < / > ) ; } ;
hi all , i want data to stick to its old value when re-fetching , instead of going back to be undefined . i could not find a param to get this behavior . did i miss something obvious or is it just not an available feature ? here 's what i 'd like : first fetch happening , data === undefined first fetch completed , data === [ 1 , 2 , 3 ] second fetch happening , data === [ 1 , 2 , 3 ] ( instead of undefined ) second fetch completed , data === [ 4 , 5 , 6 ] thanks all ! < code >
loving this library so far ! i wanted to ask about an issue i ran into . in pages/home.js , i call const { data } = useswr ( `` /api/endpoints/endpoint1 '' ) and it fetches data correctly . but when i try to run the same code in pages/folder/folder1.js , it always returns undefined . i tried making another useswr call to another endpoint ( /api/myendpoint ) and that works in pages/folder/folder1.js , so i 'm wondering if it 's an issue with my api endpoint . my fetcher is defined in context with so i do n't think that 's an issue . i 'm pretty confused , so any comments are appreciated , thanks ! edit : i added some logging in /api/endpoints/endpoint1 and it seems like useswr is n't even hitting the endpoint . i 'm even more confused at this point < code >
i am filling up the cache of a useproductdetail hook after a search hook performed using cache.set ( productkey ( id ) , product ) but when the useproductdetail hook is used , it still revalidates and hits the server again although the cache was just updated . sure i can set revalidateonmount to false but that brings other undesired side effects . even after one year i am still unclear on the inner workings of swr in such situations . < code >
i have a batched api , all the useswr calls on the same tick are sent to the server in one request . when the request completes , it looks like useswr calls setstate multiple times without unstable_batchedupdates , so it causes multiple rerenders . would it be possible to only rerender once when multiple fetchers complete at the same time ? < code >
its more a question of js variable scoping & binding than swr but still related . the server has an endpoint that returns all the unread messages ( for all channels ) . so every minute or so the enpoint is polled and if new messages have arrived the hook should return the newly arrived unread messages . i could setup 2 hooks , one fetching all the pending unread messages and a dependent hook that takes those messages and compares it to the previous ones . but i wonder if i could handle it in one hook instead ( since the messages themselves are not that important , only that there are new messages ) . the client is supposed to show a toast when new messages arrive . in the snipped below , is it safe to access data < code > function usenewunreadmessages ( ) { const { data = [ ] } = useswr ( ... , ( ) = > { fetch ( `` unreadmessages '' ) .then ( results = > { results.filter ( result = > ! data.find ( olddate = > olddate.id === result.id ) ) } ) } , { refreshinterval : 6000 , } ) return { newunreadmessages : data } }
hi all , i have such a use case - list of records is rendered , then several of records may be updated multiply times during short period . imagine user drags and drops group of objects several times . so each record has x , y coordinates fields . what i am doing currently - i update data using my api and post requests and then mutate swr cache with revalidate false . only when user deselects this group of objects i am invalidating swr cache , so only one real fetch happens at the end . it 's good for performance but for some reasons out of scope of this discussion i want to not wait for deselection to trigger swr cache revalidation , but to have some debounced revalidation call after each drop . so if user constantly dragging and dropping blocks no fetching will happen until user will calm down and wait at least for two secs . i see by default swr has an option for deduplication 2secs , does it mean swr already will behave as i need ? main questions are : if i mutate cache without revalidation - will it be a reason for swr to ignore deduplication option or not ? how exactly deduplication works ? if we compare it with lodash debounce - does it make only first fetch in sequence of rapid requests , only last one , or both , or maybe it makes some additional fetching in the middle ? if i do 10 revalidate calls each 1 second - what exactly will happen ? < code >
i 'm using next.js with my /pages/api/graphql running apollo-server-micro . on the client , i 've been using swr . i 'm just needing to get notified when a new comment is added by another user . so i thought i 'd add a graphql subscription . the problem is , i 'm not sure how to get the apolloserver to handle these requests . i 've seen numerous documentation that the client side should be doing something like this : but i have n't been able to make a connection to the server because i guess i need to setup a websocket somehow or maybe there 's an alternative ? < code > const apolloserver = new apolloserver ( { typedefs , resolvers , subscriptions : { onconnect : ( ) = > console.log ( 'connected ' ) , ondisconnect : ( ) = > console.log ( 'disconnected ' ) , } , } ) ; const client = new subscriptionclient ( 'ws : //localhost:3000/api/graphql ' , { reconnect : true , connectionparams : { headers , } , } ) ;
hello ! does swr have a best practice for generating typescript def files ? i want to type my queries using generated types something like : const { data } = useswr < generated_type_resp , generated_type_vars > ( ... ) with google , i found the graphql code gen swr plugin . however , i wanted to ask someone with swr experience their thoughts for generating types ? thank you ! -matt ( working on my first project with swr , in the past i 've worked on projects with apollo & relay ) < code >
yes i know , ie11 is dead and unsupported basically everywhere , unfortunately i 'm required to support it for a project i 'm working on ... anyways , for some reason this library is n't working in ie11 and i ca n't figure out why . i 'd assume i probably need a polyfill , but i 'm not sure which one i would need . currently i 'm using es6-promise , core-js , isomorphic-fetch , proxy-polyfill , and element-closest . is there a specific one i need to add to get swr working in my project ? thanks ! < code >
i encounter some issues with the options onsuccess and open this issue # 1125 . it turns out that i have misunderstood the mechanism behind swr deduplication . i wrote a blog to explain it and hope it can help someone who is also not familiar with the library . tl ; dr when the hook is mounted , it will first check if there is data of the same key in the cache . if there is , set it to the return value data . then check if there is any hook with the same key mounted before during the depupinginterval . if not , trigger the request . after the request success , only the onsuccess callback in the same hook will be fired . < code >
my use case is that i have a dropdown menu that fetches items from an api . it 's a dependent fetching const { data : projects } = useswr ( ( ) = > '/api/projects ? id= ' + projectid ) i 'm experiencing these issues : - i do n't want to refetch something that is already in the cache ( if the user fetches projectid 1 , then 2 , and then back to 1 ) - but because the key changes , for each fetch it creates a new entry in the cache . - right now the fetch at the useswr is not conditional ; every time is fetching something regardless of being cache or not . how can i implement it ? - how can i say useswr to fetch something depending on whether it is already in cache or not ? ( conditional fetched based on cache ) - can it be done with only one cache ? i 've seen these two posts from @ sergiodxa and i 've got some ideas but i 'm not sure how to implement it : # 525 ( comment ) # 360 thanks ! < code >
i 'm experimenting with using swr to replace redux . consider this storefetcher.js component1.js component2.js this works , but when i open a new tab , the count does not synchronize . does swr not use the cache value when opening new tabs or page refresh ? in the console on both tabs , i see the fetcher executing after clicking on each tab . do i have to switch to make fetch api to get auto revalidation to work ? < code > import { mutate } from 'swr ' const store = { count : 0 } export const increment = ( ) = > { store.count++ mutate ( 'count ' ) } export const storefetcher = ( key ) = > { return promise.resolve ( store [ key ] ) } const component = ( ) = > { return < button onclick= { increment } > increment < /button > } const component = ( ) = > { const { data , error } = useswr ( 'count ' , storefetcher ) return ( < div > { data } < /div > ) }
hey , when using useswrinfinite , the setsize function preserves data , which is great as it avoids the page to jump until the new data is returned . in our case , the query also expects a search term that may be different between calls . but when the query parameter changes , the data gets wiped ( becomes undefined until data is validated ) so the page jumps ( data is cleaned ) until data is back and then shown . is there a way to use useswrinfinite in a way that not only the page size change while still preserves the same behavior ? thanks , asaf . < code >
hello , i have a problem that some configuration of useswr together with suspense lead to infinite rerenders but some do not . i use : i wrap my components in : it is used like : mywidget looks like : it will never render data but keep showing the fallback . in the background , the http request is repeated forever . with suspense false , everything works perfectly . with suspense true , it starts randomly going into infinite render loops , maybe a race condition ? it does n't happen for all widgets , for most it never happens . it also never happens on first render . it happens in dev mode and production . < code > export const mywidget : react.fc < { query : string } > = ( { query } ) = > { const { data } = useswr ( [ '/api/data ? query= < cur > { query } ' , query ] , fetcher ) return < > { data } < / > } react @ 17.0.2 next @ 10.1.3 swr @ 0.5.5 < widgetdata fallback= { < > loading ... < / > } > < mywidget query= { query } / > < /widgetdata > export const widgetdata : react.fc < widgetdataprops > = ( { fallback , children } ) = > { if ( isserver ) return < > { fallback } < / > return ( < widgeterrorboundary > < suspense fallback= { fallback } > { children } < /suspense > < /widgeterrorboundary > ) }
this could be a react hook related question , but i ca n't figure out the problem . it does not return the productdata on first search , however it does work on second request . useswr asyncronusly updates productdata , but why does n't it apply to components that i 've used this hook ? < code > const usesearch = function ( { query , index } ) { const [ shouldfetchproduct , setshouldfetchproduct ] = usestate ( true ) ; const [ shouldfetchbrand , setshouldfetchbrand ] = usestate ( false ) ; const [ shouldfetchusers , setshouldfetchusers ] = usestate ( false ) ; const { data : { data : productdata } = { } , error : producterror } = useswr ( shouldfetchproduct ? '/genel/urunarama ? ad= < cur > { query } ' : null ) ; const { data : { data : branddata } = { } , error : branderror } = useswr ( shouldfetchbrand ? '/genel/markaara ? ad= < cur > { query } ' : null ) ; const { data : { data : userdata } = { } , error : membererror } = useswr ( shouldfetchusers ? '/genel/kullaniciara ? ad= < cur > { query } ' : null ) ; const { searchtabindex , setsearchtabindex } = usesearchstore ( searchstoreselector , shallow ) ; return { productdata , userdata , branddata } ; }
swr @ 0.5.5 was published 12 hours ago at the time of this post . however , the tag and its commits ca n't be found on the github repo which makes me somewhat wary to install it . what 's going on there ? < code >
bug report description / observed behavior data is not fetched when disabling all validation options which is expected . however , data is fetched again when suspense is enabled expected behavior validation option and suspense should not be related repro steps / code example < code > import { suspense } from 'react ' import useswr from 'swr ' export default function test ( ) { return ( < div > < suspense fallback= '' loading ... '' > < child1 > < /child1 > < /suspense > < suspense fallback= '' loading ... '' > < child2 > < /child2 > < /suspense > < /div > ) } function child1 ( ) { const { data } = useswr ( 'hello ' , fetcher , { revalidateonfocus : false , revalidateonmount : false , revalidateonreconnect : false , refreshwhenoffline : false , refreshwhenhidden : false , refreshinterval : 0 , } ) return < div > child1 : { data + `` } < /div > } function child2 ( ) { const { data } = useswr ( 'world ' , fetcher , { revalidateonfocus : false , revalidateonmount : false , revalidateonreconnect : false , refreshwhenoffline : false , refreshwhenhidden : false , refreshinterval : 0 , suspense : true , } ) return < div > child2 : { data + `` } < /div > } let i = 0 function fetcher ( key ) { console.log ( key , 'invoke fetcher ' ) return new promise ( ( resolve ) = > { settimeout ( ( ) = > { resolve ( ++i ) } , 3000 ) } ) } `` ' # # additional context swr version . 0.4.1
hi we have an app which displays some kind of items in several places in the app at one time - e.g . itema can be displayed in two sections of navigation and its details in the grid view in the main content of the app . each of these lists may be a bit different , thus we use different params for requests , and different cache keys to store items list . that works , but here is the problem - we can update itema title in one of these lists , and how can we reflect that change it in all other places ? we do not know each key where the item appears ( e.g . because some lists are paginated , so we do not know cursor ) , so we can not simply mutate , unless we iterate over all cache keys < code >
hi , i need to update one of the object in array based on current data here is my current working code : i have tried spread clone array and using map ( ) , filter ( ) , reduce ( ) to update the state but with no success because of spread 's shallow clone . are there any better way than using slice ( ) and concat ( ) and not using any 3rd party lib at all ? < code > mutatedevice ( currentdata = > { const newdata = currentdata .slice ( 0 , index ) .concat ( { ... currentdata [ index ] , state : checked } ) .concat ( currentdata.slice ( index+1 , currentdata.length ) ) return newdata } , false )
i 'm not sure if this is a bug , but here is what is happening . i have a list of items in a table that each has an action button for updating . during an update action , i do an api update request and call mutate for updating the cache . here is the ui : this always works fine but it does n't when the list is revalidating . for example : after the page regains focus and immediately one action button is clicked , the api request updates the data successfully . ( check ) mutate function returns the updated cache . ( check ) but the ui does n't re-render to show the new changes . ( fail ) after the page regains focus but instead of immediately , you wait for re-validating to finish ( isvalidating resolve to false ) and then do the action , then successfully the ui re-renders and shows the new changes . still not sure if this is how swr is supposed to work but my current solution is to disable the action buttons while revalidating is true . but this could be bad experience for some one with slow connection . my question is : why is it behaving like this ? < code >
in the local state sharing example in the repo , it shows that you can share data between components , but then assigns the initialdata again from a static array . i do n't understand how that helps . i was expecting that if i load the data in my root component , that i should be able to retrieve it again from a child component . does that make sense ? i made an example in codesandbox here ( i also posted to so , but there are very few followers of swr there ) < url > < code > import useswr from `` swr '' ; export default function indexpage ( { speakersdata } ) { const { data } = useswr ( `` globalstate '' , { initialdata : speakersdata } ) ; return ( < div > this is the index page < br / > data : { json.stringify ( data ) } < br / > < othercomponent > < /othercomponent > < /div > ) ; } function othercomponent ( ) { const { data } = useswr ( `` globalstate '' ) ; return ( < div > i 'm thinking this should get my global cache but it does not { `` `` } { json.stringify ( data ) } < /div > ) ; } export async function getserversideprops ( ) { const speakersdata = [ { id : 101 } , { id : 102 } ] ; return { props : { speakersdata : speakersdata } } ; }
is this the standard behaviour that all swr hooks refetch the data on mount even if the key has n't changed ? what is the reasoning for that ? i have hook that downloads large files and i have the files checksum as one of the cache key and even when the checksum stays the same between mounts/rerenders , the fetch method of the swr hook is still called . when i set `` revalidateonmount '' to false then the fetch function is never called . where is my misunderstanding ? < code >
i 'd like to make my swr state mutations resilient against network errors and support some kind of retry functionality . basically what i do is inside my useswr powered hook : first my question is if the chain of mutates is correct like this , especially in the error case . then i generate a new error object with a retry function that can be used by the ui code to show a toast to retry the operation at later time ( upon user interaction ) . i wonder if the dependencies to setfavourite are still valid at the time retry ( ) would be called . i guess not , as they depend on data and if this changes , then the setfavourite is also regenerated . anybody implemented such kind of retry before ? < code > const setfavourite = usecallback ( async ( objectid ) = > { const url = '/favs/ < cur > { objectid } ' const newdata = [ objectid , ... data ] return mutate ( newdata , false ) .then ( ( ) = > request ( `` post '' , url ) ) .then ( ( ) = > mutate ( ) ) .catch ( ( error ) = > { mutate ( data , false ) .catch ( ( ) = > { } ) const usererror = new error ( `` could not add favourite '' ) usererror.retry = ( ) = > setfavourite ( objectid ) } ) } , [ data , mutate , request ] )
hello , i need to get the next 100 data that are n't the ones i have . i ca n't request per page or offset because i have random results from different databases . it would be ideal if getkey callback was called with pageindex and data ( all pages ) , since given the pageindex you can access the previouspagedata . instead of that i 've tried creating a closure so getkey has access to data , or in my fetcher function i tried keeping the data in usestate or useref , updating them in onsuccess callback or in a useeffect and i 've either ended up having infinite loops , sending double requests or data not being updated the right moment . so i 'm asking and i 'd appreciate it if there 's anyone that has implemented something similar and can help . < code > function fetchdata ( data ) { return ( url ) { // map the data ids i want to ignore also a limit ( e.g . { limit : 100 , skip : [ 1 , 2 , 3 ] } ) } } function getkey ( data ) { return ( pageindex , previouspagedata ) { // } } function getkey ( pageindex , data ) { // const previouspagedata = pageindex ? data [ pageindex - 1 ] : null ; }
hi , suppose there 's a user a and b. i have a database which contains a list of posts . all these posts are displayed on the homepage of my website . suppose , user b makes a post request to my database and creates a new post . eg : so now i want the data ( which is displayed on the homepage ) to be updated for user b as well as user a using swr . now the thing is , i do n't want to revalidate the data on focus or interval . if user a is looking at the browser window , the data for them should update right away in front of his eyes and should not require him to switch tabs or anything . how can i implement this ? i 'm searching this for hours and have n't found any answer . this is basically optimistic ui but for each and every user ? i have looked up on many examples but according to me , its only updating the data for the user who is actually making the post request and not for other users . < code > await axios.post ( `` /api/post '' , data )
hi ! i 'm working on an application where it would be useful to have separate arguments for the fetcher and the swr cache . here 's the idea : currently otherarg1 and otherarg2 are being replaced by url and accesstoken , as expected . is there any way to accomplish my idea ? < code > const { data } = useswr ( [ url , accesstoken ] , // i want this to be my cache key ( otherarg1 , otherarg2 ) = > fetcher ( otherarg1 , otherarg2 ) // i want these args to be sent to fetcher )
it looks like useswrinfinite does a for-loop for each page that needs re-fetching , and awaits inside of each step . i often have to set revalidateall , and i 'm noticing an odd flickering happening when some pages load and then the next . i 'd prefer they all load in together . could there be an option to promise.all ( ) the revalidation calls ? < code >
i use cookies and sessions for user authentication . when the cookie expires and user makes a request for some data it returns error because user is no longer logged in . what is the practice for handling this scenario with the pattern of useuser hook combined with useswr ? where should i handle this error and where should i use mutate ( ) to update the user info and where should i do a navigate to the home page when it happens ? i know this is not fully swr related question but i really have no idea how to deal with it . i would really appreciate some tips for using useuser hook and useswr . < code > const useuser = ( ) = > { const { data : user , mutate , error } = useswr ( `` /api/auth '' ) ; const loading = ! user & & ! error ? true : false ; return { loading , user , mutate , } ; } ;
i wonder what the best pattern for stable `` empty '' results is , especially in regards to minimised re-renderings variant # 1 ( anti-pattern ? ) using a dynamic empty object as result variant # 2 using a stable empty object variant # 3 using a default assignment variant clearly creates a new result on every hook rerender , which i would consider bad . which patterns do you recommend ? < code > function myhook ( ) { const { data } = useswr ( .. ) return { items : data || [ ] // non-stable } } const empty = [ ] function myhook ( ) { const { data } = useswr ( .. ) return { items : data || empty // stable } } function myhook ( ) { const { data = [ ] } = useswr ( .. ) return { items : data // stable ? } }
in this example with wrapper hooks , why does n't the upper text update when the bottom button is pressed ? < url > sorry for the contrived example , working in a big codebase . thanks in advance for any help ! < code >
i just what to handle the error when first to fetch data . if the fetching data is triggered by the refreshinterval . i do n't want to do anything . how can i config the useswr ? < code >
hi everyone , i work on a dashboard to show a stock chart ( using highcharts ) . when the dashboard is opened , a default stock curve is shown . next to it , a side panel contains several checkboxes allowing the visitor to superpose other stock curve on the already visible one . each chart curve contains unique data and has to be fetched from external api . problem is that many different graphs will be available and i assume they should not be loaded at the same time via a single api call and unique fetch . i believe that `` hard writing '' multiple fetcher for each chart is not the ideal solution . ( maybe it is ? ) could you guide me towards the right approach ? thank you so much . < code >
i am curious if you have ever considered doing something with swr similar to how rtk query creates api services : < url > i am trying to imagine how to do something where there is a workflow for swagger/oas spec all the way to the swr hook . openapi generator - > < url > something like : < code > // users.tsx import { useusers } from 'usevercelapi ' function app ( ) { const { data , error } = useusers ( ) return < div > total users : { users ? .length } < /div > } // usevercelapi.ts import client from 'vercel-api-client ' ; // some autogen client library , like axios-typescript from openapi-generator export default useswrclient ( { client } ) ; // hand-waving magic swr code
hi , we 're developing a web app using the vercel stack , next and swr . we have 8 paginated lists on our dashboard , each making their own api calls using swrinfinite . since executing 8 api calls is much less than ideal , we created a new endpoint in the back-end that serves the data for all of these lists . our current solution is as follows : dashboard 's swr hook fetches all lists ( first page of each list ) , propagates the data to these list components as the initialdata option of useswrinfinite . so page 0 of all lists are fetched from a single endpoint , but if user goes to the 2nd page on any list , its own swr hook takes care of that , so we 're not fetching the data for 8 lists when we need the 2nd page for only one of them . the problem we 're facing here is the timed interval causing all swr hooks to fire api calls . we end up with 9 now instead of 8. ideally , we 'd like to use dashboard 's swr hook for all lists that are at page 0 , and only utilize the individual swr hook of a list in case user goes to the next page on one of them . i hope i was able to describe the issue well enough . what would you recommend ? < code >
so , i have a component that runs useswrinfinite to fetch some data , once this data is fetched , it updates the element . this fetch occurs on component mount . the problem is that in tests , it causes the act problem : ' warning : an update to servers inside a test was not wrapped in act ( ... ) . i tried encapsulating the component creation inside the act , but it does n't work . do you guys know what should i do ? < code > const servers = ( { title , session , initialdata } ) = > { const router = userouter ( ) ; const team = session ? .team ; const projectid = router.query.project_id ; const { data , error , mutate , size , setsize , isvalidating } = useswrinfinite ( index = > '/api/url ' ) ; //tried with initialdata but the problem still occurs return < component that updates when data is fetched/ > } when testing , code that causes react state updates should be wrapped into act ( ... ) : act ( ( ) = > { / * fire events that update state * / } ) ; ' it.only ( 'should show the blanksate component ' , async ( ) = > { wrapper = mount ( < routercontext.provider value= { router } > < servers title= '' servers '' / > < /routercontext.provider > ) ; expect ( wrapper.find ( blankstate ) ) .tohavelength ( 1 ) ; //it breaks here with the act message } ) ;
hi , i 've just deployed on vercel the example code using mongodb with mongoose : < url > on the index page , i have substituted the getserversideprops call for a useswr hook . with that one api call only , i was able to reached a number of 35 opened connections on my mongodb atlas cluster ... ( it was 4 with the use of getserversideprops ) . is there any way i can reduce that number ? i guess setting flags like revalidateonfocus to false would reduce the number of calls but that 's not what i consider a good solution . i have read many threads about the subject , but none of them deal with the use of swr . thanks < code >
given an error like this being sent from an express api : res.status ( 500 ) .send ( { message : 'message ' } ) even while throwing in the fetcher , the response body ( { message : 'message ' } ) is still being set as data : const { data } = useswr ( endpoint ) // data should be undefined or a cached value , not the error response body am i missing something ? do i have to just not send a response body at all ? < code >
hi there , i was working on something which requires me to show only up-to-date data of a particular endpoint . i tried using isvalidating but i then realized it returns true if there 's any request currently being re-validated . would n't it be more intuitive for isvalidating to return true if the single request being made is loading ? if not , what was the reasoning behind how it currently works is there a different way in which i can solve my problem ? thanks < code > const { data , error , isvalidating } = useswr ( `` unique-key '' , fetcher , options )
as mentioned # 954 , the timing of revalidating is invoked is unpredictable especially when suspense is present . here is my proposed way of making sure the fetcher is called only once of the application lifecycle i know that the point of swr is revalidation , but there are also other nice features out of the box without revalidation , so the correctness of such practice makes a lot of sense in some projects not sure such practice is a production-ready once i suppose memorized fetcher is also a valid option any thoughts are welcomed . < code > import { useeffect , usestate } from 'react ' import useswr , { cache } from 'swr ' export default function test ( ) { const [ mount , setmount ] = usestate ( false ) return ( < div > { mount ? < child / > : 'unnounted ' } < button onclick= { ( ) = > setmount ( ( x ) = > ! x ) } > switch mount < /button > < /div > ) } function child ( ) { const { data , revalidate } = useswr ( 'key ' , fetcher , { revalidateonfocus : false , revalidateonmount : false , revalidateonreconnect : false , refreshwhenoffline : false , refreshwhenhidden : false , refreshinterval : 0 , } ) useeffect ( ( ) = > { if ( ! cache.get ( 'key ' ) ) { revalidate ( ) } } , [ revalidate ] ) return < div > { data } < /div > } function fetcher ( ) { console.log ( 'fetcher is call ' ) return promise.resolve ( 'hello ' ) }
when not using swr i would updated my set state like this once i had deleted an item for example setdata ( data.filter ( ( d ) = > d._id ! == id ) ) ; but i am not really sure how to do this now . i am not using swr for any mutations but using axios directly like this : i then have tried to use the mutate function to reload the users but this does n't actually do anything and i do n't see any errors . clearly i am not using it the intended way . any assistance would be appreciated . < code > const handledelete = async ( id ) = > { try { const response = await axios.delete ( ' < cur > { process.env.react_app_backend_url } /v1/user/ < cur > { id } ' , { headers : { authorization : `` bearer `` + auth.token , } , } ) ; console.log ( response ) ; mutate ( ' < cur > { process.env.react_app_backend_url } /v1/users ' ) ; } catch ( err ) { console.log ( err ) ; } } ;
hi , what is the best practice to mutate useswrinfinite when in cache is many pages ? for example for 30 pages mutating will take a long time to update all of them . maybe is it possible to keep only first page and rest pages ( keys ) remove from cache and then mutate only first page ? similarly question is here # 579 ( comment ) < code >
hello , guys . i am very pleased with the simplicity of using swr and how you do great work in managing the cache . recently , i used swr to manage persistent state by defining a custom fetcher that fetches data from local storage . and things are very simple and are working great for me . i have been thinking though : your caching model and simple , intuitive interface are very easy and make the project and the code very simple , so why not publish a version of swr to be used to manage and publish local state ( to be shared across different screens easily without persistent ) . it would be a great way to manage a simple local state in the place of some more complex state management libraries like redux , pull state and so when all you need is simply sharing some state . < code >
i find that when mutation throws an error , it wo n't throw to global onerror callback . but i do n't want to write another function to globally handle mutation error , any suggestion ? < code > mutate ( 'api ' , ( ) = > { throw error ( 'api failed ' ) } ) < swrconfig value= { { onerror : ( err ) = > { alert ( 'error ' + err.message ) ; } } } / >
according to the type definition and implementation , the fetcher function seems to support a non-promise function . what is the use-case for the synchronous fetcher ? i 've seen synchronous fetchers in tests ; is it only for testing ? if there is no use-case , could i drop the synchronous fetcher from the type definition ? type definition swr/src/types.ts line 1 in a9c10f7 export type fetcherfn < data > = ( ( ... args : any ) = > data | promise < data > ) | null a test swr/test/use-swr-suspense.test.tsx lines 81 to 95 in a9c10f7 it ( 'should work for non-promises ' , async ( ) = > { function section ( ) { const { data } = useswr ( 'suspense-4 ' , ( ) = > 'hello ' , { suspense : true } ) return < div > { data } < /div > } render ( < suspense fallback= { < div > fallback < /div > } > < section / > < /suspense > ) await screen.findbytext ( 'hello ' ) } ) implementation checking if the value is a promise swr/src/use-swr.ts lines 779 to 785 in a9c10f7 if ( concurrent_promises [ key ] & & typeof concurrent_promises [ key ] .then === 'function ' ) { // if it is a promise throw concurrent_promises [ key ] } < code >
useswr catching errors is not working when adding to the options suspense true the code will never enter the if the statement of the error and the website will carshes and if we remove the suspense true everything will work fine < code > const fetcher = url = > axios.get ( url , authheader ( ) ) .then ( res = > res.data ) ; const url = ' < cur > { apiurl } /info/5 ' ; const { data , error , isvalidating } = useswr ( url , fetcher , , { suspense : true } ) ; if ( error ) { console.log ( 'error ' ) ; }
i started reading the documentation of swr and i discovered that exists an optional param to useswr called fetcher ( a function to fetch data ) . if i just pass the key to useswr and do n't pass a fetcher , what function or code will be executed to fetch the data ? < code > const { data , error } = useswr ( ' < url > )
i want to keep data fetching/caching decoupled from react/components , and only interface it via react usereducer/context . for that i need to be able to use swr outside of react . does swr have a pure js api ? best regards , jared < code >
hello , first thanks a lot for making this library . it 's amazing . i have a doubt . we have a big project divided in small inter-dependent modules . my question is : in this scenario it 's better to put swr as a peer dependency or it 's totally fine to have it as dependency of the different packages ? thanks in advance < code >
i am migrating an redux project to use swr with struggling about where to do all the data manipulations ( filter , normalise , select etc . ) after fetching data from server . i can do it in custom hook or in component , however i find that both way is not elegant and efficient compared to what selector does in redux . will anyone can give me some suggestions about this ? < code >
hey , i would like my app to make a request to an endpoint on the initial page load , then every 10 seconds . i presumed setting refreshinterval : 10000 , would be perfect for this however i have an issue where : first request can take > 10s to be made before data is available when removing refreshinterval prop , it also takes a long time > 10s when settings refreshinterval to something small 1000 the data loads very fast . can someone explain if i am doing something wrong here ? example : later i pass to a component like so : i have also tried using a preload , in this scenario i can see the request in the network tab in browser instantly , however , data does not appear to have updated with this information until > 10s also : i would very much appreciate any suggestions on how to proceed tia < code > const { data , err } = useswr ( '/api/data ' , fetcher , { refreshinterval : 1000 , initialdata : { distance : 0 , members : 0 , activities : 0 , } , } ) ; < link rel= '' preload '' href= '' /api/data '' as= '' fetch '' crossorigin= '' anonymous '' / > < stat value= { data ? data.distance : 0 } / >
i want to add a durable local cache , and not send a request at all if the cached value is fresh . i thought of a few ways to approach it . one way that fits in pretty well would be to write a fetcher like , i guess this probably wo n't work . what would be a better way to set this up ? edit : perhaps instead of swr , in this case , @ n1ru4l/use-async-effect still , though , interested in a simpler way to re-think it . < code > async function * fetcher ( ) { const cacheddata = await idbkv.get ( key ) if ( cacheddata ) { if ( isfresh ( cacheddata.t ) ) return cacheddata.data else yield cacheddata.data } const freshdata = await axios.get ( url ) idbkv.set ( key , { t : now ( ) , data : freshdata } ) return freshdata }
in case of slow connection if user navigates off ( unload ) the page during the revalidation , browser aborts the fetch with an error and useswr hook returns an error while page is still visible ( after `` beforeunload '' , but before `` unload '' event ) . in such a case the user may see an error message or error alert for a while when clicks on a link moving to another page ( outside the spa ) causing frustration . the fix is to always returning stale data after `` beforeunload '' event is triggered instead of error . it could be implemented in the application logic itself , but is n't it the best to be handled by swr ? here is an example code of the in app logic fix to depict better the problem : < code > export default function test ( ) { const [ unloading , setunloading ] = usestate ( false ) ; const { data , error } = useswr ( `` /test '' ) ; useeffect ( ( ) = > { window.addeventlistener ( `` beforeunload '' , ( ) = > setunloading ( true ) ) ; } , [ ] ) ; if ( ! unloading & & error ) { console.error ( `` error ! ! ! `` ) ; return < h1 > error ! ! ! < /h1 > ; } else if ( ! data ) { return < h1 > loading ... < /h1 > ; } else { return < h1 > { data.message } < /h1 > ; } }
i 'm using nextjs and want to create 'load more ' pagination with useswrinfinite . but it is strange behavior for me when i provide initialdata and than getkey calls with page : 0 and prevpagedata : null i expect if i pass initial data in count of 1 item it will pass page as 1 and my initial data as prevpagedata because i already have first loaded page . for example : < code > type const getkey = ( page : number , previouspagedata : { items : homeitem [ ] ; next : null | number } ) = > { if ( ! previouspagedata ) return '/api/homes ? page=1 ' if ( previouspagedata.next === null ) return null return '/api/homes ? page= < cur > { previouspagedata.next } ' } const mycomponent : nextpage < { items : homeitem [ ] ; next : null | number } > = ( { items , next } ) = > { const { data , size , setsize } = useswrinfinite < { items : homeitem [ ] ; next : null | number } > ( getkey , fetcher , { initialdata : [ { items , next } ] , } ) ... }
i call an api endpoint like this : as far as i understood swr , it would cache the response and re-use it for any additional calls to the same endpoint as long as i do n't call mutate ( ) or the user minimizes the browser . however , i render this component multiple times and i still see multiple calls going to the api . am i misunderstanding this or am i missing someting ? < code > const { data , error } = useswr ( ' < cur > { api_endpoint } /invitations/ < cur > { employee.id } /is-worker-known-in-pms ' ) ;
i 'm maintaining a next js application that relies on apollo to fetch data , infinite scroll and do updates in realtime ( chat like updates ) . swr seems to work better with next js with no boilerplate code . i 'm considering migrating to swr but have no idea how to replicate some react-apollo features like components subscribing to updates via graphql . are there any examples of swr working with graphql subscriptions as in react-apollo < url > < code >
i wanted to use swr instead of redux but i see one issue there . as it is written in the docs `` swr is a strategy to first return the data from cache ( stale ) , then send the fetch request ( revalidate ) , and finally come with the up-to-date data. '' . so swr firstly takes cached data and even though it took cached data it gon na make request to the api to get the newest data , right ? then it makes no sense to use it instead of redux because it always makes additional request ? < code >
i 've looked through the documentation and i can not find how to handle exceptions thrown in my fetcher function . this is what i came up with . should n't useswr handle those ? < code > const [ fetcherror , setfetcherror ] = usestate ( ) ; const fetcher = ( url , params ) = > { return axios.post ( url , { headers : { authorization : 'bearer < cur > { params.accesstoken } ' } , } ) .then ( ( res ) = > res ) .catch ( e = > { setfetcherror ( e ) } ) ; } ; const { data , error } = useswr ( [ path , json.stringify ( { search } ) ] , fetcher ) ; return { data : data , loading : ! fetcherror & & ! error & & ! data , error : fetcherror || error , } ;
when trying to combine swr with axios , i like the approach i found in the examples : < url > this way my axios config resembles the keyinterface , this is great . the problem starts when i try to mutate my data . in the bound mutate function , the expected data includes the whole axiosresponse object , which makes no sense when locally mutating . am i doing something wrong with the demo ? or am i misusing the mutate functionality ? demo : i use the basic userequest hook from the examples ( link above ) . when i act on the mutate function returned from userequest ( ) like this : mutate ( { data : updatedanswers } , false ) ; , i receive this compiler error : < code > argument of type ' { data : answer [ ] ; } ' is not assignable to parameter of type 'axiosresponse < answer [ ] > | promise < axiosresponse < answer [ ] > > | mutatecallback < axiosresponse < answer [ ] > > | undefined ' . type ' { data : answer [ ] ; } ' is missing the following properties from type 'axiosresponse < answer [ ] > ' : status , statustext , headers , config
i 'm polling some numbers from a webpage , but at the same you can also edit that number that i 'm polling ( think of it like getting a value for a variable but be able to set it ) . therefore i have either a < div > that contains the value or when you toggle a button you have a < input > field . when i click that button i do n't want to fetch that data anymore ( because i 'm about to edit it ) , but i want to last value that has been fetched as an initial value for my input field . but when i set the key to null via conditional fetching the data will be reset to null as well . is there a way to get the last fetched data ( prefereable without storing it in the mean time ) ? < code >
hello folks does anyone know how to redo the code snippet below using swr ? < code > const dependency= useselector ( state ... ) useeffect ( ( ) = > { call api ... } , [ dependency ] ) ;
this test fails with a invalid hook call . hooks can only be called inside of the body of a function component i have also tried to render the hook with a wrapper that provides the swrconfig provider but it does not change the outcome . < code > const { result } = renderhook ( ( ) = > usefaqtopics ( ) , { wrapper } ) 72 | export function usefaqtopics ( ) { > 73 | const { data , error , mutate } = useswr < faqtopic [ ] > ( `` /faq '' , ( ) = > promise.resolve ( topics ) ) | ^ 74 | return { 75 | topics : data , 76 | loading : ! data & & ! error , at resolvedispatcher ( node_modules/react/cjs/react.development.js:1590:13 ) at object.usecontext ( node_modules/react/cjs/react.development.js:1598:20 ) at useswr ( node_modules/swr/dist/index.js:1:6763 ) at usefaqtopic ( src/api/faq.ts:104:44 ) at _renderhook2.wrapper ( src/api/faq.test.tsx:35:60 ) import react , { reactnode } from `` react '' import { renderhook , cleanup } from `` @ testing-library/react-hooks '' import { cache , swrconfig } from `` swr '' aftereach ( ( ) = > { cache.clear ( ) } ) const wrapper = ( { children } : { children : reactnode } ) = > ( < swrconfig value= { { dedupinginterval : 0 } } > { children } < /swrconfig > ) it ( `` should return all categories '' , async ( ) = > { const { usefaqtopics } = require ( `` ./faq '' ) const { result } = renderhook ( ( ) = > usefaqtopics ( ) ) const { topics } = result.current expect ( topics ) .tohavelength ( 7 ) } )
is there an example of how to persist pagination in the page url when using useswrinfinite ? for example , i want to be able to share a paginated page with someone and persist the page size , also when page size changes i want to update url . with next.js i can do something like this : but this will trigger two renders , so i want to do just a route change and trigger useswrinfinite load . is this possible ? i can do it like this but it will also trigger two renders . the thing gets more complicated if we add more query string params , for example , sort or multiple filters . maybe i 'm doing something wrong here , but not sure what , so please help 🙏 thx ! < code > const { page } = router.query ; const { data , setsize } = useswrinfinite ( getpagekey , fetcher , options , ) useeffect ( ( ) = > { setsize ( page ) ; < -- this will trigger second render } , [ page ] ) ; const onnextpage = ( ) = > { router.push ( '/ ? page= < cur > { page +1 } ' , null , { shallow : true } ) ; } const onnextpage = ( ) = > { router.push ( '/ ? page= < cur > { page +1 } ' , null , { shallow : true } ) ; setsize ( page +1 ) ; }
for example is this a good idea ? is this feasible ? < code > import dayjs from 'dayjs ' ; import useswr from 'swr ' ; export function component ( ) { const { timestamp : lastupdated } = useswr < user > ( `` /users/ @ me '' ) ; return < p > last updated { dayjs ( lastupdated ) .fromnow ( ) } < /p > }
i am trying to build an application with large json data and sending get request every 7 seconds . so , both data size and frequency are high . should i use swr or axios with react hooks and setinterval . i am using ag-grid and react-vis chart to display data . there are 12 tables in every page with 30-100 rows . i am concerned about the performance issues . can swr be good fit for this type of application ? < code >
in my hooks i am often combining useswr with mutation functions to update the server resource . in my hook callbacks it would be nice to be able to use the already existing and exported swr error for error reporting . like with a seterror function maybe ? otherwise i 'd have to setup a usestate for the error that is shared between swr and my post promise rejection . any patterns that could help to streamline error reporting ? < code > const { session } = usesession ( ) const { data , error , mutate } = useswr ( session ? .id ? [ `` /v2/order/recipe/summary '' , session.id ] : null , ( path , sessionid ) = > get ( path , sessionid ) .then ( normalise ) ) const uploadphoto = react.usecallback ( ( path : string ) = > { return post ( ... , session.id ) .then ( mutate ) .catch ( seterror ) } , [ session , mutate ]
so i 'm using swr to query an endpoint with refreshinterval set to 1000. but i only want to do this until the data returned meets a certain condition . after this , i want to set the refreshinterval to 0 again . what would be the best solution for this ? i guess i can see a solution with useref for the options object for example , but that seems kind of overkill ... < code >
this could be the happiest case if data returns 3 type null = > loading [ ] = > empty [ { id : 1 } , { id : 2 } ] = > fetched success but the current api response only 2 type null = > when empty [ { id : 1 } , { id : 2 } ] = > when have query data which means , as the frontend point of view , i ca n't distinguish between loading and empty any tips to handle this ? < code > import useswr from 'swr ' function profile ( ) { const { data , error } = useswr ( '/api/users ' , fetcher ) if ( error ) return < div > failed to load < /div > if ( ! data ) return < div > loading ... < /div > if ( data.length === 0 ) return < div > empty < /div > return do something with data ; }
hi everyone , i 'm implementing an autocomplete component that uses swr . so far so great , i really love it but i would like to handle the use case when the user types fast and i would love to not trigger all the swr calls if those calls are made in the same period of time . would be possible to do that or should i create a layer above swr ? the other issue would be that the match should be done on partial key because at the moment my code is like this : so i would like to check on /search ? query= and not the whole query < code > const { data , error } = useswr ( query & & query.length > = minlenght ? '/search ? query= < cur > { query } ' : null , async ( ) = > await api.business.getsuggetions ( query ) ) ;
hi guys ! i have a scenario that needs totally rely on the data responded from the api . swr always returns the cache data first then revalidate it in the background . if i get data i 'll show some important messages to users . if i get the cached data first , this message will be shown , which might not the correct message . so i 'm thinking if i can know what kind of data is a staled data , i can ignore them in this scenario . 🤔 thanks ! < code >
i have a mutate call triggering in my useeffect hook after an event , but i suspect it kills any automatic regular interval polling after this call is made . would that be correct ? < code >
is it intentionally that mutate will not trigger the onsuccess and onerror callbacks for a hook ? < code > const { data , mutate } = useswr ( `` /session '' , fetchsession , { onsuccess : newsession = > newsession & & asyncstorage.setitem ( `` session '' , newsession ) , onerror : asyncstorage.removeitem ( `` session '' ) , } ) const login = react.usecallback ( ( name , password ) = > { return post ( ... ) .then ( result = > mutate ( result , false ) ) } )
i have a fairly complex cache key , and it is triggered whenever i save the ( debug ) versions source code as if one identity of the objects in the cache key changes . is there a away to debug print the recognised cache key by swr so that i can see how it differs from the old one ? < code >
hi , i was fetch data in other component now i am trying get data but do n't need to fetch again const { data } = useswr ( `` searchresult '' , null , { revalidateonfocus : false , revalidateonmount : false , revalidateonreconnect : false , shouldretryonerror : false } ) ; but swr still fetch ( `` searchresult '' ) is there a good way to stop it ? < code > await fetch ( `` /api/search ? data= '' + e.target.value , { method : `` post '' , } ) .then ( ( res ) = > res.json ( ) ) .then ( ( res ) = > { mutate ( `` searchresult '' , res , false ) ; return res ; } )
i am using useswr for my profile request in order to get various profile data ( name , photo , saves etc ) . so this means using useswr in each component that needs the specific data . the problem is that on each request , the useswr hook makes some changes behind the scenes ( based on the different request states maybe ) and this triggers multiple renders on each component that uses the hook . so if i have 10 components that use the hook , it will cause ~20 renders ( 2 for each component x 10 ) . using the react dev tools it would show the famous hooks changed for each component . this can lead to many useless renders and performance problems down the way . is there anything that i am missing in the way i am using the hook ? can i use usecallback or usememo behind a custom hook that uses useswr ? i thought i 'd be able to use it as a context and it doing the required memoization behind the scenes , only triggering once per component . < code >
hi all , i 'm struggling with how to catch and respond appropriately to a 401 error from an api call using axios . i need to call a function to handle a 401 response ( namely asking the user to login ) , but ca n't find where to do that ? any error returned from swr does n't really help that much , as it does n't include the status code ( it does , but as part of the message property of the error object , which is n't the best place to find it ) . i 've tried adding a .catch ( ) to the end of the fetcher function , but that does n't seem to get called . i 've also tried defining an onerror function in an swrconfig , but that does n't seem to get called either . i 've switched from using suspense , as i thought that was getting in the way of those functions , but it does n't seem to have made any difference . i 'm sure i 'm missing something obvious , but i ca n't see the wood for the trees . it occurs to me that swr should return the error object from axios , which would include the detail i need , but it seems to return a subset of the object instead ? < code >
bug report description / observed behavior i want to revalidate the data/send a new request using the global mutate function . expected behavior to send a new request . repro steps / code example i 'll just post a code snippet as i am not doing anything fancy . and then when i use the global mutate function mutate ( '/api/tasks ' ) now i am not adding the query and i assume thats how it should work . because i do n't have access to contactid in every instance . < code > const { data , error } = useswr ( '/api/tasks ' + encodequerystring ( { limit : 3 , contactid : id , } ) , ) // /api/tasks ? limit=3 & contactid=30404
hi , i 've been using swr for a while and following the docs i understood about sending multiple arguments like this [ '/api/user ' , token ] and it works pretty good until now for all of my apps . now i have to deal with a infinite loading and following the docs , i have tried to implement it the `` same way '' as useswr , also , passing multiple args like this : but sadly it 's not even getting into getkey fn . i tried to do a console log just to check : checking the example from docs in sandbox ( < url > ) if i try to modify to an array it 's also not working . how could i do this in order to work ? thanks ! < code > const { data , error , size , setsize } = useswrinfinite ( token ? [ getkey , token ] : null , fetcher ) ; const getkey = ( pageindex , previouspagedata ) = > { console.log ( 'here ? ' ) ; // reached the end if ( previouspagedata & & ! previouspagedata.data ) return null ; // first page , we do n't have 'previouspagedata ' if ( pageindex === 0 ) return '/customer_access ' ; // add the cursor to the api endpoint return '/customer_access ? last_slice= < cur > { pageindex } ' ; } ;
i have created several custom hooks that are invoked within other hooks but the strange thing is that swr is always fetching from the server and never returning what 's in cache even though the key is the same but each time that hook is invoked in another component , it will invoked always from the server , never from the cache is it possible that the fetch data onmount is making this efffect on hooks ? < code >
i 'm using useswr in a component and rendering result . in that i have set dedupinginterval as 60 seconds . with that , a resource item in the previously fetch data can be updated in a separate component . since mutate can not be used in this case to revalidate the data , i tried clearing the cache . but even after clearing the cache , the useswr returns old data . basically the question is , is there a way to revalidate within the dedupinginterval time by clearing cache ? < code >
our search hook ( useswr ) returns a bunch of results . would it be possible to update individual cache keys without those cache keys ever being used before ? so that when the item is actually rendered the `` smart '' component can use it as : and the item is not fetched from the server again ? < code > searchresult.foreach ( item = > mutate ( 'item/ < cur > { item.id } ' , item , false ) ) const item = ( { id } ) = > { const { item } = useswr ( 'item/ < cur > { id } ' , get ) return < ... > }
did n't find it in docs or maybe its a bug , but is it possible to mutate data when component is already unmounted ? as common example user submits data in a component , then ( immediately ) navigates away/back to a different component when user returns to component form values ( inputs ) are being initially populated with stale default values and are not affected with later revalidation changes . i 'm curious how others handle this pattern ? < code > const onsubmit = async ( ) = > { await updateremotedata ( formdata ) ; await mutate ( '/remote-data ' ) ; console.log ( 'data successfully updated remotely but not in cache . ' ) ; } ;
background i currently have a project where i 've written data fetching hooks , these work great for simple use-cases , however right now we 're about to do some major rework on the api-backend side , and before expanding my hook i 'm evaluating swr . one frequent pattern i have is that i want to wait and do the initial load until my context receives a callback containing a parameter used for data-fetching . problem in my use-case , i sometimes want to do the following : mount swr in context use context hook in sub-components to gain access to callbacks call the callback function with an initial parameter receive do first backend request however , swr does n't fetch any data when changing the arguments or/and calling mutate if i use either option of initialdata : [ ] or revalidateonmount : false . in my data-hook , i have an option called initialload which i can set to false to get the desired behaviour but , i ca n't seem to reproduce this behaviour using swr . i 'm much grateful for any help i can get in regards to this matter . < code >
having read the full docs , i 'm still confused about the behavior when using array keys . if any of the items in the array key are null , does swr cancel the request ? do all items have to be strings ? another discussion seemed to imply that . if so , why is n't that enforced by the typescript typings ? pagination is listed as a feature but not documented at all ? i appreciate any help/clarification here . < code >
if i prefetch a key and then load a component with useswr revalidateonmount : true using the same key , before the prefetch has resolved - the request ends up validating and never resolves . i can fix this by pre-fetching the key and in the component have revalidateonmount : false on the useswr as you suggest ... but if i have n't pre-fetched the key , and the component is set to revalidateonmount : false , then that component never loads the data ! ! ! and this only works when not using suspense , with suspense it ends up in a never ending re-rendering loop . < code >
i have a hook that should conditionally fetch some data , when a user logs in . for that i use a conditional key : however , sometimes , while the log has several lines with ( same ) session and user id filled useswr never starts the fetch . i see like 40 log lines but not one time a fetch request performed ( also logged ) . could that be a debounce problem ? too many updates flooding the hook ? at the start of the program session is undefined therefore the key is null . but this seems to work on almost all other places i use this pattern . < code > export function usewatchlist ( ) { const { session , fetch } = usesession ( ) const selectedpharmacy = useselectedpharmacy ( ) const { data , error , } = useswr ( session ? .userid // dev-1837 : include selected pharmacy to invalidate cache key when pharmacy is changed ? [ `` /user/watchlist '' , session.id , selectedpharmacy ] : null , ( href ) = > fetch ( { method : `` get '' , href } ) ) console.log ( `` session & user '' , session ? .id , session ? .userid ) ... }
hi guys , i 'm trying to add offline capabilities to a small app i made that use swr . what i have in mind is using indexeddb as a local cache provider . a solution would be adding cache update and fallback into the fetcher func , but it seems heavy for something that i guess already exists somewhere . or maybe populate swr at startup from db and update cache in fetcher so i do n't have to test is we are online in fetcher . how are you guys doing this ? thanks , < code >
hi everyone , i 'm stuck trying to use swr with graphql-request when using variables . i 've looked at the docs on graphql and multiple arguments but i 'm still a bit confused on the syntax of it . the attempts i have tried are returning no data and causing constant refreshes in react ( i can get data through without the variables ) . the backend server is being hit constantly ( many times a second ) and returning 200 statuses but the front end app never gets past the isloading status . example of my attempt : < code > function getdataforswrviagraphql ( graphqlquery , variables = { } ) { const { data , error } = useswr ( [ graphqlquery , variables ] , graphqlfetcher ) ; return { data : data , isloading : ! error & & ! data , iserror : error } } const productsgraphqlquery = gql ' query productsquery ( < cur > limit : int ) { products ( limit : < cur > limit ) { id name price } } ; const variables = { limit : 10 , } ; getdataforswrviagraphql ( productsgraphqlquery , variables ) ;
i tried to return an array with 2 string as the key and everytime it only retains the first string as discord the rest . is that the expected behavior ? thanks < code >
i 'm using useswr in my nextjs project but i 'm having trouble with it returning undefined . hooks.jsx when i console logged the 'data ' in the fetcher function , it returns the data as expected . however , in the main useuser function , the 'data ' returns undefined . what am i doing wrong ? thanks in advance < code > import useswr from 'swr ' ; import { useeffect } from 'react ' ; import { userouter } from 'next/router ' ; const fetcher = ( url ) = > { fetch ( url ) .then ( ( r ) = > r.json ( ) ) .then ( ( data ) = > { console.log ( data ) ; < - returns data as expected return { user : data ? .user || null } ; } ) ; } ; function useuser ( { redirectto , redirectiffound } = { } ) { const router = userouter ( ) ; const { data , error } = useswr ( '/api/users/fetch ' , fetcher ) ; const user = data ? .user ; const finished = boolean ( data ) ; const hasuser = boolean ( user ) ; console.log ( data ) ; < - returns undefined useeffect ( ( ) = > { if ( ! redirectto || ! finished ) return ; if ( // for register / signin route ( redirectto & & redirectiffound & & hasuser ) ) { router.push ( redirectto ) ; } } , [ redirectto , redirectiffound , finished , hasuser ] ) ; return error ? null : user ; } export default useuser ;
i am using swr with indexeddb . here 's the scenario , very simple : i update one list item in indexeddb , after that i need to refresh the list by making an indexeddb query to get the list again . as the indexeddb request is very fast , i do n't need to update the local data immediately . i just need a refetch . i found calling mutate ( ) without parameters and calling revalidate ( ) both work out , so i want to know which one is more suitable ? < code >
i am using next and have a statically generated page that checks if the current user is logged in after it loads . i would like to use useswr to fetch updated data on this page only if the current user is logged in . the check to determine whether they are logged in takes about a half second . once the state is updated with the logged in status , is it supported to change the conditional in useswr ? something like this ? < code > const [ session , loading ] = usesession ( ) ; const { data } = useswr ( ! loading & & session ? '/api/data ' : null , fetcher )
hi all , i do n't know what i 've done wrong here but useswr is not pulling the data i would expect from my api routes . hoping somebody could offer some advice ? i have a page called backorders : when you navigate to /api/orders the expected data is pulled and displayed . my orders api file : i can see the issue in the axios error : '/order.json ? complete=undefined ' , complete=undefined should not occur due to my if statement in the orders api file ? any ideas ? < code > export default async ( req , res ) = > { const { complete } = req.query if ( ! complete ) { const response = await getallorders ( ) res.json ( response.data ) } const response = await getfilteredorders ( complete ) res.json ( response.data ) } const backorders = ( ) = > { const fetcher = url = > fetch ( url ) .then ( res = > res.json ( ) ) const { data , error } = useswr ( '/api/orders ' , fetcher ) console.log ( data ) return < div > test < /div > }
currently in page i use this const { data , error , mutate } = useswr ( '/api/ ' , fetcher ) in child component i use this so i can get the values const { data , error , mutate } useswr ( '/api ' , fetcher , { revalidateonmount : false } is there anyway i can access the current key value , check if the key is `` fetched before '' before fetching ? pseudo code const { data , error , mutate } = useswr ( '/api ' , ( currentkeydata ) = > fetcher ( check if currentkeydata exist before fetch ) ) < code >
i have an app that has two entities : widget and user . every widget belongs to a user . a user can have many widgets . i 'm making a call to fetch a paginated list of widgets which is all well and good . but then , to fetch the users , i 'm doing something which seems sub-optimal ( since i 'm losing out on de-duping and caching benefits ) : we can run into duplicates if there are multiple widgets created by the same user in our paginated list . it 's easy enough to solve with a set , but i 'm wondering if there 's a better way . regarding caching , the above is n't great either . we 're caching [ 1,2,3 ] , but not [ 1,2 ] or [ 3,2,1 ] . what i 'd like is to have a hook per user in order to cache each individual entity . < code > const { data : widgets } = useswr ( `` /api/widgets '' , fetchwidgets , { suspense : true } ) const fetchusers = async ( keyname , userids ) = > { // logic to fetch users } const userids = widgets.map ( w = > w.userid ) const { data : users } = useswr ( // the key [ `` /api/users '' , userids ] , // the fetcher fetchusers , // swr options { suspense : true } , )
hi , i feel silly but i have n't found any clue on how to achieve such a task . should i use the compare function and return true is new data is empty ? should i rather leave this task to react and use react.memo to not update the view ? thanks < code >
hi , swr has been working fine with me until today i realize my server got unexpected request when i click a button that causes a confirmation popup and revalidateonfocus enabled . please refer images below . and this is the delete product function . again , the problem here is the hook re-render and make a server request whenever i click `` ok '' or `` cancel '' on the confirmation box . my guess is that , swr hook detects user loses focus on the component , then when i click `` ok '' or `` cancel '' the component re-focus , that 's why resend server request . if if this is unavoidable because of default browser behaviour , mind suggest me a better approach to confirmation before actual delete ? note revalidateonmount tested no issue here . the issue is revalidateonfocus . this is the first time in my life to create a issue in github , please forgive me if i miss out anything here . swr is a great tool . thanks with love . < code > const handledeleteproduct = ( e ) = > { e.preventdefault ( ) ; if ( typeof window ! == `` undefined '' & & window.confirm ( `` are you sure you want to delete the product ? once deleted it can not be recovered . '' ) ) { deleteproduct ( product.public_id ) ; } } ;
i only discovered this project today . congratulations for this great job ! in your opinion , how difficult is it to create an offline-first web/desktop/native application with this project ? anything that respects these rules ? < code >
hi ! i was wondering what the best practices were for augmenting the data returned from useswr with state . as a toy example , suppose i use useswr to fetch a user 's todos from an api endpoint . but on the client , the user should be able to `` check '' those todos to mark them for exporting to csv or similar . the `` check '' operation should be stored as client state and ideally would `` augment '' the fetched data in a way . is there a proper way to do this ? as an incomplete example , see below < code > function todolist ( ) { const [ todos , settodos ] = usestate ( [ ] ) ; const { data } = useswr ( `` /gettodos '' , fetcher ) ; if ( data === undefined ) { return < div > loading < /div > ; } // this will run on every render which seems wrong for ( let todo of data.todos ) { // append a todo to the local state along with `` check '' settodos ( [ ... todos , { checked : false , ... todo } ] ) ; } return ( < div > { todos.map ( ( todo ) = > ( < div onclick= { ( ) = > { todo.checked = ! todo.checked ; // i know this does n't work but you get the point } } > { todo.checked & & `` i 'm checked '' } < /div > ) ) } < /div > ) ; }
hi , i 'm working on a next.js app and we also use swr for data fetching . the problem i 'm encountering is the following : useswrinfinite works perfectly on /page1 , but if i navigate to page2 it breaks . on the other hand , if i go directly to /page2 from my browser , it works . by `` it breaks '' i mean that even though we call setsize with the new size and i have confirmed with a console.log that pagecountref.current gets updated , < url > this still has the old value any suggestions please ? < code >
i am running a bound mutate and using the axios example in this repo . i would expect the data to maintain previous result until request has finished but it seems to turn undefined and returns the network data . how can i achieve optimistic response like behaviour using swr ? < code >
i need to update the search params ; const { data , error , size , setsize , mutate } = useswrinfinite ( index = > '/api/posts ? page= < cur > { index + 1 } & limit= < cur > { pagesize } & search= < cur > { params } ' , fetcher ) does the mutate function accepts query params ? < code > const handlesearch = ( params ) = > { mutate ( '/api/posts ' ) }
the ts compiler is complaining about a possible undefined variable when using the key callback pattern : this will complain that session might be undefined . since this is intentional what is the swr teams recommendation for getting rid of the warning ? disable it via comment ? < code > const { session } = usesession ( ) useswr ( ( ) = > [ `` /v2/order/recipe/summary '' , session.id ] ,
i am using pwa with cra , so is it possible if the network was offline to prevent replacing old data with the new on , in this case , error , because the network is offline ? < code >
hello , i understood the basic usages of swr on the web application . before using the library , i would like to know where the cache will be stored ? would it impact on the long-term running on the browser , like memory overload etc . given that my query could be fetching quite a amount of data , should i worry about the memory issue ? < code >
i have a problem with accessing data from cache . i have my dahboard component . data fetching here is ok , and i can access it . the problem starts when i 'm trying to access this data in other component . data in navbar component is undefinied . any reason why this is not working ? whole app is wrapped into swr provider . < code > const navbar = ( ) = > { const { data , error , mutate } = useswr ( [ '/api/user ' ] ) console.log ( data ) return ( < styled.navbar > dasdasdas < /styled.navbar > ) } const dashboard = ( { code } ) = > { const { data , error , mutate } = useswr ( [ '/api/user ' , code ] , ( url , code ) = > api.auth.getauthdata ( { code } ) ) return ( < mainlayout > < div > dasdasdasasd < /div > < /mainlayout > ) }
i have a prod code like this : then i want to mock this error and perform an assertion for error message changing : and it does not work , so my question is how to mock useswr 's error , so i can trigger onerror callback thanks . < code > import { renderhook } from `` @ testing-library/react-hooks '' ; describe ( `` # myhook '' , ( ) = > { it ( `` should set error message when request failed '' , async ( ) = > { // given const useswr = jest.fn ( ) .mockreturnvalue ( error ( `` error '' ) ) ; jest.domock ( `` swr '' , ( ) = > useswr ) ; const { myhook } = require ( `` .. /myhook '' ) ; // when const { result , waitfornextupdate } = renderhook ( ( ) = > myhook ( ) ) ; await waitfornextupdate ; // then expect ( result.current.error ) .tobe ( `` error '' ) ; } ) ; } ) ; const myhook = ( ) = > { const [ error , seterror ] = usestate ( `` '' ) ; const { data } = useswr ( url , fetcher , { onerror : ( error ) = > { seterror ( error ) ; } , } ) ; return { data , error , seterror } ; } ;
hi , i 'm working on a react native app that needs to work offline and i 'm looking for the best way to handle data fetching . swr seems to address a lot of problems i have encountered with redux based apps but i do n't find how i could handle an offline mode ? what i 'm trying to achieve is performing an optimistic update if offline and send the requests as soon as mobile reach network again . is it something i could do with swr ? thanks for your help ! < code >
hi ! i would like to ask whether the useswrinfinite ( ) hook is considered a stable api ( i.e . it can be used in production , and the api is n't going to change radically in the future ) . am wondering about this because there were n't any documentation about it in the readme , so i was n't sure whether it is still experimental , or the missing docs was just an oversight . thanks ! < code >
hello ! i 'm using useswr like this : so i have to manually mutate ( '/api/something ' ) explicitly whenever i need the head request to be triggered again how do you see if we could have access to headers in comparefn , or have a compareheaders , so i can do this : < code > ... const { data } = useswr ( '/api/something ' , url = > axios.head ( url ) ) const myvalue = data.headers [ 'some-header ' ] .... const { data } = useswr ( '/api/something ' , url = > axios.head ( url ) , { compareheaders : ( a , b ) = > a [ 'some-header ' ] ! == b [ 'some-header ' ] } )
hello , thank you so much for this library . it 's excellent . i had a quick question about this pattern i 'm using to fetch data using swr , and this is skeletal of the inner component . just curious if this pattern looks good ? any thing i might do to improve this pattern . it is working nicely . i realize i 'm just showing `` some thing went wrong '' which is pretty generic & probably not too helpful to the user & plan on refining this a bit further . < code >
hello , i have a single resource that i 'd like to update while it exists . unfortunately , at some point , it gets deleted and swr still tries to update and makes unnecessary 404 requests . i am aware that swr uses exponential backoff by default and that works in favour , but i want to stop those requests completely . so my question is there a way to delete a key from revalidating forever ? do i have to write a custom onerrorretry function or is there a different/better way ? < code >
i am facing problems in how to mock useswr in jest . i have tried few ways f doing it . by mocking my [ ... param ] file . like it does not work . ca n't find any material to refer to as well . can i get some help ? for mocking useswr with jest @ namics @ sergiodxa < code > const path = require ( 'filepath ' ) ; jest.mock ( path )
i 'm planning to switch data fetching in my app from manual to swr . i have a need to fetch data when i navigate back from one screen to another . does anyone know if it will work without need for custom setup or is revalidate-on-focus web only ? < code >
i have a mutate as follows await mutate ( [ `` /api/v1/resource/updateresource '' ] , await axios ( config ) ) when the server returns a 500 , retry does n't happen . i 'm not sure what i might be missing , any help would be much appreciate i did specify the following explicitly too < swrconfig value= { { refreshinterval : 1000 , shouldretryonerror : true , errorretrycount : 3 } } > < app store= { store } usermanager= { usermanager } / > < /swrconfig > < code >
looks like a nifty library . i 've now got this working . the api call ( api/persons ) response is as follows : in my application i have a person type as follows : what 's the best practice for mapping the person api response to my person type ? < code > export interface person { firstname : string ; lastname : string ; } [ { 'first_name ' : 'bob ' , 'last_name : 'smith ' } ] import useswr from 'swr ' ; import { user } from ' .. / .. /models/user ' ; import heroimage from ' .. / .. /components/hero-image/hero-image ' ; import layout from ' .. / .. /components/layout/layout ' ; const fetcher = ( url ) = > fetch ( url ) .then ( ( r ) = > r.json ( ) ) ; const homecontainer : react.functioncomponent < props > = ( { user } ) = > { const { data : persons } = useswr ( '/api/persons ' , fetcher ) ; const getlayout = ( ) = > { return ( < layout signedin user= { user } > < div > { persons ? ( persons.map ( ( t ) = > ( < li key= { t.first_name } > { t.first_name } { t.last_name } < /li > ) ) ) : ( < spinner / > ) } < /div > < /layout > ) ; } ; return ! user ? ( < div classname= { style.centre } > < spinner / > < /div > ) : ( getlayout ( ) ) ; } ; export default homecontainer ;
the issue i am having is every call of size + 1 while resulting in a new query does not change any of the values sent to the fetcher . i am perhaps using it in a bit unusual of a way . however i believe i also tried it correctly in a more conventional approach and could not get it to work as well . i am sure i am missing something . whenever i call setsize ( size = > size+1 ) , searchcredits only receives skip : 10 no matter how many times . size is increasing with each call but its not passed down . any thoughts or guidance would be appreciated . < code > const [ searchcreditsquery , setsearchcreditsquery ] = usestate ( { searchterm : `` , claimed : false , } ) const getkey = ( pageindex , previouspagedata ) = > { if ( previouspagedata & & ! previouspagedata.length ) return null return [ '/api/credits/ < cur > { teamid } /search ' , searchcreditsquery.searchterm , searchcreditsquery.claimed , size , ] } const { data : creditsdata , error : creditserror , isvalidating , mutate , size , setsize , } = useswrinfinite ( getkey , ( ) = > searchcredits ( teamid , { ... searchcreditsquery , skip : size * 10 } ) )
this is a great library , thanks . i have a larger fetch with data that are relatively stable . i would like to avoid validations unless i am explicitly triggering them . previously i managed this data in context and moved to useswr . if i have data from this fetch used in different components there is a re-validation by default . i do not mind focus validations but want to avoid unnecessary fetches due to components mounting . i tried the revalidateonmount option in this case i am not getting an initial fetch . i tried setting the dedup threshold very high but this also seems to prevent my manual validations ( i was surprised by this ) . is there a way i can achieve what i want ? no re-validation on mount but ensure my manual mutations are triggering a fetch ? < code >
hello , with apollo client , you could just use usequery in any level of the component tree and the app would still render in ssr mode like this : < url > and here is the source code for getdatafromtree : < url > with this library , you have to write your fetch twice , once in getserversideprops and inside the component for client side fetching if the data changes during runtime . is there a way to avoid writing the queries twice and use useswr at any level of the component tree ? < code >
do you find github discussions useful as a communication channel ? maybe not ? hello developers ! i am raula gaikovina kula , a software engineering researcher < url > together with a team of researchers , we are interested in your thoughts about using the github discussions beta . we noticed that your project is currently using . we have developed a simple 3 question survey that could take up to 5 mins to complete . < url > thank you in advance for your time and apologize if this is not a proper use of this channel . @ raux raula , phd on behalf of hideaki , sebastian , nicole and christoph < code >
have you successfully implemented : this library with workbox 's or any other library 's swr caching strategy in a service worker ? i 've used workbox stalewhilerevalidate caching strategy with swr library , but stumbled upon an issue with useswrinfinite : there is no rerender with updated data on revalidate for some reason i will explore it more , but if anyone has successfully implemented it , it 'd be great to hear your story < code >
im trying to use swr only with a fetcher and send one parameter to that fetcher , but it return undefined , how to do that correctly ? i have this fetcher that connect to my fauna api and i want to send an id parameter const { data , errors } = useswr ( [ idproduct ] , productbyid , { refreshinterval : 3000 } ) < code > export const productbyid = async ( id ) = > { const query = 'query productbyid ( < cur > id : id ! ) { findproductbyid ( id : < cur > id ) { _id name } } ' const res = await fetch ( process.env.faunadbgraphqlendpoint , { method : 'post ' , headers : { authorization : 'bearer < cur > { process.env.faunadbsecret } ' , 'content-type ' : 'application/json ' , accept : 'application/json ' , } , body : json.stringify ( { query , variables : { id } , } ) , } ) const { data : { findproductbyid } } = await res.json ( ) return { data : { findproductbyid } } }
what if we would like to achieve realtime not by polling , but by connecting to a stream ( using websockets ) , and persist emissions of that stream in the cache , that would be accessible cross routes . would swr be suited for that ? < code >
in swr documentation , i can not found about isloading explicitly . this page show like this similirary , [ quick start ] section show like this < url > and isvalidating is explained like this isvalidating : if there 's a request or revalidation loading question1 : what is best practice for isloading ? is this isloading : ! error & & ! data ? question2 : what is isvalidating use case ? < code > if ( error ) return < div > failed to load < /div > if ( ! data ) return < div > loading ... < /div > isloading : ! error & & ! data ,
hi , i am using a jwt token in fetcher which refreshes in every 5 minutes . the initial request works as it is expected but when revalidation on focus runs again after 5 minutes , the fetch calls fail because the jwt token inside the revalidating fetch call is not getting refreshed . but when i click and make a new request it works fine again . i am assuming that the fetcher instance is stored initially and the same instance is then used when running revalidation thus the jwt token not being updated . example code : any idea how i can fix this ? additional context swr version : 0.3.0-beta.10 < code > const fetcher = usecallback ( ( url : string ) = > { ... } , [ jwt ] ) ; const { data } = useswrinifinite ( ( index ) = > { // returning url with pagination params } , fetcher ) ;
hello , if i try something like the following : mutate swallows the error and it 's never heard from . however , the docs seem to state that i should be able to catch this . here 's what the docs say : that is here : < url > what 's going on ? < code > try { const user = await mutate ( '/api/user ' , updateuser ( newuser ) ) } catch ( error ) { // handle an error while updating the user here } import { mutate } from 'swr ' ; try { const foo = await mutate ( 'bar ' , async ( ) = > { throw new error ( 'an error occurred ' ) ; } ) ; console.log ( { foo } ) ; // { foo : undefined } } catch ( e ) { // this is never executed console.error ( e ) ; }
i am new to using useswr . below is one condition i found in which useswr does n't even attempt to make the api call : if i comment out the line specificprop= { componentdata.specificprop } and pass that prop as spreading operator in { ... componentdata } , it works well . but if i do n't do it , it does n't even call the api and the component does n't render altogether . < code > // below is a snippet of component that one of my pages on nextjs renders const { data : componentdata , isvalidating , error } = useswr ( url , fetcher.fetch , { refreshinterval : 0 , revalidateonfocus : false , } ) ; return ( < > { ! isvalidating ? ( < > < somereactcomponent { ... componentdata } specificprop= { componentdata.specificprop } // this is the line causing problem onrefresh= { handlerefresh } / > < / > ) : ( < somereactcomponent loading / > // renders the loading version of the component ) } < / > ) ;
what is the best way to include mutation handling and swr cache revalidation in a custom hook ? i am currently using this : it works , but i wonder if this is the recommended way to do that ? it also create a rather unstable hook , as the 2 addproduct and removeitem are not stable in a way they could be used as dependencies for hooks because they are recreated each time the hook is called . < code > export function useorder ( ) { const { session } = usesession ( ) const { data : order , error , mutate , revalidate } = useswr < order > ( ( ) = > '/order/ < cur > { session.orderid } ' , get ) const addproduct = async ( productid : string , quantity : number ) = > { await post ( `` /order/item '' , { productid , quantity , } ) revalidate ( ) } const removeitem = async ( itemitem : string ) = > { await del ( `` /order/item/ '' + itemitem ) revalidate ( ) } return { order , error , loading : ! order & & ! error , addproduct , removeitem , mutate , } }
i have several custom hooks that all depend on usesession ( ) to annotate the key with the session token . however at the apps start a new session should be created via post inside ( ? ) usesession ( ) hook : there are several problems with that : all hooks that usesession ( ) trigger the creation of a new session , so multiple sessions are created on the server i am using tempid to not trigger a fetch before the session is created the created session is not mutated it seems . the dependent hooks ca n't seem to use it to perform their fetches . what is the correct way to start and sync up such interconnected hooks ? < code > const { session } = usesession ( ) const { data : order , error , revalidate } = useswr < order > ( session ? [ '/v2/order/ < cur > { session.orderid } ' , session.id ] : null , get ) const [ tempid , settempid ] = usestate ( null ) const { data : session , mutate } = useswr < session > ( tempid ? [ `` /session '' , tempid ] : null , get ) useeffect ( ( ) = > { async function createsession ( ) { const newsession = await post ( `` /session '' ) settempid ( newsession.id ) mutate ( newsession ) } createsession ( ) } , [ ] )
hello , i need to do a conditional fetch inside a function that can have many different params . in the first render i fetch using params coming from uselocation ( ) .search ( react-router-dom ) and the value from a state called `` page '' because the query is paginated . when the user click a button to load more , i call the function again to do the query with the new page and the same params from uselocation . i tried to call this directly like a hook , but i could n't make it work right ( it is calling non-stop ) . has anyone been in this situation or can sugest something i can do ? < code >
hi all , i just wanted to know can a trigger works when called from one page and it should reflect in the other page , here is the example page1 ( < url > ) page2 ( < url > ) in page1 i do n't mutate here just a api call to add to database if success then i trigger eg ( trigger ( key ) of page2 ) will it reflect the changes in the page 2 in page2 it will only display names it will be only trigger when a new name is add at page1 will it do a api call onse i call the trigger < code >
hello everyone ! i 'm here to show a quick problem i have at this moment . why when i submit a form and do a mutate with the new form values , all input with type `` datetime-local '' changes to another value ? i made a quick example of my problem , so everyone can check without do any code : link here gif with the occurring problem : < code >
hi there , i 'd like to get ideas on how would you use swr to handle pages that are both for create and edit data ? example : i have teams , with existing api routes like post /team ( create ) , get /team/2 ( read ) , put /team/2 ( update ) using next.js , i already made it so /team/new and team/1 will display the same create or edit form in my team page i have two cases , either the url is `` team/new '' then i display the form with default values or the url is `` team/2 '' then i use swr to display a form with the values to display and update on the new form case , when the form is submitted , i use router.replace to redirect to team/ < cur > newid on the edit form case , when the form is submitted , i just mutate the team so the page is updated ( like the team title on top of the form ) now this is almost fine but ideally i 'd like the new form case , when submitted , to just refresh the page with new content . but router.replace does reload the page and so there 's a small blank screen pause before content is loaded . i am stuck on how i could make this better , any idea ? i though about still using swr even for the new case and handling the `` id=new '' part server side ( sending default data , etc .. ) . thanks ! < code >
hi , i have a components of users reviews . the component use useswr to fetch the reviews . the user can delete/edit a review . after the user delete/edit a review , i use mutate to update the cached version . how can i avoid the following scenario ? user click `` delete review '' button on review r call mutate to remove r from the reviews list swr fires a request to fetch reviews ( and get a list of reviews with r in it ) review r removed from db the response to the request in step 3 arrives and showed to the user . the user will see review r in the list until next swr fetch . even if in step 2 i call mutate with false param ( do not revalidate ) , swr possibly can revalidate again depends on the options param . how can i avoid this scenario ? what is the best practice for optimistic ui ? thanks ! < code >
hi , i am trying to add facebook to my app . i code like below , i am trying to lazy load fb comment by use dynamic , but i see facebook comment re-render too often so i use usememo . it run pretty ok , but if i go to homepage and back to mypost page , fb comment disapear ... finding a solution to implement fb comment . thank you . what i want to archive ? lazy load fb to get best speed fb just render onetime for app performance here is facebook comment component comments-facebook.js < code > import { useeffect , memo } from `` react '' ; const commentsfacebook = ( props ) = > { console.log ( `` render commentsfacebook '' ) useeffect ( ( ) = > { console.log ( `` load facebook script '' ) const facebookscript = document.createelement ( `` script '' ) ; facebookscript.async = true ; facebookscript.src = ' < url > } & autologappevents=1 ' ; document.body.appendchild ( facebookscript ) ; } , [ ] ) ; return ( < react.fragment > < div id= '' fb-root '' > < /div > < div classname= '' fb-comments '' data-href= { process.env.facebook_app_id } data-numposts= '' 10 '' data-width= '' 100 % '' > < /div > < /react.fragment > ) ; } ; export default commentsfacebook ; // mypost.js const comment = dynamic ( ( ) = > import ( `` .. / .. / .. /lib/facebook/comments-facebook '' ) , { ssr : false } ) ; export default ( props ) = > { // some codes ... return ( < tab > < othertabs / > < comment / > < /tab > ) }
when passing initialdata and using conditional fetching the data will reset to initialdata when the condition is set to falsy instead of leaving it on the last-fetched data . example : change shouldfetch to true - > will fetch fresh data change shouldfetch to false - > data reverts to initialdata instead of staying `` fresh '' i 've created a workaround that displays the behaviour i expected : change shouldfetch to true - > will fetch fresh data change shouldfetch to false - > last fetched data will be returned i appreciate that resetting data to null when no initialdata is passed makes sense , so i 'm not sure what the best solution is but the current behaviour is a bit whacky with this combo of settings . < code > // swr hack : do n't revalidate when closed but do pass latest data to initialdata const initialdataref = useref ( datafromssr ) ; const { data } = useswr ( shouldfetch ? '/api/things ' : null , apifetch , { initialdata : initialdataref.current , } , ) ; useeffect ( ( ) = > { initialdataref.current = data ; } , [ data ] , ) ; const { data } = useswr ( shouldfetch ? '/api/things ' : null , apifetch , { initialdata : datafromssr } , ) ;
so i have a set of api routes that correspond to related data like so : the employee has a foreign key to team and team has a foreign key to company . obviously i could use useswr to fetch all the data at once like so : my idea is to have a master detail ui where i have a list of companies . i can click a single company to get a list of teams . i can click a team to get a list of employees . however , what should happen if i delete a team with id 2 ? i 'm just confused on how to handle mutations such that related cascade deletes . furthermore if a local component usesswr on /api/team/2 for example , would n't i have to mutate that unique key as well ? what 's the best way to handle relational data ? at the moment i 'm using redux-orm but that 's probably overkill . < code > const { data : cdata } = useswr ( `` /api/company '' ) ; const { data : tdata } = useswr ( `` /api/team '' ) ; const { data : edata } = useswr ( `` /api/employee '' ) ; - /api/company - /api/team - /api/employee
hello , i 'm trying to find a way to prevent swr from re-rendering on each mutate call and instead re-render once after a batch of mutate calls i need this because i 'm doing the following : create new list item optimistically ( mutate ) scroll document to optimistically created list item call api to create the element for real rollback the optimistic changes ( mutate ) create the real list item ( mutate ) if i do n't batch the last two changes , the item will be removed & re-added to the layout , causing the scroll position to shift i can , instead of rollback then create , update the previously created element . but it makes the code way , way more complicated than just calling my `` add item to list '' function twice for reference , this is what the code to add that list item looks like : < url > < code >
say you have a large list of items that has been paginated using useswrpages currently , if we want to refresh the list , we have to call revalidate on every swr which causes a lot of network traffic in order to reduce traffic , apis can typically provide filters to only retrieve elements that have been updated or created after a certain date , but i do n't see a way to properly integrate that with swr my current solution is to have a second useswr run next to my useswrpages that polls that `` recently updated data '' endpoint , and to mutate the cache in the onsuccess of useswr , but that feels hacky ( it has to remove some data from some pages , add some data to other pages , etc ) i hope partial updates can become a first class citizen of the new pagination api given the high performance boost it would bring partial updates would also resolve this use-case < code >
steps to reproduce : send a successful swr query to the server = > data ! = undefined and error = undefined . after that , i trigger an error response from the server for the subsequent query = > data ! =null and error ! = undefined . is this normal ? i 'd assume that data should become undefined once error is not . when i remove the source of error and try to have a new successful server query , since error ! = undefined and exists in the cache , it is returned immediately which causes my program to redirect to login page and i lose the possibility to fetch data . this causes me a loop unless i reload the page . thanks for your help . < code >
i 've been looking into swr and the features look really nice . i like the idea of caching as well as optimistic updates . however , i 'm currently using redux alongside redux orm to manage related data models in the frontend . for example , i have a table model with a row model foreign keyed to it such that if i want to have a master > detail pattern to update the table title or the row contents i can easily select either in a detail component . is there a way to effectively transition from redux actions with axios to useswr while maintaining the ability to manage related data models ? < code >
hi team , is there any way to set poster source dynamically for video recordings done by webrtc . we get recorded video as blob and i want to show first frame of recorded blob as poster image . < code >
hey , does anyone know whether it 's possible to set own start/end values for the players timeline and use not the one from the underlying video ? we have a basic video file which can have subclips , but these subclips are just tc-in/out marks . we needed to set the start of the player to 0 but in this case , its not the start of the media , it 's start of the subclip within the media . is this currenlty a possible scenario ? thank you very much for your help . regards , stefan < code >
i am building a music web app and so far i was just hiding controls and rebuilding them using the video js api . is it possible to remove a component out of the video player container and place it anywhere in the dom and still remain with its functionality ? for example the play control component ? currently , i do n't care about the ui as long as the functionality still works fine . < code >
i have some videos that are mp4s in s3 and some others that are playable via hls with m3u8 playlists . for various reasons it 's convenient for me not to have to know which is which when rendering the html for a page , but it seems that videojs ca n't play a source without a file extension or without a type= '' '' hint . the server returns the correct content-type for either hls or mp4 . is this expected ? < code > < body > < video-js id= '' my-video '' class= '' video-js '' controls preload= '' auto '' width= '' 640 '' height= '' 264 '' data-setup= ' { `` sourceorder '' : true } ' > < source src= '' < url > / > < p class= '' vjs-no-js '' > to view this video please enable javascript , and consider upgrading to a web browser that < a href= '' < url > target= '' _blank '' > supports html5 video < /a > < /p > < /video > < script src= '' < url > < script > var player = videojs ( 'my-video ' , { html5 : { hls : { withcredentials : true } } } ) ; player.play ( ) ; < /script > < /body > < /html >
the problem is explained in detail by this thread : mediacms-io/mediacms # 403 ( comment ) summarize let me summarize it here . there is a custom videojs plugin : < url > i need to use another plugin i.e . videojs-wavesurfer , to be able to visualize the audio : < url > question is it even feasible to use the videojs-wavesurfer plugin alongside the custom plugin ? if it 's feasible , i need some hints on how it can be done . is there any helpful example ? thanks . < code >
with a group of friends , we watch very lengthy videos together . around an hour and a half or so . our problem is that some of us have unstable connections , so if theres too much action on the video , it will stall . for that reason , we have a `` buffer '' button which preloads the full video , and then we play it . the thing is that we have to wait till everyone buffers , while its not a big deal it consumes time . so the question is , it is possible with video.js to preload the whole video while watching it ? the html5 tag preloads only a few seconds and is useless . thanks in advance < code >
hi i would like to know the followings .. videojs compatibility with tizen and webos can videojs play hevc ( h.265 - 8k video ) playready drm protected contents on tizen and webos ? < code >
hello , i am using concat plugin to concatenate multiple hls videos and play in sequence but is there a possibility to add start and end offsets to those videos . for example , if there are two videos , i want the first video to play for 5 seconds and switch to the second video and once it is done i want the first video to continue playing from the 5th second onwards . is there any way to achieve this . thanks < code >
hello , is there a list of errors that the end user can see in the end ? i 've got hard times trying to recognise which error messages propagates all the way down to the player errordisplay and which are there only to log it . particularly in the video-http-streaming package . is there a way to tell ? thanks . < code >
i have a videojs playlist loaded in the video player . each video source in the playlist consists of a presigned url that expires in x number of seconds . i know exactly when the videos expire and i can obtain fresh signatures to extend their expiry time if required . there will be scenarios when this needs to happen , for example , if the viewer pauses the playlist and comes back to it later . upon the user pressing play ( or selecting a new item on the playlist ) i want to perform something like the following pseudocode : i tried listening out for videojs 's play event in the hope i could perform my expiry check here and then somehow stop the rest of the default chain of events from occurring if they had expired . but so far i 've not been able to find a way to stop this . perhaps i need to reconfigure the event listeners for the player 's default controls ? any advice would be gratefully welcomed . many thanks < code > if ( sourceshaveexpired ( ) ) { let updatedplaylist = rebuildplaylistwithnewpresignedurls ( ) ; window.videoplayer.playlist ( updatedplaylist ) ; // continue playing here , somehow }
i am using video js with the playlist plugin and the playlist ui plugin and all is working great until i go full screen . is there a way to somehow `` attach '' my playlist ui element to the player so the playlist goes full screen too ? thanks for your help : ) < code >
hi i 'm trying to reproduce the jwplayer functions to get metadata from an hls live stream : player.on ( 'meta ' , onplayermeta ) ; and var onplayermeta = function ( m ) { if ( m.metadata & & m.metadata.tit1 ) { console.log ( m.metadata.tit1 ) } } ; do you have any ideas how to proceed ? thanks a lot ! < code >
hi , i would like to learn whether this player supports going back and forward in video while providing a fast forward and fast-backward play experience , i.e . the experience whereby the video really renders very fast from the current video position all the way to the desired new position while fast-playing the video between the two points . ( obviously doing so by constantly skipping many frames at the desired rate ) . frankly i am not aware of any player that actually does that , other than what you would occasionally see in tv series and in movies . also , perhaps you can point me at library api for this project for jumping around the video programmatically rather than through a user interface control . many thanks , matan < code >
hello , i 'm working on a webinar project and one of the feature is the availability to start and stop again and again the webinar . the live video is streamed using aws medialive and mediapackage solution . when a medialive channel is stopped , then the mediapackage channel stop streaming by adding # ext-x-endlist in its last manifest but when we restart streaming , the manifest from mediapackage becomes live again as explain here < url > and videojs player is not starting to play again . here an example of the last manifest received : we are looking for a solution to tell videojs that the streaming is live again and refresh itself , load the manifest again and resume streaming . we tried several solution but no one work : calling player.load ( ) calling player.reset ( ) then player.load ( ) one solution can work but is not graceful is to dispose the player and recreate one from scratch . obviously the user will see the player disappear and then appear again like if there is a glitch in the interface . if someone have an idea to do this gracefully it should be great . thanks for your help . < code > # extm3u # ext-x-version:3 # ext-x-targetduration:4 # ext-x-media-sequence:509 # ext-x-discontinuity-sequence:16 # extinf:3.917 , dev-manu_030aaea4-bb0b-4915-88a4-521fc8b59366_1637050264_hls_1_509.ts ? m= < phone > # ext-x-endlist
i am looking for a freelancer to solve an issue for my company . we have integrated videojs in our webpage replacing dash.js . however the switch has caused an issue with our application . the ios app works fine and viewing from a browser works as expected . however on android the webview has the full screen option disabled and we have been unable to find a solution to get it resolved . this is a paid offer for a solution depending on skillset and experience with these technologies . contact me at the email below if you are interested or reply to this posting if you have questions . thank you , dominic ottaviano < email > < code >
hello i 'm searching a free lance for helping me with videojs player for live streaming events . anyone interested please contact me on telegram to the user : < url > thank you . < code >
hello , when tapping on a device to display the controls , if the tap happens on an area the should have a control once displayed ( for example the play/pause button ) , the control triggers . is there an option to disable the controls until the transition is complete ? thanks ! ! < code >
is such thing possible ? we face some problems with both - for video it 's the problem of uhd video having different codecs than lower resolutions , so the player just stop playing when we switch . we solved this problem by having uhd in a different source and when the user check uhd option ( manually ) , we reset the player and put in the new source . this is bad , because user has no adaptive streaming available anymore . i guess it could be solved via html5.vhs.bandwidth option . for the sound the problem is even more complicated , since the player starts playing representation with two channels and when we switch to to audiotrack that have representation with six channels , the player downmix 5.1 back to 2.0. so is there any way to tell the player which representation should it pick at the start ? thank you very much . i just noticed there is an issue where there is written something about better support for playlist with mixed codecs , so maybe my question is less relevant , but it would be still great to know if there is a way . < code >
i am trying to add multiple video source using this javascript file : < url > but i 'm getting an error ( no compatible source was found for this media . ) , how can i fix it ? < code >
is it possible to change the layout of the player and the components in the player ? by default the player and controls are laid out vertically , occupying 100 % width . i want to add a component to the right of the player and have the player and other controls adjust the width accordingly ? i want to add a sidebar . is this possible ? thanks anand < code >
hello , i saw that it is possible to customize the controlbar and style it as you want . is it also possible to create a complete own layout so i dont have a bar but buttons on given positions for the controls ? thank you very much in advance < code >
i 'm working on a project that runs a live video stream that is n't always running . i need to have a fallback video but the normal way - adding a second source file - does n't work . is there documentation on this ? any advice ? < code >
csp [ server ] [ ] [ ] how do i configure the server internal style of npm run dev to an external style , like the service started with the preview command npm run dev server , preview if i enable csp configure , npm run dev console output error // npm run preview < code > // error < style > # app { } < /style > // expect < link ...... > < meta http-equiv= '' content-security-policy '' content= '' default-src 'self ' ; script-src 'self ' ; style-src 'self ' '' >
i am using vite with react app for this small app . just starting . for some reason when i introduced one component ( grocerylist ) hrm is not picking up changes for this component , either from css module file or from jsx file . here is a link for the branch with this component added everything works fine when i start the app initially , but any other changes are not picked up . < code >
hi , i am looking to get started with vite and i 'm running into a strange issue with an internal shared npm library and vite -- when i attempt to import from the library ( which is simply re-exporting some mui 4 components ) , as shown below : unfortunately , the build fails like so : i believe this has something to do with the way our @ company/company-ui package exports the shared components -- there is no singular main entry in the package.json file , rather we have the following entry in exports : any ideas would be greatly appreciated ! < code > import cssbaseline from ' @ company/company-ui/core/cssbaseline ' ; import loadingoverlay from ' @ company/company-ui/core/loadingoverlay ' ; import theme from ' @ company/company-ui/styles/themeoctavia ' ; import { themeprovider } from ' @ company/company-ui/styles/themeprovider ' ; `` exports '' : { `` ./ '' : `` ./dist/ '' , `` ./package.json '' : `` ./package.json '' } , 9:06:40 pm [ vite ] internal server error : failed to resolve import `` @ company/company-ui/core/cssbaseline '' from `` src/app.tsx '' . does the file exist ? plugin : vite : import-analysis file : /users/cjones26/mfe/vite/test-app/src/app.tsx 15 | var _jsxfilename = `` /users/cjones26/mfe/vite/test-app/src/app.tsx '' ; 16 | import react from `` react '' ; 17 | import cssbaseline from `` @ company/company-ui/core/cssbaseline '' ; | ^ 18 | import loadingoverlay from `` @ company/company-ui/core/loadingoverlay '' ; 19 | import theme from `` @ company/company-ui/styles/themeoctavia '' ; at formaterror ( /users/cjones26/mfe/vite/test-app/node_modules/vite/dist/node/chunks/dep-59dc6e00.js:38663:46 ) at transformcontext.error ( /users/cjones26/mfe/vite/test-app/node_modules/vite/dist/node/chunks/dep-59dc6e00.js:38659:19 ) at normalizeurl ( /users/cjones26/mfe/vite/test-app/node_modules/vite/dist/node/chunks/dep-59dc6e00.js:56830:26 ) at processticksandrejections ( node : internal/process/task_queues:96:5 ) at async transformcontext.transform ( /users/cjones26/mfe/vite/test-app/node_modules/vite/dist/node/chunks/dep-59dc6e00.js:56979:57 ) at async object.transform ( /users/cjones26/mfe/vite/test-app/node_modules/vite/dist/node/chunks/dep-59dc6e00.js:38900:30 ) at async dotransform ( /users/cjones26/mfe/vite/test-app/node_modules/vite/dist/node/chunks/dep-59dc6e00.js:55857:29 )
in a fairly common setup , i have a single entry point for js code in html : the idea is to use nonces for strict csp , substituting value of nonce_placeholder each time a server ( nginx in my case ) serves index.html . however , generated html file loses nonce attribute in relevant < script > and < link > tags : desired result is : is there a regular way to achieve that with vite ? ( right now i have to resort to injecting nonce attribute with html-transform plugin . plugin has to know about implementation details of what do tags generated by vite look like . this is fragile so i 'm looking for a more proper way ) < code > < script type= '' module '' crossorigin src= '' /assets/index.3472c4ab.js '' > < /script > < link rel= '' modulepreload '' href= '' /assets/vendor.70b67224.js '' > < script type= '' module '' src= '' /src/index.tsx '' nonce= '' nonce_placeholder '' > < /script > < script type= '' module '' crossorigin nonce= '' nonce_placeholder '' src= '' /assets/index.3472c4ab.js '' > < /script > < link rel= '' modulepreload '' nonce= '' nonce_placeholder '' href= '' /assets/vendor.70b67224.js '' >
i 'm wondering if its possible to explicitly configure vite to use a tsconfig file of my choosing ? i 've looked through the docs and ca n't find any information in the config api for being able to specify this explicitly . when working with nx dev tools it is standard to compose your ts settings across multiple files with tsconfig.app.json being the actual entry point that matters for serving/building the application . i 'd like to be able to update vite to leverage the configuration defined in tsconfig.app.json instead of automatically picking up tsconfig.json < code >
i 'm concerned whether the whole cjs compact layer is worth it . i 'd say : let 's rip the band aid off . there are enough examples of esm-only environments ( e.g . sveltekit ) showing it 's possible and , more importantly , worth it to go for esm-only . if we go for esm-only in 12 months with vite 4 , that 's 12 more months carrying the whole cjs baggage around . it slows us down . at the end of the day , i see vite becoming a better tool if we drop cjs with vite 3 already , because we 'll be able to focus on higher priority things than cjs support . @ patak-dev @ antfu < code >
because we are mixed development , embedded h5 page , open using file protocol , and vite must be http protocol to request , how to solve this < code >
tl ; dr i would like to run domo dev in the directory created by npm run serve in my vite project . how can i find it ? i am working on a project that uses the domo app dev studio cli which is great for vanilla js development , but is terrible for using vue . i have tried finding documentation on how i could use their ryuu proxy service but either the documentation is not good , or i just do n't understand it . ( i 'm leaning toward the former , based on experience with domo 's documentation ... ) i have come to the conclusion that the easiest way to make things work is to invoke domo 's dev server in the directory that has the processed files . for example , if i run domo dev in the root project directory , it fails due to it not understanding how to process * .vue files . if i run domo dev in the /dist directory after npm run build , it loads fine , but without hmr . what i would like to do is to run domo dev in whatever directory is generated by using npm run serve in my vite project . where can i find this ? < code >
i understand using .js instead of .jsx extension will not yield optimal performance as it 'll go through unnecessary ast transformation , but it 's a trade-off i 'm willing to sacrifice . another reason vscode intellisense does n't recognize index.jsx . this means intellisense on the following does n't work : where home 's full path is to make intellisense work , i have to do : so , i think we should give developers the choice to opt-in the usage of .js in vitejs . how to make it happen ? thanks ! < code > components/home/index.jsx components/home/index.js import home from 'components/home '
apologies in advance if this has been mentioned elsewhere but i could n't find anything related . when i run the vite cli command in my terminal , i then have to either click the < url > link in the terminal or manually type out the localhost url in the browser . is there a config option or flag or anyway that will have vite automatically open localhost in my browser when i run vite in the cli ? for reference , i 'm on vite v2.9.6 currently . < code >
i have a single web worker like so : this works great . but as soon as i introduce a second web worker , the build fails : this should work , right ? it works in dev , but as soon as i try to build i get the error above . < code > import someworker from './workers/someworker.js ? worker ' ; import someotherworker from './workers/someotherworker.js ? worker ' ; worker = comlink.wrap ( new someworker ( ) ) ; worker.dosomework ( ) ; otherworker= comlink.wrap ( new someotherworker ( ) ) ; otherworker.dosomework ( ) ; import someworker from './workers/someworker.js ? worker worker = comlink.wrap ( new someworker ( ) ) ; worker.dosomework ( ) ; vite v2.9.9 building for production ... 06:22:12 36 modules transformed . 06:22:16 43 modules transformed . 06:22:17 error unexpected early exit . this happens when promises returned by plugins can not resolve . unfinished hook action ( s ) on exit : ( vite : worker ) transform `` /path/to/someotherworker.js ? worker '' error error during build : 06:22:19 error : unexpected early exit . this happens when promises returned by plugins can not resolve . unfinished hook action ( s ) on exit : ( vite : worker ) transform `` /path/to/someotherworker.js ? worker '' at eventemitter.handleemptyeventloop ( ode_modules ollup\dist\shared ollup.js:23169:20 ) at object.oncewrapper ( node : events:509:28 ) at eventemitter.emit ( node : events:402:35 ) at process. < anonymous > ( ode_modules ollup\dist\shared ollup.js:23163:55 ) at process.emit ( node : events:390:28 )
i have a strange problem using vite in vue 3 monorepo setup . i have several locally builded as library and linked to main app dependencies . libraries are in commonjs format , with custom tsconfigs , package.json and other staff . while serving main app there is no hmr updates . what i 'm doing wrong ? googled all over internet , but no luck < code >
previously , when you run `` npm run dev '' it showed something like : local : < url > network : phofurl now , there is no network address but : network : use -- host to expose how do you get it to work ? and why remove such a feature ? < code >
i 've read several discussions on how to shim nodejs modules such as buffer and crypto , but so far i 've never been able to fix the error referenceerror : ca n't find variable : buffer . i tried using several rollup plugins . the last one i used is rollup-plugin-polyfill-node , but i still get the error . i tried defining it in the vite config , but then i get this error : typeerror : undefined is not an object ( evaluating 'buffer.from ' ) . i tried this # 2785 , but still it 's not working . i 'm lost right now . is there any way to make it work ? btw i 'm using web3 , so i ca n't drop this dependency . < code >
i 'm trying to use vuetify 2 in a vue 2 project , with vite 2.9.9. when i run vite , while it 's running it outputs : vite error , < omitted > /node_modules/.vite/deps/vuetify_lib.js ? v=cd582479 optimized info should be defined ( x1042 ) not entirely familiar with vite 's new pre-bundling behaviour as of 2.9.0 , but it does n't seem to play well with vuetify . has anyone run into this or have any insight on what to do about this ? < code >
problem i am trying to append entry js files in body without writing html-plugin because i do n't want to override default behaviour . question is there any way to do that ? < code >
describe the bug when i do build lib with config `` rollupoptions.output.banner '' , why i found three different effects , and the code is error for umd the banner like this : reproduction reproduction system info used package manager yarn logs no response validations follow our code of conduct read the contributing guidelines . read the docs . check that there is n't already an issue that reports the same bug to avoid creating a duplicate . make sure this is a vite issue and not a framework-specific issue . for example , if it 's a vue sfc related bug , it should likely be reported to < url > instead . check that this is a concrete bug . for q & a open a github discussion or join our discord chat server . the provided reproduction is a minimal reproducible example of the bug . < code > const banner = '// / * ! * -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- * < cur > { pkg.name } v < cur > { pkg.version } * ( c ) < cur > { new date ( ) .getfullyear ( ) } @ < cur > { pkg.author.name } . * released under the < cur > { pkg.license } license . * -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- - ! * /// ' ; vite2 vue3 ts
i am trying to optimize my bundle size ( using bundle-buddy ) . to achieve this , i need to obtain the metafile from esbuild . how can i access this file ? adding metafile to the build options in my vite.config.js unfortunately does not produce this file : adding metafile to the esbuild options produces an error ( error : invalid option in transform ( ) call : `` metafile '' ) : < code > defineconfig ( { esbuild : { metafile : 'meta.json ' } } ) defineconfig ( { build : { metafile : 'meta.json ' } } ) ;
i 'm working on a plugin that deals with hmr and i have a question about the update interface : what 's the difference between path and acceptedpath ? vite/packages/vite/types/hmrpayload.d.ts lines 18 to 23 in eb66b43 export interface update { type : 'js-update ' | 'css-update ' path : string acceptedpath : string timestamp : number } from my experimentation , they have the same value , but i 'm sure that 's not always the case . < code >
i have a problem with production build . while dev env is working perfectly , production 's build tree shaking somehow removes side effect of external library . let me explain . in current project we have internal component library ( lets name it our-lib @ 1.0.0 ) which is developed with rollup . inside this component library we are also using external libs like , ie . react-draft-wysiwyg . unfortunately we had to override some styles of this wysiwyg lib . we do it something like that : file : richtexteditor.css in project i want to use this customized component so i am doing import richtexteditor from 'our-lib ' ; . run dev env and everything is good , styles are ok. problem is when production build is generated . it does not contain .rdw-option-wrapper class for example ( and entire all from richtexteditor.css ) i bet this is because vite somehow cut out side effect which looks like this ( node_modules/our-lib/richtexteditor/richtexteditor.css.js ) whole file is removed in production build and styleinject is never called . please help bonus , after digging , setting build.rollupoptions.treeshake : false causes that styles are injected but you now ... build size < code > @ import '~react-draft-wysiwyg/dist/react-draft-wysiwyg.css ' ; .rdw-option-wrapper { background : transparent ; border : 0 ; } etc .... import { editor } from 'react-draft-wysiwyg ' ; ... import styles from './richtexteditor.module.scss ' ; import './richtexteditor.css ' // here is override global react-draft-wysiwyg
hello , i am using the library photoswipe js for a photo gallery . in my html i have the following structure : and in the main.js : const imagesphotoswipe = import.meta.globeager ( ' .. /images/photoswipe/ * .jpg ' ) as you can see i created a workaround for photoswipe images . indeed , they are not detected by vite in the anchor tag of my html . for now i have to run a build , get the hash of every images and place them in the html raw which is not optimal . in addition , i added a small js line to manually import thoses images in the asset folder when building . i would like vite js to detect my images in the anchor tag and import them in the asset folder when building the app like it would do with a src or srcset tag . if you have some insights or something that can be less time consuming that copying hash ( i 'd like to keep them however ) it would be so nice 🧐 thank you very much in advance 🙏 benjamin < code > < a class= '' grid-item portrait '' href= '' ./assets/103-big.37cdaafd.jpg '' data-pswp-width= '' 1036 '' data-pswp-height= '' 1554 '' target= '' _blank '' > < picture > < source type= '' image/webp '' srcset= '' ./images/gallery-page/103-small.webp '' > < source type= '' image/jpeg '' srcset= '' ./images/gallery-page/103-small.jpg '' > < img src= '' ./images/gallery-page/103-small.jpg '' width= '' 518 '' height= '' 777 '' alt= '' some title '' > < /picture > < /a >
describe the bug i konw mybe the error do n't come from vite . i can run vite project in my old m1 air book . but the error happened in the m1 pro . have someone know how to solve it ? thank you ! environment issue when i see the eror description , i find this : is vite use this package ? maybe the package have some eror . < code >
i do n't have a normal setup and use django to load i 'm using the following config to make this work : unfortunately , i have a library that assumes process.env is available in the browser . how can i get define or process.env working with this setup ? < code > < script type= '' module '' src= '' < url > export default defineconfig ( { define : { 'process.env ' : process.env } , build : { manifest : true , rollupoptions : { input : 'src/main.tsx ' , } , } , // snip } ) ;
hi everyone , i 'm trying to load the page built with vite into an iframe ( i do n't have control over this iframe ) . into the console i get this error : failed to execute 'postmessage ' on 'domwindow ' : the target origin provided ( `` ) does not match the recipient window 's origin ( 'null ' ) . plus , i have a lot of cors policy errors . anyone knows how to load the page into iframe skipping those errors ? thank you all < code >
hello , i 'm preparing vue component library as a single npm package . docs have section for lib mode : < url > but typescript instructions seems to be missing ( type generation ) . can you provide some examples on such case ? < code >
hello , i have build a library that can be deployed across multiple servers . at build i do not know those servers urls . the library is referenced from another apps/pages buy adding < script src= '' phofurl - in such case all imports within my lib should be loaded from some-sever/lib/ path . have migrated lib code from webpack to vite and i 'm struggling to mimic __webpack_public_path__ behaviour . in webpack i was able to set < url > at runtime . in vite i 've been trying to use < url > especially import.meta.env.base_url - but setting it at runtime seems to have not effect . do you have any idea how to solve this problem ? < code >
can anyone confirm that chrome v100 will ( or will not ) auto-refresh on save with vite v.2.9.1 ? i just upgraded chrome to v100 ( according to caniuse , v100 has only about a 0.2 % penetration ) and auto page refresh stopped working . however , after rolling vite back to v2.8.6 , auto-refresh works just fine . v2.8.6 terminal shows : 7:31:57 am [ vite ] page reload wide-page-layout.html ( x5 ) v.2.9.1 terminal shows : 6:51:10 am [ vite ] hmr update /wide-page-layout.html ? html-proxy & index=0.css ( x5 ) this is a vanilla js html css project ( but uses tailwinds and post-css ) . however , just editing the html content does not cause chrome to refresh so i doubt this is a tailwind issue . < code >
clear and concise description of the problem currently there is no way to specify an entry file that is not named index.html . a separate file is sometimes needed since say an index.prod.html file , which is for production deployment , may contain things like google analytics , that the staging env index.html may not contain . suggested solution add an option to build object to specify alternate index.html file for input . the output should still rename it to index.html , but the input filename should be able to be user specified . alternative additional context < code >
i have a question about server.proxy in vite.config.ts . if there is no server process listening on the proxied port vite returns the following error in the console , but the browser request does not change from pending . for create react app 's http-proxy-middleware , it returns a 504 error . is this behavior normal for vite ? i would like to resolve this issue in order to change from cra to vite . please reply . console browser network when a proxy error econnrefused occurs , it does not change from penging . setting proxy.timeout changes it to failed , but what is expected is a 504 error vite.config.ts version of service used < code > error 0:20:38 [ vite ] http proxy error : 00:20:38 error : connect econnrefused xxx.xxx.xxx.xxx:9008 at tcpconnectwrap.afterconnect [ as oncomplete ] ( node : net:1157:16 ) ( x4 ) server : { proxy : { '/foo ' : { target : < url > , changeorigin : true , rewrite : ( path ) = > path.replace ( /^\/foo/ , `` ) , } , } , } , node.js : v16.14.2 npm : 8.5.0 vite : ^2.9.0 react : ^17.0.2
hello , i did n't want to open an issue because i do n't if it 's really a bug or if it 's the intended behaviour . i 'm using the guide for backend integration and i 've noticed that when we delete the index.html in the vite root directory , the vite development server does n't serve the @ vite/client script anymore . the source files are still served . here is the vite.config.js modified from the react template to take the javascript as entry point instead of the html . with this configuration , everything is built successfully . when the development server is running , we can successfully access < url > for example but not < url > because i use vite for serving only scripts for development , i do n't care about the index.html so i deleted it and from that moment , < url > returns a 404. this problem appears since vite 2.0.2. the @ vite/client was correctly served in 2.0.1 even without any html file in the vite root folder . < code > import { defineconfig } from 'vite ' import reactrefresh from ' @ vitejs/plugin-react-refresh ' export default defineconfig ( { build : { assetsdir : './ ' , manifest : true , rollupoptions : { input : './src/main.jsx ' , } , } , plugins : [ reactrefresh ( ) ] } )
i am only talking about the default values here . i know the hmr url can be customized in config . the current hmr url is composed as protocol : //host : port . the protocol seems to be dynamically determined at frontend , but the port is hard-coded to the port passed to the dev server . i wonder if it makes sense to let the port be dynamically determined as well ? the current default is broken in case the dev server sits behind a reverse proxy , where the port passed to the dev server does not neccessarily match the external port . related # 7849 < code >
i have an app ( laravel php ) running at < url > which loads it 's assets from a vite 's devserver which is up at < url > cypress is hitting the main app correctly , but it does n't load the assets , leaving me with a blank page because the page received no response for the < url > file . everything works fine if i visit the app directly on the browser . the browser is able to load the assets from port 3000 without problems . they 're only failing when requested via the cypress test runner . i tried to cy.visit ( ' < url > ) and it seems like the vite 's devserver is refusing connections . but i checked the vite documentation to see if there was something that could be blocking this and nothing caught my eyes . also , the strange part is that they 're only blocked when requested via the test runner . i 'm running cypress on wsl2 and my app and the vite devserver are running through docker mapping to the addresses above . is there any additional configuration i 'm missing ? if i build the assets and serve them from the main app address ( < url > ) , everything works fine and my tests run fine . so , i 'm guessing there 's some sort of configuration i need to do to allow vite to deliver the assets ? < code >
in webpack , we can use providerplugin to import jquery in webpackage.config file . like this : now use vite2 , how to do that . ( i do n't want to import jquery file in html , i want build all file in a single js file ) ; < code > new webpack.provideplugin ( { < cur > : 'jquery ' , jquery : 'jquery ' } )
my project has been developed for almost 4 years , there are thounds of .js files which contain jsx syntax.it used webpack as building tool , now i want to use vite instead.but encounter this error : failed to parse source for import analysis because the content contains invalid js syntax . if you are using jsx , make sure to name the file with the .jsx or .tsx extension . when i search solutions for this issue , there seems two way : 1.replace .js to .jsx . 2.use < script lang='jsx ' > . but all of them do n't meet my command.i just have to use .js as suffix.anyone has any solution ? < code >
i have introduced a third-party dependency , this dependency introduces relative path css like this : import s from './s.modules.scss ' ; dependent css does not take effect , how should i configure the vite.config.js file ? < code >
i use the latest vite . and the following is invalid syntax from eslint : but this file can be bundled normally . any way to solve this ? < code > class foo { static bar = 1 }
hello , i am trying to import csv from assets folder into my js file : but i get back an error : uncaught syntaxerror : the requested module '/src/assets/sixcontinentfirst.csv ? import ' does not provide an export named 'default ' if i try to just pass path like this without importing : i get 404 not found error . here is how my csv file looks : < code > import continentscsv from ' .. / .. /assets/sixcontinentfirst.csv ' import * as d3 from 'd3 ' useeffect ( ( ) = > { d3.csv ( continentscsv ) .then ( data = > console.log ( data ) ) } , [ ] ) dates , africa , asia , europe , north-america , oceania , south-america , grand-total jan-20,0,9333,17,11,9,0,9370 feb-20,3,73839,1485,50,17,4,75398 mar-20,5764,96833,454715,207358,5238,14507,784415 apr-20,32993,342990,931818,964294,3085,165773 , < phone > may-20,108124,618468,604273,849767,465,725850 , < phone > useeffect ( ( ) = > { d3.csv ( ' .. / .. /assets/sixcontinentfirst.csv ' ) .then ( data = > console.log ( data ) ) } , [ ] )
helloworld.vue foo.js the browser console error : uncaught syntaxerror : the requested module '/src/components/foo.js ' does not provide an export named 'foo ' . anyway to solve this ? if i do n't want to use esm syntax in foo.js < code > module.exports = { foo ( ) { } } < script setup > import { foo } from './foo.js ' < /script >
css-module compose options requires relative import . .filterbutton { composes : root_lowpriority from ' .. / .. / .. /packages/framework/components/button/button.module.css ' ; min-width : 6.25rem ; } postcss-import is also not working how to configure vite use css module composes from relative to node_modules ? < code >
i 've a simple react project which i 've just migrated to vite . now it works fine with the development environment and all . but the issue is when i try to generate a static build . it creates a build in build/dist folder , wherever i want to . but it does n't trigger the github-pages ci/cd anymore . after every successful pipeline , it used to trigger another action by bot : but now it does n't trigger that gh-pages workflow anymore : why is it because it 's not overriding the target directory ? i 'm all confused out here . can anyone investigate and let me know , what 's happening ? my pipeline is simple as hell ( pasted only relevant portion , full pipeline : < url > ) : full source : < url > < code > - name : 'build ' run : yarn build # -- if-present - name : 'deploy ' uses : peaceiris/actions-gh-pages @ v3 with : deploy_key : < cur > { { secrets.actions_deploy_key } } publish_dir : ./build
how do you configure the vite dev server to work over a reverse proxy like ngrok ? i 'm not getting a hmr connection , causing my react app to keep reloading every few seconds which renders it practically unusable . i need to use ngrok to develop an app for a secondary device over a restricted network . running vite starts a dev server on port 3000 , and running ngrok http 3000 exposes this over the internet . i have a paid ngrok plan , so i can set a fixed -- subdomain as well , though i imagine many vite users rely on the free ngrok plan . i 've read several unresolved github issues that relate to this topic ( # 3093 , # 4259 , # 4463 ) and i get the impression that some users have found a way to make this work , though i have yet to find a clear set of working instructions . i 've tried fiddling with the vite config ( e.g . setting my tunnel 's domain as the server.hmr.host option ) to no avail . < code >
i 'm writing an image viewer application , where the images are static assets in the public/gallery directory . the content of this directory is provided externally and the bundler should not care what 's in there . how can i make sure that the build step does not copy all the images in the public/gallery directory ? < code >
i am trying to understand why certain chunks include the packages that they do . the way i am doing this is that i set the entry point to a route , e.g . i would expect that the resulting bundle only includes what that is needed to load profileprojects ( or at least not more than what is needed ) . i am using rollup-plugin-visualizer which gives me an output as such : how do i go from this to understanding why lodash was included ? < code > rollupoptions : { input : path.resolve ( __dirname , 'src/features/profile/pages/profileprojects.page.tsx ' ) , }
clear and concise description of the problem hi , currently i create the json file called cbt.json and put it inside public folder which is imported like this : example of cbt.json ( this json file will update many times manually ) : when run npm run build the output folder contain cbt.json but the bundle js file does not load this cbt.json but it got hardcode inside js file : because it hardcore like this if i modify cbt.json , the code wo n't affect , can help ? suggested solution i 'm not sure alternative import json file dynamically instead hardcode when build additional context no response validations follow our code of conduct read the contributing guidelines . read the docs . check that there is n't already an issue that request the same feature to avoid creating a duplicate . < code >
hey , i 'm using vite with vue 3 and i would like to build every javascript files in a single .js file , is there a way to do it ? < code >
describe the bug reproduction < url > system info used package manager yarn logs no response validations follow our code of conduct read the contributing guidelines . read the docs . check that there is n't already an issue that reports the same bug to avoid creating a duplicate . make sure this is a vite issue and not a framework-specific issue . for example , if it 's a vue sfc related bug , it should likely be reported to < url > instead . check that this is a concrete bug . for q & a open a github discussion or join our discord chat server . the provided reproduction is a minimal reproducible example of the bug . < code > // scss : export { sidebarwidth : < cur > sidebar-width ; } // js import { .sidebarwidth } from './scss ' // error system : os : macos 12.3.1 cpu : ( 8 ) x64 apple m1 pro memory : 29.93 mb / 16.00 gb shell : 5.8 - /bin/zsh binaries : node : 14.19.1 - /usr/local/bin/node yarn : 1.22.18 - /usr/local/bin/yarn npm : 8.7.0 - /opt/homebrew/bin/npm browsers : edge : 101.0.1210.47 safari : 15.4 npmpackages : @ vitejs/plugin-legacy : ^1.8.2 = > 1.8.2 vite : ^2.9.9 = > 2.9.9
i 'm asking this because i have an interesting scenario that i do n't know how to debug , so my situation is i have a github actions that build my project on push to develop/main , and the chucks ' hashes keep the same between builds/ci runs but then when i build the project to deploy it to heroku , in the heroku ci it get 's generated different hashes every time this is happend only for js files , reading vite codebase i found that vite : asset generate hash based on the content , i 'm wondering what about .js files 🤔 < code >
i use to vite to : build my website build a script that people can reference to transparently integrate a module on their site ( think iframe with extra features ) . it uses vite library mode currently i have to use two different vite config : website and external script . these 2 distincts configs introduce some complexity ( slightly harder to launch the two build in dev or production mode , maybe some issues with vite internal cache reset when a change is detected on the config ) , and i wonder if i could simplify it . it 's already possible to have multiple entry points on a vite config , but as far as i know all of them have to be in library mode or not . it is n't possible to generate at the same time a script in library mode and a website alongside . any idea to solve this ? < code >
vite.config.js =============================== i want to use esbuild to build , because because esbuild so faster then terser , but how can i remove console.log , use esbuild < code > export default defineconfig ( { base : './ ' , build : { sourcemap : false , minify : 'esbuild ' , // minify : 'terser ' , // terseroptions : { // compress : { // warnings : false , // drop_console : true , // drop_debugger : true , // pure_funcs : [ 'console.log ' ] // } // } } } )
i 'm using the tone library , librray written in typescript which builds esm modules with sourcemaps . debugging the library works very well with webpack or snowpack , but when i use it with vite i get the following unexpected behaviour : i do import * as tone from tone ' inside my js module in dev mode vite transforms tone into a single js file under the .vite cache folder i set a breakpoint at a line of my code which calls tone code the sourcemap inside tone esm js modules make the browser step into what looks like the original source code , e.g . < url > to my workspace > /node_modules/tone/tone/event/toneevent.ts of course these typescript must be converted again to js , and vite does it . so what apparently is the original typescript file is instead the trasnformed version of it , with different rows and columns . step debugging does n't work anymore since the debugger goes to positions that do n't exist in the transformed file . the only solution for me was to rebuild the tone library without its own sourcemaps . this way the browser and vite do n't try to load and convert the original typescripts . is there a way to tell vite to not consider the sourcemaps for typescript sources from dependencies ? < code >
describe the bug i have a problem with debugging on visual studio code/webstorm . when i attached a breakpoint it is placed with prefix `` /localhost:3000 '' and when breakpoint is running , redirects me to wrong file ( its read-only ) in vsc launch.json : reproduction < url > system info used package manager npm logs no response validations follow our code of conduct read the contributing guidelines . read the docs . check that there is n't already an issue that reports the same bug to avoid creating a duplicate . make sure this is a vite issue and not a framework-specific issue . for example , if it 's a vue sfc related bug , it should likely be reported to < url > instead . check that this is a concrete bug . for q & a open a github discussion or join our discord chat server . the provided reproduction is a minimal reproducible example of the bug . < code > system : os : macos 11.6.2 cpu : ( 4 ) x64 intel ( r ) core ( tm ) i5-5675c cpu @ 3.10ghz memory : 1.51 gb / 16.00 gb shell : 5.8 - /bin/zsh binaries : node : 16.13.0 - /var/folders/s5/syp7yzj56xd7nvwvpbb4ydph0000gn/t/fnm_multishells/47984_1643329563258/bin/node npm : 8.1.0 - /var/folders/s5/syp7yzj56xd7nvwvpbb4ydph0000gn/t/fnm_multishells/47984_1643329563258/bin/npm browsers : brave browser : 97.1.34.80 chrome : 97.0.4692.99 safari : 15.2 { `` version '' : `` 0.2.0 '' , `` configurations '' : [ { `` type '' : `` pwa-chrome '' , `` request '' : `` launch '' , `` name '' : `` chrome '' , `` url '' : `` < url > '' , `` webroot '' : `` < cur > { workspacefolder } '' } ] }
hello all , vite build -- help explains the sourcemap option is a boolean , however i 'd like to set it to `` hidden '' as is described in the docs . is this possible and just not documented . any suggestions very much welcome . thanks < code >
i 'm writing a plugin and i 'd like to log a message to the terminal when transforming a file in vite dev . beneath here where other logs go ... working from the example below ... within the transform function , putting a console.log ( `` test1 '' ) does n't work . i 've also tried config.logger.info ( `` test2 '' ) but that doesnt work either . both work when doing a vite build though < url > i do n't see anything about this in the docs , seeking any tips < code > const exampleplugin = ( ) = > { let config return { name : `` read-config '' , configresolved ( resolvedconfig ) { // store the resolved config config = resolvedconfig } , // use stored config in other hooks transform ( code , id ) { // // doesnt work in dev // console.log ( `` test1 '' ) // // doesnt work in dev // config.logger.info ( `` test2 '' ) if ( config.command === `` serve '' ) { // dev : plugin invoked by dev server } else { // build : plugin invoked by rollup } } } }
i can get it in main.ts but it can not be obtained in the code under node_modules why is this happening ? is there a way to get import.meta under node_modules ? < code >
i 'm doing this in my component : eslint/vscode/everything else all see this import and the types work fine . when i run vite build everything is fine - no errors . when i try to run vite though i get : the buefy/types/components.d.ts file exists in node_modules/ and the bmodalcomponent class exists within it . i 've tried with vite 2.9.8 as well - same problem . i 'm using vue2 & the `` vite-plugin-vue2 '' package . the buefy import is the only thing it complains about . all other imports ( and my other apps using the same setup ) work fine . this was working for weeks , then i deleted & recreated my node_modules directory and now it no longer works . ( using the same package.json & lock file . ) for reference , here 's components.d.ts from buefy . does anyone have any ideas ? < code > my-app | vite v2.9.5 dev server running at : my-app | my-app | > local : < url > my-app | > network : < url > my-app | my-app | ready in 2753ms . my-app | my-app | the following dependencies are imported but could not be resolved : my-app | my-app | buefy/types/components ( imported by /usr/src/my-app/src/components/foo.vue ? id=0 ) my-app | my-app | are they installed ? < script lang= '' ts '' > import vue , { proptype } from 'vue ' import { bmodalcomponent } from 'buefy/types/components ' ...
hi everyone , i recently started using vite for vanilla js projects since it 's extremely powerful tool for optimization in production . i use vanilla js for mostly simple landing page designs , etc . the main issue that arises when working with html files is that a single file gets bloated with html tags and it would be extremely convenient to have the file split up into multiple files and include them in to the main file . i would like to know whether there is an option to include html files inside html files in vite ? < code >
hey there , i 'm migrating from cra to vite and i was wondering what the best way is to run eslint with typescript ? is there a plugin or should i just set it up manually ? < code >
i 've been trying to search for a solution but i could n't find anything relevant at all . i 'm migrating cra-bootsrapped app to vite so far it has been nice : dev server runs ok vite build runs ok - vite build but then when i run vite preview after the build , - when i open the default < url > the browser tries to load the app , but then it immediately redirects to blob : < url > and the # root ( or # app ) < div > is empty when inspecting element . so it looks like the js does n't even eject or start working . reproducable : browsers : chrome/firefox operating system : ubuntu any ideas what 's this ? is this an issue in vite preview config , or paths , or what it could be ? when using npx vite preview dist/ the browser does n't even do anything , just prints : can not get / vite.config.ts folder structure : root/index.html root/dist/ ... buildfiles root/vite.config.ts < code > export default defineconfig ( { resolve : { alias : { process : 'process/browser ' , stream : 'stream-browserify ' , zlib : 'browserify-zlib ' , util : 'util ' } } , server : { port : 3000 } , plugins : [ react ( { include : ' * * / * . { jsx , tsx } ' } ) , { ... polyfillnode ( ) , enforce : 'post ' } , tsconfigpaths ( ) ] , build : { sourcemap : false } } ) ;
every so often , i get some http 504 after starting up vite . by killing vite and restarting ( sometimes 2-3 times ) , the error goes away . no changes in package.json , lock files or anything . it is always the same packages . anything that could explain this behavior ? it is livable , but also quite annoying for the entire team . have been seeing this for the last 8 months . has been going on since vite 2.6. now on 2.9.1 packages : tcomb , day.js < code >
i had a day long debugging session to get to the bottom of why hmr was not working in my app , and it turns out a simple export const foo = 12 at the ( almost- ) top-level component was enough to break hmr . while that was the reason , i do not understand why it is so . could someone explain this to me ? background discussion background with minmally reproducible case : < url > the single line needed to screw up hmr : fatso83/break-vite-hmr-with-export @ e3159d5 # diff-26ad4b834941d9b19ebf9db8082bd202aaf72ea0ddea85f5a8a0cb3c729cc6f2r7 edit : got a tips on where to look for clues in discord < code >
when making a production build of a react project with vite , the speed is n't as fast as i expected with esbuild . is it using babel or esbuild ? < code >
in a production ( rollup ) build , i understand why it 's necessary to tell rollup which files should be looked at for each dynamic import call that relies on variables ( since they have to be bundled in ) , but it would be nice if in development ( esbuild ) builds you could skip pre-bundling dynamic import candidate modules entirely and just load them completely on demand from the filesystem , when they 're requested . for example with an import call like import ( variable ) where variable would be /home/user/code/foo/bar.ts , the bar.ts module would n't be bundled in at all in a development build , but imported on demand from the file system , when the dynamic import is first executed . is this possible ? < code >
as above , second argument has no member vitemetadata , i have to assert it as any type . < code > renderchunk ( code , chunk ) { if ( chunk.filename.endswith ( '.js ' ) & & chunk.isdynamicentry & & ( chunk as any ) .vitemetadata ) { // ... } return undefined } ,
i have the case that there is not one entry point for the library . there are several relatively independent js modules . in this library , there is also no bundling or minify what is expected behaviour for my case . in order to be able to specify all of them as entry points , i have solved this as follows : idea : for a library that does not have a direct entry point but several individual js modules , it would be practical to be able to specify the lib entry as a folder . if it is a folder , it should then include all files , for example , with the extension * .js , * .html , * .css as entrypoints . the configuration remains the same , but a distinction is made between folder and file . < code > import path from `` path '' ; import glob from `` glob '' ; export default { build : { outdir : path.resolve ( __dirname , `` build '' ) , emptyoutdir : true , csscodesplit : true , lib : { entry : path.resolve ( __dirname , `` src/index.js '' ) , formats : [ `` esm '' ] } , rollupoptions : { input : glob.sync ( path.resolve ( __dirname , `` src/ * * / * . { js , css } '' ) ) , output : { preservemodules : true , preservemodulesroot : `` src '' , entryfilenames : ( { name : filename } ) = > { return ' < cur > { filename } .js ' } } } } }
hey ! im building a vue3 app using vite . im having trouble getting my imported style files built . im importing these in the style section of the component . the styles are included but arent compiled from scss into css . i have some global styles included globally using the preprocessoroptions which works . i do have sass installed . any ideas on how i can make sure imported style files get built before imported in the component ? < code >
currently i 'm having problems importing canvaskit-wasm ( aka google skia ) into my project and getting the wasm file . in canvaskit 's documentation it shows that when in development mode/watch mode , vitejs seems to change the import name of canvaskitinit to canvaskitinit2 which seems to be completely wrong . currently i 'm bypassing this by doing something like this . second , i 'm having problems trying to load in the wasm file since the wasm file is in the node_modules directory . how would i go about getting this wasm file recognized in my code ? < code > import * as canvaskitinit from 'canvaskit-wasm ' import type { canvaskit } from 'canvaskit-wasm ' // @ ts-ignore : import above is broken let canvaskit : canvaskit = await canvaskitinit ( { locatefile : ( file ) = > { return '/node_modules/canvaskit-wasm/bin/ ' + file } } )
i have an example stackblitz : < url > in this example , i write a simple plugin to rewrite a pure css to .module.css to enable css modules for plain css files . after this rewrite , it seems when i update style.css , such as change color from green to red , no hot update happen , i 've tried to invoke this.addwatchfile without any luck , in handlehotupdate function the context.modules is an empty array . it seems i need to figure out a way to establish the relationship between my virtual module style.module.css and the actual file style.css , but do n't know how to archive that . < code >
hi , i want to use vite with django . below a dummy entrypoint main.js : in development it works , but not in production because export is removed . if i use the library mode then export is kept , but style.css is not included in the manifest , and the filenames do n't include the hash . the idea is to use it as a library , but only internal to the project , so i can call the exported functions , components , etc . from anywhere in the django generated html . the html would look something like : how this can be done with vite ? < code > < script type= '' module '' > import { hello } from '/static/main.d7465693.js ' ; hello ( 'world ' ) ; < /script > function hello ( name ) { console.log ( 'hello ' , name ) ; } export { hello }
hi , for the dev mode , i am using babel for transpiling typescript and not esbuild which is turned off inside vite.config . in that case all sourcemaps ( `` sources '' : [ `` app.ts '' ] ) does not contains any path as they have when esbuild is used . it seems that default rollup sourcemappathtransform is used ( exactly the same sourcemap output ) . the question is how could i change/set custom sourcemappathtransform for vite ? e.g . < code > sourcemappathtransform : ( relativesourcepath , sourcemappath ) = > { // will replace relative paths with absolute paths return path.resolve ( path.dirname ( sourcemappath ) , relativesourcepath ) ; } ,
i am using and importing msw library in my code as an es module in development mode & i am using import.meta.env.dev to include this in just development . but when i am building for production this library is also included in the build output . so how to exclude this code from build output ? < code >
i have an import in a .less file that looks like this : when i spin up vite , i get this error : so basically , it 's treating the url as the name of a local file . i assume this is just a setting i need to set for less in the vite config , so i did n't log this as a bug . has anyone else run into this issue ? thanks . < code > @ import url ( ' < url > ) ; [ vite ] internal server error : enoent : no such file or directory , open '/home/suneel/code/ ... /src/https : /fonts.googleapis.com/css2 ? family=cabin : wght @ 400 ; 700 & family=roboto : wght @ 400 ; 700 & display=swap ' plugin : vite : css file : /home/suneel/code/ ... /src/app/global.less 117| / * theme * / 118| //fonts 119| @ import './assets/fonts/style.less ' ; | ^ 120| @ import url ( ' < url > ) ; 121| @ font-proxima : 'proximanova ' ; at less ( /home/suneel/code/ ... /node_modules/vite/dist/node/chunks/dep-e0fe87f8.js:20596:33 ) ( x4 )
i recently moved from create-react-app to vite . everything is working perfectly in dev server but when i build for production with vite my styles are all messed up it seems they are n't applied properly . so , is there any extra config needed to make styled-component work . in cra i used babel and babel-plugin-styled-components maybe that is an issue ? since vite does n't use babel < code >
hi , i 'm using the very useful `` library mode '' because i 'm creating a web-component . i 'm using index.html file as documentation page . the build command gives me the es/umd files , exports some of the css/js files referenced in the index.html , but not the index.html file itself . would be nice to export things like when we do n't use library mode . ( i 'm very new to vitejs , maybe i 'm completly missing a point ) < code >
when running npm run build and afterwards npm run preview the preview starts with preconfigured localhost:5000 but when you want to see it in the browser it responds with http status code 403 : this happens for google chrome , safari and brave . for firefox it works . when you change the port like vite preview -- port 5001 then it works . i checked everything . i do n't have anything running on port 5000. and i never had that issue before . is anybody else experiencing the same issue ? device : macbook pro ( 13-inch , m1 , 2020 ) macos monterey version 12.1 tested browsers : google chrome version 97.0.4692.71 ( offizieller build ) ( arm64 ) safari version 15.2 ( 17612.3.6.1.6 ) firefox 95.0.2 ( 64-bit ) brave browser version 1.34.80 chromium : 97.0.4692.71 ( offizieller build ) ( arm64 ) < code >
so i was looking for some way that allows me to create html files from some other extension ( for example .ejs ) for example , let 's say i have this project- now here i do n't have any index.html file . there is index.ejs file that needs some transformations to become index.html . i could 've used transformindexhtml hook but it specifically gets called on .html extension . if i use transform then vite generates a javascript file instead of html . < code > - index.ejs - main.js - vite.config.js
in the why vite page , we can read : over time we have seen tools like webpack , rollup and parcel [ ... ] we are starting to hit a performance bottleneck for javascript based tooling : it can often take an unreasonably long wait ( sometimes up to minutes ! ) to spin up a dev server , and even with hmr , file edits can take a couple seconds to be reflected in the browser . now i just read about < url > and based on their claims , it seems all the initials problems would be resolved using parcel 2. so i 'm wondering what are the advantages to use vite over parcel2 , or parcel2 over vite ? < code >
user questions/requests for feature : quoting discord user anoesj : regarding file/line : vite/packages/vite/src/node/plugins/html.ts line 292 in 2351d79 js += ' import `` < cur > { id } ? html-proxy & index= < cur > { inlinemoduleindex } .js '' ' one thing i can think of is that it 'd be nice to add an option to preserve inline style tags with some kind of vite-preserve attribute . quoting @ patak-dev : i think we should create a feature request for this . something interesting to me is that after 2.8 we do n't have a way to add css to the html that we want to remain there ... it will always be extracted to a separate file . and i think there are use cases to avoid the waterfall for some critical styles todo : check if other maintainers agree . bikeshed on implementation ... an attribute in the < style > tag ? < style attribute > where attribute could maybe be vite-preserve , critical , keep , inline , no-extract , etc ... ? < code > // < style > ... < /style > if ( node.tag === 'style ' & & node.children.length ) { const stylenode = node.children.pop ( ) as textnode const filepath = id.replace ( normalizepath ( config.root ) , `` ) inlinemoduleindex++ addtohtmlproxycache ( config , filepath , inlinemoduleindex , stylenode.content ) if ( ! node.props.some ( p = > p.name === 'vite-preserve ' ) ) { js += ' import `` < cur > { id } ? html-proxy & index= < cur > { inlinemoduleindex } .css '' ' shouldremove = true } }
hi , when i do : i get [ plugin : vite : import-analysis ] failed to resolve import `` @ watchtower/api ? worker '' from `` ...... tsx '' . does the file exist ? am i doing something wrong or is it not supported ? i have this module in my node_modules ( built with vite actually and with the correct and recommended dist/ paths in package.json ) : < code > import apiworker from ' @ watchtower/api ? worker ' const worker = new apiworker ( )
hi all , im trying to add couple of svg and png files into my js file as i did before in webpack projects . i cant manage to make it work with vite.config.js , but i did it with vue.config.js with webpack . vite.config.js.txt vue.config.txt any inputs any1 ? how to build assets into js file .. i appreciate any help ! < code >
hello 👋 i recently created a new project with vite 's template-vue-ts template and had to spend a bit of time to figure out that i needed to add plugin-vue-jsx to be able to use tsx in vue components . would it make sense to add this plugin by default in this template ? i 'm assuming most people who want to use typescript would likely want to use tsx . i 'm happy to add this to the template and submit pr if it makes sense . ( not sure if this should go into discussions or issues , so excuse me if this is not the right place 😄 ) < code >
so i 'm splitting up a codebase into packages that are connected via yarn workspaces and typescript 's references feature . one issue i still have is how to import `` svg '' assets . in the package where i run vite , it works fine , but there are other packages where i do n't run vite , i just run the typescript compiler to output to a dist folder which then gets pulled in by the main vite project . typescript does n't know about the .svg modules , of course . is there a good solution ? < code >
i am desperately trying to get react-timeseries-charts to work after migrating to vite ( from craco ) . react-timeseries-charts uses ( an older version of ) a library called moment-duration-format . from what i understand , the moment-duration-format is not an es module , and neither is moment which is another package that moment-duration-format relies on . so when trying to run the application , moment-duration-format produces an error saying : moment duration format can not find moment.js i found some tips on how to get around this in these issues ; # 6675 # 1724 so i enable this plugin : and then it works fine in my dev environment . but , when doing a vite build , this fix is not applied for some reason . moment is not defined for the moment-duration-format package . so how can i make the build work ? < code > export default defineconfig ( { optimizedeps : { esbuildoptions : { plugins : [ esbuildcommonjs ( [ `` moment '' , `` moment-duration-format '' ] ) ] , } , } ,
i 'm just playing with porting a snowpack app to vite and thought i 'd share something i found in case it helps anyone else . if your client-side code uses buffer ( e.g. , you 're doing stuff with cryptography and you 're using a node.js library ) and you get a `` buffer is not a function '' -type error , you do n't have to mess with rollup plugins , etc . ( which i went down a rabbit-hole with , unsuccessfully ) . instead , install feross 's buffer polyfill : and , in your js entrypoint ( e.g. , index.js ) , do something like this : and it should work . similarly , you can implement other node polyfills directly in your code , if and when you need them . ( in snowpack , there is a polyfillnode option you can use in the configuration that should do this for you automatically but there 's been a recent regression so i took it as an opportunity to try out vite . given that vite does n't have the same directory-related issues and with this small workaround seems to just work in my tests , i 'm going to start using it instead for our small web stuff . also , expect a vite + svelte template for site.js soon i actually encountered the issues while working on a snowpack version , which i 'll release once/if the regressions are fixed . ) < code > import { buffer } from 'buffer ' globalthis.buffer = buffer npm i buffer
hey 👋 , unless i 'm mistaken , no json schema exists for the manifests generated by vite . i think it would be interesting to create them to allow external tools to validate manifests against them . what do you guys think ? i 'd be willing to get the ball rolling and drafting a proposal . use case i 'm working on a php library for parsing vite manifests to help with backend integration . it would be nice to be able to validate the manifest prior to parsing it . < code >
hi guys , with vue2 i used to bundle my whole build project into 1 js and 1 css file , due to the enviorment i am publishing to only supports 1 js and 1 css file . and this works perfectly with vue2 , and the vue.config.js file attached . i have problems making this work with vue 3 - vite . i need help to migrate/reconfigure vue.config.js to vite.config.js . vue.config.txt vite.config.txt ive tried to migrate this my self with help of < url > but i cant make it work , maybe some1 here can help me ? < code >
i chatted a bit about this in the discord and was unable to make any progress . i 'd love to start a discussion here incase anyone has had similar issues . the setup vite : ^2.1.1 we have an < url > reverse proxy on local that 's being reverse proxied with generated ssls with caddy server . our caddy file looks like the issue when visiting fakedomain.dev , the site inifinite loops with logs saying websocket connection to 'wss : //localhost:3000/ ' failed : or websocket connection to 'wss : //fakedomain.dev:3000/ ' failed : based on how our vite is configured what i 've tried already https : true in vite config . - > server then responds with a 502 changing server.hmr forced http1.1 in our reverse proxy . notes localhost:3000 works fine , but we 'd prefer to have https & our reverse proxy as safari refuses localhost httponly , secure cookies . not a dealbreaker , but we 'd really like to be able to reliably test safari in dev . i 've been reading issues all morning , but nothing seems to do the trick . # 1653 , # 1926 , # 1925 this same setup works in snowpack with no special config . not saying that to diss vite , just as a note that something in the differences in how vite handles wss in reverse proxies seems to be the issue . i 'll make a reproduction and an issue , but wanted to get this out there in case anyone else is having this issue . thanks ! < code > { local_certs } fakedomain.dev { reverse_proxy 127.0.0.1:3000 }
hey 👋 we have recently moved to using vite as our tooling and we noticed a rather long delay when loading a page through the dev server . it seems like the dependency pre-bundling does n't work for one of our modules . the module in question is a pure esm package which includes vue sfcs . if we now import one of these components , every file gets downloaded by the browser instead of being pre-bundled . even worse if one of these components imports from something like lodash-es , everything from there gets downloaded as well , which leads to the long delay when loading a page . is there a way to get this to work or is this just not supported on vite 's end ? < code >
since yesterday , i 'm trying to migrate from cra to vite . i have css import from swiperjs at my index.js file . while other css imports are working well , but css import from swiperjs giving me error like this thing that i 've tried is bumping up my swiper version from version 7 to version 8 , but seems i can not find any luck . < code > import react from `` react '' ; import reactdom from `` react-dom '' ; import `` antd/dist/antd.css '' ; import `` swiper/swiper.min.css '' ; import `` swiper/modules/navigation/navigation.min.css '' ; import `` ./assets/fonts/main.css '' ; import `` ./index.css '' ; import `` react-multi-carousel/lib/styles.css '' ; import app from `` ./app '' ;
trying to do import packagejson from ' .. /package.json ' assert { type : 'raw ' } ; and it looks like vite build is unhappy ? also asked on discord but i think i asked during the middle of somebody else 's debugging session < code >
hello , i am working on a library and currently i build it by gulp , because i can process each module and have the same modules structure . for example apply css modules rules , transform ts to js , convert svg to react components etc . i wonder if it is possible to have the same behaviour using vite , not to create single file but leave the files structure ? thanks . < code >
when i want to mod devserver.proxy configs in vite 's config hook , it is confusing that i ca n't get host : port which will be used when devserver running . < url > is obviously not alaways working , the port may be changed to 3001/3002/3003 ... etc . so how to get the host : port of the devserver in config hook ? ? < code >
i 'm using vite to build my react component library , but after i build my project , i searched my dist code , no component was export . here is my build config : import path from 'path ' ; const buildconfig = [ { build : { rollupoptions : { external : [ 'react ' ] , output : { entryfilenames : 'index.js ' , chunkfilenames : 'index.js ' , assetfilenames : 'index . [ ext ] ' , format : 'es ' } , input : { index : path.join ( __dirname , ' .. /src/component/index.js ' ) } } } } ] ; export default buildconfig ; here is my index.js code : export { default as button } from './button ' ; export { default as input } from './input ' ; export { default as sidebar } from './sidebar ' ; export { default as navigation } from './navigation ' ; export { default as menu } from './menu ' ; export { default as table } from './table ' ; is there any one can help me ? < code >
i 'm trying to configure a proxy , but the cookie headers are not being sent . i 'm trying to reach the following server url : the request being made : i configured vite like this : the server requires authentication , a jsessionid cookie . i 'm authenticating in the browser . after that , if i just copy & paste the request url in the browser , it works , returning the json data . in the vite application , the fetch returns a 401 error code ( unauthorized ) ... however , if i manually set the cookie header , for example : then it works , which means the cookie header is not being sent by vite . what am i missing ? < code > export default defineconfig ( ( { command , mode } ) = > ( { plugins : [ react ( ) ] , server : { port : 8081 , proxy : { '/api ' : { target : ' < url > changeorigin : true , } , } , } , } ) ) ; '/api ' : { target : ' < url > changeorigin : true , headers : { cookie : 'jsessionid=frcm9jb1wsund4srhprxsgvf ' } , } < url > fetch ( '/api/some/resource ' ) .then ( resp = > resp.json ( ) ) .then ( data = > console.log ( data ) ) ;
as some collaborators are getting very knowledgeable with vite 's source code , i 'm suggesting we give some vite collaborators the privilege to merge prs without the need of a second reviewer . this is already the case for evan you , which makes sense since he is familiar with the source code . i 'm thinking maybe we can start considering extending this privilege to others . i 'd like to nominate : patak . < code >
hello everyone , they gave me a site on vite.js for revision , when i write npm run build , files are created in the dist folder , but everything is displayed as if without styles and js . tell me how can i create files that i can then upload to the hosting ? < code >
hello , is n't there a way to have only multiple entries , not just in production ( < url > ) ? i want to use vite to made webextensions and i 'm having trouble setting up the vite.config.js file . merci ^^ < code >
npm run dev is fine and all , but after doing vite build then seemingly some dependency of react-timeseries-charts crashes with this error message : anyone know why this would happen after doing a vite build but not in the dev env ? < code > typeerror : right-hand side of 'instanceof ' is not callable at pipeline._setin ( asset.ee736b61.js:13229:15 ) at pipeline.from ( asset.ee736b61.js:13317:17 ) at timeseries.pipeline ( asset.ee736b61.js:13800:37 ) at timeseries.fixedwindowrollup ( asset.ee736b61.js:13891:35 ) at getaggregatedseries < cur > 1 ( asset.ee736b61.js:24288:18 ) at new bandchart2 ( asset.ee736b61.js:24299:22 ) at mg ( index.494ab1bf.js:6853:8 ) at pi ( index.494ab1bf.js:7838:77 ) at ck ( index.494ab1bf.js:9928:96 ) at bk ( index.494ab1bf.js:9405:12 )
i 've decided to give vite a shot and so far it has been great . it 's blazing fast . today i tried using it on a monitor connected with my mac air m1 via hdmi cable and the rerender speed due to css changes has dropped significantly . on my machine it renders in 100-200ms while on the monitor it renders at 1000-1500ms . is there a hardware bottleneck ? it 's a 7yo asus monitor with a standard hdmi cable . is there any way to speed it up ? < code >
in vite build after , open index.html show blank page . i am try change base option . but show again failed to load module script : expected a javascript module script but the server responded with a mime type of `` '' . strict mime type checking is enforced for module scripts per html spec . vite version @ 2.6.4 please tell me the correct solution < code >
hi , as title states , i 'm using vite and noticed i can use nested css despite not having any postcss plugin added . i do n't see any plugins as dependencies of vite , so how is this possible ? < code >
we used to have one big monolithic bundle , which worked fine , but it included a lot of code for hidden paths that usually would never be loaded for most users , so i decided to use dynamic loads for each route , a la const screena = await import ( './screena ' ) , for all top-level routes . that worked and was painless , but now all modules were being loaded async . that was unintended . i hoped vite would just split the bundles per route . is there any way i can relatively painfree bundle all the tiny modules up into bigger bundles ? < code >
hello , i have a component which instanciate a worker like : component.vue inside this worker , i import a service : my-worker.js and the service is define like : service.js but i go this error : uncaught referenceerror : htmlelement is not defined ( anonymous ) | @ | overlay.ts:116 when i comment the line which import the service , no error but i can not use my service : ( maybe i 'm doing something wrong ? should i exclude service file from being process by vite ? edit : found out that the problem come from the import { service } from 'shared/service ' which is imported from a shared repository installed as dep . when duplicate the service , to put it on the same repository it works ... < code > import pollerworker from ' .. /worker/poll.worker.js ? worker ' new pollerworker ( ) import service from ' .. /services/service.js ' self.addeventlistener ( ... import { service } from 'shared/service ' class myservice extends service { ... } export default new myservice ( )
is there any specific reason that create-svelte references a fork of the original project ? vite/packages/create-vite/template-svelte/readme.md line 39 in 9a93233 hmr state preservation comes with a number of gotchas ! it has been disabled by default in both 'svelte-hmr ' and ' @ sveltejs/vite-plugin-svelte ' due to its often surprising behavior . you can read the details here phofhyperlink . and vite/packages/create-vite/template-svelte-ts/readme.md line 39 in 9a93233 hmr state preservation comes with a number of gotchas ! it has been disabled by default in both 'svelte-hmr ' and ' @ sveltejs/vite-plugin-svelte ' due to its often surprising behavior . you can read the details here phofhyperlink . the original repo is < url > < code >
describe the bug eslint does n't warn about any issues can somebody clarify me , maybe i 'm doing something wrong ? reproduction reproduction steps system info used package manager yarn logs no response validations follow our code of conduct read the contributing guidelines . read the docs . check that there is n't already an issue that reports the same bug to avoid creating a duplicate . make sure this is a vite issue and not a framework-specific issue . for example , if it 's a vue sfc related bug , it should likely be reported to < url > instead . check that this is a concrete bug . for q & a open a github discussion or join our discord chat server . the provided reproduction is a minimal reproducible example of the bug . < code > just bootstrap a new empty project , and add eslint config
hello , i 'm working with esbuild and need to specify the build option to replace all occurrences of process.env.node_env . the problem is that vite replaces the string . i looked into issue # 3077 , but this did n't really help . here is the code snippet : does someone have an idea how to solve this ? thanks a lot ! < code > const bundled = await esbuild.build ( { entrypoints : [ 'index.js ' ] , bundle : true , write : false , plugins : [ plugin ] , define : { 'process.env.node_env ' : ' '' production '' ' , global : 'window ' } , } ) ;
if you just want add a simple html page to your project , you may place it in the public directory . but editing html file in public dir will not cause page reloading . in this case you can add a simple script tag in the html file . then , html in public will reload automatically after you editing it . < code > < script > if ( location.hostname === 'localhost ' ) { fetch ( '/ @ vite/client ' ) .then ( r = > r.text ( ) ) .then ( code = > { const client = document.createelement ( 'script ' ) client.type = 'module ' client.textcontent = code + ' socket.addeventlistener ( 'message ' , ( { data } ) = > { json.parse ( data ) .type === 'full-reload ' & & location.reload ( ) } ) ' document.head.append ( client ) } ) } < /script >
vite will not inject css code in your esm build js code . i have a plugin to solve this problem . requires vite > = 2.9.0 < code > import { extname } from 'path ' // vite wont inject css when build format is es export default ( ) = > { return { name : 'inject-css-for-es-build ' , apply : 'build ' , enforce : 'post ' , config ( ) { return { build : { csscodesplit : true } } } , renderchunk ( code , chunk , opt ) { const { filename , isentry , isdynamicentry , vitemetadata } = chunk if ( [ '.js ' , '.mjs ' , '.cjs ' ] .includes ( extname ( filename ) ) & & opt.format === 'es ' & & ( isentry || isdynamicentry ) & & vitemetadata ) { return [ ... vitemetadata.importedcss ] .map ( ( css ) = > 'import `` ./ < cur > { css } '' ; ' ) .join ( ' ' ) + code } } } }
i am building vite js app ( click here to download code ) and when i try and build with the command : i get an error like : i am running ubuntu with node version 15.9.0 and npm version 7.5.3 . i do n't know what is going on . can anyone help ? thank you a lot in advance ! < code > npm run build [ rollup-plugin-dynamic-import-variables ] unexpected token ( 25:51 ) file : /home/alein10/desktop/sam coding/test-vite/src/index.ts:25:51 error during build : syntaxerror : unexpected token ( 25:51 ) at parser.pp < cur > 4.raise ( /home/alein10/desktop/sam coding/test-vite/node_modules/rollup/dist/shared/rollup.js:16685:13 ) at parser.pp.unexpected ( /home/alein10/desktop/sam coding/test-vite/node_modules/rollup/dist/shared/rollup.js:14195:8 ) at parser.pp.semicolon ( /home/alein10/desktop/sam coding/test-vite/node_modules/rollup/dist/shared/rollup.js:14172:64 ) at parser.pp < cur > 1.parseexpressionstatement ( /home/alein10/desktop/sam coding/test-vite/node_modules/rollup/dist/shared/rollup.js:14651:8 ) at parser.pp < cur > 1.parsestatement ( /home/alein10/desktop/sam coding/test-vite/node_modules/rollup/dist/shared/rollup.js:14386:24 ) at parser.pp < cur > 1.parseblock ( /home/alein10/desktop/sam coding/test-vite/node_modules/rollup/dist/shared/rollup.js:14667:21 ) at parser.pp < cur > 1.parsestatement ( /home/alein10/desktop/sam coding/test-vite/node_modules/rollup/dist/shared/rollup.js:14351:34 ) at parser.pp < cur > 1.parseifstatement ( /home/alein10/desktop/sam coding/test-vite/node_modules/rollup/dist/shared/rollup.js:14496:26 ) at parser.pp < cur > 1.parsestatement ( /home/alein10/desktop/sam coding/test-vite/node_modules/rollup/dist/shared/rollup.js:14340:31 ) at parser.pp < cur > 1.parseblock ( /home/alein10/desktop/sam coding/test-vite/node_modules/rollup/dist/shared/rollup.js:14667:21 )
first i was told to move all tailwind css stuff to devdependencies ... i saw no difference in how the app works or the speed of dev/build . same now with firebase - it kinda ends in a resulting bundle so where should it go ? no difference in both ways . what 's the recommendation - to move as much as possible to devdependencies until it works ? < code >
hi , i 'm using nuxt 3 ( which is using vite for dev server ) and i try to launch the server with nuxi dev -- port 4000 -- host 0.0.0.0 to access it from a docker container . it works perfectly fine on linux but not on windows wsl ! do you have an idea why ? or am i missing something ? step to reproduce : have docker installed and wsl windows on linux it will display the page content correctly , on windows wsl : curl : ( 7 ) failed to connect to host.docker.internal port 4000 after 2024 ms : connection refused < code > npx nuxi init nuxt3-app cd nuxt3-app yarn install yarn dev -- port 4000 -- host 0.0.0.0 docker run -- add-host=host.docker.internal : host-gateway curlimages/curl : latest host.docker.internal:4000
when i change my code , due to hot reload , the code on my google chrome browser gets updated which is great , but the modified file gets different filename . it 's the original file name , with ? t= [ some big number ] appended to it . this is problematic because i debug using chrome 's devtools and i lose all my breakpoints probably because google chrome thinks it 's a different file . how can i prevent this behavior so file names are kept unchanged during hot reload ? thanks . < code >
hi , i 'm trying to understand how to lint sugarss inside .vue files with stylelint when i use < style lang= '' sss '' > ... < /style > < url > i ca n't run npm run dev , vite is complaining : stylelint src works without a problem : when i use < style > ... < /style > < url > vite is working without a problem with sugarss : but stylelint is complaining ( it probably thinks it regular css ) : so , the question is , how to allow vite and stylelint work together with sugarss in .vue files ? should i pass some options to style for vue/compiler-sfc to link sss with sugarss syntax ? < code >
variables.scss < cur > -- color-primary : # 1890ff ; : export { theme : < cur > -- color-primary ; } import variables from variables.scss variables is string how to share variables between javascript and sass ? < code >
hi , i am writing something like vite playground . i am trying to run vite in browser . is there any plan to support vite running in browser environment ? i noticed that there is a package browser-vite on npm . what is the current state of it ? < code >
hello there , i 'm currently migrating from snowpack to vite and and i have a question for one specific feature : i have a couple of clientside routes , e.g . /foo/bar i can navigate to the route on the client , using a spa router , that works just fine . but now when i 'm reloading ( f5 ) , the dev server tries to load the resource /foo/bar ( which of course is not there ) , failing with a 404. what i want the dev server to do is to just server /index.html on every route that is called . in snowpack this is done via the routes configuration , it is called `` spa fallback paths '' : < url > is there any way to accomplish this ? < code >
menu : yarn start i ca n't access src/xxxx.html , unless i add a serial number . i do n't know why i do n't want the serial number . < code >
hello , if i change the package.json file ( by switching to another git branch ) and install new dependencies ( using command npm install ) , do i need to restart the vite server ? or is it possible to do without it ? the current problem is that if i import a package from node_modules , i still get old version . the vite server works in the docker container and i would avoid stopping it , but then there is probably no way to simply restart vite . thanks . < code >
i am using monaco editor . there is a module called monaco-editor-auto-typings that can work with the monaco editor . getting an error on the site when i want to import it . the first of this error is that path.dirname is not defined . not how to fix it , i want to find exactly can be why giving error . why does vite throw path.dirname not defined error on a default package ? ( my guess is the path reference is not given ) screenshots : my code error message : location of the error line my questions : i did some tests and after importing the path i discovered that the dirname method does not exist . so why ? why do we use a vite-plugin for the monaco editor . what exactly is the reason for this ? where can i learn ? i like the plugin system of vite.js , but i do n't know exactly how it works . where can i learn ? < code >
i created a vite.config.ts to write my build configuration which includes const . but vite will fail when loading the configuration file and throw an error transforming const to the configured target environment ( `` es5 '' ) is not supported when i changed the target of tsconfig.json to es6 , it worked fine . so how to change the target only when building the project with vite ? this may related to evanw/esbuild # 1355 < code >
i 'm using typescript and am confused about type importmetaenv allowing for custom env vars to have type boolean : i 've tried setting a variable vite_test to 0 , 1 , true and false but when i log its type in my app , i always get string . if env vars are always string or undefined , then boolean should probably be removed from the union to avoid any confusion and potentially simplify type guards . < code > interface importmetaenv { [ key : string ] : string | boolean | undefined base_url : string mode : string dev : boolean prod : boolean ssr : boolean }
is it possible to override individual functions in @ vite/client or make the server serve a different custom implementation during dev ? i 'm trying to override the implementation of updatestyle to handle the fact that the styles in our app are not always imported in the correct order . i 've tried the following in my config but that does not seem to do anything . i 've also tried but that does not seem to work either . problem : i 'm working on converting a large webpack app to use vite during dev . i 've gotten most of it working , but one issue that 's left is that our styles are inserted in the incorrect order ( because they are also imported in the wrong order ) . on the server when building with webpack we have some custom code that insert any styles that are imported from node_modules before any other styles . i 'm trying to do something similar in vite but i 'm unable to find a way to override the implementation of updatestyle in @ vite/client < code > { resolve : `` @ vite/client '' : path.join ( __dirname , `` customviteclient.ts '' ) } } { server : { proxy : { `` @ vite/client '' : `` < url > } } }
hello , i hope you 're all doing well . i have a problem regarding loading images from assets in my vue3 components . when i build my project it creates all the files in the folder i have mentioned in my outdir i.e . `` path.resolve ( __dirname , `` ./ .. / .. / .. /themes/rd2/dist '' ) '' . now when i include this project in my php file and run it using apache , it tries to load my image from `` /assets/shop.db40dbac.svg '' instead of `` /themes/rd2/dist/assets/shop.db40dbac.svg '' < code >
i noticed the react preset is using babel . this is causing everything to be a lot slower than is necessary and adds a very noticeable delay when starting in dev mode . i 'm wondering why this could n't be done in esbuild/rollup ? < code >
in the documentation on modes here , there is no mention of node_env being what determines a production or development build . it is shown in the screenshot but there 's no mention in the documentation . i looked over this several times without realizing the importance of the node_env line from the screenshot . this was definitely an oversight by me , but i think adding a line about node_env could potentially save someone else the struggle i went through yesterday when trying to get other [ modes ] to build a production app . < code >
there style in # app element , bug vite will move the style to head tag < code > < div id= '' app '' > < div > < /div > < style > < /style > < /div >
i have a script debugger which allows you to insert breakpoints to debug codes , but it needs to wrap the codes and pass to a debug function as a string , like below . also , i have a vite project and i just want to enable this debugger during serve instead of build . that means i have to add a banner/footer for all scripts to wrap them up by debug ( ... ) . i 've tried lots of ways but failed . do you guys have any idea ? thanks . < code > // original code console.log ( 1 ) ; console.log ( 2 ) ; // transformed code debug ( ' console.log ( 1 ) ; console.log ( 2 ) ; ' ) ;
libesvue , console import xx from 'vue ' vite.config.ts < code > export default defineconfig ( { plugins : [ vue ( ) , vuejsx ( ) ] , resolve : { alias : process.env.node_env ! == 'production ' ? { 'demo : resolve ( __dirname , './src ' ) } : undefined } , build : { lib : { entry : resolve ( __dirname , 'src/index.ts ' ) , name : 'demo ' , filename : ( formats ) = > 'free-layout. < cur > { formats } .js ' } , rollupoptions : { external : [ 'vue ' ] , output : { sourcemap : false , globals : { vue : 'vue ' } } } } } ) ; // console demo.es.js:1 uncaught syntaxerror : the requested module '/node_modules/.vite/deps/vue.js ? v=c3d23b24 ' does not provide an export named 'default ' // vue require < cur > 0 < cur > 2 import require < cur > 0 < cur > 2 , { ref , readonly , watch , computed , getcurrentinstance , onmounted , onbeforeunmount , onbeforemount , reactive , definecomponent , provide , createvnode , createtextvnode } from `` vue '' ;
hello ! i integrated backend , with this article < url > php + vue 3. all work fine . but when if change some css , or html , page does not update live , i should reload page force . in console i got this error . i fixed this problem with this extension < url > after i disabled csp , all work fine , live reload working . maybe i can fix without extension ? < code >
take the plugin that updates the path of an imported file based on some environment variable : the environment variable is set during a request : navigating to localhost:3000/a should use the contents of a.js to load the webpage . localhost:3000/b should then show the contents of b.js . is there a way to achieve this with vite ? take this stackblitz as an example . go to the left ports tab , click port 3000 , and then add /a to the end of the url . when you replace /a with /b the expected behavior is to use b.js to render the page . i try deleting the cache on each request so that vite must re-resolve a/b . but have n't had any luck with this method . < code > app.get ( '/ : with ' , async ( req , res ) = > { process.env.filter_on = req.params.with ; try { console.log ( 'sending html ' ) ; res.set ( 'content-type ' , 'text/html ' ) ; res.send ( buffer.from ( html ) ) ; } catch ( error ) { console.error ( error ) ; res.status ( 500 ) .json ( { error : json.stringify ( error ) } ) ; } } ) ; { name : 'inject ' , enforce : 'pre ' , resolveid ( id ) { if ( id.includes ( 'replaceme ' ) ) { console.log ( 'replacing with ' , process.env.filter_on ) ; if ( process.env.filter_on === ' a ' ) return '/a.js ' ; if ( process.env.filter_on === ' b ' ) return '/b.js ' ; } return null ; } , } ,
how do you use the new `` import with constructors '' syntax to import workers from an npm package ? i 'm basically trying to express what @ yyx990803 wrote here in the new syntax and i 'm failing hard . < code >
hello , i 'm importing modules in my javascript file with this import * as three from ' .. /node_modules/three/ ' and i put the code below in vite.config.js . but when i open my website in the browser i get the error `` failed to load resource : the server responded with a status of 404 ( ) '' . the script is in the src and the module in node_modules . < code > module.exports = defineconfig ( { build : { rollupoptions : { external : [ `` .. /node_modules/three/ '' ] , } } } )
i 'm working on a typescript project with vite . i 'm importing a css module like so : somehow vite 's css module typings take over the intellisense functionality of vscode . so when i ctrl+click to open the .scss file , i instead open vite 's client.d.ts . is there any way to get this working correctly ? < code > import styles from './component.module.scss ' ;
hello , is there is a way to determine if the watch mode is used when building the config ? i know i can pass a function to defineconfig to retrieve the mode and command but when using vite build -- watch it does not help to differentiate it from vite build . my end goal is to do some changes to the configuration when the watch mode is used like disabling the minification process . i know i can pass those options with the cli but then i have to remember to set those flags each time . < code >
i 've been pulling my hair on this for a few hours ... i tried almost every setting combination i could figure out from the docs . unfortunately , according to issues and discussion in the vite repo , there are some new web worker features in vite which are not yet documented . here is how to use workerpool according to their docs : needless to say importscripts ( ) does n't work , because vite imports the worker as a module . then , i either end up with two separate instances of workerpool , or unable to call the regular workerpool instance from the worker with importscripts ( ) . any ideas ? < code > // main.js import `` workerpool '' from workerpool ; const pool = workerpool.pool ( / * script string or blob - this argument goes directly to the browser 's worker ( ) function * / ) ; // worker.js importscripts ( `` workerpool '' ) // create a worker and register public functions workerpool.worker ( { fibonacci : fibonacci , } ) ;
newer versions of vite are pre-loading a hashed vendor.js chunk and importing it within the index.js . while it 's a great idea generally , it unfortunately breaks our vite-plugin-singlefile plugin ( richardtallent/vite-plugin-singlefile # 7 ) . for example , vendor.js is n't listed in the indexhtmltransformcontext.bundle available to the plugin . we could detect the preload link , but index.js aliases everything it imports from there , which puts this well beyond some simple regex to unwire . i 've looked through the vite , vite-plugin-vue , and rollup options , and i 'm not seeing a way to disable this vendor code-split . is there an option i 've missed somewhere ? if not , would this be best addressed in vite , or in rollup ? < code >
hello everyone , i have created this component library in preact lib mode : < url > after publishing it , once i import any component from the lib i get these : warning in terminal error on browser console i am not sure what is going on . the library uses styled-components , which might be causing issues with all the react-preact aliasing going on . can anyone help me ? i had a previous version of this lib in react which was working fine , i might have to just migrate everything back to react : ( < code > debug.js ? c91e:116 uncaught ( in promise ) error : undefined component passed to createelement ( ) you likely forgot to export your component or might have mixed up default and named imports < # text dangerouslysetinnerhtml= '' [ object object ] '' / > in # text in asynccomponent in route in router in app at preact__webpack_imported_module_0__.options.__b ( debug.js ? c91e:116:1 ) at preact__webpack_imported_module_0__.options.__b ( index.js ? a178:25:1 ) at preact__webpack_imported_module_1__.options.__b ( forwardref.js ? 07a8:6:1 ) at j ( index.js ? c988:44:1 ) at w ( children.js ? b0ec:137:1 ) at j ( index.js ? c988:171:1 ) at w ( children.js ? b0ec:137:1 ) at j ( index.js ? c988:171:1 ) at w ( children.js ? b0ec:137:1 ) at j ( index.js ? c988:171:1 ) ⚠️ warn .. /node_modules/ @ logrock/pebbles/dist/logrock-pebbles.es.js 3789:8-18 `` export 'default ' ( imported as 'require < cur > 0 ' ) was not found in 'preact ' @ ./routes/onboarding/onboarding.tsx @ .. /node_modules/babel-loader/lib ? ? ref -- 4 ! ./routes/onboarding/index.ts @ ./routes/onboarding/index.ts @ ./app.tsx @ ./index.ts @ .. /node_modules/preact-cli/lib/lib/entry.js
i have create two project with npm create vite @ latest which use react & vue both update the logo path & make the same alias point to the image path just like file path : src/assets/images/logo.png alias : '/images/ ' : 'src/assets/images ' use case : < img src= '' /images/logo.png '' / > but only the vue version includes the logo.png file to dist folder i am not sure if the react plugin need to set something ? < url > < code >
have a question about dev mode , possibly related to how css is handled when hmr is enabled . i have an index.html like this : i 'm noticing that when i run vite , index.css is actually being served as some js , probably for the sake of hmr . is there a way to exempt this asset from that transformation , so that it is just a static resource/ normal < link > of a css file ? if so , is it possible to do that , without disabling hmr overall ? i need to keep hmr enabled because i 'm using a plugin that does n't work in dev mode when hmr is disabled . < code > < ! doctype html > < html lang= '' en '' > < head > < ! -- ... -- > < title > example < /title > < link rel= '' stylesheet '' href= '' ./src/index.css '' > < /head > < body > < div id= '' root '' > < /div > < script type= '' module '' src= '' ./src/index.tsx '' > < /script > < /body > < /html >
im vite docs of japanese translator . i maintaining api-plugin.md , for updates , i found a words that are a little harder to make sense of . < url > think in context , broadcast is right ? if it is right , i 'll proposing a pull request to fix it . < code > server to client on the plugin side , we could use server.ws.send to boardcast events to all the clients :
i indeed add / * @ vite-ignore * comment , but the dynamic importing warning is still there . i update vite to 2.9.0 , the issue appears , but the old version is ok. < code > docs : dev : plugin : vite : import-analysis docs : dev : file : node_modules/.pnpm/ < email > .3/node_modules/vitepress/dist/client/app/index.js docs : dev : 2:56:21 [ vite ] warning : docs : dev : apps/docs/.vitepress/theme/example.vue docs : dev : 61 | return docs : dev : 62 | } docs : dev : 63 | import ( / * @ vite-ignore * / ' < cur > { compfile } ? raw & _t= < cur > { date.now ( ) } ' ) .then ( r = > { docs : dev : | ^ docs : dev : 64 | this.sourcecode = r.default ; docs : dev : 65 | } ) docs : dev : the above dynamic import can not be analyzed by vite . docs : dev : see < url > for supported dynamic import formats . if this is intended to be left as-is , you can use the / * @ vite-ignore * / comment inside the import ( ) call to suppress this warning
i was using this library ( < url > ) that exports a build.min.js when i import it normally , it works but when i use dynamic import , and log the module , its properties are minified , which possibly leads to the error that states init is not defined my suspicion is that vite minify the build.min.js again and obfuscate all the variables inside , could you suggest a way to config rollup or vite to opt-out minifying a specific library ? < code > const dynamicinit = async ( ) = > { const branch = await import ( 'branch-sdk ' ) console.log ( branch ) branch.init ( ) return instance } import branch from 'branch-sdk ' ; branch.init ( ... )
i am currently doing a javascript project using vite and webstorm . when i run vite and there is an error in my code , the error message in the webstorm console links to the js file after the build process , while i would like it to link directly to the source file . it 's currently cumbersome to have to find the file directly by myself to then debug it . when i was using parcel , the error message linked directly to the source file that i could then rapidly debug . it 's the same problem when i am using breakpoints , webstorm shows me the js file in the browser which results of the build process . it 's thus a pain to debug . am i doing this wrong ? or is vite just still not optimized for webstorm ? thanks < code >
by default , vite not generate .d.ts in lib mode . i try to find some plugins to solve it , but i cant't the effective plugin . anybody can help me ? : ( < code > export default defineconfig ( { plugins : [ vue ( ) ] , test : { environment : 'happy-dom ' , } , build : { lib : { entry : './src/main.ts ' , formats : [ 'es ' , 'umd ' ] , name : pkg.name , } , rollupoptions : { external : [ 'vue ' ] , output : { globals : { vue : 'vue ' , } , } , } , } , } )
hey there ! currently , i have set up a vite 2 project with monaco-editor as a dependency . whenever i am trying to use it says that the workers are not imported . since i am using vite 2 i have assumed that simply specifying the rollup plugin rollup-plugin-monaco-editor in the plugins array . however , i am still getting this issue . is there any proper way to import monaco-editor into a vite 2 project ? thanks ! < code > editorsimpleworker.js:454 uncaught ( in promise ) error : unexpected usage at editorsimpleworker.loadforeignmodule ( editorsimpleworker.js:454 ) at webworker.js:38 export default defineconfig ( { plugins : [ vue ( ) , monaco ( { languages : [ 'javascript ' ] } ) , ] , } ) ;
i have a repo that builds a library including a webworker . the output for the worker includes a polyfill for fetch , can i disable that somehow ? < code >
i am getting the above message on running the production build after `` npm run build '' command . no problem in dev build . it is a react app . < code >
somehow , if i keep saving the file ( cmd+s ) without any modifications the vite will keep trying to reload the same content over and over again . and in conjunction with vite-plugin-checker 0.4.4 fi3ework/vite-plugin-checker # 127 , node will throw out-of-memory error eventually . # 2433 screen.recording.2022-03-25.at.11.12.22.mov < code >
the question 's in the title . for more context , i 'm trying to write an automated test to make sure the vite dev server spins up properly , and my current plan is to simply wait until it 's up and close it . if there 's a specific feature of vite ( or a plugin , or something else ) which can do this for me you know of , lmk ! < code >
hello , i read the documentation and there is -- base for vite build command to specify the base path for all assets . i am currently building a widget using vite . i need to load specific lazy-loaded components from cdn . is it possible to specify the -- base option for specific chunks ? for example : i have app.tsx component which lazy loads component a or component b according to some statement components a and b are ( built ) located in cdn any idea to realize this approach ? < code >
i realised that the example for lit ( typescript ) does n't show how to enable dev mode . these are the resulting warnings : lit is in dev mode . not recommended for production ! see < url > for more information . and see < url > for details . < code > element < your-element > scheduled an update ( generally because a property was set ) after an update completed , causing a new update to be scheduled . this is inefficient and should be avoided unless the next update can only be scheduled as a side effect of the previous update . see < url > for more information .
when i use vite build i get all my output in a dist folder and i can load everything from that - which is fine for production . when i just use vite then it starts a server on port 3000 and the vue app is delivered in a nice debuggable format - all the vue components and their typescript appears in the developer tools as separate files . my problem is that i want to generate the output i get from the vite command into the dist folder and have a fully sourcemapped debuggable set of assets that i can load without using the server that the vite command fires up . imagine , if you will , a situation where i want to create a completely open . debuggable set of assets that i can zip up as an artifact and send off to be tested and run . a development only set of assets really that ideally i can also have a watcher on . i imagine the vite command uses rollup with a specific set of options to achieve what i want , so is it possible to provide the options i need ? < code >
i did not change anything , but the build output css file , is different . what is wrong ? look at index.css and index2.css , the content is same , but the file name is different . < code > vite v2.8.6 building for production ... 14 modules transformed . dist/pages/a/detail.js 0.06 kib dist/pages/a/detail.d.ts 0.04 kib dist/pages/a/list.js 0.04 kib dist/pages/a/list.d.ts 0.04 kib dist/pages.mjs 0.16 kib / gzip : 0.12 kib dist/vuecomponentnormalizer.js 1.78 kib / gzip : 0.65 kib dist/index.css 0.04 kib / gzip : 0.06 kib dist/index.js 17.22 kib / gzip : 3.21 kib dist/index2.js 9.87 kib / gzip : 2.17 kib > vite build vite v2.8.6 building for production ... 14 modules transformed . dist/pages/a/detail.js 0.04 kib dist/pages/a/detail.d.ts 0.04 kib dist/pages/a/list.js 0.07 kib dist/pages/a/list.d.ts 0.04 kib dist/pages.mjs 0.16 kib / gzip : 0.12 kib dist/vuecomponentnormalizer.js 1.78 kib / gzip : 0.65 kib dist/index2.css 0.04 kib / gzip : 0.06 kib dist/index.js 17.22 kib / gzip : 3.21 kib dist/index2.js 9.87 kib / gzip : 2.17 kib
i 've recently migrated my cra project over to vite . it uses urql along with graphql-codegen-code-generator which generates a module containing use < queryname > hooks for each query ( using the typescript-urql plugin ) . this works great but i noticed that my production build is a bit on the large side , in part because these documents are not being minified . see example : this kind of makes sense as the code generated by graphql-code-generator consists of template strings so the minifier would be wrong to try and reformat the code . but i notice that the previous webpack setup at least makes a few optimizations : is there anything i can do to further improve the minifying of the prod bundle ? < code >
i tried the sample vite app and hot-update was instantaneous . but it is n't working for my project ( it did n't hot-update in vue-cli either ) . after making a change i have to use ctrl-c to kill the server and then restart it . the javascript code in the browser is apparently listening for changes because at the end of the restart the page updates automatically . so what could i be doing wrong for hot-update to not work in my project ? i 'm running in windows wsl in vscode , could that have something to do with it ? i know i 'm asking a lot but can someone take a peek at my code and look for weirdness that could cause this ? unfortunately you ca n't run the code because it requires two special servers . the code is at < url > < code >
good evening , i have problems displaying my react page in netlify , i tried with ( hasrouter ) and it did n't work either . if i am in the domain ( / ) it shows me the react page but when reloading in ( /clients ) 404. any solution ? < code >
is there a way to adjust the postcss config dynamically , based on which css file is being processed ? ( or even which entry point vite is working on ... ) why : i 'm working on a wordpress site with tailwindcss , and i 'd like to have slightly different tailwind configs for the frontend and admin editor styles . i can compose the config dynamically inside of tailwind itself , but i need some token that i can check to determine if i 'm in an admin context or a frontend context . postcss does seem to support a context.file property that would let me do that in postcss.config.js , but vite does n't seem to populate that value . ( open issue here . ) if i switch to inline postcss config inside my vite.config.js , is there any way that i can access the current filename at run time ? worst-case scenario , i could use a different , custom vite mode to build the editor styles , but i 'd rather keep all the output in a single manifest for simplicity . < code >
hi vite team , i deployed a react app , using dynamic module replacement . my users often get this kind of error : failed to fetch dynamically imported module : < url > the error comes from the fact that org.xxx.js has been updated , so the xxx alias is not the same = > the only solution i 've found now is to reload the react app . do you know a smarter way to manage this error ? note : i ca n't use service workers because my app is running in webview without support of services workers . < code >
hello , in my current project i habe an index.php file instead of an index.html and i cant change that . im using vue-cli at the moment but want to switch to vite . is this possible in vite ? < code >
i been having a lot of questions regrading the build when trying to use vite-plugin-ssr . this imho cross realms with all three vite , vue , and vite-plugin-ssr . and the documentation is really lacking on all tree . i been have primarily 2 problems . i ca n't get production build to work when using fastify posted at bottom of issue problem with websocks in short when i run vite build what happens ? in more detail what is vite build doing and how do i deal with moving this to a static server such as apache ? what happens when index.html is missing as which is what happens when i use the scaffolding from vite-plugin-ssr ? how does it deal with the web-socket that vue uses ? what name should i use when i want to access a web page from a .vue in a html ? < code >
hi . i set up a new project with vite , vue 3 and ts . i got this error : devtools failed to load source map : could not load content for < url > http error : status code 404 , net : :err_http_response_code_failure i looked it up on the internet but could n't find much . does anyone know how to solve this problem ? thanks ! < code >
when i tried to run npm run test-serve -- -- runinband -- fs-serve , i got an error which said : 'page.goto : target page , context or browser has been closed ' , then all suites failed.and my pr # 7274 gots the same error too.that 's give me a big headache . after a few days of debugging , i find what tooks the bug for me . in /scripts/jestpertestsetup.ts , line 126 , there 's a line said await page.goto ( url ) .but in some case , the url refer to an 404 page , because the url variable from line 124 is ' < url > ' and the fs-serve root is /src , only the ' < url > is reachable . when page.goto get a 404 code , it seems closed the page context , when you call page.goto later , it throw the error `` page.goto : target page , context or browser has been closed '' . after i changed the code to this : , the error went away . i wonder it is a playwright version problem ? why other people 's ci can succeed ? hope you help me 🆘 < code > try { await page.goto ( url ) } catch ( e ) { }
the documentation shows an example on how to import a file as a string . but is it possible to configure all .glsl files should be loaded as string in vite.config.js ? it seems silly to have to append ? raw to every import < code > import shaderstring from './shader.glsl ? raw '
is there anyway for me to support scss modules in vitejs createserver dev server api ? the project being stated is outside of the scope of where the vitejs server is spawned . code : skylixgh/nexts/packages/cli-service/commands/dev/electronreact/electronreact.ts line : 156 my goal is to create an electron + vitereact tooling system < code >
i 've got a few components that are dynamically loaded with @ loadable/component like so : this seems to work fine when run on the client . with ssr - it does n't get rendered . i tried using : but this depends on @ loadable/webpack-plugin to work . is there a way to achieve something similar for dynamic react components under vite that 's compatible with ssr ? < code > const faq = loadable ( ( ) = > import ( / * webpackchunkname : 'faq ' * / './faq/faq.jsx ' ) , { ssr : true } , ) import reactdomserver from 'react-dom/server ' import { chunkextractor } from ' @ loadable/server ' const extractor = new chunkextractor ( ) reactdomserver.rendertostring ( extractor.collectchunks ( < app / > ) )
i created a vite plugin that converts a custom file with a custom extension to typescript code . the problem is that typescript is only listening for `` .ts '' files . how can i make it load my custom files too ? < code >
hello , one think i 'd like to know if vite supports hmr for webworkers , as i always have to restart the application ( vite start ) when i include changes in my worker files . i 'm currently using a library called comlink for the workers . i tried to use vite-plugin-live-reload to target specific files , and it refreshes the page after changing something , but do n't return the new changes after the refresh . so , i 'm starting to question if vite supports hmr for webworkers . does anyone know if it does ? < code >
so my app is composed of a about 30 different routes , of which only a handful is really used , so it made sense to me to avoid letting the user need to parse all the unneeded cruft for the normal worflows . and so i converted most import screena from ./screen/atoconst screena = react.lazy ( ( ) = > import ( './screen/a ' ) ) ' . this worked ! at least in the sense of `` i do not have two big chunk of js anymore '' . the downside was that all files under a route is now downloaded separately . i was assuming that each route would get its own bundle , but not so . now i have vender-bundle.js , main-bundle.js and foo.js , bar.jsx , some-random-component.jsx , etc . not sure this is an improvement . how can i ensure the routes are assembed into bigger chunks ? < code >
when i use minio in vite2.x , have wrong as sax.js:222 uncaught typeerror : can not read property 'prototype ' of undefined found in < url > but when i yarn add stream have wrong as uncaught typeerror : super expression must either be null or a function < code >
hey ! i 'm trying to use postcss-preset-env to transform properties like background-image : var ( -- vue-image ) for older browsers that do n't support css variables . the -- vue-image css variable references a url like this : url ( ' @ /assets/logo.png ' ) ; in the resulting css file , the additional background-image line inserted by postcss-preset-env is using the literal url entered on the css variable in the source scss file , not transforming it to the expected url which the browser will understand . interestingly , the -- vue-image variable 's url is correctly transformed though . i 've taken this screenshot in chrome dev tools for a clearer picture of what 's going on : my postcss.config.js file looks like this : i 'm not sure what else to try - have i missed something from the config file ? thanks ! 😀 < code > module.exports = { plugins : [ require ( 'postcss-import ' ) , require ( 'postcss-flexbugs-fixes ' ) , require ( 'postcss-preset-env ' ) ( { autoprefixer : { flexbox : 'no-2009 ' } , stage : 3 } ) ] }
today working with vite ( and several other tools ) i 've always worked doing a build for each environment with an .env file for each environment . ex . : however , in my understanding , having to do several builds hurts the principle of the twelve factor , and also makes the ci/cd process more time consuming . i 'm using a single build approach and configuring a script directly in html manually in each environment that makes some global variables available . ex . : < script src= '' config.js '' > < /script > . now i have something like this : however , there are some points in my solution that i do n't like : store all these settings in global variables on browser not having a good cache policy for this file , because this file does n't have a hash manage the config.js file manually what do you think of these points ? < code > vite build -- mode production .env.production < url > < url > config.staging.js < url > config.production.js < url > vite build -- mode staging .env.staging < url > vite build -- mode production .env.production < url >
vite documentation on why not bundle with esbuild ? while esbuild is blazing fast and is already a very capable bundler for libraries , some of the important features needed for bundling applications are still work in progress - in particular code-splitting and css handling . for the time being , rollup is more mature and flexible in these regards . that said , we wo n't rule out the possibility of using esbuild for production build when it stabilizes these features in the future . is there some github issue/discussion/project/label which is tracking the stabilization requirements to use esbuild in production ? < code >
i am getting error in my app for using decorators . exact similar issue seems to be fixed via # 2776. but fix is n't working for me . do i need to add anything to get it worked ? update : after bit of debugging , i narrowed it down to dep node modules which are using decorators . they are the ones having issues . < code >
i dynamiclly import css file like this import ( '/styles/dark.css ? dark ' ) .then ( ( ) = > { } ) ; by using style-loader & webpack i can add id atrribute to the style tag in case i can find and remove it . is there a way vite can do the same thing ? < code > { resourcequery : /dark/ , use : [ { loader : 'style-loader ' , options : { attributes : { id : 'theme-style ' } } } , 'css-loader ' ] , } ,
hey 👋 i 'm wondering if it 's possible to synchronously import assets dynamically , but in such a way that vite recognises it and includes them in the final bundle . something similar to const imageurl = require ( ' @ /assets/image/avatar/ < cur > { avatarid } .jpg ' ) . i tried multiple things , such as import ( ) , new url ( ... ) , import.meta.globeager ( ) , import ... from ' ... ' , but i could n't make any of them do what i want them to . before migrating to vite from vue-cli , this was as easy as doing require ( ' @ /assets/image/avatar/ < cur > { avatarid } .jpg ' ) . did i miss anything ? < code >
hi ! whenever i open a vite project , it automatically runs local server . is there any way to stop this ? i tried this but it does n't work : ( vite.config.ts ) < code > server : { // disable automatic dev server on project open ? // < url > open : false , } ,
hi , when i using @ vitejs/plugin-react , i find a prbolem that the class component can not hotupdate it self . shown as gif , when i changing test1.tsx which using function component the network only load test1.tsx but when i changing test2.tsx which using class component , the network not only loading test2.tsx but alse loading app.tsx then , i got @ vitejs/plugin-react 's code , i find it 's using react-refresh/babel when using react-refresh/babel , the function component has been added some code like `` refreshreg '' but the class component is the same ! so , it 's the react-refresh/babel 's problem ? < code >
is it possible to reference a variable from a .env file in the vite.config.js file ? in my case im trying to set up my proxy to rely on the value provided from the .env file < code > server : { proxy : { `` /api '' : { target : import.meta.env.vite_api_host , changeorigin : true , } , } }
hi all , i 'm having trouble understanding how to get hmr working for vue components which are added via a npm package . i 'm using the following setup : vite with vue as a project template vue npm components package if i add components directly in to the template ( 1 ) , i get hmr support . but whenever i add components via the vue npm package ( which is installed globally as a plugin in my main.js ) , it does n't support hmr and i have to reload the page whenever i make changes to the attributes of these components . is there anyway to support hot module reloading for the exported vue library components ? thanks in advance 🙂 < code >
i have a shared js class in a monorepo shared between my node and vue-based frontend code . it uses the cjs export syntax , i.e . exports.classa = classa . reading the documentation , i should be able to get vite to import this file by adding the path to the file in optimizedeps.include and build.commonjsoptions.include but i still get the error uncaught syntaxerror : the requested module '/ @ fs/c : /users/ < path-to-repo > /lib/classa.js ' does not provide an export named 'classa ' . my project is structured like this : classa does n't have any other dependencies . classb imports it like this : i have added the following to my vite.config.js to no avail : i have also tried to move the classa into /client/src/lib but that lead to the same error , just without the absolute / @ fs/ path . is this kind of setup just not supported by vite or am i doing something wrong here ? for reference : i created the client folder with the npm init vue @ latest and am currently running vite 2.8.4 on windows 10 . < code > / /index.js < -- node.js entry point /lib/classa.js < -- shared library /client/vite.config.js /client/src/lib/classb.js < -- class requiring classa /client/src/app.vue < -- classb is imported here export default defineconfig ( { // ( ... ) optimizedeps : { include : [ `` .. /lib/classa.js '' ] , } , build : { commonjsoptions : { include : [ `` .. /lib/classa.js '' ] , defaultismoduleexports : true , } , } , } ) import { classa } from `` .. / .. / .. /lib/classa '' ;
hi , at work i need to make it possible to change the environmet variables at runtime , from an azure web service , through docker and nginx . i tried this , this and some similar solutions , but i coul n't get any of them to work . i also could n't find any solution online or any article/thread/post that explained if this is even possible , i only always find the text that vite statically replaces the env variables at build time . during our ci/cd pipeline vite gets the env variables but our azure admins want to be able to configure them from azure , just for the case of it . does anyone know if this is possible and or maybe has a solution or som help , please ? : ) < code >
i am creating an electron application with a react user interface . i wanted to try out vite because of the fireship video i recently watched . however , i am running into a problem . whenever i try to use the html file in my vite app ( in this case , web/ ) , electron does n't display anything . but when i open the local web server , it works flawlessly . upon checking the index.html , it appears that it 's using a module import , which is n't supported in native html . in my own custom react template , i use webpack to compile my jsx to a `` small '' js bundle . so , is this possible in vite ? < code >
describe the bug i 'm trying to run vite on vue 2 , but it complains about template rendering due to missing the runtimecompiler : true option , which was easily configured in vue.config.js . how can i do it in a similar way so that there are no errors ? my vite.config.js my package.json error reproduction system info used package manager npm logs no response validations follow our code of conduct read the contributing guidelines . read the docs . check that there is n't already an issue that reports the same bug to avoid creating a duplicate . make sure this is a vite issue and not a framework-specific issue . for example , if it 's a vue sfc related bug , it should likely be reported to < url > instead . check that this is a concrete bug . for q & a open a github discussion or join our discord chat server . the provided reproduction is a minimal reproducible example of the bug . < code > all browsers , npm run dev
chrome have introduced a new header blocking requests to localhost without a preflight request : < url > this has broken our usage of vite , where we run the website during development on < url > and the vite dev-server at < url > . there has been an issue open since august 2021 on expressjs/cors to sort this expressjs/cors # 236 . i can not get the workaround provided to work with vite as we can only pass in a cors configuration object . is there any way to add this header ? < code >
i 'm trying to build a base component library for vue3 , written in typescript . i 've edited the vite.config.ts so i can generate separated , compiled components , instead of merging everything together , by setting rollupoptions.output.preservemodules to true . but when i run vite build , the d.ts files was n't generated . so i tried the tsc command , and i find that the tsc could not generate d.ts files for .vue files . so my problem is : what is the right way to generate a file-separated vue3 component library ? how can i generate d.ts for .vue files ? for example there is a component in src/divider/divider.vue . when i run vite build , i would like to generate a compiled component in es/divider/divider.js , and then also generate a es/divider/divider.d.ts for it . another example , here 's an util component library for vue : vueuc . i would like to generate files like it does . but the vueuc library was written in .ts only , is there a way for me to write it in .vue and accomplish the same result ? < code >
i am writing a test suite which makes use of import.meta.globeager , but it seems to be getting hoisted before other code which is intended to override some globals for testing purposes . so i am curious if it is hoisted and if there is a way to control that order ? < code >
hello there ! love the work you all are doing with vite ! how can i configure the path of the source js files ? i want to support this directory structure- i added root : 'public ' to my vite.config.js for index.html but could n't figure out how i can set the source directory 🤔 in the output , i would like to have index.html and index.js in the same directory . is this possible in vite ? < code > client/ - index.js public/ - index.html vite.config.js
i 'm trying to get the url of an asset in a node module . i 'm using ? url for this , but import path from `` some-module/asset.html ? url '' ; gives me missing `` ./asset.html ? url '' export in `` some-module '' package , indicating that the vite plugin did n't trim the ? url postfix when looking for the file . i 'm also publishing some-module myself here and i 've tried to explicitly list the asset filename in the exports of the package.json of the module , to no avail . is there any way to include assets into a vite build from a dependency ? the package.json of some-module contains something like this : i assume i 'm doing something wrong as the example in the guide for ? url is exactly for this usecase : an asset included from a dependency . any asset that does not require explicitly importing it as a url does work , like css files . any help would be very much appreciated ! < code > { `` exports '' : { `` ./asset.html '' : `` ./asset.html '' , } }
normally when i run the vite -- host command , it printed like this : but recently at the latest version , something weird heppens . now every time the server has started , vite also printed this and stuck for a really long time : and after a long time , this got printed ( even worse , sometimes the update just failed ) : actually in another project i was also using @ vicons and vite , so it 's only difference in versions of these packages . could this be a problem of the package @ vicons or is it a problem of vite ? cause i do n't understand why vite take these icon libraries as new dependencies every time it started . < code > 11:17:45 [ vite ] new dependencies found : @ vicons/utils , @ vicons/material , updating ... vite v2.8.4 dev server running at : > network : < url > > local : < url > 11:19:52 [ vite ] ✨ dependencies updated , reloading page ...
i created a new svelte + ts project . i started to write my stores , and i spent quite some time figuring out why readable < mytype | null > did n't work . after some research i discovered it was because strict was not enabled . i know typescript but i 'm not the ultimate expert , and finding why null was ignored took me quite some time . if i decide to use typescript , is because i want it to check my types . strict mode should be set as the default option , as it is in the default configuration created by tsc -- init . thoughts ? < code >
we are close to having every official rollup plugin included in the vite rollup plugins compatibility list . only three remains : @ rollup/plugin-auto-install + vue there is an open pr for it @ rollup/plugin-legacy in windows i sent a pr to the rollup plugins repo that fixes this issue if merged @ rollup/plugin-babel the babel plugin works correctly for vanilla . but i need help understanding how to do the setup when used with vue . conceptually , even if it works , i do not know if it is a good idea to recommend using babel with vite . if people are using babel to support old browsers , that is covered already by @ vite/plugin-legacy . the only use case i see where it is useful is to try experimental features like the pipeline operator . but if we use babel for transpilation , would n't that slow down the dev server ? in my opinion , i would only use experimental features if they are supported by esbuild ( or there is an esbuild plugin for them ) . i think i will label the @ rollup/plugin-babel as compatible , and add a note or link to an explanation . maybe it would be useful to add a note in the vite docs about what is recommended with regard to babel , as it would probably be a really common question ( maybe in a new q & a section ? ) < code >
i managed to install and use bip39 in dev mode . link : < url > however when i compile the entire project it doesnt work . example code : < url > error when you the built version : it doesnt transpile require correctly and some other dependencies i assume . i dont understand why it works perfectly in dev mode but not at all when i build the project . can anyone explain this to me or show me how to fix it ? < code >
describe the bug how to fix ssr-external failed to resolve entries for some packages ? reproduction none system info used package manager yarn logs validations follow our code of conduct read the contributing guidelines . read the docs . check that there is n't already an issue that reports the same bug to avoid creating a duplicate . make sure this is a vite issue and not a framework-specific issue . for example , if it 's a vue sfc related bug , it should likely be reported to < url > instead . check that this is a concrete bug . for q & a open a github discussion or join our discord chat server . the provided reproduction is a minimal reproducible example of the bug . < code > vite : ssr-external failed to resolve entries for package `` @ heroicons/react '' vite : ssr-external error : failed to resolve entry for package `` @ heroicons/react '' . the package may have incorrect main/module/exports specified in its package.json : failed to resolve entry for package `` @ heroicons/react '' . the package may have incorrect main/module/exports specified in its package.json . at packageentryfailure ( acme/node_modules/vite/dist/node/chunks/dep-e0fe87f8.js:30273:11 ) at resolvepackageentry ( acme/node_modules/vite/dist/node/chunks/dep-e0fe87f8.js:30269:9 ) at trynoderesolve ( acme/node_modules/vite/dist/node/chunks/dep-e0fe87f8.js:30044:11 ) at resolvessrexternal ( acme/node_modules/vite/dist/node/chunks/dep-e0fe87f8.js:30424:27 ) at object.ssrloadmodule ( acme/node_modules/vite/dist/node/chunks/dep-e0fe87f8.js:66752:40 ) none
i would like to use objectionjs & knex database in my vite app i have node & mysql installed on server how do i configure vite to use objectionjs & knex ? when i run npm run dev i would like app to start with mysql capabilities for use in my .vue files via objectionjs i have read backend integration documentation and ca n't figure it out < code >
i have a component a build for library , and use the code import.meta.env.mode in the component a. then publish to my private npm registry . now i use component a in my vue application b. then the import.meta.env is undefined when run dev . but can read the value in build . so how can i read the value of import.meta.env.mode in my component a when run dev ? < code >
i would like to know what build.lib.format is at build time use case : usage information ( we log which build our clients are using at runtime ) . this would also be useful for anyone who would like to change some values for different builds e.g . es , cjs and esm . current workaround : assuming i define process.env.vite_lib_type=umd in vite.config.js i can use import.meta.env in the code and at build it will be replaced . however this solution means i need to have two vite.config.js files . one for each build format e.g . es and umd . or is there a way to define an array of configs ? ideally there should be an environment variable set in import.meta.env for the build format e.g . this way i only need one configuration and i think this is a much more elegant solution . < code > { `` base_url '' : `` / '' , `` mode '' : `` production '' , `` dev '' : false , `` prod '' : true , `` build '' : `` umd '' // < -- -- - additional environment variable for library format } // app.js function buildtype ( ) { return import.meta.env.vite_lib_type || `` empty '' } // dist/app.js function buildtype ( ) { return `` umd '' }
vite : 2.8.x i 'm using react 's template , the template has include a vite-env.d.ts declaration file . how can i override some default declaration ? such as is there any solution to solve ? ref : microsoft/typescript # 14080 microsoft/typescript # 36146 < code > /// < reference types= '' vite/client '' / > declare module ' * .less ' { const classes : cssmoduleclasses export default classes // error : ts ( 2300 ) duplicate identifier }
hi ! i 'm using vite to create a frontend app that i integrate as part of a complete solution . it makes development much easier and vue sfcs are great . coming from php and symfony development i 'm still not all used to all these tools that magically makes things happen during development and build process so there are some things that i ca n't work out . i 'm hoping you guys can help me out here 🤗 what i would like to do once i 'm building the finished app is simply to generate the app file and the vendor file and publish those assets together with the already existing assets like css , images , backend templates and so on . during development i 'm injecting the vite client as well as the main.js file as part of the symfony templates , so not really using the provided web server and index.html . the assets already exists as part of the main application as well . so my questions are . am i doing it completely wrong by linking to the vite server instance client and app file in the main symfony application template during development ? is there a better way of doing this ? can i disable the static asset handling of the vue plugin ? this create errors during building/rollup saying that the assets are not part of the project making me have to use : src= '' < asset-link.jpg > '' instead of just src= '' < asset-link.jpg > '' . can i disable bundling of the entry file ( index.html ? ) on build ? thanks a bunch ! < code >
it seems that i have to use < url > if i want to use < url > is there a way to just add the layout function ? < code >
i made a fresh install of vite using the react js template . i tried to start it with 'npm run dev ' and got the following permission error . has anyone else had this problem ? any ideas how to fix it ? < code > error when starting dev server : error : listen eperm : operation not permitted 127.0.0.1:3000 ...
this behaviour is very strange to me . i have a fairly large site built using vite . i defined multiple npm scripts in package.json : my understanding of custom npm scripts is that they simply point to other executables ( as opposed to built-in commands that npm provides ) e.g . : what i 'm finding with my build command is that there 's a huge difference in building with 'npm run build : dev ' vs. the command it points to 'vite build -- mode dev ' : the issue is not just on my machine , it 's on other developer 's machines and also present in our teamcity builds : the only practical difference in between these builds are the build configuration . in one i build using the npm script , in the other i build using vite . any ideas ? < code >
hi . my vite project which is written in react works fine in developement mode , but when i create build using npm run build and the preview the app using npm run preview , app does n't load properly and shows errors in console ( i tried to fix the errors in the build files but more erros keep appearing ) . can someone please check the code and tell if there is some problem from my end or is this an issue in vite ! thanks in advance clone the repository to your machine : < url > change directory : cd quiz install dependencies : npm install < code >
after a few days of using vitejs/vite i was able to set it up on a php framework-based docker environment ( using ddev-local and typo3 cms ) . today i 've noticed an issue straight after finishing my hmr tests my /public/dist/ files are never updated . i expect that these files should update too ( transpiled / re-compiled/-built ) whenever hmr is triggered but it does n't . or do i misunderstand the whole concept of hmr and it should only work as-in browser only since it 's a hot module replacement ... ? do i have to extend my vite.config.ts to build manually ? < code >
i have react app created by vitejs and hosted on firebase hosting . now i need to share one page on facebook . so i need to add open graph for facebook . i saw the documentation for vite ssr . may i know it can host on firebase function ? < code >
i find the problem because of this issue : originjs/vite-plugin-federation # 120 ( comment ) . i start a vite server use 'localhost : xxxx ' to visit the page , hmr works well . when i set the host file like : 127.0.0.1 hello.com , and open the 'hello.com : xxxx ' , the hmr are not work , if you set the vite.config server.host : hello.com and then open the 'hello.com : xxxx ' , now hmr works again . but what i want is to use a domain to instead host : port . so i used nginx to do a proxy . now hmr are not work again . when the hmr not work , all my module federation compoment , are not work .... < code >
question when i use vite-plugin-istanbul in vite project , i got the incorrect line coverage . the script lable just has on statement `` import helloworld from './components/helloworld.vue ' '' , but the coverage date has more then 12 statement . so i dubug the vite-plugin-istanbul find the app.vue has been change to the images shows , because of ' @ vitejs/plugin-vue ' . if i ues @ vue/cli to create project with babel-plugin-istanbul i got the correct coverage so how can i get the real coverage with vite ? step yarn create vite ✔️ project name : vue3 ✔️ select a framework : `` vue cd vue3 yarn yarn add -d vite-plugin-istanbul yarn dev < code > // vite.config.js import { defineconfig } from 'vite ' import vue from ' @ vitejs/plugin-vue ' import istanbul from 'vite-plugin-istanbul ' // < url > export default defineconfig ( { plugins : [ vue ( ) , istanbul ( ) ] } )
i use vite on my new project , but find my webview can not show this page , it does n't load js file , even when i use the @ vitejs/plugin-legacy plugin , i use android studio debug find a message output `` access denied finding property `` net.dns1 '' have anyone else met the same problem ? < code >
a bit of context , i 'm porting a large app built with webpack to vite , my app is setup so each builds are agnostics and can be used on dev/staging/production and my backend is providing the base html file while injecting some environment variables . the assets generated at build are on a different domain that my actual app , < url > while my app is on < url > . my issue is that the path of the images are all starting with / , but i 'd like them to use < url > instead , in webpack i could set __webpack_public_path__ which did the trick but i ca n't find a way to do it with vite . here 's what i 've tried : using < base href= '' < url > '' / > wo n't because it 'll change all my relative path , including links to different pages < url > did n't seem to do anything at all , for information my app is built with react & js using base is not possible since my build have to be agnostics i could wrap my images in a function that add prefix them with my environment variable but i 'm really not keen on having to do that . do you have any other ways to solve my problem ? < code >
hi , i used the react template to create a react app using vite . midway into the project , it seemed a good idea to incorporate typescript . how can i add typescript to an existing react app created using vite ? i 've added typescript earlier to a cra project , but the following script did n't work in this case- yarn add typescript @ types/node @ types/react @ types/react-dom @ types/jest i would really appreciate some solution as i could n't find any link regarding this in the docs . thanks ! < code >
hello , in my vue3 project i have a couple of .scss file that are watched by dart sass independently of vite . most of the css i use is already in its final .css form and the sass files are only for some experiments , so i do n't need nor want vite to process them `` again '' , since that 's what sass is already doing in another console ( for other reasons , too ) . i have n't told vite to process .scss files , yet i am getting preprocessor dependency `` sass '' not found . must be some default magic happening here . sass also is n't listet in package.json of said project on purpose , because the project wo n't require sass or the likes . the dart sass binary was globally installed a while ago . it 's in the path and i can call it from the command line . the global node wrapper is also available and working . how can i prevent vite ( or whatever plugin is complaining ) from trying to process these .scss files interrupting me whenever i make some edits ? my html links to .css files in /public/ exclusively and i have no idea why vite 's trying to be smart here : - ) none of the vue components have a style tag let alone on for scss . if i dismiss the hmr error popup the site works flawlessly . hints & help appreciated . < code >
same aims as # 1231 , i want to copy some files from 'node_modules/ @ arcgis/core/assets ' to 'public/assets ' , here is my vite.config.js : here are my deps : it only work on prod mode . that is to say , when i run yarn build & & yarn serve , open < url > , the app run all well , but however , when i run yarn dev , the app access some resources in assets folder will report 404 : < code > import { defineconfig } from 'vite ' import vue from ' @ vitejs/plugin-vue ' import copy from 'rollup-plugin-copy ' export default defineconfig ( { plugins : [ vue ( ) , copy ( { targets : [ { src : `` node_modules/ @ arcgis/core/assets '' , dest : `` public/assets '' } ] , hook : 'writebundle ' } ) ] } ) { `` dependencies '' : { `` @ arcgis/core '' : `` ^4.19.3 '' , `` vue '' : `` ^3.0.5 '' } , `` devdependencies '' : { `` @ vitejs/plugin-vue '' : `` ^1.2.2 '' , `` @ vue/compiler-sfc '' : `` ^3.0.5 '' , `` rollup-plugin-copy '' : `` ^3.4.0 '' , `` vite '' : `` ^2.3.3 '' } }
this is my vite.config.js i use it in my project output : but i use it in a third party library why does this happen ? < code > export default defineconfig ( { define : { 'process.env.request_model ' : json.stringify ( 'requestmodel ' ) , 'process.env.request_model_default ' : json.stringify ( 'com ' ) , 'process.env.application_name ' : json.stringify ( 'yw-zdw ' ) , } , } ) onmounted ( ( ) = > { // @ ts-ignore const foo = process.env.request_model console.log ( { foo } ) } )
i found @ vue/eslint-config-prettier can works on vite . but i do n't know if it 's the right way to use it . the reason i use it is because it prompts me on vscode for the correct space limit i found good reference code , just set up a new project and run npm init vue @ latest i have solved this problem , thanks to the community < code > // .eslintrc.json { `` parser '' : `` vue-eslint-parser '' , `` env '' : { `` browser '' : true , `` es2021 '' : true , `` node '' : true , `` vue/setup-compiler-macros '' : true } , `` extends '' : [ `` plugin : vue/vue3-recommended '' , `` eslint : recommended '' , `` @ vue/typescript/recommended '' , `` @ vue/prettier '' , `` @ vue/prettier/ @ typescript-eslint '' , `` ./.eslintrc-auto-import.json '' ] , `` parseroptions '' : { `` ecmaversion '' : `` latest '' , `` parser '' : `` @ typescript-eslint/parser '' , `` sourcetype '' : `` module '' } , `` plugins '' : [ `` vue '' , `` @ typescript-eslint '' ] , `` globals '' : { `` global '' : true } , `` rules '' : { } }
hello . i found in official documentation this best way to load images from assets : my code : and i get an error and wrong url : < url > if i try for test laod 1 image all work fine : what is difference ? < code > import placeholder from ' @ /assets/hubs/placeholder-image.png ' ; < img src= '' /src/assets/hubs/placeholder-image.png '' >
hello all . i 'm migrating a large , old app to vite just to help with the awful build times , this app is changing teams and has not been using ts properly at all , so i 'd like to ignore ts errors on build entirely . is this possible ? the reason , ( that can go into a tangent about polyfills , core-js , etc , but feel free to ignore it ) , is because i 'm just trying to get the app to build to se if upgrading old libraries works . as the build keeps stopping at different points of the transformation , i suspect it 's due to ts and not , say , issues with core-js . it 's also stopped when transforming a date-fns esm file , and i believe that should n't happen . just an example : < url > < code >
os : centos stream ( in a virtualbox vm ) nvm : node version manager ( v0.38.0 ) npm : 8.4.0 i can use npm install -g yarn install success but when i use npm install -g vite report error like this i just spend a whole day time , i really want to know why , thanks ! < code > npm err ! code 127 npm err ! path /root/.nvm/versions/node/v16.13.2/lib/node_modules/vite/node_modules/esbuild npm err ! command failed npm err ! command sh -c node install.js npm err ! sh : node : command not found npm err ! a complete log of this run can be found in : npm err ! /root/.npm/_logs/2022-02-01t16_44_33_684z-debug-0.log
i would like to add mock mode for the purpose of web api mocking . in production mode , i do n't want the code for the mock to be bundled . is it the right way to use virtual file ? < url > i 'm using a virtual file to make it an empty module when in production mode . any other recommended way ? i use mirage js for web api mocking . 🙏 < code >
hi guys , i would like to import and use this cardano-serialization-lib-browser library , but could n't make it work . helloworld.vue but got this error message : please tell me what i did wrong , thanks . < code > uncaught ( in promise ) syntaxerror : the requested module '/node_modules/ @ emurgo/cardano-serialization-lib-browser/cardano_serialization_lib_bg.wasm ? import ' does not provide an export named '__wbg_address_free ' const cs = ( async ( ) = > { return await import ( ' @ emurgo/cardano-serialization-lib-browser ' ) } ) ( )
sample setup : < url > i want to use @ alias in package-a for src directory . package-b uses package-a as a dependency . when i start vite server from package-b yarn workspace @ vite-monorepo/package-b dev it fails with error because @ alias resolved from package-b root directory < code >
i have a project created with `` create-react-app '' . each js file in it is actually jsx . i would like to try vitejs to develop such project . the problem is that when i create vitejs 'react ' template project and try to rename '.jsx ' to '.js ' , i am getting syntax errors as vite parses such files as 'javascript ' files . i am wondering if there is a way to tell vite that all ( or some ) js files are actually jsx files ... if anyone knows any trick , please , let me know . thank you . regards , vadim < code >
hey guys/gals , quick question for vite pros ... i 'm working in a full-stack environment that has both browser and server code . sometimes , i need to share files across both environments and i accidentally import `` server '' files into the browser environment and get a bunch of indirect errors . this can take hours to debug . i was wondering what the right approach would be to create a file pragma for server files that would basically notify me when this occurs and the stack trace to fix . for example in the browser : in the server file i could have : this would notify me : `` you imported a server only file ! '' instead i get a bunch of unrelated errors from esbuild vaguely about the chalk dependency . < code > / * * server-only * * / import chalk from 'chalk ' // browser import { wronglogger } from './server-file '
when building , rollup seems to move the @ vitejs/plugin-vue helpercode to the `` main '' index chunk . all the other component chunks import that index chunk just for that one exported function . because the big index chunk changes easily , it 's contenthash changes between builds causing a cascade of all the other ( smaller ) chunks also having their contenthash change just because they import this little helpercode . it seems like inlining this tiny code might fix the issue -- or ensuring it is served in its own tiny chunk , but what is the actual thing causing the problems here ? the bigger issue i 'm curious about is why rollup tries to put such a tiny common piece of code into a huge chunk ? < code > / * index. < hash-1 > .js * / var oa= ( e , n ) = > { const t=e.__vccopts||e ; for ( const [ a , i ] of n ) t [ a ] =i ; return t } ; / * the helper code * / ... / * very big entry chunk * / export { ... oa as _ ... } ; / * somecomponent. < affected-by-hash-1 > .js * / ... ; import { _ as m } from '' ./index. < hash-1 > .js '' ; ... ... var v=m ( { name : '' somecomponent '' , ... ... export { v as _ } ;
i have an issue getting a rollup plugin to work with vite in dev mode . the plugin steveblue/rollup-plugin-inline-postcss processes tagged-template css code with postcss ( in my case , css inside lit elements ) . it works as expected with vite build without any specific configurations or enforced ordering . but when i vite dev it fails with the error enforcing pre or post makes no difference either . i have created a reproduciton for this issue here : 5310/issue_vitejs-rollup-plugin-inline-postcss , stackblitz what can i do to make this plugin work with vite dev mode ? any leads will be greatly appreciated . < code > 12:45:21 pm [ vite ] internal server error : /mnt/active/projects/personal/scratchpad/issue/issue_vitejs-rollup-plugin-inline-postcss/node_modules/.vite/lit.js ? v=98f0f383:1:2 : unknown word plugin : inline-postcss file : /mnt/active/projects/personal/scratchpad/issue/issue_vitejs-rollup-plugin-inline-postcss/node_modules/.vite/lit.js ? v=98f0f383 1 | // node_modules/ @ lit/reactive-element/development/css-tag.js | ^ 2 | var supportsadoptingstylesheets = window.shadowroot & & ( window.shadycss === void 0 || window.shadycss.nativeshadow ) & & `` adoptedstylesheets '' in document.prototype & & `` replace '' in cssstylesheet.prototype ; 3 | var constructiontoken = symbol ( ) ; at input.error ( /mnt/active/projects/personal/scratchpad/issue/issue_vitejs-rollup-plugin-inline-postcss/node_modules/postcss/lib/input.js:148:16 ) at parser.unknownword ( /mnt/active/projects/personal/scratchpad/issue/issue_vitejs-rollup-plugin-inline-postcss/node_modules/postcss/lib/parser.js:522:22 ) at parser.other ( /mnt/active/projects/personal/scratchpad/issue/issue_vitejs-rollup-plugin-inline-postcss/node_modules/postcss/lib/parser.js:149:12 ) at parser.parse ( /mnt/active/projects/personal/scratchpad/issue/issue_vitejs-rollup-plugin-inline-postcss/node_modules/postcss/lib/parser.js:59:16 ) at parse ( /mnt/active/projects/personal/scratchpad/issue/issue_vitejs-rollup-plugin-inline-postcss/node_modules/postcss/lib/parse.js:11:12 ) at new lazyresult ( /mnt/active/projects/personal/scratchpad/issue/issue_vitejs-rollup-plugin-inline-postcss/node_modules/postcss/lib/lazy-result.js:133:16 ) at processor.process ( /mnt/active/projects/personal/scratchpad/issue/issue_vitejs-rollup-plugin-inline-postcss/node_modules/postcss/lib/processor.js:28:14 ) at /mnt/active/projects/personal/scratchpad/issue/issue_vitejs-rollup-plugin-inline-postcss/node_modules/rollup-plugin-inline-postcss/index.js:62:79 at array.map ( < anonymous > ) at transformcontext.transform ( /mnt/active/projects/personal/scratchpad/issue/issue_vitejs-rollup-plugin-inline-postcss/node_modules/rollup-plugin-inline-postcss/index.js:62:44 )
hey guys , i am playing around with porting a pretty big react app of mine from cra to vite . i got most of the stuff working in development , but i am getting this error when i try to build it for production : can anybody point me in the right direction what is going on here ? thx and cheers < code > vite build vite v2.5.10 building for production ... 3357 modules transformed . could not resolve ' .. /internals/globalthis ' from .. /internals/globalthis ? commonjs-external error during build : error : could not resolve ' .. /internals/globalthis ' from .. /internals/globalthis ? commonjs-external at error ( /users/user/coding/vite-test/node_modules/rollup/dist/shared/rollup.js:158:30 ) at moduleloader.handleresolveid ( /users/user/coding/vite-test/node_modules/rollup/dist/shared/rollup.js:22263:24 ) at /users/user/coding/vite-test/node_modules/rollup/dist/shared/rollup.js:22257:26
i 'm vite with ssr and vue3 according to this example < url > i want to proxy certain requests via the proxy options , like this : this works fine when calling the endpoint < url > from postman or via browser . however it fails on when the app is rendered on the server . any help or advice here ? < code > vite = await require ( 'vite ' ) .createserver ( { root , loglevel : 'info ' , server : { middlewaremode : 'ssr ' , watch : { usepolling : true , interval : 100 } , proxy : { '/graphql ' : { target : ' < url > , changeorigin : true } } } } )
hello ! i am writing a package that will be used for both frontend and bakcend . i want to use vitejs compiler for this purpose . is vitejs suitable for such purposes ? let 's discuss this 🙂 < code >
vite already caches dependencies to the disk , as well as the browser . however , this mechanism does not apply in any way to local files ( i.e . files that are in the src folder usually ) . is there a reason for that ? right now for every page refresh the browser still has to make ~s+v calls ( s = number of files in src , v = number of modules references , that are in node_modules ) . the latter of the two is file-system-cached , but the former is n't . source files do change more often than dependencies , but when working on a project not all of them change - usually only a handful , or maybe a few dozen files change , but most files remain as-is . i 'd expect there to be some file-system cache for src files using their hash as a key possibly ( or last edited , or any other key that should be fine most of the time ) to avoid having to re-transform them + serve as an etag for the browser to use the cached versions . is there a reason this is not the case with vite ? < code >
while parceljs bundler for example has its own command parcel watch for using an external server ( like nodejs ) for development , i can not find out how to simply enable vite to use my node server.js file instead of its own . i have seen some pretty complicated code examples that have to be inserted into the server file , but i do n't want to clutter server files with additional external code , especially in case my colleagues do n't use vite . if that separation of concern can not be done simply i am ready to abandon vite , in that case that would be a big drawback . < code >
i have such a use case : user update any * .vue file extract css from all * .vue files using purgecss hot update css i 've got this code which injects the purged css at the startup of vite , but it wo n't get any hot update after modified the vue files . anyone can help me complete my code ? thanks ! ! < code > import { plugin } from 'vite ' import purgecss from 'purgecss ' function foobarcss ( ) : plugin { const module_id = ' @ foobar.css ' const module_id_virtual = '/ @ foobar.css ' return { name : 'vite : foobar ' , resolveid ( id ) { return id === module_id ? module_id_virtual : null } , async load ( id ) { if ( id ! == module_id_virtual ) { return } const purgecssresults = await new purgecss ( ) .purge ( purgecssconfig ) return { code : purgecssresults [ 0 ] .css , } } , } }
when i use < cur > ref syntactic sugar in the vue3 project , packaging and using vue-tsc -- noemit & & vite build will throw an error as follow : if any help ? < code > error ts2304 : can not find name ' < cur > ref ' .
i would like when creating the folder build/dist inside assets to add the folder images where all the images of my project are added , like this : < code >
when i exe npm run dev . an error like this . uncaught error : dynamic require of `` node_modules/selector-pc/index.css '' is not supported in the node_module js file require ( `` ./index.css '' ) ; but this do work : require ( `` ./index.js '' ) < code >
we have a big app , and we want to load some parts of the app after the page has rendered . we would like to use 'defineasynccomponent ' but the problem is that the component is on another server . so what we basically want is : this is right now not working with vite and vite-ssr-plugin . any idea how to we can do this ? < code > components : { asynccomp : await defineasynccomponent ( ( ) = > import ( `` < url > ) ) , } ,
when i was developing the vite plug-in , i found that in the transform hook stage , the url value of the background attribute of css is ' '__ vite_ asset__ e69fa01e__ ' , is there any way to get the real value ? like this < code >
hi this is a vanilla html css with minimal js project which in dev works fine . when i build it it 's outcomes is inconsisent , it works for 5 secs , then it stops and when it doesnt work . the issues are the background images and the links in the nav background : url ( `` /public/images/mobile/image-header.jpg '' ) console in firefox is returning a warning : layout was forced before the page was fully loaded . if stylesheets are not yet loaded this may cause a flash of unstyled content . link to live site link to repo < code >
while running the development mode , you will not be able to delete the complete resource files when packaging , and you will occupy resources and can not delete them . i do n't know if this is a bug . enotempty : directory not empty , rmdir ' f : \gitee\vue3-admin-vite-ts\dist\ueditor\dialogs\attachment ' < code >
hi , i 'm migrating a webpack app that has 2 entry points : entry.tsx is the spa entry point and can be handled easily in vite-land with a script tag in index.html but the second entry point is also important because it is used on third-parties website that reference it with a < script src= '' ourdomain.com/external-script.js '' / > . i tried using build.rollupoptions.input to add an additional entry point , but it create it in the asset directory with the hash in the name not the top level dist/ as webpack does . i tried to change this behavior with build.rollupoptions.output.entryfilenames but it does n't work either because it overwrite the whole vitejs naming scheme and not just my script . i guess one option would be to create a completely separate vite config in `` lib '' mode , but i was wondering if there is a better way to support this use-case ? related # 5317 < code > module.exports.default = { entry : { 'website ' : './src/entry.tsx ' , 'external-script ' : './src/external-script.js ' , } , }
when i change code and save the page , will dispatch 500-600 requests . the loaded spend more than 18s . every time full reload all file . < code >
i am using react and react.lazy to lazy load dependencies . while on development , everytime i navigate to a part of the app that triggers a lazy load a component , the deps of that component are detected as new dependencies , vite starts rebundling and the app fails to load the component ( probably due to a server connection closed ) . is there a way to avoid this ? is lazy loading ( using react.lazy + import ) not supported ? this was previously a webpack project < code >
apologies if this question has been discussed before ! i was recently playing around with a css modules alternative and wanted to try it out in astro ( which leverages vite under the covers ) . the alternative would rely on aliasing the package postcss-modules and instead resolving the alternative ( which is api compatible ) . however , in vite , this appears to be impossible as vite opts to bundle it 's dependencies as part of a build . things like lodash , postcss , etc . are included under dist/node/chunks . so a couple of questions : why build the dependencies instead of listing them within the package.json ? is there an alternative to aliasing these dependencies within vite and other tools that have come to rely on vite ? thanks ! < code >
hi , i am not sure if this is a bug with vite or rollup . spdx-license-ids and spdx-exceptions packages only provide json files , vite hangs indefinitely after having failed module resolution for those packages . for example , i installed a package ( @ pulumi/pulumi ) that installs spdx-license-ids transitively . vite fails with : [ commonjs ] failed to resolve entry for package `` spdx-license-ids '' . the package may have incorrect main/module/exports specified in its package.json . the closest issue describing what i think is happening is # 247. i added an index.js file that simply exports the index.json via module.exports in each of the offending packages locally in node_modules . vite was then able to complete the build successfully . what is the right way to fix this ? should i open a bug report here ? here 's my env info : < code > system : os : windows 10 10.0.19043 cpu : ( 4 ) x64 intel ( r ) core ( tm ) i5-7200u cpu @ 2.50ghz memory : 8.48 gb / 15.81 gb binaries : node : 14.17.0 - c : \program files odejs ode.exe yarn : 1.22.10 - c : \program files odejs\yarn.cmd npm : 6.14.13 - c : \program files odejs pm.cmd browsers : chrome : 91.0.4472.114 edge : spartan ( 44.19041.1023.0 ) , chromium ( 91.0.864.54 ) internet explorer : 11.0.19041.1 npmpackages : vite : ^2.3.3 = > 2.3.8
anyone have a good strategy for externalizing big dependencies so they are n't rebuilt all the time ? ideally a persistent cache would solve this problem , but until then , it 's so wasteful to keep rebuilding this dep all the time . < code >
i 'm tring a way to bundle office js lib on my artifacts following office guidelines . i 'm in a yarn pnp monorepo , and the goal is copy node_modules manually with a post processing . it 's relatively easy implement a post processing copy in a yarn project that has node_module resolutions . but i 'm unable to do that on pnp modules . any ideas ? < code > import { defineconfig } from 'vite ' import copy from 'rollup-plugin-copy ' import react from ' @ vitejs/plugin-react ' export default defineconfig ( { plugins : [ react ( ) ] , build : { rollupoptions : { plugins : [ copy ( { flatten : false , targets : [ { src : 'node_modules/ @ microsoft/office-js/dist/ * * ' , // < < -- pnp resolution dest : 'dist/assets/office-js ' } ] } ) ] } } } )
hi ! i 'm trying to migrate from cra to vite , but i 'm a bit stucked with some external dependencies . one of them is shpjs : < url > when i run vite dev , i get typeerror : global is not defined from an internal shpjs dependency ( lie library ) . if i add < script > window.global = window < /script > to index.html , then i get typeerror : buffer2 is undefined . i have tried some rollup plugins but i have n't solved it . could someone give me some ideas ? i 'm thinking on forking the library and remove all node dependencies to transpile it to a es module , but i guess that there is some kind of combination of plugin + configuration that i do n't know that solves this kind of problems sample repo is here : < url > thank you all ! < code >
hello ! i 've encountered an issue with my vuejs vite app . during the development , i always used absolute paths for every url ( in css , html and js scripts ) , be it an image src tag , link href or a css url ( ) import , like this : /pics/15.jpg or /companies/6.png . my problem is that , even though my dev build of the webpage works fine , since the server serves index.html from the root dir right away , on the actual deployment server , the folder structure is a bit different . its a standard php godaddy hosting , it has index.php file in the root which includes ( outputs , renders ) the index.html from ./landing/index.html , ./landing/ subdirectory is an actual location for the website files . reason for that complication , is apart of landing page , my server also hosts ./admin-panel/ which is a totally different project , but it has to be there . basically , my server 's folder structure : but my development structure : so my question is such : is there way to modify vite config somehow to make it transform all urls in all project files from `` /pics/path1/ '' to `` /landing/pics/path1 '' ? or are there better solutions ? if i use relative paths , then : vite rollup throws errors and doesnt build this still wo n't work , since page is actually rendered from root index.php file as : website.com/index.php and relative paths would be relative from that root page anyways , they 'd still need /landing/ prefix . thanks for any help ! < code >
currently , vite does n't perform well with large projects with a lot of modules ( 1000+ ) on dev mode . the bottleneck is on the browser side : chrome is unable to load 1000+ modules ( infinite pending on my computer ) firefox takes approximately 8s to load all of them ( cached or not in http1 ) and 26s with http2 ( maybe due to the tls layer ? ) the bundled app is less than 50kb but it requires a lot of dependencies ( i 'll provide a sample repo soon ) . so currently vitejs can not be used for large or very fine grained applications 😢 we could probably fix it by bundling and caching on the fly some of the modules . it 's not an simple task , but this could help a lot to scale vitejs . other ideas or solutions ? < code >
the simple question i have is how do i use vitejs with my own cdn . the longer question needs a bit of context . our spa is using vue and our backend is .net . our build process builds artifacts for both the spa and backend and sends them to octopus . octopus then creates releases to move the artifacts through the various environments such as dev , test , staging or production . the spa artifacts are deployed to azure . when we access our app ( app.domain.com ) assets are downloaded as expect and everything is great . recently we tried to place all static files on a cdn ( cdn.domain.com// , where is the environment name ) such that the app is still hosted at app.domain.com but all the static assets are pulled from cdn.domain.com . how can this be accomplished ? i 've seen the information on < url > however this sets the base path at build time . we need the base path to by dynamic so that we can move the generated package through our various environments which have slightly different cdn urls . does that make sense ? < code >
according to this thread i 've tried everything but i still ca n't get my env variables . i 've command : it works if i try to dump process ? .env ? .something anywhere else ( ex . tailwind config ) it shows whatever but i ca n't get it working in vite.config . this situation is exactly described in this comment but it does n't work for me . i 've also tried loadenv ( ) but it looks like it is only dot.env loader . another comment says it is out of date because of conditional config but all it knows it is in `` build '' command and `` production '' mode which is useless for this . how do you get env variable in vite config ? i 'm using vite 2.7.x < code > something=whatever tsc & & vite build
i use npm workspaces so there is a single package-lock.json at the root level . the ui package is large and it takes 3 minutes during development for vite to pre-bundle everything required . when i install dependency to some other package , the global package-lock.json is modified which probably invalidates the cache . and when i start the vite again , it pre-bundles everything again , which means another 3 minutes to wait . i have fixed it by generating a lock file in the package by `` postinstall '' : `` npm install -- package-lock-only -- ignore-scripts '' and it seems to work . is this the way to go ? < code >
hello , is there a specific reason ts-lit-plugin is not included in the lit-ts template ? or just an oversight ? it 's also part of the official lit typescript template , see here : < url > regards < code >
hi ! i 'm currently making a website with vite js and have a problem : i 'm using @ vanillajsx/jsx-runtime with this vite config here : problem : it shows the correct module as source map but there is another jsx_vanilla in node_modules/.vite/ and it has an error : and : when i remove the dependency from my whole project , it still provides this weird file in node_modules/.vite/ and i dont know from who it gets it . how can i just use the dependency i import ? < code > import { defineconfig } from 'vite ' export default defineconfig ( { esbuild : { jsxfactory : 'jsxruntime.jsx ' , jsxfragment : 'fragment ' , jsxinject : 'import * as jsxruntime from ' @ vanilla-jsx/jsx-runtime '' } , server : { fs : { // allow serving files from one level up to the project root allow : [ 'src/ ' , 'public/ ' , 'node_modules/.vite/ ' ] } } } ) uncaught typeerror : _b is null node_modules @ vanilla-jsx_jsx-runtime.js:115 leafviteapp leafviteapp.jsx:4 < anonymous > leafviteapp.jsx:10 index.js:3:35 jsx index.js:3 leafviteapp leafviteapp.jsx:4 < anonym > leafviteapp.jsx:10 innermoduleevaluation self-hosted:2374 evaluation self-hosted:2335
i 'm using vite via sveltekit , and i 've come across several packages which do n't define an export for their package.json , which results in vite throwing the following error : why does vite require this ? it seems like an antipattern , and certainly something that ca n't be depended on in the wider npm ecosystem . some prominent packages flat out refuse to export their package.json . < code > internal server error : missing `` ./package.json '' export in { pacakge } package
i 'm new to tailwindcss and it has me excited about graphic design again ! after working through setup tutorials online ( generally for older versions of tailwindcss ) i finally decided to just set it up from scratch in vite using a lit template . i was just wondering how i can view the tailwindcss tags being transformed into actual css in vite , the way the tailwindcss v3 demo shows in a side by side way ? in some of the older tutorials there was a output.css generated for the input.css . here in the vite environment i do not see a output.css file . where is it and how can i view the jit compiling in action ? < code >
hi , i 'm trying to expose vite ( dev server -- vite -- host 0.0.0.0 -- port 3000 ) from a docker container but when i try to access it from the host machine i 'm unable to reach it . while from inside the container everything looks good . this is a sample dockerfile to reproduce the problem may i get some help please ? thanks ! < code > from node:16-alpine run npm init -y vite @ latest test-app -- -- template vanilla workdir /test-app run npm install expose 3000 cmd [ `` npm '' , `` run '' , `` dev '' , `` -- '' , `` -- host '' , `` 0.0.0.0 '' , `` -- port '' , `` 3000 '' ]
hi ! 😃 i need to test local changes in a node_module that is used in a main application , and i 'd love to use vite and it 's devserver capabilities . however , i can not use the devserver url ( < url > etc ) in the project , and probably will need to include the files in the aforementioned application via yarn link . one downside of just using vite build -- watch though is that it 's super slow compared to vite 's devserver . is it possible to have the vite devserver write it 's files in memory to disk instead to get better performance instad of using vite build ? let me know if i can provide any clarifying information . thank you ! < code >
in production environment , i can mark the annotations as having no side effects by using / * # __pure__ * / to make tree shaking take effect . like this , it can worked fine in production : @ /utils/func-b @ /utils/func-a main.js use funca but in the development environment , tree shaking will not work . i was wondering is it possible to make tree shaking work in development as well ? there 's repo : vite-tree-shaking < code > import * as utils from ' @ /utils ' const fragment = document.createdocumentfragment ( ) fragment.append ( utils.funca ) import funca from ' @ /utils/func-a ' import funcb from ' @ /utils/func-b ' export { funca , funcb } class funcb { static init ( ) { const box = document.createelement ( 'div ' ) box.innerhtml = 'func-b ' return box } } export default / * # __pure__ * / funcb.init ( ) class funca { static init ( ) { const box = document.createelement ( 'div ' ) box.innerhtml = 'func-a ' return box } } export default / * # __pure__ * / funca.init ( )
using opencv-ts ( opencv with ts wrapper ) in vite is not working . i realized it is related with commonjs , esmodule , or like something ... but i ca n't understand i tried to change vite.config.ts but nothing worked . check my repo main branch < url > it crash immediately after open browser . < code > import { defineconfig } from 'vite ' import vue from ' @ vitejs/plugin-vue ' import { esbuildcommonjs , vitecommonjs } from ' @ originjs/vite-plugin-commonjs ' import { builtinmodules } from 'module ' import commonjs from ' @ rollup/plugin-commonjs ' ; // < url > export default defineconfig ( { plugins : [ commonjs ( ) , vue ( ) ] , // optimizedeps : { // esbuildoptions : { // plugins : [ // esbuildcommonjs ( [ 'opencv-ts ' ] ) // ] // } // } , build : { commonjsoptions : { transformmixedesmodules : true , include : [ `` opencv-ts '' ] } } } )
i have a project which has two entrances for pc and mobile . i want to bundle three chunks . one for mobile views call mobile.dep.js , one for pc views call pc.dep.js and a share.dep.js for common part . i found there are three functions in pc.dep.js which call commonjsrequiregetdefaultexportfromcjs_vitepreload after bundled . these functions cause share.dep.js import pc.dep.js , mobile.dep.js import pc.dep.js . what i expect is when i enter mobile view it only load mobile.dep.js and share.dep.js without pc.dep.js . question : is there a way to move these three functions into share.dep.js ? < code >
config : vite v2.6.4 , react v17.0.0 , firebase v9.5.0 when i deployed for the first time my app on netlify , it all went good . but when i go to my app its all blank and the console log me : uncaught firebaseerror : firebase : error ( auth/invalid-api-key ) . with the following content .env files ( .env.local , .env.production.local ) .gitignore file first time deployed firebase.js file by reading the < url > page i conclued to change my firebase.js by adding .production after import.meta.env like so : second time deployed firebase.js file and yet again a blank page but this time the console logged me this : uncaught typeerror : can not read properties of undefined ( reading 'vite_app_api_key ' ) if anybody has a clue , or now what to do , i will appreciate your help . if you want more informations let me know , i 'll reply to you or edit the dicussion . folder architechture < code > const firebaseconfig = { apikey : import.meta.env.production.vite_app_api_key , authdomain : import.meta.env.production.vite_app_auth_domain , projectid : import.meta.env.production.vite_app_project_id , storagebucket : import.meta.env.production.vite_app_storage_bucket , messagingsenderid : import.meta.env.production.vite_app_messaging_sender_id , appid : import.meta.env.productionuction.vite_app_app_id } node_modules .ds_store dist dist-ssr * .local .env .env.local .env.development.local .env.test.local .env.production.local const firebaseconfig = { apikey : import.meta.env.vite_app_api_key , authdomain : import.meta.env.vite_app_auth_domain , projectid : import.meta.env.vite_app_project_id , storagebucket : import.meta.env.vite_app_storage_bucket , messagingsenderid : import.meta.env.vite_app_messaging_sender_id , appid : import.meta.env.vite_app_app_id } vite_app_api_key= * thekey * vite_app_auth_domain= * theauthdomain * vite_app_project_id= * theprojectid vite_app_storage_bucket= * thebucket * vite_app_messaging_sender_id= * themsid * vite_app_app_id= * theappid *
i 'm trying to use import maps and vitejs , however i am running into several issues . i 'm using shim mode for es-module-shims.js . this means that the entrypoint looks something like this : so instead of module this uses module-shim . as a result vitejs is not using this index.html as an entry point . how can we resolve that ? < code > < script type= '' module-shim '' src= '' /src/main.ts '' > < /script >
config : vite v2.6.4 , react v17.0.0 , yarn v1.22.17 i made a /locales folder for translation via i18next , that i put in the /src folder . while developping i figure it out when i ran yarn dev that my locales does n't load and send me an error : failed to load resource : the server responded with a status of 404 ( not found ) so i moved the folder on the /root and ran again yarn dev , then it worked . before deploying my app i wanted to test its behaviour on production , so i ran yarn build . that created me a /dist folder with my /assets and my /index.html , but the /locales was n't inside . anyway i ran yarn serve this time to check the app on production , and it logged me again : failed to load resource : the server responded with a status of 404 ( not found ) if anybody know what to do i 'll take all advices . thank you for your help , i appreacite = ) . you 'll find an image below to understand where the /locales is . < code >
how the problem arises : access to vite in the project , an error is reported when running vite error corresponding file : return crypto.randombytes ( math.ceil ( len / 2 ) ) .tostring ( 'hex ' ) .slice ( 0 , len ) ; //this line reports an error in /node_modules/.vite/unique-string.js run framework , version : vue2.6.12vue-cli4vite2.5.5 ( not the latest version ) ask for advice~~ < code >
i have mpa mode and this is my config : this should output only page1.js , page2.js , page3.js & style.css but it adds to that also a style.js with sourcemap in it , this style.js is unnecessary and the application works without it , is this a bug how can this be fixed ? < code > export default defineconfig ( { plugins : [ react ( ) ] , build : { rollupoptions : { input : { page1 : resolve ( __dirname , `` page1.html '' ) , page2 : resolve ( __dirname , `` page2.html '' ) , page3 : resolve ( __dirname , `` page3.html '' ) , } , output : { manualchunks : undefined , entryfilenames : 'assets/ [ name ] .js ' , chunkfilenames : 'assets/ [ name ] .js ' , assetfilenames : 'assets/ [ name ] . [ ext ] ' , } , } , csscodesplit : false , sourcemap : `` inline '' , assetsinlinelimit : 0 , } , } ) ;
hi , i am using a solidjs app served by vite and i want to add solid-meta ( < url > ) to render tags in the . it talks about `` server setup '' to render the tags . how do i set up a server for this with vite ? solid-meta instructions say to set up the server ( i guess i just need one file ? ) : import { rendertostring } from 'solid-js/web ' ; import { metaprovider , rendertags } from 'solid-meta ' ; import app from './app ' ; // ... within the context of a request ... const tags = [ ] ; // mutated during render so you can include in server-rendered template later const app = rendertostring ( ) ; res.send ( ' < ! doctype html > < cur > { rendertags ( tags ) } < cur > { app } ' ) ; any help would be great . thanks ! jim < code >
describe the bug i run npm run build and when i go to a routes created with react-router i saw this s reproduction system info used package manager npm logs no response validations follow our code of conduct read the contributing guidelines . read the docs . check that there is n't already an issue that reports the same bug to avoid creating a duplicate . make sure this is a vite issue and not a framework-specific issue . for example , if it 's a vue sfc related bug , it should likely be reported to < url > instead . check that this is a concrete bug . for q & a open a github discussion or join our discord chat server . the provided reproduction is a minimal reproducible example of the bug . < code > system : os : macos 12.0.1 cpu : ( 8 ) x64 apple m1 memory : 41.49 mb / 8.00 gb shell : 5.8 - /bin/zsh binaries : node : 14.17.6 - /usr/local/bin/node yarn : 1.22.10 - /usr/local/bin/yarn npm : 6.14.15 - /usr/local/bin/npm browsers : chrome : 96.0.4664.55 safari : 15.1 npmpackages : @ vitejs/plugin-react : ^1.0.0 = > 1.1.0 @ vitejs/plugin-react-refresh : ^1.3.6 = > 1.3.6 vite : ^2.6.4 = > 2.6.14 git clone < url > npm i npm run build
describe the bug vite , , reproduction system info used package manager npm logs no response validations follow our code of conduct read the contributing guidelines . read the docs . check that there is n't already an issue that reports the same bug to avoid creating a duplicate . make sure this is a vite issue and not a framework-specific issue . for example , if it 's a vue sfc related bug , it should likely be reported to < url > instead . check that this is a concrete bug . for q & a open a github discussion or join our discord chat server . the provided reproduction is a minimal reproducible example of the bug . < code >
some packages should not , or can not be bundled , and should remain in production as external packages . in this case , there may be a problem with the bare module : it would be fabulous to have a plugin that would automatically inject map imports for all external packages : is it technically possible at all ? one of the use cases : electron application . you can use packages , that require the nodejs context , but in the browser runtime . or , you do n't bindle an dependencies at all . since this is an electron application , all dependencies are delivered locally and there is no need to optimize them . < code > < script type= '' importmap '' > { `` imports '' : { `` vue '' : `` /node_modules/vue/dist/vue.runtime.esm-browser.prod.js '' } } < /script > import { definecomponent as e , pushscopeid as t , popscopeid as n , resolvecomponent as o , openblock as r , createblock as a , createvnode as u , withscopeid as l , createtextvnode as c , fragment as s , ref as i , todisplaystring as d , createapp as p } from `` vue '' ; uncaught typeerror : failed to resolve module specifier `` vue '' . relative references must start with either `` / '' , `` ./ '' , or `` .. / '' .
it 's a bit annoying since i have to duplicate the resolve.alias 🤔 usecase is to enable absolute imports ... vite config : express : note the path is a bit different due to the location of the server.ts file < code > export default defineconfig ( { base : '/ ' , plugins : [ react ( ) ] , build : { manifest : true , } , // absolute import setup for vite resolve : { alias : [ { find : `` @ '' , replacement : path.resolve ( __dirname , 'src ' ) } ] , } , } ) const vite = await createviteserver ( { server : { middlewaremode : 'html ' } , // xxx : for some reason we need to configure this for absolute paths to work // even though we have this in vite.config.js resolve : { alias : [ { find : ' @ ' , replacement : path.resolve ( ' < cur > { __dirname } / .. / .. ' , 'src ' ) } , ] , } , } ) app.use ( '/ ' , vite.middlewares )
how can i console.clear ( ) whenever i update any file in my project ? without that , the console is quickly filled , and new messages are below the fold , so i constantly have to switch back to the browser and do a full refresh . that defeats the point of using hmr for me . i 've gotten this to work , but i have to put it in every single file in the project . i want to just put it in the root file . it 'd be even better if there were a way to do it in vite.config.js , so i do n't have to add extraneous things to my source . < code > if ( import.meta.hot ) { import.meta.hot.dispose ( ( ) = > { console.clear ( ) ; } ) ; }
hey , y'all ! i come from vue-clie and i 'm starting on vite ! in a test project , i 'm using vue 3 a syncfusion grid library . in the docs i 'm advised to set the value of runtimecompiler to true in vue.config.js : i 'm a little confused how i can make this work with vite . < code > module.exports = { runtimecompiler : true }
greetings , i am not sure of vite 's default behavior for build.rollupoptions.output.manualchunks option ? i am afraid if i change it to the following , i am going to lose something else from the default behavior . my goal is only to rename the vendor chunk without tampering with anything else . < code > manualchunks : ( id ) = > { if ( id.includes ( 'node_modules ' ) ) { return `` externaldependencies '' } }
i 've got a project to create a vite plugin and i wrote it in es modules . when i import it into vite.config.js from the local repository , it works just fine but when i install the plugin as a node module , it stops working.and i get the error : so my question is , do i need to run my vite plugin through a build step to generate a commonjs < code > import myplugin from './my-plugin.js // .... syntaxerror : can not use import statement outside a module
greetings and thank you for this useful library . i have the following vite.config.js . currently , when building , vite is placing the html files nested inside folders according to their relative path from root . however , i want them to be flattened and renamed inside the ourdir . how can i achieve this ? < code > import { defineconfig } from `` vite '' import vue from `` @ vitejs/plugin-vue '' export default defineconfig ( { root : `` src '' , publicdir : false , server : { port : 19940 } , build : { outdir : `` .. /www '' , assetsdir : `` '' , emptyoutdir : true , rollupoptions : { input : { operationalexcellence : `` /informationtechnology/userexperience/operationalexcellence/client.html '' } } } , plugins : [ vue ( ) ] } )
hi : when i use less to write the style , i want to inject less variables into vite.config.ts globally , just like the 'style-resources-loader ' plugin . pluginoptions : { 'style-resources-loader ' : { preprocessor : 'less ' , patterns : [ path.resolve ( __dirname , `` ./src/theme/color.less '' ) ] , } } , what should i do , please ? < code >
i am using vuepress v2 with vitejs for bundling . i am facing an issue while developing a custom theme . the vuepress starts normally in dev environment . however , when i try to access localhost:8080 then i receive following error : the error is shown when i am using the following configuration for vitejs in the vuepress config.js file . the vitejs configuration was used from the docs mentioned here : < url > commenting out the vitejs configuration fixes the issue . i figured that this issue is mentioned in the github issue ( # 5380 ) as well . however , i can not identify the resolution for the issue . how to fix the vitejs configuration for using variable defined in quasar framework ? < code > bundlerconfig : { viteoptions : { plugins : [ vue ( { template : { transformasseturls } } ) , quasar ( { sassvariables : path.resolve ( __dirname , './theme/css/quasar-variable.sass ' ) } ) ] , } , vuepluginoptions : { } } [ vue warn ] : component is missing template or render function . at < mylayout > at < asynccomponentwrapper > at < vuepress onvnodeunmounted=fn < onvnodeunmounted > ref=ref < proxy { < target > : { } , < handler > : { } } > > at < routerview > at < vuepressapp >
hello ! if i give as input where content a.scss and b.scss is identical , i got only one generated file and randomly a . [ hash ] .css or b . [ hash ] .css am i wrong or is it a bug ? problem is also in bundle parameter in plugin hook ( filename contains a but name contains b ) thanks < code > rollupoptions : { input : { a : ' a.scss ' , b : ' b.scss ' } }
hi , everone . i create my vue project with vite . this is my simple routes : const routes = [ { path : '/ ' , name : home , component : home } , { path : '/about ' , component : ( ) = > import ( ' @ /pages/about.vue ' ) , } , ] ; everthing works well . whenever i click the about link it will load the about.xxxx.js file . is it possible to prefetch the js files when home loads ? < code >
# 5805 describe the bug scenes : when vite starts , i want to control the introduction of other plugins through my plugin so i imagine to change the configuration through the config hook for example , but it is not working , online demo i read the source code and found a problem with config.ts , i found that mergeconfig merged plugin does not appear in preplugins , normalplugins , postplugins vite/packages/vite/src/node/config.ts lines 317 to 326 in d980ad1 const userplugins = [ ... preplugins , ... normalplugins , ... postplugins ] for ( const p of userplugins ) { if ( p.config ) { const res = await p.config ( config , configenv ) if ( res ) { config = mergeconfig ( config , res ) } } } vite/packages/vite/src/node/config.ts lines 476 to 481 in d980ad1 ; ( resolved.plugins as plugin [ ] ) = await resolveplugins ( resolved , preplugins , normalplugins , postplugins ) i plan to provide a pr to fix it , need some time reproduction < url > < code > import { defineconfig } from 'vite ' import vue from ' @ vitejs/plugin-vue ' // < url > export default defineconfig ( { plugins : [ { name : 'my-plugin ' , config ( ) { return { plugins : [ vue ( ) ] } } } ] } )
since i see the team is not planning on enabling multiple build configs like rollup , i 've been working on a node script to run multiple instances of vite . i 'm able to build a config and run it with vite.build ( config ) however , i 'm not seeing an option for running in dev mode , equivalent to vite dev . i tried setting the mode to mode : 'development ' but that did n't seem to do it . is there another way to run vite dev without the cli ? < code >
i am trying to get my sw.js file url to activate it in my main.js file , so i am doing an import swurl from './sw.js ' hoping swurl being the sw.js path before the build , but it ends with a error : 'default ' is not exported by sw.js , imported by src/main.js , how could i archive that ? please < code >
i 've used vite on other vanilla js projects without problems on this same machine , but when starting a new project with react-ts and running npm run dev localhost just shows `` this site ca n't be reached '' . any idea why this would be ? i have n't changed anything in the template , it 's jut as-is . < code >
problems with determining the target from an external source : requests to < url > api work , but not external end point . found a duplicate : # 564 , but it 's closed . < code > proxy : { `` /check-external-https '' : { target : `` < url > '' , changeorigin : true , secure : false , } }
hi all , i 'm just getting started with vite . i find it super amazing to use . thank you for all the hard work ! i 've a small question . i 'm trying to extract all the legal comments from vendor.js in a different file to keep my actual js file small . i found this issue : # 4907 which suggests using terser and it works . but , i 'd prefer using esbuild for its speed . i tried something like : but that does n't change anything . here 's the api reference of esbuild : < url > i thought i could pass on transform api options using vite config , am i doing it wrong ? < code > export default defineconfig ( { esbuild : { legalcomments : 'external ' } } )
hello , i have some problem when by running npm run build command . it shows rollup failed to resolve import @ shared/styles/global.module.less ? used '' from `` src\pages\payments\payments.tsx . when i switch this into relative path like .. / .. / .. /shared/styles/global.module.less npm run build does n't show any errors . my tsconfig paths for .ts and .tsx works fine . here is my config for tsconfig.paths.json vite.config.ts any ideas ? < code > export default defineconfig ( { plugins : [ tsconfigpaths ( ) , eslintplugin ( ) , vitestylelint ( ) , createimportplugin ( { babelimportpluginoptions : [ { libraryname : 'antd ' , style : true , } , ] , } ) , resolve : { alias : [ { find : /^~/ , replacement : `` } ] , } , css : { preprocessoroptions : { less : { javascriptenabled : true , } , } , modules : { generatescopedname : ' [ name ] _ [ local ] _ [ hash : base64:5 ] ' , } , } , } ) { `` compileroptions '' : { `` baseurl '' : `` ./ '' , `` paths '' : { `` @ atoms/ * '' : [ `` src/components/atoms/ * '' ] , `` @ organisms/ * '' : [ `` src/components/organisms/ * '' ] , `` @ molecules/ * '' : [ `` src/components/molecules/ * '' ] , `` @ templates/ * '' : [ `` src/components/templates/ * '' ] , `` @ pages/ * '' : [ `` src/pages/ * '' ] , `` @ redux/ * '' : [ `` src/redux/ * '' ] , `` @ shared/ * '' : [ `` src/shared/ * '' ] } } , `` include '' : [ `` src/ * * / * .less '' ] }
here is my config if i remove resolveextensions , esbuild will throw error : could not resolve `` ./src/checkbox '' , this is a vue file . if i turn it on , esbuild will throw no loader is configured for `` .vue '' files : node_modules/element-ui/packages/checkbox/src/checkbox.vue how to fix this ? < code > { optimizedeps : { esbuildoptions : { resolveextensions : [ '.mjs ' , '.js ' , '.ts ' , '.jsx ' , '.tsx ' , '.vue ' ] , } , } , }
hello ! i have a global style that i import in my main.js : in my router file , if i import my components like : when i do this , my style overload element-plus style . if i use dynamic import , my style do not overload element-plus style : i thought it was link to css code split , but it seems not . i tried with build : { csscodesplit : false } , do you have any idea , how i could do this ? : ) < code > import { elbutton , elcard , } from 'element-plus ' ; ... import 'style/style.scss ' ; ... createapp ( app ) .use ( router ) .use ( elbutton ) .use ( elcard ) .mount ( ' # app ' ) ; import main from ' @ /pages/main .vue ' ; ... const routes = [ { path : '/ ' , component : ( ) = > import ( ' @ /pages/exmain.vue ' ) , ... const routes = [ { path : '/ ' , component : ( ) = > import ( ' @ /pages/main.vue ' ) ,
i 'm using vite for a react/typescript project . i have a web worker script worker.ts that has no imports or exports . vite stipulates that the typescript isolatedmodules flag is required for proper use with esbuild . typescript complains that since isolatedmodules is set to true , my worker.ts needs to use import/export . do i just add a export { } at the end of the file to shut the compiler up or some other solution ? additionally , i had to remove the lib list as i was getting some conflicts when i enabled the web workers one . any ideas here as well ? < code >
hi , i need to get web worker file path instead of using ? worker because i wo n't initialize it manually , i need to pass it to emscripten 's locatefile . when i try to do this i get uncaught syntaxerror : can not use import statement outside a module because vite is appending import { injectquery as __vite__injectquery } from `` / @ vite/client '' ; at the beginning of my worker file . i 've tried importing using ? url , new url ( ) , i 've tried adding it to optimizedeps.exclude . nothing seems to help , vite is always appending injectquery . i ca n't modify my worker file because it 's output file from emscripten ( it 's generated automatically during build ) is there any way around it ? thanks , bartosz < code >
on the vite vue 3 typescript template the ts compiler only runs on build . what 's the best way to run it while developing and saving files ? < code >
minify css using esbuild got this error . my project works fine on 2.5.x but failed at 2.6.x and 2.7.x < code > vite v2.7.0-beta.5 building for production ... 2950 modules transformed . rendering chunks ( 1 ) ... /users/julytang/work/code/astore/astore-editor-plugin/node_modules/ < email > /lib/main.js:170 throw new error ( `` invalid packet '' ) ; ^ error : invalid packet at bytebuffer._read ( /users/julytang/work/code/astore/astore-editor-plugin/node_modules/ < email > /lib/main.js:170:13 ) at bytebuffer.read32 ( /users/julytang/work/code/astore/astore-editor-plugin/node_modules/ < email > /lib/main.js:179:40 ) at decodepacket ( /users/julytang/work/code/astore/astore-editor-plugin/node_modules/ < email > /lib/main.js:131:15 ) at handleincomingpacket ( /users/julytang/work/code/astore/astore-editor-plugin/node_modules/ < email > /lib/main.js:717:18 ) at socket.readfromstdout ( /users/julytang/work/code/astore/astore-editor-plugin/node_modules/ < email > /lib/main.js:596:7 ) at socket.emit ( events.js:314:20 ) at addchunk ( _stream_readable.js:297:12 ) at readableaddchunk ( _stream_readable.js:272:9 ) at socket.readable.push ( _stream_readable.js:213:10 ) at pipe.onstreamread ( internal/stream_base_commons.js:188:23 )
i 'm trying to create a plugin that injects css at the end of the bundling pipeline ( it relies on the contents of the js files which is why it has to happen at the end ) . as i understand , renderchunk is the right place to do this , and for the sake of a very basic example , let 's say it looks like this : i 'm not sure how to do this . i know about emitfile but that generates a new file which is not really what i want . i 'm not sure how i would tell users the name of the built file or how to incorporate it . so i 'm thinking maybe there is another way ? any pointers in the right direction would be awesome . < code > export default function myplugin ( ) { return { name : 'my-plugin ' renderchunk ( code , chunk , options ) { // inject ' * { color : red } ' into final css bundle } } }
currently , when we have a proxy setup , vite will downgrade from http2 to http1 . this invalidates the assumption that because we use http2 , serving many files through vite will not have a significant performance impact . this leads to a suboptimal developer experience when proxying is required . currently the http-proxy dependency that vite uses is unmaintained ( they have been trying to do http2 proxying and it has not progressed in the last seven years ) . and while http1 proxying may work for now , as http3 approaches vite will fall further and further behind internet standards . what i think we can do for now is to use http2-proxy since it appears to at least be updated more frequently and actually allows for proxying through http2 . context : # 4184 < url > < code >
as seen in the docs , the polyfills can be configured core-js . but we are using a package @ dian/polyfill ( like react-app-polyfill ) . is there a way to config like polyfills : [ `` @ dian/polyfill '' ] ? < code > import legacy from ' @ vitejs/plugin-legacy ' export default { plugins : [ legacy ( { polyfills : [ 'es.promise.finally ' , 'es/map ' , 'es/set ' ] , modernpolyfills : [ 'es.promise.finally ' ] } ) ] }
hi . i have a worker named something like myworker.worker.ts it 's imported as 'myworker.worker.ts ? worker ' in a vue component as per vite documentaion however , jest does n't seem to like it . ' could not locate module / @ /myworker.worker.ts ? worker mapped as : c : \dev\project\src < cur > 1 . ' the following used to work in a test file when my project was built with webpack : i 've tried messing with some of the jest.config settings but no joy . any ideas ? < code > please check your configuration for these entries : { `` modulenamemapper '' : { `` /^\/ @ \/ ( . * ) < cur > / '' : `` c : \dev\project\src\ < cur > 1 '' } , `` resolver '' : undefined } jest.mock ( '/ @ /myworker.worker ' , ( ) = > jest.fn ( ( ) = > ( { postmessage : jest.fn ( ) , terminate : jest.fn ( ) } ) ) ) ;
in build , even though i set process.env.node_env as `` test '' , but in vite.config.ts , it is always be production ? why ? ? ? ? ? ? ? < code >
hi all , i was wondering if anyone knows if this is possible , something i was able to do with nuxt .... build the pre-rendered output of your site . the css for the individual page will be injected into the of said page , so it loads with the pre-rendered page . you can define a global css file which will also be injected into the for every page and loaded with the pre-rendered page . or maybe , it determines which styles from the global css is used on each individual pages too ( then it loads the whole global css lazy in the background when the network is free ) when you navigate to other pages ( which will just be via the modules ) it just loads the individual pages css . and the global css is already loaded from the initial single page load . some may say , you cant cache the css then . but that is okay for me . < code >
hi folks , i have a simple one page js app ( in preact ) and i 'd like to add couple static html pages to it ( `` about '' , `` contact '' , etc ) , really static , just plain html as authored . since i have some dynamically built global styling ( scss ) , i 'd like these pages to reference global stylesheet that 's being processed by vite ( and later rollup during build ) . i tried with vite 's own multi-page app feature by specifying these additional pages as extra entry points , this works fine if these pages are `` sub-applications '' . this means i have to load global styles by way of importing them in js which produces a lot more assets which are significantly slowing down page load ( single threaded http server running on single-core mcu ) . is there a way to reference that global styles without making these pages sub-applications ? a rollup plugin would do the work during build , but how about dev ? < code >
in my vite project i have set up jest using esbuild-jest as a transform ( so i do n't have to use babel ) . it almost works great , but any test that accesses a module that has a import.meta.env in it results in the following error : typeerror : can not read property 'vite_my_env_var ' of undefined it seems that the env property of import.meta is not defined . any idea why this is and how to solve ? < code >
when a web server ( e.g . nginx ) is sitting in front of the vite dev server and acting as a proxy , there is a frequent visible page refresh that happens automatically . if i remove the nginx proxy , the issue disappears . however , then i need to different cross-origins for the ui and api containers . i 've got an example repo that illustrates this behavior here : < url > requirements : docker , docker-compose to use the browser included with cypress , ensure you 've run xhost local : root ( on linux ) . otherwise , map boilerplate.local to 127.0.0.1 in /etc/hosts : launch the services : navigate to the application in a browser . the automated page refresh is visible . any ideas on how to prevent the visible refresh without getting rid of the proxy ? < code > cd web-vite-api-data docker-compose up -d docker-compose ps git clone < url > 127.0.0.1 boilerplate.local
it is working fine on the single entry page . as this q & a says # 5081 but how can i customize static assets relative path when i have a structure like this : window1/index.html and 2 's assets path has always been set to /assets/ ... / somefile or ./assets/ ... /somefile whenbase seted to `` . '' ( same with root index.html ) file resources load by file : /// protocol , and it 's only working with relative paths . and the app was built for browsers too . am i missing any details in the documentation ? < code > index.html | -- - window1 | | -- -- - index.html | -- - window2 | | -- -- - index.html
hello , i am facing something strange . when i get the vue instance with vue-cli . i get a proxy with < cur > store , < cur > router etc . but with 'vite ' i get a proxy from which i ca n't find < cur > store etc . with vue-cli based app : with vite based app : does anyone know how to get the instance up vite ? did i miss something ? thanks by advance . = ] < code > let app = createapp ( app ) .use ( store ) .use ( router ) .mount ( `` # app '' ) ; console.log ( app ) ;
my web server is provieded by other host like aaa.bbb.com , so i just add this code in my html to use vite dev but the host of sourcemap file is aaa.bbb.com not 10.4.50.122:1888 , how can i change host of sourcemap to my ip 10.4.50.122:1888 < code > < script type= '' module '' src= '' //10.4.50.122:1888/src/js/app.js '' > < /script > < script type= '' module '' src= '' //10.4.50.122:1888/ @ vite/client '' > < /script >
we all know that vite will automatically use rollup for bundling in the production environment , so how can we directly use or not bundle for certain performance-insensitive scenarios ? i think this can improve the cache hit rate of a single file . < code >
i know there were a lot of discussions , but the problem still exists . we all would like to have one tool to do everything . a similar example would be `` parcel '' , `` microbundle '' bundlers . so the problem is that currently , you need a separate process/script/config to build a type for your awesome library . the idea 💡 would be for vitejs - if this is library mode take a look at package.json and see if there is a `` types '' key in json - that would mean to enable type generation after build to the specified file path . take a look at tsup builder - it uses rollup plugin for generating type definitions < url > it could be solved in a similar way - right ? < code >
i have an application that once built produces two different index.html pages for two different brands , for example index-a.html and index-b.html . the production web server then chooses which of these html files to serve in spa mode based on the domain that the request is coming from , so < url > goes to index-a.html and < url > goes to index-b.html i 'm trying to replicate this with the vite dev server , but i ca n't because the served page is hard-coded as index.html which you can see in the spafallback middleware . i 've attempted to override this , but i either get into an infinite redirection loop , or the server never serves the request . is there a way to do this with the vite dev server , or should i raise a feature request in the main repo ? < code >
i 'm puzzled by a a warning i see when i run vite that seems to come from babel , was under the impression that vite was using esbuild , so where is this warning coming from ? my vite config , < code > import { defineconfig } from 'vite ' import react from ' @ vitejs/plugin-react ' import path from `` path '' ; import reactsvgplugin from `` vite-plugin-react-svg '' ; // < url > export default defineconfig ( { envprefix : `` public_app '' , plugins : [ react ( ) , reactsvgplugin ( ) ] , resolve : { alias : [ { find : `` src '' , replacement : path.resolve ( __dirname , `` src/gitsubmodule/src '' ) , } , ] , } , server : { fs : { strict : true , allow : [ `` . `` ] , } , } , } ) [ babel ] note : the code generator has deoptimised the styling of /home/me/my-repo/node_modules/.vite/chunk-7l3spmwf.js ? v=69f76dad as it exceeds the max of 500kb .
using vue-cli i have proxy settings something like this so i m sending request to a target for all requests excepts few whitelisted urls . now using vite proxy ( which is using node-http-proxy ) i did't find any way to bypass a url . what would be the equivalent of above code using vite proxy ? < code > proxytable : { '/baseurl ' : { target : ' phofurl changeorigin : true , bypass : function ( req , res , proxyoptions ) { if ( urlwhitelist.includes ( req.originalurl ) ) { return joinurl ( assetspath , `` index.html '' ) ; } } , }
i try to use vue2 by vite , and my project build the index.html is wrong unicode and can not correct display . i never meet this problem , how can i fix it . my vite.config.js is on < url > < code >
hi . i 'm using vite-2.4-vue-3.2.1 . however , the old defineemit import mode stopped working right after the upgrade . before , everything was fine . i 've already tried to change it to a possible new format , but to no avail . < script setup= ' { emit } ' > const emit = defineemits ( [ 'logon ' , 'logout ' ] ) when we call the emit ( ... ) results in : `` uncaught typeerror : _ctx.emit is not a function . '' has anyone solved this problem ? can you indicate an example with emit working in the new format ? thanks . < code >
ok , so this is version 3 of this question . having continued to try to understand the problem i 'm facing , i think i 've narrowed it down to the fact that some of the packages imported by my app and from the pnpm monorepo the app is part of ( using pnpm 's `` package-name '' : `` workspace : * '' style of dependency declaration ) . so , in short , does anyone know of a definitive guide to using vite and pnpm together ? i 've spotted a couple of related issues , but i 've not been able to understand the `` solutions '' . < code >
i need to use ssi include file with invalid html tag in my project which vite can not parse . include file content : vite is giving me this error on console : i ca n't fix the include file on my side so i 'm looking if it 's possible to work around it . i think i can workaround this if i can : run a plugin before vite read this index.html so i can load the file and the invalid tag will be fixed . i tried playing around with enforce property of plugin but it did n't work as i expected . some way to allow invalid html tag . i ca n't get codesandbox to show the error so no sandbox . sorry about that . < code > [ vite ] internal server error : unable to parse { `` file '' : `` index.html '' , `` line '' : 1 , `` column '' : 1 } < div > ^ at traversehtml < ! -- index.html -- > < div > hello < ! -- vite detects invalid html tag , errors out -- > < div > < ! -- # include virtual= '' /some_part.html '' -- > < /div > < ! -- some_part.html -- > < span > text < /span > < span > text < /span > < span > text < /span > < /div >
on the vite.config.ts i 've change the and i still get localhost:3000 when i try to do yarn dev i 'm basing this changes from stackoverflow < url > also applied this changes also on host file in windows os < code > base : '/admin.ecommerce-backend.test/ ' ,
no matter which one i choose below : the generated result will always be like this : what i really want is : or i 'm asking this because it really matters when used in electron . is there any official ways to do that ? i could n't find any answer in the doc . thanks for help ! < code > < script type= '' module '' crossorigin src= '' ./assets/index.a3377d47.js '' > < /script > < link rel= '' modulepreload '' href= '' ./assets/vendor.98ac8201.js '' > < link rel= '' stylesheet '' href= '' ./assets/index.163c7cae.css '' > < script type= '' module '' crossorigin src= '' /assets/index.a3377d47.js '' > < /script > < link rel= '' modulepreload '' href= '' /assets/vendor.98ac8201.js '' > < link rel= '' stylesheet '' href= '' /assets/index.163c7cae.css '' > < script type= '' module '' src= '' index.ts '' > < /script > < script type= '' module '' crossorigin src= '' assets/index.a3377d47.js '' > < /script > < link rel= '' modulepreload '' href= '' assets/vendor.98ac8201.js '' > < link rel= '' stylesheet '' href= '' assets/index.163c7cae.css '' > < script type= '' module '' src= '' ./index.ts '' > < /script > < script type= '' module '' src= '' /index.ts '' > < /script >
hello ! i was wondering whether there 's a standard approach to handling duplicate imports when css code splitting is enabled . importing a css file in a given js module seems to reconcile duplicates automatically . given the entry point ... ... colors.css will only be imported once ( which is what i want ) . however , if some other js file then imports a stylesheet that also relies on colors.css , colors.css will be imported again even though it 's already available on the client ( either via a < style > tag in dev mode or a linked stylesheet in production builds please correct me if i misunderstood this ) . i 'd like to know whether there 's a way to avoid these duplicate imports across all js files , not just in the context of a single css import entry point . we have quite a few large design token files capturing variables for colour , space , animations etc , which are imported extensively across the project . < code > / * styles.css * / @ import `` ./colors.css '' ; @ import `` ./other.css '' ; .class { color : var ( -- red ) ; } / * other.css * / @ import `` ./colors.css '' ; .other { color : var ( -- red ) ; }
form the docs : if you 'd rather have all the css extracted into a single file , you can disable css code splitting by setting build.csscodesplit to false . in searching for said single file , my first thought was that there is some standard location for a main.css file which vite then processes into a single production css file , but from the lack of docs on this , and from observing the actual behaviour , i take it that there is no automatic handling for css files if you disable css code splitting ? is my understanding correct if i opt out of css code splitting , i should handle the build pipeline for my css files some other way ? < code >
in webpack , i can option.js user.vue in vite , how can i do for achieve the same effect < code > const option = require ( '/src/option/user/option ' ) .default ( this ) ; export default ( vm ) = > { return { a : vm.b+vm.c } }
i use vite build my vue2 component library . vite config is as follows : after build finished . output files as follows : /lib/table/index.umd.js , /lib/table/style.css . i expect css file 's output path to be /lib/table/style/index.css . how do i modify the configuration ? < code > build : { emptyoutdir : true , outdir : outpath , lib : { entry : path.resolve ( __dirname , url ) , name , filename : 'index ' , formats : [ 'umd ' ] } , rollupoptions : { external : [ 'vue ' ] , output : { globals : { vue : 'vue ' } } } }
i 'm using some modules that require react contexts to work , so they depend on peerdependencies and a single installation on the client in the vite project . i 'm using some custom packages that all peerdepend on three and @ react-three/fiber , but it looks like vite is somehow duplicating the references . this is evident in the following warnings 'warning : multiple instances of three.js being imported . ' ( despite only having one ) uncaught r3f hooks can only be used within the canvas component ! ( despite being used inside a canvas ... ) so clearly these packages ca n't find the right context . has anyone figured out some vite/rollup configuration that will resolve these conflicts ? < code >
hello , just need a small guidance on how to deploy a full stack website . i have searched around but could n't find a satisfactory answer . my application is connecting with different api , i mean that api is n't in my site environment then am i supposed to just make a static build and done ? that 's it . < code >
how to obfuscator the project codes when i use vite and typescript . for example , use javascript-obfuscator to obfuscator codes . but i do n't find the way to do it , can you help me , thanks < code >
i run pnpm install and build successfully , however the pnpm-lock.yaml occur some changes it 's from dependencies : create-vite : link : .. /create-vite kolorist : 1.5.0 to dependencies : create-vite : 2.6.6 kolorist : 1.5.0 /create-vite/2.6.6 : resolution : { integrity : sha512-vqslquffedg+nalivn7um94mu244f5p8c4a8navg2j1qiuedqg1ptqbk+wdjqarw7zjov3n6kp++6hvhwxrj7g== } engines : { node : ' > =12.0.0 ' } hasbin : true dependencies : kolorist : 1.5.0 minimist : 1.2.5 prompts : 2.4.1 dev : false i'am really confused . did i do something wrong ? < code >
hello , i use vite + vue3 and import rosjslib . an error is prompted when i use it , but when i use vuecli + vue3 it is indeed normal , how can i solve it ? < code > < template > < div > < p class= '' text-success '' v-if= '' connected '' > connected ! < /p > < p class= '' text-danger '' v-else > not connected ! < /p > < input type= '' text '' v-model= '' ws_address '' / > < br / > < button @ click= '' disconnect '' class= '' btn btn-danger '' v-if= '' connected '' > disconnect ! < /button > < button @ click= '' connect '' class= '' btn btn-success '' v-else > connect ! < /button > < /div > < /template > < script setup > import roslib from `` roslib '' ; let ws_address = '127.0.0.1:9090 ' let connected = false ; const ros = new roslib.ros ( { url : ws_address , } ) const connect = ( ) = > { ros.on ( `` connection '' , ( ) = > { connected = true ; console.log ( `` connected ! `` ) ; } ) ; ros.on ( `` error '' , ( error ) = > { console.log ( `` error connecting to websocket server : `` , error ) ; } ) ; ros.on ( `` close '' , ( ) = > { connected = false ; console.log ( `` connection to websocket server closed . `` ) ; } ) ; } const disconnect = ( ) = > { ros.close ( ) ; } < /script >
maybe i just oversee something , but this drives me nuts . use a new vite installation with an a-tag inside the index.html : < a href= '' '' > test < /a > and some simple css : a { margin-top : 50px ; transition : margin-top .5s ease ; } a : hover { margin-top : 0 ; } now it starts the transition on page load . when it should run it only on real change ( like : hover in the example ) . < code >
hi guys , i would like to know is there any plugin or tool i can add to vite2 for getting support of jamstack ? gridsome/gridsome # 1576 < code >
i 'm having problems with a script that needs to be compiled on its own and then included in pages for other projects . essentially , when building and minifying my script vite renames one of my functions ga ( ) . ga ( ) unfortunately also seems to be commonly used by google analytics , so this causes problems whenever my script is loaded on a page using a package trying to interface with google analytics . i 'm not 100 % of why this is happening behind the scenes , but there 's definitely an issue with the name ga ( ) . is there any way to tell vite/rollup to not change my function names , or even better , specify i do n't want any of my functions/variables called ga ? < code >
because my js is quite hefty on this project i am working on , it takes a while to load . which is not a problem on its own . but because the css is only being parsed after the js has loaded , the loading of the page is pretty darn ugly . especially loading in the fonts ( via css ) . because of i want to switch the 'link rel= '' stylesheet '' ' line with the 'link rel= '' modulepreload '' ' via the config so that the stylesheet is loaded before the javascript . but i am also curious of why this is not the default behavior in the first place . < code >
with webpack , we are used to optimizing svg images with svgo , compressing it with brotli and saving them to public directory . is there any plugin for vite that can do this as well ? the vite-plugin-compression plugin can compress .css , .js , .svg files into brotli ( .br ) , but i have n't found any that can pre-optimize svg with svgo . any idea ? thank you ! < code >
since v2.6.1 default build.minify to esbuild ( e4892be ) , all configurations that do not set build.minify but use plugin-legacy will receive an ca n't use esbuild as the minifier when targeting legacy browsers because esbuild minification is not legacy safe error . the solution is simple . just set build.minify to terser . but is this a best practice ? how about the default is esbuild and the legacy part uses terser ? i do n't know the result because the current plugin-legacy does n't support configuring the minifier separately . i think the relevant documents and options can be better done , to guide users to use the best configuration with plugin-legacy < code >
it seems that if you pass values that do n't strictly conform to the `` valid values '' for the base config option , during production builds a forward slash / is added both before and after said value . for example , if i set base to { { .base } } the index.html will include / { { .base } } / before all assets . coming over from cra i previously would just set my % public_url % to whatever value i desired and this would be output accordingly , though it seems i can not do that with vite without an additional step to strip said slashes . is this behaviour expected and strictly necessary ? in my explicit use case , we add the above value so that our go backend application can use templating to achieve a dynamic path for our frontend react application . < code >
i need to mount two different folders of static content . the first folder contains the standard 'public ' web stuff - favicons , manifest.json and so on . the second folder contains many gigabytes of game data - audio files , 3d model files ( gltf ) , textures and so on . copying the game data into the 'public ' folder is expensive and slow because the files are so large . also , i have more than one vite app that uses the same data ( the game and the editor ) , and i do n't want to have to sync multiple copies of the game data . i would rather have the game data live in one place . it would be much easier if there was a way that i could simply 'mount ' or 'alias ' the second static folder , either as a completely separate url path or as a sub-folder of the regular 'public ' folder . however , i 've gone through the vite documentation a bunch of times and there does n't seem to be a way to do this . a symlink would do the job , but wo n't work on non-unix systems . < code >
i would like to import s/css directly into my javascript code as a minified string , is that possible ? at the moment it just imports it but with and comments . < code >
describe the bug i do n't know how to config vite.config .. js to resolve node_modules module in ssr mode reproduction i do n't know how to config vite.config .. js to resolve node_modules module in ssr mode system info used package manager npm logs validations follow our code of conduct read the contributing guidelines . read the docs . check that there is n't already an issue that reports the same bug to avoid creating a duplicate . make sure this is a vite issue and not a framework-specific issue . for example , if it 's a vue sfc related bug , it should likely be reported to < url > instead . check that this is a concrete bug . for q & a open a github discussion or join our discord chat server . the provided reproduction is a minimal reproducible example of the bug . < code > system : os : windows 10 10.0.22463 cpu : ( 6 ) x64 intel ( r ) core ( tm ) i5-8400 cpu @ 2.80ghz memory : 16.76 gb / 31.94 gb binaries : node : 14.17.6 - c : \scoop_softpps odejs-lts\current ode.exe yarn : 1.22.10 - c : \scoop_softpps odejs-lts\currentin\yarn.cmd npm : 6.14.15 - c : \scoop_softpps odejs-lts\current pm.cmd browsers : edge : spartan ( 44.22463.1000.0 ) , chromium ( 94.0.992.31 ) , chromiumdev ( active code page : 936 ) internet explorer : 11.0.22463.1000 invalid value for option `` output.manualchunks '' - this option is not supported for `` output.inlinedynamicimports '' .
i am writing a project with vite & react . i need to deploy it on a server as a single page application . the deployment process is automation , so i need to include config file in the dist folder with npm run build , how to include at the config file ( .json , .toml or .cfg ) in dist folder with vite build ? < code >
hi , i just transferred my webpack project to vite , it is fast ! however , i hit an issue which really puzzle me . in my local , when i run vue-tsc -- noemit & & vite build it works great no error . however , if i deploy this script to github 's workflow it will show this error this is index page looks like thanks , jing < code >
hi , has anybody problem with the development on windows 10 ? i do n't know what can be wrong but cra and other solutions ( parcel.js , snowpack ) works as expected without any crashes . even vite.js v1 worked great but after transition to v2 it has started to occasionaly crash with this error in log : ( transcript ) : i ca n't safely reproduce it . sometimes it works for a quite long time ok but sometimes it crashes almost immediately . the repository with reproducible error but it happens without any change right after the yarn create @ vitejs/app my-app -- template react-ts where i 've just tried to change text content and nothing else . < code > 15:26:48 [ vite ] hmr update /src/components/tabs.tsx ( x2 ) 15:28:04 [ vite ] hmr update /src/app.tsx node : events:353 throw er ; // unhandled 'error ' event ^ error : ebusy : resource busy or locked , lstat ' c : \dumpstack.log.tmp ' emitted 'error ' event on fswatcher instance at : at fswatcher._handleerror ( c : \users\bransky\projects\_playground\yummy\node_modules\vite\dist\node\chunks\dep-b48a59d1.js:11575:10 ) at readdirpstream.nodefshandler._boundhandleerror ( c : \users\bransky\projects\_playground\yummy\node_modules\vite\dist\node\chunks\dep-b48a59d1.js:10071:43 ) at readdirpstream.emit ( node : events:376:20 ) at emiterrornt ( node : internal/streams/destroy:188:8 ) at emiterrorclosent ( node : internal/streams/destroy:153:3 ) at processticksandrejections ( node : internal/process/task_queues:80:21 ) { errno : -4082 , code : 'ebusy ' , syscall : 'lstat ' , path : ' c : \\dumpstack.log.tmp ' } error command failed with exit code 1. info visit < url > for documentation about this command . error command failed with exit code 1. info visit < url > for documentation about this command .
my vite.config.js has the following configuration : however , i still get an error in the pre-bundling dependencies step , with references to the original package : is this a bug or am i missing something obvious ? < code > pre-bundling dependencies : vue vue-router vue-property-decorator @ uifabric/icons @ uifabric/styling ( ... and 7 more ) ( this will be run only when your dependencies or config have changed ) .. / .. /node_modules/.pnpm/ @ uifabric+ < email > .1/node_modules/ @ uifabric/styling/lib/styles/scheme.js:1:46 : error : could not read from file : /home/ ... /office-fabric/packages/website/ @ uifabric-vue/utilities 1 import { customizations , mergesettings } from ' @ uifabric/utilities ' ; resolve : { alias : { ' @ / ' : path.resolve ( __dirname , './src ' ) + '/ ' , ' @ uifabric/utilities ' : ' @ uifabric-vue/utilities ' , ' @ fluentui/utilities ' : ' @ uifabric-vue/utilities ' , } , } ,
hi ! i converted one of our packages to an es module which uses main to export a cjs build and module to export a es module . since vite is all about es modules , i would have expected it to use to the es module , but it seems like it 's using the cjs build in main . i can provide a reproducable repo if it 's not an obvious issue . the package in question is < url > ( i am aware that the cjs build does n't seem to work at the moment , but that 's exactly how i found out that vite is using it instead of the esm build . ) i would appreciate any pointers on how to fix this . 🙂 thanks a lot ! edit : could this be due to ssr ? might be the same as # 3979 . < code >
so , i was wondering if it is somehow possible to remove any logic automatically that is used with import.meta.env.dev vars . let 's say i have an if-clause in vue3 v-if= '' isdev '' , isdev is assigned in my < script setup .. and now running vite build would completly remove anything related to it since import.meta.env.dev is false . did anyone create something like this before , or is this even possible ? maybe not because of how different react/vue looks like , but a simple js if-clause might work better to remove example data that is only used in dev mode . < code >
hi there , i 'm currently trying to migrate a rather big project ( react typescript ) from snowpack to vite . currently i 'm used to import interfaces like this import loginstore , { user } from ' .. / .. /stores/loginstore ' or rather in vscode by ctrl + . = > add 'user ' to existing import declaration from ' .. / .. /stores/loginstore ' however once i run vite in my terminal , the browser console logs the following message : uncaught syntaxerror : the requested module '/src/stores/loginstore.ts ' does not provide an export named 'user ' which led me to the following issue , # 2117 and the `` wontfix '' comment # 2117 ( comment ) however , when i create a completely new project via the cli tool , export and import an example interface no error is being thrown . example repo : < url > my question is , why is this error not being thrown in case of my example ? < code >
hey , is it currently possible with vite and vue-router ( or any other routing lib ) to build static pages like a ssg e.g . gatsby ? we have no access to our apache and can only use .htaccess files . unfortunately , one of our sub-routes ( /preview ) is filled by other projects ci ( per branch preview builds ) so anything regarding url rewrite to /index.html does not always work . is anyone having a setup or started anything in that direction ? i really do n't want to use some bloated framework like nuxt or other libs . vite is remarkable because it 's fast and since our ci pipeline is limited per month we really would like to keep it that fast and simple . < code >
greetings is there a way to get notified when hmr finished ? ( it might be react plugin specific ) in an app with multiple tabs as react components , those have effect hooks ( store change ) on unmount , if i modify a child component ( even if i add `` hot.accept ( ) '' ) the tab gets reloaded , and it will unmount . i wanted to add some logic ( to restore state ) after the updated tab is mounted again . so far i 've tried hmr api callbacks like `` dispose '' , firing custom events from a custom plugin similar to the `` handlehotupdate '' example , but every every event finishes earlier ( even the log [ vite ] hot updated : /src/components/ ... ) than the component starts unmounting . < code >
hi ! i 'm trying to import a few sound files from another library i 'm using with no luck . right now i 'm simply doing the following if i remove the file ending it throws an error that the file is not found . so it finds the file , but the error i 'm getting is quite obvious . < url > 404 ( not found ) vite should support the wav type by default as defined here what 's the problem ? < code > import `` mathlive/dist/sounds/plonk.wav ''
hello , we have a project and a internal library . the project runs with react-scripts and i try to make it use vite . when i run vite , i have an error : missing `` ./dist/index.css '' export in `` xxx '' package where xxx is our home made library here is the export part in the library : i guess i should add `` ./dist/index.css '' somewhere in package.json exports { } but i ca n't find how . if i remove the exports , i do n't have the error but i begin to see other issues with commonjs import ( ? ) how can i make this library compatible with vite / es import ? < code > `` exports '' : { `` require '' : `` ./dist/index.js '' , `` import '' : `` ./dist/index.modern.js '' } ,
i have an icon component that i built in vue 3 ( webpack ) that i 'm trying to get working with vite and vue 3 , but having some difficulties with dynamic import of the icon components . i tried replacing require.context with import.meta.glob without luck . webpack version template script < code > import { defineasynccomponent } from `` vue '' const requirecontext = require.context ( `` .. /assets/icons '' , true , /\.vue < cur > /i , `` sync '' ) let componentnames = requirecontext .keys ( ) .map ( file = > file.replace ( / ( ^.\/ ) | ( \.vue < cur > ) /g , `` '' ) ) let components = { } componentnames.foreach ( component = > { //component represents the component name components [ component ] = defineasynccomponent ( ( ) = > //import each component dynamically import ( ' .. /assets/icons/ < cur > { component } .vue ' ) ) } ) export default { name : `` icon '' , components , props : { name : { type : string , required : true } , ... } , data ( ) { return { componentnames } } } < component : is= '' name '' / >
i have just added vite to my project by following this guide : < url > after changing all the @ to /src vite started working but when i opened the link it only rendered the html in index.html it did not start vue or anything . the only error message in the console is : navbaruser.vue:34 uncaught syntaxerror : the requested module '/node_modules/.vite/vue.js ? v=7251db6f ' does not provide an export named 'createblock ' what is going on ? how can i fix this ? i would really like to use vite its so fast . < code >
hello . we use vite and vue3 with ssr in our project . for us - comments are required ! but i did n't find anything about : 'does comments removes from main files ? ' . can someone show where i can configure vite to delete comments after dev command ? < code >
how can i use sass modules ( styles.module.scss ) in my project without styles getting duplicated ? i have a solid.js template installed with vite i also installed sass when i run the app everything works just fine , but the styles get duplicated . i do n't know why tho . without sass , pure css modules work fine , no duplications . vite.config.js < code > import { defineconfig } from `` vite '' ; import solidplugin from `` vite-plugin-solid '' ; import path from `` path '' ; import idgenerator from ' ... ' export default defineconfig ( { plugins : [ solidplugin ( ) ] , build : { target : `` esnext '' , polyfilldynamicimport : false , } , resolve : { alias : { `` @ '' : path.resolve ( __dirname , `` ./src '' ) , } , } , css : { modules : { generatescopedname : idgenerator } } } ) ;
hi , is there anyway to exclude svg file to be handle as static file reference . i do n't want any of svg file to be in the dist folder because i already transform it ( svg file ) to a js file ( a vue component to be exact ) . thanks . < code >
so i imported bootstrap like so in app.scss for example , now inside a component if i do , i get the following error , < code > < style scoped lang= '' scss '' > .text { @ extend .text-white ; } < /style > [ plugin : vite : css ] the target selector was not found . use `` @ extend .text-white ! optional '' to avoid this error . 8 @ extend .text-white ; ^^^^^^^^^^^^^^^^^^^ src/components/navbar.vue 8:3 root stylesheet @ import `` bootstrap/scss/functions '' ; @ import `` bootstrap/scss/variables '' ; @ import `` bootstrap/scss/mixins '' ; @ import `` bootstrap/scss/bootstrap.scss '' ;
i 'm using components which are sent from api and loaded via vue.component ( ) . i need the runtime template compiler for that . with webpack , i could use the option runtimecompiler : true . can i achieve the same thing with vite ? < code >
hi , i use a lib unified with a dependency vfile that should be browser compatible but i think it 's with the help of webpack that process process.cwd ( ) in browser to return `` / '' i tried with define but like it 's a function it 's not replaced what workaround will you see ? < code >
i use vue 3 with vite . i want to set correct path config for styles in .vue sfc files . my-component.vue : in vite.config.js i have , when i run vite and inspect the code i see the path instead of the path with vite server which needs to be : background-image : url ( `` < url > ) ; how can i configure the app ? < code > < template > ... < /template > < style scoped > .my-ele { background-image : url ( `` @ /background.png '' ) ; } < /style > background-image : url ( `` / @ fs/e : /www/project-x/asset/background.png '' ) ; { base : process.env.app_env === 'development ' ? '/ ' : '/dist/ ' , build : { outdir : path.resolve ( __dirname , './ .. /dist ' ) , manifest : true , target : 'es2018 ' , rollupoptions : { input : '/main.js ' } } , resolve : { alias : { vue : 'vue/dist/vue.esm-bundler.js ' , ' @ ' : '/e : /www/project-x/assets ' } } }
in webpack with file-loader we can code like below : we can we do to dynamic import imgs that contain variables . < code > < template > < img alt= '' '' : src= '' imgsrc '' / > < /template > < script > export default { data ( ) { return { avatar : 'test ' } } computed : imgsrc ( ) { return require ( ( ' @ assets/img/first- < cur > { this.avatar } .png ' ) ) } } < /script >
on the package.json scripts : im using this `` build '' : `` tsc & & vite build '' to generate the types and the build files . but as soon as the tsc build finishes the vite build command clears the dist folder and creates js files without any types . i wonder if there is any good solution to this . i tried rollup-plugin-typescript2 but it has lots of issues with monorepo setup . < code >
in my project , there are some codes as follow : if ( env === 'web ' ) { module.exports = require ( './web/module ' ) ; } else { module.exports = require ( './node/module ' ) ; } although in web env , after transform to chunk in './vite ' , the code require ( './node/module ' ) will cause some node code require in chunk , which causing node 's variable error in browser . so how can i ignore the code require ( './node/module ' ) ; , to avoid node 's variable error in browser . < code >
i have wrote a set of components in react , when i try to import it in vue , it becomes blank , meaning vite library mode is not generating web components ? based on my understanding , web components can be use across any platform am i wrong ? < code >
hi , i have a fairly large project where i am editing multiple javascript files and i find that saving each one is causing hmr to reload the page too many times and thus sends a needless amount of api requests . however , i still want to use hmr for .css files since the page does n't get fully reloaded and the changes are just injected . so , my question is : is it possible to tell hmr to ignore .js files or only watch for changes in .css files ? thank you for your help and thanks for making this 😄 . < code >
hi everyone , i have a lerna mono repo where i have built some vue single file components . i have been symlinking these to my node_modules folder on a few website projects when i need to make a change to the design of the component . i then publish a new version of the component and can consume the new version on the production website . is it possible to have hmr working from symlinked packages locally ? i 'm wanting to hot module these so i do n't have to stop and restart dev to see the change i have made . i have been playing around with optimizedeps.exclude to try and stop the prebundling of these components so they do n't cache but have n't got anywhere with that . i have also been thinking my process of testing these packages with the symlinking may be incorrect but has been working with laravel mix and would rather avoid the npm linking and unlinking way . it 's also good to see the components with real project content and is why i have been doing it this way . would appreciate some help if possible . : ) < code >
i want to pre-render my app by react-snapshot do anyone try it , is it possible , or there is issues with that , is there any good alternative ? thank you < code >
# queryviteplugins css pluginhard code ? url ? inline vite lang=scss scss , codetransform '' a '' , # 2522 webpackloaderpitchplugins query loader scssqueryvitepr < code > import code from `` /src/index.scss ? a '' // code `` a '' import code from `` /src/index.scss ? b '' // code `` b '' import code from `` /src/index.scss ? c '' // code `` c ''
hi , i 'm currently using vite with wordpress , following specs here : < url > all fine till now , but i 'd also want to also support ie11 , so i 'm currently trying @ vitejs/plugin-legacy . but obviously legacy js are not injected in production in wordpress pages . so how exactly should i include them manually ? < code >
i want to deploy my appl in heroku , the issue is that there is no start script yarn serve will give just a preview not recommanded for production i am comming from cra , and there we already have yarn start command heroku are complaining about this , do exist a solution for this thank you < code >
currently vite is a commonjs package , one downside of this is that to load es modules in ssr they have to be transformed in commonjs and then executed . by adding `` type '' : `` module '' in vite 's package.json the import ( `` module.js '' ) could be used to load both commonjs and esm modules . probably the whole ssrtransform.ts module could become unnecessary . node supports esm without any experimental flag from version 12. is this something that is already planned or there is something blocking it ? < code >
i followed # 1791 to add monaco editor , and everything works as expected . however , in the dev mode , the code of monaco is n't bundled , so there are a lot of requests , both js and css requests : meanwhile the requests on production build looks pretty good : the lodash-es dependency , however , does n't have this problem : < code >
i 'm trying to write a pure css file in vite . but any css property is not working for auto-complete . how to solve this ? < code >
i 'm trying to include this umd module and it works fine in using vite due to the dependency prebundling . however in the production build vite build i get `` uncaught typeerror : e.cssjs is not a constructor '' can i configure rollup to include it in the bundle ? ( or is it a bug ? when vite works , i would also expect vite build to work . ) thank you . < code > import cssjs from `` jotform-css.js '' ; console.log ( new cssjs.cssjs ( ) .parsecss ( `` * { color : blue } '' ) ) ;
i config the postcss-nested in postcss.config.js , and it work as expect . but the vscode warn that the nested syntax have some problem , any suggestions will be appreciated . < code >
because i use routes ( react router ) that start with /public , vite shows a warning in the console . the /public routes are part of my application ( it shows public data compared to /user routes ) and is unrelated to the public folder mentioned in the warning . the app works correctly , but the warning does not make sense . is there a way to `` solve '' this so the warning does not show up ? < code > instead of /public/foo , use /foo . files in the public directory are served at the root path .
explanation when i use build then serve , `` this '' just not included my storage when i trace it . but when i use yarn dev it 's work 100 % fine . in this case this.entity give storage in methods and computed in my app.vue . is there a way to fix this ? reproduce < url > i tried to simplify as much as possible . it 's just one counter , one method , and one button . main.js store/index.js < code > import { createapp } from 'vue ' import app from './app.vue ' import store from './store ' createapp ( app ) .use ( store ) .mount ( ' # app ' ) `` dependencies '' : { `` vue '' : `` ^3.1.5 '' , `` vuex '' : `` ^4.0.2 '' } , `` devdependencies '' : { `` @ vitejs/plugin-vue '' : `` ^1.3.0 '' , `` @ vue/compiler-sfc '' : `` ^3.0.5 '' , `` vite '' : `` ^2.4.4 '' } import { createstore } from 'vuex ' import entity from './modules/entity.js ' const store = createstore ( { modules : { entity , } } ) export default store ; < template > < button @ click= '' tonextday '' > end < /button > < /template > < script setup > import { computed } from `` vue '' ; import { usestore } from `` vuex '' ; const store = usestore ( ) ; const entity = computed ( ( ) = > { return store.state.entity ; } ) ; < /script > < script > export default { methods : { tonextday ( ) { this.entity.day++ ; } , } , } < /script >
so i 'm wondering if it would be beneficial to add a guide to using vite , and docker-compose . adding things like basic configs , environment variables , dockerfile/docker-compose settings in a guide . i 'm currently working on adding a vue3 front end as a ui to personal project built around some microservices . i have everything but vite with hmr running in docker-compose correctly . i 've combed through various blogs , vite issues , stack overflow questions , and through some trial and error have gotten pretty close to getting it working ( pretty sure i have something configured incorrectly either in my dockerfile , docker-compose.yml or vite.config.js ) . i 'm sure i could start a blog , and post what i 've done . perferably i think it might be better a option to have it more as a community document . thoughts ? < code >
i 'm a little bit confused that vite is not calling my plugins handlehotupdate method on creation/deletion of files . is this the way it is supposed to work ? < code >
i noticed that my build got bigger after adding a `` dev '' dependency and after digging around i 'm trying to find a solution to remove these unnecessary imports in my vendor chunk for example how can i have the build tool ignore imports so they are not included in the final vendor chunk when i run the build command ? < code > import react from `` react '' ; import reactdom from `` react-dom '' ; import { queryclient , queryclientprovider } from `` react-query '' ; import { reactquerydevtools } from `` react-query/devtools '' ; import { worker } from `` ./mocks/browser '' ; import app from `` ./app '' ; // this should be ignored when building production if ( import.meta.env.vite_mock_backend === `` true '' ) { worker.start ( { onunhandledrequest : `` bypass '' } ) ; } const queryclient = new queryclient ( ) ; reactdom.render ( < react.strictmode > < queryclientprovider client= { queryclient } > < app / > // this is ignored when env is production < reactquerydevtools initialisopen= { false } / > < /queryclientprovider > < /react.strictmode > , document.getelementbyid ( `` root '' ) ) ;
im trying to support decorator syntax with vite , but i 'm failed . actually i can rename all js files into ts files to solve this problem , but it seems too hard for our huge project . < code >
clear and concise description of the problem it seems vite always take a index.html as entry point , is there any way to develop userscript with vite ? i tried append ' @ vite/client ' by add module script tag to host site , sadly not work😂 suggested solution my be a vite plugin can do this job , or is there any solution ? alternative no response additional context no response validations follow our code of conduct read the contributing guidelines . read the docs . check that there is n't already an issue that request the same feature to avoid creating a duplicate . < code >
hi everyone i have question about use vite with styled components in react we tell that as default vite come and code split css and seprate css code from js code and on the demand of request , return and load css for exact page that help use to reduce bundle size when load page for first time now i have question in how work with styled component how undrestand our code ? is seperate css code from js ? if can seperate , how undrestand js syntax and covert to css if dont convert means we dont have any code spliting in out code ? < code >
i deployed build code in github pages . in build html , file path was created like below github page was not loaded so i manually changed to src= '' assets/ ... '' and href= '' assets/ind ... '' . its worked . is it possible to config in vite to generate file path like this . < url > < code > < script type= '' module '' crossorigin src= '' /assets/index.38d0ce4a.js '' > < /script > < link rel= '' stylesheet '' href= '' /assets/index.361823df.css '' >
i would like to manually trigger recompilation on a watched file ( say , helloworld.vue ) without modifying it with fs . is there anyway to trigger this with vite programatically via a plugin / socket message to vite server ? here is an example of someone who achieved the same with webpack - < url > thanks in advance ! < code >
so i 'm trying to use the libraries react , plotly.js and redoc . i had some problems with node libriaries before , but this answer helped me ( # 4479 ) . now i 'm stuck with another problem during building . running vite serve works fine , and vite build finishes fine , but when i open the browser i get process is not defined in the console . the error is from a dependency of redoc . i 've tried various combinations of define and polyfills , etc , but without success . i appreciate any help ! here 's a minimal reproduction : < url > my vite config looks like this : < code > // vite.config.js import { defineconfig } from `` vite '' ; import reactrefresh from `` @ vitejs/plugin-react-refresh '' ; import resolve from `` @ rollup/plugin-node-resolve '' ; import builtins from `` rollup-plugin-node-builtins '' ; import replace from `` @ rollup/plugin-replace '' ; import globals from `` rollup-plugin-node-globals '' ; / * import json from `` @ rollup/plugin-json '' ; * / import polyfillnode from `` rollup-plugin-polyfill-node '' ; // < url > export default defineconfig ( { plugins : [ reactrefresh ( ) , / * replace ( { * `` process.env '' : json.stringify ( process.env ) , * preventassignment : true , * } ) , * / ] , / * define : { * `` process.env.node_env '' : json.stringify ( { } ) , * } , * / resolve : { alias : { process : `` process/browser '' , stream : `` stream-browserify '' , util : `` util '' , http : `` http-browserify '' , path : `` path-browserify '' , } , } , } ) ;
with vue-cli 's webpack dev server , when i save ( cmd+s ) an unmodified file ( say helloworld.vue ) , the watch immediately triggers re-compilation irrespective of whether the file was modified or not . but with vite ( with the page containing helloworld component opened in my browser ) , when i try to save ( cmd+s ) and unmodified file ( helloworld.vue ) , the watch does n't trigger the re-compilation of the file . it triggers re-compilation only when a modified file is saved . i assume this is an optimisation to avoid recompilation of an unchanged file . but , is there a way to switch off this optimisation and just recompile whenever the file 's mtime changes ? i did check the rollup ( < url > ) & chokidar watch options ( < url > ) , but did n't find anything related to this . < code >
hellow , i used a component library . this npm package uses images . for example , the input component for clear icon.but it 's wrong when it 's running . how to solve this problem ? thanks < code >
the browser kernel version i use is chrome 78 , i found that i always reported an unexpected syntax error : unexpected token ' . ' error during development , because i used the optional chain operator ? . , how can i fix it ? e.g . < code > // helloworld.vue < script setup > ... let a = { } let b = a.b ? .c < /script >
hey guys . i 'm using vite indirectly through sveltekit , and deploy to an azure app service hosted via a linux container . all super - except environment variables passed to app service will always be prefixed with appsetting_ , and this can not be changed without going through the ballache of deploying via an azure container instance ( port opening etc , it gets messy ) . either i get the app service to prefix with vite_ ( which appears impossible ) or i get vite to expose using another prefix .... such as appsetting_ . providing settings via environment variables is optimal so i can set these values per deploy , not per build or image . it also allows setting dynamic variables such as build versions . so ... how can i tell vite to use an alternative environment variable prefix other than vite_ ? i think define might have something to do with it , but the docs assume astral level of js understanding , which i do n't have . it 'd be great to see an actual example for morons like me . < url > thanks ! < code >
i was told the teleport component should be able to be rendered during ssr . i ca n't get it to work in neither < body > nor < head > . any ideas ? < code >
before , there is a babel plugin transform-vue-jsx allow to use jsx without lang= '' jsx '' . in vite , how to implement this feature ? there is a lot of old code that needs to be compatible . jsx.vue < code > < script > export default { name : 'jsx ' , render ( ) { return < div > 123 < /div > ; } } ; < /script >
i import less file in the js file . the style is not invalid , i do n't know why , how should i do ; index.js index.less < code > import `` ./index.less '' ; ..... export default index extends react.component { render ( ) { return ( < div classname= '' test '' > test < /div > ) ; } } : global { .test { color : red ; } }
refs : # 3114 this is not possible , due to that vite assumes that js files contain only js valid syntax . as i can tell , many devs in the community were writing jsx in js files . would it be possible to add an option to allow its usage ? < code >
this is rather cosmetic but it would be nice to prevent the 404 errors from showing up ( beyond meddling with the filters ) . sometimes i want to stop the server to move a lot of files around and the console is just going in a frenzy . i understand from # 1989 that there is n't a point to implementing exponential backoff , so my idea is to abort the fetch before the browser treats it as a 404. i have n't seen this pattern around so i do n't know if there are any serious drawbacks , but it is just a few lines < code > diff a/packages/vite/src/client/client.ts b/packages/vite/src/client/client.ts @ @ -209,11 +209,13 @ @ async function waitforsuccessfulping ( ms = 1000 ) { // eslint-disable-next-line no-constant-condition while ( true ) { try { + const controller = new abortcontroller ( ) + settimeout ( ( ) = > controller.abort ( ) , ms ) + await fetch ( ' < cur > { base } __vite_ping ' , { signal : controller.signal } ) - await fetch ( ' < cur > { base } __vite_ping ' ) break } catch ( e ) { await new promise ( ( resolve ) = > settimeout ( resolve , ms ) ) } } }
when i use external and import vue and vuetify from index.html the build version doesnt work . i add vite like this : and import in index.html like this : why this doesnt work ? < code > rollupoptions : { external : [ 'vue ' , 'vuetify ' ] } < script src= '' /lib/vue.min.js '' > < /script > < script src= '' /lib/vuetify.min.js '' > < /script > < script type= '' module '' src= '' /webapp/main.js '' > < /script >
what i 'm trying to achieve is kinda like webpack -- mode=development . it only outputs un-optimized dev build files to a directory without starting a dev server . can i do that ? instead of vite 's dev server , i use a separate express server . this takes care of rendering my templates with data . i take care of live reloading by watching the build directory . sadly that cuts me off from hmr tho . any help appreciated . < code >
i have a file called mypage.jsx and on vite build it outputs mypage.b234112a.js . is there any way to have the output file as , say , c2378a324112a.js ( only hash ) instead of retaining file name ? i tried looking for the solution in the docs but did n't find it . < code >
i 'm trying to use ionic/react in my app along with vite . but i 'm getting a 404 < url > you can try it out immediately here < url > and here is its github repo < url > how can i use vite with ionic ? < code >
in vue cli , it can be set by the following configuration : but no related setting items are found in vite < code > pages : { index : { entry : 'src/main.js ' , title : 'xxxxxxx ' } }
when run vite + react , use less file , the less content like this : : global { .app-link { color : # 61dafb ; border : solid 1px # fff ; } } and in react component use classname < a classname= { 'app-link ' } > test < /a > and run the cmd npm run dev . the less class do not work , because of the css file in browser has : global symbol . when i use postcss-modules , it can transform : global symbol . but also /node-modules/ , how to exclude /node-modules/ < code >
hi , i 'm trying to replace the build system of an existing project with vite . in order to prove that vite can replace my old build system , i have created a new test project , with lit-element and tailwind ( my base is the lit-element template of yarn create vite after some trials , i found a way to have a working tailwind configuration with the following steps : initialise tailwind config file add a `` styles.css '' to my project import `` styles.css '' to a `` styles.ts '' file ( for loading tailwind in a lit-element context ) load the style in my element . this works properly , and i can view that changes in my markup are detected . the new classes are processed by tailwind jit mode as needed and an hmr update is triggered for styles.css . i expected that an hmr update to styles.css will trigger a change to styles.ts , then to my webcomponent . but this is not the case , the hmr change is stopped before reloading the typescript ( my component is not updated in my browser ) how can i force the hmr update or what modifications is needed to have a properly updating hmr chain ? you can find a repository with the current status here : < url > thanks for the help , jivane < code >
set `` preservesymlinks '' : true in tsconfig.json will build error.but pnpm can not get right tips for import path . so i want to specify another tsconfig.build.json file ( `` preservesymlinks '' : false ) for build , and tsconfig.json ( `` preservesymlinks '' : true ) for vscode , how to do it ? < code >
i 've added shortcuts for node modules and src paths in my vite.config.js : resolve : { alias : [ { find : ' @ ' , replacement : path.resolve ( 'src ' ) } , { find : '~ ' , replacement : path.resolve ( 'node_modules ' ) } ] } it works cool with assets because vite has type declarations for svg , woff and so on in client.d.ts , but it has no declarations for tsx files . so i have an error `` module not found '' in vscode for component paths . i 've tried to add a declaration to my vite-env.d.ts in my src folder , but it has no effect . how can i add alias support for component paths ? < code >
when i write like this import clonedeep from 'lodash/clonedeep ' ; or import { useform } from 'antd/es/form/form ' ; it will show 'new dependencies found : xxx ' , and then the page will reload ( first start ) now i push 'lodash/clonedepp ' , 'antd/es/form/form ' .... into optimizedeps , but if users write something else like these , they need to change the optimizedeps . is there a better way to resolve this problem ? < code >
[ vite ] internal server error : [ @ vue/compiler-sfc ] ref : sugar now needs to be explicitly enabled via @ vitejs/plugin-vue or vue-loader options : @ vitejs/plugin-vue : via script.refsugar vue-loader : via refsugar ( requires 16.3.0+ ) how should i deal with it ? < code >
i am developing a multi-page app and struggling to configure the development servers paths for html files . the general file structure is this . / admin index.html login index.html user index.html vite.config.ts this is the relevant part of my vite config . i need to navigate to < url > for the admin html page . i would like to navigate to < url > and this serve the index.html file . i would also like to configure < url > to resolve to /user/index.html . i tried to configure this using the server.proxy setting , but have been unsuccessful so far . is this configuration possible ? trying to use '/admin ' : ' < url > as a proxy setting , i get a http 431 when going to < url > i think this is due to /admin being proxied endlessly until the 431 is returned . < code > export default defineconfig ( { build : { rollupoptions : { input : { login : resolve ( __dirname , 'login ' , 'index.html ' ) , index : resolve ( __dirname , 'user ' , 'index.html ' ) , admin : resolve ( __dirname , 'admin ' , 'index.html ' ) } , } , } , server : { proxy : { '/api ' : ' < url > } } } ) ;
combining typescript compiler and vite should be added in docs , as show in @ web/dev-server documentation to use both tsc and vite in the same terminal , you can use the -- preservewatchoutput option to avoid both tools clearing the terminal on change . to run both commands on a unix system : < code > tsc -- watch -- preservewatchoutput & vite
is there any way to disable filename hash of generated assets on production build ? i mean , not only js and css assets but also other assets like json , images , etc .. < code >
hi , i decided to use statically.io cdn for serving images in one of my side projects which is built on vitejs and preact . the url of the image is supposed to be something like this . < url > i tried with base in the config , but it did n't work . i think there should be something like this in config . < code > export default defineconfig ( { plugins : [ preact ( ) ] , build : { handleassets : ( asset ) = > { if ( asset.url.includes ( `` .png '' ) ) { return prefix + asset.url } return asset.url } } } )
in my vue-projects i often pass asset sources to custom components via props . for example this simple image viewer in a webpack / vue project : it seems that now with vite i would have to import the asset in my script and expose it as a variable that i send to the component prop . this seems very tedious compared to the webpack code . i understand , that vite is a dev server , not a bundler , but as far as i understand it can transform urls from img-tags src-attributes for example . my proposal would be to provide a syntax with which we can mark a attribute value as static asset thats url should be transformed . for example like , where transformurl would tell vite that this is a static asset . : maybe i can already achieve a similar ( but not so dynamic ) behaviour by using the transformasseturls option ? i am not sure how exactly the syntax of this feature should look and i do not know if this is a `` vite '' feature or a `` @ vue/compiler-sfc '' < code > < image-viewer : imgsrc= '' require ( ' @ /assets/demoimage.jpg ' ) '' / > < template > < image-viewer : imgsrc= '' imgsource '' / > < /template > < script > import imgsource from `` .. /assets/demoimage.jpg '' ... export default definecomponent ( { ... setup : ( ) = > { return { imgsource } } ... < /script > < image-viewer : imgsrc= '' transformurl ( ' .. /assets/demoimage.jpg ' ) '' / >
i am migrating a cra project to vite but i am facing some problems ca n't use js extensions : it 's annoying to convert all my js files to jsx i am using react 17 but why i have to import react in every file that use react ? < code >
my frontend source code involves a hardcoded .txt file , i need the content of the file like this : my question is , can i lazy load it ? i know there 's const lazy = import.meta.glob ( './some-file ' ) , but it seems to work only for script files . i also do n't want to put the .txt in public because the content changes frequently , and i do n't want to worry about http-cache . < code > import text from './some-text-file.txt ? raw ' ; // later : renderinsomecomponent ( text ) ;
i 'm using window 10 21h1 with wsl 2.0 ( ubuntu 20.04 ) and vite does n't reload on changes , here is a video of it . it works when i 'm using window ( powershell ) this is my repo as well . any idea to fix this problem < url > < code >
my project used css modules in all css files , it use webpack now , and i do n't want to change my filename , i just want to apply css modules to all .css suffix , but i am new to vite , and i do n't find solution after i read the docs , so can anyone help me ? < code >
i tried to import a file in svgo to use in the browser , but the os module of nodejs is used in this file . although this file can be added to the optimizedeps.exclude option , this means that i need to process this file . so i hope to be able to replace the os module with export const eol = `` `` like this example . but the pre-built files will not trigger the resolveid and load hooks in the universal hooks . what should i do ? < code >
i wan na keep the dist folder when i run vite like vite build . cause the figma plugin can only read the file in dist . < code >
the problem i 'm having is , when i build , the css gets compiled correctly in dist/assets but it does n't show up in manifest.json . i 'm using the backend integration guide and i 'm trying to build my site 's scss with vite ( among other things ) . what am i doing wrong ? is this a supported use case ? i guess , i can work around it by creating a dummy javascript file that includes my css and use it as an input , then it will be in the manifest . < code > build : { manifest : true , rollupoptions : { input : 'src/style.scss ' } }
hello , i 'm trying vite for a lit-element project . i have created a new project with yarn create @ vitejs/app , then build the library using vite build without error ( no code or configuration modified at the moment ) . my next step is to take the generated js module , host it in another server ( npx http-server in this case ) and use the component in a basic html page : loading the page in a browser ( either firefox or chrome ) does n't show the custom element . running vite as a dev server show the component correctly . it seems i 'm missing a configuration , but i ca n't find which one . does anybody as an idea on how to configure vite to package a standalone module for lit-element ? thanks for the help , jivane < code > < ! doctype html > < html > < head > < script type= '' module '' src= '' /test-lit-element.es.js '' > < /script > < /head > < body > < my-element > < p > this is child content < /p > < /my-element > < /body > < /html >
hi : ) i want to create a public components using vite and scss i am having trouble with vite automatically extracting the css . below is my setup . use case after npm publish , i want to use like this but result does not contain css . so css should be loaded as well . is there any way to include css in js ? < code > const path = require ( 'path ' ) module.exports = { build : { lib : { entry : path.resolve ( __dirname , './src/index.ts ' ) , formats : [ 'es ' ] , } , outdir : './dist ' , rollupoptions : { external : [ 'react ' ] , output : { globals : { } , entryfilenames : ' [ name ] .js ' , } , } , } , } import alert from ' @ components/alert ' import ' @ components/style.css ' import alert from ' @ components/alert '
return < code > rendercontent ( h , { node , data , store } ) { return ( < span class= '' custom-tree-node '' > < span > { node.label } < /span > < span class= '' buuton-tool '' > return ( < span class= '' custom-tree-node '' > < /span > )
hi guys . i need some help setting up tests with vue + jest . i 've read the docs , on the vue test utils site and they never mention vite , they assume that you are using the vue-cli . < code >
what can resolve.alias do ? it does n't resolve the path below : in my html : error in the browser console : any ideas on how to do it correctly ? < code > ' < img src= '' @ /assets/images/sample-1.jpg '' > ' // vite.config.js import { defineconfig } from 'vite ' import path from 'path ' export default defineconfig ( { resolve : { alias : { ' @ ' : path.resolve ( __dirname , '/src ' ) , } , } } ) get < url > failed to load resource : the server responded with a status of 404 ( not found ) client:180 [ vite ] connecting ... client:202 [ vite ] connected .
vite -- a=4 : cacerror : unknown option -a vite-cli : this.config.allowunknownoptions allowunknownoptions ? : < url > , vite -- mode production -- tenantid=000000 // mode .env.production vite -- mode production -- tenantid=111111 vite -- mode uat -- tenantid=000000 // mode .env.uat vite -- mode uat -- tenantid=111111 .env . * ' checkunknownoptions ( ) { } ' < code > const { options , globalcommand } = this.cli ; if ( ! this.config.allowunknownoptions ) { for ( const name of object.keys ( options ) ) { if ( name ! == `` -- '' & & ! this.hasoption ( name ) & & ! globalcommand.hasoption ( name ) ) { throw new cacerror ( 'unknown option \ ' < cur > { name.length > 1 ? ' -- < cur > { name } ' : '- < cur > { name } ' } \ '' ) ; } } }
specs vite version : ^2.3.8 node version : 14.17.1 os : linux mint ulyanna i 'm building the app using the following command : and serving the app with but i 'm getting the following error in the browser console and all the .js files are html files . more context : i 'm using serving in production with pm2 , serve & nginx . this is my startup script : and this is the part of my nginx.conf that handles this route : how do i solve this ? help is appreciated as it is a bit urgent . < code > failed to load module script : expected a javascript module script but the server responded with a mime type of `` text/html '' . strict mime type checking is enforced for module scripts per html spec . serve -s dist yarn build -- base=/registration-form/ location /ideathon-registration/ { phofurl } pm2 start `` serve -s -p [ port ] dist '' -- name registration-form
hey , adding a page such foo.html is automatically accessible via < url > is it possible to configure vite to make the page accessible without the .html suffix ? ( e.g. , < url > ) best , asaf . < code >
i 've tried to create something like shared layout for each of my pages in multi-page app but vite does n't transform paths in included files . i 've @ layout.html which contains : and index.html which contains : it uses nunjacks . i 've simple plugin which transforms html : i set enforce to pre and hoped it would compile same as it would be usual html ( just after nunjucks render ) . but the output does n't transform paths and output looks still same as is in src : how to force vite to transform included files or transform after it has been rendered ? i would really want to use some templating engine but it is useless as long as it does n't transforms its resources . i am using vanilla-ts starter . < code > import { renderstring } from 'nunjucks ' ; export default ( ) = > { return { name : 'nunjucks ' , enforce : `` pre '' , transformindexhtml : renderstring } } < img src= '' src/img/fitting_piece.svg '' / > < script type= '' module '' src= '' /src/main.ts '' > < /script > { % extends `` src/html/ @ layout.html '' % } < ! doctype html > < html lang= '' en '' > < head > < meta charset= '' utf-8 '' / > < link rel= '' icon '' type= '' image/svg+xml '' href= '' favicon.svg '' / > < meta name= '' viewport '' content= '' width=device-width , initial-scale=1.0 '' / > < title > title < /title > < /head > < body > < img src= '' src/img/something.svg '' / > < script type= '' module '' src= '' /src/main.ts '' > < /script > < /body > < /html >
how does @ vitejs/plugin-legacy convert es6 to es5 on demand ( automatically ) when type= '' nomodule '' ? currently , no conversion is implemented when viewing the code built with type= '' nomodule '' . my configuration legacy ( { targets : [ 'defaults ' , 'not ie 11 ' ] , } ) < code >
i think import.meta.env is used to access .env variables with the vite_ * prefix . but i want to access .env variables into vite.config.js , i got result undefined both import.meta.env.vite_port and process.env.vite_port . it 's fallback into fallback server port . if i am edited like that : i got this error : repro repo < url > related line < url > < code > failed to load config from < project-dir > /vite.config.js - port : parseint ( process.env.vite_port ) || 4000 + port : parseint ( import.meta.env.vite_port ) || 4000
index.html vite.config.js example this config will transfrom all imported styles and entry styles to rtl and ltr how to specify plugin to entry point in build.rollupoptions object-like # 1736 rollup documentation : you can export an array from your config file to build bundles from several unrelated inputs at once , even in watch mode . to build different bundles with the same input , you supply an array of output options for each input : and how to specify in build.rollupoptions array-like for example this config not working test case for array-like : < url > < code > < html lang= '' en '' > < head > < title > document < /title > < /head > < body > < script type= '' module '' > import './app.scss ' ; // apply plugin just to specify entry import './another.scss ' ; import './app.js ' ; < /script > < /body > < /html > rollupoptions : [ { input : { app : './app.js ' , } , output : { plugins : [ rtlcss ( ) ] , // < url > } , plugins : [ ] , } , ] ; rollupoptions : { input : { 'entry-point-a ' : path.resolve ( __dirname , 'src/entry-point-a.tsx ' ) , 'entry-point-b ' : path.resolve ( __dirname , 'src/entry-point-b.tsx ' ) , } , plugins : [ ] // will apply to all entry points } import { defineconfig } from 'vite ' ; // rtlcss postcss plugin just to app.scss entry import rtlcss from 'rtlcss ' ; export default defineconfig ( { css : { postcss : { plugins : [ rtlcss ( ) ] , } , } , } ) ;
after migrating a create react app project to vite js , i ca n't recommend it enough . it made front end stuff far more enjoyable for me . thank you a lot for this amazing tool ! i think it would be a great idea to have some kind of migration guide from cra in the docs , it would help with adoption . what do you think ? < code >
just thought i 'd post here about a new vite + vue3 website we 're proud to have launched . the app itself is also built on the same stack , discussed below ... the website is here : < url > and the app itself can be found here : < url > we started building this app last year but knew from the outset that we did n't want to use webpack . the main paint point we 've had was integrating ssr and prerendering into the stack cleanly . we ended up writing our own renderer based on vite 's ssr docs . some tips , we use vue3 computeds a lot . they are quite handy to use outside of components , as i 'm sure @ yyx990803 intended . have n't seen this awesome capability documented too much . we wrote our own auth engine and endpoint mapping system . i feel its a big mistake to use managed services for this , or ql libraries which add a lot of complex abstraction while not really reducing the amount of work needed . other than vue and vite , the stack is using postgres , tailwind , typescript . the usual suspects . if you have any questions or would like some tips on creating something similar , let me know . picture of the app : < code >
i am trying to utilize import.meta.globeager to get translation files into my app . however , whenever i change any of the translation files that got imported by import.meta.globeager ( ' .. / .. / .. / * * / * /i18n/en.ts ' ) ; it causes my whole app to refresh and any import.meta.hot.accept gets ignored . this makes updating translations and seeing the result a terrible experience . is this intended behavior or is there any way around it ? < code >
i am getting an error uncaught syntaxerror : invalid left-hand side in assignment in vite.js ? v=348316d4 while migrating the react application to vite . please find following images for reference . my vite.config.ts file looks like < code > const paths = [ 'account ' , 'api ' , 'assets ' , 'auth ' ] ; const resolvedpaths = paths.reduce ( ( acc , pathname ) = > { acc [ pathname ] = '/src/ < cur > { pathname } ' ; return acc ; } , { } ) ; export default defineconfig ( { resolve : { alias : resolvedpaths , } , plugins : [ svgr ( ) ] , } ) ;
the documentation states it is important to note that vite preview is intended for previewing the build locally and not meant as a production server . but it is not explained why . i am running my website in a docker image , and using the npm package http-server . however , it seems that vite preview does the exact same thing as http-server . why is vite preview not recommended ? < code >
hello ! i would like to build component using the library mode ( < url > ) and reactjs . i would like the component to get arguments from the html file inside < script > < /script > tag using a variable . i see that i do not have any access to the reactdom from the console of the dev server . do you have any idea how to do it ? for example : < script > const components = reactcomponent ( { locale : 'en-us } ) ; const returning = components .create ( 'returning ' , { style : { base : 'black ' } } ) .mount ( < user give selector > ) ; < /script > i could do it with webpack as i have access to the window object in the dev server . thanks ! ron . < code >
unfortunately < url > does provide source maps files inside the packages : the problem is that these files points to non existing file .ts : and this lead to this error in vite : is there any way to exclude these files ? < code >
hey everyone , i 'm researching of possibility of using vite instead of default cra/webpack as a sample test i create new blank app with < url > the app itself is just a component with imported like this : import { button } from `` @ blueprintjs/core '' ; and the thing confused me is release chunk size : for vite it was 500kb+ with size warning , for cra/webpack only about 200kb . so i guess it 's something about how tree shaking difference between webpack and rollup ? or something blueprint library specific ? < code >
has anyone succeed in using decorator in js files ? ideally , i 'd like to be able to use js files with simple decorators , like : snowpack supports it out of the box ( in dev and build ) . renaming .js files to .ts makes it work , but it is not ideal . i know this has been discussed in some issues , but none seems to reaching a final conclusion . thanks a lot ! < code > import { litelement , html , customelement , property } from 'lit-element ' ; @ customelement ( 'me-el ' ) class untitled1 extends litelement { @ property ( { type : number } ) propname = 0 render ( ) { return html'template ' } }
i need write tsx in sfc , so i installed both plugin-vue and plugin-vue-jsx . but the hmr seems not work . can anyone help ! pls ! < code > // vite.config.ts import { defineconfig } from 'vite ' import vue from ' @ vitejs/plugin-vue ' import vuejsx from ' @ vitejs/plugin-vue-jsx ' export default defineconfig ( { plugins : [ vue ( ) , vuejsx ( ) ] } ) // home.vue < script lang= '' tsx '' > import { definecomponent } from 'vue ' export default definecomponent ( { name : 'home ' , setup : ( ) = > { return ( ) = > { < h1 > the text here wo n't update , hmr seems not work < /h1 > } } } ) < /script >
i have a simple project that looks something like this : i am pulling in the css with a regular link tag . when changing the content of the index.html , hot reloading works as expected , but if i change any other html file or any of the css files , the browser does not refresh automatically . if i move all files to the root directory , hot reloading works correctly , but vite build will not work out of the box because it only copies static assets from the public directory . anyone else running into this ? is there some config i can set to make this work how i want ? < code > -- index.html -- public -- -- index.css -- -- about.html -- -- about.css -- -- global.css
hi everyone ! first of all thank you for your great job , vite is awesome ! i have configured this server option to true following the documentation ( < url > ) but if i add mode to the dev script it does n't open in the browser : package.json vite.config.js it only work if a change the dev script to : is there something that i 'm missing or is this the way to do it ? thanks in advance ! ! < code > server : { open : true } , `` scripts '' : { `` dev '' : `` vite -- open -- mode development '' , `` scripts '' : { `` dev '' : `` vite -- mode development '' ,
i try to use dynamic import on vue-router , and everything working well , just because i use pascalcase for the file name , so the generated chunk name have the same name case . how can i change to use kebab-case or some random characters ? for example , i want documentdetaildialog.988f625a.js changed to document-detail-dialog.988f625a.js or some-random-chars.988f625a.js . thanks in advance . < code >
hello . i 'm trying to use @ web/test-runner which for more advanced features have a package called @ web/test-runner-commands , this package imports a file called /__web-dev-server__web-socket.js , this file does not exist on disk and currently vite blows up with : this file is instead generated on the fly while served by @ web/dev-server and thus that import statement must survive unmodified to the buildt version . snowpack has an externalpackage option that handles this : < url > but i can not find anything similar in vite . this discussion is an continuation from this issue material-svelte/vite-web-test-runner-plugin # 11 < code > running tests ... 11:19:46 am [ vite ] error while updating dependencies : error : build failed with 1 error : node_modules/ @ web/test-runner-commands/browser/commands.mjs:2:43 : error : could not resolve `` /__web-dev-server__web-socket.js '' at failureerrorwithlog ( /project/node_modules/esbuild/lib/main.js:1466:15 ) at /project/node_modules/esbuild/lib/main.js:1148:28 at runonendcallbacks ( /project/node_modules/esbuild/lib/main.js:938:63 ) at buildresponsetoresult ( /project/node_modules/esbuild/lib/main.js:1146:7 ) at /project/node_modules/esbuild/lib/main.js:1253:14 at /project/node_modules/esbuild/lib/main.js:629:9 at handleincomingpacket ( /project/node_modules/esbuild/lib/main.js:726:9 ) at socket.readfromstdout ( /project/node_modules/esbuild/lib/main.js:596:7 ) at socket.emit ( events.js:376:20 ) at addchunk ( internal/streams/readable.js:309:12 ) 11:19:47 am [ vite ] internal server error : failed to resolve import `` /__web-dev-server__web-socket.js '' from `` node_modules/ @ web/test-runner-commands/browser/commands.mjs '' . does the file exist ? plugin : vite : import-analysis file : /project/node_modules/ @ web/test-runner-commands/browser/commands.mjs 1 | / * eslint-env browser , es2020 * / 2 | import { sendmessagewaitforresponse } from '/__web-dev-server__web-socket.js ' ; | ^ 3 | 4 | const param_session_id = 'wtr-session-id ' ; at formaterror ( /project/node_modules/vite/dist/node/chunks/dep-cb562f8f.js:44553:46 ) at transformcontext.error ( /project/node_modules/vite/dist/node/chunks/dep-cb562f8f.js:44549:19 ) at normalizeurl ( /project/node_modules/vite/dist/node/chunks/dep-cb562f8f.js:69541:26 ) at async transformcontext.transform ( /project/node_modules/vite/dist/node/chunks/dep-cb562f8f.js:69674:57 ) at async object.transform ( /project/node_modules/vite/dist/node/chunks/dep-cb562f8f.js:44751:30 ) at async transformrequest ( /project/node_modules/vite/dist/node/chunks/dep-cb562f8f.js:59118:29 ) at async vitetransformmiddleware ( /project/node_modules/vite/dist/node/chunks/dep-cb562f8f.js:59256:32 )
i 'm using vite to make an online tool , which is installed globally through npm , and the default is `` /usr/local/lib/node_modules '' on my mac . but when i start `` npm run dev '' , the page can be opened normally , but the console has an unbelievable error `` uncaught syntaxerror : the requested module'/node_modules/ '' , how can i solve it ? passing `` vite.config.js exclude '' still does n't work , and different errors appear endlessly . but my project can run normally in other local directories . i know that the directory `` /usr/local/lib/ '' is very special , but how can i solve it ? < code >
currently having a large project with all files in js extension . is there any method where i can rename/convert all js to jsx in order to apply vite js ? < code >
hello there ! thanks for the awesome work on vite ! it 's super-duper fast 😍 tldr is it possible to include code from dynamic require ( 'xyz ' ) statement in final bundle ? context : we are using an older dependency that is using dynamic require statements and i 'm wondering if it possible to resolve those during the build . using this config : we are seeing require is not defined in the browser because it looks like vite does n't recognize/include them in the built output . ref is it possible to require commonjs from older modules ? any pointers would be very helpful . thank you all ! ❤️ < code > import { defineconfig } from 'vite ' import reactrefresh from ' @ vitejs/plugin-react-refresh ' import nodepolyfills from 'rollup-plugin-polyfill-node ' ; export default defineconfig ( { plugins : [ reactrefresh ( ) ] , build : { rollupoptions : { plugins : [ nodepolyfills ( ) ] , } , } , } )
it seems vite will not append < style > css in html head with both transformindexhtml and ssrloadmodule api . there are also no manifest can be found during 'development ' , so i ca n't add them to head manually . in node_modules/.vite ( vite cache folder i belive ) , these 're also no css files when dev server is running . can someone briefly explain how css is handled in development server and ways to preload them in ssr ( dev server ) ? here 's my code . < code > // in entry-server.jsx import app from './app.jsx ' export const render = ( ) = > react.rendertostring ( < app / > ) // in app.jsx import './app.scss ' // blablabla // start-dev-server.js // vite = require ( 'vite ' ) .createserver ( / * options * / ) template = fs.readfilesync ( resolve ( `` templates/development.html '' ) , `` utf-8 '' ) ; template = await vite.transformindexhtml ( url , template ) ; const appentrymodule = await vite.ssrloadmodule ( `` /src/entry-server.jsx '' ) ; const apphtml = await appentrymodule.render ( url , { } ) ; const html = template.replace ( ' { { react-mount-point } } ' , apphtml ) ; res.status ( 200 ) .set ( { `` content-type '' : `` text/html '' } ) .end ( html ) ; vite.listen ( )
hi i have a question . i am migrating away from a webpack build to vite . for the client part everything works fine just the backend is a bit more complicated . we have a jvm backend ( design reason ) and would like to prerender our frontend code . we have something like now webpack bundles it into one single file to use this script to prerender our frontend . with vite i have not found anything to make this work . i would like to avoid having a hybrid where vite bundles/builds our frontend part and webpack to bundle/build the same code differently for the backend part . i tried a lot of configuration options with the -- ssr flag but no luck .. can someone point me in the right direction ? < code > import react from 'react ' ; import reactdomserver from 'react-dom/server ' ; import { staticrouter } from 'react-router-dom ' ; ... import app from './views/app ' ; ... function rendertostring ( url , context , locale ) { return reactdomserver.rendertostring ( < staticrouter > < app/ > < /staticrouter > < /localeprovider > ) ; } ;
i 'm working on a backed integration and i 'm trying to get the output path for static assets ( images ) imported within the entry via a glob , however the images are missing from the manifest.json despite being outputted to the dist folder . is this the expected behaviour ? if so what is the recommend approach ? src/main.js vite.config.js output from vite build generated manifest.json expected/desired manifest.json < code > build : { manifest : true , outdir : 'public/dist ' , rollupoptions : { input : '/src/main.js ' } , } , import 'vite/dynamic-import-polyfill ' ; import './scripts/main.ts ' ; import './styles/main.scss ' ; let images = import.meta.globeager ( './images/ * * / * ' ) ; { `` src/main.js '' : { `` file '' : `` assets/main.2cb57978.js '' , `` src '' : `` src/main.js '' , `` isentry '' : true , `` css '' : [ `` assets/main.912f90a6.css '' ] } } vite v2.2.4 building for production ... 6 modules transformed . public/dist/assets/one.4ed5b8eb.jpg 300.71kb public/dist/assets/two.ac9e63e7.jpg 1183.60kb public/dist/manifest.json 0.16kb public/dist/assets/main.2cb57978.js 0.62kb / brotli : 0.31kb public/dist/assets/main.912f90a6.css 6.02kb / brotli : 1.47kb { `` src/main.js '' : { `` file '' : `` assets/main.2cb57978.js '' , `` src '' : `` src/main.js '' , `` isentry '' : true , `` css '' : [ `` assets/main.912f90a6.css '' ] } , `` src/images/one.jpg '' : { `` file '' : `` assets/one.4ed5b8eb.jpg '' , } }
vue & vite running in a docker container as frontend , and backend is in the same container ... my problem that `` npm run dev '' is not showing the changes on the template ... this my vite config file ... any idea how to fix this ? or because docker wo n't work ? ... it is only working with npm run build < code > import { defineconfig } from 'vite ' import vue from ' @ vitejs/plugin-vue ' export default defineconfig ( { mode : 'development ' , // production plugins : [ vue ( ) ] , build : { // minify : false , outdir : 'public ' , } } )
hi , i 'm using vue 3 + vite ssr , and i installed vue-meta to render my pages but i 'm having problems making it work . when i run vue-meta 's rendertostringwithmeta function , it internally calls rendertostring from server-renderer.cjs.js and i run into an error : `` can not destructure property 'createcomponentinstance ' of 'vue.ssrutils ' as it is null '' if i 'm not mistaken , this seems to happen because @ vue/runtime-core does not export the ssrutils object on esm . and when it is loaded directly , instead of the cjs version being converted to an esm , it does not contain the ssrutils object . is there any way i can make sure that vite converts the cjs runtime-core to esm ( and keeps the ssrutils object ) instead of directly using the esm ? i 've read the docs a few times now but i 'm still confused , any help is appreciated ! < code >
i use path.resolve to parse router map by myself , i inject this api in guard hooks . when i run dev , broswer will throw a waring that this api is not to use in client side what should i do < code >
hello all , i have n't seen this in the docs so thought i 'd ask here . my dad and i have deployed a few react apps on iis ( i do n't really have a choice here , it 's just what he uses ) and so far it 's worked well enough with create react app and react router , after making a few necessary tweaks based on the cra docs . has anyone successfully deployed an app this way using vite ? i 'm strongly considering moving our projects into vite if it 's possible . < code >
after defining import alias in vite.config.js , the import statements are not been understood when running jest . example , in vite.config.js , i designate import alias : now i can use ~ as src : but when running jest , it errors : any idea how to allow jest to understand import alias defined in vite.config.js ? < code > can not find module '~/app ' from 'src/main.jsx ' import app from '~/app ' export default defineconfig ( { resolve : { alias : [ { find : '~ ' , replacement : path.join ( __dirname , 'src ' ) } ] } , } ) ;
what i am trying to accomplished hi , i have a use case where i need to setup a react ssr application , and changes the import path of a particular module depending on if it is resolving in ssr or not . the case that is working [ using configureserver hook for ssr ] i follow the doc and wrote a small plugin using resolveid which works great when i use configureserver hook to return me html . [ see this working by doing yarn dev in this branch ] the case that is failing [ using ssrloadmodule for ssr ] i than changed the ssr setup to a middleware mode using ssrloadmodule to load application on a koa server instead . this time i get an error in the terminal and it seems the module path was not changed . [ see this fail with the following error by doing yarn ssr in this branch ] questions are there particular differences b/t using configureserver hook vs ssrloadmodule that i should be award of ? i can help debug into the method itself but any pointer on how to start debugging this or assumption would be are highly appreciated 🙏 thank you ! a bit of additional information . i log out the plugin and some stuff from vite . it looks like in client side , the plugin would load and everything is fine . but in server side , the plugin would not get invoked found the fork where client side & server side works differently ok , i am now convince the vite plugin i wrote does not load with ssrloadmodule i did find # 1636 , also from the ssr option , ssrloadmodule should have plugin support . very confuse 🤔 < code >
hi vite has been working fairly smoothly for me so far , but now i have a dependency i 'm working on actively alongside my frontend code . i have this in my vite.config.js : vite is configured in my frontend project . mydep is npm link'ed in to that frontend project via the usual two-step npm link process . mydep and the frontend project happen to both live alongside each other in the same directory -- but that means mydep does not lie beneath the root directory of the frontend project where my vite.config.js lives -- like this : whenever i change any .js file under mydep , killing and restarting vite lets me see the changes . however , hot module reload does n't occur . is there a way to get vite to do hot module reload for npm linked projects ? or some different way to approach this situation that would let me use hot module reload ? thanks < code > optimizedeps : { exclude : [ 'mydep ' ] } top mydep package.json frontend package.json vite.config.js
`` vite '' : `` ^2.3.3 '' , '' vite-plugin-compression '' : `` ^0.2.5 '' , `` vite-plugin-style-import '' : `` ^0.10.0 '' , '' vue '' : `` ^3.0.5 '' , i use npm run dev and the project runs successfully , but it ca n't be accessed < url > there was no mistake . < code >
i tried porting a small project to vite today - super fast and looks promising , but i ran into the fact that i use export interface and import { somereactcomponent , thatinterface } in my codebase . per # 2117 , this is a wontfix because it 's part of how esbuild works ( file by file . ) so that 's fine , and i 'm generally open to larger refactors in exchange for the speed/simplicity . but it does make me worry that perhaps i 'll run into compatibility problems with various npm modules : i have no idea what they do . is this something i have to worry about , or can i assume > 99 % of all node modules will just work . < code >
background i use vite to build my project from esmodule to commonjs , and i will run the result in nodejs . one problem that bothers me is that process.env has been converted to a specific value , but i just want process.env to stay the way it is because i will pass in the concrete value when nodejs runs the result . detail my code looks something like this : the result of the build is something like this : the build result i expect : it 's my config : < code > usevariable ( process.env.root ) export default defineconfig ( { build : { outdir : ' .. / .. /dist ' , lib : { entry : path.resolve ( __dirname , './index.ts ' ) , name : 'main ' , formats : [ 'cjs ' ] } , rollupoptions : { plugins : [ autoexternal ( { packagepath : './package.json ' } ) ] } } } ) usevariable ( { } .root ) usevariable ( process.env.root ) // keep it as it is
hi all , i 've got a few custom html components in my app and i 'm trying to set up hot module reload when making changes to their style without having to reload the whole app . my current setup is : in the same file , i 'm trying to accept updates from the css / html modules so i can re-update the shadow dom / my styles , but i 'm not getting anything coming through : tried a few different things like only listening for change on the css modules only ( thought the raw option might cause some issues ) , but no luck . i do see [ vite ] hot updated : /elements/myelement.css when making changes to the css file , and it also seems to work fine with calling import.meta.hot.accept without dependencies , but i need the updated content of the css / html files . any ideas ? < code > import html from `` ./myelement.html ? raw '' ; import css from `` ./myelement.css '' ; customelements.define ( `` my-element '' , class myelement extends htmlelement { constructor ( ) { super ( ) ; this.root = this.attachshadow ( { mode : `` open '' } ) ; const element = object.assign ( document.createelement ( `` div '' ) , { innerhtml : ' < style > < cur > { css } < /style > < cur > { html } ' , } ) ; this.root.append ( ... element.childnodes ) ; } } ) ; if ( import.meta.hot ) { import.meta.hot.accept ( [ `` ./myelement.css '' , `` ./myelement.html ? raw '' ] , ( newmodules ) = > { console.log ( newmodules ) ; } ) ; }
so , i am having an issue with commonjs bundling using vite in vue 3. here is the error message : i am trying to use axios and set some bases of it with axios.create { baseurl : ... the problem is i think vite is only able to bundle esmodules which is not the case for axios that contains commonjs in it . is there any way how to implement rollups in vite ? ( i tried many ways but failed ) < code >
our vue frontend app is served at `` /app/ '' . our api is at `` /_api/ '' . to retrieve csrf token from backend , we apply a trick , that we place this code in index.html : however , because our vite.config.js set : vite always rewrite the path above to `` /app/_api/hello '' . is there any config to tell vite to ignore some selected url ? < code > { base : '/app/ ' } < script type='text/javascript ' src='/_api/hello ' > < /script >
is there a way to serve more than one static directory ? in my case i have a monorepo with a shared/public directory that i 'd like served ( e.g . /shared/fonts/inter.ttf ) as well as the public dir . snowpack has a mount feature for this . any equivalent in vite ? < code >
is there a way to omit the root entirely in the import path ? ex : in create-react-app you can set a baseurl . so instead of writing you can write : this looks much cleaner . how to achieve the same in vite ? < code > import user from '~/src/components/user ' ; import user from 'components/user ' ;
coming from create react app , i 'm used to access special environment variables ( react_app_ * ) in the html template index.html . the same appears to work with vite , but the documentation is not clear about that . example for once , this only works in production , but more importantly this will print undesired quotes in the browser tab : so two questions : are env vars meant to be used in the template ? can this be done without the quotes ? < code > # .env vite_app_title=my website < ! -- index.html -- > < title > import.meta.env.vite_app_title < /title >
in the production environment , there is no problem with vite dev code , but with vite build , the code execution will report an error , because the code has been compiled , so it is difficult to find the source . simply put , it 's a production environment , but you do n't want to confuse code compilation , is there a solution ? < code >
terser is not able to minify tagged templates , like for example those used in styled components . for babel there is an official plugin for styled components , but i could n't find anything that i could use with vite or rollup . does anyone know some plugin to minify styled-components tagged templates ? < code >
hi , is there any solution to apply different rollupoptions ( e.g . external ) for different output formats ( e.g es , cjs - umd ) . thank you . < code >
hi folks ! 🤗 i 'm working on a tool to show a catalogue of components . i 'm using import.meta.globeager in order to get all the components from a folder as this : but , as this could be used anywhere , i would like to change for something like this : where in config i have : the icons_dir has the value i expect but i got this error : while i understand the error , i would like to know if you know any way i could achieve this as i 've been struggling to find a solution . thanks for your help ! < code > const iconfiles = import.meta.globeager ( ' .. / .. / .. / .. /frontend-fc -- web-server/icons/lib/ * .js ' ) 13:03:06 [ vite ] internal server error : import.meta.glob ( ) can only accept string literals . plugin : vite : import-analysis file : /users/midudev/dev/sui/packages/sui-svg/src/app.jsx 5 | import `` ./index.scss '' ; 6 | const iconfiles = import.meta.globeager ( __icons_dir__ ) ; const iconfiles = import.meta.globeager ( __icons_dir__ ) const root = path.join ( __dirname , ' .. ' , 'src ' ) const iconsabsolutedir = path.resolve ( process.cwd ( ) , 'lib/ * .js ' ) const icons = path.relative ( root , iconsabsolutedir ) ... define : { __icons_dir__ : json.stringify ( ' .. / .. / .. / .. /frontend-fc -- web-server/icons/lib/ * .js ' ) } ,
< url > importing .css files will inject its content to the page via a < style > tag with hmr support . you can also retrieve the processed css as a string as the module 's default export . how do i disable this behaviour ? this feature is bad when developing web components . the styles get inserted into the custom element , but also inlined in the head . < code > import styles from './my-element.scss ' @ customelement ( 'my-element ' ) export class uescrolltop extends litelement { static styles = unsafecss ( styles ) ... }
is there a way to run the a rollup plugin with all the vite additions/environment ? ( eg . : import.meta.globeager ) i tried to import some ts files with a glob pattern but that results in unknown file extension `` .ts '' i would like to concat some ts files ' default export and write it out into a file at the end of the build . < code >
hi ! i 'm having an issue with images referencing svg files in the template section of a vue sfc . the vue plugin of vite picks these up and attempts to bundle them and use imports on them . this causes the app not to load and the dev console complains about svg+xml being loaded as a module . is it possible to exclude these somehow so that they 're just being served as static files later on ? i 've circumvented it by putting the icons as variables within the component instead and this works . does not work does work i assume i 'm doing something wrong and i tried to configure the vue plugin to simply exclude the assets but without any luck . any ideas ? thanks ! michael < code > < template > < img : src= '' icons.close '' alt= '' close '' > < /template > ... data ( ) { return { icons : { close : '/assets/images/icons/close -- black.svg ' , pdf : '/assets/images/icons/file/file__pdf -- brand.svg ' } } } , < template > < img src= '' /assets/images/icons/close -- black.svg '' alt= '' close '' > < /template >
i 'm doing a library build and could n't find a css.extract option ( similar to vue-cli configuration ) , so how do you configure vite to inline css into the js bundle ? < code >
i must import an umd file , and for some reason it ca n't be published to npm i attempt to add it into optimizedeps.include ( relative path , eg : '' ... /mylibs/xx.umd.js '' ) , but when the umd file is outside node_modules , it does n't work . however , when i manually put it in the node_modules , and add an package.json file , it works fine < code >
i am trying to set up a mono repo where backend lambdas and frontend react will share some common interfaces . currently its working with relative imports , but absolute imports are just not recognizing the shared folder . can anyone assist me ? relative import absolute import tsconfig vite config eslint < code >
how to setup vite to output during npm run build to a single js file for each modern and legacy browsers and also a single css file ? current vite.config.js looks as follows . running 'npm run build ' results in the following output . the desired output should be similar to the following . note that the file name hashing should also be removed . similar setup for snowpack is shown here < url > but that one does n't involve the modern and legacy browser differentiation of the js bundle . < code > > svelte-vite @ 0.0.0 build /home/user/svelte-vite > vite build vite v2.1.3 building for production ... 9 modules transformed . build/assets/index-legacy.js 7.8kb / brotli : 2.99kb build/assets/svelte.png 5.06kb build/index.html 0.97kb build/assets/index.css 0.88kb / brotli : 0.37kb build/assets/index.js 6.53kb / brotli : 2.61kb import svelte from ' @ sveltejs/vite-plugin-svelte ' import legacy from ' @ vitejs/plugin-legacy ' / * * * @ type { import ( 'vite ' ) .userconfig } * / const config = { plugins : [ svelte ( ) , legacy ( { targets : [ 'defaults ' , 'ie 11 ' ] , polyfills : [ ] , } ) , ] , build : { outdir : `` ./build '' , rollupoptions : { } } , } ; export default config ; > svelte-vite @ 0.0.0 build /home/user/svelte-vite > vite build vite v2.1.3 building for production ... 9 modules transformed . build/assets/vendor-legacy.f71d9f42.js 3.67kb / brotli : 1.47kb build/assets/index-legacy.0e83eefc.js 4.13kb / brotli : 1.52kb build/assets/svelte.d72399d3.png 5.06kb build/index.html 0.97kb build/assets/index.64a40f2d.css 0.88kb / brotli : 0.37kb build/assets/index.ab696668.js 2.99kb / brotli : 1.19kb build/assets/vendor.8580ce95.js 3.54kb / brotli : 1.42kb
closed i have been switching my cra to vite on a branch at work . one strange bug i 've noticed is my react-tooltips have a strange new behavior where tooltips resurrect themselves and display the tooltip again even though the user has not hovered them again . does anyone have an idea what may cause this or how to fix it ? it 's weird to me as it was n't a problem on cra but is a problem on vite . nothing in the code has changed other than using vite . < code >
this would be really useful to lit users who use rollup style loaders such as rollup-plugin-postcss-lit or rollup-plugin-lit-css that transform style imports into lit style objects at build-time : as of now all these styles get unnecessarily duplicated in < head > . a css.inject option would help a lot in this case : < code > export default { css : { inject : false , } , } ; import styles from './my-styles.scss ' ;
facing a problem where code like this : import { app } from 'app ' ; fails with error : the following dependencies are imported but could not be resolved i have to change it to import { app } from './app ' ; my app is pretty big . is there a way to configure vite to have the same behavior so i wo n't need to manually change thousands of imports ? < code >
i am using vite with bootstrap for a static multipage site . this is the default project folder structure after the build command . but i want to make this a multipage site and change the input and output directory for a better organizable way like this basically , it should take the 'src ' as an input folder and output 'dist ' as a child of the 'my-app ' . when i try to do this it shows errors , then i change the scripts of the package.json into this this way the 'dev ' command works fine . but the 'build ' command makes the dist folder inside the src folder and does not generate other html files except index.html now how can i fix this ? any suggestion ? < code > my-app/ node_modules/ package.json src/ about.html index.html main.js style.scss dist/ assets/ about.html index.html my-app/ node_modules/ dist/ assets/ index.html index.html main.js style.scss package.json `` scripts '' : { `` dev '' : `` vite src '' , `` build '' : `` vite build src '' , `` serve '' : `` vite preview '' }
although i understand from migration from v1 that one of the reasons is the decreasing reliance on middleware , it does n't seem to be a necessary reason to do so . so why is this necessary ? < code >
i am trying to use the lib-jitsi-meet library in my setup . unfortunately , these people have a really strange way of bundling their library so simply importing it in vite leads to errors after import on their site . that 's why i started to include their minified bundle instead . this leads to the error message `` no default export found '' . i was able to fix this for the dev server by adding it to the prebundling config . however , vite build still throws because it ca n't find a default export . the lib also is n't available in its newest version on npm so here is how to install it and reproduce : now you can run npm run dev and it will work . however , running npm run build will attempt to build it but ultimately fail with error : 'default ' is not exported by .. \lib-jitsi-meet\lib-jitsi-meet.min.js does anyone has a solution for this problem or is it a bug in vite ? < code > git clone < url > cd lib-jitsi-meet & & npm i # builds the lib cd .. /your-project & & npm i .. /lib-jitsi-meet // vite.config.js ... optimizedeps : { include : [ 'lib-jitsi-meet/lib-jitsi-meet.min ' ] } // main.js import jitsimeetjs from 'lib-jitsi-meet/lib-jitsi-meet.min ' const initoptions = { disableaudiolevels : true } // use it so it does n't get tree shaked jitsimeetjs.init ( initoptions )
trying to host vue3 development on a remote machine , using vite to serve development , do hot module replacement ( hmr ) , etc. , and it works perfectly when developing locally . i 'd like to be able to develop remotely , and so i thought i 'd set up an instance , put the dev stuff on it , and run a caddy instance to proxy port 3000 to port 80. this almost works . i get the page served fine , but hmr fails , and the page reloads itself every few seconds because the websocket can not connect . i can add another port forward proxy with caddy , but it appears that it has to have a different path ( e.g. , i can forward everything for path '/static ' to some other port ) , but it does n't appear , from a cursory look at the vite code , that the websocket code uses a different path , it just runs via '/ ' like everything else . is there a separate path ? can one be configured ? is there a way to deal with this ? thanks ! < code >
i have a project which need the babel-tranform-runtime to compile some files using es5 . and i know vite is only compatible with es2015 or above . the @ vitejs/plugin-legacy plugin can only convert the syntax . how can i use some grammar like array.from which show up in es2015 ? how can i migrate my project from webpack to vite ? < code >
i 'm a newbie when it comes to js . i 'm working on a project and want to use vite with vanilla javascript . i do n't need to support ie 11. should i use @ rollup/plugin-babel in build.rollupoptions.plugins ? < code >
i have a problem with hmr when running 2 projects on localhost on different ports . i 'm running one project on localhost:3000 and another project on localhost:5000. vite is logging hmr update when making changes , but the browser tab is being refreshed only for one project , not for the other . i 've tried changing vite.port , but that does n't fix it . < code >
i 'm moving an application over from webpack to vite but i 'm stuck at a style problem . the app is using vue2 and on all places < style lang= '' scss '' scoped > is used it gets exported to a css file . so i could load all these styles by default in the root html file but the problem is i currently have at least 50+ css files and this means i 'm loading a few mb of un-used style just because some lazy loaded component used one of these files . not great at all , so my question is can i force sass files to be inlined in the js or is there some config value i can use to automatically import css when a js file is lazy loaded ? my vite.config.js : < code > import { createvueplugin } from `` vite-plugin-vue2 '' ; export default ( ) = > { return { build : { assetsinclude : [ ] , manifest : true , outdir : 'public/js ' , rollupoptions : { input : 'resources/js/main.js ' } } , plugins : [ createvueplugin ( { vuetemplateoptions : { transformasseturls : false , } , } ) , ] , publicdir : 'staticfiles ' , } ; } ;
i 'm moving a cra app onto vitejs and running into issues with apollo-client , specifically i have a dependency in my node_modules that does : where @ apollo/client is a barrel export file : < url > but i end up getting uncaught referenceerror : apollolink is not defined . if i manually change export * to export { apollolink } from './core ' then the error goes away , but i get another for the next missing import . like it seems like i 'd have to `` fix '' / manually-expand all of the export * s in any dependencies i have . i know that esbuild has limitation on isolatedmodules behavior , but afaiu export * isn't/should n't ( ? ) be one of them ? it seems like not supporting export * would break a ton of libraries ... should this `` just work '' and i need to dig for some other root cause ? < code > import { apollolink , fetchresult , graphqlrequest , operation } from `` @ apollo/client '' ; export * from './core ' ; export * from './react ' ;
when developing and using npm run dev ( with hot reloading ) , any ideas how to get the nonce-token ( that is needed for authenticating wp-json api ) inside the index.html file ? or is it better to simulate the backend server when developing with hot reloading ? when using npm run watch it works fine , then i replace a placeholder inside the index.html to the needed nonce with php . < code >
how to package the imported style of each component in the page into js , and then dynamically create the imported < style > < / style > file < code >
i am trying to upgrade frontend tooling on a 2015-ish project written on vue 1. so far plugin-vue seems to be disliking triple curly brackets in templates which were used to output html without escaping . is there a config option to make it work ? is it feasible at all to dev/build vue 1 project with vite , or should i forget about it ? < code >
use vue-tsc -- noemit & & vite build , when opening a project in chrome browser , an error is reported how can i analyze and solve it < code >
hi , i did n't transpile any my ts code in my library and try the library in vite . and i 've got error about process.env not defined . anybody know how to resolve this problem ? i can not change process.env to import.meta in the library . < code >
according to the docs link description you should always reference public assets using root absolute path - for example , public/icon.png should be referenced in source code as /icon.png . in my code , my file tree structure . readme.md index.html package-lock.json package.json public favicon.ico lib arearestriction_min.js curveline.min.js images bg_drawing_tool.png blank.gif circle.png ruler.cur texticon m0.png m1.png js.txt map3.0.js map3.0_init.js modules vmlcontext_41oars.js .txt src app.vue assets car.png logo.png components helloworld.vue index.css main.js main.js.map main.ts module complexcustomoverlay.js complexcustomoverlay.js.map complexcustomoverlay.ts router index.js index.js.map index.ts shims-vue.d.ts tsconfig.json vite.config.ts 12 directories , 115 files all status codes are 404 //vite.config.ts < code > < link rel= '' icon '' href= '' /favicon.ico '' / > < script type= '' text/javascript '' src= '' /lib/map3.0_init.js '' > < /script > ...... import { build , defineconfig } from 'vite ' import vue from ' @ vitejs/plugin-vue ' import { resolve } from 'path ' import pluginrewriteall from 'vite-plugin-rewrite-all ' ; // < url > export default defineconfig ( { plugins : [ vue ( ) , ] , resolve : { alias : { ' @ lib ' : resolve ( __dirname , 'lib ' ) , ' @ m ' : resolve ( __dirname , 'src/module ' ) , ' @ ' : resolve ( __dirname , 'src ' ) , ' @ a ' : resolve ( __dirname , 'src/assets ' ) , } } , assetsinclude : resolve ( __dirname , 'lib ' ) , base : `` ./ '' , publicdir : `` ./lib '' , build : { assetsdir : './lib ' , rollupoptions : { inlinedynamicimports : true } , } , // optimizedeps : { // include : [ ] // } } )
my typescript is being compiled correctly , but i 'd like to remove the hash from it to have it as a single source of truth to be used externally . so rather than having : i 'd like it to be compiled as : i 've looked all over the docs but i have n't been able to figure out how to do this . any help would be appreciated ! < code > /assets/main.js /assets/main.75be657f.js
is there a way to import a shared commonjs file that is used by both the client and e.g . a node server ( that still needs to use commonjs ) . so i have a shared-helpers.js file that looks something like this ( could also include require calls ) this shared-helpers.js is both imported and required using import produces ( understandably ) this error i guess it is not the intended use case for vite , @ yyx990803 wrote in # 326 if you want to write commonjs in your src code , then no , vite is created so that you only use standard esm in your own code . but i was still wondering if there is an option to do this without needing to write a custom plugin for it . basically i would like to tell vite to handle shared-helpers.js the same way it does handle other external commonjs packages . < code > uncaught syntaxerror : the requested module '/shared-helpers.js ' does not provide an export named 'default ' const add = ( a , b ) = > a + b ; module.exports = { add } ; // some-common.js const helpers = require ( './shared-helpers.js ' ) ; // some-esm.js import helpers from './shared-helpers.js ' ;
hi 👋 i 'm trying to deploy a vite website to heroku where the project has some env . variables defined that i 'd like to inline in the javascript bundle generated by vite . however , according to the documentation , vite only reads env . variables from a .env file . have you considered extending this functionality to include all present env . variables that are prefixed with vite_ ? < code >
i ask this , as exclude property in vitejs does not remove threejs from dev builds , and messes up the dev build ( at times ) . also , i dont ' see any support for vite -- external argument , so that i can remove some node_modules completely from building . am i missing something here ? ? < code >
i depend on react-dates which eventually depends upon has-symbols . this is causing issues where i 'm getting global is not defined presumably this is happening because esbuild is n't converting global - > window during dependency bundling , and as far as i can see , esbuild does n't support that . initially i tried adding a rollup plugin so my config looked like the below file , as per suggestions in issues in this repo . but i think that wo n't work because rollup is n't processing those files because they 're pre-bundled by esbuild ? < code > import { defineconfig } from `` vite '' ; import reactrefresh from `` @ vitejs/plugin-react-refresh '' ; import globals from `` rollup-plugin-node-globals '' ; import graphql from `` @ rollup/plugin-graphql '' ; export default defineconfig ( { plugins : [ { name : `` rollup-plugin-globals '' , ... globals ( { global : true } ) } , graphql ( ) , reactrefresh ( ) , ] , build : { manifest : true , rollupoptions : { input : `` /assets/js/index.tsx '' , } , } , } ) ;
hi , i really need the feature # 2860. i am a deep stylus user , at the same time , i like vite very much . recently , i want to change my project from webpack to vite . at vite 2.1.5 , global variables.styl can not be import to other stylus files . please tell me when the new version will be released ? thx < code >
i 'm getting this error : it was hard enough getting jest to even work with vite in the first place ( as import.meta is not available in node and was throwing errors ) -- do you know what i need to do to make sure that jest knows that these are css files ? the build is using typescript and vite , but jest ( in order to get around import.meta ) has to use babel to transform . here 's the babel.config.js file : < code > test suite failed to run syntaxerror : /volumes/sourcecode/src/enerlytics/enerlytics-login-next/src/index.css : support for the experimental syntax 'decorators-legacy ' is n't currently enabled ( 1:1 ) : > 1 | @ tailwind base ; | ^ 2 | @ tailwind components ; 3 | @ tailwind utilities ; // only used by jest module.exports = { presets : [ [ `` @ babel/preset-env '' , { usebuiltins : `` entry '' , corejs : `` 2 '' , targets : { node : `` current '' } } , ] , `` @ babel/preset-typescript '' , `` @ babel/preset-react '' , // needed for jsx ] , plugins : [ function ( ) { return { visitor : { metaproperty ( path ) { path.replacewithsourcestring ( `` process '' ) ; } , } , } ; } , ] , } ;
i changed a vue2 project from vue-cli to vite . it works fine now . trying to remove dependency `` @ vue/cli-service '' from package.json . when removing , it gives in .postcssrc.js i changed as noted in # 1287 but then i get this error ( sometimes the error is for bootstrap.css or app.vue ) any suggestions on how to solve this and get rid of `` @ vue/cli-service '' ? maybe `` @ vue/cli-service '' has some other deps which are needed for handling the css files ? ps : i get the same error by simply closing any of these 2 projects , run npm install and npm run dev : < url > < url > thanks ! < code > [ plugin : vite : css ] loading postcss plugin failed : can not find module 'autoprefixer ' require stack : - /home/marius/work/wensia/admin/noop.js ( @ /home/marius/work/wensia/admin/.postcssrc.js ) /home/marius/work/wensia/admin/node_modules/bootstrap-icons/font/bootstrap-icons.css plugins : { require ( `` autoprefixer '' ) //gives unexpected string errors on various css/vue files // autoprefixer : { } } [ vite ] internal server error : unexpected string plugin : vite : css [ plugin : vite : css ] unexpected string /home/marius/work/wensia/admin/node_modules/vue-sidebar-menu/dist/vue-sidebar-menu.css
will it be suggested to replace webpack to vite if ie9 and above as compatiblity requirement ? how to debug in ie browser if consider to replace webpack to vite ? < code >
in the vue cli you can conditionally import a file using require if you specify dev mode . i 'm wondering if there is any kind of support for this in vite ? i should note that i 'm using typescript and therefore i would be importing a ts file , not a js file . if i convert the following into an import statement within an async function , i just get an empty module object and not the expected default export from the file . how it 's done with vue cli < code > import { createapp } from 'vue ' import app from './app.vue ' // new if ( process.env.node_env === 'development ' ) { const { worker } = require ( './mocks/browser ' ) worker.start ( ) } createapp ( app ) .mount ( ' # app ' )
am i right in thinking esbuild is used when running vite serve , and rollup is used when running vite build ? i got confused when reading about build.target as i thought builds were performed with rollup , but it says `` the transform is performed with esbuild '' . thank you . < code >
hi all , getting pouchdb to run seems to be tough under vu3/vite so far : .. shimmed global in index.html - < script > window.global = window < /script > running into uncaught error : module `` events '' has been externalized for browser compatibility and can not be accessed in client code . tried pulling events in via rollup-plugin-node-polyfills in vite.config.js but had no effect ( i might have done it wrong though ) anyone managed to get this working ? thanks < code >
hey folks ! while editing my tools i ca n't found vitejs on stackshare and i think adding it to stackshare give it us a little bit popularity 🤔 < code >
this work well in webpack , but vite no support require ./config.local it ignore by git , for each developer can write his own configuration . this file does not exist during remote build . so i ca n't use 'import localconfig './config.local ' , it will fail ===== webpack , viterequire , config.localgit , config.local , 'import localconfig './config.local ' < code > import devconfig from './config.dev ' ; // this is not vite.config import prodconfig from './config.prod ' ; let config : config ; if ( process.env.node_env === 'dev ' ) { config = devconfig ; } else if ( process.env.node_env === 'prod ' ) { config = prodconfig ; } else { const local = require ( './config.local ' ) ? ? { } ; config = local ? .default ? ? local ; } export default config ;
one of the tools i use generates the following typescript code : it 's a piece of code inside my application , not inside node_modules . when that file is imported it results in typeerror : ca n't find variable require . is it possible to have files with commonjs require in vite ? < code > import * as react from 'react ' ; // tslint : disable-next-line : no-var-requires const layercontextbs = require ( './layercontext.bs ' ) ;
hi , i am trying to build a preact app with vitejs . would like to mount it dynamically instead of rendering it in an index.html page . however , the exports mentioned in the entry point file is stripped out . here is the implementation , preact-app/src/main.jsx mounting part require ( 'preact-app/main ' ) returns undefined as the default export is stripped out . vite-js-config . any help would be really appreciated , thanks ! < code > export default renderhtml ( < cur > element ) { preact.render ( < app/ > , < cur > element ) ; } export default defineconfig ( { plugins : [ preact ( { devtoolsinprod : true } ) ] , build : { outdir : 'preact-app-dist ' , rollupoptions : { plugins : [ noderesolve ( ) ] , exports : 'named ' , output : { exports : 'named ' , assetfilenames : 'assets/ [ name ] [ extname ] ' , chunkfilenames : ' [ name ] .js ' , entryfilenames : ' [ name ] .js ' , format : 'amd ' , amd : { autoid : true , basepath : 'preact-app ' } } } } } ) ; require ( 'preact-app/main ' ) .renderhtml ( < cur > ( ' # preact-app ' ) ) ;
hi i am working on a vite project where i need to use esbuild-wasm to build some user-provided code . i have some code like where the define key should set env vars for esbuild-wasm . however , when i run vite to serve locally the `` process.env.node_env '' string is being interpolated by vite to become `` '' development '' '' in the browser . is there a way to prevent this behaviour ? < code > import * as esbuild from `` esbuild-wasm '' // some initialization await esbuild.build ( { // other configurations define : { `` process.env.node_env '' : `` production '' } } )
i 've seen many plugins like vite-plugin-windicss have the style of installation steps like this : step 1. install in the vite.config.js step 2. install in the main.js where [ step 2 ] is completed redundant .. would n't it be better to just inject the import 'virtual : windi.css ' automatically .. ? i 'm looking for the recommended way to inject js code into the main.js , any suggestions ? < code > // vite.config.js import windicss from 'vite-plugin-windicss ' export default { plugins : [ windicss ( ) ] , } ; // main.js import 'virtual : windi.css '
i 've spent like 3 hours today debugging why vite fails to run our production bundle . to hopefully save someone in the future those hours , i created this discussion . the errors you might encounter is either referenceerror : buffer is not defined or if you have it on window , you might get this one : this is caused by having import ' @ babel/polyfill ' . also the error might not happen in development if you have multiple entry points and you 're only testing those that do n't import it . when you remove the import and replace it with it builds and runs fine in both dev and production . a lot of projects might get this issue when they get ported to vite from webpack . many people have that import in their projects to support ie browsers . anyway good luck with vite and fare well . < code > import 'core-js/stable ' import 'regenerator-runtime/runtime vendor.79a2da47.js:131927 uncaught ( in promise ) error : expected opts.sync to be a function . at makeerror ( vendor.79a2da47.js:131927 ) at asserttypeof ( vendor.79a2da47.js:131924 ) at newgenerator ( vendor.79a2da47.js:131932 ) at gensync2 ( vendor.79a2da47.js:131835 ) at vendor.79a2da47.js:132459 at createcommonjsmodule ( vendor.79a2da47.js:22 ) at vendor.79a2da47.js:132454
trying to covert my templates over from snowpack ( vanilla.js/pug and svelte ) . both project templates i ca n't seem to get any gsap plugins to import . vite just asks if they are there ( and they are ) . gsap has the gsap.registerplugin ( ) method to help with treeshaking but vite ca n't even find the plugins so i am sure there is something i am missing in the config . any help would be appreciated ! to install clone you would need to replace the gsap npm with your club membership or use the free bonus gsap plugins . < url > < url > < url > < code >
i 'm trying to share the same file betwen node and vite : node : vite/vue this complains about module.exports and requires an export ( which does n't work in node ) i tried adding this in vite.config.js but this breaks vite-plugin-pages hannoeru/vite-plugin-pages # 28 i 've read/tried various ways , including making the node app a module ( but then ca n't use 'require ' anymore , or createrequire breaks with other code in existing app ) < url > lukeed/httpie # 33 but could n't get it working . is there any solution to make this work with vite ? < code > const uti = { date_display : 'd mmm , yyyy ' , } uti.isnumber = ( n ) = > { return isfinite ( n ) & & ! isnan ( parsefloat ( n ) ) } module.exports = uti //const uti = require ( './uti ' ) //used to work with vue-cli & webpack import { uti } from './uti ' const uti = require ( './uti ' ) const path = require ( 'path ' ) module.exports = { //needed for module.exports to work in frontend , be able to share same file between node and front alias : { // alias a path to a fs directory // the key must start and end with a slash '/ @ / ' : path.resolve ( __dirname , 'src ' ) } , }
we can ignore suffix by configuring as follows in webpack : but this is forbidden in vite , you can see : # 178 so when the dependencies in node_modules/ use webpack , and the code maybe as follows : instead of how to solve this problem without changing the third-party dependency < code > import { a } from './app ' reslove : { extensions : [ '.vue ' ] } import { a } from './app.vue '
here 's a minimal reproduction : < url > this app runs fine with npm run dev , but if i build and run the dist folder , i get a t.apply is not a function error when it 's attempting to parse or render the markdown . i have n't had any other issues so far with markdownit plugins . is this an issue with vite , mermaid , or the mermaid plugin for markdownit ? not sure where i should file the issue here . ( if you have n't used mermaid before , it 's awesome ! it lets you create diagrams of various types using a markdown-like syntax . i had it working under vue 2 , but had to disable it in our app for now under vue 3 until we figure this out . ) < code >
i tried to use @ vitejs/plugin-legacy to compile code for chrome 49. below is my setting in viteconfig.js : const legacyoption = { targets : [ 'chrome > = 49 ' , 'firefox > = 52 ' ] , } export default ( { command , mode } ) = > { return { root , resolve , server , css , //build , plugins : [ vue ( ) , legacy ( legacyoption ) ] , } } compile finished without error . however , when i open the website and login , on page routing i got several errors : uncaught syntaxerror : unexpected token import polyfills-legacy.6efd4eb6.js:1 unhandled promise rejection syntaxerror : unexpected token import ( anonymous function ) @ polyfills-legacy.6efd4eb6.js:1uo @ polyfills-legacy.6efd4eb6.js:1 ( anonymous function ) @ polyfills-legacy.6efd4eb6.js:1lo @ polyfills-legacy.6efd4eb6.js:1 ( anonymous function ) @ polyfills-legacy.6efd4eb6.js:1ui . ( anonymous function ) @ polyfills-legacy.6efd4eb6.js:1mi @ polyfills-legacy.6efd4eb6.js:1fi @ polyfills-legacy.6efd4eb6.js:1 polyfills-legacy.6efd4eb6.js:1 unhandled promise rejection typeerror : illegal invocation ( ) ( anonymous function ) @ polyfills-legacy.6efd4eb6.js:1uo @ polyfills-legacy.6efd4eb6.js:1 ( anonymous function ) @ polyfills-legacy.6efd4eb6.js:1lo @ polyfills-legacy.6efd4eb6.js:1 ( anonymous function ) @ polyfills-legacy.6efd4eb6.js:1ui . ( anonymous function ) @ polyfills-legacy.6efd4eb6.js:1mi @ polyfills-legacy.6efd4eb6.js:1fi @ polyfills-legacy.6efd4eb6.js:1 resize-event-legacy.697e0ca5.js:1 uncaught syntaxerror : unexpected token import polyfills-legacy.6efd4eb6.js:1 unhandled promise rejection syntaxerror : unexpected token import ( anonymous function ) @ polyfills-legacy.6efd4eb6.js:1uo @ polyfills-legacy.6efd4eb6.js:1 ( anonymous function ) @ polyfills-legacy.6efd4eb6.js:1lo @ polyfills-legacy.6efd4eb6.js:1 ( anonymous function ) @ polyfills-legacy.6efd4eb6.js:1ui . ( anonymous function ) @ polyfills-legacy.6efd4eb6.js:1mi @ polyfills-legacy.6efd4eb6.js:1fi @ polyfills-legacy.6efd4eb6.js:1 polyfills-legacy.6efd4eb6.js:1 unhandled promise rejection syntaxerror : unexpected token import can anybody help to figure out how to solve this ? appreciate for any hint ... < code >
i 'm trying to use ( react-command-palette ) [ < url > ] in my vitejs react-ts project . and i ca n't figure out how to use it . i first got an error that said can not find module 'react-command-palette ' or its corresponding type declarations . so i created a react-command-palette.d.ts with declare module 'react-command-palette ' inside it . but then i started gettgin the referenceerror : require is not defined at runtime . any help ? < code >
i 'm getting very unstable behaviour , where if i switch branches and work on vite in one of parts of monorepo , i usually get if i disable parts which render in ssr it works just fine . also if i tinker with my ssr code and slowly remove and add all code back , it starts working again . was trying to reproduce , but no luck with a fresh build . wondering if something else is failing silently , but this is where it manifests it 🤔 < code > error : no known conditions for `` ./compat/server '' entry in `` preact '' package
when importing zod into a svelte kit project , vite attempts to import a typescript file , for an unknown reason . the author of zod confirmed this should not be happening , it should use zod 's javascript entry point . error the error is enoent : no such file or directory , open '/users/me/my-app/node_modules/zod/src/index.ts ' . but zod actually exports javascript as both cjs and esm . zod was imported via : import * as z from 'zod ' ; original error report to zod : colinhacks/zod # 168 ( comment ) reproduce to reproduce , create a svelte kit project then in index.svelte , add this import import * as z from 'zod ' ; , and save . it should cause an error in the dev server console . info vite : ^2.1.0 @ sveltejs/kit : next zod : ^3.0.0-alpha.24 node : v14.7.0 macos < code > npm init svelte @ next my-app cd my-app npm i npm i zod
i use the observer as a decorator then i got the error , are there anyway to solve this ? can not find a place to enable this option . < code > > src/app.jsx:22:0 : error : unexpected `` @ '' 22 @ observer error when starting dev server : error : build failed with 1 error : src/app.jsx:22:0 : error : unexpected `` @ ''
hi , i 'm working on a middle-size app where we today are using webpack but are interesting in using vite instead . i have however some issues with the load time for development builds . it currently takes about 100 ms to load our application with webpack but with vite it takes about 5 sec . i understand that the main issue is that we do n't take advantage of code-splitting so under development we are downloading 150 javascript files and that takes time . however , 50 of these files are coming from node_modules , files that will never change . now to my question : is it possible to bundle all files that come from node_modes into one file , instead of bundle each package into its own file ? thanks for a great build tool ! < code >
when i run vite build even with minify : false and or -- mode=development all comments are stripped . i do n't think rollup deletes by default . i need the comments to strip development code in final build . using vue3/vite2 . < code >
hi i 'm facing an error with a project that builds semantic-ui ( actually the fomantic-ui fork ) with vite . the css comes out of a fairly complex less build and it works fine for the most part but it fails in this function this produces this error : i ca n't really tell if this is an error on less or on the way url imports work in vite . as a workaround i 'm ignoring this function and import manually < code > .loadfonts ( ) when ( @ importgooglefonts ) { @ import ( css ) url ( ' @ { googleprotocol } fonts.googleapis.com/css ? family= @ { googlefontrequest } ' ) ; } [ plugin : vite : css ] failed to find ' .. / .. / .. / .. /node_modules/fomantic-ui-less/ phofurl in [ /users/cquiroz/projects/scalajs-react-semantic-ui/demo/src/main/webapp/theme ] /users/cquiroz/projects/scalajs-react-semantic-ui/demo/src/main/webapp/theme/semantic.less
hey ! i 'm currently working on the vite-imagetools plugin . and while it works like a charm i feel like i used some dirty tricks to get it to work and would like to ask you all for advice . since vite seems to have very particular opinions about non-text assets , i have a load hook , that resolves the asset , applies all transformations to it and then outputs the image in build mode . this works very well , but since emitfile is disabled in development mode for obvious reasons , i have to write the generated images to my cache folder and then rewrite the imported url to point to that file . this also works , but besides feeling somewhat backwards it leads to continued fights with vites builtin plugins , so does someone have a better idea on how to solve this ? maybe something i missed ? < code >
hi ! we are evaluating vite as a replacement for our less-than-optimal webpack configuration , and used in a demo project for a designed system ( powered by tailwind ) . this is all tucked away in a monorepo , structured as follows : the web directory holds the design system itself , and web-demo is home of the demo project used for testing the design system . the index.html is just some basic html for the component we 're working on , so nothing special . the tailwind.config.js includes the plugin.js from the web directory ( = the design system ) . i have tried adding @ project/design-system as a dependency to the web-demo project through yarn link and yalc . for the record : these were separate attempts , of course . the initial build succeeds and the design system itself works properly , but vite does n't seem to detect changes in the web folder nor directly in the node_modules/ @ project/design-system folder , and requires a server restart . the question : is this something that should work out of the box , or through some sort of configuration option ? i found # 1614 during my quest and this makes me wonder whether i 'm missing something . < code > . react react-native web readme.md node_modules package.json plugin.js src web-demo index.html node_modules @ project design-system package.json postcss.config.js tailwind.config.js vite.config.js
i am trying to implement hmr using template engine : liquid js because .liquid files are not es module so i am trying to watch all .liquid in my directory using server.watch : but how should i access this chokidar watcher from main.js ? in webpack its done by using require.context or how to implement hmr with a template engine ? thanks and sorry my english xd < code > // liquidplugin const engine = new liquid ( { root : path.resolve ( __dirname , 'src ' ) , extname : '.liquid ' } ) ; export default function liquidplugin ( ) { return { name : `` transform-html '' , transformindexhtml ( html ) { return engine.parseandrender ( html ) } , } ; } // vite.config.js module.exports = { server : { watch : glob.sync ( './src/ * * / * .liquid ' ) } , plugins : [ liquidplugin ( ) ] , } ;
since the definition of importing an esm web worker is a hack , we can use it as a constructor : we can find the code previous import generates in the worker plugin : src/node/plugins/worker.ts it is confusing to people how to use it with dynamic imports , and seems that can not be used with import ( ' ... ' ) . invoking the dynamic import returns a module , and so , it is necessary to invoke what the worker plugin exports : it exports the function as default so we need to use it , the following code is equivalent ( with code spliting ) : i think this should be included in vite docs , here : web worker section . < code > async function usewebworker ( ) { const myworkermodule = await import ( './my-worker ? worker ' ) return myworkermodule.default ( ) < === use 'default ' function } import myworker from './my-worker ? worker ' function usewebworker ( ) { return new myworker ( ) } async transform ( _ , id ) { ... return 'export default function workerwrapper ( ) { return new worker ( < cur > { json.stringify ( url ) } , { type : 'module ' } ) } ' }
are there any plans for adding vue 2 as a starter template ? there is already a vue2 plugin for vite , so i feel like the groundwork has been laid . i am happy to try contribute a pr adding it if you think it would be a good addition to vite 🙂 < code >
in vue cli 3+ , we can use transpiledependencies option to import uncompiled package , like this but how can i do in vite , i search in the document but i ca n't find sth related to this option . < code > // vue.config.js module.exports = { transpiledependencies : [ 'vue-echarts ' , 'resize-detector ' ] }
vite treats index.html as the entrypoint/template while any ssg tool would overwrite it with the actual frontpage . this produces an unwanted fof ( flash of frontpage ) when visiting a page that has n't been prerendered . considering spa servers need url forwarding to the spa entrypoint and the entrypoint could have any name , it would be worth considering a name that 's not already reserved for the frontpage . hash-based navigation is the exception , but it would still work . < code >
development : i wrote the following code in setup function : it did n't work . it seems that compile the code to following : however , i hope it transforms the code to : then i tried to write a updated function by myself : but this syntax is wrong . < code > vue3 vite2 ant-design-vue @ vitejs/plugin-vue-jsx h ( a , { value : inputvalue , `` onupdate : value '' : ( < cur > event ) = > ( inputvalue.value = < cur > event ) } ) ; let inputvalue = ref ( `` ) const vnodes = ( < div class= { 'wrapper ' } > < h1 > title < /h1 > < input v-model= { [ inputvalue , 'value ' , [ ] ] } > < /input > < /div > ) return { vnodes } h ( a , { value : inputvalue , `` onupdate : value '' : ( < cur > event ) = > ( inputvalue = < cur > event ) , } ) ; < input value { inputvalue } onupdate : value= { onupdatevalue } > < /input >
i 've been pulling my hair out for hours over this . i 've tried every known plugin related to rollup , vite , and svg . i even tried to roll my own plugin . nothing works . i 'm using vite 2.0.5 and vue 3.0.7. i need to import the source code of a bunch of svg files as strings , not as components . from the docs , this should work , but does n't : instead , i get this browser error : failed to load module script : the server responded with a non-javascript mime type of `` image/svg+xml '' . strict mime type checking is enforced for module scripts per html spec . since ? raw did n't work , i also tried writing my own rollup plugin , which did n't help : does anyone have ideas ? i 'm down to the wire on on a deadline , and without getting svg icons working , i 'm sol . < code > // plugin-test.js , based on rollup-plugin-rawsvg export default function myplugin ( ) { return { name : `` plugin-test '' , transform ( code , id ) { if ( /\.svg < cur > /.test ( id ) ) { const content = json.stringify ( code.trim ( ) ) return { code : 'export default < cur > { content } ' , map : { mappings : `` '' } } } } , } } // vite.config.ts import myplugin from `` plugin-test '' export default defineconfig ( { plugins : [ myplugin ( ) , vue ( ) , viteeslint ( ) ] , ... import mysvgsource from `` ./assets/my-file.svg ? raw ''
i 'm currently using parcel to bundle assets together but there are a few things that bug me about it i wondered if anyone was using vite in production with shopify , and if they 'd be willing to share their set up ? < code >
a simple article on our process ( at work ) with replacing lerna , create-react-app and node-sass with vite , npm @ 7 workspaces and sass . < url > hope someone has use for it ! 🙏 < code >
< -- - js stacktrace -- - > ==== js stack trace ========================================= security context : 0x01e6a86408d1 1 : decode ( aka decode ) 000002ad02f874d1 ] [ e : ite-template < email > ollup.js : ~133 ] [ pc=0000039464a55451 phofhyperlink 2 : decodedsourcemap ( aka decodedsourcemap ) [ 000002ad02f8a979 ] [ e : ite-template < email > oll ... fatal error : ineffective mark-compacts near heap limit allocation failed - javascript heap out of memory 1 : 00007ff696cd180f napi_wrap+119407 2 : 00007ff696c787e6 v8 : :internal : :orderedhashtablev8 : :internal : :orderedhashset,1 : :nexttableoffset+38102 3 : 00007ff696c795e6 node : :onfatalerror+438 4 : 00007ff6974b5a6e v8 : :isolate : :reportexternalallocationlimitreached+94 5 : 00007ff69749dc21 v8 : :sharedarraybuffer : :externalize+833 6 : 00007ff69734f3fc v8 : :internal : :heap : :ephemeronkeywritebarrierfromcode+1436 7 : 00007ff69735a640 v8 : :internal : :heap : :protectunprotectedmemorychunks+1312 8 : 00007ff697357154 v8 : :internal : :heap : :pageflagsareconsistent+3204 9 : 00007ff69734c953 v8 : :internal : :heap : :collectgarbage+1283 10 : 00007ff69734afc4 v8 : :internal : :heap : :addretainedmap+2500 11 : 00007ff69736c30d v8 : :internal : :factory : :newfillerobject+61 12 : 00007ff6970cf76f v8 : :internal : :interpreter : :jumptabletargetoffsets : :iterator : :operator=+1295 13 : 00007ff69790abbd v8 : :internal : :setupisolatedelegate : :setupheap+546925 14 : 0000039464a55451 < code > 0 : exitframe [ pc : 00007ff69790abbd ]
tried to open my vite app ( runing in dev mode ) in wechat , quark , and qqbrowser , all failed . but samsung built in browser did the job pretty good thogth . wonder why , is it because those browsers lack es module support ? < code >
i thought i had found a way that worked but i realize now there are some weird compilation side effects . when i 've created hmr solutions in the past i 've generally passed the module.hot to a separate reusable handler . it makes it a lot cleaner since the process i use for hmr is create a hoc that uses the accepted module to set a signal and recreate the wrapped component . ideally i was trying to make this work : where _ < cur > hot is my wrapper . but this does n't seem to pass through properly . i tried to directly pass accept but it causes a weird bug if there are any strings after it : i noticed `` click '' was getting rewritten to `` /src/component/click '' which i 'm gathering is because the dependency version of hot where you name the dependencies needs the full path but users do n't write that so the transformation looks ahead for strings to transform . sure i could do something with the compiled output but this all points to me likely doing something unintended . am i right in assuming that unlike some of the older methods ( ie .. module.hot ) this one is n't expected to be able to be passed outside of the module and i should try to come up with a different solution ? < code > export default _ < cur > hot ( mycompnent , import.meta.hot.accept ) ; _ < cur > delegateevents ( [ `` click '' ] ) export default _ < cur > hot ( mycompnent , import.meta.hot )
class a { constructor ( ) { console.log ( this.constructor.name ) } } normal use when dev is running after build , this feature can not be used < code >
i 'd really like to see a good example of vite working in lib mode with treeshakeable vue components . there is a good example of a vue ui lib here , < url > but it does n't support tree shaking . side note : it got me thinking perhaps it makes sense to have a recipes/examples section in the docs ? < code >
i 'm writing a vite plugin that generates a manifest of all the files in the output directory . i 'm currently using the generatebundle hook and reading the file names from the bundle arg , but it does n't include stuff under public . is there a different hook i should be using , or is it okay to manually read the public dir from within my plugin ? < code >
just a post to say that we finally have gotten vite working to deliver an app rendering system we are happy with ( ssr ) it has taken us years to finally arrive at something that `` just works '' without mind-numbing debugging and confusion ... roughly a year ago ( at vuetoronto ) evan and i discussed the weaknesses in build systems and what the future might look like . anyway , today i can verify that evan made it happen and this platform is a solid improvement to webpack and everything else we 've used . looking forward to shipping some software ! andrew < code >
not sure if i 'm just missing something , but it appears that the transform stage is n't performed in dev ( or this parse error occurs before it gets to it ) when using jsx files in node_modules . it appears to choke during optimizedeps . unclear if transform is intended to happen here in dev and/or there is a way to opt-in . jsx files work fine in the src folder . if i use precompiled js of the node modules or do the production build everything works as expected . screenshot of the error : i can report an issue and provide a reproduction if needed . but was thinking this might be simpler than that . the use case is for solid which does custom transformations on jsx that differ depending on target ( client , server , hydration ) similar to svelte , so it is common to ship .jsx files in shared modules . thanks for any assistance . < code >
is there any html-loader alternative to vite ? so that i can split html files in to partials . i 'm new to vite . so any examples or code would be a great help 🙏 < code >
i initialized a fresh app with vite + typescript . it contains the vue-shims.d.ts . it contains defined a new global property in the main.ts file . now i want to let typescript know this global property exists : the build now fails : could anyone help me with this ? how do i define additional global properties without messing with the included vue-shims ? < code > declare module ' @ vue/runtime-core ' { interface componentcustomproperties { < cur > foo : string ; } } app.config.globalproperties. < cur > foo = `` bar '' src/vue-shims.d.ts:5:15 - error 2305 : module ' '' .. /node_modules/vue/dist/vue '' ' has no exported member 'definecomponent ' . declare module `` * .vue '' { import { definecomponent } from `` vue '' ; ~~~~~~~~~~~~~~~ const component : returntype < typeof definecomponent > ; export default component ; declare module `` * .vue '' { import { definecomponent } from `` vue '' ; const component : returntype < typeof definecomponent > ; export default component ; }
vite2 electron , < url > vite.config.ts vite2 node_modules , import ; < code > require ( 'dotenv ' ) .config ( { path : join ( __dirname , '.env ' ) } ) import { defineconfig } from 'vite ' import vue from ' @ vitejs/plugin-vue ' import vuejsx from ' @ vitejs/plugin-vue-jsx ' import externals from 'rollup-plugin-node-externals ' import { join } from 'path ' import { cjs2esm } from './script/utils ' // < url > export default defineconfig ( { plugins : [ vue ( ) , vuejsx ( { / * options are passed on to @ vue/babel-plugin-jsx * / } ) , ] , root : join ( __dirname , 'src/render ' ) , base : './ ' , // index.html server : { port : +process.env.port , } , resolve : { alias : { ' @ ' : join ( __dirname , 'src/render ' ) , ' @ src ' : join ( __dirname , 'src ' ) , ' @ root ' : __dirname , } , } , optimizedeps : { // exclude : [ 'electron-store ' , 'electron ' ] , } , build : { outdir : join ( __dirname , 'dist/render ' ) , sourcemap : true , minify : false , rollupoptions : { external : [ 'electron ' ] , plugins : [ externals ( ) , // cjs2esm ( ) , ] , } , } , esbuild : { jsxfactory : ' h ' , jsxfragment : 'fragment ' , // jsxinject : 'import { h } from 'vue '' , @ vitejs/plugin-vue-jsx } , } )
when the dev server is running and i modify a file in a directory . is there a way to configure vite so that it reloads the page . right now , my app reads markdown files to create a slideshow . these are located in /src/slides if i modify one of these files whatever is handling hmr does n't notice , so i have to do a manual browser refresh . i tried different configuration of the server object . but that does n't seem to work . the page reloads fine if i modify sass , js , html files , but evidently not md files . is there a configuration i 'm missing somewhere ? < code > export default { root : `` src '' , publicdir : `` public '' , server : { open : true , watch : { paths : `` /src/slides/ * .md '' , } , } , } ;
if i need to import an index.js file which is in directory named dir1 , i can import it using import file1 from ' @ /components/dir1 ' but somehow it does n't work with .vue extension files . i have to explicitly mention the file name such as import foo from @ /components/foo/index.vue . what changes do i have to make in the settings in order to import the .vue extension file without mentioning the filename ? vite.config.js file is below < code > export default defineconfig ( { plugins : [ vue ( ) ] , resolve : { extensions : [ '.js ' , '.ts ' , '.vue ' ] } } )
hi , i 'm using vite 's ssr together with express . for certain reasons , i 'm using the es6 module syntax ( i.e . import/export ) for the whole project , not just for the vite part.1 however , the ssr production build produced by vite build -- ssr src/entry-server.js -- outdir dist/server uses the commonjs syntax ( exports/require ) and thus is incompatible with the rest of the project . therefore , when i try to run the project in production , i get an error : referenceerror : exports is not defined . i tried different options for vite build , like -- target esnext , but no matter what i choose , i never get the esm import/export syntax . when i manually convert the resulting entry-server.js file to use import/export , the production build works fine . is there any way to tell vite build to use esm import/export syntax ? thanks a lot ! 1 : the thing is that i need a local module in both express and vite , and since vite does n't support require , i thought i 'd just switch the whole project to es6 modules . < code >
i 'm using only a few specific modules from lodash-es debounce , merge , clonedeep etc .. in my code like so : import { debounce , clonedeep } from `` lodash-es '' ; then i have to exclude it in optimizedeps for the dev server to work otherwise i get : and if i do exclude it , then the dev works but prod build fails : and ... if i add the same optimizedep.exclude array to rollupoptions.externals as per the suggestion then the build passes but there 's an issue with chunks if i set manifest : true ( required for backend integration ) . so i 'm in a pickle here , not sure how to move forward . appreciate any help ! thanks . < code > error when starting dev server : error : the following dependencies are imported but could not be resolved : lodash-es ( imported by /users/myusername/work/my-project-5.7/application/js/build/dashboard/utils/chart.js ) mitt ( imported by /users/myusername/work/my-project-5.7/application/js/build/dashboard/event-bus.js ) axios ( imported by /users/myusername/work/my-project-5.7/application/js/build/dashboard/utils/pdf-report.js ) @ amcharts/amcharts4/core ( imported by /users/myusername/work/my-project-5.7/application/js/build/dashboard/utils/chart.js ) @ amcharts/amcharts4/charts ( imported by /users/myusername/work/my-project-5.7/application/js/build/dashboard/utils/chart.js ) [ vite ] : rollup failed to resolve import `` lodash-es '' from `` .. /packages/my_project_projects/js/dashboard/reports/overview-report/src/store.js '' . this is most likely unintended because it can break your application at runtime . if you do want to externalize this module explicitly add it to 'build.rollupoptions.external '
i 'm using vite in a monorepo setup and my model layer includes both firebase and firebase-admin . the latter only works in node environments not in the browser . i 'd like to ideally ask vite to ignore certain files when running ( i 've already got a conditional if statement which means no node dependant code is actually called when running in the browser ) . < code >
giturl i 've configured a multi-page app , but i ca n't access the route with vue-router , how to config ? < code > // env : vite/2.0.0-beta.64 win32-x64 node-v12.6.0 // vite.config.ts import { defineconfig } from 'vite ' ; import { resolve } from 'path ' ; import vue from ' @ vitejs/plugin-vue ' ; const port = 3000 ; export default defineconfig ( { plugins : [ vue ( ) ] , build : { rollupoptions : { input : { main : resolve ( __dirname , 'main.html ' ) , about : resolve ( __dirname , 'about.html ' ) , nested : resolve ( __dirname , 'nested/index.html ' ) , } } } , server : { port , } } ) ;
sorry guys , but i have a question , in some ssr examples its used the following snipped : but when try to watch ctx.modules , always its empty , i want to know in what specific scenario it has something , because i want to pre-render a component with its styles , but it loads the styles until js is loaded in browser . someone who wants to explain me i will be very happy with that . < code > const ctx : ssrcontext = { } const apphtml = await rendertostring ( app , ctx ) // need to resolve assets so render content first const renderedhtml = renderhtml ( transformedindexhtml , apphtml ) // render current page 's preloadlinks renderpreloadlinks ( ctx.modules , ssrmanifest )
hey . i 'm trying out vite right now and i 'm pretty excited about it . my test playground is a simple react app which uses react-three-fiber to render a simple 3d scene which just works . one special thing when dealing with 3d stuff are shaders which may be placed in its own files , beacuse they are written in glsl and one may want to get code highlighting . in js they are simply handled as strings . so , currently a simple import fragmentshader from ' .. /shader/grid.frag.glsl ' ; wont work , because i get a syntax error . is there a way for importing file contents just as text strings ? < code >
so i have been experimenting with vite , and i was involved in how fast it is . i tried state management and routes , now i would like to experiment on pwa . how to add pwa for vite vue ? thanks 😊 < code >
minimal reproduction here : < url > i was developing a nifty vue 3 app under vite that used babylonjs to create a vr environment . cool stuff . got everything working , but i have n't worked on it in a week or two ( ? ) , came back , updated dependencies , and all hell broke loose . i 'm getting weird errors everywhere that seem to suggest that babylonjs is n't able to find deeper dependencies within the classes i 'm using . i had some minor trouble with this before , but figured out how to work around it . now it 's back , and far worse . even creating a universal camera throws an error about gamepads ( which are not an input device on my machine ) . i believe the break point happened soon around/with the addition of the vue vite plugin , since that 's one line of code i had to change ( adding the vue plugin for vite ) to make things start up again after the dependency updates . any help would be appreciated ! i love vue , vite , and babylonjs , so i definitely want to figure out how to make them play nice together . babylonjs 's es build is , from what i gather , a bit `` weird , '' which is likely contributing to this issue . here 's their documentation , i have n't found anything magical in there yet to resolve the problem ( or searching for similar issues in the forum ) : < url > < code >
i need to mark some import as an external resource and convert them into a global variable . like this : yes , i 'm using meteor-client-bundler < code > // in webpack configuration ... module.exports = { // externals : function ( context , request , callback ) { var match = request.match ( /^meteor\/ ( .+ ) < cur > / ) ; var pack = match & & match [ 1 ] ; if ( pack ) { callback ( null , 'package [ `` ' + pack + ' '' ] ' ) ; } } // } ;
i have a vue3 project with vite and vue-router , need to deploy to multiple servers with different base path , so , when calling the router 's createwebhistory , i do n't want to use a hard coded paths , but current setup build pipeline is calling vite with different command line -- base so , is there anyway to get vite command line 's base option , and pass to createwebhistory ? and is there anyway to optimize this workflow ? to merge into a single same copy of distdir to copy to different servers ' different base path and be self aware the base path where it is served ? < url > thanks , < code > createrouter ( { history : createwebhistory ( '/base-directory/ ' ) , routes : ... } < cur > vite build -- base '/server1-base/path/to/a/b/c ' -- outdir ./server1-distdir < cur > vite build -- base '/server2-base/path/to/b/c/d ' -- outdir ./server2-distdir < cur > ...
i 'm trying to work with [ ssr example ] ( < url > ) , i made some changes to works just with vue , and it throws and error , but it works . have a repo to reproduce the error vite version : 2.0.0-beta.36 < code > [ vite ] error when evaluating ssr module /src/app.vue : typeerror : can not read property 'accept ' of undefined
i want to have a global variable accessible in my app but a different one for dev and build mode . i tried to use define for setting the dev one in vite.config and rollup output intro for the build mode in the rollupoptions . what am i doing wrong ? is there a way to do this , without defining environment variables ? < code >
greetings , i have some idea for vlang documentation , i wan na create pull request for creating documentation for installing and and tutorial in indonesia , hope some people from indonesia more know about how to install or tutorial about basic v programming language , thankss ! 👋🏻 with filename docs_id.md for indonesia version < code >
if fn a ( ) ( int , int ) and fn b ( int , int ) i should be able to do b ( a ( ) ) . currently i get error : expected 2 arguments , but got 1 this seems to conflict with doing q : = a ( ) which gives error error : assignment mismatch : 1 variable ( s ) but ' a ( ) ' returns 2 value ( s ) . if v knows 2 values are returned , i should be able to pass them as arguments < code >
nice to have an anonymous struct that can be disposable in a function . it is a struct that is never used outside of that function . for now , i am dealing with multidimensional arrays of strings whenever possible . it would be useful if it could be used in arrays with the type as it is without conversion to string < code >
hi , i am very excited about the v project and i believe it could be a very good substitute for the fast-decaying but still very powerful root framework . this is the main platform particle physicist in cern and farmi-lab and other institutes around the world use for their computations . the problem with root is that its have to be very fast , therefore it is written as a c++ library , with a clang-based interpreter . there is also a python library but the root-python interface is very slow and prone to errors . in any case , if v will pick up the challenge it will get massive support from a relatively small ( ~10k people ) but very organized and experience community of users and developers . good luck ! < code >
currently , < cur > embed_file will load the file at runtime if compiling without -prod , but with -prod , it really embeds the file . however , when cross-compiling , the file really needs to be embedded even without -prod , since file paths rarely match across systems . it should be relatively simple to fix - for someone who can find the right flags . line 804 in cgen.v has that could be changed to something like for now , the only `` workaround '' is to always compile with -prod when cross-compiling , but that is suboptimal for the development cycle . < code > if g.embed_file_is_prod_mode ( ) || target ! = current_target || os ! = current_os { if g.embed_file_is_prod_mode ( ) {
it seems like it 's being continually updated , but not enough to make it to 0.0.5. out of curiosity , what is the criteria for it to reach that point ( 0.0.5 ) ? < code >
after 0.3 , we 'll be going for 1.0 right away , freezing the syntax , similar to what go did . so if something has to be changed , now is the time to do it . please post your criticisms of v , there 's a good chance that things you do n't like will be fixed/improved . < code >
hi everyone i was writing a push procedure for a priority queue . here is the code : < url > or > > the code here < < ( the code is short ... the comments no ! ! ! ) differently of a function , the return is its own priority queue . for instance , adding a value 13 with priority 44 i created this procedure : push_pq ( mut a_queue , 13 , 44 ) to modify the `` a_queue '' inside of this procedure , in the end , i am using something like to return its value as : ........................ prior_queue = temp.clone ( ) //line 42 in the code above ... in temp has the result } am i doing it the right way ? or should be used a `` & '' to reference the variable address ? thanks for the opinion claudio < code >
what about maps supporting all comparable types of keys ? golang already do that . ref : < url > it seems to have already been `` planned '' , see `` for now '' in the error message bellow : < code >
v currently only supports a few primitive types as keys in maps . it would be useful if structs , arrays , ... could also be keys . < code >
related issues # 12554 - v : array init expression issues ( major ) # 14262 - cgen : specific array initialization since # 12181 - v : add variable it as index accessor in array init expression overview after we added it variable as index accessor in array init expression , it went out original implementation has lots of flaws , the major problem is that it would expand array init expression into multiple statements , which will causes serveral problems on cgen , e.g . or block generation ( # 14262 ) , if-else generation for array init with it variable ( # 12554 ) . possible workarounds more generation fixes on both c and js backend , which is fixing itself without changing anything but cgen . limit its accetable expressions extra explaination for workaround no.2 what we do here is to limit possible generation fault before we actually solved the problem itself , this would be a temporary workaround . for single-dimensional array init , forbids or block , and accept type fn ( usize ) t additionaly for a more general workaround , in this case , t is array 's element type for nested multi-dimensional array init : accept type fn ( usize ) [ ] t only , in this case , t is multi-dimensional array 's element type < code >
hello , i try to define with a simple regex operation if some inputs numbers have a valid format . ( integer/decimal ) . the specificity of my test should use `` period '' character and not `` comma '' for the decimal part . i work with this regular expression and the matches_string ( string ) bool function ( native regex module function ) : ( [ 0-9 ] + [ . ] { 1 } [ 0-9 ] + ) | ( [ 0-9 ] + [ ^ . ] ) however , i have problems in some situations like : 2000 is invalid ( first problem ) , 15.50 is valid ( ok here ) , .1500 is invalid ( ok here ) , 2000. is invalid ( ok here ) , 20 .. 00 is invalid ( ok here ) , 20.3.50 is valid ( second problem here ) , 20.0.0. is valid ( third problem here ) , 200da0 or 20 36 is valid ( fourth problem here ) . etc ..... i went through the documentation : v regex module , and use some stuff like print of the regex execution code , but i admit to being in trouble with my test . in javascript , with this regex : ^ [ 0-9 ] +\. ? [ 0-9 ] + < cur > /gm i get better results : test javascrip url if someone have an idea and can explain at how resolve this issue with v regex . thanks in advance ! < code >
hi there ! i 've recently started to learn v and i must say it 's an amazing language , lots of excellent ideas which makes it very nice to use . i have however one big problem with the ways structs are defined . v makes a lot of assessments about how it promotes safety in the language ( which is indeed true ) . but when it comes to struct , it really bothers me that all fields are optional by default . it 's very easy to make a mistake and forget to specify a field , which will then be set to it 's default value . this is for me a very big problem as even languages which are not geared as much towards safety such as typescript handle this perfectly . now i understand it would n't be possible to make such a change to the language independently of the fact it 's relevant or not , as it would be break many existing scripts . but would it be possible to have something like a flag or an attribute at the top of the file to indicate the compiler to consider all fields as required by default ? this would be incredibly helpful to avoid such errors . what do you think ? < code >
the v root directory has a folder named `` cmd '' which causes grief in windows when opening a shell prompt by typing `` cmd '' into the windows explorer navigation bar , as windows instead opens the folder cmd rather than launching cmd.exe . the only way to circumvent this is to open a different folder in the v root directory , type cmd in the navigation bar , and when the shell prompt launches cd .. back to the v root directory . < code >
hi everyone i am using the visual code under linux to edit v. although i had installed the package for v unfortunately , the codes are not automatically indented . the formatting is done almost all manually is there any shortcut to do it ? the language is recognized very well . thanks once ccs ps : i could not any thread on this < code >
hi everyone i have a map such with type `` map [ string ] [ ] string '' , which supports somehting such : x : = { ' a ' : [ 'brazil ' , 'canada ' , 'denmark ' ] ' b ' : [ 'france ' , 'canada ' ] } how to delete a 'canada ' from both keys in this map ? the final expected result should be : x : = { ' a ' : [ 'brazil ' , 'denmark ' ] ' b ' : [ 'france ' ] } i tried to apply the filter but it does not support string types . any guess ? any method and/or function to deal with maps with a set of strings ? here x.delete ( ' a ' ) ... will delete the whole line or the key thanks claudio < code >
hello everyone , i have created a repl.it template for vlang called vepl.it ! i know this will help me because our school chromebooks wo n't allow me to download vlang on it . there are 2 problems ( that i know of ) : there is n't any syntax highlighting there is no intellisense the template link is here ! thank you for reading ! 😃 < code >
it would be nice to restrict line lengths generated by v fmt to make it easier to include listings in technical documentation and when targeting printed book width limitations . perhaps -m max or -s size ? < code >
this might sound a bit naive , but as i have found out , # include only declares c # define 's , not functions , which is why sqlite functions are declared manually in this example . if you comment out # include `` sqlite3.h '' , the only error you 'd get is undefined c.sqlite_ok . c interop is extremely important for any new language , given the sheer amount of c libraries out there . so i think making it as easy as possible should be a priority . are there any plans on making # include generate function ( and type ) declarations ? or maybe creating a tool to generate v declaration from c headers , although this approach does n't seem ideal to me ? < code >
what did you do ? what did you expect to see ? only a warning about the unused variable `` var '' what did you see instead ? < code > ok.v:15:9 : error : can not assign to 'var ' : expected 'aa ' , not 'bb ' 13 | 14 | // does n't work 15 | var = match true { | ~~~~~~~~~~~~ 16 | true { bb { } } 17 | false { bb { } } struct aa { } struct bb { } type sumtype = aa | bb fn main ( ) { mut var : = sumtype ( aa { } ) if mut var is aa { // works var = bb { } // does n't work var = match true { true { bb { } } false { bb { } } } } } os : macos , macos , 12.3 , 21e230 processor : 8 cpus , 64bit , little endian , apple m1 cc version : apple clang version 13.0.0 ( clang-1300.0.29.30 ) getwd : /users/hunam/documents/dev/go2v vmodules : /users/hunam/.vmodules vroot : /applications/v vexe : /applications/v/v vexe mtime : 2022-03-19 12:45:57 is vroot writable : true is vmodules writable : true v full version : v 0.2.4 f7feb63.0cc6310 git version : git version 2.32.0 ( apple git-132 ) git vroot status : weekly.2022.11-28-g0cc63107 .git/config present : true thirdparty/tcc status : thirdparty-unknown-unknown de82a130
currently asm and sql are handled at the langage level , which means that adding a language to be used like sql is not possible . the same behaviour could be possible with a function definition like this : this way the sql keyword becomes syntactic sugar for allowing the creation of arbitrary dsl would allow for user extensions which would be quite helpful , such as or weirder use-cases < code > sql ( db , `` insert new_customer into customer '' ) fn sql ( db database , query string ) { db.cursor.execute ( query ) } data : = json { `` foo '' : `` bar , `` baz '' : 2 } sql db { insert new_customer into customer } small_squares : = python { [ x for i in range ( 10 ) if x : = i * * 2 < 50 ] }
hi everyone i am a newbie in v , so it is my third code in v , and already taking some difficulties with maps . since to pass it as an argument either to return it . i want to obtain a map from : print ( ' my map : < cur > { creating_a_map ( 10 ) } ' ) ( line 28 ) , where the code is in : < url > but a silly and strange error came : < cur > v run maps_study.v maps_study.v:27:4 : error : function declarations in script mode should be before all script statements ...... it does not make sense for me yet in addition , whose types are supported as the keys in v for maps ? only strings ? byte ? runes ? sorry , i did not scrap for similar questions in this discussion .... thanks in advance for any help . claudio < code >
i am new to the v programming language , and i read on the homepage of v , section `` innovative memory management '' : most objects ( ~90-100 % ) are freed by v 's autofree engine : the compiler inserts necessary free calls automatically during compilation . remaining small percentage of objects is freed via gc . i got some questions concering that : when exactly ca n't the compiler add free calls , and must use gc ? is there any specification for it , yet , or will it be added , when autofree becomes the default ( v0.3 ) ? if the compiler ca n't add free calls and must use gc , it would be helpful to know , in which cases or source code positions the compiler was not able to add free calls but needed to use a gc . is it possible , that the compiler outputs information , warning or error messages in such cases ? maybe it would allow to edit the source code in a way , that the compiler does not need to use a gc after the change . my target is to write 100 % gc free code , and i would be happy , if the compiler assists it . maybe the compiler output for gc usage can also be put into the v language service , and be used in the vscode v programming language extension to visualize problems with autofree in vscode . how much space does the gc take in the final executable ? < code >
i 'm semi new to opengl and sokol in general . i want to find a way to write in glsl and execute it on the gpu , hopefully in a parallelised way . without creating vertex buffers or messing with windows , just a simple set of code with an input and an output ran on the gpu . thank you . < code >
hello ! i 'm new to vlang and love it . i wondered how to replicate the following `` parameters in the body '' functionality for a custom struct ? example : how to make this code executable for struct something { } ? so i can call it like i have spent 24 hours reading the documentation and ca n't figure it out . my candidates are : if i pass a string , it 's converted into the first struct parameter something with interfaces ( still paying around ) , reviewed orm.v and the @ select , create seems promising something with the [ params ] , still playing around can you please push me to the right direction ? ? ? < code > sql db { create table foo } // maybe some params here [ ? ? ] struct something { // maybe some code here ? ? } // maybe some fn that enriches the struct here ? ? ? something { create table foo }
in looking at static variables , i 'm wondering if their usefulness is being underestimated , particularly in a non class-based oop language that emphasizes the use of functions . perhaps static variables should not be designated as `` unsafe '' , and be allowed to play a more important role in v. additionally , static variables should not be confused with global variables ( particularly in the conceptual sense and usage ) . since v does n't allow global variables by default , this creates a problem . there can be a need to preserve values , which changes ( is mutable ) based on being acted upon . what static variables allow , is reducing the scope of such interactions to a particular function . this becomes more important in a language like v , where it does n't uses class-based oop nor global variables ( normally ) . another area where this issue shows itself is with guis . if you have a function that contains a gui ( it is better to isolate the ui from business logic ) , often you will need ui related variables that maintain track of state between function calls . it is arguably much more convenient to use static variables to do this , than workarounds . what say you all ? < code >
hi everyone , i was testing some functions on arrays from : < url > under v interpreter ( v 0.2.4 996bd41 ) , and under these snippets , it does not works : : where is my mistake ? is there any place reporting what is working and what does not work yet ? thanks indeed claudio < code > > > > import arrays > > > mut a : = [ ' 0 ' , ' 1 ' , ' 2 ' , ' 3 ' , ' 4 ' , ' 5 ' ] > > > a.delete ( 4 ) -- -- > remove the 5th . element > > > print ( a ) [ ' 0 ' , ' 1 ' , ' 2 ' , ' 3 ' , ' 4 ' , ' 5 ' ] > > > a.delete_many ( 4,1 ) -- -- > remove the 5th . element ... and it > > > print ( a ) [ ' 0 ' , ' 1 ' , ' 2 ' , ' 3 ' , ' 4 ' , ' 5 ' ]
please comment with or ask questions about your experience or trouble installing v on apple 's macos operating system . important : 32-bit / ia-32 / x86 usage is not officially supported and would only be available up to mojave ( macos 10.14 ) . `` hackintosh '' systems are also not officially supported . < code >
due to v silently auto-converting decimal real number notation ( e.g . 123.456 ) to ieee 754 binary floating point representation ( which is not suitable for decimal numbers ) , it 's not clear , that this conversion is in most cases lossy which leads to serious errors ( so profound that for example it 's one of the most frequent techniques in plausible deniability competitions ) . v should warn in compile time if the decimal number is not losslessly convertible to the underlying ieee 754 floating point representation . the warning can be suppressed by explicitly casting the literal number to f64 or f32 ( e.g . f64 ( 123.456 ) ) . note , no warning is necessary for hexadecimal notation . another alternative would be to treat decimal real number notation as what the user intended and thus convert them losslessly to ieee 754 decimal floating point ( all platforms v supports support it ) . this 'd probably require addition of d128 d64 d32 floating point formats to the language which was already proposed some time ago by some but got burried in other issues . thinking about it , this second option sounds actually cleaner to me than the warning . < code >
as shown in this bug report ( # 13572 ) it is not possible to pass the capacity of an array to a slice . however this seems not to be a bug in v. go has this functionality , so that also an empty array can be specified with the outermost bound with the capacity . just like this : for example : copy holds the capacity of the array ( it copies a slice into that array ) . if using out = out [ 0 .. ] .clone ( ) or simply out = out [ 0 .. ] the capacity is 0 as below ( it replaces the array with a slice of it ) . < code > // v code fn main ( ) { mut out : = [ ] byte { len : 0 , cap : 512 } out = out [ .. out.cap ] // error < - out of bounds println ( out.cap ) } // go code func main ( ) { out : = make ( [ ] byte , 0 , 512 ) out = out [ : cap ( out ) ] // works fmt.println ( cap ( out ) ) } fn main ( ) { mut out : = [ ] byte { cap : 512 , init : 0 } println ( out.cap ) //512 copy ( out , out [ 0 .. ] ) println ( out.cap ) //512 out = out [ 0 .. ] println ( out.cap ) // < = 0 }
currently the web server seems to assume a file will be uploaded as a whole . but that 's not necessarily the case and actually for performance reasons ( both significantly lower memory usage as well as starvation avoidance thus much higher efficiency of resources utilization ) and to allow writing a `` pause & resume '' uploader supporting multihoming a chunked/streamed file uploads would be necessary . some good inspiration might be tus ( used by e.g . vimeo ) or < url > . @ mcastorina and others what do you think ? < code >
... so you can tell how many bytes it takes , since there 's no easy way to iterate over a string with runes , or slice the string to remove a single rune , or ... < code >
issue # 13791 shows that assigning an immutable slice to a mutable variable should be disallowed : that is probably straightforward to implement . but what about when the immutable slice is the result of a function call : i think we need to allow marking the return type as mut . this could maybe be done with vfix . then any mutation of a function result which does n't have that mut should be made an error . this will also need tracking of every expression as mut or not : < code > arr : = [ 1 , 2 , 3 , 4 , 5 ] mut s : = arr [ 1 .. 2 ] // should error s [ 0 ] = 0 fn id ( arr [ ] int ) [ ] int { return arr [ 1 .. 2 ] } arr : = [ 1 , 2 , 3 , 4 , 5 ] mut s : = id ( arr ) // should error s [ 0 ] = 0 fn id ( arr [ ] int ) [ ] int { return arr [ 1 .. 2 ] } arr : = [ 1 , 2 , 3 , 4 , 5 ] id ( arr ) [ 0 ] = 0 // should error
i 'm new to v and pretty new to programming in general . i was playing around today , did the `` v up '' and created a new project . i decided to try making a http request , pretty simple , grab the date/time from `` < url > format it and print to console . when i ran the program windows decided to block `` v.exe '' , declaring it `` trojan : win32/bearfoos.b ! ml '' . i 'm guessing that this has nothing to do with v itself but windows being windows . do i need to pay any attention to this or can i safely just restore the executable ? update : i reinstalled v , tried to recreate what happened with no success . i might have missed the `` make.bat '' last time , honestly ca n't remember . i 'll provide a screenshot anyway . < code >
hey guys , i 'm trying to use zig which is clang compatibile c compiler with multiple libc and ability to compile for other operating systems . i made an appimage that points to zig cc and did a symlink named clang to /usr/bin but i get error : this is a compiler bug , please report it using v bug file.v . < url > you can also use # help on discord : < url > i even renamed clang to zig and it 's still the same . i know that zig is not officially supported , but is there any way to make it work ? anyone tried zig cc with vlang before ? thank you < code > [ seba @ sebapc v ] < cur > ./v -cc clang ./structtest.v ================== unable to hash /home/seba/obrazy/v/ '' /tmp/v_1000/structtest.13441100194319091039.tmp.c '' : file not found ... ================== ( use ' v -cg ' to print the entire error message ) builder error : ================== c error . this should never happen .
please comment with or ask questions about your experience or trouble installing v on the tiny core linux . official website : < url > port usage necessary for x64 / arm * : < url > < code >
please comment with or ask questions about your experience or trouble installing v on the raspberry pi os ( formerly known as raspbian ) linux distribution for the raspberry pi . official website : < url > < code >
would like to see an option with os.execute that completely hides the console and prevents any kind of blinking or pop-up . sometimes , for various reasons , the command prompt console will show for a fraction of a second ( blink ) . i know that this is possible , as have seen it in other languages , where they have a cross-platform process or runcommand that has a `` noconsole '' option . would be great if v has this too . < code > import os fn main ( ) { println ( os.execute ( r'cmd /c ipconfig /all ' ) .noconsole ( ) ) // maybe something like this or whatever is best }
mut can already be used to indicate that it will modify the object , just like in function arguments , with the difference that it is not required . example : the question now becomes whether mut can be used too to immutable methods like : mutation methods ruby and julia use ! in end of mutation methods , in v could be adopted the pattern of use either : _ _mutation _mutable _mut _mt in end of a mutation method example , either : sort_ ( ) sort_mutation ( ) sort_mutable ( ) sort_mut ( ) sort_mt ( ) non-mutation methods or as opposite , to use a pattern to naming non-mutation methods using either : _ _clone _cln example , either : sort_ ( ) sort_clone ( ) sort_cln ( ) < code > mut a : = [ 1 2 4 ] ( mut a ) .insert ( 2 , 3 ) // or a.insert ( 2 , 3 ) a : = [ 1 2 4 ] f : = a.first ( ) // or f : = ( mut a ) .first ( ) // too works
i 'm trying to built the calculator example from the ui library and for a production build , it takes about 19 seconds on my machine . this is 80 % slower than ved and the source code of the example is 16 times less so i 'm pretty sure that v always builds `` ui '' too . but why is this happening ? it does n't make much sense as the library will never change from me . how can i have the library to not automatically be build every time ? < code >
i was just wondering what 's the general plan with `` native '' . when outputting c , we can use `` tcc '' to get crazy fast compilation times and `` gcc '' / '' clang '' to get great runtime performance . so what 's the idea of having `` native '' ? what purpose it curves ? do you plan to make it something in between or do you plan make the performance of `` gcc '' / '' clang '' but make it as fast as possible ( which make sense as they 'll be no intermediate code and assembly ) . if compile times is important , i would also suggest a mode ( compiler switch ) where the compiler will parse every file and create the executable at once rather than creating objects files and then link them . this will be great for production builds when the end users want to compile software from source and do n't want to keep the object files . if you ask me , native is the way to go ! thanks for your work regardless ! < code >
i was wondering if vlib builds on top of libc and uses functions from libc or if it is a stand-alone library that implements the system calls and the algorithms from scratch . any ideas ? < code >
format v document code is too difficult , it seems that the code blank in the v document with tab , but i vim will always automatically tab to space , which will lead to cmd/tools/vcheck-md.v error i think this step can be completely automated , the program format markdown and then save , or even add to ci , do not let people to repeat this uninteresting work . i tried to write a vsh script , but it was blocked at this step and i could n't get execute to receive stdin pipe input . i see that the current implementation of v check-md is to extract the v code in the document to a temporary file save to disk , and then call v fmt i do n't think it 's necessary to write file to disk at all , it 's inelegant v fmt is available cat test.v|v fmt . however , there is no pipe_execute ( cmd , string ) function . can someone please add a function like this ? i 've read the code and it does n't clear how it should be implemented . also , does the v language now have a concept like stream in nodejs ? for example , if i want to count the number of lines based on pipe for a 200gb file , i think pipe_iter_execute ( cmd , [ ] byte iterable ) is more appropriate . < code >
wrapping operations for integers these operations have guaranteed wraparound semantics . failing when the result cause overflow +~ ( wraparound addition ) -~ ( wraparound subtraction ) * ~ ( wraparound negation ) /~ ( wraparound multiplication ) example : < code > u8 ( 129 ) +~ u8 ( 129 ) // error
how much effort has been dedicated , and how much effort would it take , to have proper v wrappers around all the major c libraries , so that a v user can pretend they 're in v world for all major tasks ? i think this , together with improving autofree would increase adoption dramatically . < code >
does anybody have any examples or experience with using gdiplus with v ? know there are several substitutes , but would like to specifically see gdiplus usage . < code >
that last 10 % which needs garbage collection right now , how hard would it be to improve autofree to cover those cases ? see also : # 12343 < code >
every time i download from the release page , it is the files v_linux.zip , v_macos.zip , v_windows.zip , and then i have to open it every time to know what version it is . if possible , please include the file version number or release timestamp when publishing , thank you . for example : v_linux_0.2.2.zip , v_macos_0.2.2.zip , v_windows_0.2.2.zip v_linux_weekly.2022.07.zip , v_macos_weekly.2022.07.zip , v_windows_weekly.2022.07.zip < code >
i try but do n't work error as below < code > mw.v:24:11 : error : for in : can not index 'iterable < string > ' 22 | 23 | fn test ( iter iterable < string > ) { 24 | for i in iter { | ~~~~ 25 | println ( i ) 26 | } rmw.v:25:3 : error : 'println ' can not print void expressions 23 | fn test ( iter iterable < string > ) { 24 | for i in iter { 25 | println ( i ) | ~~~~~~~~~~ 26 | } 27 | } struct squareiterator { arr [ ] int mut : idx int } fn ( mut iter squareiterator ) next ( ) ? string { if iter.idx > = iter.arr.len { return error ( `` ) } defer { iter.idx++ } return ( iter.arr [ iter.idx ] * iter.arr [ iter.idx ] ) .str ( ) } interface iterable < e > { mut : idx int next ( ) ? e } fn test ( iter iterable < string > ) { for i in iter { println ( i ) } } nums : = [ 1 , 2 , 3 , 4 , 5 ] iter : = squareiterator { arr : nums } test ( iterable ( iter ) )
i just started building a compiler for a custom dialect of lambda-prolog in vlang . when trying to build an identifier parser , i tried mapping each character to whether it could at the beginning of an identifier , if it could be in the tail , and if it would terminate the identifier like this : note : the program variable is a string . when i try to compile this i get : error : unknown method or field : string.map . if strings are just read-only array , why ca n't i use array methods on strings ? it makes sense imo . < code > identifier_map : = program [ 0 .. 19 ] .map ( match it { ' a ' ... ' z ' { i8 ( 0 ) } ' a ' ... ' z ' { i8 ( 0 ) } `` ... ' y ' { i8 ( 0 ) } ' a ' ... ' o ' { i8 ( 0 ) } `` ... ' o ' { i8 ( 0 ) } `` ... ' y ' { i8 ( 0 ) } ' _ ' { i8 ( 0 ) } 's ' { i8 ( 0 ) } `` { i8 ( 0 ) } `` { i8 ( 0 ) } `` { i8 ( 1 ) } `` { i8 ( 1 ) } ' 0 ' ... ' 9 ' { i8 ( 1 ) } '~ ' ... '™️ ' { i8 ( 1 ) } `` ... '©️ ' { i8 ( 1 ) } ' '' ' ... '' ' { i8 ( 1 ) } `` ... '' { i8 ( 1 ) } else { i8 ( 2 ) } } )
in examples > vweb there 're html templates but there 's no layout . a layout - is an html skelleton that all other html templates are inhereted from , and thus share . let 's say , a layout can contain a top nav bar , left menu and footer . not functions-helpers that would render those shared elements , but a layout itself . does vweb support layouts ? and how to work with them ? < code >
the compile speeds on v are really impressive . can someone describe the approach that makes is so quick ? is it because it targets c ? < code >
i think that the new languages has a leak in the implementation of the std , that is the possibility to have complex data structure implemented directly in the language . this can help to feel a lack that is in all the language . i built some things in < url > for my purpose , and i 'm thinking that maybe we can build some of these data structures there ? < code >
there has been plenty of discussion on discord about the v documentation , with some ideas mentioned , but no real effort put into making general improvements . some ideas that have been mentioned : lower-level `` intro to v '' . tutorials . more details in existing sections . links to the command line help , or at least better descriptions of how to find that help . so - what are your ideas for improving the v documentation ? < code >
it feels wrong that we have the integer type sequece as i8 , i16 , int , i64 and even worse if we consider u8 , u16 , u32 , u64 . i propose we have i32 the concrete type so we keep the naming consistent and have int as an alias to i32 . < code >
< url > the interface 's mut : should be deprecated . if a struct on the implementation side has mut , it should be treated as mutable , if not , it should be treated as immutable , that 's enough . there are some structs that require mut and others that do not , for the same method , but if mut is specified in the interface , the implementor will be forced to add mut even in situations where immutable is appropriate . this is grammatically nonsense specification , will lead to more nonsense code like < code > fn ( f foo ) foo ( ) { mut fm : = f mf.do_mutable_func ( ) }
i can do : but not that is , the r '' .. '' approach to create raw strings is not supported in map initialisation . this leads to a compiler error . < code > data : = { r ' '' '' ' : [ byte ( 0 ) ] r ' '' '' ' : [ byte ( 0x01 ) ] r ' '' ☃️ '' ' : [ byte ( 0xe2 ) , 0x98 , 0x83 ] r ' '' ☃️ '' ' : [ byte ( 0xe2 ) , 0x98 , 0x83 ] } data : = { ' '' \x00 '' ' : [ byte ( 0 ) ] ' '' \x01 '' ' : [ byte ( 0x01 ) ] ' '' \u2603 '' ' : [ byte ( 0xe2 ) , 0x98 , 0x83 ] ' '' \xe2\x98\x83 '' ' : [ byte ( 0xe2 ) , 0x98 , 0x83 ] }
edit : after playing with it some more , static variables do work . have to put `` unsafe '' in many places . < code > fn main ( ) { mut stuff : = '' stuff = 'where is it at ? ' stuff += 'no where to be found . ' unsafe { println ( loglines ( stuff ) ) } unsafe { println ( loglines ( meetoo ( ) ) ) } unsafe { println ( loglines ( stuff ) ) } } [ unsafe ] fn loglines ( text string ) int { mut static logged_line : = 0 logged_line = logged_line + text.count ( ' ' ) return logged_line } fn meetoo ( ) string { mut strings : = '' strings = 'yeah , but , what about this ? ' strings += 'did that on sunday . ' return strings }
for example , let 's say you want to publish my_module which has many submodules . some methods in the submodules need to be public in order to be used among submodules . however , some of those public methods are better to be kept private from outside my_module , in other words make it internal only public . would be nice to have such a mechanism . proposal : for example , not a very good way though , adding an attribute such as [ internal_pub ] to prohibit access from outside the v.mod . < code >
allow v doc < module > . < component > to display the component declaration / definition and any comment above it . compare with , for example go doc os.readdir . the can a dot separated list . currently v doc os file for examples file struct type and its methods . this can continue work but v doc os.file should also work . < code >
one major frustration for adopting v is that its regex standard library is not compatible with go 's , making porting more difficult than it should be . my proposal is to port go 's regexp standard library unit tests to v and then update v 's implementation of regex to pass all unit tests . thoughts ? < code >
importing the 'ui ' or 'gx ' modules seems to completely disable terminal output . is this a bug or do i need to explicitly interface with the terminal in some other way when creating a graphical application ? in either case , there seems to be non-obvious change to behavior ( contradicting the simplicity mantra ) . perhaps i am missing something right in front of me ? run from cmd and powershell on win10 . < code > import ui fn main ( ) { println ( `` how does one print this text ? '' ) }
repl.it is a fantastic site for making quick apps or even big projects online . currently there is a small template for running v code , but there 's no official language support as of now . i 'd personally like to use v alongside my other small projects on replit ; it would get me to use the language more since as of now i have no easy way of compiling and running v code . anyone else think this is a good idea ? < code >
the documentation shows dealing with structs created in v , but it 's not clear in the documentation on how to properly interop with external c structs from a library , and inside of v functions . edit : appears to have been an odd update issue , as after update things work as expected . the below way ( pseudo code ) would work . < code > struct c.cstruct { stuff u32 things u32 } fn main ( ) { var1 : = & c.cstruct { } var2 : = & c.cstruct { } }
the below code should compile because it is type-safe ( although , for the sake of efficiency , not purely functional ) , but the compiler disregards the type-checking within the block and errors . i 'd appreciate if this could be solved so i would n't have to do match { nil { } linkedlist { < body > } } every time i want my function to interact with its data . main.txt < code >
although vlib is currently very rudimentary and lacks documentation . however , it has been gradually improved and standardized , and recently found that many modules have added readme and examples , which is too important for newcomers , thanks to the contributors . < code >
csv data can be download from finance.yahoo.com < url > how can the raw data return be formatted to its csv format ? example date open high low close * adj close * * volume jan 06 , 2022 3,269.01 3,296.00 3,238.92 3,265.08 3,265.08 2,353,943 jan 05 , 2022 3,337.66 3,342.53 3,287.14 3,287.14 3,287.14 3,215,100 jan 04 , 2022 3,408.76 3,428.00 3,326.99 3,350.44 3,350.44 3,536,300 < code >
printing a [ ] byte will attempt to decode each individual byte to its ascii representation while printing a byte will just output the decimal value of the byte interpreted as an unsigned int . there should be consistency between the two . printing [ ] byte should always output decimal values . < code > println ( 'hello'.bytes ( ) ) // will print [ h , e , l , l , o ] println ( 'hello'.bytes ( ) [ 0 ] ) // will print 104
i just started learning the v and thevlib libraries , and saw that a lot of things were missing . i saw that there is only html parser , but there is no xml parser . i would take on this task in order to study the language if someone considers it necessary . < code >
is 'sql ' a reserved keyword and 'sql db ' a statement used by the compiler ? i did n't find the keyword in appendix i : keywords but found sqlstmtin ast.v . so is orm included in the language ? < code > customer : = sql db { select from customer where id == 1 limit 1 }
the bar with embedded foo can be used as getter interface in go . but not in v. same functionality is desirable . but interestingly , if getter interface has only fields , then it can be used as a getter interface . methods are forgotten ; - ) this works in go but this does not in v. < code > package main import `` fmt '' type foo struct { x int } func ( f foo ) get ( ) int { return f.x } type bar struct { foo } type getter interface { get ( ) int } func main ( ) { var getter [ 2 ] getter getter [ 0 ] = foo { } getter [ 1 ] = bar { } fmt.println ( getter ) } struct foo { x int } fn ( f foo ) get ( ) int { return f.x } struct bar { foo } interface getter { get ( ) int } fn main ( ) { mut getter : = [ ] getter { } getter < < foo { } getter < < bar { } // error : 'bar ' does n't implement method 'get ' of interface 'getter ' println ( getter ) }
how do you feel about the yield keyword and the iterators that it generates ? or do you feel the defer syntax gets you close enough to not warrant the additional complexity in the compiler ? if there answer was no thanks , is there any way to extend v without having to have access to the compile code ? ( macro etc ) having written hundreds of iterators in languages with and without yield syntax , i have to admit a strong preference in readability and maintainability in languages that support them . if there was any interest , i 'd be happy to try my hand at a pull request / fork etc . < code >
yall are developing all this sophisticated tooling to make gc obsolete freeing memory when it should be freed . do you think the go language , as it is without modification , could be compiled in this same way ? < code >
the use of int as array length forbids allocation of arrays with more than < phone > elements . that , in particular , could make a problem for some engineering/scientific applications e.g . in case of processing of 1d signals with very high sampling rate . and , in general , it does not allow the developer to fully exploit the available memory resources . thus , the question is - why not using usize instead of int ? < code >
it would be useful to include the default value in the help message < code > flags : -verbose verbosely list files being processed * * ( defaults to false ) * * < - this should be included -help prints help information . commands : help prints help information . app.add_flag ( cli.flag { flag : .bool name : 'verbose ' default_value : [ 'false ' ] description : 'verbosely list files processed being processed ' } )
hello folks ! i just stumbled about the installation info in the docs.md for macos users while installing vlang on big sur . the hints for installing from source are pretty ok. but , i 'd like to suggest a tiny addition : most macos users , regardless whether they are developers or just interested in software development , will have brew ( homebrew ) installed on their machines . and vlang is available as homebrew formulae ( see here ) . using brew for the installation is pretty easy and fast . therefore it might be useful to add that installation method as a hint to the docs.md . thank you in advance for considering this and keep up your great work ! best regards ! < code >
v version : v 0.1.23 fc64238 os : macos 10.15.2 ( 19c57 ) what did you do ? attempting to access a c enum results in type undefined compiler errors . what did you expect to see ? i expected to be able to define and access the c enum what did you see instead ? missing type errors on compile < code > // c enum enum thing { first , second } // v declaration enum c.thing { first , second }
is support for writing low-level , hardware-accessing device driver type code planned for v where the use of a volatile keyword could be used to prevent optimization removal of multiple reads of a hardware register or a memory-mapped device ? or is v counting on this type of code to be written in pure c ? < code >
i 'm using win10 for my stuff and occassionally i want to run all test files in a specific folder , but without any subdirectory . on linux i can do v.exe test modules osie\ * _test.v because linux shell will replace the `` file '' with all the file names matching . win cli ( cmd ) is not doing it . it would be nice if v would expand the `` file '' , doing what the linux shell is doing otherwise . < code >
v version : v 0.2.2 e06e8b1 os : alpine linux ( stable ) in a docker what did you do ? run v commands by multiple users ( installation steps as root , project runs as another user ) what did you expect to see ? v works fine - for every user on the system . what did you see instead ? v uses the /tmp/v dir which is owned by root and thus not accessible by other users . most likely related : # 7838 ( 2nd issue ) , # 7713 , # 4649 please use a random named directory ( as many apps do ) or at least check for permissions first . < code >
i really like v , but one thing really stands out to me , and that 's the lack of standards for code documentation . walking through the code of vlib , it 's a rarity to find a function , struct , or enum , etc . with any sort of comment documentation . this really takes me aback given that v wants to have a rigid format and standard to it 's approach and style - yet there 's no enforcement on merges to document your code - like it 's that hard to write a sentence about the function they 've created . i feel like if this is n't rectified soon it will continue to hurt the language , and as more is added to vlib undocumented the more of a mess it will become . < code >
from thread on discord : spytheman 11/06/2021 exactly at least to me , it is very confusing when a module name is used for a local variable or a parameter too jalonsolov 11/06/2021 my vote ? that should be invalid . would have to allow for import gg as g , then make any other use of g illegal . perl is crazy with that ... you can have % var , @ var , and < cur > var all in the same file ... and then < cur > var { key } , but that means the % var hash , not the < cur > var plain variable . i think once a name is defined as a type of thing , it should be invalid to use the same name for something else . it also goes along with the `` simple , safe '' ideas in v. hard to confuse what it is if it 's only ever one type of thing . alex m yesterday at 12:03 pm yeah it 'd be consistent with v not allowing shadowed variables < code >
hello , i 've just discovered the language and have read the docs . now i want to practice , so i 'm writing a little guessing game where you enter a number between 1 and 100. i need to convert the user 's input from a string to an int . reading the docs , i 've found < url > which does what i want . but ... not exactly . if i enter some random characters in my program , strconv.atoi will just convert it to 0 instead of rising an error where it says that the string ca n't be converted . i think this is incorrect behavior , the strconv methods should be optionals , or at least provide methods which implements this mechanisms and are optionals . tl ; dr expected behavior : if i do strconv.atoi ( `` blablah '' ) it should let us handle the error with an optional current behavior : it just returns 0 ... < code >
currently we can declare variable size multidim arrays like this : because arrays are frequently used we should have additional shorter syntax for declaring them ( alex m. agrees ) . the exact syntax is open for discussion . my proposal : basic use : [ ] [ ] [ ] int { len : [ 2,3,2 ] } advanced use [ ] [ ] [ ] int { len : [ 2,3,2 ] , init:1 , cap : [ 10,20,10 ] } < code > // 2d mut a : = [ ] [ ] int { len:2 , init : [ ] int { len:3 } } // 3d mut a : = [ ] [ ] [ ] int { len:2 , init : [ ] [ ] int { len:3 , init : [ ] int { len:2 } } } // ...
right now , to declare an individual rune , you must use `` around the actual character . it would be simpler in most cases to use something like or u+fb28 ( does n't matter ) instead of hunting down the `` pastable '' version of ... especially if your editor does n't support the full unicode range . < code >
v version : v 0.2.4 52df19e os : linux , ubuntu 18.04.6 lts ( wsl ) what did you do ? what did you expect to see ? all assert statements passing what did you see instead ? the left value very clearly is a string , and a is a valid map entry . but the value shown and applied by assert is * unknown value * , and the test fails . the workaround is to create a temp variable and compare this with the expected result . but it should not be necessary . i have to say this is not 100 % reproducable for me on different platforms and exact situations . < code > fn test_map ( ) ? { mut m : = map [ string ] string { } m [ `` a '' ] = r '' c : emp '' assert m [ `` a '' ] == r '' c : emp '' assert m [ `` a '' ] == os.join_path ( r '' c : '' , `` temp '' ) } > assert m [ ' a ' ] == rosie.parser.os.join_path ( ' c : \ ' , 'temp ' ) left value : * unknown value * right value : c : /temp
hi all , i really like v so far and think it has a bright future . however , some of my projects require a more object oriented approach . while structs can mimick classes in a way , it does n't offer protected zones and are awkward inheritance wise in my opinion . true class support would be a huge bonus . gracias . < code >
from aiguy in discord : v needs a grid with datatypes on the vertical and horizontal headings like a map and where the datatypes meet on the x and y it should have a link to the the function or cast with an example for converting datatype 1 to datatype 2 . < code >
the problem is that if a public function has a non-public type argument , v will not forbid it , but the user can not use this function because he can not initialize a non-public type we need to add check accessibility of types , fields , etc . it will be much harder to make it so it was impossible to use the library because of this error possible output error : < code > module somemod struct config { line string } pub fn read_config ( cfg config ) { println ( cfg ) } error : public function argument type 'config ' is private 13 | pub fn read_config ( cfg config ) { | ~~~~~~ type is private 14 | somemod.read_config ( cfg ) 15 | } import somemod fn main ( ) { cfg : = somemod.config { 'some ' } // ^^^^^^^^^^^^^^^^^^^^^^ leads to this error : // main.v:13:17 : error : type 'somemod.config ' is private // 11 | // 12 | fn main ( ) { // 13 | cfg : = somemod.config { 'some ' } // | ~~~~~~~~~~~~~~ // 14 | somemod.read_config ( cfg ) // 15 | } somemod.read_config ( cfg ) }
description : as v 's crypto module is based off of go 's package , i propose adding public key functionality to the package . suggested path is : create interfaces for public and private keys implement rsa using these ( similar to go ) on successful implementation , move on to ecc ( elliptic curve crypto ) beyond this , dsa and ecdsa can be implemented as a first step , only the basic implementation can be provided , without safety features like constant-time implementations < code >
since the contributing guide currently contains instructions for setting up the project for contribution using the web interface and the hub tool , which is no longer actively developed , i feel it would be useful to add a section with the same setup using the official github cli . < code >
v supports if optionals unwrapping as described here . i propse to provide something similar in for loops as well . reasoning : consider how many of the io.read ... ( ) methods are implemented and how they shall be used : with the proposed change , the following would be possible . imho more readable and also more obvious . as long as read_line ( ) is successful , the next line will be returned . upon an error , the for-loop will break . it would probably be useful to distinguish between true errors and `` reached the end '' . true errors may return from the function with that error ? ! ? i envision that this change greatly simplifies creating iterators , and that it is a true improvement to v-lang . currently a next ( ) ? function is needed . which btw also returns an optional . < code > for { line : = br.read_line ( ) or { break } // ... } for line : = br.read_line ( ) { ... }
hi ! i would like to know if there currently is a way to avoid boilerplate on standard rest crud interfaces by simply specifying models as structures . suppose i want to declare a api for posts like and i would like this call to generate code for the creation view like is this possible at the current time ? are there code creation facilities that could be used like this ? < code > struct post { id int title string body string } < cur > gen_create < app , post > ( ) [ `` /post '' ; post ] pub fun ( mut app app ) post_create ( ) vweb.result { // .... code here }
i tried initializing two variables in the for loop like this but i got an error . so i changed it to it worked but it is n't as clear as the first and requires more typing . this style can be useful but for for loop i think the first is better and familiar . i 'm not asking to remove the second style , just to allow the first . < code > for i : = 0 , j : = 100 ; i < j ; i += 1 , j -= 1 for i , j : = 0 , 100 ; i < j ; i , j = i + 1 , j - 1
now that custom error types have been implemented into the language ( see # 8924 and # 9043 ) , the next step is to actually use these in the standard library . for example : the e.g . return error ( 'file < cur > file not found ' ) calls inside the os module can be replaced with a new filenotfounderror type the generic error_with_code calls in vlib/net/errors.v should be replaced with a proper dedicated type for each error code etc. , etc . it might be a good idea to implement these in batches ( e.g . one pr could add proper errors to the net module , another could document part of os ... ) < code >
we can return a string with error ( `` ... '' ) and retrieve it with err . but using a string we can only describe the error and we can not do much else with that . it would be nice to be able to return some kind of enumeration of error codes which we could compare and react differently to different errors . could not the returned error be a kind of user extensible sum type ? for example have a look at `` zig '' language , it seems to me that they support something like that . anyway the error handling must remain as simple as possible . < code >
hi . i 'm new in v and compiled languages at all . i asked a question on stackoverflow , but no answers yet . so , maybe someone can help there . the question is how to convert strings like ' 2 345.5 ' to number with decimal . what i 'm doing is parsing json using json.decode ( ) and struct . standard convertion to float gives 0 : output is : < code > import json struct account { id int balance f32 [ json : availablecash ] } json_data : = ' { `` id '' : 26 , `` availablecash '' : `` 1 475.26 '' } ' account : = json.decode ( account , json_data ) or { panic ( 'failed to parse json ' ) } println ( account ) account { id : 26 balance : 0 }
i 'm reading the docs but still ca n't find info on what i 'm trying to do . i want to be able to spit files across the same directory . let 's consider the following structure . so i want to import the `` other_file.v '' in the `` main.v '' file . i 'm trying using things like import other_file or import main.other_file ( while have defined the module first with module main.other_file ) . any ideas ? < code > my_awesome_project | src | main.v | other_file.v | readme.md
i 'm using htmx to build a site . htmx needs the server to spit out html ( not json ) , so i 'd need to make extensive use of compile-time macro to fill in templates . but it seems that i ca n't . say for example that i have an if statement inside a request handler and i need to output two different pieces of html ( according to the condition ) . for now , i ca n't do it because v loads ( and compiles ) the html template with the same filename as the request handler function - if i understand it well - and of course it must be one . having only return < cur > vweb.html ( ) is pretty limiting . so , could it be possible to extend vweb to use some arbitrary template i specify , instead of automagically choosing one ? something like return < cur > template_file_name.fill ( ) allowing automagic filling ( as it is now ) or having return < cur > template_file_name.fill ( params ) for a more general , controllable approach . < code >
please add posit [ 1 ] and bfloat16 [ 2 ] . posits/unums are used in hpc computing and bfloat16 on neural networks training . might be of interest in the future . [ 1 ] < url > ) < url > [ 2 ] < url > ( extracted from # 3961 ) < code >
i think there are two benefits to altering as to return an error/option : one is that it removes a language construct that can hide error flow . as looks pretty harmless , and since it is missing the usual if/or/ ? error-handling constructs , it does n't jump out as a place your program might crash . functions which use as should have to handle the error , or explicitly or { panic ( ) } if a panic is truly desired . second is that it could help make code less verbose when you expect only a certain type . i 've notice this happens a lot with x.json2 . for example , instead of writing this : you could remove one layer of nested ifs : < code > fn get_method ( obj map [ string ] json2.any ) ? string { if m : = obj [ 'method ' ] { return m as string } else { return error ( 'missing method ' ) } } fn get_method ( obj map [ string ] json2.any ) ? string { if m : = obj [ 'method ' ] { if m is string { return m } else { return error ( 'invalid method ' ) } } else { return error ( 'missing method ' ) } }
in trailing struct literal arguments para-defaults like-a-varargs trick is described . now , assume all our params in actuall function call are defaults . i expect that ommiting arguments from foo call will be equal to foo ( foo { } ) : nope , this will not compile : adding empty { } to foo ( ) will make it compile , though : proposal allow empty arguemnts if the only argument of the function is struct . < code > fn main ( ) { assert foo ( { } ) == 3 } hello.v:10:9 : error : too few arguments in call to 'foo ' ( 0 instead of 1 ) 8 | 9 | fn main ( ) { 10 | assert foo ( ) == 3 | ~~~~~ 11 | } struct foo { baz string = `` cool ! '' bar int = 3 } fn foo ( c foo ) int { return c.bar } fn main ( ) { assert foo ( ) == 3 }
this source : yields : but yields : i think it would be nice to have both behave identically ( at least that 's the semantics i 'd expect ) . it 'll be useful for proper error handling as tracked in # 9367 . < code > fn f ( ) ? { return error ( 'my err ' ) } fn main ( ) { f ( ) or { panic ( err ) } } v panic : optional not set ( my err ) v hash : e9bbb7d /tmp/v/a.7836897204962053226.tmp.c:5649 : at v_panic : backtrace /tmp/v/a.7836897204962053226.tmp.c:5620 : by panic_optional_not_set /tmp/v/a.7836897204962053226.tmp.c:9392 : by main__main /tmp/v/a.7836897204962053226.tmp.c:9478 : by main fn f ( ) ? { return error ( 'my err ' ) } fn main ( ) { f ( ) ? } v panic : my err v hash : e9bbb7d /tmp/v/a.11159072267687342120.tmp.c:5649 : at v_panic : backtrace /tmp/v/a.11159072267687342120.tmp.c:9393 : by main__main /tmp/v/a.11159072267687342120.tmp.c:9479 : by main
i just wanted to make sure that when the final parser is created , it is done with the ability to have an array of values . the original implementation did n't do this ( i 'm using v 0.2.2 78c6e35 ) . in my little play app to learn v i created this implementation : see v/vlib/vweb/request.v line 70 in < phone > fn parse_form ( body string ) map [ string ] string { and v/vlib/net/http/request.v line 229 in de4c0c2 fn parse_form ( body string ) map [ string ] string { < code > fn parse_form ( body string ) map [ string ] [ ] string { words : = body.split ( ' & ' ) mut form : = map [ string ] [ ] string { } for word in words { kv : = word.split_nth ( '= ' , 2 ) if kv.len ! = 2 { continue } key : = urllib.query_unescape ( kv [ 0 ] ) or { `` } value : = urllib.query_unescape ( kv [ 1 ] ) or { `` } if value.len == 0 { continue } if key in form { form [ key ] < < value.trim_space ( ) } else { form [ key ] = [ value.trim_space ( ) ] } } return form }
i have this json from a external api [ { `` number '' : `` 674952 '' , `` createdat '' : `` 2021-01-26 20:38:47 '' , `` updatedat '' : `` 2021-02-18 14:51:33 '' , `` status '' : { `` name '' : `` status.returned '' } , } ] this fields updatedat , createdatgive my erros at compile time . this is my struct : struct pedido { number string status status createat string updateat string } json.v:9:5 : error : field name createat can not contain uppercase letters , use snake_case instead how to decode this fields ? annotations are allow in vlang ? go allows this struct pedido { number string status status createat stringjson : '' createat '' updateat string json : '' updateat '' } this json : '' createat '' tell go that createat field in json is map to createat in the struct < code >
feature request based upon the following not-quite-working example : v already knows that nums is of type [ ] [ ] int , so it seems like it should be smart enough to infer that an empty array inside of a [ ] [ ] int is a [ ] int . < code > user @ work1 : ~/v/examples < cur > cat type_inf_bug.v module main const ( nums = [ [ 2 ] , [ 0 , 1 ] , [ ] ] ) fn main ( ) { println ( nums ) } user @ work1 : ~/v/examples < cur > v run type_inf_bug.v type_inf_bug.v:4:23 : error : array_init : no type specified ( maybe : ' [ ] type { } ' instead of ' [ ] ' ) 2 | 3 | const ( 4 | nums = [ [ 2 ] , [ 0 , 1 ] , [ ] ] | ~~ 5 | ) 6 |
now i have made a v module called ffmpeg . it 's a v binding for ffmpeg , such as name . but i have to export every functions with function wrapper , such as : it 's so strange , and redundant . so can i find a easy way to export c functions in module ? < code > module avutil // some c flags fn c.avutil_xxx ( ) int pub fn avutil_xxx ( ) int { return c.avutil_xxx ( ) }
currently , the v is still under development , and v1.0.0 is still in the foreseeable future . but at the same time , v official team has developed too many great peripheral products ( ui/editor/unix system/lsp , and so on ) this leads to too much energy being allocated to these projects . i can understand that a successful product can help build a reputation , like docker for golang . but is this too early when v is not ready ? there are still many bugs in the current v core , and many functions of the standard library are missing . for most people , if you want to develop a tool ( library ) , most have to implement it yourself , which is a stumbling block that hinders the growth of the community . most people just stop here and choose another language . otherwise , for users , it may take 5 years and more for v to release v1.0.0 . this is just a suggestion , thank you for all your great work . ❤️ < code >
currently channels ( vlib/sync/channels.v ) use a ring buffer with smart locking optimizations ( i did n't yet find any time to check correctness of these considering the c memory model as described in < url > - there might be some fences needed or not ... idk - but so far it seems to do what 's expected in usual setups ) . thanks @ uwekrueger for all the hard work ! the performance is acceptable and the ring buffer itself does n't seem to be the main bottle neck for usual scenarios using ( very ) small buffer capacities . for others ( incl . networking , `` message passing '' , actor frameworks , etc . ) this will become a limitation though . one potential solution could be the use of a `` bipbuffer '' ( aka `` virtual ring buffer '' ) as described in < url > and < url > and < url > and < url > and others . except for the main property of being contiguous , another advantage is , that bipbuffer should allow for even more locking optimizations . those of you needing some more performance from channels , feel free to give it a try ! @ uwekrueger @ medvednikov @ spytheman @ cristian-ilies-vasile @ jalonsolov @ penguindark and many others ... < code >
hello , in the docs i read that v allows operator overloading specifically for scientific applications , but then you constrain it to be type-symmetric , i.e . dont allow operators between different types . unfortunately that seems to strongly constrain scientific application : matrices , vectors , scalars , tensors , quaternions , complex numbers , plucker coordinates , etc , all of these define cross-type operators that are very useful and otherwise lead to a lot of what the doc says it doesnt want ( i.e . matrix.dot ( vector ) .mul ( scalar ) ) as can be seen in vlibs implementation of glm . < code >
i 'm developing a websocket game in vlang , i face this problem : the data variable is not visible inside . there are no global variables in vlang . is there any solution or workaround for this problem ? compile error message : ./gameserver.v:97:32 : error : undefined ident : data 95 | if msg.payload == 'get-map'.bytes ( ) { 96 | //create_game ( ) .get_map_string ( ) 97 | c.client.write ( data.bytes ( ) , websocket.opcode.text_frame ) or { panic ( err ) } | ~~~~ 98 | } 99 | } anyway , i found vlang very cool ; ) < code > mut data : = 'testmessagedata ' s.on_message_ref ( fn ( mut ws websocket.client , msg & websocket.message , mut m websocket.server ) ? { for i , _ in m.clients { mut c : = m.clients [ i ] if msg.payload == 'get-map'.bytes ( ) { c.client.write ( data.bytes ( ) , websocket.opcode.text_frame ) or { panic ( err ) } } } } , s )
is there any idea for how to go beyond amd64 ? i can put in some work , because i would like to play with v , and need closures to do anything interesting : ) . currently starting to look into libjit , not sure where that will lead . < code >
what did you do ? what did you expect to see ? a white rectangle what did you see instead ? nothing description due to the sokol_gl.h header , it is only possible to give it a max of 1 < < 14 or 16384 commands . everytime set_pixel ( ) is called , that counts as a command . while this is n't unintended behavior , it can be pretty limiting . finding ways around the restrictions is pretty easy by drawing and updating an image instead , but for some cases i might prefer to draw pixel by pixel . i 'd request for these limits to be increased : < url > i was n't sure whether to mark this as a feature request or bug < code > for x in 0 .. 150 { for y in 0 .. 110 { app.gg.set_pixel ( x , y , gx.white ) } }
i am now building an experimental freebsd virtualization management interface that use vweb . but now i have a problem , my application only listening to localhost . based on this code v/vlib/vweb/vweb.v line 291 in 063ffe3 mut l : = net.listen_tcp ( .ip6 , ' : < cur > port ' ) or { panic ( 'failed to listen < cur > err.code < cur > err ' ) } it 's seem that vweb hard coded to listening only on localhost . it 's is pointless for me to deploy extra reverse proxy like nginx in front of application . so the question is : is my understanding about vweb listening only on localhost wrong ? how to make vweb listening to all interface or ip available ? thank you in advance < code >
rich library , generics , speed ( execution and compilation ) make v a good candidate for competitive programming . i know language devs might not think of competitive programmers as an ideal target but i seriously enjoyed solving project euler problems in v. but no competitive site seems to offer v as a choice . when will we get v support on sites like < url > < code >
when the c compiler generates an executable on/for android , the executable includes what is called an elf header , and everytime you run it , it will always prints this when compiling c , you can clean the elf header using the makefile , but v has its own build system and strategy . if the compilation is happening inside an android device and the termux-elf-cleaner command is detected , run that with the path of the executable as the first argument . you can detect if the device is android by check if one of the environment variables android_data or android_path are set . < code > warning : linker : /some/path/to/executable : unsupported flags dt_flags_1=0x8000001
v version : v 0.2.2 1588fe7.be7c396 os : windows , microsoft windows 10 enterprise v19041 64-bit what did you do ? this works fine and this one compiles with an error what did you expect to see ? that < cur > embed_file ( ) not supports string literals as file name , but also string variables what did you see instead ? < code > mut file : = < cur > embed_file ( `` rosie_unittest.rpl '' ) error : unexpected name 'fpath ' , expecting string 102 | fn load_rpl_file ( debug int ) ? rt.rplx { 103 | fpath : = `` rosie_unittest.rpl '' 104 | mut file : = < cur > embed_file ( fpath ) | ~~~~~ 105 | data : = file.to_string ( ) 106 | mut p : = parser.new_parser ( data : data , fpath : fpath , debug : debug ) ? fpath : = `` rosie_unittest.rpl '' mut file : = < cur > embed_file ( fpath )
there is a problem at the moment where interop declarations are not declared as public , so the checker can not check if they are being used correctly in imported modules , yet they are always treated as public . discord discussion started here : < url > the ultimate decision of that thread is that the interop declarations should not be declared as public - there should be v wrappers for them instead , if they need to be public . the wrappers can then be declared public . as this has never been a requirement before there is a fair amount of existing code which relies on c interop declarations being public without the keyword , so the suggestion is to have -wimpure-v flag such things as a problem to ease the transition . at a later date , this can become a warning/error if an interop function is declared with pub . for now , we can enforce that pub must be used if you want to access the interop declaration outside the current module . < code >
i like that i can initialize struct values such as in however what i do n't like is that i can not use default values , such as if i do this , a warning is raised , and in prod code even an error . and if i do the below , because i like the expressiveness and readability of the default assignments , then the the code formatter will screw it up completely hence my suggestion : allow struct variable initialization also with v-lang default values . < code > struct mystruct { a bool = true start int = 10 } struct mystruct { a int = false start int = 0 } struct mystruct { a int / * = false * / // describe ... start / * int = 0 * / // comment }
hi ! < cur > embed_file is very useful , but sometimes there are needs to include whole directories ( like those that have lots of files ) , whose file names are known at compile time but can not currently be included easily except by writing all of their paths explicitly . some kind of compile-time computation using os.glob would solve this , but i think it is much faster to currently include an < cur > embed_dir mechanism . < code >
documentation says : `` here i does n't need to be declared with mut since it 's always going to be mutable by definition . '' i 'd suggest to change the semantics here : this i is `` const '' in the body of the loop , it is only allowed to be changed by the i += 2 loop increment instruction . if the programmer wants to change the loop variable within the loop body freely it must be declared with mut explicitly : motivation : arbitrarily changing the loop variable in the loop body is considered `` bad style '' and allowing that makes code analysis ( by compiler and human readers ) much more complex . so it should be not allowed by default and enabled only if necessary . < code > for i : = 0 ; i < 10 ; i += 2 for mut i : = 0 ; i < 10 ; i += 2
as known , v supports tuple returns and tuple assignments . if , say , a function takes in a tuple argument , and another function returns a tuple , i should ( ? ) be able to feed the output of one function into the input of the other like this : current behaviour < code > 3 | fn a ( x int , y int ) { main.v:12:2 : error : expected 2 arguments , but got 1 10 | 11 | fn main ( ) { 12 | sum ( prod_pair ( ) ) | ~~~~~~~~~~~~~~ 13 | } fn sum ( x int , y int ) { println ( x+y ) } fn prod_pair ( ) ( int , int ) { return 2,3 } fn main ( ) { sum ( prod_pair ( ) ) }
currently my computer has two operating systems installed which i use interchangeably , and both of which access the same filesystem with my projects and other junk . yesterday i cloned the repository of vlang compiler and compiled the compiler from linux . i had used the compiler and it worked fine . today i tried to navigate to the same folder and build vlang for windows also . turns out that it did n't do it , because it relied on tcc.exe being in thirdparty cc , and it was there , but it was an elf executable . the make script , seeing that the tcc compiler is there ignored it 's installation and proceeded trying to compile vlang compiler source . since windows can not execute elf executables , i got an error . i would like for the vlang compiler to execute a different version of tcc ( the one for windows or the one for linux ) depending on the current os . for now the solution to my problem is to re-clone vlang and duplicate every single file of the clone library and update and rebuild each one of the copies separately . < code >
currently , offsetof is expressed with this uncharacteristic __ in front of it , seen nowhere else in v afaik . in c , it is a compile-time macro implemented by compiler magic , so it would make sense imo to consolidate this feature into the reflection system by prefixing a < cur > symbol on it . < code >
right now only string literals are supported , string support too would be awesome ! example of use : a dynamic html template renderer what did you expect to see ? the rendered html file printed . what did you see instead ? < code > page : = 'index ' println ( < cur > tmpl ( '/templates/ < cur > { page } .html ' ) )
running v as a mounted drive to a window partition which is thne mounted into a virtual box ( windows 10 ) , v was compiled with gcc 10 ( mingw ) , this previously work with a v version from months ago , and now i get z : \v > v.exe welcome to the v repl ( for help with v itself , type exit , then run v help ) . failed cmd : `` unc\vboxsvr\portableapps\v\v.exe '' `` z : \v\unc\vboxsvr\portableapps\v\cmd\tools\vrepl.v '' failed code : 2 v panic : exec failed ( createprocess ) with code 2 : the system can not find the file specified . cmd : `` unc\vboxsvr\portableapps\v\v.exe '' `` z : \v\unc\vboxsvr\portableapps\v\cmd\tools\vrepl.v '' v hash : aaee251 print_backtrace_skipping_top_frames is not implemented < code >
as we all know , x64 code generation is currently only available for linux . the purpose of this issue is to track , discuss and collaborate on efforts to get this also implemented for macos and windows ( or to branch out into other issues to get more specific for each ) . < code >
description currently we ca n't customize the domain or the path of a cookie when setting a cookie using vweb.context.set_cookie ( ) . expected behavior i would like to be able to do this : notes i see there is a net.http.cookie struct , would n't it be better to try to share the same struct ( if there is no reason to split both of course ) ? < code > import vweb { cookie } struct app { vweb.context } fn ( mut app app ) index ( ) vweb.result { app.set_cookie ( cookie { name : `` darkmode '' , value : `` 0 '' , path : `` / '' , // < -- -- -- new domain : `` localhost '' , // < -- -- -- new } ) return app.html ( `` < h1 > hello world < /h1 > '' ) } fn main ( ) { vweb.run ( & app { } , 8000 ) }
( from a discussion on discord ... ) the problem right now is that you can not use the same methods on fixed arrays as you can on dynamic arrays . for example : give the error meaning there 's no way to print the contents of the array as a string without converting to a dynamic array , first . suggested syntax would be something like or < code > fn ( x [ _ ] byte ) foo ( ) mut buf = [ 10 ] byte { } buf [ 0 ] = 0x61 println ( buf.bytestr ( ) ) fn ( x [ * ] byte ) foo ( ) bug.v:3:13 : error : unknown method : ' [ 10 ] byte.bytestr ' 1 | mut buf : = [ 10 ] byte { } 2 | buf [ 0 ] = 0x61 3 | println ( buf.bytestr ( ) ) | ~~~~~~~~~ 4 |
v version : v 0.2.2 2c4a59f os : 20.04.1-ubuntu what did you do ? try to find a simple way to get the header value by the header name in request what did you expect to see ? code snippet for this . < code >
situation imagine a function call that exceeds the maximum line length ( 100 ) : current behaviour now the lines fit into the max length but it still looks messy . proposal put one argument per line please let me know whether you support this idea or want to keep the current behaviour . or come up with something even better ; ) < code > my_func ( 'very long string with many many words to be really long ' , < phone > , my_long_boolean_var_name , 'another string with big length ' ) my_func ( 'very long string with many many words to be really long ' , < phone > , my_long_boolean_var_name , 'another string with big length ' ) x ( 'very long string with many many words to be really long ' , < phone > , my_long_boolean_var_name , 'another string with big length ' )
i think the documentation file is getting unwieldy , so i crapped out a quick and dirty documentation reader . < url > it supports syntax-highlighting and bookmarking , and you can toggle the light/dark themes by pressing the lightbulb . i spent zero time actually designing this , because i 'm not a designer - i just grabbed a couple of free bootswatch themes and picked two of the standard prism themes . it obviously should n't live on jsfiddle , and probably should n't rely on githack.com as a cdn , so you can think of this as a quick prototype - but it 's a lot more usable than just the bare markdown file on github , i think . anyhow , i do n't plan on doing anything else with this , so feel free to pick it up and create more v looking themes maybe , or use it as the basis of something more official on the website ? copyleft , no rights reserved . 😉 < code >
for now , there is a problem to synchronize correctly the thread with websocket server and another thread ( s ) . for example , websocket_test.v ( and other samples ) use sleep in main thread for it . during the discussion in discord @ spytheman suggested to change events.v and websocket_server.v to add the new on_listen callback to provide such synchronization ( for example , via post semaphore in the main thread from the callback ) . unfortunately , it ( making the changes ) is to complex for me : - ( the changes in websocket_server.v around s.ls = net.listen_tcp ( s.port ) ? should provide the scheduling of the new callback with passing possible error ( if happened ) to it . best regards , vladimir < code >
i want to create a set type that holds strings . at the moment i 'm using map [ string ] bool but i only care about the key and do n't need values . is this possible in v ? ( i do n't want to implement sets from scratch . ) what i need is fast membership testing and fast add/remove ; ordering does n't matter . < code >
struct comparison might be implemented by default as : < code > < cur > v welcome to the v repl ( for help with v itself , type 'exit ' , then run ' v help ' ) . v 0.2.2 < phone > use ctrl-c or 'exit ' to exit , or 'help ' to see other available commands > > > struct struct1 { ... field1 int ... field2 string ... field3 f32 ... field4 byte ... } > > > a : = struct1 { } > > > b : = struct1 { } > > > a < b error : undefined operation 'struct1 ' < 'struct1 ' 20 | 21 | } 22 | println ( a < b ) | ~~~~~ a < b < = > a.field1 < b.field1 || ( a.field1 == b.field1 & & a.field2 < b.field2 ) || ( a.field1 == b.field1 & & a.field2 == b.field2 & & a.field3 < b.field3 ) || ( a.field1 == b.field1 & & a.field2 == b.field2 & & a.field3 == b.field3 & & a.field4 < b.field4 )
v version : os : what did you do ? what did you expect to see ? the program running , printing 0 , then 2 what did you see instead ? < code > sum-type.v:15:3 : error : unexpected symbol 'sum_type ' 13 | a : = st ( abc { } ) 14 | println ( a.a ) // would print 0 15 | a.a = 2 // error : unexpected symbol 'sum_type ' | ^ struct abc { mut : a int } struct def { mut : a int } type st = abc | def a : = st ( abc { } ) println ( a.a ) // would print 0 a.a = 2 // error : unexpected symbol 'sum_type ' println ( a.a )
deinit ( ) . similar to init ( ) , but called at the end of the module 's lifetime . ( also similar to free ( ) for structs ) . this can be accomplished using c code currently - c.atext ( ) ( int atexit ( void ( * func ) ( void ) ) ) . c.atexit ( ) exists , but with scoping & avoiding globals , the relevant context ( s ) can not be accessed . request more robust cross-platform termination detection , and a potential similar alternative to init ( ) , so that meta/system-level control flow can be properly handled by the main module . discussion tl ; dr : current methods not cross-platform ( c.atexit ( ) , os.signal ( ) ) , encourage wasting resources ( init ( ) ) , encourage sub-modules to alter system-level control flow ( os.signal ( ) , exit ( ) , panic ( ) ) . pattern with closures proposed . sub-issue of sub-modules having globals and side-effects . globals are a necessity for c interop and low-level ( effectively discouraged for general use ) , but side-effects ( making globals apparent to the main module , or altering system-level control flow ) can and should be avoided , at least not encouraged . < code >
i do n't know how challenging this is to implement in the compiler , but i think it is a very useful and simple idea that could reduce the use of interface { } a lot . if there 's another way to do this then please let me know . i want to define algorithms on data without knowing anything whatsoever about what is in the data . so i ca n't use sum types . and different functions need to be cross-compatible , so i ca n't use a separate generic for each of them . what seems natural to me is choosing a particular grounding for the type variables when the file or module is imported . an example of what i mean : where this scenario is less compatible with single-letter type parameters than just single functions , so that 's another mark against it thoughts ? < code > import mdp_utils with { state as [ ] i64 action as string } ( define a particular agent and mdp ) mdp_utils.execute ( m , ag , s ) module mdp_utils pub type state = ( ( file-level type parameter ) ) pub type action = ( ( file-level type parameter ) ) interface markovdecisionprocess { actions [ ] action states [ ] state discount f64 reward ( s state ) f64 transition ( s state , a action ) state } interface agent { policy ( state ) action update ( f64 ) } pub fn execute ( mdp markovdecisionprocess , ag agent , start state ) { mut state : = start for { action : = ag.policy ( ) state = mdp.transition ( state , action ) r : = reward ( state ) ag.update ( r ) } }
hi all , to successfully close a vweb application , it would be great to have a default method called when the application get a sigterm signal ( maybe even sigint ) ; note that could be useful to call that handler even by application code ( when applications expose a termination endpoint on a protected route or port , or other ) . default behavior should be to stop incoming traffic and stop the server ( using a timeout , by default x msec ) ; this is useful for example to let existing elaborations to complete , and flush db connections ( if any ) . and if an application need a custom logic , write a custom close handler . note that an internal flag to manage incoming traffic could be useful even when webapps are running for example in kubernetes ( k8s ) , where it 's possible to specify even a `` readiness '' endpoint that when true k8s will route incoming traffic to the webapp ; so for example it could be automatically set to true at the end of webapp init ( the `` init_once '' method ) and and the beginning of the close handler . all just to give more context ... that in some cases the ability to stop ( maybe temporarily ) application to accept/process incoming requests could be good to have ; and in those cases maybe by default reply with an http error 503 , as seen here . what do you think ? thanks a lot < code >
struggle i have been playing with rust integration for ios , and one thing i noticed is that syntax wise it sucks . why ? because rust uses c types to actually extern methods from library to end user . syntax wise it could be this : solution this could be solved with v. v exports .c files from .v file with ease . issue is module that are written in v that actually include other modules does not export to .c files , there for .a files ca n't be created . and this is where issue blocks this idea . why would this be beneficial for v ? imagine writing v module that runs on ios , android and asm . this will make building cross platform modules reality . < code > # [ no_mangle ] pub extern `` c '' fn give_me_letter_a ( count : c_ulong ) - > * mut c_char { let string = `` a '' .repeat ( count as usize ) ; let cstring = cstring : :new ( string ) .unwrap ( ) ; cstring.into_raw ( ) }
so because error as it 's clear that < cur > if currently introduces a scope . it should not , i repeat , it should not . having it introduce a scope makes it impossible to optionally define make declarations of types , functions and constants , depending on the compile-time expression given to < cur > if . if you want v to be a language that 's going to be competitive in terms of expressiveness and powerful metaprogramming capabilities , please change this now . as andrei mentions in his talk linked to below , in the case studies done in d , its static if requires absence of scope in 95 percent of its uses cases . if you want to see for yourself what scope-less static if makes possible , go into d 's standard library and search for static if ( or static foreach ' for that matter ) and look for yourself . it 's branching at design space . one have to study these cases for oneself to understand what capabilities it enables . the scope should instead be optionally enable via an extra pair of braces as and for motivation see andrei 's complete destruction of c++ 's corresponding if constexpr at < url > < code > fn main ( ) { < cur > if windows { x : = 1 } < cur > else { x : = 2 } println ( x ) // error : undefined ident : ' x ' } < cur > if { { } } error : undefined ident : ' x ' < cur > for { { } }
filter and map are great but i 'd like more iterator methods like the ones mentioned in the title . rust offers a huge number of functions for anything that is iterable : < url > the biggest benefit i see is it allows for a more functional style of programming . some example usage : < code > x : = [ 1 , 2 , 3 ] x.any ( it == 2 ) // true x.all ( it < 2 ) // false x.sum ( ) // 6 x.chunks ( 2 ) // [ [ 1 , 2 ] , [ 3 ] ] x.windows ( 2 ) // [ [ 1 , 2 ] , [ 2 , 3 ] ] x.take ( 2 ) // [ 1 , 2 ] x.skip ( 1 ) // [ 2 , 3 ]
go 's string to bool conversion uses these values . i think v should use the same . < code > `` 1 '' , `` t '' , `` t '' , `` true '' , `` true '' , `` true '' `` 0 '' , `` f '' , `` f '' , `` false '' , `` false '' , `` false ''
partial application is a very useful feature in any language . it could complement vlang 's current capabilities and allow for more functional application designs . for instance : you might partially apply functions with any dependencies they might need at the top of the application so that you can mock every side effect in the application from the main entry file . question : is there any way that a workaround could be achieved using existing features of the language ? perhaps using reflection ? < code >
rust , if you have programmed in it , allows you to specify a generic to a specific trait . i do n't remember what this feature is called , but it looks like this : the purpose of this is to make sure that the type that will be passed to the function fulfills a certain function or field , to avoid making use of non-existent things . in v this could be elegant , because with this we could tell the compiler that we expect a type that implements one ( or more ) specific interfaces . what do you think about this ? < code > trait operable { fn operate ( ) - > string ; } fn gen < t : operable > ( operator : t ) { println ! ( `` { } '' , operator.operate ( ) ) ; } interface operable { operate ( ) string } interface hack { hackme ( ) } fn gen < t : operable + hack > ( v t ) { println ( v.operate ( ) ) v.hackme ( ) }
under linux the installation of the optional garbage collector is trivial . it is enough to install the libgc-dev package . how do i install the gc under windows ? simply including the required header file ( gc.h ) is not sufficient . btw : since the crypto modules still have strong leaks , i tested them with the gc under linux . so it works , except for losses in performance very well < code >
is there a plan to support tail call optimization v to allow efficient use of recursive functions ? i did not see any mention of tco in the docs . < code >
hi there ! v looks very interesting ! question : in the types - primitive types section , the graph shows an oblique arrow from int to f32 . yet just below , the text states that an int can not be automatically promoted to f32 nor to u32 . what are the oblique arrow representing then ? is it an error in the document or an omission of another supported concept not yet described such as casting ? i assume the latter is true . is this correct ? let me know if this was already discussed , i looked and did not find it . < code >
i want to be able to declare a variable from the field data of a structure possible syntax already found that table.get_type_symbol ( typ ) satisfies the goal < code > obj : = < cur > ( typeof ( field.typ ) .name ) { } obj : = < cur > typeof ( field.typ ) { } // where fielddata.typ is int ( idx ) obj : = < cur > ( field.typ ) { }
right now , the docs list these common types : i8 i16 int i64 i128 ( soon ) byte u16 u32 u64 u128 ( soon ) it would be nice if `` u8 '' were an alias for `` byte '' , and `` i32 '' for `` int '' . that would give full consistency across the integer types/sizes , and leave no ambiguity as to size . i know 'byte ' and 'int ' are commonly used , but they are actually different sizes on different architectures ... for example , at least one old system had an 11 bit 'byte ' . < code >
do enums support constant expressions ? currently no , but i think it is easy to add support ( it is similar to the const case ) < code >
first : i like vlang . i just want it to be better , it 's that the perfect programming language i 've been looking for . but it still has some confusing syntax ( just i think ) . this issue i will keep updating , record some little little suggestions see above syntax or other not used , it use brace { } , it 's has no problem , but see this . can we use this : can we use this : import and const are all defined keywords , it difference with function block , and no fn define . < code > struct app { } for i in input { } if value { } fn main ( ) { } import os import flag import semver import vxt import java import { os flag semver // ... others } const { } const ( )
one difference from bash , sh , .. and vsh is that commands executed , will not live printed to the terminal . for example : does print the output after the command was run . but is n't there a function that prints it directly ? i do n't develope programming languages or so and i do n't know how that can be implemented , but i guess the idea is not bad . also do n't replace it with the execute ( ) . adding something like execute_and_print . the return value can be the same as in execute ( ) . < code > println ( execute ( 'echo first ; sleep 10 ; echo after ' ) .output )
it would be great if the compiler could enforce exhaustive matches for error handling . this is a pretty difficult problem which can be discussed more when the language stabilizes . < code > fn default ( ) ? int { return error ( 'hello ' ) } fn opt_none ( ) ? u64 { return none } struct customerror { msg string = 'hello ' code int = 86 } fn custom1 ( ) ? f32 { return ierror ( & customerror { } ) } fn propagation ( ) ? { custom1 ( ) ? } propagation ( ) or { println ( 'err.msg = < cur > err.msg ' ) match err { none { println ( 'got 'none '' ) } error { println ( 'got 'error '' ) } customerror { println ( 'got 'customerror '' ) } else { panic ( 'unhandled error : < cur > err ' ) } // < -- - remove else } }
now compiler warns unnecessary default value . but what is wrong to explicity set default value ? any demerit ? i think to make it sure that this field is first false explicitly would promote readability , no demerit . < code > struct { foo bool = false }
since the vweb web framework will get bigger and bigger , it needs a standalone documentation page . for the beginning there could be a doc/vweb.md file with a clear structure , where all the important points are explainined . this will allow people to create good web apis / websites . at the moment there are just references to other projects or code samples but there is no single complete documentation about it . this makes it harder to jump on the train . < code >
i can not find anything on the docs about working with sockets and ports , dealing with incoming requests ( https , telnet , tsl , etc ) , listening and/or sending reponses . is networking implemented in any capacity in v or is still being worked on ? if it 's already implemented , where can i find documentation or examples of it ? < code >
hi folks , i 'm new to v , but i 'm liking it so far . i think it has a lot of potential . i was just working my way through the docs , and was trying out the attributes . in particular , i wanted to try out the [ if debug ] attribute . however , despite marking a function with the attribute , the function is still called even when no flag is passed . is this a future feature , or am i just messing up somehow ? my test code is nothing more than the example given in the docs . i checked the open issues , but could n't see any mention of a bug and i 'm not a good enough programmer to boldly claim that this is one 😁 are [ if debug ] attributes working for you ? if this is something that others are seeing , i 'll open an issue . thanks . < code >
this is a c function , how to use v complete it . thanks ! < code > float invsqrt ( float x ) { float xhalf = 0.5 * x ; int i = * ( int * ) & x ; // get bits for floating value i = 0x5f3759df - ( i > > 1 ) ; // gives initial guess x = * ( float * ) & i ; // convert bits back to float x = x * ( 1.5 - xhalf * x * x ) ; // newton step return x ; }
currently mutation is explicit for function calls but not method calls : sort ( mut mutable_item ) // here the current syntax makes mutation explicit mutable_item.sort ( ) // here the current syntax allows silent mutation // for the same functionality since the extremely minimal syntax of appending an exclamation mark , as in mutable_item.sort ! ( ) , has apparently already been rejected by the community .... here i 'm suggesting : mutable_item ! sort ( ) // the new syntax would use an exclamation mark // in place of the dot operator for mutating method calls i 'm not sure how we can cut down the typing much more than that . replacing the dot with ! means one less keypress than sort ! ( ) and it has an added advantage : with autocompletion it can trigger a filtering of suggestions to include only mutating methods . finally , this way methods do n't need a special name . that would mean there may actually be no net extra typing . another option could be capitalizing : mutable_item.sort ( ) // same benefits as ! but actually also enhances the readability , i think if this change makes it in , i 'm imagining that at first the compiler would just give a warning when the new syntax is expected . < code >
[ direct_array_access ] turns off bounds-checks for arrays for a whole function - this hides memory-unsafe behaviour . instead we could make it easier to get an element pointer - what if we had a ptr array property for [ ] t that is & t , unlike the data voidptr field . that avoids a pointer cast , and it 's much cleaner for pointer indexing : [ direct_array_access ] is sometimes overkill , so making it easier to selectively avoid bounds checks inside a function is a win regardless . note also that [ direct_array_access ] can sometimes be avoided with for/in : # 8857 < code > arr [ 0 ] = 2 // looks like it should bounds check but might not unsafe { ( & int ( arr.data ) ) [ 0 ] = 2 } // using .data unsafe { arr.ptr [ 0 ] = 2 } // proposed
prevent v fmt from removing tabs preceding trailing comments and preceding assignments . currently : formats to : ensure assignments/comments are indented to the same level in an enum/struct . < code > enum result { success = 0 out_of_memory = 0x00010000 // out of memory invalid_value // invalid value/argument invalid_file_name // invalid state } enum result { success = 0 out_of_memory = 0x00010000 // out of memory invalid_value // invalid value/argument invalid_file_name // invalid state }
given that it 's possible to compile v as c code , i 'd like to know if it 's possible to write once and , supposing all your libraries do n't rely on specific os system calls , is it possible to have stuff done in v to be as compatible as c ? for instance , writing something that can be run on windows xp , slitaz , haiku and aros ( all of them on a x64 arch ) , by compiling as c instead ? or would that require specific work to ensure that v knows what functions to call for those oses ? < code >
currently this works : what 's the behaviour of it ? will this be removed ? < code > union test { x int } fn main ( ) { t : = test { } }
i 'm having fun playing and learning v , its great ! but to use it just about anywhere in my world i need to access microsoft sql servers , do you have any idea of when this may happen . thank you , ashley < code >
working with unicode is kind of a pain . for example , reversing a string that contains unicode is not simply reversing the bytes ( like the standard reverse ( ) does ) . it 's possible , though troublesome , to find the start byte of each rune using s.ustring ( ) .runes but this does n't work for grapheme clusters . note that the 0xcc 0x88 is considered its own rune instead of grouped with the u as it should be . < code > x : = 'uuu ' x.bytes ( ) // [ u , u , 0xcc , 0x88 , u ] x.ustring ( ) .runes // [ 0 , 1 , 2 , 4 ]
currently , the crypto module only has the basic implementations of the crypto protocols . current ones like sha3 as hash algorithm or eliptic curves are not available . the current openssl module `` x.openssl '' can currently only accept tls connections , but can not provide any as a server . how about an implementation like in go ( crypto/tls ) or python ( ssl , but then not the same syntax ) . this is essential for running web servers or sockets in general . also , instead of the ftp module , the alternative ssh ( which is much more secure ) would be interesting . are extensions like in go planned ? < url > < code >
i 've read the docs ( which are super great by the way ) which said that constant variables are the default when declaring variables ( and assigning ) . so why do you need `` const '' if mutability is opt-in ? < code >
there are a lot of uses of p.error ( ) or p.warn ( ) that do n't show a position . # 6997 shows how to fix these . probably best to fix them in batches . < code >
i thought go missed an opportunity when garbage collection did n't extend to streams and files . they required manual `` freeing/closing '' instead of the language handling it for me when the variable went out of scope . defer was pushed as a helper for calling close , but this does n't work correctly in a loop unless it 's wrapped by a function . mistakes are often made with http clients in go for example . this would reduce code size , eliminate leaks and reduce cognitive load . thoughts ? < code >
hi , i 'm new to v and trying to write a simple smtp server . i just took some example code and used net/tcp_read_line . when i run the below code i got 30 % cpu utilization for every client that connect while the threads blocking in read_line . is there a way to not busy block ? tested with v 0.2.2 c904c91 on win 10 . < code > import net const ( test_port = 45123 ) fn handle_conn ( mut c net.tcpconn ) { for { str : = c.read_line ( ) if str.starts_with ( `` helo '' ) { c.write ( `` hello , too ! `` .bytes ( ) ) or { println ( 'server : connection dropped ' ) return } } } } fn echo_server ( mut l net.tcplistener ) { l.set_accept_timeout ( 1000 ) for { mut new_conn : = l.accept ( ) or { continue } go handle_conn ( mut new_conn ) } } fn main ( ) { mut l : = net.listen_tcp ( test_port ) or { panic ( err ) } echo_server ( mut l ) l.close ( ) or { } }
hi , have been reading the source code of vweb and i do n't find a convenient way how to return files remarl : should not be loaded in memory before sending to client would be nice there is just a method like return app.file_send ( path ) ... is there any way how this can be done ? many thanks kristof < code >
i read in the documentation on operator overloading that `` calling other functions inside operator functions is not allowed '' i do n't understand the reason for this restriction . imagine that you want to write a nice wrapper for a libray perfoming some kind of arithmetic like gnu gmp / mpir , flint/ arb , pari , etc . then you will need to call some c functions in the implementation of the overloaded operators ! this would be very useful for any application related to mathematics . < code >
release version should be as easy and friendly as possible to new comers , facilitating v 's spread among programmers with different programming level and different familiarity with v. v development is for professionals , but release should not . for example , some languages like python just give an install package . you download and then click on it , finished ! what need to be done to release version ? ( 1 ) . create easy solution ( install package e.g. ) . ( 2 ) . remove dependency , especially professional tools as many as possible ( git e.g . ) < code >
< div > @ html < /div > the content is entity encoded . i ca n't find a way to disable that . other templates i 've used have soemthing like { : html content } where : html will disable html entity encoding . < code >
i want to use the winexec function of kerenl32.dll to pop up the calculator i tried the winexec function of kerenl32.dll to pop up the calculator , but the calculator did not pop up and there was no error message . my code is as follows : the results are as follows : < code > module main import dl type exec = fn ( string , int ) int fn main ( ) { h : = dl.open ( 'kernel32 ' , dl.rtld_now ) mut proc : = & exec ( 0 ) proc = dl.sym ( h , 'winexec ' ) res : = proc ( `` calc.exe '' ,2 ) println ( res ) }
hi guys , is there a way to get mac address info by using v 's standard library module ? i see it 's easy to get that information in golang , by using net lib of go . but i did n't find a way to get that information in v. thanks for help : ) < code >
part of : # 43 , # 8346 < code > < cur > for type , field in t.fields { // type variable name must be capital and longer than 1 char // type is not accessable from real code // type can be used in comptime calls like < cur > if type is string }
changelog.md v 0.2.2 overloading of > , < , ! = , == , < = and > = operators . i think this is a feature that would make the code look confusing . when looking at other people 's code it can make people wonder what `` == '' means now and if it has been overloaded . the first word in the introduction of v is `` simple '' , i hope it really is a simple language and not getting more and more complicated and finally becoming c++ . < code >
i do n't wan na know why i should use v instead of another language . i 'd like to know why this language is named ' v ' . probably there are some causes < code >
i 'm to transform/transpile stockfish c++ in v , is it readily complete to replace all the c++ capabilities used there ? please list whichever one seem not ready or hard to get substitute in brief clear explanation . thanks before < code >
introduction this issue is a roadmap for phase 3 and community contributions are welcome . it is a continuation of the work i , @ delta456 and @ x0r19x91 had done last summer . it aims to add support for non-uniform probability distributions ( like gaussian , poisson , etc ) and utility functions ( like shuffle , perm , etc ) . there exists some overlap with the existing ( and ongoing ) work with vsl , specifically the combinatorics module . hence , discussion is necessary . please add your suggestions as comments in this issue . planned features move seeding functions to rand.seed rename rand.util to rand.seed rename rand.util.util.v to rand.seed.seed.v distributions submodule ( rand.dist ) functions will support user provided rngs through sum types and configuration structs . users can change the default rng to suit their needs . ( # 9083 ) bernoulli trial binomial trial gaussian ( or normal ) distribution functions exponential distribution utility functions ( rand.util ) generic array shuffle function . sampling functions final touches code review update documentation postponed ( good pr ideas ) poisson distribution weibull distribution log-normal distribution pareto distribution beta , gamma distributions von mises distribution triangular distribution random array generation tutorial using sampling functions others ... < code >
i need to decode 2020-9-13 to time.time struct , who would like to help me ? thanks a lot . < code > fn encode_date ( ) { t : = time.new_time ( year : 2020 , month : 8 , day : 13 , ) s : = json.encode ( t ) println ( 'encode date : < cur > { s } . ' ) //got : { `` year '' :2020 , '' month '' :8 , '' day '' :13 , '' hour '' :0 , '' minute '' :0 , '' second '' :0 , '' microsecond '' :0 , '' unix '' : < phone > } } fn decode_date ( ) { s : = '2020-9-13 ' d : = json.decode ( time.time , s ) or { println ( 'decode error : < cur > { err } . ' ) return } println ( 'decode : < cur > { d } . ' ) //got : 0000-00-00 00:00:00 }
as @ spytheman said , once type analysis of match block gets smarter , the f64 ( ) in such code should be able to be removed . < code > // a binary tree example struct empty { } struct node { value f64 left tree right tree } type tree = empty | node fn sum ( tree tree ) f64 { return match tree { // todo : remove f64 ( ) empty { f64 ( 0 ) } node { tree.value + sum ( tree.left ) + sum ( tree.right ) } } } fn main ( ) { left : = node { 0.2 , empty { } , empty { } } right : = node { 0.3 , empty { } , node { 0.4 , empty { } , empty { } } } tree : = node { 0.5 , left , right } println ( 'tree structure : < cur > tree ' ) println ( 'tree sum : < cur > { sum ( tree ) } ' ) }
sizeof currently takes a type or an expression , and produces a u32 . v and go have a philosophy of not using unsigned types e.g . for allocation size , .len , so this should be a signed type to avoid casts . in c , sizeof working on an expression is important because : c does n't have typeof ( expr ) . v does . c has string literals ( and array literals ) where sizeof will give the size of the data rather than the pointer type . v string and array types already have length so this can be calculated very easily . let 's simplify this . we already have the type.name property . we could have a type.size property that is an int ( or isize ) , and it only works on types . you would use typeof ( expr ) .size when you do n't already know the type . note : typeof ( expr ) is allowed atm but i need to deprecate that , and the size property can still be implemented whilst that is still supported . < code >
in node , you can type object . and then double-tap the tab key in order to bring up a list of all properties . this feature is super useful when exploring an api - especially when you ca n't remember the exact typing or what all a module or object has for methods and functions . would something like this be possible to be added to the repl ? < code >
for easier distinguishing from variables , constant names should be uppercase allowing underlines . it makes the code a lot easier to read and is a basic convention among most languages and good practices . < code >
hello guys , i have a problem concerning x/websocket . i tried to figure out a way to send messages to all users when any client sends a message using the websocket example ping.v . i removed the client stuff so there is only a server and one can connect via js or something like this . trying to find a solution i thought about adding the client to an array upon connecting . i had a hard time implementing this , and i am still wondering whether there are any easier possibilities . i am really new to vlang and wondering how this works . for that reason , i would really appreciate any code examples on how to realize my problem . thanks in advance 😄 < code >
when working with c interop , it 'd be nice to declare a c function directly as a v function . instead of having to type c. a dozen times for a basic but vast api , can be tiresome . so i 'd like to propose this : especially when creating library wrappers , this would be very helpful ! < code > # include < myapi.h > module myapi_bindings [ import : `` myapi_something '' ] fn myapi_something ( int , int ) int
i often feel the need of stepping in the history while trying something out in the repl . it would be great if the repl supported the up- and down arrows to step backwards and forward in the history like python 's repl . right now it seems like [ [ a and [ [ b is n't handled at all . i guess this would need to be implemented by extending readline to support syscalls ( or create a separate keyboard package for events ) . < code >
will v support generic methods as function paras ? < code > // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * struct foo { pub mut : name string } fn ( mut foo foo ) from ( src string ) { foo.name = src + `` is foo '' } struct bar { pub mut : name string } fn ( mut bar bar ) from ( src string ) { bar.name = src } // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * struct reader { pub mut : objects [ ] string } type callback = fn < t > ( string ) t fn ( reader & reader ) iterate_generator < t > ( f callback ) [ ] t { mut typs : = [ ] t { } for obj in reader.objects { typs < < f ( obj ) } return typs } // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * fn my_callback < t > ( src string ) t { mut typ : = t { } typ.from ( src ) return typ } fn main ( ) { mut r : = reader { } r.objects = [ 'foo1 ' , 'bar1 ' , 'foo2 ' ] bars : = r.iterate_generator < bar > ( my_callback ) }
i have to implement a parser for json ( returned by rest api calls ) , which is complex , deeply nested and whose structure is not known at compile time . how do i go about doing that ? < code >
this will allow us to see which functions are implemented for a particular platform or a set of platforms . also , it will point to the source of the platform 's implementation of the function . edit : see kotlin docs for inspiration . < code >
using __has_include is a neat way to discover headers - but not reliable . it 'd be nice to be able to turn the usage of this off entirely . modify this : < url > and query for another define , i.e . v_no_has_include . < code >
i saw a language called nelua and it generates surprisingly small c files ( ~60 loc for hello world ) . v also needs to output small c files , it would be a lot faster ! < code >
tldr ; please help point me to a file in the codebase that will give me a hint as to how the pl is put together . basically how the compiler is organised together . so i saw v for the first time many months ago and the fact that it 's syntax is a blend of my two favourite languages , golang and rust is just captivating . i would always swear i 'd come back to make a pr but work has been really intense . well i am ready to take that bold step in contributing to v and the first thing on my list is understanding how pls are put together entirely . v is my case study particularly because of its fast build . would love to know what makes it tick . can anyone here point me to the location of the codebase where i can kick off my dreams ? < code >
is this the place to ask dumb question ? i could n't find a function to register a callback on file system change ( file change , moved , etc ... ) can maybe someone point me towards it ? < code >
some methods like .index and .contains are autogenerated during cgen , and not present in source code form . this presents a discoverability problem , because tooling like v doc builtin and vls ( which work over the ast , before it is passed to cgen ) will not see them , and thus not produce information about them . how should v handle this problem ? < code >
embedded struct method is very nice feature . then , what about this ? the button should be as implemented or not ? this should be allowed or not ? < code > interface measurable { width ( ) int } struct widget { mut : left int right int } fn ( w widget ) width ( ) int { return w.right - w.left } struct button { widget text string } fn main ( ) { mut button : = button { text : 'click me ' widget : widget { 10 , 20 } } assert 10 == button.width ( ) mut measurable : = [ ] measurable { } measurable < < button // error : 'button ' does n't implement method 'width ' }
i keep wondering why languages insist devs start array indexing at zero . i understand it has to do with optimizing the calculation of the offset in an array to access elements randomly ( avoiding a -1 operation each time ) . but could n't the compiler take care of that -1 operation ? something similar about the `` .. '' in `` for i in 0 .. 5 '' ( excl . upper limit ) . why not do the same as the `` ... '' ( incl . upper limit ) in the match statement ? or why not simply also allow the `` ... '' with for ? to me these seem like some underlying technical problem bleeding thru to the 'user ' . < code >
while vfmt uses a sophisticated algorithm to perform automatic line breaks the decision where to break a complex expression often does not satisfy the expectation of the programmer . suggestion : just use the break positions that are given by the programmer for expressions . < code >
short field docs are behind the field . but what about long comments ? last discussion with alex was about moving it above if the comment is too long . does vdoc already handle this ? < code > struct bar { foo string // foo does something . } struct bar { foo string // foo does something . // milk is different from foo because the comment is too long to put it behind the field . that 's why it 's on above the field . milk milk }
i had an error like that with vui where i had not set the state . i could not figure out why it was n't working , as the callback function was getting called , but the first function that function called caused the panic . by chance , when scrolling through the logs i noticed window ( ) state =0x0 , so i eventually figured it out . it would of been easier if i had seen the address . maybe it could be enabled/disabled through a compiler flag . < code >
could we have something like vbin path where v modules can be compiled to ? it would make something like installing vls a lot easier for the user . by just doing v install vls and use it with vls from the command line . that means that < cur > vmodules/bin needs to be added to the path . and we need something that vpm knows to compile the downloaded source . go has go get and go install < url > < code >
we have the [ required ] struct field attribute , but it 's not mandatory . as the result , struct fields with reference types can be uninitialized and result in segfaults . same with map [ string ] & type new optional syntax for map.get ( ) it 's not required for primitive types ( ints [ 'bad_key ' ] will still return 0 ) , but it will be required for reference types . < code > m [ 'key ' ] or { println ( 'not found ' ) return }
the goal is to never have segfaults due to calling uninitialized callbacks . struct fields that have function types must be initialized . uninitialized function types can be achieved with optionals : similar to swift 's usage : or maybe the current syntax < code > struct foo { callback : ? fn ( int ) string } if x : = foo.callback { x ( 10 ) } struct foo { var callback : ( ( ) - > ( ) ) ? } if foo.callback { foo.callback ( 10 ) }
as of this moment , there are a lot of c. < whatever > calls sprinkled throughout regular .v files in vlib . this code needs to be separated so that c. calls are in .c.v files . it would be really nice if the compiler also gave errors ( warnings to start , perhaps , until everything has been separated properly ) if any c. calls were to show up in plain .v files in the future . < code >
current time dones n't have timezone info . but i think time should have timezone info e.g . : in golang , time has timezone as location . < url > < code >
it would be nice to have something like c 's alloca : < url > alloca is not portable , but it could be supported just for c compilers that have it . c99 variable length arrays is a standard feature but i think it was made an optional feature in later standards . msvc has malloca which requires freeing with freea . this combination could also solve portability issues because it can fall back to heap allocation on systems without runtime stack allocation . < code >
vls needs an option that the parser takes care of new lines . example : from user perspective those are two stmts : k : = lsp . and println ( `` ) but the compiler sees it as k : = lsp.println ( `` ) and shows errors the user ca n't understand . also what happens : if there is a syntax error on a position , all tokens ( are nearly all ) after it have errors . the difference between vls and cli is that cli only shows one parser error while vls shows all . this results in weird errors after the root cause . maybe there is also another solution than taking care of new lines < code >
maybe a bug or a feature request i tested raven_text_rendering.v , when adding chinese utf-8 chars to the text , the chinese chars are empty . i changed font_path to some chinese fonts , e.g . < code > font_path : '/system/library/fonts/stheiti light.ttc ' font_path : '/users/seven/downloads/notosanscjk-demilight.ttc ' ' both english fonts and chinese fonts are empty . also , i thin the 'font_path ' should take an array so it 's possible to load both english and chinese fonts . thanks .
maybe the result should be ( u64 , int ) , the first value indicating the parsed value , the second one the position of the first unparsable character index ( or for simplicity -1 if everything was fine ) ? how otherwise you would know that the provided string is not parsable ? < code >
we can a reserved word as flag this is managed by the compiler as instead 0,1,2,3,4. the variable defined as is managed by the compiler as : typedef textalign byte|u16|y32 ... according to the number of flags . and we can check the flags with the match statement as which is transformed by the compiler as : instead the usual enum ( if align == .left ) the cost is very low , similar to the enum management but make very simple the management of flags/states . traslating all the ugly work to the compiler . is it possible ? < code > flag textalign { left right center top middle bottom } match alin { .left { } .right|.middle { } else { } } if ( align & textalign.left { } align textalign enum textalign { unset = 0 left = 1 < < 1 right = 1 < < 2 center = 1 < < 3 ... }
i imagine something like this it could be useful if you want to have some platform-specific constant settings , like a filepath . < code > const ( foo = < cur > if linux { 'lnx ' } < cur > else < cur > if windows { 'win ' } < cur > else < cur > if macos { 'mac ' } < cur > else { 'other ' } )
separately from built-in parallelism & concurrency ( i.e . backend ) is the topic of apis ( i.e . programmer-facing `` front end '' ) . hereby i 'd like to ask for interest in parallel iteration api like e.g . rayon uses ( see also < url > ) , but built in to standard v library ( imagine e.g . parallel iteration over any array ) . of course , such api must be seamlessly compatible ( i.e . complement & enhance ) all the built-in parallelism primitives ( including go routines & channels ) . note , this might complement ( or even conflict ) with iteration approaches e.g . weave uses . so keep that in mind and take a thorough look first . just for clarification , i do n't want any syntactic support , but just api . < code >
< url > all test functions have to be placed in * _test.v files to run the tests do v hello_test.v to encourage better maintenance , v could support defining a test function following a symbol in the same file . otherwise the coder will forget ( or not bother ) to update the test , because they do n't see it when working on a file . then to run tests in a file , use something like v -test hello.v . edit : this is also important for testing examples in documentation , see below . < code >
version 1 - new file method version 2 - new syntax - similar to iterating over an array < code > for { line : = f.readline ( ) or { break } // ... do something with line } for i , line in f { // ... do something with line } for line in f { // ... do something with line }
currently you declare vweb.run < app > and use handle_conn < t > ( ... ) inside the vweb . that handle_conn function translate to c function like this vweb__handle_conn_main__app most of the event loop library use callback to trigger when message arrived , so you need address of that function . current syntax does not allow to get generics function like & handle_conn < t > without the call with bracket ( ) . if you allow the syntax and generate the code same as & vweb__handle_conn_main__app , that would be perfect . ( i got good numbers with pico with vweb , and performance are very close with raw and it is lacking only that functionality . - < url > ) < code >
is there already a mechanism , or is there any chance of adding one liner support to vlang , e.g . similar to other languages where a source file does not need to be specified ? < code > < cur > perl -e 'printf qq [ hello world ] ' hello world
if we do n't want # 5835 , there are 2 simpler things we can do to help make sum type handling and optional handling more similar : if val : = opt { was only documented last week in # 5838. we could change the syntax to use as for consistency with if sum is t as var and match sum as var : or for sum type instances : < code > if opt as val { var : = sum is t or {
it would be very nice to allow something like this : this imply the use of type abc before its complete definition . i would add method definition inside structs after all fields have been declared , as shown above . this would greatly simulate oop without changing the language < code > struct abc { name string // all other fields fn ( a abc ) is_empty ( ) bool { return a.name.len == 0 } // all other funcs }
this code is very repetitive : alex has a feature for a safer sum as type that ca n't panic , requiring if : this could be extended to allow making sum a subset of its allowed types ( i 'm just showing 2 here ) : assertstmt | assignstmt is a sum type literal . each type must be listed in stmt or it 's a compile error . return stmt.pos can work by lowering to : if one of the types does n't have a field called pos , then the lowering would naturally fail to compile , using the existing code in checker.v . calling a method on a sum type instance can work with similar lowering . < code > pub fn ( stmt stmt ) position ( ) token.position { match stmt { assertstmt { return stmt.pos } assignstmt { return stmt.pos } comment { return stmt.pos } compif { return stmt.pos } constdecl { return stmt.pos } ... else { return token.position { } } } match stmt { assertstmt { return stmt.pos } assignstmt { return stmt.pos } } if sum is t { // typeof ( sum ) is t here } if stmt as assertstmt | assignstmt { // here stmt is known to only hold one of the above types return stmt.pos } return token.position { }
reason afaik , if you want to run code on a seperate thread , you have to put this code into a function . i think it would improve things if there were `` go blocks '' like this : because then you would n't have to create a function for every thread you have . < code > go { / * code here * / }
can orm query have a special character for variables like ' @ ' which is used in web templates ? let 's say we have the situation if i want to select all users with/without team filter i can do this teamid : = web_post_form_value // 0 - not set ; positive value for a specific team right now , without prefix character it is confusing what is columns , what is variable . the code will be more clear and with less bugs . < code > table [ user ] { id int name text teamid int } users : = sql db { select from user where ( @ teamid == 0 || teamid == @ teamid ) }
if you care a whit about internationalization ( i18n ) , force your code to run under the turkish locale as soon as reasonably possible . please add localized case folding support like golang : go case folding < url > < url > i can suggest test code below for turkish . vlang has a dreamy syntax and features . i have no doubt that the turks will be very excited when they discover this language . you do n't want to deprive them of this feature : ) < code > fn test_turkish_case ( ) { lower : = 'abccdefgghijklmnooprsstuuvyz ' upper : = 'abccdefgghiijklmnooprsstuuvyz ' for i , c in lower { assert c == upper [ i ] } }
currently , when v installs dependencies , it only allows for packages to be installed globally . this differs from other package managers like npm ( i think ) and cargo which default to downloading and building packages in the current project folder . i propose adding a way to specify local dependency/package installation in the .mod file of the project and when using v install as an optional flag . this will still have packages install globally as the default behavior ( like it is now ) but will add similar functionality to other languages ' package managers and dependency resolution features . < code >
hi , are there plan to have stream support ? especially when come with os.exec , we need a way to stream read output or even write to input for exec < code >
i notice many people miss the minus indexing feature in other languages such as python . however , alex does n't like this because it 's error-prone . yes indeed sometimes . so i 'm thinking about using a symbol other than minus ( - ) to indicate indexing from last . say we use # . and there 's a bonus . i notice some want last element to be -0 rather than -1. we know this is not a good idea for the old minus ( - ) system because -0 and 0 are numerically equal . but by applying the new # system this could be solved - 0 is different from # 0. do you like this idea ? if so , do you like # to be the symbol ? do you prefer the last element as # 0 or # 1 ? btw i personally prefer last element to be # 0. because when considering backward indexing you can still assume it 's the more familiar forward indexing , and finally add a # . very easy . < code > // v - i prefer this . arr [ # 0 ] // last element arr [ # 1 ] // second from last arr [ # 4 .. ] // five elements from last // v arr [ # 1 ] // last element arr [ # 2 ] // second from last arr [ # 5 .. ] // five elements from last # python arr [ -1 ] # last element arr [ -2 ] # second from last arr [ -5 : ] # five elements from last
on linux , there is different libc such as musl and glibc , and diferent libc are not compt , but syscall are relative stable . < url > < code >
for those hungry after speed , i 'd recommend recent observation why finally `` correctly '' implement quicksort ( in pure c - without any assembly - with very short code base - about 3x as minimal quicksort - but leveraging modern cpu pipelines ) , despite being unstable , still matters and why mergesort/heapsort ( and their variants - e.g . quadsort ) ca n't beat it for primitive values/types : < url > ( note the linked quadsort above seems still slower than the mergesort implemented in the above-linked blog post ) < code >
it is very common to have the need to create a function that returns the enum value given the string . this is usually done by the programmer in c , but other languages provide a way to do that . i think it will be good if v could autogernate this function as long as it have .str ( ) implemented : this program prints 'foo ' . but there 's no way to get foo.foo from 'foo ' . my proposal here is to treat enums as functions like this : < code > fn main ( ) { a : = foo ( 'foo ' ) assert ( a == foo.foo ) println ( ' < cur > a ' ) } enum foo { foo bar } fn main ( ) { a : = foo.foo println ( ' < cur > a ' ) }
current : suggested : i would suggest that by making all muts act as if they were pointers and values otherwise . this would reduce cognitive load and code . the ptr `` & '' syntax could be eliminated ( mostly ) . this might help towards # 41. thoughts ? < code > mut m : = sync.waitgroup { } a : = m // m is duplicated z : = somestruct { wg : m } // m is duplicated and requires & , trap for new players somefunc ( m ) // & m is passed mut m : = sync.waitgroup { } // m = & sync.waitgroup a : = m // a and m share same data z : = somestruct { wg : m } // z.wg and m share same data somefunc ( m ) // & m is passed
looking through v 's source files , the naming convention does n't seem entirely consistent . while i 've mostly seen snake_case , i 've also seen kebab-case . it seems to be a point of contention in go . so now would be a nice time to use and document a convention . notable comment from the linked go issue above : a short new section on codereviewcomments is more than sufficient . example : there is a de facto standard for v source file names : all lowercase with underscore separation when necessary , i.e . snake case . thoughts ? edit : most of the snake case violations happen in v/cmd/tools/ < code >
v version : v 0.1.27 28ffe2a.7e538d7 os : macos 10.15 what did you do ? what did you expect to see ? what did you see instead ? < code > const ( < cur > if macos { a = 1 } < cur > else { a = 2 } ) fn main ( ) { eprintln ( ' < cur > a ' ) } test.v:2:2 : error : unexpected ' < cur > ' , expecting 'name ' 1 | const ( 2 | < cur > if macos { | ^ 3 | a = 1 4 | } < cur > else { macos < cur > 1
with many ongoing discussions and requests of javascript and webassembly support for v and the misunderstandings that it does n't exactly exist yet ( or a clear path does n't yet exist ) , i believe it is important to have a semi-formalized discussion and presentation of this information for v. should we put something on the main site and / or within the readme.md ? there is ongoing discussion in discord . and @ prime31 has shared what works for him : for vs code users this task will get wasm going for you ( pretty_c can be slow if you 're codebase if over 20 - 30k lines so drop it if you dont need it ) : any thoughts on formalizing this information and making it all more clear and convenient to inbound v learners and contributors ? < code > { `` label '' : `` v generate c ( webgl ) '' , `` type '' : `` shell '' , `` options '' : { `` cwd '' : `` < cur > { filedirname } '' } , `` command '' : `` v -pretty_c -d webgl -o < cur > { filebasenamenoextension } .c < cur > { filebasename } & & cat < ( echo `` # include < emscripten.h > '' ) < cur > { filebasenamenoextension } .c > wasm.c '' , `` group '' : `` build '' , `` problemmatcher '' : [ ] }
i am using windows 7 32 bit and i want to know why v simply not work on 32 bit windows . is there any old version which is posible to compile on win 32bit os ? you must explain which c compiler you use for compiling is that mingw ? < code >
something to consider at some point : is it possible to make a crash handling / recovery system similar to erlang in v ? there are various things to consider from conversations in discord : here : < url > and here : < url > < code >
v is looking really promising . i understand that v is intended to transpile into multiple target languages ( at least c & js ) ? quickly scanning the language i was wondering how you intend to generate low level constructs like `` goto '' into languages like js ? i could imagine that most of v could be compiled into good looking js code but some features like goto are hard for me to imagine to generate human readable/understandable js code . will all language features be available for js target ? < code >
coroutines ( go ) or promises ( js ) futures ( rust ) can provide hundreds of thousands of concurrent services on the server side channel sending data between threads or coroutines < code >
now v has very useful arrays and ( hash ? ) maps . should v support other commonly used data structures as built-in types ? for example linked list , stack , queue , heap ( priority queue ) , binary search tree , graph , and even data table ( like dataframe in python ) ? < code >
v version : v 0.1.24 436603a os : macos 10.15 what did you do ? build a program or chk if the deps are installed what did you expect to see ? < cur > v check . return 0 or 1 depending if we need to do v install . what did you see instead ? network requests and more than 1s of wait to finish the v install .. line < code >
v version : 0.1.24 os : - on playground what did you do ? a struct can not be defined inside any function works but does n't work what did you expect to see ? 4 4 what did you see instead ? could not find method x 2| struct point { x int y int } < code > struct point { x int y int } fn main ( ) { p : =point { x:4 , y:4 } println ( p.x ) println ( p.y ) } fn main ( ) { struct point { x int y int } p : =point { x:4 , y:4 } println ( p.x ) println ( p.y ) }
i was quite happy to see added support recently for enum flags in # 3025 , i think there are a couple more tweaks that could be made to improve usability . many other languages implement all and none for flags , so instead of having to check each flag , being able to do something like : would be really nice . even nicer would be bitwise operations on flags : etc . < code > flags & = ~tensorflags.write [ flag ] enum tensorflags { contiguous fortran owndata write } flags.has ( .all ) flags.has ( .none )
v version : v 0.1.23 f7c1b78 os : macos what did you do ? attempted to define a v struct to match the c struct below : what did you expect to see ? some way to be able to define the c struct in v so that we can access the c code . the following does not work : what did you see instead ? < code > next token = ' { ' bug.v:14:5 : syntax error : unexpected 'struct ' , expecting 'name ' 12| struct c.hmm_vec3 { 13| struct 14| { ^ 15| x f32 16| y f32 struct c.hmm_vec3 { struct { x f32 y f32 } struct { u f32 v f32 } } typedef union hmm_vec2 { struct { float x , y ; } ; struct { float u , v ; } ; struct { float left , right ; } ; struct { float width , height ; } ; float elements [ 2 ] ; } hmm_vec2 ;
every .v file in vlib/ should use one type of license instead of multiples as seen in < url > < url > and < url > even some files do n't have any license . i suggest using something like how go does it i.e . // copyright 2011 the go authors and contributors . all rights reserved . // use of this source code is governed by a bsd-style // license that can be found in the license file . and have a separate file contributors.md for list of contributors . what you guys think ? < code >
now this would not work : because sort ( ) requires mutable receiver . you have to do : i think it would be good if objects ( structs , arrays , primitives ) returned from the funtions would be treated as mutable by compiler until they are assigned to some immutable variable . this way it would enable method chaining independently of the mutability of the receiver of the method . could it be that method returns an immutable object ( like the same immutable receiver it works on ) , and then this proposed change would allow to change the immutable object ( that should never happen ) ? is there some better way to enable that ? indicating if the returned object can be mutated of not ? < code > fn ( m map ) keys ( ) mut [ ] string { ... } pub fn ( s mut [ ] string ) sort ( ) [ ] string { s.sort_with_compare ( compare_strings ) return s } fn main ( ) { m : = { ' b ' : 1 ' a ' : 2 } for k in m.keys ( ) .sort ( ) { println ( m [ k ] ) } } fn main ( ) { m : = { ' b ' : 1 ' a ' : 2 } mut k : = m.keys ( ) for i in k.sort ( ) { println ( m [ i ] ) } }
please add support to vectorial ( parallelized ) instructions with something like in julia lang with it 's `` . '' dot-syntax this opens opportunities in hpc/gpgpu/ml where this is very useful for simd optimization . also include some syntax/keyword to enable such features being complied like declaration to cuda < < > > non std c syntax being generated when compiled/translated to/from cuda , hip/opencl < code >
< url > < url > < url > ) < url > ( < url > ) < url > ( < url > ) < url > ) is there any stable tool now in compiler that can do translate and intergate from above projects into vlang infrastructure ? < code >
allow local flags declaration in function arguments - imagine something like : ( < cur > flag1 < cur > flag2 < cur > flag3 are choices where exactly one must be given whereas < cur > flaga < cur > flagb < cur > flagc are true flags allowing any ored combination of them , but at least one of them ) except for avoiding most separate enum declarations ( requiring among the code clutter also each time a good descriptive but globally unique name ) , take a look at more interesting use cases this allows : < url > ( source code for the compile-time checked templating engine ) in the end general interfaces look much cleaner and are `` kind of easier to use '' ( e.g . .trim ( < cur > space ) instead of .trim_space ( ) ) . this everything goes hand in hand with default argument values and assumes they 'll be supported . < code > fn f ( x < cur > flag1|flag2|flag3 , y < cur > flaga ; < cur > flagb ; < cur > flag ) ...
currently in the repl can only be converted to str and then printed , which is very difficult . and , i want to be able to add a value function that can see all the properties , just like in python dir ( ) i hope to solve the problem of putting the cache file under /tmp when running the file . otherwise , the cache file will be added to git when compiling . this is too uncomfortable . < code > > > > import os > > > dir ( os ) > > > import http > > > http.get ( ' < url > ) > > > fc : = http.get ( ' < url > ) > > > println ( fc ) .vrepl.v:4 ' ? http.response ' needs to have method 'str ( ) string ' to be printable
hi , for mr. alex , would like to add * * /bin * * directory binaries , such as compiler , web framework , vlang foramt , and so on . < code >
core/packages/runtime-dom/types/jsx.d.ts line 461 in 0c7fd13 checked ? : booleanish | any [ ] | set < any > // for ide v-model multi-checkbox support checked ? : booleanish | any [ ] | set // for ide v-model multi-checkbox support but < url > said v-model can assign any value . ex : 'yes ' is this bug ? < code >
if we update to vue 3.2.35 or later , vite ( dev server ) fails with errors like this . the component is different every time , and the unexpected token is usually pointing to the middle of a word or a space . i think the position ( 1:89 ) is pointing to a position in generated code , rather than the file indicated . vite build works without any problem . downgrading back to vue 3.2.34 resolves the issue too . i want to file a bug report , but it insists on a minimal reproduction and despite spending some time on this , i have n't been able to find one . < code > [ vite ] internal server error : unexpected token ( 1:89 ) plugin : vite : vue file : [ ... ] 1 | < script setup lang= '' ts '' > 2 | import { computed , ref } from `` vue '' ; 3 | import { useapifetch } from `` @ /api '' ; | ^ at instantiate ( ... /node_modules/ @ babel/parser/lib/index.js:72:32 ) at constructor ( ... /node_modules/ @ babel/parser/lib/index.js:358:12 ) at object.raise ( ... /node_modules/ @ babel/parser/lib/index.js:3341:19 ) at object.unexpected ( ... /node_modules/ @ babel/parser/lib/index.js:3379:16 ) at object.getexpression ( ... /node_modules/ @ babel/parser/lib/index.js:12234:12 ) at object.getexpression ( ... /node_modules/ @ babel/parser/lib/index.js:11164:18 ) at object.parseexpression ( ... /node_modules/ @ babel/parser/lib/index.js:16575:17 ) at processexp ( ... /node_modules/ @ vue/compiler-sfc/dist/compiler-sfc.cjs.js:4979:30 ) at array.compilerdom.transform.nodetransforms ( ... /node_modules/ @ vue/compiler-sfc/dist/compiler-sfc.cjs.js:4949:45 ) at traversenode ( ... /node_modules/ @ vue/compiler-core/dist/compiler-core.cjs.js:2162:41 )
as the title suggests , i 'm just trying to do something like this : but i keep getting a static value ( from the first-ever call to that computed ) . any thoughts on this ? just to do a quick check , i tried adding a rand number , but still no good , something like : computed : { datenow : function ( ) { return date.now ( ) + math.random ( ) } , } < code > computed : { datenow : function ( ) { return date.now ( ) } , }
i am working on dynamic color on my project . so i was succeed to store variable on env and passed on vue.config.js in order to render scss color variable from env variable . but i got into problem when i had to render color value from api since api send color variable as a object . so is it possible to pass object on scss prependdata as a object ? i had also asked same question on stack over flow . u can visit stack over flow for full detail i had attach link below : < url > can any one suggested me what shall i do ? < code >
this is my first project with vue and i do n't have any vue related experience before . through this project , i really got started with vue , and i want to share it with everyone . this project uses : naiveui : the ui library used in the project , i think it is the best ui library based on vue3 . pinia : used when changing themes . router : every tool entry is lazy loaded . wasm & web worker : trying to load wasm modules in the project via worker proved to be easy . vercel : used to deploy the project . preview link : < url > this project is inspired by devtoys and one tooling . < code >
hello guys , i have a some problem with the slots in setup context . when i use v-for to render component in parent slots , i ca n't get those components in parent setup context slots . is there something wrong with my code ? i want get slots components props to do something , is there other solution ? plz~ < code > setup ( _props , { slots } ) { const getslotscomponents = ( ) = > { const children = slots.default ? . ( ) return children } ) }
i was wondering if vue can use ref or computed to not use the value property . sample : < code > // if would be awesome if i can use ref automatically instead of adding a value property cons mydata = ref ( 'this is data ' ) ; onmounted ( ( ) = > { console.log ( mydata ) // like this not adding .value } ) ;
in server-side rendering ( ssr ) , beforeunmout and unmounted hooks do not occur ( link1 , link2 ) . if you unmount ( ) the app , the beforeunmout and unmounted hooks do not occur . is n't this a bit of a problem ? this is because , in the beforeunmount hook , code for the purpose of freeing memory can be executed . in the client , it may be possible to use the createapp ( ) function , but since this function emptys the html of the container ( code1 ) , it is not appropriate because the html content disappears for a while and then appears . when the client creates an app through the createssrapp ( ) function , it seems appropriate to generate the beforeunmout and unmounted hooks . what do you think ? link1 < url > link2 < url > code1 - createapp ( ) core/packages/runtime-dom/src/index.ts line 102 in c03459b container.innerhtml = `` < code >
for example about a custom directivev-form it can help us to use v-model , then we can use function expression and bind v-model to another context directive component useform as same as < input v-model= '' model '' / > , it can be transformed into we can add other directives to the components which bind with custom directive . < code > export function useform ( ) { const onchange = ( fieldname ) = > { // do somework when change } const register = ( fieldname , options ) = > { const model = ref ( ) watch ( model , ( ) = > { onchange ( fieldname ) } ) return model } return { register } } < input : value= '' model '' @ input= '' ( e ) = > model.value = e.target.value '' / > < script setup > const { register } = useform ( ) < /script > < template > < input v-form= '' register ( 'username ' , { required : 'username is required ! ' } ) '' / > < /template > export function formdirective ( el , binding , vnode ) { const model = binding.value // ref vnode.props = { modelvalue : model , 'onupdate : modelvalue ' : ( value ) = > model.value.value = value } } // main.js app.directive ( 'form ' , formdirective )
hello vue community , it 's awesome to see discussions being opened , and i look forward to seeing everyone 's projects . i 'll kick things off with the project my team and i have been working on for about 2 years , the dive annotator . github repository : < url > documentation : < url > more screenshots : < url > stack : vue 2 , vuetify , typescript , d3 , geojs about dive we built dive as the user interface for the viame toolkit . it 's a pretty sophisticated annotation and analysis tool for images and videos , and it 's being used by noaa and others to train and run ai on data collected from aerial surveillance and underwater uavs . we 've built it for both web and electron . we 've really pushed against the limits of reactivity performance , sometimes dealing with tens of thousands of reactive entities on the page , and we 've had to rely on optimizations like shallow reactivity where possible and using proxy variables to indicate when a deep/complex object changes . even though we 're still on vue 2 , we 've completely adopted vue composition api plugin . vue has been a real pleasure to work with , and it will be part of our team 's toolkit for a long time to come . thanks for all the great work that has allowed us to build high-quality software for our users . < code >
version 4.1.3 browser and os info firefox 59.0b8 steps to reproduce read readme attempt to use vue dev tools on site with strict csp headers check console for errors : content security policy : the page 's settings blocked the loading of a resource at self ( `` script-src '' ) . source : ; ( function ( e ) { let t= { } ; if ( e.hasownproper .... page:1 content security policy : the page 's settings blocked the loading of a resource at self ( `` script-src '' ) . source : ; ( function ( e ) { settimeout ( ( ) = > { const n=do .... page:1 content security policy : the page 's settings blocked the loading of a resource at self ( `` script-src '' ) . source : ; ( function ( e ) { let n=null , t=0 ; const o= { no .... page:1 re-read readme.md hoping that requirement to inject scripts in this way is documented somewhere relax csp headers to allow unsafe-inline vue devtools start working what is expected ? dev tools should operate without having to compromise on site security by allowing inline scripts if this is n't technically possible , this incompatibility should be documented clearly in the readme what is actually happening ? dev tools can not detect running vue instance < code >
hello , i 'm making this discussion because i encounter an issue with the new devtool on vue3 , but i do n't have any way to reproduce this , so i wo n't make an issue about it sometimes , for no reason , components stop appearing in the components tree , it 's either blank , or with a few components , but not all the tree , sometimes child components are displayed but not their parent components , which does not make sense since it 's a tree as a side note , i 'm also annoyed by anonymous components , because i ca n't see children components who are not anonymous do you encountering this issue and have you any way of reproducing it ? thanks . < code >
( cross-posted here : vuejs/pinia # 1111 ) not sure whether this is a pinia or devtools issue : when i view the store in the pinia panel a property of type map is not editable : i am not offered the pencil icon only `` copy value '' / '' copy path '' . is write-access to pinia state properties of map type not implemented ? < code >
hello , this morning , i have an error message while using devtools and i realize that there was an update overnight : uncaught ( in promise ) typeerror : options.version is undefined backend.js:949:32 could you tell me what i need to do to resolve this situation . thank you < code >
version 6.0.0-beta.21 browser and os info windows 10 , chrome steps to reproduce i have disabled the timeline option in vuex ( plugin options ) but it still shows the timeline . what is expected ? the timelink is hidden or can be removed ( or resized or even dragged to another position ) what is actually happening ? vuex timeline is still there < code >
hello ! i have a question , thank you for your time . in vue3 , if the child component of keep-alive was selected , it still shows old state on the devtools panel after i changed some data of the component . the reason is that new instance called mounted but the old instance of keep-alive components called deactivated without unmounted during hmr . i think that is designed correctly but it just triggered the event component : added without component : removed in devtools , which means the old instance was still stored in instancemap and the old state was shown because the selectedid was not changed . it took up space and make old state show as a consequence , so is it necessary to remove the old instance , or stay them here ? < code >
version 4.1.4 browser and os info chrome 68 / xubuntu 16.04 steps to reproduce using the following code : what is expected ? message events are pushed through my event bus and do n't crash the app . what is actually happening ? any message posted to the window now gets looped by vue devtools , as it is trying to track the events fired on the event bus and appears to be using messages to do this . i am using this to allow communication between an iframe and my main vue application . i am willing to work around this by checking for something specific in the message data which my app will always use but it 's a bit of a pain and restricts how i can use it . is there a better way i can blacklist devtools messages , rather than whitelisting specific messages ? < code > let bus = new vue ( ) window.addeventlistener ( 'message ' , function ( e ) { bus. < cur > emit ( 'message ' , e.data ) }
due to some dependency missmatches i need to downgrade vue-cli to a version that has webpack 4. i managed to downgrade vue-cli from 5 to 4.5.17. unfortunately i still seem to have webpack 5.73.0. can anyone help here ? < code >
hi all ! hoping for a little help . i just recently switched to using vue-cli 5.0.3 with webpack v5 . i have a web app that is throwing a `` exports is not defined '' error from within one of my node dependencies . the interesting thing is the error only occurs when i build with node_env set to test or production . all works fine with development builds ; no errors . any idea how i can fix this ? < code >
i 'll make my question short ! i write this in my * .scss file : after i run yarn build i get this in my * .css : but , i do n't want first / in url : i use vue-cli-serice to build a component library and when i use this library in a nuxtjs project , my images did n't load because images address are relative and did n't read from /dist/img/ in my package in my node_modules < code > background-image : url ( `` ~ @ /assets/images/logo-en.svg '' ) ; background-image : url ( img/logo-fa.ad1b8dbc.svg ) background-image : url ( /img/logo-fa.ad1b8dbc.svg )
i am trying to run npx @ vue/cli create test from python ( using popen ) in an effort to generate vue projects for automated testing . what i would like to do is create a vue preset and then specify that preset on the command line . how do i specify the vue preset on the vue cli command line ? < code >
i am sorry if i did not phrase the title well because i am at a complete lost of what the technical terminology is and really how to search for an answer . this was not an issue until i updated google chrome to version 99.0.4844.51. this is also an issue in window 's edge , but not firefox 97.0.2 dev tools . i have a fairly standard multi-page vue 2 app . i am trying to debug an issue and in the chrome devtools , not vue devtools , i used to be able to see the source code of a single file component and step through methods etc . on the left hand side in the chrome devtools source tab there is the page tab . in the webpack : // folder you have four sub folders one of those is src . it lists my .vue files but instead of showing the typical template , script , and style code sections it shows the following . a list of imports and a hot reload . i am not sure what changed with the chrome based devtools . is there a new setting in chrome or something ? if you can make suggestions on how to phrase my question better please advise . thanks for your patience and understanding . via : stackoverflow < code >
in our project we use export-loader like this to import old modules : import { something } from `` exports-loader ? exports=component ! somefile.js '' ; the project has been set up using vue-cli . running jest i get something like can not find module 'exports-loader ? exports=component ! somefile.js ' from 'testedcomponent.vue ' how can i make this work ? ideas appreciated : ) < code >
hi ! i 'm trying to install vue cli in a m1 mac trying node versions 10.13.0 and higher and i 'm getting this error every time . from what i 've seen this version is still available in npm < url > does anyone know how to fix this ? < code > `` install '' `` -g '' `` @ vue/cli '' 11221 verbose node v10.13.0 11222 verbose npm v6.4.1 11223 error code e404 11224 error 404 not found : colors @ ^1.1.2 11225 verbose exit [ 1 , true ]
we have the command vue upgrade to get the latest version of the first-party vue-cli plugins , e.g . @ vue/cli-plugin-babel . but , there are many other necessary dependencies in a typical vue-cli project , such as eslint , sass , sass-loader , typescript , vue-jest , etc . i can simply use npm-check-updates to upgrade all packages to their most recent version , but that causes tons of compatibility errors when building . i 'd love to be able to call vue upgrade with a special flag to upgrade all related packages to their most recent versions that are compatible with the vue-cli packages . though , i 'm guessing that would be difficult to implement . instead i 'll ask , is there just a simple list i can consult to get the latest safe versions ? something i can mindlessly look at to upgrade , without having to troubleshoot ( as i plan to be doing this multiple times over the years to keep my project up to date ) . perhaps that list already exists in the form of vue-cli 's package.json ? can i always assume that these are the latest packages i can safely install ? but then again , that file is missing some potential dependencies like sass ... related : # 6923 < code >
overnight , without any changes to package.json or yarn.lock , my build broke . i 'm currently using v5.0.0-rc.1 of vue-cli i remove node_modules and ran yarn install to replicate the issue on my dev machine . but now i 'm lost in how to resolve ( or report an issue ) . i 'm building a vue-based pwa , and have so far not configured webpack directly - rather relying on the vue-cli plugins to pull all that together for me . the results from vue-inspect have this plugin at [ 5 ] : when i dig into the library code , the plugin class does have an apply method . < code > new htmlwebpackplugin ( { title : 'cross-it-off-pwa ' , scriptloading : 'defer ' , templateparameters : function ( ) { / * omitted long function * / } , 'template ' : '/var/checkouts/websites/cross-it-off-pwa/public/index.html ' } ) , < cur > vue-cli-service build error validationerror : invalid configuration object . webpack has been initialized using a configuration object that does not match the api schema . - configuration.plugins [ 5 ] misses the property 'apply ' . should be : function - > the run point of the plugin , required method .
i created a project with vue cli just now , but when i execute git log right after creating it , it shows me a commit : it seems that vue cli performed this initial commit automatically for me . but i do n't want this . what i 'd like to know is , how to disable this feature ? < code > commit 66d530a1c6c551817da0bec3af2cae87c8917f93 ( head - > master ) author : xxx < < email > date : sun jan 23 12:04:43 2022 +0800 init
i have a particular need to be able to set different targets for babel-preset-env dynamically from my vue.config.js file . i am unsure how to do that . is it in the pluginoptions like so ? < code > module.exports = { pluginoptions : { ' @ vue/babel-preset-app ' : { targets : `` > 1 % , ie 10 '' } }
the following configuration worked for me with vue-cli/vue-cli-services 4 and webpack 4 : ( note : for webpack v5/cli v5 i 've updated output - > format ) this no longer works -- drop_console is not being respected . interestingly , the output of vue inspect -- mode production shows the following ( as a snippet ) : where the vue-cli-service v4 ouput shows : is this a bug ? is my configuration off ? has someone gotten this to work ? ? < code > minimizer : [ new terserplugin ( ... ) , { options { terseroptions : { < -- -- -- -- -- -- -- compress : { drop_console : true } } } ] minimizer : [ new terserplugin ( ... ) , { options { options : { compress : { drop_console : true } } } ] // relevent section of vue.config.js module.exports = { configurewebpack : { devtool : process.env.node_env === 'production ' ? false : 'source-map ' , optimization : { ... ( process.env.node_env === 'production ' & & { minimizer : [ new terserplugin ( { terseroptions : { output : { comments : false } , compress : { drop_console : true } , mangle : true , } , extractcomments : false , } ) , ] , } ) , } }
i 've created a project with vue-cli and added a few components but after i run this below script and publish dist to npm , i just can use 2 component in my nuxt project . i 'm not sure if i build my component right or wrong because i get many umd files ! < code > vue-cli-service build src/index.ts -- target lib -- name zarin -- modern & & rm ./dist/demo.html // src/index.ts // this file used to build component by vue-cli-service import { vueconstructor } from 'vue ' ; import * as components from './components ' ; const install = ( vue : vueconstructor ) = > { object.entries ( components ) .foreach ( ( [ name , component ] ) = > { vue.component ( name , component ) ; } ) ; } ; if ( typeof window ! == 'undefined ' & & window.vue ) { install ( window.vue ) ; } export default install ; export * from './components ' ;
i want to implement a pr that supports @ vue/cli-service @ 5 to load both vue.config.js and vue.config.ts does anyone have an opposing or agreeing opinion ? the effect will look like this 👇 i expect to finish it in this week the advantage of this feature is that the configuration file in the ts project is also vue.config.ts the dx will be better @ sodatea @ fangbinwei < code >
those utilising vs code 's formatting on save , have you come across the issue when trying to utilise multiple script tags ? a typical scenario : needing to set inheritattrs to false when using script setup . according to the documentation : < url > we 'd just utilise an additional script tag like : though if you have the following settings enabled in vs code : vs code automatically shifts the code inside the first script tag , and moves it into the second , resulting in : i 've spent hours trying to work out how to prevent this . is there a way ? has anyone else come across this issue yet ? < code > < script > export default { inheritattrs : false } < /script > < script setup > // all composition api code here < /script > < script > < /script > < script setup > // all composition api code here export default { inheritattrs : false } < /script > `` eslint.format.enable '' : true , `` editor.codeactionsonsave '' : { `` source.fixall.eslint '' : true }
i have a component , i do n't added lang= '' ts '' to the tag , because i do n't need it in this component , but still i got eslint lightning warnings in this file and also errors during compiling . how i can disable eslint for this files ? < code >
if `` public '' dir is removed - `` copy '' plugin not adding . its possible , or only add second `` copy plugin '' ? i was try : but got error : < code > config .plugin ( 'copy ' ) .use ( 'copyplugin ' ) .tap ( args = > { args = [ { from : path.resolve ( ' .. /src/static ' ) , to : path.resolve ( ' .. /dist ' ) , totype : 'dir ' } ] return args } ) error : can not find module 'copyplugin '
hello , i 'm trying to get information about the cli-plugin-pwa . i have a vuejs project using cli-plugin-pwa added by vue add pwa and i 'm facing an issue about service-worker.js on production . the issue is : my service-worker.js is reachable and contains : my initial service-worker.js is on the src/folder from the project . ii read the doc < url > and search on many tuto or forum but i do n't find any solution about this error . < code > error during service worker registration : typeerror : serviceworker script at < url > for scope < url > threw an exception during script evaluation . importscripts ( `` /precache-manifest.20a6ce74c24b125cc57f89fde8de5429.js '' , `` < url > ) ; if ( workbox ) { console.log ( 'workbox is loaded ' ) ; workbox.clientsclaim ( ) ; // the precaching code provided by workbox . self.__precachemanifest = [ ] .concat ( self.__precachemanifest || [ ] ) ; workbox.precaching.suppresswarnings ( ) ; workbox.precaching.precacheandroute ( self.__precachemanifest , { } ) ; workbox.core.setcachenamedetails ( { prefix : `` waterbrain '' } ) ; } else { console.log ( 'workbox did n't load ' ) ; } self.addeventlistener ( 'message ' , ( event ) = > { if ( event.data & & event.data.type === 'skip_waiting ' ) { self.skipwaiting ( ) ; } } ) ;
so i 'm using setups everywhere now that they 're available in vue , but there 's an extra step to do on my vue cli based projects . can this be added by default on all vue 3 with eslint ? < url > < code >
i have added `` @ vue/cli-service '' : `` ~5.0.0-beta.3 '' to the package.json of my typescript project . that one has ( among others ) dependencies to `` webpack '' : `` ^5.22.0 '' , `` @ types/webpack-dev-server '' : `` ^3.11.0 '' , according to `` npm list '' , the latter one depends on @ types/ < email > , and also in node_modules/ @ types/webpack-dev-server/package.json , i find a dependency to `` @ types/webpack '' : `` ^4 '' , so , i get webpack 5 via dependency , and webpack 4 via the other chain . i suspect that this might cause me having that problem : webpack/webpack # 12185 especially that comment : webpack/webpack # 12185 ( comment ) i must admit that i am relatively new to that infrastructure , so i might easily miss something fundamental ... nevertheless question : is that dependency situation intended ? < code >
i 'm trying to convert my app to ssr , i 'm following the example of the doc , but i have problem with this line : it 's says that ssr is not defined , how i can define this environment variable ? < code > `` scripts '' : { `` build : client '' : `` vue-cli-service build -- dest dist/client '' , `` build : server '' : `` ssr=1 vue-cli-service build -- dest dist/server '' , `` build '' : `` npm run build : client & & npm run build : server '' , }
i 'm just curious if there is a predicted date for 5.0.0 rc or ga. guessing beta 3 is n't quite there for a production app ( maybe it is ? ) . using 4.5.13 , we 've had to provide some funky package json resolutions for some packages to avoid long-deprecated versions as long as the newer package is backward-compatible enough for the use-case . this is not pretty . we 're also trying to avoid forking . < code >
hello , i need some guidance on investigating an issue i have running vue-cli-service serve . i have a weird issue where simply duplicating lines of console.log ( ... ) has the effect that the source code is not present in the bundled output , although it compiles successfully . i described the question on stackoverflow in more detail . can you help me with some hints where i should start investigating the issue ? < code >
context monorepo with 3 packages : 2 are vue-cli projects , and 1 is a common package consumed by the other packages . how to lint common package with @ vue/cli-plugin-eslint ? ideas : a ) install vue cli in common package b ) manually add eslint and required plugins as dependencies in common package c ) ... ? anyone with a similar situation ? any recommendations from the authors of @ vue/cli-plugin-eslint ? thanks ! < code >
vue-cli-service build seems to include vue.config.js in the actual production output ( vue cli v4.5.12 ) . i assume it 's included in webpack for hmr in case it is changed during development . however , i would n't think there is a reason to include it in a production build considering there could be a bunch of code that would never be executed in a browser ( e.g . chainwebpack ) . this has the undesirable effect of having any requires in vue.config.js included in my production output . for example , i 'm using are-you-es5 to build transpiledependencies and it ends up in my app . the only workaround i could think of was to use browser-or-node and only load are-you-es5 when node is detected : is there a way to prevent this ? < code > const { isnode } = require ( 'browser-or-node ' ) ; ... let transpiledependencies ; if ( isnode ) { // reason : 'eval ' is used to prevent the lib from getting included in the production // package by webpack . not sure why this happens or if there is a better way . // < url > // eslint-disable-next-line no-eval const { checkmodules } = eval ( 'require ' ) ( 'are-you-es5 ' ) ; transpiledependencies = checkmodules ( { path : `` , checkallnodemodules : false , ignorebabelandwebpackpackages : true } ) .es6modules ; } module.exports = { ... transpiledependencies , ... } ;
in the dependent package @ vue/babel-preset-app , there is a parameter polyfills with default value [ 'es.array.iterator ' , 'es.promise ' , 'es.object.assign ' , 'es.promise.finally ' ] according to the documentation it 's a list of core-js polyfills to pre-include when using usebuiltins : 'usage ' but actually according to the source code , it was filtered in this line and then pass to envoptions.exclude of @ babel/preset-env in this code . the excerpt is as follows . does this code work in the correct process ? i noticed that if this parameter is configured ( even the default values too ) , the polyfiils will eventually be excluded . < code > const envoptions = { bugfixes , corejs : usebuiltins ? require ( 'core-js/package.json ' ) .version : false , spec , loose , debug , modules , targets , usebuiltins , ignorebrowserslistconfig , configpath , include , exclude : polyfills.concat ( exclude || [ ] ) , shippedproposals , forcealltransforms }
according to the < url > vuetify v3.0 ( titan ) beta was planned to be released during february 2022. now in march , could we know what is the status ? thanks p.s . not pushing : ) < code >
tried many examples and tutorials already but i still cant get it to work locally , so anyone has a github project that actually works with jest and vuetfy and typescript ? regards ronald < code >
hi all , i have been trying to migrate from vuetify 1.0 to 2.6 issues : i could n't keep the original look of the application vuetify over powers custom css , i have tried the work arounds i find online no luck . can anyone point me to the right direction . im using webpack 4.6.0 rules : [ { test : /\ . ( sass|less|css ) < cur > / , use : [ 'vue-style-loader ' , { loader : 'css-loader ' , // requires sass-loader @ ^7.0.0 options : { implementation : require ( 'sass ' ) , indentedsyntax : true // optional } , } , ] , } , ] on my app.vue file i am using the v-app tags < code >
i 'd know about how to place the label of text fields on the left side . i attempted the image below . i think with vuetify its only possible to place the label inside the input field , i want to place the label left . in that case , can i use `` v-subheader '' ? i think it is a solution to use `` v-subheader '' , but i read `` v-subheader '' is used when i want to separate sections of the list form the docs ( < url > ) , so i care about that is not used for the label . < code >
hello , i need help to activate my dialog from another component . how can i do ? server.vue ( the parent ) button.vue ( navigationdrawertoolbarserverbutton ) but i get this error [ vue warn ] : property `` props '' was accessed during render but is not defined on instance . thanks ! < code > < template > < v-dialog > < template v-slot : activator= '' { props } '' > < navigationdrawertoolbarserverbutton / > < ! -- this component contains the button that activate the dialog -- > < /template > < navigationdrawertoolbarservercard/ > < ! -- this component contains the `` card '' content of the dialog -- > < /v-dialog > < /template > < template > < v-btn color= '' primary '' v-bind= '' this. < cur > parent.props '' > open dialog < /v-btn > < /template >
hey there . i 've asked a question about extending vuetify 's vbtn component on stack overflow and since realised i can also seek help here . so here i am , and here 's the link to the original question - < url > i 'm hoping it 's something silly that i 'm missing ( or not doing correctly ) with vue 's createelement ( or even vuetify 's gencontent ) method . fingers crossed , and thanks in advance . < code >
i just want to when user do double click on input text field then he can type otherwise till then user can not type & also input would be not active . passing the true & false in : readonly but not working . < code >
hello all , first of all - thanks for the amazing work . vue 2 and vuetify combo is my bread and butter . i 've recently initialized a project with the 3.0.0-beta release . so far , it 's great . i did notice one thing though . it 's no longer possible to set v-select 's item-text & item-value props , even though it says so in the documentation ( albeit , in the documentation page for the v-autocomplete , there is no v-select documentation page , but they are more or less the same ) . so i was looking around in the code , why even the default `` text '' was not working anymore for me ( i mapped all my items to { text : ' ... ' , value : ' ... ' } , but was getting nowhere . after looking around , i noticed in the new codebase , it 's looking for the title prop . this solved my problem , but i think it 'd be nice if vuetify @ 3 could provide those two props again , like in version 2. the code lines i 'm referring to are these . what my question is - can i somehow join the effort , via helping on this particular issue ? from what i see , couple of things need to be done : update docs , title is new default ( not text ) enable passage of item-text & item-value i 've never contributed to open source before , so please be gentle on me . apologies if this is not the place to ask this . < code >
hi , i need to set the id of a dialog so i can use selenium in my e2e test to check if the dialog is visible or not . in my template i have : < v-dialog persistent max-width= '' 490px '' : value= '' show ( ) '' > ... < /v-dialog > which results in the following html : < div class= '' v-dialog v-dialog -- active v-dialog -- persistent '' style= '' transform-origin : center center ; max-width : 490px ; '' > in my test i am using selenium python and i would like to select the div with find_element_by_id ( ) then use is_displayed ( ) to check if it is visible . but i have some trouble assigning an id to the < div > . i tried adding id= '' myid '' to < v-dialog > but this id never shows up in html . how can i set the id of the dialog in such a way it shows up in html . or is there another way to select a dialog with selenium ? thanks . < code >
i tried different ways , i tried to read the code of the library as well , but i can not make it work . the example here for the api search is not working < url > < code >
i 'm really impressed by the sheer quantity of components available . but i was searching for a tags list element and was not able to find it . i 'm blind or is not there ? currently i 'm using @ sipec/vue3-tags-input that works , but could be better . what do you think ? < code >
hi , i 'm using v-data-table of vuetify , and mainly use bootstrap 's style . but when using vuetify and bootstrap at the same time , vuetify overrides bootstrap 's styles , e.g. , font-family . how to solve this issue ? thanks . < code >
hi , i want to handle click events on table cells ( of a certain column ) using a function . v-data-table provides click handling for row , but how to handle cell ? thank you . < code >
when you set one or more custom filters on headers then the logic for search becomes : all headers with a custom filter need to match and at least one header without a custom filter needs to match i ca n't really imagine when this would be useful / the desired behaviour , at least from my point of view i want to use the filter on the header to apply the search term slightly different than the default , but it should still only require one of any of the headers to match ... relevant code : < url > < code >
< url > - here is an example of disabled not working on v-items in a v-item-group . v2.6.4 < url > - here is an example of disabled working on v-items in a v-item group . v3.0.0alpha i did n't see a bug out for this one . am i trippin , or should 2.6.4 be working ? opened a bug at : # 14923 < code >
how do i make the whole line clickable instead of clicking the text of the item ? is it possible to overwrite the items into an anchor tag ? < code >
by default , when elements such as checkboxes and buttons get focus , they either get a shade around them , or their color changes to a lighter version . even if the contrast of the element itself is well above the minimum , the contrast of this focus indicator is not ( around 1.3-1.5 , depending on original color ) . in order to comply to wcag requirements , i need the contrast for focus indicators to be at least 3.0. i have been adding red borders on focus to some elements , but there are many issues with this approach . is there any way to override the 'focus color/opacity ' in a wider context ? ( like , say , as a theme color option ) examples from the documentation itself : < url > first checkbox , focus indicator is light blue , contrast 1.34:1 < url > contrast of focused blue button compared to unfocused : 1.16:1 etc < code >
i 'm using vuetify 's v-select but in fact i do n't need to show the hint at all , why do n't you choose to hide the dom ( .v-text-field__details and margin-bottom at .v-input__slot ) above the hint position by default ? < code >
we have a strange problem that has been bugging our project for some time now . in the project , some components , like buttons and tabs , move slightly after they have been loaded . this problem ca n't be reproduced in codepen , but it exists in every new vue-cli project we start . on this codepen the problem does n't occur . and on github the problem does occur in a fresh vue-cli project with the same app.vue . of course , the project can be run with npm install . if you pay close attention ( which our customers do ) , you see the button text , the icon on the dialog and the tab titles move after the modal has been opened . even after a lot of experimenting , we have n't been able to pinpoint the cause of this problem . any help would be greatly appreciated ! p.s . project initialization options : vue-cli project options vuetify options p.s.2 . the only notable issue during configuration of the project is this warning : < code > vue-cli 5.0.3 ( but did occur with older versions just the same ) vue 2 typescript babel router vuex dart-scss sfc no custom theme no custom variables material design icons ( both offline and online , does n't matter ) a la carte components warn conflicting versions for project dependency `` sass-loader '' : - ^12.0.0 injected by generator `` undefined '' - ^10.0.0 injected by generator `` vue-cli-plugin-vuetify '' using newer version ( ^12.0.0 ) , but this may cause build errors .
we have several apps using vue and vuetify . i 'm creating an npm package `` design system '' , which : encapsulates vuetify installation based on a passed vue instance from a host app encapsulates theme creation for a white-label host app re-exports vuetify components and sass variables exports our custom components based on vuetify components the idea is : the host app does n't depend on a vuetify but depends on the `` design system '' package whole vuetify setup is just one line of code like const vuetify = initdesignsystem ( vue , theme ) , then we pass vuetify to a vue constructor in the host app sync vuetify version between different apps any ideas , recommendations , and examples on how to do it ? < code >
i saw at v-otp-input apididnt have rules and error-messages when i need to put validation on it , and then i have to make customlly , i think it would be same with v-text-input with error-handling show for consistency thankyou . < code >
hi , i have a navigation drawer that is permanently visible on large screens , and can be toggled on and off on small screens . in order to comply with wcag requirements , i need keyboard tab-control to remain in the navigation drawer when it is shown on small screens ( so that the toolbar and the page elements are not focusable ) . however , right now , tab-key navigation works the same as for large screens ( i.e . when pressing tab , focus goes to toolbar first , then navigation drawer , then rest of page ) . is there any way to toggle keyboard controls of the toolbar and the rest of the page , when the navigation drawer is opened/closed ? < code >
problem to solve i ca n't use my own sass file . i can only to override css class or set variables . but no posible to use a own main.sass file . loading file : lib/presets/default/index.js doc : < url > ... import ' .. / .. /styles/main.sass ' proposed solution load sass template via option . < code >
hi , i saw some examples like that for material design : but did n't see any option in the v-dialog to have the close icon by default . any example to make the thing the most clean ? thank you , < code >
i want to make my select component more special , so i am trying to put the badge in the select options can this be achieved ? < code >
i 'll try to describe my use case ( using vuetify 2.6.3 ) : i use v-text-field as basis for a number input with type= '' number '' . in order to have proper localization i want to apply formatting to the actual value of the component , which is a number or a decimal . i want to do this through intl.numberformat , as the component is used for currency , units , percentages , and as a regular decimal input . however , if i try to use v-model , the formatting will pollute my data . i 've tried workarounds of only showing the formatted value in the input when the input is not focused ( and preventing input listener from making changes ) but that because type= '' number '' ca n't parse the value it shows no text or errors . i 've changed that to type= '' text '' for the time being , but that removed keyboard/mouse control support and is bad semantically . it 's not trivial to try and parse a string that could be formatted according to any locale 's standards back into a number either . i thought a default slot existed for v-text-field , but apparently that is not the case . # 14145 # 14265 with a default slot , i figure it could be much easier by receiving the value as a prop , formatting it , and displaying that ( for example through the i18n-n component from vue-i18n ) while keeping the internal value the same . how do you make localization work for this ? v-text-field contains a lot of functionality that i use for the numberinput as well . < code >
hi , everyone . i think that i have checked all properties of treeview but i really do n't understand if i can customize the prepended icon color and label text color when a node is hovered . if there is any way , please tell me how to approach this . i 'll appreciate your help . < code >
hi , everyone ! i try to customize the icon shown on the left side , but it seems there is no any elegant way to do that . does anyone know how to do this ? < code >
i 'm compelled to use react . but i have worked in vue before , and thus vuetify . i want to ask the community , if you had to choose between all the options available , what would you choose ? i see options like : mui mdbootstrap < code >
i am looking for help to make the slider or range slider accept more than two values . my use case is to have 3-4 values for different limits image attached ( done in a different framework ) all of those thumbs would be mobile and displayed from a single array . thanks , for any assistance anyone can provide . < code >
how can i pass a size parameter to an v-icon component through v-checkbox component ? ( xsmall , small , large , xlarge ) i need to control the size of the icon i 'm using . < code >
i am getting below issue while running the sample application with below configuration . package.json `` vue '' : `` ^3.0.0 '' , `` vue-textarea-autosize '' : `` ^1.1.1 '' , `` vuetify '' : '' ^3.0.0-alpha.0 '' main.js import { createapp } from 'vue ' import app from './app.vue ' import vuetify from './plugins/vuetify ' import 'vuetify/dist/vuetify.css ' app.use ( vuetify ) .use ( vuetextareaautosize ) getting below warning and component is not visible . can anyone help me on this ? < code >
i and trying to create a top/header navigation using vuetify 's menu component . so far i could not find a single tutorial/sample online where the menu and sub-menu both are dynamic . all the samples/tutorials have a single button drop-down with dynamic values for sub-menus . i am looking for a sample/tutorial where there are a few , say 4-5 top-level menus ( buttons ) with some of them having sub-menu . indeed , this would require a conditional check if the data has a sub-menu value or not . if the data does n't have a sub-menu value only a top-level menu would be shown . all this with a data-driven approach . can anyone suggest a sample or go to a place for such an example ? thank you very much ! in a nutshell : top level dynamic value with condition check to see if sub-menu exists if a sub-menu exists , dynamic sub-menu values sample menu data : menu_items : [ { title : 'table ' , path : '/ ' , icon : 'mdi-home ' } , { title : 'forms ' , path : '/forms ' , icon : 'mdi-home ' , submenu_items : [ { title : 'link 2 ' , path : '/link2 ' , icon : 'mdi-home ' , } , ] sample ui with drop-down as well as no menu links < code >
i installed the pinia and vuetify3 and i got the message like that .. `` ' [ vite dev ] error loading external `` fs '' . at file : ///c : /users/ipactory_pc_006/desktop/projects/test3/.nuxt/dist/server/server.mjs:3021:264 at async instantiatemodule ( file : ///c : /users/ipactory_pc_006/desktop/projects/test3/.nuxt/dist/server/server.mjs:22994:3 ) `` ' i installed vuetify3 in this way , nuxt/framework # 1183 wobsoriano 's comment import components `` ' // plugins/vuetify.ts import { definenuxtplugin } from ' # app ' import { createvuetify } from 'vuetify ' import { vapp , vappbar , vbtn } from 'vuetify/components ' // import everything // import * as components from 'vuetify/components ' export default definenuxtplugin ( ( nuxtapp ) = > { const vuetify = createvuetify ( { components : { vapp , vappbar , vbtn } } ) nuxtapp.vueapp.use ( vuetify ) } ) `` ' transpile and add styles to nuxt.config.ts `` ' import { definenuxtconfig } from 'nuxt3 ' export default definenuxtconfig ( { css : [ 'vuetify/lib/styles/main.sass ' ] , build : { transpile : [ 'vuetify ' ] } } ) `` ' and i installed pinia in this way , `` ' yarn add pinia `` ' make directory `` plugins '' and make typescript file `` pinia.ts '' and `` ' import { createpinia } from `` pinia '' ; import { definenuxtplugin } from `` nuxt3 '' ; export default definenuxtplugin ( ( nuxtapp ) = > { nuxtapp.vueapp.use ( createpinia ( ) ) ; } ) ; `` ' and error ... please help me < code >
hi ! i 'm using vuetify data tables and they work great . i wonder if it is possible to customize the ui of a particular case : - > when the v-data-table is in responsive into the mobile breakpoint . the ui looks like this : is it possible , just in this case , to customize the select highlighted in red here ? i tried to update the the global css but things are not clean because when an item is selected from the list there is a v-chip added : i would like the select to look like this case here in red : but i have n't found any way in the documentation or in github on how to properly do it . is anyone have any idea ? thank you ! < code >
i try to use color vars in my css , but it does n't work . what am i doing wrong ? please help me . < code > < style > .my-class { background : var ( -- v-theme-primary ) color : var ( -- v-theme-on-primary ) } < /style >
i want to dynamically change the theme colors . in previous versions it was possible to do this . but now , the parameter is changing , but it does not affect the color display in ui . this. < cur > vuetify.theme.themes.green.colors.background = ' # ff0000 ' - no longer changes color dynamically help please . < code >
hi i am using vuetify in my nuxt projects but there is a problem with loading all library requirements and components . is there any way to add just some components of vuetify instead of all features ? i use caching for better performance but i have some problem in loading < code >
hi , i 've used adobe xd for prototyping on previous projects , i would like to mock up some designs for our vuetify website but i 've not been able to find any vuetify ui kits i can template from . does anyone know of any ? thanks < code >
i want to place all my elements on a page below each other , with a bit of spacing between . elements like v-simple-table , v-btn , < h2 > . i can do that inside a v-container like this : which looks clean to me . or i can do it like this : which is much more cumbersome and does n't look as nice . so i am wondering , what do i gain by using v-row and v-col everywhere ? < code > < v-container > < v-row > < v-col > < h2 > this is my webpage < /h2 > < /v-col > < /v-row > < v-row > < v-col > < v-simple-table > ... < /v-simple-table > < /v-col > < /v-row > < v-row > < v-col > < v-btn > save < /v-btn > < /v-col > < /v-row > < /v-container > < v-container > < h2 > this is my webpage < /h2 > < v-simple-table > ... < /v-simple-table > < v-btn > save < /v-btn > < /v-container >
i want to ask : how can i use this component then i get data from axios as a object ? data : < code > axios.get ( this.link ) .then ( response = > { var data = response.data console.log ( data ) } ) { `` -3 '' : { children : { 14 : { } , 15 : { } } id : -3 link : `` .... '' name : `` home '' } `` -2 '' : object { id : -2 , name : `` second part '' , link : `` ... '' , children : { ... } } ... }
good day. ! i noticed that when using v-app-bar and app prop is not given that its clipping the v-navigation-drawer .. is this normal .. ? if so how would i get around that so it does not clip the v-navigation-drawer when app prop is not set .. ? kind regards < code >
would anyone happen to know how to colour a random part of the v-progress-circular a different colour then the background stroke ? like the image below , where green is moving with a value and the red bit is just a random section of the circle to be coloured . < code >
hello , just want to know if it is possible to modify the sort function so , that it is only possible to sort for asc or desc . currently , you have 3 possibilities , desc , asc and no sort . thank you . < code >
i want bind the value of sparkline and update the value for every 3000ms as well as process circular component . < v-progress-circular rotate= '' 360 '' size= '' 100 '' width= '' 15 '' : value= '' circlevalue '' color= '' teal '' > { { circlevalue } } % < /v-progress-circular > methods : { randomvalue ( ) { let _this = this ; setinterval ( ( ) = > { _this.circlevalue = _.random ( 0,100 ) } , 3000 ) } , } , < code >
hi , i am in a strange situation . locally , i have no problem , i can see my events that i created on the calendar . but in production , events do n't appear , and i noticed that when i arrive on the page , the calendar does n't initialize ( i see it because the month name of the calendar does n't appear when i arrive ) . and when i change month for example , the calendar initializes well , but i still ca n't see my events ... i repeat , this issue occurs only in production . locally , everything works perfectly well . < code >
hi ! i 'm getting a little bit of frustation trying to change a value of a input text with vuejs with v-time-picker . vuejs never register new value : i have this field that dispatch date and time picker . i executed a lot os snippets but none works , none register value i want ... var < cur > input = < cur > ( ' # air_boardingdate ' ) .val ( '2021-11-12 11:00 ' ) ; var e = document.createevent ( 'htmlevents ' ) ; e.initevent ( 'change ' , true , true ) ; < cur > input [ 0 ] .dispatchevent ( e ) ; i need this kind of hack because i need to fill up 50 times a form for 50 passengers i am responsible of their travel and i want to automate the submission . thank you and sorry if this is not the place for writting this kind of things edit : form i want to automate is < url > < code >
< v-alert type= '' warning '' > hello world < /v-alert > the type of info , error , success are fine , but type of warning is not a icon , display only a ugly `` ! `` ... it 's different from the document . how to fix it ? < code >
suppose i have variable items structured like below : in v-treeview we have props item-children that take string , it allow to set withc property will be taken as children reference . on the first level i want the property item_nested as children and the second level i want nested_item as children , but is it possible to set multiple value for item-children ? < code > [ { id : 1 , name : 'value1 ' , item_nested : [ { id : 2 , name : 'value2 ' , } , { id : 3 , name : 'value3 ' , nested_item : [ { id : 4 , name : 'value4 ' } ] } ] } ]
hi , please have a look at codesandbox for testing just fill in each required formfield a `` 1 '' and then confirm the form . the first range-slider should give you the opportunity to select a range . the second slider should give you this selected range in detail . at 5 and 5,5 % there are two ticks defined . and at the beginning and at the end of the range there are ticks too . when moving the thumbs of the range-slider these ticks disappear somehow . moving slow brings them back ( sometimes ) . any ideas for this behaviour ? i want them to be shown all the time . thanks for your hints < code >
hi , i load html content from my api . this content contains the text : < v-chip > hello < /v-chip > . how can i render this to a vuetify chip component when displaying the content in my vue app ? thank you . < code >
i 'm using vuetify with tsx , so my components look like this : how can i prevent sass/scss sources from being imported/compiled ? i just want to use `` vuetify/dist/vuetify.min.css '' to speed up the build process . i 've tried file-replace-loader and webpack ignore plugin , but they did n't work . should i keep trying , or there 's a better way ? ... < code > import * as tsx from `` vue-tsx-support '' ; import { vnode } from `` vue '' ; import { vbtn } from `` vuetify/lib '' ; export default tsx.component ( { name : `` dashboard '' , render ( ) : vnode { return ( < div > < h1 > dashboard will be here < /h1 > < vbtn > some button < /vbtn > < /div > ) ; } , } ) ;
hi all , any idea how to keep the selection position when you select and then reopen the v-select to reselect something ? right now , each time i want to reselect something close to my initial selection , i have to scroll everything down again . thanks ! < code >
hello , my client asks me if there would be any way to prevent users to take a screenshot of the web or recording , since the content uploaded to that website is owned by each user , and we have a subscription system to access that content , we 're not interested that another user can `` steal '' that content and publish it on other websites . we are interested in avoid the screen capture or show black screen on the v-img component since we are using vuetify , i was wondering if there is something similar with v-img . thanks and best regards < code >
i found out that there are no danish translations for vuetify controls . see the following location - vuetify/packages/vuetify/src/locale/ would it be possible to add danish translation ? < code >
hi . i 'm trying to bind both a tooltip and a dialog on the same button , but that does not seem to work . how can i bind on/attrs on activator slots for both component on the same button ? is that even possible ? i 've tried nesting the tooltip in the dialog and the other way around . each time , only the nested component works - i guess because the parent 's on & attrs attributes are overriden by the nested one . < code > < v-tooltip bottom > < template v-slot : activator= '' { on , attrs } '' > < v-dialog max-width= '' 600 '' v-model= '' showqrcode '' > < template v-slot : activator= '' { on , attrs } '' > < v-btn text v-bind= '' attrs '' v-on= '' on '' color= '' primary '' class= '' d-none d-sm-block '' > < v-icon > qr_code < /v-icon > < /v-btn > < /template > < v-card class= '' p-4 pb-1 '' > < v-card-title class= '' justify-center '' > scan this code to view the widget on your mobile device < /v-card-title > < div id= '' qrcode '' class= '' mt-4 '' > < /div > < v-card-actions > < v-spacer > < /v-spacer > < v-btn text color= '' primary '' @ click= '' showqrcode = false '' > close < /v-btn > < /v-card-actions > < /v-card > < /v-dialog > < /template > < span > scan the qr code and test on your mobile device. < /span > < /v-tooltip >
versions and environment vuetify : 1.1.0-alpha.4 vue : 2.5.16 browsers : chrome 66.0.3359.139 os : linux x86_64 steps to reproduce clone the repo at < url > run yarn dev expected behavior normal console messages ( quieter ) . this was the case in 1.0. actual behavior this pair of messages appears for every button in the toolbar . there are two buttons in the repo example , so there are four messages total ( first 2 shown below , repeats not shown ) . reproduction link < url > other comments replace 1.1.alpha.4 with 1.0 and the messages disappear . removing the buttons resolves the messages . removing the footer entirely resolves the messages . removing app from the footer resolves the messages . removing app from the header does not resolve the messages . replacing the v-button/v-icon combinations with simple v-icon resolves the messages . note : if the dev tools are not visible for the console when running the app , ctrl-shift-i shows them ( also menu ) . i was unable to reproduce this with a web build of the app , thus unable to reproduce with a simpler codepen either ; there may be some kind of conflict between vuetify 's use of an app mix-in and electron . < code > ./node_modules/vue/dist/vue.runtime.common.js:589 [ vue warn ] : < cur > attrs is readonly . found in -- - > < vbtn > < vtoolbar > < vapp > < electify > at src/renderer/app.vue < root > warn @ ./node_modules/vue/dist/vue.runtime.common.js:589 ./node_modules/vue/dist/vue.runtime.common.js:589 [ vue warn ] : < cur > listeners is readonly . found in -- - > < vbtn > < vtoolbar > < vapp > < electify > at src/renderer/app.vue < root > warn @ ./node_modules/vue/dist/vue.runtime.common.js:589
i think it would be a good idea to have a functionality to move the order of certain elements in tables or lists . if you want to reorder a specific image collection for example . easily drag your element to the desired location in the list and the order of the array would be changed . i can think of many use cases where this could be convenient . here is an example from the jquery ui library < url > < code >
i know what my item height is and i know the position of the item in the list , so i should be able to calculate the scroll position . however , i am not sure how to set the scroll position . < code >
hello , i have a dialog where i 'm asking the user to enter an amount like so : how can i change this so the user can only enter ( two decimal places ) like so < cur > 12.34 and not 3 decimal places like < cur > 12.345 . while googling , i 've come across some libraries ( v-currency-field , vue-currency-input & v-money ) but none of them had good examples on how to use them in my code above . vue-currency-input looked promising ( because it 's relatively new ) but i just could n't get anything to work . has anyone managed to have a v-text-field that can enter numbers to 2 decimal places ? note : i 'm currently using vuetify 2.5.7 < code > < v-col class= '' d-flex align-center '' cols= '' 6 '' > < v-text-field class= '' px-4 '' label= '' prepayment amount '' prepend-icon= '' mdi-currency-usd '' v-model= '' amount '' type= '' number '' > < /v-text-field > < /v-col >
i 'm trying to display some data with v-data-table . there is a specific value in each object that is responsible for grouping . the problem i ca n't solve is about ordering the groups dynamically . is there any way to change this order ? < code >
i use treeview component to show orgnization chart and i fetch the sub orgnizations by load-children while click the treenode , the issue is while in the independent type when i fetch the new children the selected nodes would be cleared . does anyone can tell how to solve the issue ? thanks so much . my code attached . uploading helloworld.vue < code >
hello everyone , i 'm currently trying modify item template in v-data-table but the first row and only the first one does n't apply style from class . thanks for your help ! < code > < template > < div id= '' list '' > < v-data-table : headers= '' headers '' : items= '' items '' > < template v-slot : item= '' { item } '' > < tr class= '' data-table-item-class '' : style= '' { backgroundcolor : item.color } '' @ click= '' handle_click ( item.id ) '' > < td > { { item.a } } < /td > < td > { { item.b } } < /td > < td > { { item.c } } < /td > < td > { { item.d } } < /td > < td > { { item.e } } < /td > < td > { { item.f } } < /td > < td > { { item.g } } < /td > < td > { { item.h } } < /td > < /tr > < /template > < /v-data-table > < /div > < /template >
my menu has some items that behave like toggle switch when clicked . they flip the value of a boolean variable in the vuex store that is used in a filter for the displayed list . this works . what i 'm still missing is providing a visual feedback of the state of the boolean by showing and hiding a check icon on the right of the menu text . i used a v-if and a computed function to control the icon display . unfortunately , the function is only called the first time the menu is shown . how can i force a re-rendering of the menu once the menu item has been clicked ? < code >
i 'm starting with vuetify and wrote a very simple app displaying a list of items . the code is inspired from an example of the vuefifyjs.com site . my component is the following : it works and display the list with the separator as in the example . the problem is that i get warning in the console for each item . the warning is the following . ( sorry for the screen capture , the errors ca n't be copied ) . i get a warning for each item . when i comment out the v-divider the error disappear . i do n't understand how it works . why do i need a : keys in the divider ? why is n't the : key put in the v-item next to the v-for ? < code > < template > < v-list dense > < template v-for= '' ( item , index ) in items '' > < v-list-item : key= '' item.r '' > < v-list-item-content class= '' font-weight-bold '' > < v-list-item-title > { { item.n } } { { item.t } } < /v-list-item-title > < /v-list-item-content > < /v-list-item > < v-divider v-if= '' index < items.length - 1 '' : key= '' index '' > < /v-divider > < /template > < /v-list > < /template > < script > export default { name : `` itemlist '' , data ( ) { return { items : this. < cur > store.state.currentitems } ; } , } ; < /script >
i have a v-banner with the app property placed directly inside v-main to show a warning on top of scrollable content . the default background colour for this is transparent , so content is visible under the banner . setting the color property allows me to set a color as expected , but ideally i want this banner to have the same colour as a v-card background for both light and dark themes . i can achieve this by setting : color= '' < cur > vuetify.theme.dark ? ' # 1e1e1e ' : 'white ' , but what 's the best way to get the card background color dynamically instead of hardcoding it like this ? < code >
hello , when a vtextfield with a persistent placeholder is inside a vcard and the vcard is disabled , we can still click on the placeholder . this is due to the vtextfield having a permanent v-label -- active class when the persistent-placeholder attribute is used : which overrides : < code > .v-card -- disabled { pointer-events : none ; } .v-text-field .v-label -- active { ... pointer-events : auto ; }
support for the scrollbar-color css property which would let the browser color the scrollbar as per the application requirements . mozilla firefox ( since ver . 64 ) has supported this and the following browsers are implementing it presently in their present , next release or one of the future releases : mozilla firefox : since version 64 ( partially implemented , light and dark are n't working , but color scrollbars do ) . chromium/google chrome : to be implemented ( tracked feature status here , partial support with prefix -webkit- ) . apple safari : 15 technical preview ( to be implemented , partial support with prefix -webkit- ) . microsoft edge : ( same as chrome/chromium ) . it 's essentially 2 colors added using the scrollbar-color css property ( it 's a kinda-trial , i 'm not as well versed in how css works here , so forgive me for that ) : mdn documentation about scrollbar-color here . caniuse about scrollbar-color here . csswg draft on scrollbar-color here . < code > html , body { scrollbar-color : < cur > primary < cur > secondary ; / * first color is the thumb/scroller part , and the second is the scrollbar background part . * / }
hello my probleme is simple , but tricky to resolve . i have a v-text-field in a v-form . my v-text-field is inside a parent component name input , this input have a props to set the value of my v-text-field . i my case i also have a default value at the input level . my probleme comes when i perform a clear action . when i clear the field i want my default value to be display and it works most of the time . but when in my field i have already my default value as value for my field , the value of the v-text-field is nicely cleared but because my new value that i want to put in the field is the same as that the one i just cleared the component is not reloaded . maybe theses images will be more relevant . here is what i have when i mount my component : i can change the value : and when i clear it the default value is comming back : but if i clear when the value is the default , the v-text-field is empty : the props i have in the input component : the props i have in the vuetify ones : so if you have any tricks who could do the job it would make me very happy : d. have a nice day < code >
v-list-item-action components are always displayed . how can they slide left and then reappear ? and each list item has such an operation button . the item is generated by the for loop . < code >
hi i am adding couple of new components to vuetify in a fork . one of them is a json renderer , which accepts a json schema and renders vuetify components . while working on this renderer , i realize some components like v-treeview accept scoped slots ( append ) and some components like v-input , accept these slots as children ( template with slot name ) only . for example this code does not render append slot in typescript render ( h ) { return h ( vtextfield , { scopedslots : { append : ( e : any ) = > ( 'some text in slot ' ) } } ) } but if the slot is passed as a child template , it renders render ( h ) { return h ( vtextfield , { } , [ h ( 'template ' , { slot : 'append ' } , [ 'some text in slot ' ] ) ] ) } what is the difference here , and how should i find which slots can be passed as scoped and which need to be passed as a child . please someone explain this to me , thanks < code >
form component : child component : it does n't clear child-component 's select value , but if i use v-select as a direct child to v-form instead , it does work as expected . < code > < div > < v-select : value= '' value '' : items= '' items '' @ change= '' < cur > emit ( 'input ' , < cur > event ) '' > ... < /v-select > < /div > // props props : { value : { type : [ number , string ] , default : null , } , value : { type : array , required : true , } , } < v-form ref= '' form '' > // does n't reset < child-component v-model= '' select '' : items= '' [ 1 , 2 , 3 , 4 , 5 ] '' / > // does reset < v-select v-model= '' select '' : items= '' [ 1 , 2 , 3 , 4 , 5 ] '' / > < v-btn @ click= '' reset '' > reset < /v-btn > < /v-form > // data data ( ) { return { select : null , } } // reset method reset ( ) { this. < cur > refs.form.reset ( ) } ,
i 'm using cypress-axe to improve the accessibility of my site , it flagged a serious issue with the rows per page dropdown menu on the v-data-table footer . does anyone know how i can add an aria-label to it ? i noticed there is a footerprop , but not sure how to specifically apply the aria-label to the dropdown button < code > * * axe issues - v-select * * vue-axe.esm.js ? 81a0:1 serious ensure interactive controls are not nested < url > element : < div role= '' button '' aria-haspopup= '' listbox '' aria-expanded= '' false '' aria-owns= '' list-94 '' class= '' v-input__slot '' > < /div > element has focusable descendants
i 'm using vuetify for the current project . now i need to create a table containing merged cells ( including both columns and rows ) that looks like the one in the excel . it appears v-data-table does not have this feature built in . how to create it ? ( btw , some cells of the table should be able to allow user edit . ) < code >
reason : currently , if we look at buttons , the background changes when the element is disabled ( based on theme ) . in some scenarios i encountered i had to add some css overrides and color preservation logic to keep the background color . ( to the best of my research , i see the api does not expose any scss vars or attributes that can be used for this . ) < code >
hello , i am trying utilize the vuetify fab button and i 'd like the background to fade out a bit while the fab button is open . does the vuetify fab button have the ability to do that ? < code >
with v-virtual-scroll can show unlimited content , and have good performance , but how should i determine when to load new data , can continuously for v-virtual-scroll ? like this < url > you can scroll down all the time . < code >
hi ! i 'm trying to find vuetify types while building my application with typescript , i 'm using vue 2. how can i find them so i can import into my code ? some examples : vcombobox - where can i find the interface of the vcombobox items so that when changevalue is called the first parameter can be defined vdatatable - where can i find the interface of the first and second param when ondbclickrowitem ? < code > < template > < v-combobox label= '' my comboboc '' : items= '' items '' @ keydown= '' onchangecomboboxitem '' / > < /template > < script lang= '' ts '' > import { definecomponent } from ' @ vue/composition-api ' ; export default definecomponent ( { setup ( ) { const items = [ ] ; // some objects inside of this array const onchangecomboboxitem = ( comboboxitem ) = > { console.log ( comboboxitem ) ; } ; return { items , onchangejobtemplate , } ; } , } ) ; < /script > < template > < v-data-table : headers= '' headers '' : items= '' items '' @ dbclick : row= '' ondbclickrowitem '' / > < /template > < script lang= '' ts '' > import { definecomponent } from ' @ vue/composition-api ' ; export default definecomponent ( { setup ( ) { const headers = [ ] ; // my headers const items = [ ] ; // my items const ondbclickrowitem = ( _ , rowitem ) = > { console.log ( _ ) console.log ( rowitem ) } ; return { items , onchangejobtemplate , } ; } , } ) ; < /script >
hi , i do not like the new search on the documentation site . i do not know exactly how long ago it has been changed in terms of ux or i do not know if this change is due to vuetify or angolia . however , i think it has made finding stuff harder : i can not use keyboard shortcuts after the search . i want to press `` / '' to focus search field ( this works ) , type a word , use arrow functions and press enter . it was like this before for a long time . i think search results can be much better . when i type `` text '' for example , i would want text-field and textarea components to come as first results and i prefer component pages on the top and api pages as second . this is not the case for now . there are much irrelevant stuff on top that are rarely used . i believe this kind of stuff can be set with angolia . i think a better search would be really good for usage . what are your thoughts about this ? < code >
problem to solve hi , in my project , we are planning to go forward with vuetify with vue2 version , if possible i wanted to know how drastically vuetify 's vue3 support will differ to vue2 . if the migration effort from vuetify 's vue2 to vue3 going to be low , medium or high ? if the the components api 's are going to be changed ? thanks for your time , your answer will help me take good decision for my project . proposed solution i am assuming , backward compatibility i.e , less changes to component api 's will be correct way which will help existing vuetify users to upgrade easily < code >
hi all . we have detected strange behavior with the v-automplete component . when it receives the focus , by code , it select all its text : this is very useful in almost every environments except in safari on ios , because each time you click on the component and the text is selected , appears the text options ( copy , cut , etc ) and this is very annoying for users . it 's possible to disable the text selection by parameters ? any help is welcome . < code >
i have added the zoom level as 0.8. after adding this v-select dropdown is not visible properly 1. set the zoom= > 2. v-select , dropdown not visible proper 3. app . vue file structure < code >
i am following the example in the documentation , ui component , one of the fotter example . i wanted to route the buttons to other pages . so is there a way to include the router in the loop ? ? '' thanks in advance < code > ' < template > < v-footer color= '' primary lighten-1 '' padless > < v-row justify= '' center '' no-gutters > < v-btn v-for= '' link in links '' : key= '' link '' : routes= '' route '' color= '' white '' text router to= '' route '' rounded class= '' my-2 '' > { { link } } < /v-btn > < v-col class= '' primary lighten-2 py-4 text-center white -- text '' cols= '' 12 '' > { { new date ( ) .getfullyear ( ) } } < strong > vuetify < /strong > < /v-col > < /v-row > < /v-footer > < /template > < script > export default { data : ( ) = > ( { links : [ 'home ' , 'about us ' , 'courses ' , 'contact us ' ] , routes : [ '/home ' , '/about ' , '/courses ' , '/contact ' ] , } ) , } < /script >
so i was having trouble in my nuxtjs app , so i have this dialog , which is scrollable who are being accessed by a different button . when i open the dialog , it does n't scroll to the top instead , it is in the same spot . < code >
hey , im trying to make a v-navigation-drawer component to open up from top to bottom , like a dropdown . i could n't find anything about it anywhere , in the api documentation there are only `` bottom '' , '' right '' , '' left '' properties .. i would like to make the drawer open from the top . what i am trying to achieve is very similar to that : < url > any advice is more than welcome < code >
how to change the style of lazy-src ? i sorry for my poor english i have a project to show the student 's photo , like this loop on the elements of data . data is from api < v-img : src= '' /img/0001_ < cur > { info.idcode } .jpg '' min-width= '' 75 '' contain / > i need to set no-img.jpg which the students photo is undefind , so i rty to use @ error like this anwser but thiss not work at loops < url > i noticed lazy-src can instead of @ error to show the no-img.jpg when the students photo is undefind , but the lazy-src ' has a slight blur filter applied . can i remove it ? and where can i remove it ? sorry for my poor english again . < code >
* i do n't want to chinese wrap when i enter data , how can i do ? before . after ( when i enter ) < code > < ! -- my code -- > < v-col cols= '' 12 '' md= '' 4 '' xl= '' 3 '' class= '' d-flex align-center justify-end '' > < span class= '' pr-4 '' > < /span > < v-select placeholder= '' '' : items= '' fakedata [ 'selectitems ' ] '' item-text= '' text '' : menu-props= '' selecttype [ 'menuprops ' ] '' : item-color= '' selecttype [ 'itemcolor ' ] '' : no-data-text= '' selecttype [ 'nodatatxt ' ] '' autocomplete= '' off '' clearable open-on-clear return-object / > < /v-col >
hi , i am trying to keep the already applied pagination object of the datatable on store , my aim is to set the data that was already applied on the table when i navigate b/w the pages . i set pagination object with : options.sync= '' paginationobj '' it keeps the value that i have on store only for itemsperpage and sortby and sortdesc props but it is strange that it is not working for page i changed the page on the table , and it is correctly set on the store , when i navigate to another page and come back it resets to page 1. how can i solve this ? < code >
i 'm trying to place a v-textfield and a v-btn into the same row . however , i got this : i just want to kick the button to the right side without changing its width , and the v-textfield will fill the width remaining . < code >
i 'm quite new to vue and vuetify , so i might just be missing the obvious ... when using the text field component , one gets a really nicely formatted input field . and when you set the type= '' time '' it gets even more awesome , with nice formatting of the input value and a little x-button to clear the input . when setting type= '' number '' however , it looks quite horrible . an up- and a down-arrow are added , but they are standard html formatting , no nice vuetify styling . also , whereas the text field with type time only accepts numbers , the text field with type number , also accepts letters . so my question is : what different types are there and am i simply missing the correct one for a beautifully layouted number input ? and if there is n't a number-input type . why not ? ? ? surely i 'm not the only one in need of this functionality ... really hoping i am simply missing the obvious here ... cheers , jakob < code >
hello , first i would like to thank you for this amazing ui library . i have a use-case that i need to separate my assets under /admin folder and load vuetify only under that layout . so i do not want to load vuetify assets globally to have better performance . is this possible ? thanks for your help , < code >
is there a way to replace the click action on a v-expansion-panel header ? on click , i 'd like to push a route to vue-router instead of opening the v-expansion-panel-content as in my project , the route change does open the v-expansion-panel-content . if i could apply the same on header clicks , the back-forward navigation of vue-router would work and allow me to navigate between expansion panels . thanks ! < code >
i opened up the documentation a few days ago , and received a message saying there were updates . upon reloading , it appears huge chunks of the documentation are now missing . this is only for the next version , at 2.4.4. i was n't sure if this was intentional and vuetify is moving these things to new repos or what . < code >
hi team , for our internal use we found creating trivial api every-time was time consuming and graphql was just another learning exercise , so i created vnatk-express-sequelize ( ves ) plugin for app side as well as vnatk-vue ( vv ) to have automatic frontends using ves backend . still its in beta but your feedback is welcome , about first impression . i have been part of many other frameworks developed but mainly for php . this is my first contribution to node community . also i coined a term sequelize-ql for the project . < url > < url > < code >
i am getting accessibility failures when i use the expand functionality of the data-table component . is there a way for me to add this aria label ? < code >
i have a v-menu that displays a list of dynamic items ( they can be added/removed ) . on activating the menu it aligns to the bottom of the screen but if items are removed , it no longer aligns to the bottom . the style of the component has a `` top '' value which i ca n't seem to override . is there a property i can use to keep it on the bottom ? < code >
has anyone managed to use data tables and have the first 1 , 2 or 3 columns frozen in place and the remaining columns scrollable left/right and keep the headers on show ? i 've come across css examples and additional packages put i need to keep the functionality and styling the same as the current vuetify data table . many thanks < code >
i try to use the v-data-table constructor . the examples all are with local data . but how can i display external data ( e. g. json data obtained via fetch ? < code >
i need to allow users to select an alternate theme that changes not only the colors but also the font being used . i have the main theme working using the vuetify constructor 's theme property and a variables.scss file . i 've found how to alter the theme being used by modifying the < cur > vuetify var , but i ca n't find any way to modify the font being used . it looks like presets might be an option , but it 's not clear if you can have multiple presets added to the project and select one when calling the vuetify constructor . also , having to publish an npm package just to support changing the font feels overly complex if that 's what is required . can anyone point me in the right direction ? < code >
how to cancel this kind of click shadow ? i only can find the way to disabled to ripple animation but i dont know how to disabled the click shadow < code >
does vuetify support purging css , i realized that i used just a button element in vuetify for testing , and yet , the css is too large . < code >
can you stop screwing around stuff that works alight ? the genius who decided to add a top margin to version 2.4.3 needs to reverse this . one more reason to move away from this annoying framework < code >
i 've got a simple list of checkboxes and it seems that a lot of vertical space is added to them . so for example , here is my view : resulting in : as you can see , i definitely threw a few things at it to try and fix it , but nothing quite worked . any idea ? < code > < template > < v-app > < v-main > < v-card elevation= '' 2 '' > < v-navigation-drawer permanent > < v-list dense nav > < v-list-item v-for= '' ( kt , index ) in corntypes '' : key= '' kt '' link dense shrink > < v-list-item-content > < v-checkbox class= '' shrink mr-0 mt-0 mb-0 '' v-model= '' kerneltypeschecked [ index ] '' : label= '' kt '' dense > < /v-checkbox > < /v-list-item-content > < /v-list-item > < /v-list > < /v-navigation-drawer > < /v-card > < /v-main > < /v-app > < /template > < script > export default { name : 'app ' , data : ( ) = > ( { corntypes : [ `` foo '' , '' goo '' , '' zoo '' ] , kerneltypeschecked : [ ] , } ) } ; < /script >
hi , i wanted to know how vuetify shares color configured in theme section to scss/style ? i know it is a low-level question but i want to know how vuetify syncs/handles this under the hood . regards . < code >
i have a very legacy project with a super complex build script , i ca n't use tree-shaking for this project . i 've already shipped the entire vuetify to the client , it 's so slow 😭 . so i came up with an idea , i can clone the vuetify repo , and delete unused components , and republish it to npm . but i do n't understand which build script should i type . currently , i only need < v-app > ( of course ) and < v-date-picker > this is the one i 'm using . i think i just need to keep these two lines in the vuetify/packages/vuetify/src/components/index.ts file . vuetify/packages/vuetify/src/components/index.ts line 1 in ab936e2 export * from './vapp ' vuetify/packages/vuetify/src/components/index.ts line 26 in ab936e2 export * from './vdatepicker ' but what build command should i run right now ? < code >
hi , i found a problem when i use the slot of data table . the object in my array has a property named payway , i use the slot , but it does n't work . following is my code . view code : js code : < code > < div id= '' app '' > < v-app id= '' inspire '' > < v-data-table : headers= '' headers '' : items= '' desserts '' : items-per-page= '' 5 '' class= '' elevation-1 '' > < ! -- this does n't work -- > < template v-slot : item.payway= '' { item } '' > < span class= '' text-truncate d-inline-block mdui-text-truncate '' style= '' display : inline-block ; max-width : 250px ; '' > { { item.payway } } apend text < /span > < /template > < template v-slot : item.name= '' { item } '' > < span class= '' text-truncate d-inline-block mdui-text-truncate '' style= '' display : inline-block ; max-width : 150px ; '' > { { item.name } } apeend text 1 < /span > < /template > < /v-data-table > < /v-app > < /div > new vue ( { el : ' # app ' , vuetify : new vuetify ( ) , data ( ) { return { headers : [ { text : 'name ' , align : 'start ' , value : 'name ' , } , { text : 'pay way ' , align : 'start ' , value : 'payway ' } , ] , desserts : [ { name : '' my name '' , payway : '' testway '' } ] , } } , } )
hello , before version 2.4 i used a space as placeholder to put the label upside the input , because we find it way more beautiful . now this does n't work anymore .. is there a way to do it now ? < code >
i use v-stepper as alt-labels mode.when the screen change to small then the bottom step label is hidden . how to make sure the label alway show ? < code >
hello . from this page < url > i found that vdatepicker has a .activepicker attribute which can be accessed via < cur > refs [ 'mydatepicker ' ] , i also found that vmenu has < cur > refs [ 'mymenu ' ] .save ( ) method . is there a documentation for these ' < cur > refs interfaces ' on vuetify ? < code >
in my app i use a fullscreen dialog to show record details . it would be great if the users could swipe down to dismiss the dialog but i ca n't get it to work . i 've used the gesture events and have tried to detect the scroll position of the dialog but without success : i can hook in to the swipe event but can not detect the scroll position of the panel in the dialog which i need to determine whether or not it should be closed . i notice there is a 'bounce ' of the dialog when it 's swiped down - it there an event that allows me to react to this so that i can close the dialog ? < code >
my app uses the fullscreen dialog in mobile apps . i 'd really like to be able to dismiss it with a down-swipe but ca n't figure out a way to do it . i 've managed to hook in to the gesture events and can detect the down swipe , but this should only dismiss the dilaog when it 's at the top of it 's scroll position . i just ca n't get a response to the the scroll events . should i be adding the v-scroll directive to the dialog ? or will this only work if the dialog is scrollable ( which it 's not ) ? or should the v-scroll directive be attached to the app element ? i 've used v-scroll : # app but this does n't work either . any help would be much appreciated . thx . < code >
i 'm building a spa , it has a login page ( just a login button ) and several app pages that has appbar , bottomnav . what the best way to have multiple layouts in a spa ? from the documentation : v-app should only be rendered within your application once but then it says : if you are using multiple layouts in your application you will need to ensure each root layout file that will contain vuetify components has a v-app at the root of its template . i 'm a bit confused : i need to include v-app in each layout file , but at the same time it should be rendered once . are there examples how to build a multiple layout spa using vuetify ? the docs about layouts talks about single layout app . < code >
hi , i 'm using webpack with vuetify-loader , and i would like to exclude all sass from the build process to reduce package sizes . i 'm quite new to webpack and ca n't find a way around this . if you have any idea , that would be great ! thank you , jeremy < code > // webpack.config.js const vuetifyloaderplugin = require ( 'vuetify-loader/lib/plugin ' ) module.exports = { module : { plugins : [ new vuetifyloaderplugin ( { match ( originaltag , { kebabtag , cameltag , path , component } ) { if ( kebabtag.startswith ( 'core- ' ) ) { return [ cameltag , 'import < cur > { cameltag } from ' @ /components/core/ < cur > { cameltag.substring ( 4 ) } .vue '' ] } } } ) ] , rules : [ { test : /\.s ( [ ca ] ) ss < cur > / , use : [ 'vue-style-loader ' , 'css-loader ' , { loader : 'sass-loader ' , // requires sass-loader @ ^8.0.0 options : { implementation : require ( 'sass ' ) , sassoptions : { indentedsyntax : true // optional } , } , } , ] , } , ] , } , resolve : { alias : { 'vue < cur > ' : 'vue/dist/vue.esm.js ' } } }
hello , since vuetify does n't support keyboard access in year button in v-date-picker , i need to add keyboard control in that part . so i want to add tabindex=0 and related keypress eventlistener to the year items , which are < li > elements . i find that i can overwrite genyearitem ( year : number ) : vnode in vdatepickeryears.ts to add tabindex and event listener . i also find a link to extend vuetify component . however , the component , vbtn , in the example is a simple component with only one file . vdatepicker is a complex one with many files doing their own jobs . does anyone know how to overwrite genyearitem ( year : number ) : vnode method ? < code >
hi i was wondering if someone could provide a working example of using vuetify form validation where the parent component contains the v-form with a submit button and it also contains a custom component which , for example , wraps a v-textarea which is required . similar to the `` validation with submit & clear '' example here : < url > but using a custom child component . thanks < code >
hello , vuetify 2.3.15 composant : datatable when i click on the row per line menu the menu is displayed in another place . i have try solutions on : < url > buts its not working . use v-app , v-content does not change the trouble . the solution param pagination.sync is outdated . thanks , < code >
hi ! i 'm working on integrating vuetify into my app and i had a question on which components/styling i should be using to properly introduce some scrolling i 'd like to use . i 'd like to have : a fixed parent component with two children the first is a row standing as a `` header '' the second is a container for two side-by-side components these two components should fill the remaining height and have overflow data scroll looking around , it seems like v-list might be sort of what i 'm looking for or the v-virtual-scroller but i 'm not sure how to best make those work with what i 'm looking for . here 's a link to the repo/branch that i 'm currently working with ( rough cut currently ) . you can see where i 've started passing down the height : 100 % in an effort to get the `` fill '' requirement for point 4 above to work but i 've also set the height for the children at a fixed 700px as an interim solution . below is a sketch of what i 'm going for . thanks for any insight ! < code >
i am trying to use the latest next branch from vuetify . so i cloned the repo in my local and checkout the branch 'next ' . i am now trying to add this to my project 's package.json , and i was wondering if there is a way to do it using yarn , something like this , yarn add -- save file : /users/documents/vuetify/packages when i run the above command , i get an error , < code > > yarn add -- save file : /users/documents/vuetify/packages > yarn add v1.22.5 > error missing list of packages to add to your project . > info visit < url > for documentation about this command .
i 'm triying to generate custom category view , in the docs say `` the category view has a slot for each category in the day and timed sections based on the categories given or the categories in the given events '' i have only two events but it 's rendering in every category . thanks ! < code >
i am just going through the calendar component and want to show the full-time slots as starttime-endtime of an event followed by the event name instead of default start time followed by an event name as below in the month view , so is there any way we can achieve this ? < code >
having some issues with attempting to include a filter dropdown icon to the v-date-table header . i 've created the popover menu , i 'm just at a loss on how to get the icon & menu incorporated into a template just like shown in the picture below . the client has stressed that they want various filters for each column ( just like their excel spreadsheets have ) . here 's the generic styling code i 've made for a clickable icon & search popover menu : fa-filter fa-1 < code > < v-card > < v-list-item > < v-list-item-content > < v-text-field v-model= '' message1 '' label= '' enter number '' dense > < /v-text-field > < /v-list-item-content > < /v-list-item > < v-card-actions > < v-spacer > < /v-spacer > < button type= '' button '' class= '' btn btn-default '' > < i class= '' fa fa-times '' > < /i > & nbsp ; clear < /button > < button type= '' button '' class= '' btn btn-primary '' > < i class= '' fa fa-floppy-o '' > < /i > & nbsp ; apply < /button > < /v-card-actions > < /v-card > < /v-menu >
hi guys , first things firts , my english is a work in progress so my apologies if i wrote something wrong . talking about my problem now , i 'm using a v-treeview component in my project but i need to choose what node is displayed based of a field in my list , this can be done ? i dont want to change my list . my code below . < v-treeview : items= '' listverbaregionalbonificacao '' hoverable item-text= '' papeldescricao '' transition > < v-treeview-node item= '' '' > < /v-treeview-node > < /v-treeview > my list ( that i recive of my backend ) nodes also have nodes , that i show below . thanks ! < code >
attached picture shows what i 'm going for . ideally i 'd have two scroll bars ; one at the top and bottom , but i 'd settle for moving it to the top . project is in vue/nuxt , so i 'd prefer to avoid jquery . wondering if vuetify has a solution i 'm missing . < code >
i want to get the item index as a param to the function in the v-list-item-action . but how ? thanks ! < code > < v-list-item v-for= '' ( layer , i ) in layers '' : key= '' i '' > < template v-slot= '' { item , index } '' > < v-list-item-action > < v-btn @ click= '' changevisible ( index ) '' icon > < v-icon color= '' blue darken-2 '' v-if= '' layer.show '' > mdi-eye < /v-icon > < v-icon v-else > mdi-eye-off < /v-icon > < /v-btn > < /v-list-item-action > < v-list-item-title v-text= '' layer.name '' > < /v-list-item-title > < v-list-item-action > < v-btn @ click= '' changeedit '' icon > < v-icon color= '' blue darken-2 '' v-if= '' layer.edit '' > mdi-pencil < /v-icon > < v-icon v-else > mdi-pencil < /v-icon > < /v-btn > < /v-list-item-action > < /template > < /v-list-item >
i am trying to replace the default header of a vdatatable . i 've managed to replace the visuals , but i lost all sorting and width sizing . here 's what i am currently doing : does anyone have an example on how to properly overwrite the default header without losing its capabilities ? thanks in advance . < code > < template v-slot : header= '' { props } '' > < thead > < tr > < th : class= '' [ 'pa-2 ' ] '' v-for= '' h in props.headers '' : key= '' 'th- < cur > { h.text } ' '' > < div > { { _getheaderletter ( h.text ) } } < /div > < div > { { _getheadertext ( h.text ) } } < /div > < /th > < /tr > < /thead > < /template >
i have a vdatatable that i am using to edit data in place . here 's what the current behavior is : as you can see , the only way to close the dialog , is to click outside . i would like the dialog to close when a date is selected . i can see here , that the veditdialog has a handler for the keydown event with enter specifically . if my understanding is correct , this only works for text fields . so my question is , can i close the edit dialog from the vdatepicker 's @ input ? thanks for the help < code >
hello good people anyone used vuetify 's v-item-group and v-data-iterator here i have a problem .. i have rows of v-cards wrapped inside v-cols which are all then wrapped inside a v-item-group with each v-col inside a v-item and then all of that wrapped inside the parent v-data-iterator now ! got two problems the index of selected card does not reflect the index of the same item in the array that was passed to the items props as the source of truth.this changes with each page . when you click a card in one page another card in the same position in all the consecutive pages also get selected . i would love to get the actual index as is in the data source passed to the items props and i would like to stop the consecutive selection of cards . below is a link to reproduce my issue . any help is highly appreciated . < url > < code >
is there any solution for avoid stuck vuetify while installing . first i uninstall previous vuetify version by npm uninstall vuetify and then try to add vuetify using vue add vuetify every time i stucked in same position . i appreciate if some one help me to solve this issue < code >
hello , i am trying to activate specific v-chips from vuetify if the id value they are storing is contained in an ajax response . but v-chips stil remain un-active even if the return , effectively returns just the ids which should activate the chip ... any idea ? < code > < v-chip-group v-model= '' tools '' column multiple > < v-chip filter outlined v-for= '' ( tool , index ) in tooltable '' : key= '' index '' : value= '' tool.tool_id '' : input-value= '' activatechip ( tool ) '' //here i think i should do something : ) > { { tool.tool_name } } < /v-chip > < /v-chip-group > .... methods : { activatechip : function ( tool ) { if ( this.editeditem.tools.includes ( tool.tool_id ) ) { return tool.tool_id } } ,
i notice that the it 's really taking a long time to even comment on an issue . not to mention how long would it take to address it . things use to be more enjoyable when we vuetify version was 1 , 1.5. i understand that everyone is busy , but it should take really little time just to take a look at new issues , tag them , and at least give an idea if this going to be a no-fix or stir to the right direction . < code >
( very new to vue , js and the like , question might be rookie ) trying to implement a plotly graph into vue , which works : however when trying any other probs then height or width for v-card , they simpley wo n't work . ( vuetify 2.3.12 ) < code > < template > < div > < v-card height=1000 > < plotlygraph : propdata= '' plotinfo '' divid= '' plot '' style= '' height : 500 '' > < /plotlygraph > < /v-card > < /div > < /template >
maybe i 'm missing something but when i try to apply my own class to a v-button the style does n't show unless i add ! important ( which is a bad practice ) . how could i style just one component without using important ? < code > < v-btn class= '' btn-add '' > add todo < /v-btn > .btn-add { height : 49px ! important ; }
hi . need to customise v-autocompite comp . - add static header upper listbox ( try to do this by using # prepend-item slot and sticky css position but in such way scrool over this `` header '' ) . is there some good way to ovveride v-autocomplite markup or add some prepend element by using slot ? < code >
hello ! i want to build one-column layout having maximum width = 1200px . also it should have a permanent navigation drawer on the right side . on narrow screen sizes the conent area can shrink . but when screen is large , content can not be larger than 1200px . space should be added from left and right sides in that case . my problem is that when i set max-width to the content , the navigation drawer is always pinned to the right side of screen , while content area is centered . is it possible to pin navigation drawer to right side of the content instead of the right side of screen ? < code >
on this page ( < url > ) in vuetify docs , there is an information about bootstraping vuetify when running unit tests . i have a project created using vue cli . as a testing framework i have chosen jest . how can i create a setup file in jest ? i was searching for this on the internet but i can not find anything . < code >
problem to solve i could n't find anything looking for `` svelte '' in the issues . proposed solution this is why i ask aloud : will there ever be a version of vuetify for svelte ? < code >
i want to change this color : i have read the component 's documentation and tried some css attributes but did n't manage to do it . < code >
do you find github discussions useful as a communication channel ? maybe not ? hello developers ! i am raula gaikovina kula , a software engineering researcher < url > together with a team of researchers , we are interested in your thoughts about using the github discussions beta . we noticed that your project is currently using . we have developed a simple 3 question survey that could take up to 5 mins to complete . < url > thank you in advance for your time and apologize if this is not a proper use of this channel . @ raux raula , phd on behalf of hideaki , sebastian , nicole and christoph < code >
hi everyone , i 'm learning how to use vue and vuetify , and i 'm not being able to overwrite components css classes . i was wondering if it 's something that i done wrong , like a project configuration . in the example below i have a v-app-bar and i want to make my v-tab text color white when active or inactive . < url > i really do n't want to use ! important like i did for the background-color . sorry if i 'm posting this in the wrong place - quite new to github community . < code > < template > < v-parallax src= '' ~ @ /assets/black-woman-reading-book-library.jpg '' > < div class= '' overlay '' > < v-app-bar app class= '' main-menu '' > < v-tabs right > < v-tab > tab 1 < /v-tab > < v-tab > tab 2 < /v-tab > < v-tab > tab 3 < /v-tab > < /v-tabs > < /v-app-bar > < /div > < /v-parallax > < /template > < script lang= '' ts '' > import { component , vue } from 'vue-property-decorator ' ; @ component export default class helloworld extends vue { } < /script > < ! -- add `` scoped '' attribute to limit css to this component only -- > < style scoped lang= '' scss '' > .overlay { position : absolute ; top : 0 ; left : 0 ; width : 100 % ; height : 100 % ; background-color : rgba ( # 262bdb , 40 % ) ; } .main-menu { background-color : transparent ! important ; .v-tabs .v-tab { color : white ; } } < /style >
and in app.vue i found the tooltip does not show when cursor hovering the h3 text ? is it possible to do that ? < code > < template > < v-tooltip bottom > < template # activator= '' { on , attrs } '' > < my-test v-on= '' on '' / > < /template > < span > test < /span > < /v-tooltip > < /template > < script > import mytest from `` my-test.vue '' ; export default { name : `` app '' , components : { mytest } , } < /script > < style scoped > < /style > for example . i have a component my-test.vue like this . < template > < h3 > test < /h3 > < /template > < script > export default { name : `` test '' , } < /script > < style scoped > < /style >
hi all , i just posted this in discord before finding out about this , so please pardon the repost i have been given a web design to implement and am trying to implement the style palette . colours were simple using the standard theme approach , and the fonts/weights/sizes were also pretty straightforward using scss/sass overrides as per the documentation - thank you to whoever wrote that up and added an example ! ! another brilliant resource are the new presets too . i have one final problem i ca n't seem to figure out - the pallete has specified h3 to be italic font . i 've got the font , weight , size , linesize all done but ca n't see where i can specify a font style in the sass and i think maybe i ca n't ? the other thing i thought of doing is importing the italic version of the font , but that seems overkill just for one single style setting . any ideas much appreciated ! < code >
hi all ! first , i wanted to report that v-list-item-group is not in the api widget of the list page ( but it is in the main api widget ) second , i wanted to have more details about this component , as it is not very documented i am making a settings page based on this example : < url > i ca n't understand the behavior of the v-list-item-group model array : it behaves inconsistently and i ca n't find how to load default values for the v-list-item-group model . here is a pen replicating what i mean : < url > it 's edited from the doc example . i changed @ click= '' toggle '' to @ change= '' toggle ; updatevuex ( ' 4 ' , < cur > event ) '' to get back the field id and its value ( < cur > event being the checkbox value ) and i log the model object of v-list-item-group at each change . note also that my attempt to define default values in data did n't work as expected ( if it was an array of boolean values as model ) < code >
typescript 4.7 requires this syntax to import esm module from a typescript file : const { installconsoleapi } = await import ( `` @ pricingmonkey/ui/src/devtools/consoleapi.mjs '' ) ; the file itself however has a typescript specific extension : consoleapi.mts . i know how to configure webpack to resolve imports by trying different suffixes ( via resolve.extensions ) , but i do n't know how to replace an 'mjs ' to 'mts ' during resolution . am i doing something wrong here - i 'm rather lost ... < code >
this is likely a non-standard use case - however the original disussion between myself and babylonjs devs is here : js forums the summary is that babylonjs has a component that can be imported via a simple import 'script ' call , but that does n't actually get enabled unless you then call an actual command there after . the code i am using is designed to be aware of if you are running normally , or if it is inside a webworker , but because the component is added via typescript import i 'm fairly sure i can not have runtime conditionals on the import statement . when this component is added , the webpack style-loader component is run and it tries to access the dom to inject various stylings which ultimately are not used . a minimal reproduction of this issue is here : github project though the project has n't been updated the related issues persist with the latest versions . my question is , is there a change that either babylonjs devs , or webpack devs can make such that style-loader is dom aware , or is there something i can edit to achieve this . my current solution is to patch styledomapi locally to be a noop if it has no document object . < code >
a lot of web developers seem to be switching to vite.js these days . it seems a lot faster ( especially for larger projects ) since it does n't compile the whole app but only the parts that are needed . what are your thoughts ? < code >
i want to find files that are not referenced in the project.how can i find the list of files imported by webpack in webpack to help me complete this requirement ? < code >
hello . i have a custom plugin and a custom loader . inside the plugin 's apply method , i want to perform certain actions , but only if the target is the same as inside my custom loader . getting the target inside the loader is very easy ( < url > ) . but how to get it inside the plugin ? can i rely on the compilation.options.loader.target value ? code example : custom loader : custom plugin : < code > module.export = function ( source ) { if ( this.target === 'web ' ) { // do some job } } compiler.hooks.thiscompilation.tap ( 'mycustompluginname ' , ( compilation ) = > { const target = compilation.options.loader.target ; // is that correct ? compilation.hooks.processassets.tap ( 'mycustompluginname ' , ( ) = > { if ( target === 'web ' ) { //same as in my custom loader // do some job
hi , the documentation for webpack 5 says that webpack no longer needs worker-loader to load web worker files . this is reinforced by the readme on the worker-loader page , which warns that worker-loader is only intended for use with webpack 4 and is not supposed to be used with webpack 5. however , the example of worker usage in the webpack docs is very simple it assumes that developers author their worker files in javascript . how should one configure webpack to be able to load workers authored in typescript ? < code >
i wan na try change chunkid like this : before : changed : i tried write a custom plugin but got failed used webpack 4+ < code > ( window [ `` webpackjsonp '' ] = window [ `` webpackjsonp '' ] || [ ] ) .push ( [ [ `` investment/self/detail/index_hash '' ] , { ... ( window [ `` webpackjsonp '' ] = window [ `` webpackjsonp '' ] || [ ] ) .push ( [ [ `` investment/self/detail/index '' ] , { ... compilation.hooks.optimizechunkids.tap ( 'chunkidhash ' , chunks = > { chunks.foreach ( chunk = > chunk.id = ' < cur > { chunk.id } _ < cur > { hash } ' ) } )
i recently upgraded to webpack 5 , and i 'm noticing that our builds no longer have deterministic outputs . i 've narrowed down the issue to optimization.concatenatemodules when i set it to false , i get the same output on every build , although i 'd like to keep concatenatemodules on . with it on , the output just differs slightly . it looks like the modules are being concatenated in different orders ? for example : any idea what might be causing this ? not sure if it 's a bug in the moduleconcatenationplugin , but given that i have n't seen any other issues about this or any mention of this problem online , i figure maybe there 's something in our configuration that could be causing this ? < code > - et = new pt ( ct ) , - kt = new ht ( ct ) ; + et = new ht ( ct ) , + kt = new pt ( ct ) ;
hi , why do i always get the can not use imports statement error when using webpack ? it 's not for the babel-presets because i 've them installed and configured ... < code >
i 'm trying to figure this out since days now but i simply ca n't get my head around what 's going on . i further do n't know if this problem is babel related or if it originates from webpack . i have a monorepo with 3 apps which all rely on components from packages inside app specific components i import eg . components like inside packages i have aliased imports , eg . requesting a component in providers the tsconfig.json in packages defines the local aliases in my webpack.config.ts i define the aliases like it all works but when i check my bundle i get a main chunk with the entire content from packages ? does that have something to do with my aliases or should i do something with my chunk settings ? here 's a screenshot from the bundle analyzer : especially interesting is the iconpack_default , from which i dynamically import icons . i would have expected this to put every icon inside a separate chunk ... i know , this might be quite vague but i 'd appreciate any kind of push in the right direction ! thanks ! 🙌 < code > { ... `` paths '' : { `` frontend/components '' : [ `` ./components '' ] , ... } { resolve : { alias : { components : resolve ( __dirname , `` .. / .. / .. /frontend/apps/campus/src/components '' ) // < -- resembles the absolute path to the config file } } } import { mycomponent } from 'packages/components ' ; import { mycomponent } from 'frontend/components ' ; frontend/ apps/ < -- each app is a package in the scope of the monroe app1/ ... packages/ < -- this is a package in the monorepo scope components/ providers/ ...
hi , i have an issue with webpack dev server ( 4.7.4 ) and webpack ( 5.69.1 ) . it works fine but the memory usage grows with each change for about 100 mb and then eventually crashs when 6gb are reached . this is the maximum i have configured . i have made a memory dump with chrome and i see a lot of cashed files , but i do n't know if this is normal or not . sometimes it is even the same file : any ideas how to debug this further ? < code >
i made a simple webpage like < text > { `` 9 '' } < /text > . i then changed it to < text > { `` 10 '' } < /text > . this is what happens . clearly , the client did receive a 10 somewhere , but it did not install it on the webpage successfully : < code >
hi , i 'm wondering if there 's any way to have different bundles and use one of them if the admin logs in . or if a user logs in there is n't a file like admin.js bundle for security for instance . thanks in advance . < code >
i using webpack4+ now , the image assets path in chunk is public path + assets name like this : i wan na chang it to : < code > / * * * / `` ./src/assets/login/logo.png ? 012e5df7379fece1f0e59d488c0e381b '' : / * * * / ( function ( module , exports , __webpack_require__ ) { module.exports = __webpack_require__.p + `` assets/logo.png '' ; / * * * / } ) , / * * * / `` ./src/assets/login/logo.png ? 012e5df7379fece1f0e59d488c0e381b '' : / * * * / ( function ( module , exports , __webpack_require__ ) { module.exports = __webpack_require__.__custom_path__ + `` assets/logo.png '' ; / * * * / } ) ,
hi all . i 'm trying to add a virtual module which exports specific files , which i need to use in bundle . content looks like this : also , it should be possible to use it in watch mode , which means the content of this virtual module can be dynamic . first part of task solved by webpack-virtual-modules , but for some reason this plugin updates content only once and new files ca n't be added to virtual module . so , maybe someone tried to solve this issue or any suggestions ? example of my plugin : thank you < code > const compilation = require ( 'webpack ' ) .compilation ; const compiler = require ( 'webpack ' ) .compiler ; const virtualmodulesplugin = require ( 'webpack-virtual-modules ' ) ; const plugin_name = 'customvirtualplugin ' ; class customvirtualplugin { / * * * @ param { compiler } compiler context path for entry * @ returns { void } returns * / apply ( compiler ) { const virtualmodulesplugin = new virtualmodulesplugin ( { './test-virtual.js ' : 'console.log ( 'test virtual ' ) ' } ) ; virtualmodulesplugin.apply ( compiler ) ; let count = 0 ; setinterval ( ( ) = > { console.log ( 'call rebuild ' ) ; virtualmodulesplugin.writemodule ( './test-virtual.js ' , 'console.log ( ' < cur > { count++ } ' ) ' ) ; } , 10000 ) } } module.exports = customvirtualplugin ; module.exports = { ' a-name ' : import ( ' a.specific.js ' ) , ' b-name ' : import ( ' b.specific.js ' ) , }
hi ! i 'm using all these things sharedworker - cra - webpack4 - signalr and react-app-rewired , when i do npm run build - > does n't generate any file . if i comment the following const connection = new signalr.hubconnectionbuilder ( ) .withurl ( 'test ' ) .withautomaticreconnect ( ) .build ( ) ; it works . i 'll attach the source code , you can dowload and do npm install npm run build and you 'll see myapp.zip if i do npm start , the app work without problem and use the library without any problem . any help would be very appreciate < code >
i need to host all assets in cdn , but web worker requires the same domain policy . the below code works correctly if i do n't use cdn . here are the docs < url > but they do n't mention how to make inline workers . worker-loader for webpack4 < url > webworkers are restricted by a same-origin policy , so if your webpack assets are not being served from the same origin as your application , their download may be blocked by your browser . this scenario can commonly occur if you are hosting your assets under a cdn domain . even downloads from the webpack-dev-server could be blocked . there are two workarounds : firstly , you can inline the worker as a blob instead of downloading it as an external script via the inline parameter in the old approach , there is a workaround for it , but i ca n't find any solutions for wepback5 . i know , it 's possible to use a proxy from the same domain , but i need to use cdn because of the performance . < code > this.worker = new worker ( new url ( './bundlerservice.worker.ts ' , import.meta.url ) ) ;
so , i am trying to use webpack to do srr with react . you can see the entire code here : < url > right now i got no errors showing , but the localhost is n't showing any text , however , it is showing the css for the background ? go figure .. is there any links to follow a basic setup for react ? maybe i am missing a plugin ? a loader ? following the react regular set up , and the webpack-config.js the main files that i think are in play look like this : index.html app.js index.js < code > < ! doctype html > < html lang= '' en '' > < head > < meta charset= '' utf-8 '' / > < meta http-equiv= '' x-ua-compatible '' content= '' ie=edge '' / > < meta name= '' viewport '' content= '' width=device-width , initial-scale=1.0 '' / > < title > document < /title > < /head > < body > < h1 id= '' app '' > < /h1 > < /body > < /html > import `` .. /styles.css '' ; import `` .. /styles.scss '' ; function app ( ) { return ( < div classname= '' app '' > < h1 > hello ! < /h1 > < /div > ) ; } export default app ; import react from `` react '' ; import reactdom from `` react-dom '' ; import app from `` ./components/app '' ; reactdom.render ( < app / > , document.getelementbyid ( `` app '' ) ) ;
i got a few courses from udemy , but kind of old ( very old ) and does n't work with new downloads . how / where i can learn webpack and implement the new versions for new websites ? right now i am looking to do a website with ssr using webpack and babel . < code >
as title . i cloned the same project into another directory on my computer , and i tried to build it in this new location . it turns out the hash is different than the old one . why ? some of the files of the project are git-ignored , so i have to copy-paste these files into this new location . i guess the hash is different because these files have a different created dates and this info is used when generating the hash ? < code >
bug report what is the current behavior ? 1.dbcwebmainapp exposes some modules 2. webpack.config.js set optimization.runtimechunk : 'single ' for hmr work 3. hmr work well , but dbcwebsubapp error loading module 4. if webpack.config.js set optimization.runtimechunk : false , modules load success , but hmr not work repository : < url > start app : npm run dev dbcwebmainapp run at < url > dbcwebsubapp run at < url > other relevant information : webpack version : 5.51.1 webpack-cli version : 4.8.0 webpack-dev-server version : 3.11.2 node.js version : 14.16.1 operating system : win10 < code >
as title . the .js-file is machine-generated , so i should not edit it directly . but now i have to import these globals . do we have any plugin to achieve this ? so i can write : and then the var foo can be accessed from the other modules as if it 's a global variable . < code > import './path/to/the/generated/foobar.js '
hello , i am working on a library and currently i build it by gulp , because i can process each module and have the same modules structure . for example apply css modules rules , transform ts to js , convert svg to react components etc . i wonder if it is possible to have the same behaviour using webpack , not to create single file but leave the files structure ? thanks . < code >
i am creating a webpack-plugin . there is a scenario where a css file is dynamically created based on a specific source code ( e.g. , .tsx ) .the creation of the css file is done once with all source code combined . this means that sequential execution is not possible for each source code fetch . the css file is then written out as a virtual module . is there a good way to accomplish this scenario ? in the buildmodule hook , rawsource does not exist . ( i do n't want to read file ) the succeedmodule hook has a rawsource , but it is already built , so updates to the virtual module will not be reflected . reference the example is an entry point , importing a virtual module . the virtual module map.css is output with the classes extracted from the .tsx file mapped as styles . mapcss maps classes to css statements . < code > // b.tsx export default b = ( ) = > < div classname= '' inline-block '' > b < /div > // a.tsx export default a = ( ) = > < div classname= '' block '' > a < /div > // index.ts import `` map.css '' import a from `` a.tsx '' import b from `` b.tsx '' .block { display : block } .inline-block { display : inline-block }
i 'm getting the following error in ie11 : object does n't support property or method 'endswith ' it appears to be caused by a recent ( 3/18/2022 ) change in createsocketurl.js where was changed to i 've tried to add a polyfill for `` endswith '' , but it does n't appear to work . perhaps i 'm not adding it in the right place ( index.js of my react application ) . does anyone know where i should be adding the polyfill or is there a way to prevent the code in question from being included in my dev build ? < code > if ( protocol & & protocol.substr ( -1 ) ! == `` : '' ) { protocol += `` : '' ; } if ( protocol & & ! protocol.endswith ( `` : '' ) ) { protocol += `` : '' ; }
bug report what is the current behavior ? i use webpack v5 , output 'commonjs2 ' , and use externals config . the output can not work in webpack v4 , webpack-dev-server v3 . if the current behavior is a bug , please provide the steps to reproduce . minimal repro : < url > in lib dir , npm run build , then npm link in proj dir , npm link @ koreyhan/webpack5-lib , then npm run dev will get error in browser : uncaught typeerror : __webpack_require__ is not a function what is the expected behavior ? it should work other relevant information : webpack version : lib : 5.51.1 , proj : 4.2.0 node.js version : v10.16.0 operating system : mac os 11.3.1 additional tools : < code >
i 'm currently trying to patch a file in an npm package with a loader based on data inferred from parsing my source code how do i ensure my loader only executes on node_modules/some-package/src/index after all my parser hooks have finished scanning my source files ? < code > const names = new set < string > ( ) compiler.hooks.normalmodulefactory.tap ( plugin_name , ( normalmodulefactory ) = > { const onparsercreated = ( parser : javascript.javascriptparser ) = > { parser.hooks.program.tap ( plugin_name , ( ast ) = > { const name = ... // scan ast for identifiers that i 'm interested in names.add ( name ) } ) } normalmodulefactory.hooks.parser.for ( 'javascript/auto ' ) .tap ( plugin_name , onparsercreated ) normalmodulefactory.hooks.parser.for ( 'javascript/dynamic ' ) .tap ( plugin_name , onparsercreated ) normalmodulefactory.hooks.parser.for ( 'javascript/esm ' ) .tap ( plugin_name , onparsercreated ) } ) compiler.hooks.compilation.tap ( plugin_name , ( compilation ) = > { normalmodule.getcompilationhooks ( compilation ) .beforeloaders.tap ( plugin_name , ( loaderitems , normalmodule ) = > { const request = normalmodule.request if ( ! /node_modules\/some-package\/src\/index/.test ( request ) ) { return } const packagejson = normalmodule.resourceresolvedata ? .descriptionfiledata as record < string , unknown > packagejson.sideeffects = false const loaderpath = path.join ( __dirname , ' .. /loader ' ) const loaderext = existssync ( ' < cur > { loaderpath } .ts ' ) ? 'ts ' : 'js ' const loader = ' < cur > { loaderpath } . < cur > { loaderext } ' loaderitems.push ( { loader , options : { // names = [ ] at this point because parser hooks have not ran yet } , ident : null , type : null , } ) } ) } )
i 've run into a problem when trying to upgrade from webpack v4 to v5 . the problem is specifically with this line : < url > in the imported module the typescript code has already been transformed to the following javascript : i.e . it 's an esm file but includes an inline require . under webpack v4 this inline require was transformed into a __webpack_require__ and everything was fine , but under webpack v5 i am left with a raw require which fails after packaging as node_modules/ is no longer available . is this expected behaviour ? can anyone offer me any pointers on how to go about resolving this ? ( ps : i 'm using babel with webpack , please accept my apologies if i 've misunderstood the boundaries of responsibility between the two and this is actually a babel issue . ) thanks in advance for any help you can provide . < code > import { getmarkupfromtree } from `` ./getdatafromtree.js '' ; export function rendertostringwithdata ( component ) { return getmarkupfromtree ( { tree : component , renderfunction : require ( 'react-dom/server ' ) .rendertostring } ) ; } // # sourcemappingurl=rendertostringwithdata.js.map
in a project we 've converted svg files into svgz ( gzipped svg ) with the webpack compressionplugin . this works great whith the transpiled project as served on an apache server with .htaccess using however , webpack dev server clearly does n't use the .htaccess config and so browsers are failing to understand the svgz files as no encoding has been set to gzip on the svgz file type . there is a headers option in the devserver config object , but afaik that 's for all files and can not be made conditionally . i also do n't know what header to set exactly . i tried the following , but it did n't work : how can we set the encoding of already zipped files to gzip on svgz files when served with webpack dev server so browsers know they need to uncompress them ? thanks in advance ! < code > config.devserver = { host : 'localhost ' , port : 8080 , static : buildpath , compress : false , proxy : { ' * .svgz ' : { target : ' < url > ' , headers : { 'content-encoding ' : 'gzip ' , } , } , } , } ; addtype 'image/svg+xml ' .svg .svgz addencoding gzip svgz
hi ! i would like to use the new worker import syntax : to share code between the main thread and the worker . unfortunately , the project i 'm working on uses cdn on a separate domain , and i get cors error . would it be possible to add some option in webpack configuration or somewhere else to use work-around with importscript ? the transformation could be : from : to : < code > const worker = new worker ( new url ( './worker ' , import.meta.url ) ) ; const objecturl = url.createobjecturl ( new blob ( [ 'importscripts ( < cur > { json.stringify ( generatedurltoworker ) } ) ; ' ] , { type : 'application/javascript ' } ) ) ; const worker = new worker ( objecturl ) ; url.revokeobjecturl ( objecturl ) ;
i have a project with multiple html/jsx pages under a central directory . when i run `` webpack -- mode=development -- watch '' i was expecting that only the chunks generated from changed jsx would be re-emitted into the build directory . instead , chunks are re-emitted for all of the pages under the central directory when the jsx on any one page is modified . i do n't know necessarily that unchanged chunks are being recompiled , but they are being re-emitted , with different mangling extensions ( e.g . foo.61e8.js is added to a subdirectory that before only had foo.ea5d.js ) i would n't expect any files to be re-emitted that have n't changed . should i file an issue for this to get it fixed ? i 'm using webpack 5.70.0 < code >
from the webpack v5 migration guide , point # 12 : when using a custom configuration , drop name : false and replace name : string | function with idhint : string | function . it 's suggesting me to change from name to idhint . but the page splitchunks.cachegroups . { cachegroup } .idhint shows no information about what 's the benefit of doing this ? < code >
hey webpack community ! i am doing some research how we could do polyfilling / ponyfilling more effectively with babel-preset-env 's option usebuiltins=usage . i thought about a cachegroup that collects all polyfills in an own bundle file , for example : now , i need to somehow load that file only when i detect a legacy browser . what condition could be used here , and how can i put the conditional require directly into the bundle ( the html webpack plugin is n't an option because it is enqueued in a wordpress plugin ) ? should i use another approach ? does something like a `` best practice '' exist to use usebuiltins=usage with own chunk file ? i also stumbled over webpack-polyfill-injector which looks promising . it has a very clever way how it injects missing functionalities . unfortunately , it looks unmaintained . how do you handle this ? regards , matthew 😊 < code > `` vendor-polyfills '' : { test : /node_modules\/ ( core-js|whatwg-fetch ) / , chunks : `` initial '' , enforce : true } ,
i have encountered a bug in angular when running inside an android webview . after investigating i found out the scripts with type= '' module '' do not send credentials by default , even for the same origin . this naturally breaks the angular application since the scripts fail to load . there is a build option that forces adding the crossorigin for the initial scripts , however , this does n't work for lazy loaded scripts . the answer i got from the angular team is that it can not be done because it is a webpack mechanism . following is the final answer , followed by a link to the issue . angular team answer : this is not actionable from our end as that is how webpack handles crossorigin . webpack/lib/runtime/loadscriptruntimemodule.js lines 89 to 96 in c181294 crossoriginloading ? template.asstring ( [ `` if ( script.src.indexof ( window.location.origin + '/ ' ) ! == 0 ) { `` , template.indent ( 'script.crossorigin = < cur > { json.stringify ( crossoriginloading ) } ; ' ) , `` } '' ] ) issue : angular/angular-cli # 22942 ( comment ) does anyone know how this can be achieved ? for webview to work a crossorigin must be added for type= '' module '' scripts , even inside the same origin . right now i manually edit the runtime.js file after creation to remove the same origin check . < code >
consider the following set of files . notice that the `` unusedfunction '' in dependency.js dynamically imports dynamic.js and will be removed in a final production build : when the final production build is produced two files are created : 1 file with the index.js code and used function from dependency.js and 1 file for the dynamic import from the unused function ( called 815.js in my case ) . in the process of pruning unused code from the build , the unused function which imported 815.js was removed from the bundle and therefore 815.js is no longer imported anywhere and no longer needed . is there any way to get webpack to remove these now-orphaned chunks after unused export pruning has occurred ? if not is there a way to detect them so i can remove them manually ? thank you ! < code > // index.js import { usedfunction } from './dependency.js ' ; usedfunction ( ) ; // dependency.js export function usedfunction ( ) { console.log ( 'used ' ) ; } export function unusedfunction ( ) { import ( './dynamic.js ' ) .then ( mod = > mod.func ( ) ) ; } // dynamic.js export function func ( ) { console.log ( 'dynamic import log ' ) ; }
os : macos webpack : 5.65.0 what is the current behavior ? dynamic import module not tree shaking about unused variable example main.js a.js b.js output test is unused variable , it 's not tree shaking . < code >
i cloned the webpack repository and build the side-effect example . i add another export variable test to the a.js in the big-module-with-flag . as i do n't use the test variable , so i expect webpack will remove it from the bundle . but the fact is the test variable is included in the bundle . readme.md @ sokra , would you mind explaining more details on this ? thanks in advance . < code >
hi . quoting from the < url > ensure no compilers transform your es2015 module syntax into commonjs modules ( this is the default behavior of the popular babel preset @ babel/preset-env - see the documentation for more details ) . however < url > says the default mod is `` auto '' , where the actual value is determined from the caller . just wanting to confirm , does docs need a change regarding this ? < code >
what determines if a file is `` dirty '' ? if i set these options to true for eslint or stylelint webpack plugins , it no longer gives me errors or warnings in files that i know have issues and have recently been changed . for some context . i 'm trying to add linting rules to an existing project and do n't want old files to break builds . i only want files actually being worked on to be linted . but if i enable those rules and make changes to some files , those files still do n't get linted . < code >
simple , the nodejs webpack api does n't run the same way as the webpack command line . i 'm trying to write custom loaders and plugins , i 'm stuck at the loaders and after banging my head , i see that it does n't even work the same way as the command line one does . why is this ? how can i make the webpack node api behavior is the same way as the webpack command line ? i want to get the file content from the loader and it does n't pass that when call via node api , it pass a object { resouce : '/path/to/file.js ' , ... //other stuff } instead of a file i get the above . how do i get the file while running webpack with the nodejs api ? < code >
hello , when defining a cache group where the name refers to an existing chunk , there is a validation check done to ensure that the existing chunk is a parent of all selected chunks being considered in the cache group . the code is here but i 'll paste the interesting section for reference : if it finds that the existing chunk is not in the same group as a selected chunk , it then looks at all of the parent groups and it will only succeed if every one of those parent groups contains the existing chunks . is this intentional ? it seems quite a high bar to say that a chunk must belong to every single parent group . is n't belonging to one parent enough ? if i understand , that should be enough to ensure the existing chunk gets loaded before the selected chunk . i 'm wondering if that continue should actually be a break instead ? < code > // module can only be moved into the existing chunk if the existing chunk // is a parent of all selected chunks let isinallparents = true ; / * * @ type { set < chunkgroup > } * / const queue = new set ( ) ; for ( const chunk of selectedchunks ) { for ( const group of chunk.groupsiterable ) { queue.add ( group ) ; } } for ( const group of queue ) { if ( existingchunk.isingroup ( group ) ) continue ; let hasparent = false ; for ( const parent of group.parentsiterable ) { hasparent = true ; queue.add ( parent ) ; } if ( ! hasparent ) { isinallparents = false ; } }
i 've been trying to upgrade my ssr project to use es6 on both the server and client but ran into an issue with hmr . on changes the compilation fails at this line webpack/lib/esm/modulechunkformatplugin.js line 52 in 86a8bd9 `` hmr is not implemented for module chunk format yet '' due to wip . can i somewhere see how much progress has been made on this so far ? thank you for your response in advance . < code >
hi , i have an angular application which works independently . also there is a flutter web build for a certain feature which runs independently . i would like to use the flutter web app as a micro frontend which can be viewed in angular shell application using angular routes . does the webpack plugin support flutter apps ? thanks a lot . < code >
i know it is easy to turn minification off globally , but is there a way to annotate a file to prevent it from getting minified by the bundler ? < code >
the webpack documentation on module.rules is quite sparse : [ rule ] an array of rules which are matched to requests when modules are created . these rules can modify how the module is created . they can apply loaders to the module , or modify the parser . in the html-loader documentation , a number of examples exist with two rules testing for the same regular expression , e.g . : what is the reason/result/effect/desire of having two rules handling the same file ? why is n't a single rule being used ? < code > module.exports = { output : { assetmodulefilename : `` [ name ] [ ext ] '' , } , module : { rules : [ { test : /\.html < cur > / , type : `` asset/resource '' , generator : { filename : `` [ name ] [ ext ] '' , } , } , { test : /\.html < cur > /i , use : [ `` extract-loader '' , `` html-loader '' ] , } , ] , } , } ; module.exports = { output : { assetmodulefilename : `` [ name ] [ ext ] '' , } , module : { rules : [ { test : /\.html < cur > / , use : [ `` extract-loader '' , `` html-loader '' ] , type : `` asset/resource '' , generator : { filename : `` [ name ] [ ext ] '' , } , } ] , } , } ;
in webpack 4 , i was used to set the external network url of the dev server as follows : in the webpack 5 docs however , i ca n't find this option . how to configure this ? < code > module.exports = { // ... devserver : { public : 'myapp.test:80 ' } } ;
using webpack on different platforms to bundle an application results in different hashes and in some instances even different chunk ids . the respective portion of our webpack configuration looks as follows : the hashes on linux and mac are identical . on windows they differ . we found out that the only thing inside the generated chunks that differs is the order of the keys of the module objects . any idea on how to ensure identical hashes for identical sources regardless of the platform the code is bundled on ? < code > output : { filename : ' [ name ] . [ contenthash ] .js ' , chunkfilename : ' [ name ] . [ contenthash ] .chunk.js ' , ... } ,
i 'm upgrading webpack-dev-server from v3 to v4 on a project using razzlejs with webpack v5 . i proxy websockets using the following config : i had to set webpackconfig.devserver.websocketserver = false to make it work , otherwise i was getting rangeerror : invalid websocket frame : invalid status code 2122 errors ( with different status codes ) and was receiving messages with hot/livereload/reconnect/hash/ok as type on the client side . oh is it that the webpack-dev-server websocket server is interfering with my websocket server ? if so , is it possible to change the webpack-dev-server websocket server config to put it on another path than /ws ? i would appreciate any insight on this . let me know if you need more details . thank you . < code > webpackconfig.devserver.proxy = { '/ws ' : { target : targethost , secure : false , ws : true , loglevel : 'silent ' , // silence proxy onerror : ( err , req , res ) = > { console.error ( err ) } , } , ' ! /static ' : { target : targethost , secure : false , loglevel : 'silent ' , // silence proxy } , }
i 'm making a webpack plugin in webpack @ 4. i have below code in my project , like const home = lazy ( ( ) = > import ( / * webpackchunkname : `` home '' * / ' @ src/routes/index ' ) ) ; plugin code is : < code > compiler.hooks.compilation.tap ( this.pluginname , ( compilation , { normalmodulefactory } ) = > { const handler = ( parser , options ) = > { parser.hooks.importcall.tap ( this.pluginname , ( expr ) = > { if ( parser.state.current.resource.includes ( 'node_modules ' ) ) { return ; } if ( expr.arguments.length ! == 1 ) { throw new error ( `` incorrect number of arguments provided to 'import ( module : string ) - > promise ' . '' ) ; } const param = parser.evaluateexpression ( expr.arguments [ 0 ] ) ; // i want to get dynamic import module info , such as ' @ src/routes/index ' } ) } normalmodulefactory.hooks.parser .for ( `` javascript/auto '' ) .tap ( this.pluginname , handler ) ; normalmodulefactory.hooks.parser .for ( `` javascript/dynamic '' ) .tap ( this.pluginname , handler ) ; normalmodulefactory.hooks.parser .for ( `` javascript/esm '' ) .tap ( this.pluginname , handler ) ; } ) ;
i 've added configuration : i would expect subsequent builds to be faster , however , i am not seeing any change and there is nothing in the logs about using / not using cache . how to verify that cache is being used ? < code > cache : { cachedirectory : path.resolve ( __dirname , '.webpack-cache ' ) , type : 'filesystem ' , } ,
i have imported some npm modules along with their css . import 'remixicon/fonts/remixicon.css ' ; i have added loader for css i am getting unknown error from every css module that imported in project . this above error getting for remixicon library . similarly every imported css giving error at its first line . please let me know what can i do to fix this ? < code > { test : /\.css < cur > / , use : [ { loader : minicssextractplugin.loader , } , { loader : 'css-loader ' , } , ] , } , @ font-face { ^ syntaxerror : invalid or unexpected token at wrapsafe ( internal/modules/cjs/loader.js:988:16 ) at module._compile ( internal/modules/cjs/loader.js:1036:27 ) at object.module._extensions .. js ( internal/modules/cjs/loader.js:1101:10 ) at module.load ( internal/modules/cjs/loader.js:937:32 ) at function.module._load ( internal/modules/cjs/loader.js:778:12 ) at module.require ( internal/modules/cjs/loader.js:961:19 ) at require ( internal/modules/cjs/helpers.js:92:18 ) at object.remixicon/fonts/remixicon.css ( /users/utkarshgupta/documents/fynd/quintessa/dist/server/index.js:6449:18 ) at __webpack_require__ ( /users/utkarshgupta/documents/fynd/quintessa/dist/server/index.js:6649:41 ) at eval ( webpack : //quintessa/./src/app.js ? :6:87 )
referring to this configuration : < url > would it be safe to set it to : the idea is that we would use this configuration on a ci/cd runner vm . however , the catch is that there are other webpack projects built on the same vm . the goal is to speed up webpack builds on vms that run tests . < code > cache : { cachedirectory : '/tmp/.webpack_cache ' , type : 'filesystem ' , } ,
for certain assets in our project we do n't want the exported filename to change so we used to override the default file-loader asset name setting via an inline loader syntax : import file from '- ! file-loader ? name= [ name ] . [ ext ] ! ./file.ext ' ; i would like to reimplement the same feature in asset modules and here is what i have so far using generator.filename . and it works : import file from './file.ext ? name= [ name ] [ ext ] ' ; my question is if there is a better way to do that ? < code > const querystring = require ( 'query-string ' ) ; // ... module.rules { type : 'asset/resource ' , generator : { filename : ( pathdata , assetinfo ) = > { const query = pathdata.module.resourceresolvedata.query ; const { name } = querystring.parse ( query.slice ( 1 ) ) ; return name || 'static/media/ [ name ] . [ hash ] [ ext ] ' ; } , } ,
in our project we use export-loader like this to import old modules : import { something } from `` exports-loader ? exports=component ! somefile.js '' ; the project has been set up using vue-cli . running jest i get something like can not find module 'exports-loader ? exports=component ! somefile.js ' from 'testedcomponent.vue ' how can i make this work ? ideas appreciated : ) < code >
i first created an electron app which worked without any problems and now i want to transfer it to webpack with the electron forge webpack-template . but now i 'm facing the problem that everything works so far , but my images , which i added with the jquery attr command , are not loaded . error message : failed to load resource : the server responded with a status of 404 ( not found ) jquery inside html file : < cur > ( ' # slide1 ' ) .attr ( `` src '' , '' ./images/example_image.png '' ) ; is there anything i need to consider in connection with jquery attr and webpack or where could be the error ? < code >
hello , this might not be an issue with webpack or the loaders themselves , however i hope to find some help here ... i am all out of ideas . situation : i recently upgraded my app from angular 12 to angular 13 i am using @ angular-builders/custom-webpack to configure webpack nothing changed in my webpack config between the versions ( who knows what changed in angular ) same version of html-loader in both ( latest ) result : angular 12 loads the images angular 13.1.x does not load the images stackblitz : < url > ( i do n't know how to make it work in the web app , but you can download the project do npm install and npm start ) related stackoverflow question < url > ( i discovered it because of markdown , but it seem the issue is in the html-loader , in angular .. or some missing configuration on my part ) . any idea at all about what could be causing this issue ? thank you . < code >
docs says : the devtool option adds the plugin internally so you would end up with the plugin applied twice . can i somewhere see what does each option of devtool maps to ? i did not find anywhere in the sourcecode . was looking for inline-source-map to see what plugin config/other options it sets . < code >
hello , i 'm working on a plugin and i wanted to know if there was a way i can get the current webpack-dev-server 's url & port ( not from config , but which port was actually assigned ) inside one of the hooks ? thanks in advance ! < code >
like the statsjson.assets [ 0 ] is the file 12345 . [ hash ] .js , and the assets.size is 2048 ( b ) , but the bundle dist of file 12345 . [ hash ] .js is 0.5kb . it is not same as 2048b < code >
bug report what is the current behavior ? if you have reexported class without usage it 's not removed from production build if the current behavior is a bug , please provide the steps to reproduce . create class export default class wontuse extends htmlelement { static somestaticprop = `` tree-shaking does n't work '' ; } into wontuse.ts file create file reexport.ts with export { default as wontuse } from `` ./wontuse '' ; and some default function for future usage import default function from reexport.ts and call it in main.ts build project and you can notice that wontuse class included in build-file despite it does n't in use at all you can check easily here : < url > just clone and run npm i & & npm run build-prod what is the expected behavior ? all useless classes ( not only functions and variables ) must be excluded from build-files other relevant information : webpack version : 5.67.0 node.js version : 14.19.0 operating system : windows 10 additional tools : vscode < code >
i use expose-loader in webpack5 , and i found when webpack -- watch is running and the file changed , will output different with webpack , the combined filename without `` -exposed '' suffix . i create a demo for this : < url > < code >
i am cross posting my stackoverflow question from here , as it rather stays silent over there and i still hope to find a good solution to my problem . you can find the overall details on my question at so but in very short to get you teased : i need to solve two key challenges with webpack but feel rather stuck : how can i obtain the absolute url to the chunk.js my library is put into so that i can spawn new web workers on this file ? ( red part ) how can i configure webpack to call a certain entry-point within my library to run the worker initialization logic when spawned using the url from q1 ? ( orange part ) my library is rather agnostic on how it is used ( umd , esm , bundlers ) and would prefer to keep it like that . i want to minimize the effort for the developers using my lib even when bundling it through webpack into their apps . i 'm looking forward to learn about the possibilities webpack might offer to achieve this setup . < code >
i have an app with the following setup : it has multiple entries . e.g . one is used as bare polyfill entry is uses modulefederationplugin with the react set as shared eager library currently , with that configuration react code is bundled in every entry chunk . is there any way to prevent modulefederation from adding container runtime for every entry or a specific entry as having react in polyfill entry is a big overhead . made a simple repro to show the issue - < url > < code >
bug report what is the current behavior ? my webpack configuration is an es module ( webpack.config.mjs ) . it imports a file from another es module ( type : `` module '' ) that imports createrequire from `` module '' in order to use require.resolve . i have cache.type = 'filesystem ' . when the build dependencies are scanned , i get a warning that 'module ' ca n't be resolved : if the current behavior is a bug , please provide the steps to reproduce . in webpack.config.mjs : from webpack-config/index.js : webpack-config/package.json has `` type '' : `` module '' . use webpack serve . warning is logged to the console . what is the expected behavior ? imports from built in node modules ( like 'module ' ) should be ignored . other relevant information : webpack version : 5.51.2 node.js version : v16.13.0 operating system : windows 10 additional tools : < code > import { webpackconfig } from `` webpack-config '' ; < w > [ webpack.cache.packfilecachestrategy ] caching failed for pack : error : ca n't resolve 'module ' in ' c : \sand\webinst-webpack\webcommons ools\client\webpack arget sc ' < w > while resolving 'module ' in c : \sand\webinst-webpack\webcommons ools\client\webpack arget sc as file < w > at resolve esm file module < w > at file dependencies c : \sand\webinst-webpack\webcommons ools\client\webpack arget sc\webpackconfig.js < w > at file c : \sand\webinst-webpack\webcommons ools\client\webpack arget sc\webpackconfig.js < w > at resolve commonjs c : \sand\webinst-webpack\webcommons ools\client\webpack arget sc\webpackconfig.js import { createrequire } from `` module '' ; const require = createrequire ( import.meta.url ) ; .... cache : { type : `` filesystem '' , }
is there any way to make webpack interpret dynamic imports as a regular ones in a child compiler ? i 'm building a plugin for doing ssg and i do n't want the dynamic imports encountered by the child compiler to cause the emission of additional chunks . i 'd like to have one self-contained output asset per entry point . < code >
hi ! is it possible to signal/share asset details , like contenthash between two different compilers , when using multicompiler config ? is there any hook to do so ? if not , can we achieve it in some other way ? < code >
as the docs , the config of optimization.chunkid/moduleid , we can set the value of 'deterministic ' which is good for long term caching . and the value of 'named ' is more readable . in my project , we prepare to use the deterministic because of the term caching . but , when we want to find the error stack online , or find which module/file had included the bundle.js ( link 125328.ajshdjkashd.js ) . the 'determistic ' property seems like is difficult to find it . i try to use the 'deterministicchunkidsplugin ' , but it looks like does n't hav the relationship about ids and named . also , i try to write a plugin , use the chunkids/afteroptimizechunks/optimizechunkids to get the relationship , but the callback params 'chunks ' also does n't have the relationship . could u help me ? or give me some advice ? i want to get the relationship of determisticid and name when i set the value 'determistic ' . thanks 🙏 < code >
looking at the output types , i noticed these two properties cssfilename and csschunkfilename . i would like to know what is the purpose of these two properties and how to use it ? indeed , i did not find the documentation on that . < code >
hello , is it possible to only include one specific .node binary and exclude everything else instead of compiling them all ? for example : i have a node_module installed that has these binaries in it : and i only need one of them in my final compiled bundle : uws_linux_x64_83.node i already tried excluding them with the exclude flag in my webpack.config.json with various regex 's but nothing seems to work : < code > uws_darwin_arm64_83.node uws_darwin_x64_102.node uws_darwin_x64_93.node uws_linux_arm64_83.node uws_linux_x64_102.node uws_linux_x64_93.node uws_win32_x64_88.node uws_darwin_arm64_93.node uws_darwin_x64_88.node uws_linux_arm64_102.node uws_linux_arm64_93.node uws_linux_x64_88.node uws_win32_x64_83.node { test : /\.node < cur > / , exclude : /node_modules\/uwebsockets\.js\/ ( ( ? ! uws_linux_x64_83\.node ) . ) * < cur > / , loader : `` node-loader '' , } ,
bug report what is the current behavior ? according to documentation webpack 5 does n't need json-loaders . < url > if the current behavior is a bug , please provide the steps to reproduce . import a local json file in a react component and try to use it . you will receive an error you may need an appropriate loader to handle this file type , currently no loaders are configured to process this file . see < url > what is the expected behavior ? json files should be read without need to install json-loader with webpack 5. other relevant information : webpack version : ^5.57.1 node.js version : 12.22.7 operating system : windows 10 additional tools : < code >
bug report what is the current behavior ? have a webpack config that includes this in its plugins : upon compilation , you 'll get an error if the current behavior is a bug , please provide the steps to reproduce . see above what is the expected behavior ? it should not throw an error . this is due to the recursion check in the defineplugin ... the javascript evaluator tries to parse it as ( import ) , which is not valid . perhaps if the parsing fails , the code should be emitted as-is ? other relevant information : webpack version : 5.68.0 node.js version : v16.13.2 operating system : windows 10 additional tools : n/a < code > new defineplugin ( { // defined to access the native browser import , which is ordinarily // prevented by ( 1 ) ts compiling import to amd require ( ) , and ( 2 ) // to its own native module loading . this bypasses both . __non_webpack_import__ : 'import ' , } ) , syntaxerror : unexpected token ( 1:7 ) at object.pp < cur > 4.raise ( c : \users\connor\documents\github\vscode-dev\client\node_modules\acorn\dist\acorn.js:3460:15 ) at object.pp < cur > 9.unexpected ( c : \users\connor\documents\github\vscode-dev\client\node_modules\acorn\dist\acorn.js:756:10 ) at object.pp < cur > 5.parseexprimport ( c : \users\connor\documents\github\vscode-dev\client\node_modules\acorn\dist\acorn.js:2854:12 ) at object.pp < cur > 5.parseexpratom ( c : \users\connor\documents\github\vscode-dev\client\node_modules\acorn\dist\acorn.js:2829:21 ) at object.pp < cur > 5.parseexprsubscripts ( c : \users\connor\documents\github\vscode-dev\client\node_modules\acorn\dist\acorn.js:2627:21 ) at object.pp < cur > 5.parsemaybeunary ( c : \users\connor\documents\github\vscode-dev\client\node_modules\acorn\dist\acorn.js:2593:19 ) at object.pp < cur > 5.parseexprops ( c : \users\connor\documents\github\vscode-dev\client\node_modules\acorn\dist\acorn.js:2520:21 ) at object.pp < cur > 5.parsemaybeconditional ( c : \users\connor\documents\github\vscode-dev\client\node_modules\acorn\dist\acorn.js:2503:2
bug report here the doc mentioned that we have to pass a json or aquery string value for loader option when using inline loader < url > but it seems both of json & query string do not support function values , so i suppose this is a bug ? since some loader does have options in which type is function . ( for example : html-loader : preprocessor ) in my case , i just need inline loader to defined which loader to use for specific .ejs files , and i am going to use these files in htmlwebpackplugin as template , so i ca n't use the module.rules way to set the loaders . you can check the library i am working on here ( just read the passing individual values part of readme.md ) < url > what is the current behavior ? if i pass a function type value as option value to inline loader , it just become undefined . if the current behavior is a bug , please provide the steps to reproduce . you can try to pass the option preprocessor of html-loader using inline loader , then you will get what i am meaning about i guess . what is the expected behavior ? inline loader must support option values in any type . other relevant information : webpack version : 5.66.0 node.js version : v14.17.5 operating system : macos catalina additional tools : < code >
hi , swiperjs , from docs : `` by default swiper exports only core version without additional modules ( like navigation , pagination , etc. ) . so you need to import and configure them too : '' i 'm doing some tests , my index.js is just this : and this is my webpack config : well , the bundleanalyzer graph shows that all the swiper modules are bundled . why ? how can i avoid that ? < code > const path = require ( 'path ' ) ; const bundleanalyzerplugin = require ( 'webpack-bundle-analyzer ' ) .bundleanalyzerplugin ; module.exports = { //mode : 'development ' , mode : 'production ' , watch : true , entry : { index : './src/index.js ' , } , output : { filename : ' [ name ] .js ' , path : path.resolve ( __dirname , 'dist ' ) , clean : true , } , plugins : [ new bundleanalyzerplugin ( ) ] , module : { rules : [ { test : /\.m ? js < cur > / , exclude : /node_modules/ , use : { loader : `` babel-loader '' , options : { presets : [ ' @ babel/preset-env ' ] } } } // babel ] // rules } // module } ; import swiper , { navigation , pagination } from 'swiper ' ; console.log ( swiper ) ;
hi there , does anyone know is there a way to pass different instances of a same environment variable to different entries when bundling ? the problem is , say , i have this structure and each of these modules references an appversion variable , that needs to resolve differently in case of each entry . i suppose , something like this would have worked but seems like entry api is no help here < code > const entry = { 'entry1 ' : { import : './src/entry1 ' , env : { appversion : '01.000.00 ' } } 'entry2 ' : { import : './src/entry2 ' , env : { appversion : '01.001.00 ' } } } ; const entry = { 'entry1 ' : './src/entry1 ' , 'entry2 ' : './src/entry2 ' , } ;
when i started to use module federation , i thought the overhead would just be the remoteentry file ( which is about 100 b ) and some small fixed overhead for creating the container . in reality , it seems like the bundle size grows as you add more components to the exposed entry . for my use case , i exposed the entire app and the bundle size grows 10+kb after gzipped ( 40mb before gzipped ) . i can see the same trend in the module-federation example . < url > ) it would be great if someone can validate my observation here and explain to me what exactly happen behind the scene . thank you in advance ! < code >
i built a microfrontend application using angular cli and module federation plugin . when i try to install angular material or kendo , i 've got this problem : bootstrap call not found . i followed this link to resolve this problem . unfortunately , i 've got further problems : when i install angular material , i 've got this error : your project is not using the default builders for `` build '' . the angular material schematics can not add a theme to the workspace configuration if the builder has been changed . when i install kendo , i 've got this error : skipping installation : package already installed . file node_modules/ @ progress/kendo-angular-buttons/package.json does not exist . i found a temporary solution : before installing the libraries , i replaced the contents of main.ts with the contents of bootstrap.ts . main.ts : after installing the libraries , i restored its contents : this is not a best solution . is there a better solution ? < code > / * import ( './bootstrap ' ) .catch ( err = > console.error ( err ) ) ; * / import { enableprodmode } from ' @ angular/core ' ; import { platformbrowserdynamic } from ' @ angular/platform-browser-dynamic ' ; import { appmodule } from './app/app.module ' ; import { environment } from './environments/environment ' ; if ( environment.production ) { enableprodmode ( ) ; } platformbrowserdynamic ( ) .bootstrapmodule ( appmodule ) .catch ( err = > console.error ( err ) ) ; import ( './bootstrap ' ) .catch ( err = > console.error ( err ) ) ;
image minification support in webpack5 is provided by @ alexander-akait 's at , image-minimizer-webpack-plugin supports only 'imagemin ' & 'squoosh ' minification , imagemin is unmaintained and suggests , squoosh compression fails , there 's been no response to that in 22 days , and the project itself looks barely active since oct '21 , what options for supported & functional image minification exist in the webpack5 ecosystem ? < code > squoosh img compress error : `` maxlistenersexceededwarning : possible eventemitter memory leak detected . '' < url > < url > `` i would recommend using squoosh instead , which is actively maintained and also avoids a lot of the problems imagemin are having with native binaries , as they 're using webassembly . '' < url > < url > webpack-contrib/image-minimizer-webpack-plugin < url > imageminimizerwebpackplugin plugin and loader for webpack to optimize ( compress ) all images using imagemin . do not worry about size of images , now they are always optimized/compressed .
with webpack-dev-server 3.x.x , when running webpack serve , after a change done in the src code , it was possible to see in the console compiling ... and then compiled successfully such like this : however , after the release of webpack-dev-server 4 , we do n't see compiling ... anymore , we only see compiled successfully . in my opinion , it was quite useful to have compiling ... like this we were aware that something was going on ( more particularly when it is a bit long to reload ) . < code >
i 'm not sure how impactful this could be so i would like to know what @ sokra and other team members think before starting to experiment with this idea . i 'm assuming swc parser and acorn parsers output the same estree compatible asts , we can try out replacing the parser to measure performance benefits . thoughts ? < code >
what is the difference between devserver.livereload and watch configuration in particular ? both seem to serve the same purpose , and according to documentation none of them does anything without the other one being enabled ? the documentation appears to be a bit blurred on this . < code >
bug report what is the current behavior ? missing compilation and `` existsat '' if the current behavior is a bug , please provide the steps to reproduce . i am not sure if this is a bug and can be similar to # 12313 i am upgrading my teams codebase to use webpack 5 and i no longer have access to compilations in stats . the reason i need this path is because i use it for the output path which i can not find in webpack 5. what is the expected behavior ? expected behavior is for me to be able to find compilation and existsat other relevant information : webpack version : `` webpack '' : `` ^5.68.0 '' , node.js version : 14.x operating system : macos additional tools : < code > function printstats ( stat ) { if ( stat.compilation & & stat.compilation.assets ) { // < -- compilation does n't exist for ( const asset in stat.compilation.assets ) { const assetinfo = stat.compilation.assets [ asset ] ; const assetpath = path.relative ( process.cwd ( ) , assetinfo.existsat ) ; console.log ( 'output file `` < cur > { chalk.cyan ( assetpath ) } '' ' ) ; } } }
bug report what is the current behavior ? recently , i have found that when a chunk is not formatted with all numbers , it ca n't be loaded because of the undefined variable : other relevant information : webpack version : 5.67.0 node.js version : 17.3.1 operating system : windows os additional tools : < code > / * ! for license information please see 117.4b325.js.license.txt * / ( self.webpackjsonp = self.webpackjsonp || [ ] ) .push ( [ [ 117 ] , { 11543 : function ( e , t , i ) { var n = i ( 61493 ) ; i ( f912e ) ; // throw error here } , 'f912e ' : function ( ) { } } ) ;
i have a remote application that defines several packages as shared services ( singleton ) my host application that consumes it , is a legacy application that is already using these libraries . when i declare the shared services in the module federation plugin settings , i get an error that module is not available for eager consumption ( < url > ) . when i remove the shared property from the plugin settings object , everything seems to work . my question is : since my host is not omnidirection ( which is the use case discussed in the docs ) , is removing the shared from the host is a good approach ? i am not sure if this way the host will still override the remote shared services or i will end with multiple downloads of them and/or multiple instance of the lib ( which is more concerning in my case ) . thanks a lot ! i tried to figure it from the created bundle , but it was a little hard to get . < code >
i do n't yet have a minimal repro ( this is occurring in a very large corporate project , 24 entries , > 2.5k chunks ) , so i 'm not yet opening an issue , but i would like some pointers for investigation . it seems that there are a few cases where going through one entry in a multi-entry compilation results a module that is not yet in a loaded chunk being synchronously requested , which results in the error in the title in webpack v5 runtime code . digging through the chunk graph , i can see that there are several paths from the chunk ( s ) containing the requesting modules up the parentage in the chunk graph where the requested module is not included . this seems like a core webpack bug , but it must clearly be an edge case given the lack of other complaints . any idea of what validation is supposed to exist for this scenario that may be failing ? < code > / * * * * * * / // execute the module function // '__webpack_modules__ [ moduleid ] ' is 'undefined ' / * * * * * * / __webpack_modules__ [ moduleid ] .call ( module.exports , module , module.exports , __webpack_require__ ) ;
still not 100 % if this should be considered a bug , so before create an issue ticket i want to confirm it after debug for a few days i found something that i still thinking is wrong in webpack when we import a library that its already a bundle in webpack , during the build process we call the plugin compatibilityplugin that basically transforms __webpack_require__ to __nested_webpack_require_ < cur > { pattern.range [ 0 ] } __ my concern is that shared dependencies that were loaded by the main bundle are under __webpack_require__ and these should be exposed to the whole application if these are singleton but testing the bundle compiled i can see things like this if i marked that react should be singleton , why is trying to load it from the nested webpack bundle instance __nested_webpack_require_ < cur > { pattern.range [ 0 ] } __ and this is why is loading the `` duplicated react '' instead the original from the bundle i can understand that each nested dependency in the bundle are completely isolated , but for scenarios where dependencies are shared/singleton doesnt make sense should this be considered a bug ? i did some tests doing manual changes in the bundle related to this , and was able to make works react instance from var versions = scope [ name ] = scope [ name ] || { } ; to var versions = scope [ dependencyname ] = __webpack_require__.s [ name ] [ dependencyname ] || scope [ dependencyname ] || { } ; ( keep on mind that this is for the scenario where __webpack_require__ is nested and we need access to the root ) doing just 1 change i was able to make it works < code >
i am using webpack 5.x to generate a entry scss file but failed , this is the detail information : < url > what should i do to make it generate the css file from entry ? < code >
i am going to use some patterns like __ ( 'hello ' + foo ) for i18n template . here are some steps : write some codes like const content = __ ( 'hello ' + foo ) in a js/ts file replace the string above with translated content like const content = foo + `` via webpack plugin during compilation stage i have tried some solutions like toconstantdependency in webpack plugin . unfortunately , it seems not work well with some strings , which contains dynamic content such as variable . < code >
suppose we have a module like this : this is how the module is used : this will cause webpack to add the entire upper module into the bundle , probably to protect any potential black-magic side-effects that could make this property access work . is it possible to disable this fallback and keep tree-shaking enabled ? < code > import values from `` ./module '' ; console.log ( values.doesnotexist ) ; export default { foo : `` '' , bar : `` '' }
bug report what is the current behavior ? when build the third library that type field is module of package.json , it wo n't work correctly if the code contains require ( ) . ( although this way is wrong ) but it will work correctly if i build it with webpack 4. if the current behavior is a bug , please provide the steps to reproduce . what is the expected behavior ? it works correctly in webpack 5. other relevant information : webpack version : 5.66.0 node.js version : 14.17.5 operating system : mac additional tools : no < code >
hi everyone , css-loader is depending on postcss , which is depending on a vulnerable version of nanoid . it looks like the postcss maintainers have recently upgraded their dependency on nanoid but not published a new release yet : postcss/postcss # 3636eaf9b749c64c5dbfbaa56d45bc22b3169ff9 i 'm not a javascript expert and i 'm not sure what the best way forward is here but still wanted to make the webpack maintainers aware . let me know if i can help in any way . thanks , lennart < code >
i upgrade the webpack to 5.x but i found it did not generate the css output file : < url > what should i do to fix the problem ? < code >
hey guys , comment is pretty self explanatory . asterisk ( * ) sign is removed not just from comments but from selector . the next css code : transpiling into : am i doing something wrong ? < code > : where ( : not ( iframe , canvas , img , svg , video ) : not ( svg * , symbol * ) ) { all : unset ; display : revert } * , :after , :before { box-sizing : border-box } * : where ( : not ( iframe , canvas , img , svg , video ) : not ( svg * , symbol * ) ) { all : unset ; display : revert ; } * , * : :before , * : :after { box-sizing : border-box ; } module.exports = { ... module : { rules : [ ... { test : /\.s [ ac ] ss < cur > /i , use : [ minicssextractplugin.loader , 'css-loader ' , { loader : 'sass-loader ' , options : { implementation : require ( 'sass ' ) , sassoptions : { fiber : false } } } ] } ] } , optimization : { minimize : process.env.npm_lifecycle_event === 'build ' , minimizer : [ new cssminimizerplugin ( ) ] , } , plugins : [ new minicssextractplugin ( { filename : ' [ name ] .min.css ' , chunkfilename : ' [ id ] .css ' } ) , ... ] }
hi , i am migrating a web project from webpack 4 to webpack 5. in console , i have the following error : rivets is not defined in webpack 4 , without provideplugin , the development output is : eval ( `` ( function ( ) { var < cur > document , cart , cartjs , format_money_warning , in webpack 4 , when i add provideplugin : everything is working and development output is now with the wrapper : eval ( `` / * webpack var injection * / ( function ( jquery , rivets ) { ( function ( ) { var < cur > document , cart , cartjs , format_money_warning , but now in webpack 5 , the output is always without the wrapper ( function ( jquery , rivets ) { ( even with provideplugin ) : eval ( `` ( function ( ) { var < cur > document , cart , cartjs , format_money_warning am i missing something ? thanks . best regards . < code > new webpack.provideplugin ( { < cur > : 'jquery ' , jquery : 'jquery ' , rivets : 'rivets ' , } ) ;
my team has a project using webpack-dev-server that hosts dozens of entrypoints . compiling them all at once takes several minutes , so we set up a system that reads a list of entrypoint names from a config file and only compiles the entrypoints that a dev is actually interested in . this cuts down compile time significantly , but this behavior can trip up devs who are n't aware of exactly how it works . webpack 's new lazy entrypoint experiment seemed like a perfect solution . my understanding was that entrypoints would be compiled on-demand , and then loaded onto the page to work as if the entrypoints had been pre-compiled . however , once i got it set up , i found that webpack would correctly lazily compile entrypoints as they were requested , but would not load them onto the page until the page was refreshed . is this behavior intentional ? if so , what is the recommended way to serve apps with lazily-compiled entrypoints ? < code >
this is a bit of a philosophical question i 've had for a while with webpack . why does the schema for the configuration file change so often between versions ? the way i see this most is that old advice on stackoverflow is usually wrong , because some property will have changed name since it was posted , or the many different ways of specifying a single property have changed in backwards-incompatible ways ( eg the many ways of specifying use , loader , loaders , etc ) . this causes problems , especially for new users / ones not deeply familiar with webpack , in that most old examples about how to configure webpack do n't work anymore if you find two answers on stackoverflow that should combine to serve your needs , usually this wo n't work because they are answering for different versions of webpack , and probably both are out of date with the current version , and migrating them to the current syntax is very nonobvious ( and some old default plugins may not even work anymore or be superseded by some new plugin ) . this is the primary reason i find webpack so hard to work with when setting up something complex . on the pragmatic end of this question : how can we mitigate this problem ? are there feasible ways to detect this kind of problem and report it in a way that users not very familiar with webpack can use to migrate parts of their configuration correctly ? < code >
i have a link tag in my html template < link href= '' styles/bootstrap.min.css '' rel= '' stylesheet '' > . i 'm going to modify it dynamically to point at styles/bootstrap.rtl.min.css depending on user preferences . both css are copied using copywebpackplugin . is there any way to prevent webpack5 from processing this link tag ? < code >
in node v14 , macos bigsur webpack4 < email > .0 < email > < email > .2 babel/ < email > .8 babel-loader @ 8.2.3 css-loader @ 5.2.7 < email > sass-loader @ 9.0.3 sass-resources-loader @ 2.2.4 postcss-loader @ 4.3.0 resolve-url-loader @ 3.1.4 terser-webpack-plugin @ 4.2.3 vue-loader @ 15.9.8 vue-style-loader @ 4.1.3 webpack5 < email > .0 webpack-cli @ 4.9.1 webpack-dev-server @ 4.7.2 terser-webpack-plugin @ 5.3.0 css-minimizer-webpack-plugin @ 3.3.1 css-loader @ 6.5.1 postcss-loader @ 6.2.1 < email > .2 sass-loader @ 12.4.0 performance webpack4 : 64399ms ( dev-server : 89409ms ) webpack5 : 186518ms ( dev-server:135508ms ) , webpack5 no filesystem cache for compare . according to the guide , the loader and plug-in were changed to the latest version , file-loader to asset-module , and excluded node-polyfill was added . ( path , stream , buffer , util , process ) . is it a normal result to increase the build time like this ? < code >
hi , i recently upgraded to webpack 5 and what i found is that if i do n't set livereload to false , it reloads the page before hot is able to inject the updated code . in webpack 4 , that was n't an issue . i 'm running webpack-dev-server in a docker container , here 's my config : is it normal to have livereload : false so hot : true works ? thanks ! < code > devserver : { host : `` 0.0.0.0 '' , // < url > port : 3000 , allowedhosts : `` all '' , hot : true , livereload : false , proxy : { `` * '' : `` phofurl } , } ,
hi , is there a way to create a combined custom console log for both of the configs ? for example : i 'm in watch mode and the second file is saved / compiled , webpack gives me information about that task in the console . the problem is , that the log of the first config is not attached to the second log . i would like to clear the console and it should show me the log of both firstconfig and secondconfig . further more i would like to get out some of the data of both and create some stats out of that . like the first file hast compiled with 3.18 kib and the second with 4.8 kib and the log should show for example the sum of both . < code > const firstconfig = { entry : './first/entry ' , output : { / * output * / } , plugins : [ / * plugins * / ] } const firstconfig = { entry : './second/entry ' , output : { / * different output * / } , plugins : [ / * different plugins * / ] } module.exports = [ firstconfig , secondconfig , ]
hi ! webpack 4 used to name chunks x.chunk.js / x.chunk.css ( starting at 0 and continuing to the highest chunk ) . how can we re-create the same behaviour in webpack 5 ? i 've tried overriding the config.output.chunkfilename and the corresponding minicssextractplugin plugin options.chunkfilename , but ca n't seem to work it out ... i want to have two chunks , i would like them to be explicitly named : 0.chunk.js / 0.chunk.css 1.chunk.js / 1.chunk.css this is for an integration with some powershell scripts that provision a sharepoint 2013 site and expect the chunks to be statically named . < code >
bug report what is the current behavior ? i want to create a react libary and push it to npm . with my webpack config i get the error : failed to resolve import `` react '' if the current behavior is a bug , please provide the steps to reproduce . i have created for that a repo and asked already on stackoverflow stackoverflow : < url > repo : < url > what is the expected behavior ? the library should take react and react-dom from parent . other relevant information : webpack version : 5.27.0 node.js version : 17.3.0 operating system : ubuntu additional tools : < code >
i 've a file with a userscript banner and im passing it with a raw property but it still gets wrapped in a comment which breaks my userscript recognition . example ( my banner txt ) gets turned into reproduce steps : git clone < url > yarn yarn prod then check dist/ * .user.js file banner content is in assets folder < code > / * ! // ==userscript== // @ name userscript-name // ==/userscript== * / // ==userscript== // @ name userscript-name // ==/userscript==
i ' trying to upgrade webpack from v4 to v5 . the dependencies have been upgraded according to the official upgrade document , but all the background image url inside scss files ca n't be resolved . error like this : webpack.config.js like this : and i have tried 'resolve-url-loader ' , it ca n't help . anyone can help ? < code > error in ./src/modules/usermanagement/components/editusermodal.scss ( ./node_modules/css-loader/dist/cjs.js ? ? ruleset [ 1 ] .rules [ 0 ] .oneof [ 5 ] .use [ 1 ] ! ./node_modules/postcss-loader/dist/cjs.js ? ? ruleset [ 1 ] .rules [ 0 ] .oneof [ 5 ] .use [ 2 ] ! ./node_modules/resolve-url-loader/index.js ? ? ruleset [ 1 ] .rules [ 0 ] .oneof [ 5 ] .use [ 3 ] ! ./node_modules/sass-loader/dist/cjs.js ? ? ruleset [ 1 ] .rules [ 0 ] .oneof [ 5 ] .use [ 4 ] ! ./src/modules/usermanagement/components/editusermodal.scss ) module not found : error : ca n't resolve '/images/btn_icon_filter_selected.png ' in ' c : \users\hej17302\documents\github\onesource-portal\newportal\spa\src\modules\usermanagement\components ' @ ./src/modules/usermanagement/components/editusermodal.scss module.exports = { module : { rules : [ { test : /\.s [ ac ] ss < cur > /i , use : [ `` style-loader '' , `` css-loader '' , `` postcss-loader '' , `` resolve-url-loader '' , `` sass-loader '' , ] , } , ] , } , } ;
i 'm having the exact same issue as @ rb-mwindh was having in this issue . to recap , angular generates a highly opinionated webpack config that they make difficult to change , so when doing anything that angular does n't expect you to be doing , there are problems . i 'm trying to apply some css via style-loader and css-loader , but angular sets the asset type of all .css imports as asset/resource . the solution posted in the issue above uses an internal ! = ! syntax like this to change the resource type so that the loader output is evaluated : this works great for the style-loader , but the output of the nested css-loader is still being treated as an asset/resource . is it possible to apply the same trick to change the type for css-loader too ? my attempts at guessing at the syntax have so far failed . thanks ! < code > import styles from 'style.css.webpack [ javascript/auto ] ! = ! ! ! style-loader ? injecttype=lazystyletag ! css-loader ! some-npm-module/style.css ' ;
we are importing fonts and processing them via webpack ( v5.46.0 ) , 'vue-style-loader ' ( v ) and 'css-loader ' ( v6.2.0 ) . the resulting path to font that is sent to the browser is `` url ( file : ///mf/fonts/sharpsansno1-book.2ee0a.woff2 ) '' and the browser complaints that it can not fetch this font ( which makes sense ) . however , if we set css-loader option `` esmodule=false '' we get a correct path to the font `` url ( /mf/fonts/sharpsansno1-book.2ee0a.woff2 ) '' . ( or downgrade to v5 version of css-loader also seem to solve this issue ) anybody who can advice on why we have to use esmodule=false to get correct urls sent to the browser ? in stylesheet : @ font-face { font-family : 'sharpsansno1book ' ; font-display : swap ; src : url ( ' .. / .. / .. / .. /assets/fonts/sharpsansno1_books/sharpsansno1-book.woff2 ' ) format ( 'woff2 ' ) } results in browser injected style-sheet in html head : @ font-face { font-display : swap ; font-family : sharpsansno1book ; font-style : normal ; font-weight:400 ; src : url ( file : ///mf/fonts/sharpsansno1-book.2ee0a.woff2 ) < code >
i have some loaders to analyze less file to collect data from theme.js , and i use filesystem cache and webpack-dev-middleware . when the file theme.js has changed but the less files have not changed , the loaders will not analyze the less file anymore because of the cache , maybe the memory cache of webpack-dev-middleware whatever , how to watch the theme.js and invalidate the cache , so that the loaders will handle these less files to collect data ? < code >
bug report what is the current behavior ? env vars arent loaded when deployed to cloudflare pages i have a repository using quasar and as stated in their docs here i have imported dotenv and provided that to webpack build , now when i run it locally it does load env and process isnt undefined whereas when deployed to cloudflare pages , process becomes undefined . if the current behavior is a bug , please provide the steps to reproduce . what is the expected behavior ? env variables should have loaded and process shouldnt have been undefined other relevant information : webpack version : latest node.js version : v16.13.0 operating system : macos intel 2017 version additional tools : quasar , vuejs , cloudflare < code >
i am struggling with building the angularjs app after upgrading to webpack 5. even we do shim with the following lines in webpack config , it does n't help us anymore . previous webpack versions supported that properly for us . the build ends with the following two errors . can anybody help , please ? < code > error in ./node_modules/angular-ui-router/lib-esm/angular.js module build failed ( from .. /node_modules/angular/index.js ) : referenceerror : window is not defined at object. < anonymous > ( /myapp/node_modules/angular/angular.js:36598:4 ) at module._compile ( node : internal/modules/cjs/loader:1097:14 ) at object.module._extensions .. js ( node : internal/modules/cjs/loader:1149:10 ) at module.load ( node : internal/modules/cjs/loader:975:32 ) at function.module._load ( node : internal/modules/cjs/loader:822:12 ) at module.require ( node : internal/modules/cjs/loader:999:19 ) at require ( node : internal/modules/cjs/helpers:102:18 ) at object. < anonymous > ( /myapp/node_modules/angular/index.js:1:1 ) at module._compile ( node : internal/modules/cjs/loader:1097:14 ) at object.module._extensions .. js ( node : internal/modules/cjs/loader:1149:10 ) error in ./node_modules/angular/angular.js module build failed ( from .. /node_modules/angular/index.js ) : referenceerror : window is not defined at object. < anonymous > ( /myapp/node_modules/angular/angular.js:36598:4 ) at module._compile ( node : internal/modules/cjs/loader:1097:14 ) at object.module._extensions .. js ( node : internal/modules/cjs/loader:1149:10 ) at module.load ( node : internal/modules/cjs/loader:975:32 ) at function.module._load ( node : internal/modules/cjs/loader:822:12 ) at module.require ( node : internal/modules/cjs/loader:999:19 ) at require ( node : internal/modules/cjs/helpers:102:18 ) at object. < anonymous > ( /myapp/node_modules/angular/index.js:1:1 ) at module._compile ( node : internal/modules/cjs/loader:1097:14 ) at object.module._extensions .. js ( node : internal/modules/cjs/loader:1149:10 ) config.resolve.alias [ 'angular < cur > ' ] = __dirname + '/node_modules/angular/angular ' ; config.module.rules.push ( { test : /angular\.js < cur > / , use : 'exports-loader ? window.angular ' } ) ;
as the title question , in my code , i create a container < div id= '' root '' > < /div > in window.onload event , but i have no idea about how to config the the webpack style-loader options ? the container the webpack config < code > window.onload = function ( ) { // console.log ( chrome.runtime.getmanifest ( ) .id ) ; container = document.createelement ( 'div ' ) ; container.setattribute ( 'id ' , 'app ' ) ; document.body.appendchild ( container ) ; const shadow = container.attachshadow ( { mode : 'open ' } ) ; } ; ... { loader : 'style-loader ' , options : { insert : function ( linktag ) { // insert into doms // no circus settimeout ( ( ) = > { const parent = document.queryselector ( ' # app ' ) .shadowroot ; parent.appendchild ( linktag ) ; } , 3000 ) ; } , } , } ,
hello , i 'd like some advice about this pattern . i would like to execute something once the servercompiler has done its first compile . i tried many hooks but i could find the one that suites my need . as you can see i ended up putting a flag . < code > const clientserver = new webpackdevserver ( clientdevserveroptions , clientcompiler ) ; let init ; clientserver.start ( ) .then ( ( ) = > { const servercompiler = webpack ( serverconfig ) ; servercompiler.hooks.done.tap ( 'ondone ' , ( stats ) = > { if ( ! init ) { init = true ; // do something once } } ) servercompiler.watch ( { } , ( err , stats ) = > { } ) ; } ) ;
i have a plugin i am modifying . i would like to be able to add an environment variable inside my plugin like this using the defineplugin ... i have verified the definitions collection is correct but i ca n't seem to get it to inject my environment variable . i was following what the environment plugin was doing but ca n't quite get it to work . is this the correct approach to call a plugin from inside another plugin ? < code > const definitions = { } ; definitions [ 'process.env.react_app_css_nonce ' ] = json.stringify ( this.nonce ) ; new webpack.defineplugin ( definitions ) .apply ( compiler ) ;
hey guys ! i have created an external package ( based on react without cra ) and i 'm using it inside another project based on react ( without cra either ) . i 'm using mini-css-extract-plugin in the external package to minimize the bundle , but because of the extract i need to always import the css when i use this external package . is that a way to , when i import a component of this external package , import automatically its css ? example : i have a button component in this external package . when i build the package , i got this : so to use it i need to import like this : i 'd like to use the css without imort it ( like html-template-plugin ) , but without use it , because the external package is a design system , so it does n't export html templates , just js components . is it possible ? i have others css variations too , like button small , large , warning , info etc . it 'll be just awesome to use a prop on the component and it 's automatically import the respective css ! < code >
with webpackdevserver v3 it was possible to configure the property publicpath in the devserver options . however , with the v4 it is not possible anymore . therefore , i looked to the breaking changes ( into the releases ) and i found that on this page : however , i am having this issue : [ webpack-cli ] invalid options object . dev server has been initialized using an options object that does not match the api schema . options has an unknown property 'dev ' . these properties are valid : object { allowedhosts ? , bonjour ? , client ? , compress ? , devmiddleware ? , headers ? , historyapifallback ? , host ? , hot ? , http2 ? , https ? , ipc ? , livereload ? , magichtml ? , onaftersetupmiddleware ? , onbeforesetupmiddleware ? , onlistening ? , open ? , port ? , proxy ? , server ? , setupexitsignals ? , setupmiddlewares ? , static ? , watchfiles ? , websocketserver ? } how is it possible to have the same behavior than before ? < code > module.exports = { // ... devserver : { dev : { publicpath : '/publicpathfordevserve ' , } , } , } ;
after i update webpack about one month , there is no bug for it . but i count the build time for everyone in my team . but i do n't understand why the difference in running time of each one is so big . i have a time statistics table as you can see , i think the build time more than 300s , i think it might build without cache or the cache is not work but within 300s , some only build less than 100s , some about 100-200 , and they all account for a large proportion . so , i want to know is : is there some hooks or api to judge if hit the webpack5 cache ? i think i cant report the hit rate , and then analyze all 's time . if both hit the cache , are these time differences in line with expectations ? sorry , recently i have too many questions after update to webpack5 . i am expecting a reply . thanks a lot ! < code >
continuing to look at watching improvements . right now , webpack defaults to waiting .2 seconds on every recompile . this data seems to not really `` show up '' in the outputted completed time , or the stats metric on < url > we had no issues in our large project lowering it to 50ms , and i see next sets this value to 5ms ( vercel/next.js # 22418 ) . seems like an easy perf win which is currently hidden away behind an uncommon config . i tried to find history on the reason for 200ms , but could not . thoughts ? @ sokra < code >
bug report what is the current behavior ? application is not running after upgrading to wepack 5. i am getting below error when try to load application uncaught error : [ < cur > injector : modulerr ] failed to instantiate module itest due to : error : [ < cur > injector : modulerr ] failed to instantiate module core due to : error : [ < cur > injector : unpr ] unknown provider : e i have compared webpack 4 and webpack 5 bundle on my system and could see in webpack 5 bundle , runtime.js file is not getting created . i am using angular 1.8.2 if the current behavior is a bug , please provide the steps to reproduce . after build creation application is not working and getting above error in console with empty page . what is the expected behavior ? other relevant information : webpack version : 5.37.0 node.js version : 12.14.0 operating system : additional tools : < code >
bug report this error , first of all has awful grammar : module not found : error : ca n't resolve 'xxx ' in 'yyy ' did you mean 'xxx.js ' ? breaking change : the request ' ... ' failed to resolve only because it was resolved as fully specified ( probably because the origin is strict ecmascript module , e. g. a module with javascript mimetype , a '.mjs ' file , or a '.js ' file where the package.json contains ' '' type '' : `` module '' ' ) . the extension in the request is mandatory for it to be fully specified . add the extension to the request . is the point of webpack to make development easier ? the developer does not want to specify the extension , and webpack can do this for him . in fact , it used to . this line `` did you mean 'xxx.js ' ? '' shows that you do know exactly what he means . there is documentation that fullyspecified : false makes this error go away , but it does not . what is the current behavior ? failure to resolve if the current behavior is a bug , please provide the steps to reproduce . what is the expected behavior ? imports should resolve . other relevant information : webpack version : 5.65.0 node.js version : 14.17.1 operating system : ubuntu 20 additional tools : < code >
bug report what is the current behavior ? as the webpack5 docs , some maintemplate hooks has been removed . but in my project with webpack4 , we use the maintemplate.hooks.bootstrap and maintemplate.hooks.requireensure to inject some js to the final file . but now the maintemplate feature is not exist , and the webpack5 docs now show how to change it . and from the webpack5 source code , i cant find any new hooks . my plugin code if the current behavior is a bug , please provide the steps to reproduce . what is the expected behavior ? other relevant information : webpack version : 5.51.1 node.js version : 14.16 operating system : macos additional tools : < code > apply ( compiler ) { if ( compiler.hooks ) { compiler.hooks.compilation.tap ( 'retrypluguin ' , compilation = > { compilation.maintemplate.hooks.bootstrap.tap ( 'retrypluginaddcustomlogic ' , ( source , chunk , hash , moduleidexpression ) = > { const flagname = json.stringify ( '__manifest_executed_ < cur > { chunk.ids.join ( ' _ ' ) } _ < cur > { hash } __ ' ) ; const newsource = maketagretry ( source , ensureexeconcetobeinject , getexeconceexecscript ( flagname ) ) ; return newsource ; } , ) ; compilation.maintemplate.hooks.requireensure.tap ( 'retrypluginaddcustomlogic ' , ( source , chunk , hash , moduleidexpression ) = > { let newsource = source ; console.log ( 'source : ' , source ) ; // nothing newsource = maketagretry ( newsource , scripttobeinject , scriptretry ) ; newsource = maketagretry ( newsource , linktobeinject , cssretry ) ; return newsource ; } , ) ; } ) ; } }
im wondered that nowhere is answered how to access entry point name in webpack loader . is it possible ? for example in postcss.config.js are function arguments < url > api.file , api.mode , api.webpackloadercontext , api.env , api.options but noone with entry name . it is useful to have little bit different configuration of webpack loader depending on entry point without having to create separete/duplicate webpack configuration file . on stackoverflow here < url > is the answer to use options.entry but it is obsolete and not working now . another identical ask is here < url > but with no answer for almost 3 years . < code >
i 'm using webpack with a really basic configuration with optiomization turned on in production and with terserplugin as minifier . when i set `` sideeffects '' : false , webpack treeshakes imports of firebase 8 services from the app . i thought webpack handles node_modules differently and does n't treeshake them but looks like i 'm wrong . i tried to put the modules to sideeffects `` sideeffects '' : [ `` firebase/auth '' , `` firebase/firestore '' ] but it did n't help . could anyone point me where the problem is ? 🙏 < code > import firebase from 'firebase/app ' import 'firebase/auth ' ; // this one is missing in production import 'firebase/firestore ' ; // this one is missing in production too firebase.initializeapp ( config ) ; export { firebase , }
running webpack-dev-server -- hot with open : true in the devserver options results in an error being thrown when trying to spawn child process . not sure if i have a weird environment , but i checked all my environment variables and this specific issue seems to be that it does not recognise % systemroot % , since that is what is undefined when trying to spawn child process , see below . node : 16.13.0 npm : 8.1.0 windows : 21h2 this does n't appear to be the problem when i use the git bash terminal . does anyone know how to fix this for cmd and powershell terminals ? < code >
bug report what is the current behavior ? in the development mode , if devtool is configured as source-map , the packaged file will not generate column mapping information normally if there is an error , but if the simplest babel-loader is configured , there will be normal column mapping information . if the current behavior is a bug , please provide the steps to reproduce . to reproduce the specific error , please read the sample repository i created . < url > what is the expected behavior ? i think it 's right to generate column mapping without babel . one thing to mention here is that although the mappings value in the map file does include column mappings , the column error message is not correctly reported on the browser . other relevant information : webpack version : 5.65.0 node.js version : v14.16.0 operating system : win10 additional tools : babel < code >
feature request what is the expected behavior ? the latest built-in loader for workers ( documented here ) should also work when worker is replaced with a sharedworker . at the moment , a sharedworker module is n't loaded at all . what is motivation or use case for adding/changing the behavior ? similar to the motivation for adding the built-in worker loader in the latest version . how should this be implemented in your opinion ? likely in a similar fashion to the worker loader , but i 'm not super familiar with webpack internals . are you willing to work on this yourself ? yes < code >
i migrated the following deprecated options of webpack dev server ( see < url > ) : however , when starting the dev server , i 'm getting mixed content errors because somehow the dev server is using plain http ? using the deprecated options works fine though . am i missing something here ? < code > // deprecated options . //options.http2 = true , //options.https = { // key : 'infrastructure/ssl/private/dev.key ' , // cert : 'infrastructure/ssl/certs/dev.crt ' , // } , // new options . options.server = { type : 'https ' , options : { key : 'infrastructure/ssl/private/dev.key ' , cert : 'infrastructure/ssl/certs/dev.crt ' , } , } mixed content : the page at ' < url > was loaded over https , but requested an insecure element ' < url > this request was automatically upgraded to https , for more information see < url >
hi everyone , i am running into a situation where webpack is not properly removing unused code from an app , and i am having a hard time figuring out why . the issue seems to be that doing a re-assignment is causing the issue ( example : < url > ) . is anyone able to shed some light on why a re-assignment would cause webpack to pull in this additional code ? minimal reproduction : < url > steps to reproduce run npm install . open src/index.js . observe that only badge is imported . run npx webpack . run grep -o -i -e 'avatar bundle|badge bundle ' dist/main.js . this will search the built output for the `` avatar bundle '' and `` badge bundle '' strings . these strings are found in the src/components/avatar.js and src/components/badge.js files and are used to quickly tell if webpack is bundling the components when building . observe that both strings appear , meaning both badge and avatar are bundled with the app . in components/avatar.js remove avatar = avatar . in components/badge.js remove badge = badge . run npx webpack . run grep -o -i -e 'avatar bundle|badge bundle ' dist/main.js . observe that only the `` badge bundle '' string appears , meaning only badge is bundled . < code >
bug report i am using webpack ( downloaded implicitly using @ angular-devkit # build-angular verison 12.1.4 ) . we have upgraded our application from angular 9 to angular 12 recently . earlier the webpack version was 4.42.0 and after the upgrade , the webpack version is 5.65.0 since the upgrade , style-loader has stopped working . no compilation error as such . just that its not working how it is supposed to . the syntax i am using to import a new css file is : require ( `` style-loader ! ./file.css '' ) . other relevant information : node.js version : 14.18.0 < code >
i 'm looking for any tips/tricks on debugging the following warning when using the filesystem cache . < code > < w > [ webpack.cache.packfilecachestrategy ] serializing big strings ( 282kib ) impacts deserialization performance ( consider using buffer instead and decode when needed )
hi , i had in webpack 4 file-loader to put fontawesome fonts into a specific nested directory , but telling via publicpath to use an fixed directory . this looked like that : now since in webpack5 this is deprecated , i tried to switch to asset/resource , but could not make it work like this : the filename works as expected , but setting any publicpath except undefined throws exceptions . unfortunately i could n't find any documentation , how to get publicpath working to behave like file-loader previous . could you please help me , thanks in advance . < code > { test : [ /fontawesome-free. * \ . ( woff|woff2|eot|ttf|svg ) < cur > / ] , loader : 'file-loader ' , options : { name : 'my/nested/path/fontawesome/ [ name ] . [ ext ] ' , publicpath : ( url , resourcepath ) = > { const filepath = path.resolve ( resourcepath ) ; return 'fontawesome/ < cur > { path.basename ( filepath ) } ' ; } , } , } , { test : [ /fontawesome-free. * \ . ( woff|woff2|eot|ttf|svg ) < cur > / ] , type : 'asset/resource ' , generator : { filename : 'my/nested/path/fontawesome/ [ name ] [ ext ] ' , publicpath : 'fontawesome/ [ name ] [ ext ] ' , } , } ,
i 'm getting a runtime error when running my app with minification enabled : the error goes away when i set optimization.minimize to false . i 'm using nx + angular 13 + module federation ... i tried to create a minimal reproduction but so far i could n't make it fail outside of my project . any idea how can i troubleshoot the issue ? < code > typeerror : y is not a function or its return value is not iterable at k ( common.js : formatted:18 ) at o ( common.js : formatted:4510 ) at m ( 9645.js:1 ) at object.28882 ( 9645.js:1 ) at y ( main.js:1 ) at module.99645 ( 9645.js:1 ) at function.y ( main.js:1 ) at nt.invoke ( polyfills.js:1 ) at at.run ( polyfills.js:1 ) at polyfills.js:1
in my project , there is some rules to translate the node modules , like this translate svg to react component but when i run my project , i find it not be translated . i am not sure if it is caused by the npm tool source ( although i do n't think the tool source will cause this reason ) . but in fact , because of pnpm , the real path what code use is '/users/mc/project/no-commit/bear/node_modules/.pnpm/ @ ud+ < email > .0/node_modules/ @ ud/icons/icons ' . is there any one hav the same problem ? < code > { test : /\.svg < cur > / , include : [ project.paths.inline_icons ( ) ] , // the real path is '/users/mc/project/no-commit/bear/node_modules/ @ ud/icons/icons ' use : reactsvgloader , }
bug report what is the current behavior ? when loading large files , there is a significant time between webpack loading minified files vs unminified files as input , not output if the current behavior is a bug , please provide the steps to reproduce . demo repo is here : < url > i tried to use the most basic webpack configuration possible what is the expected behavior ? the code for 2 test cases is the identical apart from minification . i would expect that the times to bundle are fairly equal . however on my machine using the repro in the demo repo i get these results : other relevant information : webpack version : 5.65.0 node.js version : 14 operating system : windows with linux subsystem additional tools : some sample code i pulled from @ fluentui/ < email > -beta.4 < code >
bug report what is the current behavior ? return 404 if the current behavior is a bug , please provide the steps to reproduce . what is the expected behavior ? return web worker console other relevant information : webpack version : 5.64.4 node.js version : 16.13.0 operating system : window additional tools : < code > // webpack library export module umd & esm import logger from './logger ' import mod from './mod ' console.log ( 'import.meta.url ' , import.meta.url , new url ( 'src/worker.ts ' , import.meta.url ) ) const worker = new worker ( new url ( 'src/worker.ts ' , import.meta.url ) ) // const worker = new worker ( new url ( 'src/worker.ts ' , import.meta.url ) , { // type : 'module ' , // } ) const app = ( ) = > { mod ( 'this is mod ' ) worker.postmessage ( { question : 'the answer to the ultimate question of life , the universe , and everything . ' , } ) worker.onmessage = ( { data : { answer } } ) = > { logger.info ( ' [ main thead ] ' , answer ) } } export default app
recently , i update my webpack version from 4 to 5. and now i find an error after updating it . in the past , i use const load = await import ( @ ud/biz/es/lang/locales/ < cur > { locale } .js ) ; to dynamic import my module , and it works good . but now , when i run with version 5 , it throw an error : can not read properties of undefined ( reading 'call ' ) [ the module with console.log is undefined ] . but when i change this to const load = await import ( / * webpackchunkname : `` locales-lang '' * / @ ud/biz/es/lang/locales/ < cur > { locale } .js ) ; . it works well like past . i really want to know , why did it not work without webpackchunkname property in webpack5 ? does that have to do with the upgrade of tree shaking ? thanks a lot < code >
i have a loader to handle a less file to get some information from it , and put the information in compilation , then the plugin get information from compilation and injected the information into the result using compilation.updateassets . when i use the cache , the less file does not change , and the loader does not run , that leads to the plugin can not get the information from compilation . how to solve this problem ? < code > apply ( compiler ) { compiler.hooks.compilation.tap ( pluginname , compilation = > { if ( compilation.compiler.name ? .match ( new regexp ( '^ < cur > { extracturlpluginname } ' ) ) ) { return ; } compilation.hooks.processassets.tap ( pluginname , ( ) = > { const { talosthemeoutput , talosfontsoutput } = compilation ; let themeinjectcode = `` ; let fontinjectcode = `` ; if ( talosthemeoutput & & talosthemeoutput.default ) { themeinjectcode = ' ... ' ; } if ( ( talosfontsoutput & & talosfontsoutput.length ) ) { // ... } if ( ! themeinjectcode & & ! fontinjectcode ) { return ; } if ( this.options.isdevserver ) { for ( const asset of object.keys ( compilation.assets ) ) { if ( ! asset.match ( /\ . ( bundle|js ) < cur > / ) ) { continue ; } [ themeinjectcode , fontinjectcode ] .foreach ( injectcode = > { injectcode & & compilation.updateasset ( asset , ( source ) = > { return new concatsource ( new rawsource ( injectcode ) , source ) ; } ) ; } ) ; } return ; } } ) ; } ) ; }
the confusing . when compiling my scss files from my main entry project the compile and bundle time is around 3000-5000 ms. but ! when i compile a scss file within node_modules it only takes 50-100 ms ? how come ? i do use cache-loader and it helped a lot , but still wondering how this has an effect changing a scss files from my project directory versus a scss files within foundation-sites from the node_modules directory for an instance . < code >
the compilation.assets is frozen , the configurable is false . < code > childcompiler.hooks.aftercompile.tap ( pluginname , ( compilation ) = > { source = compilation.assets [ childfilename ] & & compilation.assets [ childfilename ] .source ( ) ; // remove all chunk assets compilation.chunks.foreach ( ( chunk ) = > { chunk.files.foreach ( ( file ) = > { // delete compilation.assets [ file ] ; compilation.deleteasset ( file ) ; } ) ; } ) ; } ) ;
i am trying to load a module that is created using blob and createobjecturl and it keeps throwing unable to resolve module . here is the piece of code and here is repro url < url > errror < code > ( async ( ) = > { const code = 'console.log ( 'testing some logs ' ) ' ; const blob = new blob ( [ code ] , { type : 'text/javascript ' } ) ; const url = url.createobjecturl ( blob ) ; await import ( url ) } ) ( ) uncaught ( in promise ) error : can not find module 'blob : phofurl
my html document 's head tag has in it : < script src= '' /packs/vendors-node_modules_jquery_dist_jquery_js-exposed-e9b29cc0e77d15c93346.js '' defer= '' defer '' > < /script > and in the document 's body , i have a script tag which is trying to use jquery , but it says < cur > is undefined . how can i make it so that expose-loader does not put that defer tag on jquery so that it 's available when my script tag is executed ? < code >
webpack v4 says there are three ways to use loaders : webpack.config.js import cli docs for v5 webpack v5 says there are only two ways to use loaders : webpack.config.js import docs for v4 my question : have you deprecated loaders via cli in v5 ? thank you . < code >
i have this webpack configuration : i 'm trying to use a web worker . i 'm using the standard webpack 5 syntax : now webpack outputs the web worker as a system.js module . this obviously does n't work , because system is n't defined in the worker scope . how can i change it to something different , like es module , without affecting the main bundle ? the only workaround i 've found is returning an array with two separate configurations in webpack.config.js , which is n't very convenient . < code > new worker ( new url ( './myworker ' , import.meta.url ) ) ; { output : { librarytarget : `` system '' , ... } , ... }
here is my webpack file and html tag and i import img in index.js but after bundling img does not show ( < code > { test : /\.png < cur > / , type : 'asset/resource ' } < img src= '' .. /img/push.png '' alt= '' hero_image '' >
hello , i ran into a hash collision problem when used localidentname : [ contenthash : base64:4 ] . we have already fixed it , but there were some questions : ) is it only way to generate hash name for each separated chunk ? why css-loader can not generate hash names for classnames before chunk separate or use some unique ( e.g . timestamp ) prefix for generate hash ? reproduce : generate more then 100 classnames and use localidentname : [ contenthash : base64:1 ] for css-loader options . < code >
my application uses webpack v5 to bundle all resources . i 'm importing from a 3rd party library that itself is also bundled bundled using webpack v5 . to customise the 3rd party library , i would now need to access some of the ( not exported ) local modules within the bundle of the 3rd party library . i fully understand , that this contradicts the intention of keeping modules private , but is there some hack to access the local symbols of a 3rd partly library bundled using webpack ? < code >
i need a response of my question i try to add coffeescript in my webpack project but i ca n't require 'script.coffee ' < url > i use this doc but allway dont't work i do n't have any coffee file compiled please help and thank you < code >
hey all . i am trying to add webpack-dev-server to my local server environment for a wordpress custom theme project . right now i 've successfully installed and can run wds , but when i open the host in a browser , it just shows a folder directory instead of the actual website homepage . no matter where in the project directory tree i point static , it still just opens a folder view at that level in the browser can anyone suggest what i might be missing/doing wrong config-wise ? added to webpack.config.js : < code > devserver : { host : 'xxxxxxxxxxxxx.local ' , // my local sitebut the same thing happens if i just use 'localhost ' static : path.join ( __dirname , './ ' ) , // i 've already tried changing this to various other levels of the folder structure https : true , hot : true , port : 3000 }
hello , i 'm using webpack 5 and typescript for my library . how to make it tree-shakable and build with esm ? ca n't see any info in docs . i 'm using : < code > `` webpack '' : `` 5.64.2 '' , `` webpack-cli '' : `` 4.9.1 ''
hello , webpack now compiles images as assets , it 's fine , no external loader is necessary . when it generates base64 codes for images , it writes these into stdout when builds bundle , which invalidates other information which webpack produces to stdout , because these base64 codes are so huge . it 's only presented in development mode . output example : old file/url-loaders produces much useful output it is possible with new built-in assets management get better output for development build , then huge base64 dumps for converted assets ? < code > asset modules 1.55 kib ( javascript ) 1.8 mib ( asset ) modules by path .. /node_modules/ .... /assets/ * .jpg 84 bytes ( javascript ) 1.73 mib ( asset ) modules by path data : image/ 41.4 kib data : image/png ; base64 , ivbor ........ ...... tons of lines with base64 ...... tons of lines with base64 ..... rkjggg== 35 kib [ built ] [ code generated ]
bug report i have multiple entry points like i want to create subfolders for each entry point , emit all related files ( assets etc . ) into the folder . this works perfectly for main output file . like this . at the end i have mod1 , mod2 , mod3 subfolders with bundle.js in them . i also want to emit assets into subfolders . using same substitution names . this does not work . the 'name ' variable does not represent same thing . what is the current behavior ? if the current behavior is a bug , please provide the steps to reproduce . what is the expected behavior ? other relevant information : webpack version : 5.60.0 node.js version : 14 operating system : linux mint 19 additional tools : < code > output : { path : __dirname + '/assets ' , filename : ' [ name ] /bundle.js ' } , output : { path : __dirname + '/dist ' , filename : ' [ name ] /bundle.js ' , assetmodulefilename : ' [ name ] /assets/ [ hash ] [ ext ] [ query ] ' } , entry : { mod1 : './src/modules/mod1.js ' , mod2 : './src/modules/mod2.js ' , mod3 : './src/modules/mod3.js ' } ,
given : a single closed shadow-root that encapsulates multiple components a tree of components with colocated css files , where each imports styles to use locally i.e . import styles from './something.css ' i want to : inject a singleton style tag into the shadow root thoughts : style-loader has an insert option which could be given a function that inserts into the shadow root . but since the shadow root is closed , only the component that created the shadow root has a reference to it . there does n't seem to be a documented way to `` import '' the style-loader 's final generated css at runtime by the component that is managing the shadow root here 's an ugly workaround : create a runtime object that aggregates the css provided by css-loader and then have the aggregator provide the concatenated string to the top level component when it needs it in its render : it works , but it requires adding extra lines into every single component to aggregate the css . is there a cleaner way to do this ? < code > import aggregator from './aggregator.js ' import sheet from './something.css ' const styles = sheet.locals aggregator.append ( sheet.tostring ( ) ) / * rest of component * /
i am usingwebpack 5 with html-loader 3.0.1 , and i am now finding if i have a template.html file consisting of < html > < /html > , then if i do : import template from './template.html ' that template variable is 'export default `` // module var code = `` < html > < /html > `` ; // exports export default code ; '' ; ' why is it getting wrapped with all that stuff and how can i make it not do that ? < code >
bug report what is the current behavior ? the following error occurs , and webpack can not compile . if the current behavior is a bug , please provide the steps to reproduce . clone this repo < url > yarn yarn start == > failed open webpack.config.js , uncomment line 15 , and comment out line 16. before : after : yarn start again == > success what is the expected behavior ? useentry should recognize the type : 'asset/resource ' entry . currently , the only way i can achieve loading my resource in nested useentry is to use url-loader . however , url-loader is deprecated . other relevant information : webpack version : 5.63.0 node.js version : v16.5.0 operating system : 5.14.10-arch1-1 x86_64 gnu/linux additional tools : webpack-cli v4.9.1 , url-loader v 4.1.1 < code > [ webpack-cli ] invalid configuration object . webpack has been initialized using a configuration object that does not match the api schema . - configuration.module.rules [ 0 ] .use [ 0 ] has an unknown property 'type ' . these properties are valid : object { ident ? , loader ? , options ? } { //loader : 'url-loader ' // worked type : 'asset/resource ' , // not work } , { loader : 'url-loader ' // worked //type : 'asset/resource ' , // not work } ,
from all the comments and what i can see in the code , it seems that contexttimestamps is supposed to track directories while filestimestamps are supposed to be for files . i ask the question because both sets are initialized to be exact replicas of eachother . webpack/lib/node/nodewatchfilesystem.js line 122 in c181294 getfiletimeinfoentries : ( ) = > { webpack/lib/node/nodewatchfilesystem.js line 129 in c181294 getcontexttimeinfoentries : ( ) = > { in large repos , these are very large and expensive sets . is it possible to simply collapse these and just use filetimestamps ? i ask now because if removing is a possibility , wp6 planning may be a good time for that . see double initialization here plus extra computation here i think a simple solution for the perf cost is to just initialize compiler.contexttimestamps to compiler.filetimestamps and then just use the same set across all the places its used . cc @ sokra < code >
consider we have main application ( a ) and utility library ( u ) . we use programmatic tool to build , which runs webpack with config object . config object is composed from base config out of u with some optional config from a on top of it . generated config is fed to webpack ( ) . what paths should be added to cache.builddependencies and will they be taken into account when using config object programmatically ? how persistent cache handles imports inside config ? is it require hook when running config or ast traversing of config ? if u is inside node_modules/ as a package , should we depend on it , like in default we depend on webpack/lib ? can we ( as an alternative ) , just use cache.version instead ? say we set version = hash ( stringify ( config ) ) ? < code >
bug report what is the current behavior ? when i specified publicpath at `` /test/ '' , but found html no display when run webpack-dev-server , and furthermore found no bundle js produced ! ( observed it from chrome source tab ) . i can only resovle it that i must manually specified the bundle js by scripts label in index.html template just like that : < script type= '' text/javascript '' src= '' /test/main.js '' > < /script > this is very strangely and not reasonable . if the current behavior is a bug , please provide the steps to reproduce . yes , i 'm sure this is bug , and i tried many time in different cases . what is the expected behavior ? pls confirm from your side and try to fix it . other relevant information : webpack version : 5.61.0 node.js version : 12.18.1 operating system : additional tools : < code >
we were burned by an issue where the an unresolved reference was present and the warning that is currently shown was only seen in our ci logs . but given that it was a warning and not an error , the build passed and led to a production build w/ a unresolved reference to a file . so the question is why this property does n't just default to true for the primary case ? is it more of a common scenario where you 'd want this false , if so what are those scenarios ? < code >
sass-loader , seem to not support tsconfig path ... is this correct or an option exist to solve this problem ? tsconfig.json theme.scss button webpack webpack log < code > resolve : { mainfiles : [ 'index ' , 'main ' ] , extensions : [ '.ts ' , '.js ' , '.json ' , `` .tsx '' ] , plugins : [ new tsconfigpathsplugin ( ) ] , @ use 'components/ui/button ' ; // do n't work // @ use ' .. / .. /components/ui/button/style ' as button ; // work /components /ui /button _style.scss main.tsx `` paths '' : { `` components/ * '' : [ `` src/components/ * '' ] # sasserror : sasserror : ca n't find stylesheet to import . 1 @ use 'components/ui/button ' ;
hi , i 'm a bit confused about the the webpack 5 syntax for web workers and was hoping someone can give me some clear answers . this syntax work fine : which result in the worker in it 's own chunk : but if the url is passed in a variable , something like this : it looks like the chunk is not properly resolved : is there a way to achieve what i want in the second example with the new syntax ? < code > new worker ( new url ( './worker.js ' , import.meta.url ) ) ; // thread.js export class thread { constructor ( workerurl ) { this.worker = new worker ( workerurl ) ; } } // main.js const thread = new thread ( new url ( './worker.js ' , import.meta.url ) ) ; import { multiplyby2 } from '' ./util.js '' ; self.onmessage=function ( e ) { var s=e.data.number ; self.postmessage ( { answer : multiplyby2 ( s ) } ) } ; ! function ( ) { `` use strict '' ; self.onmessage=function ( s ) { var e , n=s.data.number ; self.postmessage ( { answer : ( e=n,2 * e ) } ) } } ( ) ;
bug report what is the current behavior ? i have an issue after upgrade to webpack 5 , we have internal components as npm packages and services that use those components and we have the following issue : package a have the following folder structure : src theme default-theme.ts views component.tsx index.ts service has the following folder structure src theme default-theme.ts exported exportedview.tsx index.ts after we run build in the service , default-theme of package a gets replaced by default-theme of the service . this does not happen if the 2 files have different paths or different name . this happens with all files that have same name and same path . what is the expected behavior ? default-theme from the services should not override the package default-theme . other relevant information : webpack version : 5.60.0 node.js version : 14 operating system : mac additional tools : current webpack configuration : < url > < code >
hey community i want to get the mode option of the current webpack compilation from within a plugin . is there a simple way for this without passing it explicitly as option when creating the plugin instance ? thanks for any hints 🙏 < code >
hi , i have a problem with javascript minify and one external plugin . for make simple : before : timestamp = countdown_default ( ) ( new date ( datetime + ' z ' ) , date.now ( ) , countdown_default.a.days ) ; webpack 4 terser-webpack-plugin 4 after : timestamp = countdown_default ( ) ( new date ( datetime + ' z ' ) , date.now ( ) , ( countdown_default ( ) ) .days ) ; webpack 5 terser-webpack-plugin 5 my problem is the code countdown_default.a.days is change to ( countdown_default ( ) ) .days ) and this create an error and the plugin is not launch . i just know , the issue came after the webpack 5 update , and nothing more . webpack et terser have change something for generate this code ? someone has already get this issue ? thank you by advance ! < code >
when i compile my project with webpack5 of cache property . i get a lot of logs like these . how can i close it like config.ignorewarning ? < code >
bug report what is the current behavior ? i get the error about hmd not defined if the current behavior is a bug , please provide the steps to reproduce . i think when i upgrade version 4 to version 5 , the treeshaking might be better . but maybe in my project , there is some unused module , and it was tree shaked . but maybe these modules is used by node service . so , to be exactly , i mainly want to know when will the webpack_require.hmd will be defined i am expecting a reply what is the expected behavior ? other relevant information : webpack version : 5.51.1 node.js version : 14.16 operating system : macos < code >
i just open the cache property , why it will build too many times . and also , when the log tell me that 'webpack build successful ' , but i ca n't open the localhost:3001/index.html until a log about webpack cache comes < code >
bug report what is the current behavior ? i upgraded webpack 4 to 5.58.1 and i am getting error : config.js:1 failed to load resource : the server responded with a status of 404 ( not found ) 383.9f47b6c6525b4d9808d8.js ? 7e90ac95af08a307e9b7:2 typeerror : ( 0 , o.x ) is not a function typeerror : ( 0 , o.x ) is not a function at 913.76620fac6614d6b7db5d.js:2 at object.usememo ( 383.9f47b6c6525b4d9808d8.js:2 ) at e.usememo ( 913.76620fac6614d6b7db5d.js:2 ) at s ( 913.76620fac6614d6b7db5d.js:2 ) at no ( 383.9f47b6c6525b4d9808d8.js:2 ) i tried general possible cases like removing node_modules/package-lock.json reinstalling packages etc and i go through the releated github issues and few of similar error in stackoverflow as well but not getting success if the current behavior is a bug , please provide the steps to reproduce . what is the expected behavior ? other relevant information : webpack version : 5.58.1 node.js version : 14.18.1 operating system : windows 10 additional tools : < code >
bug report i have a microfronted app , the base app used webpack4+vue2+vuerouter3+qiakun2 , and the subapp is same as the base . recently i upgrade the base app to webpack5 , when i load the subapp , i clicked the button to get lazy load chunk , i found the chunk resource successfuly loadedbut webpack told me message as the title describedcan anyone told me what 's the reason what is the current behavior ? my subapp webpack config the chunk relation if the current behavior is a bug , please provide the steps to reproduce . what is the expected behavior ? other relevant information : webpack version : node.js version : v14.16.0 operating system : additional tools : < code > devserver : { port : process.env.default_port , disablehostcheck : true , headers : { 'access-control-allow-origin ' : ' * ' , // } , } , publicpath : process.env.base_url , css : { loaderoptions : { sass : { data : ' @ import `` @ /style/settings.scss '' ; ' , } , } , } , configurewebpack : { output : { library : ' < cur > { name } - [ name ] ' , librarytarget : 'umd ' , jsonpfunction : 'webpackjsonp_ < cur > { name } ' , globalobject : 'window ' , } , } ,
i 'm working on upgrading to the latest versions of all webpack packages and i 'm noticing a new format for webpack-dev-server messages : is there an option for getting a human readable build time ? 171472 ms sure is precise , but it leads to unnecessary mental gymnastics , especially since this output is for humans , not machines . imo this would be much better : < code > webpack 5.58.2 compiled with 3 errors and 1 warning in 171472 ms webpack 5.58.2 compiled with 3 errors and 1 warning in 2m 51s
it seems that at one point appending ? hotreload=false to your url would disable hot reload : < url > however that does n't appear to work on webpack 5 ( i 'm currently testing on 5.50.0 ) . is there a way to disable hot reload for an individual browser session without writing any javascript code or having to restart the webpack dev server ? < code >
followed by the previous discussion , i want to make an exception for the following class name `` abc '' and how does it get it working ? does it have any example ? nuxt/nuxt.js # 9957 @ simon04 @ ooflorent < code >
webpack : 4.35.3 option and some try , i add context , library and name is same too , add vendors.dll.js that all not work ! i have no idea thanks ! < code > // webpack.dll.conf.js new webpack.dllplugin ( { context : __dirname , path : path.resolve ( __dirname , './ ' , `` [ name ] .manifest.json '' ) , name : `` [ name ] _dll '' , } ) output : { filename : ' [ name ] .dll.js ' , path : path.resolve ( __dirname , ' .. / .. / .. /dist/public/dll ' ) , library : `` [ name ] _dll '' , } , // webpack.base.conf.js new webpack.dllreferenceplugin ( { context : __dirname , manifest : require ( path.resolve ( __dirname , './ ' , 'vendors.manifest.json ' ) ) , } ) ,
so i 'm hooking into done to spawn a child-process which is actually a custom server that launches over the dist folder and only once ( after the first compilation ) . the server has a watcher itself so there is no need to relaunch it every single time . the problem is that i would like to signal an abort process from webpack if i got an error from my spawn process . the first time i call it . what do i need to trigger in webpack to exit the watch mode ? < code >
bug report what is the current behavior ? i have a project build with react that run perfectly in development but in the moment that i try to compile to production present the next error : if the current behavior is a bug , please provide the steps to reproduce . in this repo , i have a branch named gh-pages in the bundle . [ contenthash ] .js in the line 9568 what is the expected behavior ? that webpack compiles normally because it does it in development mode . you can run the master branch with npm start to check it . it is going around in my head and i really do n't now what i 'm doing wrong , i appreciate any help . other relevant information : webpack version : < email > .0 node.js version : v16.4.1 operating system : ubuntu 20.04.3 lts additional tools : i was use the gh-pages packages to deploy it after run npm run build < code > typeerror : f.usestate is not a function at x ( bundle.401809f7e2b1bf0c5287.js ? dbbd351bf274641f0ba8:9568 ) at ro ( bundle.401809f7e2b1bf0c5287.js ? dbbd351bf274641f0ba8:3957 ) at wi ( bundle.401809f7e2b1bf0c5287.js ? dbbd351bf274641f0ba8:7455 ) at pu ( bundle.401809f7e2b1bf0c5287.js ? dbbd351bf274641f0ba8:6610 ) at _u ( bundle.401809f7e2b1bf0c5287.js ? dbbd351bf274641f0ba8:6604 ) at su ( bundle.401809f7e2b1bf0c5287.js ? dbbd351bf274641f0ba8:6594 ) at yu ( bundle.401809f7e2b1bf0c5287.js ? dbbd351bf274641f0ba8:6361 ) at fu ( bundle.401809f7e2b1bf0c5287.js ? dbbd351bf274641f0ba8:6155 ) at xu ( bundle.401809f7e2b1bf0c5287.js ? dbbd351bf274641f0ba8:7279 ) at bundle.401809f7e2b1bf0c5287.js ? dbbd351bf274641f0ba8:7377
i 'm interested in extending the webpack runtime so i can collect some metrics around number of chunks downloaded at runtime , and some other stats . is it possible for me to provide a custom runtime to achieve this ? < code >
when use babel to transpile my code , they shove an extra require in there . my solution was to disable transpiling so there 's no commonjs , no require . but lets say i run babel , and i 'm transpiling and i dont want it to be in one single file , i want it to be transpiled but still in seperate logical files like say split chunks . how does shared code in webpack split chunks work ? my own solution was using browserify or require js but i 'm curious to see how wepback does it . < code >
please see microsoft/typescript # 46344 , typestrong/ts-loader # 1383 for more details . < url > this code works in commonjs modules , but will fail in es modules because relative import paths need to use extensions . as a result , it will have to be rewritten to use the extension of the output of foo.ts so bar.ts will instead have to import from ./foo.js . ... this might feel a bit cumbersome at first , but typescript tooling like auto-imports and path completion will typically just do this for you . resolve.extensions takes an array of suffixes , but does n't seem to be able to express replacements and does n't seem to take such an expressive function , by the documentation . is there a way in current releases to support the typescript 4.5 explicit eventual-extension-for-relative-imports policy ? < code >
i have two parallel compilations : application itself ; web worker ; i need to load worker from the application , and i need worker file name to be hashed . is it possible to implement this somehow ? < code >
webpack does not support multiple strings being passed into the target property ... -- < url > does this still mean multiple fully-independent webpacking work though , right ? related to react ssr , i am webpacking a library of common ui components which is reusable/isomorphic in both the browser client-side environment and the node server-side environment . aside from the chunking logic which is platform-specific , most of the script code should be executable in both environments - there are no native operations for these components . for a very basic webpack project , the emitted differences between the targets of `` web '' vs `` node '' , the `` production '' build changes seem trivial , minification aside : [ id ] .js/main.js : runtime.js : the `` development '' mode emits are bigger but also seem mostly identical . is there a major reason why these emits could n't be unified for an isomorphic single bundle output that is executable in either browser or node environments , perhaps with certain restrictions or warnings about use of native dependencies ? if this goal is in reach , is it limited to a change in the splitchunksplugin ? where is the code for that ? the benefit would be a single build cpu load for both consumers of ssr ui code . thanks ! < code >
i am using webpack 5. i facing an issue where webpack build process hangs at building 5/6 entries 12443/12532 ....... without giving much log or info on the console . i have identified this issue happened after i have updated an internal npm package which part of the application i am building . the package is basically a css library and the changes that were done was some refactors . however i am still not sure what exactly inside the package is causing webpack to hang . can anyone suggest how to debug this issue ? i mean is there anyway i can get more logs on the build process with which i can identify whats going wrong ? < code >
hello , maintainer of < url > we are looking at redesigning our web front end with react from angular.js ( 1.x ) . buildbot is designed to be very configurable , and we want users to be able to create their own custom pages , which are then packaged in a .js and .css file that is just loaded inside the webapp ( via script tags ) with angular.js , we could just provide library and ui code via angular.js 's dependency injection , we just had to provide the plugin the angular object as a global variable and everything will just load and connect together . we would like to reproduce this with webpack . plugins can just import the buildbot library from their plugin . autocomplete should work and everything js developers are expecting . ( this was a very loud complain from our users that autocomplete do not work with angular.js dependency injection ) buildbot-base code should not be included in the plugins bundle , but linked at runtime from the main app 's bundle . react and other base third party libraries should also be linked at runtime from the main app 's bundle . we can load plugins via script tags or via es6 dynamic import if that would simplify the design . what do you think would be the best approach to this problem ? < code > import react from 'react ' ; import buildwidget from 'buildbot-base ' ; import registermenuitem from 'buildbot-base ' ;
tags : module concatenation , optimization , bailout , tree the bailout condition for only including a module in concatenation if all references to it are in the same chunks as the concatenated module is overly restrictive and leaves a lot of optimization potential on the table : webpack/lib/optimize/moduleconcatenationplugin.js lines 635 to 645 in < phone > // module must be in the same chunks like the referencing module const otherchunkmodules = incomingmodules.filter ( originmodule = > { for ( const chunk of chunkgraph.getmodulechunksiterable ( config.rootmodule ) ) { if ( ! chunkgraph.ismoduleinchunk ( originmodule , chunk ) ) { return true ; } } return false ; } ) ; a particularly common case where this criteria gives suboptimal results is for any module that is synchronously loaded in the initial chunk , then referenced in async chunks . although it is referenced from other chunks , those chunk load strictly after the concatenated module , and thus scope hoisting would still be beneficial . it would , however , require remapping the imports in the later chunks . a slightly more relaxed but still technically correct condition is that the root module of the concatenated module must already be present in the synchronous dependency graph of each origin module . the most correct would be that the flattened synchronous dependencies of every entry point or async imported module of the graph include both the root and candidate module , or neither of them . this equates to that the concatenation will never increase the set of modules that will be evaluated in webpack 's current round of module evaluation . < code >
i have a single entrypoint with split chunks enabled . i want to generate a single output file `` app- [ contenthash ] .js '' which will then import the other chunks as necessary . i 've tried tweaking the config , and so far the only thing that seems to produce the single file is to disable split chunks entirely . with my current config , i 'll get more than one app- < some hash > .js file . my use case : i need a uri to a single script that i can dynamically inject into a page . related to module federation . key parts from my config related this seems to be what i want , but the question was n't given a satisfactory answer : < url > < code > { entry : { app : [ 'entry.js ] } , output : { path : 'dist ' , publicpath : '/ ' , filename : ' [ name ] - [ contenthash ] .js ' , chunkfilename : 'chunk- [ contenthash ] .js ' , sourcemapfilename : ' [ contenthash ] .js.map ' , } , optimization : { splitchunks : { name : false , minchunks : 2 , chunks : 'async ' , maxsize : < phone > , minsize : 20000 , maxinitialrequests : 30 , maxasyncrequests : 30 , automaticnamedelimiter : '- ' , cachegroups : { defaultvendors : { priority : 0 , name : 'vendors ' , test : / [ \/ ] node_modules [ \/ ] /i , } , } , } , } , }
i am a beginner to this project i would love to contribute to this project .so that i can do my first contribution . can anyone suggest me some beginner friendly issues . it would be really great if i can contribute to this amazing project . thank you < code >
i have a script that loads js file which imports dynamic modules ( function imageextension ( s , p , o , t , t ) { s.spottoptions = t || { } ; t=p.getelementsbytagname ( 'head ' ) [ 0 ] ; var el=p.createelement ( 'script ' ) ; el.async=1 ; el.src=o ; t.appendchild ( el ) ; } ( window , document , ' < url > { } ) ) this imageextension.js should load modules from list basictags : ( ) = > import ( / * webpackchunkname : `` basictagsplugin '' * / ' .. / .. /plugins/basictags ' ) , trackedtags : ( ) = > import ( / * webpackchunkname : `` trackedtagsplugin '' * / ' .. / .. /plugins/trackedtags ' ) , ... const loadedplugins = ( await promise.all ( internalplugins ) ) .map ( ( plugin ) = > plugin.default ) ; i have an edge case where website throws error on these imports uncaught ( in promise ) typeerror : can not read properties of undefined ( reading 'call ' ) what could be the problem ? is there anything that can influence imports ? maybe it ca n't read correct path or something < code >
what is the current behavior ? i got weird error for a statement that works when copy pasting to browser console : ca n't convert bigint to number it 's because , the statement was complied to other relevant information : webpack version : @ nuxt/webpack 2.16.8 which uses webpack 4.46.0 node.js version : v14.16.1 operating system : - additional tools : - < code > var rate = bigint ( this.sale.rate ) * math.pow ( bigint ( 10 ) , bigint ( this.decimals ) ) let rate=bigint ( this.sale.rate ) * ( bigint ( 10 ) * * bigint ( this.decimals ) )
host : standalone remote : i think app2 should not share with app1 's react due to version mismatch . however , app2 uses app1 's react debugging shows that they all use __webpack_require__ . e ( `` vendors-node_modules_react_index_js '' ) may i ask why they are not differentiated according to version , but all use vendors-node_modules_react_index_js , not , for example , 16.8.0/vendors-node_modules_react_index_js and 16.14.0/vendors-node_modules_react_index_js thanks ! < code > new modulefederationplugin ( { name : `` app2 '' , shared : { react : { requiredversion : '16.14.0 ' , import : `` react '' , sharekey : `` react '' , sharescope : `` default '' , singleton : true , } , } , } ) , new modulefederationplugin ( { name : `` app1 '' , shared : { react : { version : '16.8.0 ' , import : `` react '' , sharekey : `` react '' , sharescope : `` default '' , singleton : true , } , } , } ) ,
bug report what is the current behavior ? when attempting to bundle a node.js project that depends on node-gyp , the following error is displayed : the same does n't happen if i simply install the native module ( which is also compiled ) and run it without webpack . if the current behavior is a bug , please provide the steps to reproduce . create a node.js app that depends on a native module that will be compiled through node-gyp try to bundle it what is the expected behavior ? as far as i understand , node-gyp should not attempt to compile a c # module in a mac machine . i may be wrong or missing something here . my impression is that node-gyp detects the os somehow to pick the right compiler , but somehow this info may be lost when running through webpack . if you guys have any clue , it 's much appreciated . if this is not related , please feel free to close the issue and i may try my luck with the node-gyp guys . thanks in advance . other relevant information : webpack version : 5.45.1 node.js version : 14.17 operating system : mac os big sur 11.4 additional tools : < code > error in ./node_modules/node-gyp/lib/find-visualstudio.cs 9:6 module parse failed : unexpected token ( 9:6 ) you may need an appropriate loader to handle this file type , currently no loaders are configured to process this file . see < url > | // this script needs to be compatible with powershell v2 to run on windows 2008r2 and windows 7 . | > using system ; | using system.text ; | using system.runtime.interopservices ; @ ./node_modules/node-gyp/lib/ sync ^\.\/ . * < cur > ./find-visualstudio.cs @ ./node_modules/node-gyp/lib/node-gyp.js 41:13-36 190:36-53
hi , the latest version of set-value is 4.1.0 ( < url > ) the project is using react-scripts v4.0.3 , which is using webpack v4.44.2 which has set-value as the transitive dependency : -- react-scripts @ 4.0.3 -- < email > .2 -- < email > -- snapdragon @ 0.8.2 -- < email > .2 -- cache-base @ 1.0.1 + -- set-value @ 2.0.1 -- union-value @ 1.0.1 -- set-value @ 2.0.1 deduped the set-value v2.0.1 has the following vulnerability : ghsa-4jqc-8m5r-9rpr does the latest version of webpack has updated version of set-value ? thanks , < code >
my webpack built express server is not able to find the bundle file . the resource from `` < url > was blocked due to mime type ( `` text/html '' ) mismatch ( x-content-type-options : nosniff ) . here is my < url > none of the online suggestions are helpful . please help tia < code >
a particular library prescribes that we add this to the webpack config file for it to work : module : { rules : [ { parser : { amd : false } } ] } which works fine in webpack 4 but not in webpack 5 , giving this error : modulenotfounderror : module not found : validationerror : invalid parser object . json modules plugin has been initialized using a parser object that does not match the api schema . - parser has an unknown property 'amd ' . these properties are valid : object { parse ? } . may i know what is the webpack 5 equivalent of writing the above lines of code to disable amd ? thanks ! < code >
hi , i am unable to find clear instructions , how to build completely separated js file to use as worker . i tried to add additional entry point : webpack.config.js : this creates `` /firebase-messaging-sw.js '' file , but it depends on other chunks and can not be loaded as worker . how i can bundle firebase-messaging-sw.js and all it 's dependencies to the completely standalone js file ? < code > ... entry : { `` app '' : `` ./src/main.js '' , `` firebase '' : { `` import '' : `` ./src/firebase-messaging-sw.js '' , `` filename '' : `` firebase-messaging-sw.js '' , `` publicpath '' : `` / '' , } , } , ...
i 'm looking to store plugin processing data into the persistent caching . is there a property i can add serializable data to that i can re-read on cache-hit ? i 'm developing a webpack plugin & loader combo that optimizes/tree-shakes a json module given that it 's only accessed using a specific getter function . for example , given a build that contains one function call getproperty ( 'property-name ' ) , the plugin will strip all properties in the json module except property-name . ( i believe terser can handle something like this but this is a boiled down version of a more complex system that terser could not optimize ) the plugin + loader has two steps : detects the usage of an arbitrary function ( eg . getproperty ( 'property-name ' ) ) via normalmodulefactory.hooks.parser removes unaccessed property names from a json module in the compilation.hooks.finishmodules hook that has the loader applied to it , and runs compilation.rebuildmodule for the loader to optimize the json module based on data from step 1 this works fine on first build , but , when persistent cache is enabled , step 1 ( javascript parsing in modules ) seems to be only executed for changed files . so the json optimization thinks only properties in the changed files are actually used . how can i add the result from step 1 into the persistent cache so that it does n't need all js to be re-parsed on a cache hit build ? < code >
i current have this dependency graph among chunks : i initially just had the main and vendor chunks . main is quite big ( around ~2mb ) and takes a while to download in some environments , so i created a new preload chunk . the preload chunk is small ( few kbs ) where some utils from main moved into . the three chunks are all initial chunks . the use of preload , given that it 's small , is that it will be able to do some preprocessing stuff while the other much bigger initial scripts are still downloading , since it 's quite small and will be downloaded much faster . however , the modules inside the preload chunk are n't evaluated as soon as the chunk finishes downloading . they are evaluated after all the initial chunks have been downloaded . it seems the code for running all the initial modules are in main since it 's the initial chunk that depends on the other initial chunks . is it possible for other initial chunks to have runtime that will evaluate their modules after they 've downloaded ? based on the graph above , both main and preload might dynamically import other chunks : when preload dynamically loads a chunk that depends on some modules from main , webpack must start downloading the dynamic chunk asap . however , the modules within the dynamic chunk will only be evaluated when main finishes downloading and evaluating because the dynamic chunk depends on main . < code >
recently , i try to replace babel-loader from esbuild-loader to improve the compile speed of my project . but when i use esbuild-loader , i find the build of project with webpack5 , the use `` cache : true '' is slower than without it . i do n't know why there is such a phenomenon . my webpack version is 5.51.0 < code >
webpack handle json import automatically in bundle process , but i can not import json file in the config itself . if there is already solution please let me know , thanks ! p.s : i use babel and js < code >
hello , i am working on upgrading to webpack 5 ( from 4 ) and have run into an issue while building for production using the node api . the issue does not occur in development . based on this issue , i thought that the issue may have been caused by a webpack version mismatch within my node_modules however , after confirming that only 1 version of webpack ( ^5.35.0 ) was installed , the issue persists i 've been banging my head against the wall for a few days on this , any help would be appreciated < code > unhandled rejection can not read property 'buildmeta ' of undefined typeerror : can not read property 'buildmeta ' of undefined - harmonyimportspecifierdependency.js:156 harmonyimportspecifierdependency.getwarnings [ frontend ] / [ webpack ] /lib/dependencies/harmonyimportspecifierdependency.js:156:37 - compilation.js:2579 compilation.reportdependencyerrorsandwarnings [ frontend ] / [ webpack ] /lib/compilation.js:2579:24 - compilation.js:2197 [ frontend ] / [ webpack ] /lib/compilation.js:2197:10 - flagdependencyexportsplugin.js:376 [ frontend ] / [ webpack ] /lib/flagdependencyexportsplugin.js:376:11 - async.js:2830 [ frontend ] / [ neo-async ] /async.js:2830:7 - async.js:2850 object.each [ frontend ] / [ neo-async ] /async.js:2850:39 - flagdependencyexportsplugin.js:355 [ frontend ] / [ webpack ] /lib/flagdependencyexportsplugin.js:355:18 - async.js:2830 [ frontend ] / [ neo-async ] /async.js:2830:7 - async.js:2865 done [ frontend ] / [ neo-async ] /async.js:2865:11 - async.js:2818 [ frontend ] / [ neo-async ] /async.js:2818:7 - flagdependencyexportsplugin.js:88 [ frontend ] / [ webpack ] /lib/flagdependencyexportsplugin.js:88:11 - cache.js:91 [ frontend ] / [ webpack ] /lib/cache.js:91:34 - memorycacheplugin.js:45 array. < anonymous > [ frontend ] / [ webpack ] /lib/cache/memorycacheplugin.js:45:13 - cache.js:91 [ frontend ] / [ webpack ] /lib/cache.js:91:19 - runmicrotasks - task_queues.js:93 processticksandrejections internal/process/task_queues.js:93:5
feature request for now seems like the splitchunks minsize calculated raw file size , i have a utils.ts , the file size more than 5kb with comments , otherwise not , the config for min size is 5000 , the chunk is split . with comments ( the chunk less 1kb after minimize but still split ) after remove comments in utils.ts , the chunk is removed . what is the expected behavior ? minsize can be calculated after minimize and tree shaking what is motivation or use case for adding/changing the behavior ? it does make sense if we set min size 5kb chunks , and the chunks will more than 5kb . 😄 max size as well , for now , default maxsize 0 , the node_modules chunks is 180kb , after i set maxsize to 100kb , i think there are two chunks , but there is three , and left two chunks total size is less than 100kb , i m confused why it can not be one chunk . how should this be implemented in your opinion ? add a flag for now and set the default to true for the next major version are you willing to work on this yourself ? yes < code >
hi , in my project i use webpack 5 and module federation for microfrontends . in my case i want to know which remote applications were not used in source code but defined in plugin . how can i make it as simple as possible ? can webpack provide stats or warnings after build ? < code >
hey everyone ! i 'm currently looking into adding new relic as a frontend monitoring tool for our mf host . would love to hear if there are any recommendations on how such monitoring should be handled in the module federation world , should the host be incharge of it ? should remotes not include their own monitoring implementations ? < code >
given , 'context.compilation ' and 'context.webpackconfig ' , how can i render ' [ name ] .html ' to 'foobar.html ' ? < code > new htmlwebpackplugin ( { inject : false , templatecontent : ( { compilation , webpackconfig , htmlwebpackplugin } ) = > { const x = ' [ path ] or [ name ] or something else.html ' // 🤔 const y = magic ( x ) // output : 'foobar.html ' // other code ... } } )
i want to introduce module federation to my company . right now , my company has an ecosystem set up where multiple angular spas are deployed under a common domain . if spa a wants to utilize another spa 's ( spa b ) modal for whatever , the system in place relies on opening a browser-sized iframe to spa b where the modal is displayed . this is the system i want module federation to replace , but i do have a big question - is there a way to prevent 3rd party applications from loading modals they should n't ? if webpack is too low-level like i fear it might be , what is a common pattern people are doing to accomplish permission checking ? < code >
i want to create minification and bundle of 3rd party js files which i want to upload s3 and directly can use inside < script src= '' cdnpath '' / > in other app that mean if i minify/bundle jquery.js it will minify in jquery.min.js format which should standard and can be use by just src path as like this but the problem which i am facing is it is minified with e.exports hence i can not use directly that bundle or minified file to other app i already tried with module ecma2015 and babel-loader but could not get success , can anybody suggest for . i am working on bundling app with cdn and i need bundle with ready to serve format i want to preparing app where i can bundle the files and upload to s3 for example this is a cdn which is serve bundle and without arrow function and i can directly use this path to src= '' '' i do not need to import or create variable phofhyperlink < code >
to simplify the question say that i have this tree structure of files & folders now i would like to import a component without referenciating the folder and use instead a dynamic resolution where the name path is expanded to incorporate the folder name as well . so instead of doing : i would like to do : but i do n't want to write an alias for each folder inside the components tree . so i 'm wondering if there is a way i can use a placeholder/wildcard/glob in the alias configuration of webpack so it can expand the last part of my path to include a folder with the same name . is this possible ? preferrably without any third party plugin . so in a very basic pseudo code i would expect something like this : the & here should be later expanded to incorporate the last part of the path to resolve . and then i will use the `` @ components '' to better trigger the alias resolution . is this possible ? < code > import componenta from 'components/componenta ' components componenta componenta.tsx other files for componenta ( styles , types , etc ) componentb componentb.tsx other files for componentb ( styles , types , etc ) ... componentz componentz.tsx other files for componentz ( styles , types , etc ) import componenta from 'components/componenta/componenta ' webpack : { alias : { ' @ components/ & ' : path.resolve ( __dirname , 'src/components/ & / ' ) , } ,
the following error message occurs when using webpack . ps c : \workspace\mission > npm run dev webpack-demo @ 1.0.0 dev webpack -- mode=development [ webpack-cli ] [ error : eperm : operation not permitted , open ' c : \workspace\mission\dist\px.bundle.js ' ] { errno : -4048 , code : 'eperm ' , syscall : 'open ' , path : ' c : \workspace\mission\dist\px.bundle.js ' } running the npm cache clean -- force command works fine . however , if i run the npm run dev command 3 or 4 times , the same error repeats again . i gave the account admin rights , and i also gave full control to the folder . i tried running it in admin mode , but it did n't work . how to fix this error ? webpack version is < email > .0 < code >
i 'm currently with two projects bundled with webpack : library main project the library depends on threejs , but i 'd like to make it an external dependency loaded from cdn when i call library inside project . i 've created a sample repo * to demonstrate the current behavior , with further information on the readme , but the main issue is that the library is working on itself and i can even test the cdn method with a localhost server . but when the project imports it , i receive an error stating that library.function is not a function what may i be doing wrong ? * repo : < url > < code >
good day to all of you . i make the project dependencies external . in external , in the webpack configuration file , i map the necessary keys to global variables . i load global variables via cdn . the question is , what other ways can i set global variables to work with external dependencies ? < code >
hi ! i have just started using webpack and want to configure to compile pug and sass files . but facing compilation error , do pardon me if there is a silly mistake . here below on left is my project structure with webpack.congif.js file in middle . code input : src folder in root directory having pug and sass folder separately . code output : expected compiled code in dist folder . i have replaced project root address with this my_project_root_directory error : would be very thankful , if someone could help me with this issue . < code > compiled with problems : x error : module not found : error : ca n't resolve './src ' in 'my_project_root_directory ' error : error : child compilation failed : module not found : error : ca n't resolve 'my_project_root_directory\src\pug ' in 'my_project_root_directory ' modulenotfounderror : module not found : error : ca n't resolve 'my_project_root_directory\src\pug ' in 'my_project_root_directory '
can i get some information and guidance on these settings , which default to `` true '' at all times ? i have found that , starting from a webpack 5 incremental rebuild time of 6.20 seconds , setting module.unsafecache : true reduces my incremental rebuild time to 4.88 seconds , and that disabling these four optimization settings on top of that reduces incremental rebuild times further to 4.22 seconds , approaching parity with webpack 4 at 3.68 seconds . i do not want to disable any tree shaking functionality that would cause subtle differences between development and production mode , should a side-effect be shaken away in production but not development . here are my questions : if these optimization features are left on ( their default settings ) , can i absolutely rely on development mode and production mode having the same tree-shaking behaviors with respect to side-effects ? if not , what other measures must i undertake ? if so , can i safely disable any of these feature with respect to that intention ? which ones ? < code > optimization.providedexports optimization.usedexports optimization.sideeffects optimization.innergraph
i get an error in my program ( webpack : `` version '' : `` 5.42.1 '' ) : at first i think it 's axios 's problem , but then i found this pkg is my local package.json ( webpack : //myprogram/./node_modules/axios/lib/helpers/validator.js ? f9a6 ) it should be axios 's pkg with the path . and then i found this code in call stack : it seems be webpack changed my require path from ./ .. / .. /package.json to ./package.json , and with the flat node_modules , it get my local package.json . can someone help me explain why webpack changed my require path ? and is this a bug ? thx very much < code >
hello , i use laravel mix to deploy my app then for some reason , i want to change something for my vue components and i must re-run `` npm run production '' again . when use this command , my cpu is 100 % and it takes about a few minutes . my questions is : how can i re-deploy my app better ? thanks in advanced , chu < code >
bug report what is the current behavior ? i want to add third-party dependencies to babel processingwhen referencing a third-party dependency , its internal package.json 's type is module , according to < url > webpack transfer it as esmodules , in the browser , report an error : exports is not defined . if the current behavior is a bug , please provide the steps to reproduce . what is the expected behavior ? it displays normally in the browser other relevant information : webpack version : 5.51.1 node.js version : 16.4.2 operating system : mac os additional tools : < code >
bug report webpack-5 's document says we can use web worker directly without using other loaders here like : but for project wrote in typescript , this expression will be : which does not function as expected . what is the current behavior ? dist/worker.ts file is generated in dist instead of dist/worker.js , loading ts file as worker file will cause mine type error , although contents of dist/worker.ts are transpiled javascript codes . if the current behavior is a bug , please provide the steps to reproduce . as above metioned , one typescript file as worker , and another typescript file using it via new worker . would reproduce . what is the expected behavior ? generating dist/worker.js file . other relevant information : webpack version : 5.49.0 node.js version : 14.17.4 operating system : macos big sur 11.4 additional tools : typescript @ 4.3.5 ts-loader @ 9.2.5 < code > new worker ( new url ( './worker.js ' , import.meta.url ) ) ; new worker ( new url ( './worker.ts ' , import.meta.url ) ) ;
i have a project where some of its files have .js file extension as well , but however those js files are not supposed to run in the browser at all . although those files have .js extension , they should be treated as plain text asset only , i think . in other words , i want webpack to ignore/override their .js file extension . currently i 'm trying type : 'asset/resource ' ( with rules matching them , excluding other js files which should be treated just as js ) , but then stuck with parsing/compilation errors from those .js files ( in my opinion they should not be treated as js at all ) , i tried something like adding resolve : { extension : [ 'txt ' ] } ( sorry , `` resolve '' was mistyped as `` parser '' , now corrected ) but it did n't seem to work . < code >
hello i have a project that works fine with webpack 4 and now i want to upgrade it to webpack 5 right now some modules is build with css-loader + extract-loader + raw-loader . it used for small chunks of css , which is used in ssr code what i got with webpack 5 : extract-loader and raw-loader is deprecated by asset modules okay , in simple case , i can go `` asset/source '' and it works fine but , if css contains url ( ... ) , it should be processed properly ( to update the paths , extract images , etc ) with css-loader result asset contains intermediate module source like // imports import ___css_loader_api_import___ from ... , so i need something between asset modules and css-loader i 've tried several options here : use to-string-loader , as it suggested in docs : < url > it does n't work , just produces to-string-loader 's source . other note : to-string-loader is outdated and does n't work with es modules from css-loader use extract-loader . it is also outdated and does n't work with current version of css-loader , it ca n't parse import.meta.url do n't use asset modules , combine css-loader + to-string-loader + type : 'javascript/auto ' . only this works for me , but i 'm very confused what is the right way here ? how can i get asset modules + css-loader to work ? < code >
hi i have just updated the webpack 2 from webpack 3 i have got this error g : \web_appuild\server.js:98800 throw new error ( `` module build failed : `` ) ; ^ error : module build failed : at object . ( g : \web_appuild\server.js:98800:7 ) at webpack_require ( g : \web_appuild\webpack : \webpackootstrap 7344fdcfe8d5a6b67db0:19:1 ) at object . ( g : \web_appuild\server.js:95376:75 ) at webpack_require ( g : \web_appuild\webpack : \webpackootstrap 7344fdcfe8d5a6b67db0:19:1 ) at object . ( g : \web_appuild\server.js:95295:67 ) at webpack_require ( g : \web_appuild\webpack : \webpackootstrap 7344fdcfe8d5a6b67db0:19:1 ) at object . ( g : \web_appuild\webpack : \src outes\index.js:9:1 ) at webpack_require ( g : \web_appuild\webpack : \webpackootstrap 7344fdcfe8d5a6b67db0:19:1 ) at object . ( g : \web_appuild\server.js:42204:67 ) at webpack_require ( g : \web_appuild\webpack : \webpackootstrap 7344fdcfe8d5a6b67db0:19:1 ) at object . ( g : \web_appuild\server.js:42149:18 ) at webpack_require ( g : \web_appuild\webpack : \webpackootstrap 7344fdcfe8d5a6b67db0:19:1 ) at g : \web_appuild\webpack : \webpackootstrap 7344fdcfe8d5a6b67db0:62:1 at object . ( g : \web_appuild\server.js:68:10 ) at module._compile ( internal/modules/cjs/loader.js:759:30 ) at object.module._extensions .. js ( internal/modules/cjs/loader.js:770:10 ) g : \web_app ools unserver.js:60 throw new error ( server terminated unexpectedly with code : < cur > { code } signal : < cur > { signal } ) ; ^ error : server terminated unexpectedly with code : 1 signal : null at childprocess . ( g : /web_app/tools/runserver.js:44:17 ) at object.oncewrapper ( events.js:284:20 ) at childprocess.emit ( events.js:196:13 ) at childprocess.eventemitter.emit ( domain.js:471:20 ) at process.childprocess._handle.onexit ( internal/child_process.js:256:12 ) error command failed with exit code 1. info visit < url > for documentation about this command . ps g : \web_app > > anyone have idea ? < code >
i use html-loader and extract-laoder to extract html file , but extractorloder.js always report errors . my config is : const pathtoindexhtml = require.resolve ( `` ./src/file.html '' ) ; const pathtomainjs = require.resolve ( `` ./src/index.js '' ) ; module.exports = { entry : [ pathtomainjs , pathtoindexhtml ] , output : { assetmodulefilename : `` [ name ] [ ext ] '' , } , module : { rules : [ { test : pathtoindexhtml , type : `` asset/resource '' , generator : { filename : `` [ name ] [ ext ] '' , } , } , { test : pathtoindexhtml , use : [ `` extract-loader '' , '' html-loader '' ] , } , ] , } , } ; and use official website example also report same error . error is : module build failed ( from ./node_modules/extract-loader/lib/extractloader.js ) : syntaxerror : unknown : unexpected token ( 3:62 ) import 'html_loader_get_source_from_import ' from `` .. /node_modules/html-loader/dist/runtime/geturl.js '' ; var 'html_loader_import_0 ' = new url ( `` ./images/nhlt.jpg '' , import.meta.url ) ; import can not been properly disposed < code >
i have a library , which i 'm trying to create a bundle that would follow the same principles as the material-ui project . i 'm trying to enable multiple imports strategy like : i am not entirely sure how would i be able to copy the same file-tree structure , while also deep-bundling my library . or if i should be using webpack or other mechanism to achieve this . have you ever had to deal with this using webpack ? < code > import { button } from 'my-library ' ; import { button } from 'my-library/components ' ; ' import button from 'my-library/components/button ' ; import button from 'my-library/components/button/button.component.jsx ' ;
i try to replace function declaration with defineplugin and it worked with 4th version of webpack , but 5th ( 5.26.2 ) not ; i have repository with demo : < url > and issue reported to storybook project storybookjs/storybook # 14257 in webpack config there is : in code this declaration not replaced with defineplugin : but this one : compiled to : i have added my note to storybook ticket too : storybookjs/storybook # 14257 ( comment ) < code > window.fake_global_function ( ) ; var tempvariable = ( function ( ) { return console.log ( 'log from define plugin function ' ) ; } ) ; tempvariable ( ) ; plugins : [ new webpack.defineplugin ( { `` process.env.node_env '' : json.stringify ( `` development '' ) , `` window.fake_global_function '' : `` ( function ( ) { return console.log ( 'log from define plugin function ' ) ; } ) '' , } ) , ] , const tempvariable = window.fake_global_function ; tempvariable ( ) ;
bug report what is the current behavior ? for a dynamic import like this webpack 5 will generate the following source code chunk for me : account.e5d772cdaf3c5f18ee93.js and a vendor chunk that looks something like : 323.fee73acb2259d6f54633.js if the current behavior is a bug , please provide the steps to reproduce . try a dynamic import with webpackchunkname magic comment do not specify optimization config or use splitchunksplugin run the build check the resulting chunk files and try to find the vendor chunk for your source chunk what is the expected behavior ? previously , with webpack 4 , i 'd get files that look like : account.e5d772cdaf3c5f18ee93.js account~vendor.fee73acb2259d6f54633.js other relevant information : webpack version : 5.50.0 node.js version : 12.16.2 operating system : linux additional tools : < code > import ( / * webpackchunkname : `` account '' * / / * webpackprefetch : true * / './components/account/account ' ) ,
based on webpack official documentation on how stats.loggingdebug works , when stats.logging is set to false , this option should be ignored . well , that 's not the case based on my latest builds ( i have tried with stats.logging : 'none ' as well ) . just want to open a discussion here to be sure if this is a bug to report or if i 'm doing something wrong . < code >
i understand that module federation cant tree shake a shared resource on build because the module that is running the build can not know what parts of the shared resource other remote modules might need . however - its seems to me that module federation is n't even tree shaking the internals of the shared resource . example : say im sharing @ shared/index.js from the example above . while we do n't know exactly what the remote modules are going to use from this file , we do know that they can only use what is exported . the rest of the code can safely be tree shaken . in the example above , module federation does n't need to include the entire @ shared/utils/utilfunc.js , just any parts used by exported members of the main shared resource and it deps . in the example above , adifferentutil should be shaken out . < code > // @ shared/index.js import { utilfunc } from @ shared/utils/utilfunc.js export function atestfunction ( ) { utilfunc ( ) } // @ shared/utils/utilfunc.js export function utilfunc ( ) { .... some code } export function adifferentutil ( ) { ... some code }
when using : webpack repeatedly recompiles itself over and over after the first file change : that happens on every poll , but if you do n't specify a poll it recompiles itself every couple of milliseconds . i have no idea why but it seems as if webpack compiles - > triggers on its own file change event - > recompiles again , over and over . i 've removed and uninstalled and uncommented just about everything i have , what 's left is basically as little as webpack can have to still function , along with ts-loader , so the only real external variable here is ts-loader , but i have no idea if that 's relevant or not . perhaps ts compiling files is interfering with webpack 's ability to pick up on file changes or something . disabling watching in tsconfig.json has no effect on it , still the same . trying to ignore any files using ignore or the ignore plugin has no affect , just gets `` ignored '' . `` webpack '' : `` ^5.49.0 '' < code > webpack compiled successfully webpack compiled successfully webpack compiled successfully webpack compiled successfully webpack compiled successfully webpack compiled successfully webpack compiled successfully webpack compiled successfully webpack compiled successfully config.watch = true config.watchoptions = { aggregatetimeout : 200 , poll : 1000 , followsymlinks : true , ignored : /node_modules/ , }
hi , we a have a react app where we are using dynamic imports for code splitting each route/page of the app . we are using optimization.splitchunks for cache group node_modules but only the ones that needed for the initial load . ( without the node_modules that used only by the lazy loaded chunks ) something like when trying to implement module federation , the app act as a shell and we are sharing around 80 modules . this is leading for around 80 files loaded on the initial load . i 'm guessing that these files are not consider as initial chunks anymore because setting the optimization.splitchunks configuration above does not effect anymore . when changing the configuration to : it does combine everything to one big vendors chunks but now it also includes the node_modules that are used only by the lazy loaded routes and not needed for the initial load , so we ended with a much bigger vendors chunk over what we had before added the modulesfederation plugin . any suggestion for how to implement this correctly ? we want to have one vendors chunk that includes only node_modules that are needed for the initial load . thanks ! < code > cachegroups : { vendors : { test : / [ \/ ] node_modules [ \/ ] / , name : 'vendors ' , chunks : 'initial } } cachegroups : { vendors : { test : / [ \/ ] node_modules [ \/ ] / , name : 'vendors ' , chunks : 'all } }
the main entry index.js import module a and b under the `` components '' directory , and module a import module c , index.js and c are not related directly . i want to split the imported modules under `` components '' , bundle them with the modules they depend on . below is the webpack config . you can reproduce it in < url > as shown in the analysis , module c is splitted into the main bundle . i expect the custom group have higher priority to inculde depend on modules , how to achieve it ? thanks for help ❤️ < code > const path = require ( `` path '' ) ; const bundleanalyzerplugin = require ( `` webpack-bundle-analyzer '' ) .bundleanalyzerplugin ; module.exports = { mode : `` production '' , entry : `` ./src/index.js '' , output : { path : path.resolve ( __dirname , `` dist '' ) } , optimization : { runtimechunk : `` single '' , splitchunks : { cachegroups : { vendor : { test : / [ \/ ] components [ \/ ] / , name : `` vendors '' , chunks : `` all '' , priority : 10 , enforce : true , reuseexistingchunk : true } } } } , plugins : [ new bundleanalyzerplugin ( { openanalyzer : false } ) ] } ;
👋 hi , all this idea comes from the napi and node-addon-api implementations in the plugins i 've written , i 've often written them in the following way or implement a dynamically increasing entry like nextjs having a stable api library would reduce the cost for plugin developers and make it easy for them to write plugins that are compatible with all versions . what about this 💡 idea ? 🤔 if feasible , i hope to join this interesting project ... < code > // webpack 4 const dep = multientryplugin.createdependency ( entry , name ) compilation.addentry ( context , dep , name , err = > { if ( err ) return reject ( err ) resolve ( ) } ) if ( `` hooks '' in compiler ) { // webpack 4 eventname = traincasetocamelcase ( eventname ) ; if ( compiler.hooks eventname ] ) { compiler.hooks [ eventname ] [ isasync ? `` tapasync '' : `` tap '' phofhyperlink ; } } else { // webpack 2/3 compiler.plugin ( eventname , func ) ; } // webpack 5 const entryoptionplugin = require ( 'webpack/lib/entryoptionplugin ' ) entryoptionplugin.entrydescriptiontooptions ( compiler , name , { import : entry } )
sorry , it 's probably a noob question but here is what i 'm trying to build : webpack.config.js : tsconfig.json : it outputs an empy main.js file and i do n't understand why . is this expected ? < code > const path = require ( `` path '' ) ; module.exports = { mode : `` production '' , entry : `` ./src/index.ts '' , output : { path : path.resolve ( __dirname , `` dist '' ) , filename : `` main.js '' , } , resolve : { extensions : [ `` .ts '' , `` .js '' ] , } , module : { rules : [ { test : /\.tsx ? / , use : `` ts-loader '' , exclude : /node_modules/ , } , ] , } , } ; { `` compileroptions '' : { `` module '' : `` es2015 '' , `` target '' : `` es6 '' , `` moduleresolution '' : `` node '' , `` strict '' : true } , `` include '' : [ `` src/ * * / * .ts '' , `` tests/ * * / * .ts '' ] } import { initcontainer } from `` ./embedtypes/container '' ; import { initpopup } from `` ./embedtypes/popup '' ; import { initbubble } from `` ./embedtypes/chat '' ; export default { initcontainer , initpopup , initbubble , } ;
when i set config.output.librarytarget = 'system ' and some chunk of a webpack dynamic import is created , it does n't contain systemjs . that would be an awesome microfrontend feature . < code >
bug report what is the current behavior ? when the same library from the same location is imported via commonjs require and es6 import results in two different instances for classes and duplicate code in the bundle . if the current behavior is a bug , please provide the steps to reproduce . if an app imports a class directly and then uses a commonjs-based 3rd party library that uses the same library it results having duplicate code in the bundle and instancesof does not work properly . the real issue happens with superstruct package , however , see the demo below with boiled down-version . visualization : repro : < url > what is the expected behavior ? webpack should be able to de-duplicate commonjs and es6 imports of the same library . the bundle should contain only one implementation of the library and instances should be able to be checked via instanceof . other relevant information : webpack version : ^5.46.0 node.js version : v15.1.0 operating system : mac os 10.15.7 additional tools : n/a < code > git clone < url > cd webpack-issue-commonjs-es6-deduplication/ cd app yarn yarn webpack yarn node dist/main.js output : localerror.source ( ) === index.es.js thirdpartyerror.source ( ) === index.cjs localerror instanceof customerror === true thirdpartyerror instanceof customerror === false [ `` app '' - es6 / 'import ' ] - > [ library ] - > index.es.js - > class customerror { } | [ 3rd party module - commonjs / 'require ' ] - > [ library ] - > index.cjs - > class customerror { }
hello ! we currently have a build system that is using webpack 4. due to business requirements , we are unable to upgrade to webpack 5 at the moment ( this is a side issue ) . we are looking for advice on the best way to handle i18n support in our build system , with the future in mind as well . we 've seen that the i18n-loader has been deprecated . the best option we have found in our research seems to be i18n-webpack-plugin . in the webpack documentation ( both for webpack 4 and 5 ) , there are brief references to moment.js , but no real detail on how to set up moment.js to help with locales either . ( and it seems that moment is no longer being actively maintained too ) . does anyone here have recommendations on other solutions , or can you confirm that i18n-webpack-plugin is our best available option ? thanks ! -chris < code >
i recently upgraded my angular application to webpack 5. i previously patched the webpack config to polyfill node packages with node : { crypto : true , stream : true , fs : 'empty ' } . for the migration to webpack 5 i changed it to additionally , i suddenly had to manually create a polyfill for buffer since i applied these changes , the pouchdb i am using became incredibly slow . especially the creation of indices and the querying of these indices takes really really long . do you have any ideas where this problem is coming from or how it can be fixed ? < code > import * as buffer from `` buffer '' ; ( window as any ) .buffer = buffer.buffer ; promise.fallback = { crypto : require.resolve ( 'crypto-browserify ' ) , stream : require.resolve ( 'stream-browserify ' ) , path : require.resolve ( 'path-browserify ' ) , }
i did n't want to log this as an issue in case i 'm doing something wrong . but i 'm trying to mimic devtool : 'source-map ' behavior using sourcemapdevtoolplugin . i read somewhere that devtool : 'source-map ' is the same as when i run devtool : 'source-map ' i get an actual source map for every file . when i use the other method i get less than half of the source maps with no obvious ( to me ) pattern . the reason i 'm trying to do this is that source map generation for 1000+ files takes forever and i want to use include/exclude to only generate maps for files that i 'll likely be interested in debugging in production . thanks in advance . < code > devtool : false , plugins : [ new webpack.sourcemapdevtoolplugin ( { filename : ' [ file ] .map ' , } ) , ] ,
bug report what is the current behavior ? i got a breaking change notice after upgrading from v4 . it was related to polyfills . i resolved it by adding the target : `` web '' attribute to my config . everything built and ran fine . then , i got to the part of my upgrade where i have to support ie11 and realized there was a note about using [ `` web '' , `` es5 '' ] or setting target to browserslist . i found that doing either of those started throwing the polyfills breaking change error again . i then returned to just `` web '' , however , i set it as an array instead of string , so target : [ `` web '' ] . this still caused the polyfills breaking change notice . once i returned to target : `` web '' everything worked again . if the current behavior is a bug , please provide the steps to reproduce . see above what is the expected behavior ? i would expect that target : `` web '' and target : [ `` web '' ] would work the exact same . i would also expect target : [ `` web '' , `` es5 '' ] or target : `` browserslist '' to compile without complaining about polyfills that nodejs needs . other relevant information : webpack version : 5.43.0 node.js version : 16.4.2 operating system : windows 10 additional tools : aurelia-based application . < code >
feature request what is the expected behavior ? i 'm trying to use dynamic module loading like this : currently the module is perfectly resolved and split when no query parameters used . once i add query param , the build fails with : protected\:5 uncaught error : can not find module './protected ? token=xxxxxxx ' what is motivation or use case for adding/changing the behavior ? in my case it 's some authentication for the part of the app code . how should this be implemented in your opinion ? ? and the rest could be just stripped on the module resolution and added back once the final url is formed . are you willing to work on this yourself ? yes , with some hints < code > const app = lazy ( ( ) = > import ( './protected ? token= ' + token ) ) ; return < suspense fallback= { < div > loading ... < /div > } > { token & & < app/ > || < login/ > } < /suspense > ;
context : we have a central js-based library that uses workers . we are trying to bundle the library with webpack and use it among differents environments ( nodejs , electron and also will be used to develop a plugin for vs code ) . problem : the bundle is working in nodejs so far so good . but when we try to import it into an electron application ( electron-react-boilerplate ) , we have some problems with the worker path and the import module system . steps to reproduce the scenario . download and build the library : < url > ( our library uses workers ) yarn install yarn build integrate manually the bundles files into electron-react-boilerplate project . to do that : copy the bundles files in to the folder electron-react-boilerplate/src/main and try to import the bundled library from the code . questions : is there a way to bundle a generic library that uses workers and works on all platforms ( nodejs and electron ) ? is the webpack.config.js in our repo correct ? other relevant information : webpack version : webpack version : 5.44.0 node.js version : v14.17.0 operating system : ubuntu lts 20.04 additional tools : yarn < code > a javascript error occurred in the main process uncaught exception : /home/ubuntu/projects/scanoss/scanoss-dt/src/main/scannerlib/electron-scanoss.js:670 a.exports = ( 0 , _module.createrequire ) ( import.meta.url ) ( `` fs '' ) ; ^^^^ syntaxerror : can not use 'import.meta ' outside a module at wrapsafe ( internal/modules/cjs/loader.js:1060:16 )
hello all 👋 i 'm working on a react app and i 'm trying to make optimizations to my frontend build with webpack @ 5. the goal is to split heavy node_modules dependencies and only load them when needed using dynamic import ( ) and react.lazy . ideally i 'd like to have : 1 main.bundle.js which will contains the app code without the heavy parts 1 vendors.bundle.js which will contains common node_modules deps without the heavy ones n dynamically imported bundles which contains heavy node_modules deps here is my splitchunks configuration : it kind of work but it 's pretty unpredictable , in some cases heavy deps that i expect to have lazy-loaded are still included in my vendors.bundle.js . for example , i have a component `` chat '' which is using the dependency `` stream-chat-react '' . i lazy-loaded this component , a chunk was created but without including the dependency `` stream-chat-react '' which is stuck in my vendors.bundle.js : stream-chat-react is only used in my component chat and its sub-components , so i have no idea why it 's not bundled with it . if you have any idea , i 'll be very grateful . 👍 < code > splitchunks : { chunks : `` all '' , cachegroups : { vendors : false , default : false , vendor : { chunks : `` initial '' , test : / [ \/ ] node_modules [ \/ ] / , name : `` vendors '' , reuseexistingchunk : true , } , } , } ,
i 'm using webpack 5.40.0 i 'm trying to use subpath patterns to sanitize my imports `` # config/ * '' : `` ./src/config/ * . { js , json } '' , i want to do something like this . i ca n't get it to work . is there a way to do this ? for now i am just allowing all filetypes . thanks < code >
i am very new to webpack . i have to migrate an application which written in laravel , docker and below versions . i read complete documents and tried with stackoverflow as well . | previous version | node v9.11.2 npm v5.0.3 babel-loader : v^6.2.4 gulp v3.9.1 webpack v^3.8.1 precommand = > ./node_modules/.bin/webpack -- progress -- colors | new version | node v14.17.1 npm v6.14.13 babel-loader : v^7.1.4 gulp v4.0.2 webpack v^5.40.0 newcommand = > ./node_modules/.bin/webpack -- progress -- colors bug report what is the current behavior ? resolve 'common/network/network ' in '/web/client/common/redux ' parsed request is a module using description file : /web/client/package.json ( relative path : ./common/redux ) aliased with mapping 'common ' : './common ' to './common/network/network ' using description file : /web/client/package.json ( relative path : ./common/redux ) field 'browser ' does n't contain a valid alias configuration using description file : /web/client/package.json ( relative path : ./common/redux/common/network/network ) no extension field 'browser ' does n't contain a valid alias configuration /web/client/common/redux/common/network/network does n't exist .js field 'browser ' does n't contain a valid alias configuration /web/client/common/redux/common/network/network.js does n't exist .jsx field 'browser ' does n't contain a valid alias configuration /web/client/common/redux/common/network/network.jsx does n't exist .less field 'browser ' does n't contain a valid alias configuration /web/client/common/redux/common/network/network.less does n't exist .json field 'browser ' does n't contain a valid alias configuration /web/client/common/redux/common/network/network.json does n't exist as directory /web/client/common/redux/common/network/network does n't exist if the current behavior is a bug , please provide the steps to reproduce . what is the expected behavior ? other relevant information : webpack version : node.js version : operating system : additional tools : < code >
was there ever a webpack version where importing exports that did n't exist resulted in an error ? right now they show up as warnings . is there a way of promoting them to errors ? < code >
hi , i recently created this ticket which was closed and i 'm trying to understand what is going on . i hope somebody can share his opinion : - ) in a project i 'm using a dependency to nestjs-cli v7.6.0 . this version has a dependency to webpack v5.28.0 ( < url > ) . then webpack v5.28.0 has a dependency to browserslist `` ^4.14.5 '' ( < url > ) . if i 'm not mistaking and according to semver , it should install browserslist v4.16.6 but it end up installing browserlist v4.16.3 which is spotted as a medium vulnerability by whitesource scan ( < url > ) . does somebody know why ? thanks < code >
bug report what is the current behavior ? i have a simple webpack react app that has a dependency of a large-ish component library . webpack ( running with serve in development mode ) notices when i re-build the library but sometimes the app will break and i have to save a file for webpack to start the re-build again and then it might work . sometimes the re-build process starts multiple times . is there anything i could do to make webpack 's re-build process more stable when the library is updated ( = multiple files get 's recreated in a short timeframe ) ? if the current behavior is a bug , please provide the steps to reproduce . use a dependecy of a large library with many files that get 's re-created . what is the expected behavior ? re-builds are fast and the app works everytime . other relevant information : webpack version : 5.40.0 node.js version : 16.4.0 operating system : macos v11.4 < code >
good morning . first thanks for the help . i want to use ts only as a form for type-check , so i use babel-loader and add only typescript-preset as shown below . it is not applied when writing the .babelrc file , but it is applied only if you give the option inside the babel-loader inside the webpack.config.js file like this . when i read the official documentation , i understood that babel-loader automatically recognizes and applies the .babelrc file . am i wrong ? myrepo .babelrc < code > { `` env '' : { `` development '' : { `` presets '' : [ `` @ babel/preset-env '' ] , `` plugins '' : [ ] } , `` production '' : { `` presets '' : [ [ `` @ babel/preset-env '' , { `` targets '' : { `` ie '' : 11 } } ] , `` @ babel/preset-typescript '' ] , `` plugins '' : [ [ `` @ babel/plugin-transform-runtime '' , { `` corejs '' : 3 } ] ] } } }
i 'm using a 3rd party library bundled using webpack . i would now need to use one of dependencies used by the library and would like to reuse the already loaded one instead of loading a new one . is there a way to use one of the ( not exported ) local dependencies in a library bundled using webpack ? < code >
i have asset modules setup . my configuration is and the publicpath is < url > . the generated code has asset path < url > assets/ [ name ] . [ ext ] . is this the expected behaviour and mandatory to include trailing slash at the end of the url 's ? or a bug ? . the same public path seems to be working fine with other assets like javascript without trailing slash . < code > { test : /\.svg < cur > /i , type : 'asset/resource ' , issuer : { and : [ /\.jsx < cur > / ] } , generator : { filename : 'assets/ [ name ] . [ ext ] ' , } }
hi -- from what i can tell , watchoptions.ignored still causes watchpack to watch all files and directories ( including node_modules etc ) , only to potentially have the ignoringwatchfilesystem ignore the results of the change . meanwhile , using watchoptions.ignored will simply ignore the file from watching altogether , which seems like a `` lower level '' way to accomplish the same thing . in our project , using webpackignoreplugin causes watchpack 's filewatchers map to have 200k entries , while using watchoptions.ignored with the same regex 's ( or glob equivalents ) drops that to 30k - we have a lot of node_modules ! from what i can tell , there may be a difference due to the the watchpack only watching directories and/or merging watchers , which may cause change events emitting from files that intuitively seem `` ignored '' . the difference between these two settings feels fairly nuanced , but i havent been able to find much about what the specific differences there are . can they be merged ? if not , does it make sense to pass the same list of ignores to both ? on that same note , can we allow regex 's in watchoptions.ignored ? webpack/watchpack # 197 < code >
hi guys i stuck into a problem that might look trivial but after digging a bit i feel like i am going to spend many days on it unless i get a bit of direction from you . the goal is to have a plugin that saves a key-value list of { assets ' old file names : assets ' new file names } . i found out that modules are where i look for original file names and assets are the final list of filenames . any ideas on how would i link assets back to modules or another way around ? < code >
bug report what is the current behavior ? a container library generated using the containerplugin with library : { type : `` systemjs '' } and served on any url different from the host application 's root ca n't have its exposed module loaded . if the current behavior is a bug , please provide the steps to reproduce . a host app served on < url > loads the ' < url > file using systemjs : when trying to call container.get ( './somemodule ' ) , the corresponding request is sent to < url > instead of < url > here is a repository to reproduce the problem : < url > see readme.md for instructions on how to reproduce . what is the expected behavior ? the exposed modules should be loaded from a path relative to the remoteentry.js file and on the same origin . other relevant information : webpack version : 5.38.1 node.js version : 14.17.0 operating system : debian 10 ( buster ) additional tools : < code > systemjs.import ( ' < url > ' ) .then ( container = > { [ ... ] } )
hi , when running webpack , git checkout 's / other vcs switching can be far more drastic than a normal file save : multiple changes in js code generated pre-processed files changed package.json file changes webpack config changes is file watching part of webpack itself ? or is it do with things like webpack-dev-server ? is there a hook specifically to detect vcs branch switches alongside file diffs ? if so , that 'd a time to raise a hook as a priority that can potentially interrupt other things that 'd be triggered . the reason why is for a vcs branch change , the desired effect may be a full restart - following the normal watch options makes my computer freeze how much of this is under webpack 's jurisdiction ? any conversations from this tracker ? or projects ? any best practices ? < code >
i have both webpack and webpack-cli installed , and i would like to use require.context , but intellij complains about `` context '' being unresolved . did i miss a step somewhere ? do i need to install another npm package or add something somewhere to make it work ? could someone please help me out ? thanks a lot ! < code >
@ sokra @ alexander-akait provideplugin seem not working in webpack 5 here the error < url > migration : resolve.alias and provideplugin . errors will give hints . ( refer to node-libs-browser for polyfills & mocks used in v4 ) the blog link explains the migration but it confusing for normal developers what should i have to do ? after search , i found this medium link but still no result < url > how to handle babel polyfills in webpack or how to do it actually 🤕 these codes not helping to register jquery globally < url > < code > import < cur > from 'jquery ' ; window. < cur > = window.jquery = < cur > ; resolve : { //extensions : [ '.js ' ] , alias : { process : `` process/browser '' , jquery : path.resolve ( 'node_modules ' , 'jquery/dist/jquery.js ' ) , } } , new webpack.provideplugin ( { process : 'process/browser ' , ' < cur > ' : 'jquery ' , 'jquery ' : 'jquery ' , 'window.jquery ' : 'jquery ' , } ) , node_modules\webpack\lib\dependency.js:311 throw new error ( ^ error : module property was removed from dependency ( use compilation.modulegraph.updatemodule ( dependency , module ) instead )
hi guys , i struggle to find the information i want - sorry if it 's a silly question : - ) basically , i want to be able to use yarn link with a project i have webpack setup for however i am using yarn2 , and unlike yarn 1 which was doing a symlink in the node_modules directly , this one basically just adds the following to my package.json : i can not find how to have webpack properly consider that configuration is that supported in any way ? cheers and thanks for the help 🙏 < code > `` resolutions '' : { `` @ mylinked-package '' : `` portal : /home/muryoh/ @ mylinked-package '' } ,
hi . i 'm currently looking for a way to speed up webpack and i think using the parser of swc can improve performance . does webpack provide an api to replace it ? if not , will you guys accept a pr for it ? < code >
hello , i 'm trying to load remoteentry.js once and then use it to load same or different modules in different places , but the issue that i 'm facing is that , modules get cached . so for example if i load the module second time , it has the state of first load and i ca n't avoid that . with current loadremotemodule ( ) behavior , if i load same module with different data twice on the same page , i get two remoteentry.js added to the dom , so i overloaded it and if i already have remoteentry.js present , i do not add it again . with this approach , i 'm facing that module cache problem . what i 'm trying to achieve is , that i want to load remoteentry.js once and use it to load modules in different places as many times as i want . thanks < code >
i like the concept of `` sensible defaults '' used in webpack , which helps to write less , relying on conventions . that 's why i 'm trying to make use of these webpack configuration defaults in plugins as much as possible . but right now i ca n't come up with an easy solution for getting those in the context of webpack plugin . let 's say we have a plugin that uses output.path value . what will be the simplest way of getting this value in the plugin , assuming that webpack @ 5 users can omit setting output.path value if it 's equal to path.resolve ( __dirname , 'dist ' ) ? should i also provide this convention in my plugin by hardcoding path.resolve ( __dirname , 'dist ' ) for cases when output.path is n't defined , or am i missing something ? < code >
has anyone done any sort of static analysis to detect node usage when migrating to webpack 5 ? ( for this < url > ) i 'm having trouble finding where it 's used throughout my node modules , and am worried about moving forward with the migration with so little confidence because the issues do n't pop up until runtime . if there was some sort of plugin or option for webpack 4 that could alert you to when node usages were detected , that would make the transition much easier . since webpack 4 already detects node usage when deciding whether to include the node plugin at all , it seems like it should be easy enough to hook into that . < code >
bug report what is the current behavior ? if the current behavior is a bug , please provide the steps to reproduce . a and b module build as a chunk , and splitchunks set chunk is 'all ' . but import by two entry , one is used async way , but another is used sync way . it will product one chunk with a hash , but async way has another hash without chunk . just like this : optimization : { namedmodules : true , namedchunks : true , moduleids : 'hashed ' , chunkids : 'named ' , splitchunks : { cachegroups : { 'react-data ' : { chunks : 'all ' , test : module = > { return / \/ phofhyperlink ( [ \/ ] | < cur > ) /.test ( module.context ) ; } , name : 'vendor-react-data ' , enforce : true , priority : 10 , reuseexistingchunk : true } } } } webpack version : `` webpack '' : `` 4.16.0 '' , what is the expected behavior ? i think , it should be product one chunk and hash be consistent other relevant information : webpack version : `` 4.16.0 '' node.js version : operating system : additional tools : < code >
i have two files set up similarly to this ( though this is obviously simplified ) : when i run webpack , it properly eliminates the definition of foo , but someone-elses-package still gets bundled . i can go into node_modules and manually add `` sideeffects '' : false to its package.json so that the unused package gets eliminated , but that 's not very robust way to handle things . is there some mechanism that allows me to tell webpack to treat an external module as side-effect-free without modifying the package itself ? < code > // util.ts import { somefunction } from 'someone-elses-package ' ; export function foo ( ) { return somefunction ( ) ; } export function bar ( ) { return `` bar ! `` ; } // index.ts ( entry point ) import { bar } from './util ' ; console.log ( bar ( ) ) ;
bug report what is the current behavior ? referencing a loader written in typescript works just as expected , except when the loader 's typescript file is inside node_modules . if the current behavior is a bug , please provide the steps to reproduce . write a simple loader using typescript . reference that loader from a webpack configuration file and see it working . move that loader to the node_modules directory and change the path in the webpack file to point to the new location . see it fail with syntaxerror : can not use import statement outside a module , as webpack fails to interpret the file as typescript . what is the expected behavior ? typescript webpack loaders should work even when placed in a directory named `` node_modules '' , just the same as they work from any other directory . other relevant information : webpack version : 5.35.1 / 4.6.0 ( cli ) node.js version : 14.16.0 operating system : macos additional tools : ts-loader 9.1.1 , ts-node 9.1.1 , typescript 4.2.4 < code >
hello , i 'm trying to integrate small purescript application in my angular project . problem is that , whenever i load remoteentry and get a module with loadremotemodule ( ) , i 'm only getting module.main ( ) method and not module.default ( ) , which i get from svelte or angular builds . problem is that with using main ( ) , it does n't check for target parameter and loads the micro frontend module directly into the body . when i use module.default ( ) , for example with svelte micro frontend app and pass object with target option , which contains element reference , that small application gets rendered in the target element , using main , it does n't work like that . why does my purescript remoteentry.js does n't export that `` default '' method and if it should not be exporting it , how can i load that module.main ( ) into the element reference which i will provide ? thanks < code >
i am looking to run a webpage from the file-system using webview2 . webpack exports the relative pathing as /css/file.css , however since i am serving from a folder , i need to export it as ./css/file.css . is there a setting that would let me do this ? < code >
hi , `` imports '' field in package.json not works for me . my package.json : when i am trying to build project with the webpack i get this error : webpack version : 5.36.0 my question : is this feature currently supported ? do i need to perform some additional setup to make it work ? thank you . < code > error : ca n't resolve ' # index ' ... `` imports '' : { `` # index '' : { `` browser '' : `` ./lib/index/browser.mjs '' , `` node '' : `` ./lib/index.js '' } , `` # lib/ * '' : `` ./lib/ * .js '' , `` # resources/ * '' : `` ./resources/ * '' } , ...
hi . i catch error about loading chunks in my app uncaught syntaxerror : unexpected token ' < ' chunkloaderror : loading chunk 5549 failed . webpack 5.32 < code >
could somebody help me re-write this simple plugin into webpack 5 ? i have n't been able to make it work . webpack 4 this is what i 've built so far : webpack 5 although not sure how to re-implement the chunk part . < code > function ignoreassetswebpackplugin ( options ) { ignoreregex = options.ignore ; } ignoreassetswebpackplugin.prototype.apply = ( compiler ) = > { compiler.plugin ( 'emit ' , ( compilation , callback ) = > { // eslint-disable-next-line array-callback-return object.keys ( compilation.assets ) .map ( ( filename ) = > { if ( ignoreregex.test ( filename ) ) { delete compilation.assets [ filename ] ; } } ) ; // eslint-disable-next-line array-callback-return compilation.chunks = compilation.chunks.filter ( ( chunk ) = > { return ! /scripts\/ . * \.min\.js/.test ( chunk.files [ 0 ] ) ; } ) ; callback ( ) ; } ) ; } ; webpackconfig.plugins.unshift ( new ignoreassetswebpackplugin ( { ignore : /scripts\/ . * \.min\.js/ } ) ) ; class ignoreassetswebpackplugin { constructor ( name , regex ) { this.regex = regex ; this.name = name ; } apply ( compiler ) { compiler.hooks.emit.tapasync ( 'ignoreassetswebpackplugin ' , ( compilation , callback ) = > { compilation.hooks.processassets.tap ( { name : 'ignoreassetswebpackplugin ' , stage : compilation.process_assets_stage_additional , additionalassets : true } , ( assets ) = > { const match = new regexp ( this.regex ) ; object.entries ( assets ) .foreach ( asset = > { if ( match.test ( asset ) ) { compilation.deleteasset ( asset ) ; } } ) } ) callback ( ) ; } ) ; } }
asking here as the extract-text-webpack-plugin repo is archived . we used extract-text-webpack-plugin to bundle our * .properties i18n files into one file that allowed our clients to see all the translation strings in our apps in one file , we 'd process/parse the files with our own loader so the files could be handled in a js engine . i 'm at a loss as to what i 'm meant to use to achieve the same effect in webpack 5 ? asset modules wo n't cut it as the files need to be parsed/modified by our loader or else we 'll have js errors and we want to bundle them all into one file . this file shows how we 'd use it : < url > < code > const i18nextracttextplugin = new extracttextplugin ( { allchunks : true , filename : i18nfilename } ) ; const i18nextractingloader = i18nextracttextplugin.extract ( [ `` raw-loader '' , `` @ caplin/i18n-loader '' ] ) ; i18nmodulesrule.use = i18nextractingloader ; webpackconfig.plugins.push ( i18nextracttextplugin ) ;
hello . interested in the question of how to set up paths to shared files between projects that are in different repositories . in this case , it is generally possible to build a microfronted , or everything needs to be kept in monorepos from lerna < code >
hello . please tell me . i am trying to make sure that cra remains in the project as a development tool with an excellent dx . i added an alias for two versions of the webpack to the package but i catch an error [ webpack-cli ] typeerror : can not read property 'includes ' of undefined what can i do without create custom config and kill dx ? < code > `` webpack '' : `` 4.44.2 '' , `` webpack-5.32.0 '' : `` npm : < email > .0 '' , `` webpack-cli '' : `` 4.6.0 ''
hello , hope you are having a nice day ! it is possible to declare a @ font-face inside the source folder and this is loading a font from the public folder in webpack 5. like this : @ font-face { font-family : 'inter ' ; src : url ( './assets/fonts/inter.ttf ' ) ; } can someone explain me how ? thanks in advance . < code >
hey guys , does anyone understand how webpacks hmr works under-the-hood ( for example for react fast refresh ) ? i.e . how is it able to swap out a modified module at runtime ? precisely , after browser fetches the new changed file , how does it replace the old module , and have the new code take into effect ? < code >
in webpack4 , i want to find which modules import the img , i thought modules.reasons maybe possible in this issue , but when i writing a plugin , in normalmoduleloader hook , the img module.reasons have two modules , both are page1 module . how do i get page1 module and page2 module in normalmoduleloader hook ? and how to do this in webpack5 ? < code > // page2.js import img from './img.png ' console.log ( 'page2 : ' , img ) // page1.js import img from './img.png ' console.log ( 'page1 : ' , img )
i am experiencing a frustrating bug finding it hard to figure out the solution . i did refer to some other git discussions which have the error message as : error in conflict : multiple assets emit different content to the same filename main.map but what 's more frustrating is i ca n't find a solution for this for webpack 5. if i remove the sourcemapfilename from my webpack config it complains about missing files in the broswer when loading the page . please help ! < code >
my configuration for the chunk-maps is well-defined in the configuration as : output : { path : path.resolve ( config.build.client , '' lib '' ) , filename : `` [ name ] .js '' , chunkfilename : `` [ id ] . [ chunkhash ] .js '' , library : `` [ name ] '' } , but yet , for some reason i still receive the following error which does n't make any sense to me . error in conflict : multiple assets emit different content to the same filename client.map < code >
we have an external system where content of the html template is prefilled in production . for example if html template has % footer_macro % it is prefilled with html content which is static and can not be modified by us . to prepare template for that system we have a webpack project which emits one html file . i would like to some how define those % externally generated macros in a project , so it would generate full html page for development environment ( hot server ) , but different `` unfilled '' % macros for production in /dist folder . i.e . under npm run start : dev it would emit full html < html > < body > ... < footer > blabla < /footer > < /body > < /html > but under npm run build it would produce just < html > < body > ... % footer_macro % < /body > < /html > where would i define that % footer_macro % = < footer > blabla < /footer > ? we are using static html webpack boilerplate which uses webpack4 i believe , if that makes a difference . < code >
i receive this error when i am using commonschunkplugin in the plugins array . i was assuming this to be not part of plugins in webpack 5 but the documentation says otherwise . what is the new way of conveying about chunks to webpack in v5 ? < code >
here i use the webpack.progressplugin ( { handler ( percentage , message , ... args ) { } } ) to show the progress of the webpack build . but when i output the percentage and message , i find there is much times in percentage 1 in build like this and then i use the server here is more output like this build [ =================== ] 99 % cache begin idle build [ =================== ] 99 % cache begin idle build [ ==================== ] 100 % build [ =================== ] 99 % cache shutdown build [ =================== ] 99 % cache shutdown build [ ==================== ] 100 % build [ =================== ] 99 % end closing watch compilation build [ =================== ] 99 % end closing watch compilation this may cause confusion . is it reasonable ? < code > build [ =================== ] 99 % cache begin idle build [ =================== ] 99 % cache begin idle build [ ==================== ] 100 % build [ =================== ] 99 % cache shutdown build [ =================== ] 99 % cache shutdown build [ ==================== ] 100 %
i have a fairly complex webpack configuration for a big project . is it possible to create some sort of unit tests for my webpack build process ? something that tests all possible scenarios of different types of files that get thrown at webpack and ensure that the proper files get built ? when i try to search for examples of how to do something like this i only find examples of people using webpack to run unit tests for their projects . < code >
i am trying to glob import all my scss files in the project to the main file named main.scss . in webpack-3 things worked just fine as i was using the loader import-glob and my sass-loader is given the paths to load the scss files from . but unfortunately the same setup never works for webpack 5. my scss files complain about missing scss functions . < code >
would the import-glob plugin still work with webpackv5 ? i receive the file-references errors stating the relative paths are not being able to resolve . not sure why am i receiving the errors for file references : resolve : { extensions : [ `` .js '' , `` .jsx '' , `` .json '' ] , alias : { assets : path.resolve ( __dirname , `` .. '' , `` .. '' , `` src/client/assets '' ) , config : path.resolve ( __dirname , `` .. '' ) } , modules : [ path.resolve ( __dirname , `` .. '' , `` .. '' , `` src/client/client_modules '' ) , `` node_modules '' ] , preferabsolute : false } this is my resolve key : value < code >
trying to do a really simple scss > css configuration . bare minimum configuration here . i have 2 entry files . i want 2 output files . why is this causing problems ? full repo here : < url > just run npm install and npm run webpack . < code > [ webpack-cli ] error : conflict : multiple chunks emit assets to the same filename file1.css ( chunks file1 and file1 ) 'use strict ' ; const path = require ( 'path ' ) ; const minicssextractplugin = require ( 'mini-css-extract-plugin ' ) ; module.exports = { mode : 'development ' , output : { path : path.resolve ( './dist ' ) , filename : ' [ name ] .css ' } , stats : { children : true } , name : 'scss ' , entry : { file1 : path.resolve ( './test1.scss ' ) , file2 : path.resolve ( './test2.scss ' ) } , module : { rules : [ { test : / ( . ) * \.scss < cur > / , use : [ minicssextractplugin.loader , 'css-loader ' , 'postcss-loader ' , { loader : 'sass-loader ' , options : { implementation : require ( 'node-sass ' ) , } } ] } ] } , plugins : [ new minicssextractplugin ( ) ] }
i receive this above error while importing the animate.css in my scss file . < code > module build failed ( from ./node_modules/sass-loader/dist/cjs.js ) : sasserror : the target selector was not found . use `` @ extend .animated ! optional '' to avoid this error . 10 @ extend .animated ; ^^^^^^^^^^^^^^^^^
i have a situation where i have multiple modules using the same loader . here is a really simple example : i have a kinda weird setup where i have the same entry files being processed and bundled multiple times for multiple websites depending on the resourcequery on the entry file . anyways i get this error : after a little research i found this : webpack-contrib/mini-css-extract-plugin # 126 this thread implies that you get this error because i 'm using the same loader for 2 different modules . is that right ? i also have a similar setup as above but for compiling my js and i use the same loaders for that on multiple modules in the same way and it works just fine . is there a solution for this ? is this a webpack problem or minicssextractplugin problem ? < code > ... module : { rules : [ { test : / ( . ) * \.scss < cur > / , resourcequery : 'website1 ' , user : [ ... { loader : minicssextractplugin.loader } , ... ] } , { test : / ( . ) * \.scss < cur > / , resourcequery : 'website2 ' , user : [ ... { loader : minicssextractplugin.loader } , ... ] } , ... modulebuilderror : module build failed ( from ./node_modules/mini-css-extract-plugin/dist/loader.js ) : error : did n't get a result from child compiler
hello all , i 'm using graphql-codegen in my project to generate typescript definition types from graphql operations . i first write my operation as graphql sdl in a mycomponent.graphql file , and then graphql-codegen generates a mycomponent.graphql.ts file containing the types . what i want now is to import those types without specifying the .ts extension : import { myawesometype } from `` ./mycomponent.graphql '' . the issue is that webpack is first attempting to resolve the actual .graphql file , so it tells me that i do n't have a proper loader to load this file . i 'd like webpack to totally ignore all my .graphql files and only consider the .graphql.ts files so i can import my types as specified above . it it possible ? thanks for your help ! < code >
here is an example ' < url > ' . at the main feature , hmr is work at webpack 4. but when i upgrade relative packages , such as ' hmr-webpack5 ' feature , hmr is not work . is there something i missed ? < code >
i have a unique situation where i have 2 different entry files that both use the same `` alias '' but each of those aliases need to point to different places for each entry file . in my case , it is n't an option to use 2 different alias names . the code uses a cascading/waterfall type of file resolution for the final product ..... it 's a long explanation but i just ca n't change the alias names . both entry files need to use the same alias `` name '' but each alias needs to point to different places . however from what i can tell aliases are unique per webpack configuration . is it possible to have unique aliases per entry file ? < code >
i have a directory structure kinda like this : i have 2 separate webpack configurations . one builds a bundle for `` site a '' and one builds a bundle for `` site b '' . site a files consist of a.js & shared.js . site b files consist of b.js and shared.js . i always run my webpack build using both configurations at the same time , even when watching . my problem is that when something goes wrong in the shared.js like it fails linting or whatever , i see the linting error twice in my terminal : once for site a config and once for site b config . is it possible to somehow avoid seeing the errors twice ? like somehow be able to suppress all errors ( linting errors , compiling errors , module resolution errors , etc ) until after both configurations are done and then display them in a way that does n't show duplicates ? like maybe save the errors to an object using the referenced file path as the object keys so that it does n't create duplicates and then show all errors at the end when webpack is done . any sort of ideas in this area ? < code > . js/ shared.js a.js b.js output/ sitea/ siteb/
hi ! i tried to create an example application using module federation . i used the example from advanced-api/dynamic-remotes as a basis for my implementation . everything worked fine until i added the shared configuration . ( when i remove that part from the webpack configuration the application works like expected . with the shared configuration it fails to load the remote modules with the following error : my shared configuration looks like the following : i uploaded my current minimal application to github . maybe someone can help me spot the issue ? i 'm somewhat lost . < url > steps to reproduce the problem : open < url > in a browser and click on `` load product details '' . console will show the error . i can see from the network tab that my application only loads micro-frontend.nocache.js ( custom naming for remoteentry.js ) . the example will follow with requests for the react-dependency and the to be imported module itself . this will not happen for my application at it already fails within code inside the micro-frontend.nocache.js . thank you for any tips and help ! jakob < code > # start root frontend cd frontends/root & & npm install & & npm start # start product frontend ( another console ) cd frontends/product & & npm install & & npm start uncaught typeerror : can not read property 'react ' of undefined at register ( micro-frontend.nocache.js : formatted:404 ) at function.__webpack_require__.i ( micro-frontend.nocache.js : formatted:452 ) at object.init ( container_entry:24 ) at remotecomponent.tsx:15 shared : { react : { requiredversion : appdependencies.react , import : `` react '' , sharekey : `` react '' , sharescope : `` default '' , singleton : true , } , } ,
i have a probably simple question but i can not figure out the problem . i moved from webpack 4 to webpack 5 in a rails application , and now , when i load the javascript module from the html page , the code is no longer executed . the webpack configuration contains : when i inspect and debug the generated /packs/js/application-5fb7bb797c21e44c763b.js file , i see that my application code ( the main code in app/webpack/packs/application.js ) is inside but wrapped as it is waiting to be loaded as a module , and it is never called . why is webpack not executing the main module ? i suspect that has to be with chunking the code in multiple files , and the generated files should only declare the modules and not execute them , but here it is my main module and i need to execute it . thank you < code > { `` output '' : { `` filename '' : `` js/ [ name ] - [ contenthash ] .js '' , `` chunkfilename '' : `` js/ [ name ] - [ contenthash ] .chunk.js '' , `` hotupdatechunkfilename '' : `` js/ [ id ] - [ hash ] .hot-update.js '' , `` path '' : `` /absolute/path/to/public/packs '' , `` publicpath '' : `` /packs/ '' } , `` entry '' : { `` application '' : [ `` /absolute/path/to/app/webpack/packs/application.js '' , `` /absolute/path/to/app/webpack/packs/application.scss '' ] } , ... }
hi there . i was trying to debug an issue that stemmed from file-loader responding to .mjs files . i tried to debug this by setting stats : `` verbose '' in devserver and core webpack config along with other similar settings . i did get a detailed log but i could n't find a line there that told me that file-loader touched this particular file , if that makes sense . i can see lines about css-loader and such but none about file-loader . is this because it intentionally does n't have debug logging or am i missing something ? would appreciate in general , if there 's any source about debugging webpack configs/loaders/plugins . < code >
i 'm trying to import @ google/model-viewer a cdn dependency which requires the following sintax : is there a way to set this type ? my current configuration throws the following error : uncaught syntaxerror : export declarations may only appear at top level of a module - > uncaught ( in promise ) scriptexternalloaderror : loading script failed . looking at the code here i think it 's not an option ... < code > < script type= '' module '' src= '' < url > / > // webpack.config.js module.exports = { ... externalstype : 'script ' , externals : { ' @ google/model-viewer ' : 'global @ < url > } }
the repo represents simple case - a react app and a library exporting react component . the app and library are built separately - the intention is that when the lib changes , the app does not need to be rebuilt . the library is resolved in runtime - not in compile time . i 'm using system.js import maps , the lib is externalized in app 's webpack config . this works correctly - the lib code is fetched in runtime , react component can be imported from lib . the problem is that react library gets duplicated . i followed the example from webpack docs . as you can see , in the 'dist ' folder , separate chunk for react is created ( when compiling app ) . this chunk is jsonp webpack chunk . how to reuse such chunk from the library ( separate webpack build ) ? is it possible to configure the format in which the chunks will be emitted ? < code >
hi , i have a question about : i want to get the cache file when start filesystem . i try to use the hook about `` done '' like this compiler.hooks.done.tap ( `` , ( ) = > { // get the cache filesystem to do something } ) but i field . which hook in compiler or compiler.cache can i use to get the filesystem cache ? < code >
i 'm developing simple proof of concept using webpack bundling code to system.js modules . repo what i 'm achieving here : i have 'app ' importing a function from 'lib ' . this is done in runtime using system.js import map . both entries are transpiled by single webpack config - librarytarget set as 'system ' . i 'm trying to understand the output generated by webpack ( v.4 ) - it is much more complicated than examples in system.js specs . looking at the bundle for the 'app ' - i do n't see it using system.import when importing code from 'lib ' . the example works fine , but i 'm having some problems to import 'plain ' systemjs modules generated outside webpack . what format is the bundle generated by webpack ? < code >
hello , i have an issue when using dynamic imports , my chunks are loaded with a low priority in the browser , how can i change that ? for now i 'm adding a script tag in the head to force the chunk to be loaded with high priority but it 's not very practical . i 'm using vue and loading my components like so : also i 'm using laravel-mix , not webpack directly , not sure if i ask that in the correct repo . thanks . < code > vue.component ( 'login ' , ( ) = > import ( / * webpackchunkname : 'login ' * / ' @ /components/auth/login ' ) ) ;
i am developing the project by nextjs ssr mode . i got the problem so the svg content is changed in the static directory like the following . how can i fix this issue ? regards < code >
hi , is it possible to import the remoteentry.js file using yarn workspace concept i made a sample at < url > by converting it from < url > the project contains two app , dog-detail home ( the host ) i made some changes to import the remote file using yarn workspace at < url > here is a simple explanation on what i did : build the dog-detail app to create remoteentry.js at dist folder import a carousel component from remoteentry.js at home app by import { carousel } from 'dog-detail/dist/remoteentry ; at home app 's app.vue the yarn workspace packages folder : packages dog-detail home dog-detail 's webpack.config.js : home app 's app.vue : however , i 'm facing runtime error of uncaught ( in promise ) referenceerror : webpack_require is not defined < code > < template > < div class= '' container '' > < carousel / > < /div > < /template > < script > import header from './header.vue ' ; import { carousel } from 'dog-detail/dist/remoteentry ' ; export default { components : { header , carousel , } } < /script > module.exports = { plugins : [ new modulefederationplugin ( { name : 'dogdetail ' , filename : 'remoteentry.js ' , exposes : { './carousel ' : './src/carousel.vue ' , } } ) , ] , }
it seems that cachegroups.issuer has been deprecated in favor of the module graph , but i ca n't seem to figure out how to use it . if i have : i get a prompt to use the modulegraph api , but i have no idea how i would find the issuer of this particular module with this api . is there some easy way to do this ? thanks in advanced < code > optimizations : { splitchunks : { cachegroups : { mygroup : { name ( module , chunks ) { module.issuer } } } } }
is there a plugin or configuration that allows for automatic chunk naming when dynamically importing , so that i do n't have to pepper the code with webpackchunkname everywhere ? < code > const somecomponent = react.lazy ( async ( ) = > ( { default : ( await import ( / * webpackchunkname : `` somecomponent '' * / `` ./somecomponent '' ) ) .somecomponent , } ) ) ;
my main compilation targeted to browser . but i would like to have plugin that compiles and executes js in node ( actually i am trying to fix htmlwebpackplugin ) . so i need to configure child compilation to be targeted to node . how i can do that ? i found nodetargetplugin but it do only half of configuration - it switches target , but it do nothing with resolve configuration . what i mean by `` do nothing with resolve configuration '' ... let me provide expmple : i am trying to import styled-components in file which i am compiling by child compiler with applied nodetargetplugin . and when i do this , webpack uses styled-components.browser.esm.js ( this file declared in package.json in `` browser '' field ) . but in my expectations webpack should pick styled-components.esm.js ( not .brower.esm.js ) because i use nodetargetplugin . what should i do to force child compilation to use styled-components.esm.js instead of styled-components.browser.esm.js ? < code >
hello , i followed some examples from : < url > and came across this server.base.js ( link to exact exampel ) webpack config . so i wonder if remotepath for the server side can also be a real remote address ( eg : remote1 : ' < url > ) like in the clients config . i tried but ca n't get it woking . if not what would be the recommended way if website1 and website2 are deployed to different servers/pods ? cheers , tim < code > const remotepath = path.resolve ( __dirname , `` .. / .. / .. /website2/buildserver/container.js '' ) ... new modulefederationplugin ( { name : `` website1 '' , library : { type : `` commonjs2 '' } , filename : `` container.js '' , remotes : { website2 : remotepath ...
this is a pretty special question i have which stackoverflow is not able to answer . what i need to know is what parts of webpack and which 3rd party code it relies on are actually shipped in generated code . for legal approval i need to list all 3rd/4th party libraries that are shipped to customers . i looked at the package.json file of the project , but to me it looks as if that contains many build/dev dependencies . i installed < email > .2 explicitly ( this is the version used by current react-scripts ) which leaves me with a 600 lines long dependency tree . this can not all be runtime dependencies . much of that is certainly for build/dev time only , right ? so , how can i tell which dep is shipped ? < code >
the docs say when the exports field is specified , only these module requests are available . any other requests will lead to a modulenotfound error . which seems to suggest that the `` browser '' field would be ignored if `` exports '' is present , but it seems like webpack 5 with default config is still resolving with the `` browser '' field in some experimentation i did on the yaml package . if this is unintended behavior i could try to fully verify this and create an issue . it would be good to explicitly document whether `` exports '' or `` browser '' in the docs for both fields . it 's starting to get really complicated to guess the resolution behavior . < code >
i 'm trying to run webpack from a command line app , a wrapper around webpack using the node api , and i 'm having trouble with loader resolution when the app is installed globally . when developing locally , i can build a path like : resolveloader : { modules : [ path.resolve ( __dirname , ' .. /node_modules ) ] } and everything 's fine , since all of my required loaders are direct project dependencies . when installing my app globally , yarn will install some of the dependencies to ~/.config/yarn/global/node_modules/my-app/node_modules as expected , but most others to ~/.config/yarn/global/node_modules instead , and these will be unresolvable with the above config . my understanding of the modules : [ `` node_modules ] string value is that it will resolve to parent directories when the required package ca n't be found , but that providing an absolute ( or relative ) path instead will not resolve in the same way . ( per # 6505 ( comment ) ) what should the value be for resolveloader.modules so that both my-app/node_modules as well as my-app/ .. /node_modules ( and so on ) will be considered , when working outside of the project directory ? < code >
i set up the svgr loader for all svg files , and it works fine in combination with file-loader , as the docs said . < url > however , since it will create a wrapper module for every svg file , it does n't work together with new url ( ... ) . i hope there will be a new property to detect the import type of that file . ( e.g . issuertype : `` url '' ) < code >
webpack/lib/optionsapply.js line 9 in a62ddbd process ( options , compiler ) { } there is an empty method name process in optionapply class which is extended in webpackoptionapply.js ( only ) and it is overrided . webpack/lib/webpackoptionsapply.js line 58 in a62ddbd class webpackoptionsapply extends optionsapply { why should we have that ? < code >
i want to add a banner to my project , and i add this snippet to my webpack.config.js it looks like it works but the result is a pecis.min.js.license.txt is appended to my directory , the content is but when i remove terserplugin , is works as excepted . how do i config to makes it add banner directly ? excepted output : < code > / * ! pecis | pecis.js.org * / // code / * ! for license please see pecis.min.js.license.txt * / plugins : [ new webpack.bannerplugin ( 'pecis | pecis.js.org ' ) ] / * ! pecis | pecis.js.org * /
hey community ! if i start webpack -- watch locally , it takes a long time for the initial build ( the rebuild is very fast 😊 ) . is it somehow possible , to use the persistent disk cache for the initial build , and the memory for the rebuilds ? regards matthew < code >
hi ! 😄 i made some badges that all kinds of open source projects can use to describe their project type , based off of the classifications from working in public by nadia eghbal . i 'd love it if different open source projects such as this one would actually consider adding the badges to their readmes . you can find descriptions of the badges here , and can get a tl ; dr explanation of how the use the badges here . here are the different badges : < code >
hi , i would like to create an angular micro apps , which required to share the assets between with angular8 version . is there any limitation for this ? it can be used ? any suggestion about it ? < code >
hey , a great feature addition would be to let users define a maximum seeding ratio . after which user could select an option to automatically remove inactive torrents after x minutes . a . < code >
i went through the docs and everything but i have no idea how to use it with a react application . can anyone please help me regarding this ? i want to use it in my little project . < code >
hello , is it possible to add a new todo at the top instead of at the bottom when i add it to a checklist ? adding at the bottom does not work so well when the list is getting longer . thanks < code >
hi , i saw many open tools using the `` open collective '' for helping with patreons . wekan is a great tool and perhaps with more financial resourses could be developed faster and become number one . with so many people that folows the updates and uses wekan i believe that we can help more . < code >
i took a guess that it would resemble the call to edit checklist items ( < url > ) but that does n't seem to be so . does such a thing exist ? thank you ! < code >
bluf : suggest/request and logic for filtering on multiple [ labels ] what is the syntax for advanced filter ( non-custom fields ) . needs a wiki page i wanted to filter for cards that have certain labels , for example cards that have all the labels : team1 , high , execution but filter currently works as or logic , so it shows any card that has any of those labels , not all . i tried to use advanced filter as a workaround , and manually search for label == team1 & & label == high , etc . but is `` label '' the correct name ? i 've searched everywhere on your github , isuses , wiki , and there is no syntax explanation for advanced filter . what are the [ variable names ] for non-custom fields ? can i use advanced filter to search labels , titles , description ? @ feuerball11 i saw that you created the advanced filter ? do you know the syntax ? thanks < code >
i noticed the dates in v. 5.84 have week numbers . i would like to disable the week numbers , but ca n't figure out how . anyone figure out how to do this ? thanks < code >
greetings , i will be brief , it is the typical case where an admin manages the individual projects of several clients , but wants to limit the access of normal users to create boards , thus maintaining order and preventing them from playing on the platform . as an administrator i can give them the permissions within each board , that 's nice . i 'll try to do it by modifying the file ( have n't tried it yet ) ... * * * /wekan/client/components/boards/boardslist.jade with if currentuser.isadmin before `` add new board '' if this feature could be added for the next version ... ( but as a conditional option in the admin menu ) that would be great , thanks wekan team . < code >
hi , backup docs mentions docker cp wekan-db : /data/dump . as target for the db dump during the backup process . however , docker-compose.yml mentions wekan-db-dump : /dump as the dump directory . should n't they match each other ? or is there a different intent for wekan-db-dump : /dump ? cheers jochen < code >
hi i am wondering why this returns `` error response from daemon : manifest for quay.io/wekan/wekan : v6.12 not found : '' v6.11 seems to be there . < code >
hello , relating to my question from yesterday re to the `` shared template '' , we got the idea to try a workaround as long as this functionality is not fully implemented . so we set up a board called `` template '' which contains the relevant template cards and got the idea to add new cards in the operational board by using the `` search '' -function along with creating new cards to use an exiting card as template , i.e . to have a copy of them . doing so , we got an unexpectated behaviour : in the operational board , we see the cards from the template board but adding a new card in the operational board by selecting the template card , it seems to make a link to template card so any changes on this new card changes the template card too so , we are not sure if we have a basic misunderstanding what this functions is really about and we have a wrong expectation about . thank you < code >
hello , we are going to use wekan as project board to set up task ( cards ) for our team . for this , we created by one of our admin some templates which we would like to use by different users to set up tasks ( cards in several boards ) . these users are linked to the template area as members . doing so , we got an issue : for the admin user who created the templates , it is possible to set up task by using the templates for the other users which are member in the template area , it is not possible to do so , i.e . the templates are not shown so , we are not sure , is it a bug and maybe fixed ( we are still on v5.0.3 ) or is there a general issue in our setup/handling what be great to get some hints from the team or other users . many thanks < code >
is there any plan to include scrum burndown and velocity charts into wean ? i just overviewed source and it should be as simple as fullcalendar is integrated ... liked google charts ... for its simplicity ... so question is there is any product plan for it ? ? thx as . < code >
when i use only parameter status : archieved in the global search : is this the correct behavior that i get result cards listed which are from boards i am not a member of ? i mean , yes i can add @ username to exclude all those entries , but would n't it be better that boards you are not allowed to look at are excluded in the result list in general ? < code >
when i start wekan , and i 'm not logged in . i still get read only access to our wekan board . i 'm using a link on the chrome start page that links directly to a board . is it possible to redirect not logged in users to the login page instead ? self hosted wekan®️ version : 5.90.0 meteor version : 2.2 node version : 12.22.8 mongodb version : 3.2.22 < code >
i wish i could create a card and enter details like due date and description in one step . now you have to enter a card title , hit the enter key or click the add button , then go back and click the card title to enter details . almost always , i want to add a description and due date or received date while i create the card . it would be nice if an alternate key stroke sequence , like ctrl-enter for example , would create the card and open the details ui in the same step . < code >
hello , i am new to wekan and trying to replace trello for our team . i am using the rest api to create cards and for some reason i am getting 401 , could someone please help me . code : note : i am using rest as i am only testing this in python i plan on transforming it to another language later < code > from requests_toolbelt.multipart.encoder import multipartencoder mp_encoder = multipartencoder ( fields= { `` authorid '' : `` gsjhyk4qdnkprvzv8 '' , `` title '' : `` test:1 '' , `` description '' : `` this is a test '' , `` swimlaneid '' : `` eje4jju8ezlqfgqpp '' , } ) print ( mp_encoder ) headers = { `` content-type '' : mp_encoder.content_type , `` accept '' : `` application/json '' , `` authorization '' : `` bearer workingtokenherethatihavetested '' , } r = requests.post ( `` < url > headers=headers , data=mp_encoder , )
hi , by looking at these instructions , it is not clear : is it possible to install wekan to a windows 7 32 bit version too ? if yes , still only node.js 12.x is the recommended version ? ( there is already v16.x lts available for a `` long '' time . ) thanks : - ) < code >
does wekan support showing multiple projects in a single board ? i tried the demo and searched the documentation but i could not find if this is possible . the closest thing i could find is to create a single board with all the tasks of all the projects and then use categories labels and swimlanes to order them but somehow this does n't seem right . is there a better way to manage tasks from different projects ? thanks . < code >
hi , i can `` hide system messages '' when i logged in . how can i hide `` hide system messages '' as default in a public board ? ( for all not logged in users ) < code >
now , we found that even we closed the browsers , and click the url for wekan again , it can login and access to the system directly successfully . so it will be unsaft when there is public network for user . and i ca n't found any information/configuration for it . or it 's set into web server , for example caddy or apache ? thanks . < code >
when i want to upgrade version manually with command '' snap refresh '' , there have error message in below . why ? and i confirmed that the server can telnet api.snacraft.io 443. error : can not refresh : can not refresh snap-declaration for `` wekan '' : get `` < url > x509 : certificate is not valid for any names , but wanted to match api.snapcraft.io < code >
today , we found that we can open with a url and show other team 's borad , and can check their all task into borad without login ( because there have a login notice button ) , i think it shoule be a security issue for user . how can we fix it ? by upgrade version ? or it 's the wrong steps for our operation ? please help . < code >
want to know if there is function that can sync one card task to 2 borad . this practical scenario is i can create a board and is related to another borade under someone/manager , then when i changed the information under my borad/tasks , it will to sync to another board ( same card , same task , same info , same updates ) . then i just need to change my board and task then someone else can see the same info . thanks . of course , if it can , how about the access right of this function , someone just can see or can modify it under their board , it depends on what the access right was assigned to it . < code >
hello , below , i explain my concern : sometimes when adding a user to the members of a table , there is a corresponding entry in the database table `` activities '' but without the id of the user who performed the action . this is a concern because the invitation email sent says that `` undefined '' performed the operation . this was noted on an earlier version of wekan ( 5.29 ) and now i can not reproduce the bug on the last version , did not find the corresponding issue , i wonder if there is not someone who noticed this problem or who can tell me if this point has already been taken into account in the last version ? < code >
i was reading the documentation , and it seems like this feature may be implemented , but not exposed ? i 'm currently running wekan in an ubuntu proxmox container , i used the npm install instructions . what can i do to force the card description editor to use markdown ? is there a config setting somewhere ? i 'm not interested in any wysiwyg tools , i 'm proficient in markdown and that is all i need . < code >
we are using wekan on large touch-enabled samsung screens . this worked great about a year ago , but now the built in browser is choking on the newer wekan versions so we are driving the screens with win10 laptops and using the touch screens as touch devices connected to the laptops . this works great for everyting including opening cards , scrolling etc except drag-and-drop . we can not get drag-and-drop of cards to work , with or without drag handles . works fine with a mouse though . are we missing something ? any advice on what we could try ? < code >
( the lighter red ) ( darker red then above ) maybe it is better to set the subtext color similar to the header color ( in this case white ) . the grey is n't good to read , not even enough contrast . i suggest : color of subtext = color of the cardheader color < code >
hey guys , how can i get my cert file for https into the docker version of wekan ? root-path in config file is already set and the website is reachable from the server ip . i 'm new to docker , so i 'm grateful for any help : ) < code >
@ xet7 @ mfilser @ jrsupplee @ claudiak21 hi ! what do you think about change ( or add a new ) the results visualization ? i think that a table would be a good option . the table would has : card | list | board | labels | members | due date something like the image below : < code >
hi , these discussions are only for discussing something . for features and fixes that would need to be done , please check is there open issue or add new issue to < url > , because only open issues are looked at when checking what feature or fix needs to be implemented . closed issues are already implemented and solved . these discussions are not monitored about are there some feature or fix that needs to be done . for each new comment in discussion , and for each new issue or comment , maintainer of wekan gets email notifications , and could reply at discussions , but does not automatically check is there issue about it yet , is it about just discussing something , or does new issue need to be added . in these discussions , if some question is answered , please mark it as answered , if possible . thanks ! br , xet7 maintainer of wekan since 2016-12 ceo of wekan team < code >
i was looking at this : < url > it looks great . cards are pretty compact and readable . my cards instead are huge , with a lot of space taken by all the card fields ( you can see here < url > ) . is a theme used in the first screenshot ? is something wrong with my configuration ? < code >
hi , i 'm new to wekan , may i know if it is possible to back up the mongodb without downtime ? i have read the wiki and documentation , yet it tells i need to turn off the wekan containers first , before starting a backup ... -- ivan < code >
we are desperate , always when re-changing the right landing list for the board subtasks , when re-open this option board settings subtasks setting the `` landing list for subtasks '' is not showing the set one , instead always the first entry in the list . even the set one works , i tested it , but it is completely irritating that the set one is not marked at all . < code >
hi , i 've turned off that users can register to wekan on their own . instead i invite them by mail . unfortunately i found no setting to declare how many days they have to do the registration afterwards . how long is the default setting ? and is it possible to adjust the number of days until the invitation gets invalid ? andreas < code >
hi , after setting up google authentication as described here : < url > i have found an issue . normally , i have the disable self-registration turned on so that people do n't just access the page and start using my wekan deployment . when adding the google login option , there is the `` sign in with oidc '' button that redirects to google authentication . the only problem i see is that that opens wekan up for self registration with any gmail account , not just the corporate google workplace account . it would be normal that only accounts that have been invited to boards to be allowed to sign-in , right ? after all , that 's why there is a disable self-registration option . let me know what 's your opinion on this and if a feature request should be opened for this . kind regards , silviu < code >
i 've upgraded mongodb from version 4.2 to 4.4 yesterday . then i tried to restart wekan and it wo n't start . it hanged on the start-up and not responding . i 've checked the log and it only shows : seems wekan is stuck on querying something on mongodb and does n't respond . do you know where is the debug log to check that wekan is doing what ? < code > presence started serverid=japejn8rxmg23qyhx { `` line '' : '' 87 '' , '' file '' : '' percolate_synced-cron.js '' , '' message '' : '' syncedcron : scheduled `` notification_cleanup '' next run @ wed may 05 2021 12:04:42 gmt+0800 ( china standard time ) '' , '' time '' : { `` < cur > date '' :1620187482473 } , '' level '' : '' info '' }
i personally like the global search very much and can handle it , also with saving bookmarks , but i know that other users have problems to use it efficiently , therefor i have some ideas to make it more generally userfriendly : a formular for choosing the search parameters , instead of looking into the text description listing ( a lot can not be copied , must be typed in manually ) , means more than one formular option for combinations like member , label , status , has etc . the description down about each should stay so everyone understands the purpose . the saving as bookmark may instead be saved internally into wekan as xxx ? unfortunately when opening a saved search bookmark sometimes the search does not work - you often need to refresh the page first or the name of the bookmark is by default only the domain , so you have to manually edit the name of the bookmark , it would be nice if the search parameters are automatically added to the domain , to know what search it is a default card sorting always by due date , so you do not need to enter the extra parameter sorting ; due feel free adding some more ideas ; - ) < code >
it seems that since a previous update the result list of my cards is broken ? a lot of cards are listed from other members where i was not added in any way and only one board is listed under option `` by boards '' > no results from other boards the same with profile / `` due cards '' and here a lot of cards are listed from other members where i was not added in any way the result dates are sorted descending instead of ascending , so the card due in 2022 is at the top , which is not helpful < code >
hi there , we are testing rocket.chat-server and outgoing webhooks from wekan to rocketchat . works fine , but it 's anoying .... wekan pushes all notifications from a board to rocket.chat . is there a possibility to configure which notifications wekan sends as webhook ? minimal requirements like : is there a possibility that wekan sends a notification via outging webhook when the `` due at '' is reached ? < code >
hello everyone , my colleague archived a card and suddenly a lot more cards were being archived magically . we have found out now that the first card has a lot subtasks which have been archived too . is it somehow possible to convert the subtasks into standard tasks , so that the main task can be archived ? < code >
hi everyone , i am trying to access on admin panel after changing the admin attribute `` isadmin '' : false to true on my user . but that does n't seem to have any effect . are there other actions to take ? can you help me please ? i am in the latest version of wekan . best regard < code >
edit and changed it , mixed assignee underline red with creator one : since the last update in all boards the `` creator '' of a card is displayed - underline green this you can unset under board card settings ( we now unset it manually in our 10 boards ) . but for the global search there is no option to unset/deactivate this - or i can not find it ? < code >
hi there , i 'm new to wekan since a few days and my team and me love it ! when i add a attachment to a card which is a image wekan show 's a thumbnail of this image in the board view . i have n't found a option to disable the thumbnail . as the thumbnails in the board view costs a lot of space i would like to disable them . any idea ? < code >
i wonder if it is possible to use operators to exclude something like the `` minus '' - when using the has : field f.i . show cards where i am member but not where xxx is member too also when using same parameters it is searched by or how can i also search for and like cards where i am member and another member too ? i also mean other parameters like label etc . < code >
hello . i 'm maintaining a wekan instance for some organization . the instance is giving some problems , and , before trying to solve them , i 'd like to know if people have actually started using it ( if not , i could simply delete the instance and install it again ) . but i ca n't see any way of listing all the projects in the instance , including private ones . in the admin panel i can see all the users , but i do n't see if they have created any project . is there any way to get this listing ? thanks < code >
i have set up wekan under docker . the test mail works as do invitation mails . these contain the local ip , though : dear , has invited you to participate in a kanban board . please click on the following link : < url > your invitation code is . thank you . this will not work for people outside . ho do i set up wekan so that it uses the dynamic address i use ? is there an environment variable to be set for this ? < code >
since the last update , when using `` copy link to clipboard '' there is no domain included anymore , so the link to the card does not work . < code >
trello allows a user to attache a url to a card . when importing to wekan , the html pointed at by this link is loaded into the database as an attached document . it ends up looking very bad when displayed . it would be better to just store the link like it is in trello . is there a problem with this solution ? < code >
i wonder how long does it take until the label name list under global board search is updating ? at the moment it does not update correctly . instead the previous label names , which have been changed , are still listed even they do n't exist anymore . example : if i change the name of an existing label , the previous label name is still displayed under global board search . only if i delete the label it is immediately deleted from the global board search under label names . how can this be speeded up ? < code >
good day everyone . i 'm currently testing all features of the new global search and found that all result listed cards are mixed up concerning the due date . i have not yet understand what sorting it is exactly , board , swimlane .. ? when i search for due:10 the cards are not sorted chronologically for the dates , this would be very helpful. . is there a way to do that or can it be implemented ? < code >
good day everyone . i wonder if it might be possible to exclude all public boards from the global search page by f.i . a global setting where the user can exclude to display public boards information from the global search page completely or a setting option to only display board page search information from boards the user is member . now the global board page is displaying really a lot information listed , including public boards . ( like all board names , list names and label names etc . ) i mean the the global search page itself not the search results . thanks in advance ; - ) < code >
hello all , i would like to setup wekan as a todo list for various departments . users should be able to create cards ( ie : incidents ) on a public board that represents teh todos for a certain department of my company . e.g . an it issue on my board : ) . no-one but the board owner and the creator of the card should be able to delete or move it . is such a configuration possible ? up to now i can do everything i want except prevent cards from being `` archived '' by other users with access to the board . thanks in advance , wd < code >
i 'd like to receive an email when a card is due . we use wekan v4.87 in a docker container , which gets amongst others the following two environment variables : email notifications work in principle , but i still do not get due notifications at 6am local time ( or any other time ) when a card becomes due . i would have expected to get two mails per card : one on the day the card has its deadline , and one the day before . do i need to set anything else in order to receive those notifications ? < code > notify_due_days_before_and_after=1,0 notify_due_at_hour_of_day=6
every card has a url that links to it . however , if i use that link in another card , it opens a new tab instead of just switching to the other card in the same tab . is there a possibility , e.g . a special link syntax , that makes smooth switching between cards possible ? < code >
hello , as i see the custom fields are not shown at linked cards . i have already added some code to handle linked cards , but then i saw that the custom fields are missing in minimongo at line : wekan/models/cards.js line 695 in c52d17b const definitions = customfields.find ( { i am not familiar with meteor and publications . where do i have to add the code to get custom fields definitions of linked cards into minimongo ? thank you a lot in advance < code >
my wekan users desire to assign a user to linked card independently from original card . so i 'm trying to implement it to my branch . i found click event , 'click .js-select-assignee ' , at < url > it is called when an assignee is clicked on popup in case of a linked card also . that event calls assignassignee ( wekan/models/cards.js line 1591 in 4fc2d7b assignassignee ( assigneeid ) { ) of cards.mutations in card.js . in my thought mutations package were imported to centralize the mutation operations by 45b662a . so i thought i just modify the assignassignee in case of a linked card for my propose as my 1st step . however current assignassignee function would just update the assignee to clicked assignee . i could n't understand why this code prevent to update a card in case of linked card . where is code to handle the linked card ? < code >
how are cards ordered in the board 's archive ? there seems to be an ordering by date entering the archive but this is n't quite right . possibly the creation date of the card ? < code >
i think that the number of list cards if a wip limit is active should only be marked red if the limit is exceeded . otherwise , if you take care of filling your lists as it should be in the kanban method , you perpetually have red numbers on top of them , although everything is okay . i have the ( very simple ) patch for that active in our own wekan instance . if you also think that this is a good idea , i prepare ( my first ) pr . < code >
i see thumbnails in the card details for attachments that are images ( png , jpeg ) . however , there are no thumbnails generated for pdfs and docx files : if i click on the attachments , i see symbol indicating that i should wait but nothing happens : i use a custom container image derived from the wekanteam/wekan image from docker hub . my question is : is it possible to get the thumbnails and/or full-screen previews for pdfs and other formats working by any means ? possibly by installing further dependencies ? fwiw , simply adding libreoffice to the image did not allow wekan to open docx . < code >
i 'm new to x64dbg . did n't even know about it . so i wanted to check if it works with mingw-w64 compiled executable . it works , but does n't show the source . i 'm using the basic hello world c program and compiling it with the mingw-w64 gcc program with -g flag . i also checked with the mingw-w64 gdb and it shows the source , so the -g flag must have worked . and i checked the manual provided in the release package . the chm file . it does n't say anything about code sources . < code > e : \projects\hello > c : \msys64\mingw64in\gcc.exe -g .\main.c -o prog.exe
i 'm confused by the new study and practice plan format . the recommended questions from weeks 1-4 are also found in the later weeks . so should we not solve those recommended problems in those initial 4 weeks , and just read through the concepts ? < code >
hello , guys ! i 've started using yew and noticed that the link component from yew router , currently , does n't take the aria-label attribute . i believe it 'll be a nice addition for describing anchor tags that take non descriptive text or icons as children , as per the accessibility recommendations . taken from w3 : the aria-label attribute provides a way to place a descriptive text label on an object , such as a link , when there are no elements visible on the page that describe the object . in some situations , designers may choose to lessen the visual appearance of links on a page by using shorter , repeated link text such as `` read more '' . these situations provide a good use case for aria-label in that the simpler , non-descriptive `` read more '' text on the page can be replaced with a more descriptive label of the link . i 'm using svg inside the anchor tags and the browser warns me about it not having descriptive text right now , one way to circumvent that is to place an aria label in the svg instead congrats for the awesome project ! < code >
the green theme color used for links in the official website of yew fails the color contrast test . this puts strain on the eyes , especially for users with weak vision . please update to colors that pass the test . screenshots suggested colors : for links on white background : for links on grey background : < code >
idea i think it could be quite useful to have a prop struct for standard html element , it would make it easier to make components reusable . example i have a pixelcanvas that is a wrapper around a canvas with added logic . i 'd like to be easily pass canvas attributes easily through my components , so i can use it with different even and style it independently . having a struct that contain the html element 's attributes would transform into < code > fn view ( & self , ctx : & context < self > ) - > html { let ( width , height ) = self.dims ; let canvasprops { class , id , onclick , onhover , .. } = ctx.props ( ) .underlying_canvas_props ; html ! { < canvas { width } { height } { class } { id } { onclick } { onhover } ... / > } } fn view ( & self , ctx : & context < self > ) - > html { let ( width , height ) = self.dims ; let props = ctx.props ( ) .underlying_canvas_props ; html ! { < canvas { width } { height } .. props/ > } }
i 'm planning to add a yew suspense support to reqwasm : hamza1311/reqwasm # 33 . what should the exposed api look like ? is there any other libraries ( from other ecosystems ) to use as inspiration ? < code >
how can i check the response to redirect or re-render the form ? < code > let onclick = { let cloned_state = state.clone ( ) ; callback : :from ( move |e : mouseevent| { e.prevent_default ( ) ; // log : :info ! ( `` { : ? } '' , cloned_state ) ; let data : data = cloned_state.deref ( ) .clone ( ) ; spawn_local ( async move { let resp = request : :post ( `` /api/user '' ) .body ( serde_json : :to_string ( & data ) .unwrap ( ) ) .header ( `` content-type '' , `` application/json '' ) .send ( ) .await .unwrap ( ) ; } ) } ) } ;
i 'm considering how much of a hard break from an existing vue application a move to yew would be . we use several javascript clients that do n't have comps in rust yet . ultimately , we might be moving away from these clients as part of a larger reorg , but it would obviously be optimal to not have to roll our own in the meantime . i 'm aware of two ways to interoperate : creating externs manually . using the js ! macro from stdweb . would there be any other way to do this that is better for yew ? i saw this on crates . is it recommended ? non-yew question : if there is n't a better way to work with yew , i 'm leaning towards stdweb . as far as developer experience is concerned , is there a way to make the rust linter treat those js ! macros with eslint ? < code >
react ) ) // item // children rust is it possible ? < code > return ( < li > { children ( p1 , p2 ) } < /li > ) { ( |click : bool , open : bool| { html ! { } } ) } { ( p1 , p2 ) = > { return ( < react.fragment > ... < /react.fragment > } }
hello ! i 'm new to front-end development , so this might be an obvious question - but i ca n't seem to wrap my head around how i would dynamically add a child component to a parent . it was n't clear to me in the docs on how to do this - or if i even should . can i use a button click in the parent to send a message , then use the update function to create and then add a child component ? if anyone could point me in the right direction it would be much appreciated ! < code >
i 'd like to create a mousemove event on document and update a component whenever this event gets triggered . is this possible and if so how would i go about doing this ? < code >
correct me if i am wrong : this is the minimum code to achieve a toggling state : a use_toggle ( ) would be nice < code > # [ derive ( partialeq ) ] enum state { show , hide , } impl default for state { fn default ( ) - > self { self : :show } } struct toggle ; impl reducible for state { type action = toggle ; fn reduce ( self : rc < self > , _action : self : :action ) - > rc < self > { match & * self { state : :show = > rc : :new ( self : :hide ) , state : :hide = > rc : :new ( self : :show ) , } } } let on_or_off = use_reducer ( state : :default ) ;
i want to use keyboard click event like this : is it possible to implement this directly in yew ? < code > document.body.onkeydown = function ( event ) { switch ( event.keycode ) { case 37 : keypress ( 'left ' ) ; break ; case 39 : keypress ( 'right ' ) ; break ; case 40 : keypress ( 'down ' ) ; break ; case 32 : keypress ( 'rotate ' ) ; break ; } } ;
i try to use background loop like setinterval and clearinterval . but i could n't find anything about this in the documentation . please advise and help . < code >
please note that some of the wording might be a bit misleading . i apologise for that . i am trying to have a component , sort of like a container panel , that will allow the user to dynamically add < input type= '' text '' > components . the idea is that at some point , the user will be able to click a button in this container 's parent , and something will be done with the contents of all these text inputs my textinput component , right now , is a bit of a beefed-up version of the textinput component in the password_strength example . instead of a function_component , it 's a `` proper '' component . i am having a lot of issues so far , so i think it 's faster to ask : has anyone here tried to tackle a similar problem ? < code > home // user can trigger other actions that require all the text from the vec < textinput > s | -- > container // user can add to the vec < textinput > through a button in this component | -- > vec < textinput > // merely holding text
following the instruction of mathjax or katex some mathematical content to be rendered . the script is added to the index.html on the root directory . // index.html the compiled index.html in the dist folder is like : // dist/index.html when i inspect the elements of the html in the browser , the mathjax.js file is loaded and some < style class= '' text/css '' > ... < /style > tag are created , but it does not render the mathematical content at all . even though i upgrade the browser and use different browsers ( firefox and chrome ) , it just does not render . the weird thing happens that copying all the html tree , saving as html file and reopening it in the browser , it renders . could somebody got a clue what it is going on ? < code > < html > < head > ... < script type= '' text/javascript '' src= '' < url > < /head > < body > < /body > < /html > < html > < head > ... < script type= '' text/javascript '' src= '' < url > < link rel= '' preload '' href= '' /index-72ea0884a4ef18d2_bg.wasm '' as= '' fetch '' type= '' application/wasm '' crossorigin= '' '' > < link rel= '' modulepreload '' href= '' /index-72ea0884a4ef18d2.js '' > < /head > < /head > < body > < script type= '' module '' > import init from ... < /script > < /body > < /html >
sorry , i could not think of a better short title . i am trying to make a list widget kind of thing , which accepts a few components from caller . since component requires two associate types , so i made the list state as contents : vec < vnode > , instead of contents : vec < box < dyn components < something i can not fill > > > . but i got problem at view . what is the way to do this ? < code > html ! { < div > { self.contents.iter ( ) .map ( |content| { html ! { < div > { content } < /div > } // error here as vnode does not implement display } ) .collect ( ) } < /div > }
yew_router : :components : :redirect could have a replace : bool property . if that is set to true instead of history : :push it should use history : :replace . this is usefull if you want to do unconditional redirects on some pages and you want the back button to work properly . if history : :push is used the browser back button will send you back to the unconditional redirect page and you will get immediately redirected to the same page you started from . alternatively instead of a replace property an alternative component like moved could also work . like this : < code > /// props for [ 'moved ' ] # [ derive ( properties , clone , partialeq ) ] pub struct movedprops < r : yew_router : :routable > { /// route that will be replaced with the current history entry when the component is rendered . pub to : r , } # [ function_component ( moved ) ] pub fn moved < r > ( props : & movedprops < r > ) - > html where r : yew_router : :routable + 'static , { use wasm_bindgen : :unwrapthrowext ; use yew_router : :history : :anyhistory ; let history = yew_router : :hooks : :use_history ( ) .expect_throw ( `` failed to read history . `` ) ; let target_route = props.to.clone ( ) ; use_effect ( move || { use yew_router : :history : :history ; history.replace ( target_route.clone ( ) ) ; || { } } ) ; html : :default ( ) }
test result : ok. 0 passed ; 0 failed ; 0 ignored ; 0 measured ; 0 filtered out ; finished in 0.00s running tests/use_state.rs ( /home/chunbinli/code/rust/yew/target/debug/deps/use_state-13ecbb454612f04c ) running 0 tests test result : ok. 0 passed ; 0 failed ; 0 ignored ; 0 measured ; 0 filtered out ; finished in 0.00s [ cargo-make ] [ 2 ] info - execute command : `` wasm-pack '' `` test '' `` -- headless '' `` -- firefox '' `` -- '' `` -- features '' `` wasm_test '' [ cargo-make ] [ 2 ] error - error while executing command , error : os { code : 2 , kind : notfound , message : `` no such file or directory '' , } [ cargo-make ] [ 2 ] warn - build failed . [ cargo-make ] [ 1 ] error - error while running duckscript : source : unknown line : 4 - error while executing command , exit code : 1 [ cargo-make ] [ 1 ] warn - build failed . [ cargo-make ] error - error while executing command , exit code : 1 [ cargo-make ] warn - build failed . < code >
for example , i have so now i have the active_page , but matching it manually ( with string manipulation ) with route seems weird . is there any better way to know the current link so i can give it an `` active '' class ? < code > # [ derive ( routable , partialeq , clone ) ] enum route { # [ at ( `` /tagging '' ) ] tagging , # [ at ( `` /new_tag '' ) ] newtag , } // somewhere else < link < route > classes= { classes ! ( `` nav-link '' ) } to= { route : :tagging } > { `` tagging '' } < /link < route > > // and let yew_router : :history : :anylocation : :browser ( active_page ) = ctx.link ( ) .location ( ) .unwrap ( ) ;
i 'm new to yew so forgive me if this is a stupid question but how do you add elements to the dom at runtime ? all of the examples and docs i have read all seem to not create or destroy any elements . say for example i wanted to fill a table based off an array of serialized components . since the number of rows is unknown , elements would have to be inserted and removed from the dom to accommodate the number of rows . how would i go about adding the de-serialized components to the dom ? < code >
problem when a form is submitted that triggers a yew router push_history event , and subsequent form that is rendered by yew is unable to be submitted . steps to reproduce steps to reproduce the behavior : to reproduce this , i have provided a minimised example in the following repository : < url > expected behavior pushing a route to the history to change pages with yew_router should not break form submissions . screenshots environment : yew-router = `` 0.16.0 '' yew = `` 0.19 '' browser = edge 96.0.1054.62 ( official build ) ( x86_64 ) built with wasm-pack , see repo . questionnaire i 'm interested in fixing this myself but do n't know where to start i would like to fix and i have a solution i do n't have time to fix this right now , but maybe later < code >
hi , how to display in log or in the web page the content of an uploaded textfile in functional comp style ? i 'm able to get the file as a web_sys : :file but struggling to deal with the actual content . thanks < code >
this discussion proposes to deprecate context and job agents . the current state of these two agent kinds are kind of `` awkward '' as now we have < contextprovider / > & use_reducer api available . contexts and hooks are easier to understand , better documented , and can achieve the same goal as these agents . in addition , agents do not have a good way to access contexts provided by < contextprovider / > as they do not have a place in the vdom . job agent job agents can be replaced by an internal state machine mechanism ( implemented with message ) inside struct components or hooks api inside function components . context agent context agents can be replaced with hooks / state machine of a parent component + < contextprovider / > . < code >
i 'd like to create a mousemove event on document and update a component whenever this event gets triggered . is this possible and if so how would i go about doing this ? < code >
i failed to find a guide to creating & inserting a canvas . after reading the official book , i guessed and tested out that the inserting pattern might be somehow like however , where to call its creating function ( say fn create_my_canvas ) puzzles me much . i found only one related example mount_point , but this example is far different from and inconsistent with the patterns shown in official book . besides , this example compiled with errors saying that the crate yew has no function start_app_in_element . above all , my question would be threefold : what 's the pattern to insert a canvas with a default context . what 's the pattern to insert a canvas with an external input ( i mean something like plotters ) where can i learn all the inserting patterns for all supported html tags . thanks for giving any guidelines . < code > fn create_my_canvas ( ) - > htmlcanvaselement { ................................ canvas } html ! { < canvas id = `` my_canvas '' > { `` some text '' } < /canvas > }
in my code i am getting a response from fetchservice ( inside the 'update ' method ) . depending on that i need to dynamically change the route . i was thinking to send a message with a new route ... but how i can create a route from `` /new-route '' string ? is that the right approach ? what is correct approach to change routes from 'update ' ? < code >
i 'm using trunk - in order to allow for absolute-project-root-path imports in my scss files i need to pass some additional config to the sass compiler . examples are shown here < url > can i do that with trunk somehow ? < code >
any thoughts on some form of auto-labeling or auto-assigning of reviewers for newly opened prs ? i 'm not sure what the best approach would be , but given that contributors are unable to apply labels or request reviews on githhub , it might be helpful ( and reassure impatient folks like me ) to have an automation to label prs that have had no review yet so that they are visible ? i 'm down to implement such a solution , but wanted to reach out for ideas and feedback before spending any time on it < code >
i 'd like to propose that we ( re- ) introduce a new type to describe references to components and agents . presently , these are named `` links '' . links are references to scopes in the case of components . my position is that reference should be an opaque type entirely for the purposes of addressing a component or agent . as it stands , we are leaking the notion of `` scope '' to the caller when we are strictly conveying an address of a component . i see that components v2 removed componentlink but i can not find any rationale as to why . there was some questioning on the context 's link method returning a scope , but that is the only commentary i have found to-date . in addition , the agentlink has been retained , which now feels inconsistent in that there is no longer an equivalent for components . in actor libraries such as akka , these references are known as actorrefs . the suggestion i have is to provide a type named , componentref for components and agentref for agents . as these types reference different types of things , i would think it is reasonable to have two types of addressing mechanisms ( as we do/did ) . over time , these types might also contain different internal representations to be able to address components and agents . edit : i removed a proposed solution of `` self '' and `` ref '' naming as its more important to focus in on the goal , which is to have a separate type to address components , and make that consistent with addressing agents . < code >
i 'd like to propose that we rename the scope 's send_future method to spawn_send_message , as this may more accurately describe what it is doing and could provide a higher degree of assurance . when looking at the example of using fetch with async/await , it was n't clear to me that a spawn was taking place . i feel that it is important to understand that the spawn is occurring so we also understand that our component does n't become unresponsive to other messages and events . as send_future is a spawned flavour of send_message , spawn_send_message may therefore lead to a better understanding of what is happening . similarly : send_future_batch could become spawn_send_message_batch callback_future could become spawn_callback callback_future_once could become spawn_callback_once preliminary discussions : < url > < code >
i 've been working on a library , yew-dsl ( better name desired , suggestions are welcome ) that enables the user to construct and use yew 's virtual dom using rust functions , instead of a macro like html ! . see # 1168 to learn about how this approach is better than using macros . malvolio by @ teymour-aldridge is an alternative to this . malvolio 's primary focus seems to be raw-html generation while also providing support for yew whereas yew-dsl is only for yew 's vdom construction . yew-dsl is not yet published on crates.io , so please see the doc comments in lib.rs for api documentation . i 'd love to hear feedback/opinions about this . future plans add builder for props ( originally suggested in # 1832 ) < code >
hi , i would like to use the image crate to load or manipulate images from memory . is there a way to use image : :dynamicimage within the html ! macro ? i received the error below about the intopropvalue trait not being implemented for dynamicimage . is there an idiomatic way to code this or some way to derive the trait ? thanks . error : error [ e0277 ] : the trait bound dynamicimage : intopropvalue < option < cow < 'static , str > > > is not satisfied ^^^^^ the trait 'intopropvalue > > ' is not implemented for 'dynamicimage ' < code > //load and image let graph = image : :open ( `` graph.png '' ) .unwrap ( ) ; .... html ! { < img id = `` graph '' src=graph alt= '' graph '' / > } ....
hi there - i 'm upgrading my codebase from 0.17.4 to 0.18.0 and discovered errors per the following : this occurs given html ! expressions where i 'm passing values into the attributes . here 's an example using svg 's line element : is it that i must use an explicit .to_string ( ) for each attribute ? can you please confirm on how i migrate this change ? thanks . < code > < line x1= { left_margin_x } y1= { top_margin_y } x2= { left_margin_x } y2= { bottom_margin_y } class= '' axis-y-line '' / > the trait 'intopropvalue > > ' is not implemented for 'u32 '
moving this question discussion from the discord to here per @ mc1098 's suggestion . what 's the best way for for a mouse callback to get dimensions of the parent element the mouse is in ? for example , i need to calculate where the mouse is hovering horizontally proportional to the width of the component in a component to pass some values to an api . the values i get from offset_x ( ) of the mouseevent are in absolute pixels . i need to get the parent element 's total width to calculate the proportion . seems related to < url > but with yew instead of jquery/js i also see < url > but that dependency might be a little bit too bleeding edge ( 1 star on the repo currently ) . also some related discussion here # 329 but this thread is 3 years old . < code >
hello everyone , i am trying to determine if i should try yew ( i am completely new to it and rust ) . given my newbness , am wondering if there exists a module/widget that takes json data and displays it in a collapsable ( and maybe even syntax-hightligted ) tree ? any pointers deeply appreciated . thanks in advance . < code >
i want to have a function like upload which is independent in impl from my components , which they can just invoke passing a reference to their own link . this is one usecase for functions external to components , i assume there may be other , i assume this could be handled with `` mega parent component that the kids call to do anything '' but this pattern is not made explicit nor endorsed by the docs . i thought this impl would work : however , this seems to fail with that error : the trait 'from < msg > ' is not implemented for ' < t as yew : :component > : :message ' ... at which point i 've got no idea what to do anymore . any help here would be appreciated : ) for now i 'm just boilperplating but as a project scales this is obvious ugly and not the way to go . < code > fn upload_fast < t : component > ( data : & mydatatype , link : & componentlink < t > ) { let s : string = fast_range.start.to_string ( ) .into ( ) ; let e : string = fast_range.end.to_string ( ) .into ( ) ; let post_request = request : :post ( `` /api/up/ '' + data.endpoint ) .header ( `` content-type '' , `` application/json '' ) .body ( json ( data.jsonify ( ) ) ) .expect ( `` could not build that request . `` ) ; link.callback ( |response : response < json < result < uploadmessage > > > | { let json ( data ) = response.into_body ( ) ; msg : :whatever } ) ; }
currently in the yew html macro , if you use onblur it correctly handles a callback , but if you use onfocusout , you get a crazy error about your callback not supporting tostring . i assume this is a default behavior for unknown / unexpected parameters ; in any case i think the onfocusout events are not supported . more generally i wonder if there is an autogen failure somewhere which is not attaching all the possible events ? < code >
problem i am not able to use keydata from yew : :html for some reason , i have used steps to reproduce steps to reproduce the behavior : write the code above in your ide run it expected behavior i was using it to be used in input element , this should have been detected to return what keys are being pressed screenshots environment : build tool , trunk os , windows < code > use yew : :html : :keydata ;
using yew in a bundler , you would have yew built with wasm-pack . the bundler has an entry point where it loads the wasm , along with injected css bundles/hot reloaders inside the header . it seems like there is no method which omits clearing the html element completely yew/packages/yew/src/app_handle.rs line 26 in 09a41d6 clear_element ( & element ) ; trying to do it manually by creating a new scope is not possible either , since scope : :new is private yew/packages/yew/src/app_handle.rs line 28 in 09a41d6 scope : scope : :new ( none ) , < code >
imagine that you are from react.js and trying to make a component with a changeable root element . this can let u passing other component as the root element like comp < comp1 > . but u can not use basic html elements like this comp < div > since div is not a component . but with a dirty fix : now u can pass it like comp < div > . that 's too dirty and there maybe better solution for this . < code > struct div ; impl component for div { ... } impl < t : component > component for comp < t > { ... fn view ( & self ) - > html { html ! { < t > { self.props.children } < t/ > } } }
i like all the improvements of 0.18.0. thanks to everyone who did that 💘 during porting my super huge rillrate project to the yew 0.18.0 i 've found that i have to split a lot of classes to separate literals , but before was possible to use multiple classes in a string like : with 0.18.0 i have to split them all or use the following workaround : i guess it 's not so effective and at least it 's not so pretty . how about to allow to parse multiple classes during compilation of to add classes : :from workaround to that ? or maybe i missed some features ? 😃 < code > html ! { < div class= ( `` many so-many bootstrap classes '' , option ) / > } html ! { < div class=classes ! ( classes : :from ( `` many so-many bootstrap classes '' ) , option ) / > }
beginners question . can one set up a main program using yew so that executing it opens a window , rather than providing a url ? is there an example of such ? < code >
i was just checking out the seed project and i discovered that they have a playground for testing out seed : < url > . it seems to be based on < url > . it would be really cool to have a yew playground similar to what seed currently has . this makes approaching yew easier for potential users as they wo n't need to install tons of dependencies and setup a build system just for a simple hello world app . gitpod might also be a good alternative . < code >
it would be great if yew had something like next.js 's hybrid approach . they use automatic static optimization . if a page has no blocking data , it 's static-generated * . a page can also use ssr or client-side like regular react . advantages of hybrid approach : performant great seo flexible ( ssg , ssr , or client-side ) use cases this would benefit : someone who just wants to make a blog using rust - > full ssg someone who wants a blog but also wants to use some external fetched data on particular pages - > mostly ssg , some ssr someone who wants a website with landing page . but also an spa after authentication . - > ssg for the public site , csr for the authenticated part ( although ssr could still be useful here ) i 'm not saying we copy everything from them . for example , the filesystem-based router can be omitted . i do think that the hybrid approach would really open doors for the ways that yew can be used . thoughts ? * # 1379 touched on ssg but i opened another issue because this discussion is broader . < code >
regarding agents is there a particular reason the handlerid id field is private ? i am trying to send messages based on the handlerids but the following seems to be impossible . < code > type input = ( endpoint , msg ) ; fn handle_input ( & mut self , msg : self : :input , _ : handlerid { match msg.0 { endpoint : :mainprocess = > { let handler_id = self.subscribers.get ( _some_handler_id_ ) .unwrap ( ) ; self.link.respond ( * handler_id , msg.1 ) ; } endpoint : :sideprocess = > { let handler_id = self.subscribers.get ( _some_handler_id_ ) .unwrap ( ) ; self.link.respond ( * handler_id , msg.1 ) ; } } }
i am working on a project that works with rather beefy data parsed from files . it 's mostly heap allocated types -- vecs and strings -- so mrc/irc is a natural fit to pass that state down into child components . avoiding unnecessary clones is fantastic , but profiling reveals a lot of time spent equality checking . the state from files is mostly immutable , changing only when a different file is loaded , so i pass around the app state that changes more often in a separate irc . the unchanging data still goes through a full equality check very frequently , though . i assumed that mrc/irc used the fact that they are pointers to optimize equality checks , using a ptr_eq to short circuit comparisons . probably , i assumed this because yew.rs encourages this pattern in optimizations . this kind of `` shallow equality '' is leveraged heavily in react and the broader js ecosystem for persistent ( ish ) structures . neither smart pointer does this , however , and irc does n't even have a ptr_eq method . i propose changing the partialeq implementation ( at least for irc , since it 's the one that is compared most frequently in component : :change ) in addition to adding a ptr_eq method . this would play most nicely with neqassign . the existing partialeq implementation is purely a function of underlying data as it is : two pointers will compare equal if their data compares equal , even if it lives at two different addresses , so this proposal should n't change the semantics of existing programs . if we agree this would be a good plan , i can draft a pull request . < code >
hi , i 'm trying to migrate a existing js app to yew , which process ( potentially ) large files with web workers on background . if i understood it correctly , i should implement an agent to do the work . in the plain-old web-worker way , i pass the file object i got from form to the web worker , then read it with filereader inside that worker . however , the file object does not implement serialize/deserialize , so i can not pass it to agent . is there a way to pass file object cross agent ? or i have to read the content of file first , then pass the content to other actor ? or , there is other way to offload cpu expensive tasks without relying on actor ? thanks . < code >
hello . basically i am trying to figure out the potential of yew to become a truly cross platform gui library . i understand that this might not be the focus currently but with enough community support and motivation it might make sense in the future . thank you . < code >
hi there , i was interested to call navigator.credentials.get/create from a yew applications . generally i think this seems like the ability for yew to call out to a javascript function or object that already exists in the context , but i 'm not 100 % clear on how to achieve this . while there are a lot of examples and docs , none of them seem to show this behaviour . even as a simple example is it possible to say ... call console.log ( ) from within yew ( without consoleservices ) for example ? how would you call something in javascript from yew ? thanks ! < code >
my use case is a kind of drag and drop api . i was thinking onmousedown attaches both an onmouseup and onmousemove event , which simply updated the x and y coordinates of an svg . i can easily achieve this using the shouldrender return type , but am i right to assume this would mean the node would be destroyed and recreated for each invocation of the events ? it would be nice if there was some way to directly mutate the dom . is this possible with yew ? i guess this goes outside the normal use case for the lifecycle hooks . could i just use raw webassembly code within the component update method ? < code >
i wanted to get the ball rolling on thoughts regarding ssg , or static site generation . i feel this will be the first step to supporting isomorphic apps , and double as a nice interface for using ssr . also , i believe isomorphism can be wholly contained within the ssg paradigm to form one consistent interface . to kick us off , i started a simple skeleton that represents how an ssg app within yew would be laid out . the notion of pages as dynamically generated is built from what gatsby learned with its node-based tree generation . in principle , any user-defined sequence of operations including plugins or other toolkits could generate these pages . will be continuing with research over the next months , but would love to hear feedback and suggestions for how this feature can work . < url > < code >
how to embed a canvas that is rendered onto using glium with webgl backend ? e.g . i want to make a 3d vr scene editor , where my gui controls need to share state with the code that renders the glium canvas ... < code >
description react native is a fantastic concept , but is seriously complicated by implementation details which are there to prevent javascript from causing a performance bottleneck . the rn team is currently working on a re-architecture ( referred to as `` fabric '' internally ) which should alleviate many of the tremendous issues with the current approach , but it is still subject to the constraints that come with composing the interface in javascript . it seems to me that a similar framework written in a lower-level language could achieve superior performance and portability with less complexity . rust is the perfect modern language for such a task , and yew has already done a tremendous job in building an ergonomic `` component centric '' ( react-like ) ui framework for web targets . i 'm curious if there 's any interest in making backends pluggable , so that yew can be used for native targets ? < code >
: clashx , , the problem arises . i installed clashx several times repeatedly and the console goes blank and does not load it works fine . < code >
what 's the difference between clashx ( compiled from source in this repository ) and clashx pro ( downloaded from appcenter ) ? i can only see the app compiled from the source have different logo at left bottom corner : is there any other difference ? i also found semporia/clashx-pro which is just a set of rules . what 's the relationship between the above repository and clashx pro downloaded from appcenter ? < code >
i just happened to find an interesting geoip repository , i 'm thinking that maybe it 's a better choice . so , it would be nice to have a way for customizing database download url . geoip < code >
👋 ! `` '' : vant vant 👋 welcome ! we 're using discussions as a place to connect with other members of our community . we hope that you : ask questions you 're wondering about . share ideas . engage with other community members . tips : bug feature , issue < code >
as of version 3. , when we hover on the component props , it shows hints in zh-cn language . how do it configure it to use en-us language ? < code >
reading i assumed the 'ext ' was a placeholder ( since , technically , there was no need to add it into quotes ) . so , i imagine my surprise when i did youtube-dl -s mp4 ... and i saw `` destination ... .webm '' . i was wondering : does yt-dlp have error checking in the -s function ? or does `` mp4 '' mean something ? < code > # download the best video with the best extension # ( for video , mp4 > webm > flv . for audio , m4a > aac > mp3 ... ) < cur > yt-dlp -s 'ext '
apologies if i am not phrasing this properly . i am running a yt-dlp script once per day with the goal of downloading all the recent videos of channels defined in a list set by -- batch-file . the problem is that some of these channels have thousands of videos . i use -- download-archive so these thousands of videos will not download but because the yt-dlp is checking each one of these videos it can take hours to run this script . i though that i could use the option -- break-on-existing so that it would download the recent videos for each channel and then break for each channel . but instead as soon as the first break is met in the -- download-archive list the entire yt-dlp download ends . what i want to know is if it is possible to use the -- break-on-existing on each channel in the -- batch-file . is this possible ? < code >
i tried to create a discord account to access the chat , but i was blocked by phone verification , i do not feel comfortable giving discord this information . matrix is an open , decentralised chat service with strong bridging capabilities , many open source projects such as jellyfin media server use it for their community chat . there are a variety of discord bridges listed here . t2bot.io is a community ran bridge service offers one of these bots for anyone to use . i would recommend creating a yt-dlp matrix space , and creating a chat for each discord channel and bridging these to each to maintain the same experience as on discord . i am happy to assist / advise on this matter . i think it would help reduce friction for those in the community . thank you . < code >
i recently started to use the twitchvod extractor regularly , and i have a few improvements in mind . i think i would be able to make the changes , but probably not too soon . is it ok if i open a new issue for every one of these at once ? or should i rather open a single issue , and make a pull request per improvement ? < code >
yt-dlp has been moved from the aur to the arch community repository , so it can be easily installed via pacman . will this be noted anywhere in the installation section of the readme ? < code >
mpr is an aur like repo for debian and ubuntu . heres the pkgbuild . heres the pkg tree structure . the pkgbuild has make specifying the build to populate the /usr directory however its neglected and /usr/local is populated instead . i dont know what might be the root cause . < code >
i currently have the following work flow setup , forgive me if this is already included : running headless on a virtualized linux machine . yt-dlp is set on a crontab to run every hour , the script looks for my config file and sets the download path and uses a batch txt file for urls . when i want to add a new channel i just edit the batch txt file from my windows machine . now what i have n't figured out or would like to see added is the ability to add custom naming script for each url in the batch file . example : url for channel a , when all videos are downloaded it names based off the uploaders name , i would like to add `` channel a '' to beginning of the name for all videos downloaded from that url , that way i can use smart collections in plex to auto add based off that text string . this will help differentiate bulk downloads from multiple channels and allow for smart collections to auto add . now i could use a work around of using multiple config files and scripts but it would remove the automation of one text file to edit and automatic downloads . last note . thanks for continuing on this project ! < code >
does it get downloaded at the same time when the livestream is being downloaded ? sometimes the the channel privates the livestream as soon as it ends and i do n't want to miss downloading the actual content . if not , can it be downloaded separately ? as in something like -- skip-download to download the live chat in a bash session and another with -- compat-options no-live-chat < code >
the following is part of my code for a discord bot to play a video from youtube . i inputted a youtube url of the music i wanted , only to receive this error : i assume that 0 index as error means that there is no video in entries . what seems to be the problem ? < code > def get_music ( url ) : with youtubedl ( ytdl_options ) as ydl : video = ydl.extract_info ( url , download=false ) [ 'entries ' ] [ 0 ] indexerror : list index out of range
installation manual says to use homebrew command but i found there is a formulae without taps so , is there any difference between these two installation paths and which is preferred ? < code > brew install yt-dlp/taps/yt-dlp brew install yt-dlp
i noticed in the section for modifying metadata that language can be set for each stream and was wondering if it was possible/how to set the language of the audio stream . i 'm not entirely sure how to go about selecting stream specific metadata . the language is n't set to what i would expect for youtube downloads ( as in the fields are all empty strings with the preference set to -1 in the info json ) . perhaps this is an extractor bug that might need an issue opening , but i 'd still like to know if this is possible regardless as a workaround . i could be misunderstanding how it works though . do i need to use ffmpeg style mappings ( s🅰️0 etc . ) or is some other mapping used ? i 'd like to do this as my media player can auto select subtitles/captions based on the language of the current audio track , but they all get marked as english so i have to select them manually ( i am a native english speaker and so generally do not need english subtitles/captions for english audio ) . < code >
i do n't want to download the comments even if it 's quick . how can i do that ? i tried adding -- no-write-comments but it still retrieves the comments . < code >
hey everyone , microsoft defender antivirus is now alerting and blocking yt-dlp ( 2021.09.02 ) for being a trojan . i have scanned the application on virus total , and the results show clean . it appears this is n't being flagged for a known virus signature , but defender apparently has some cloud based ai now which is determining if an application is safe or not . the previous build did n't have this issue , so i 'm assuming its a change that was brought in . just reviewing the release notes for this release , the only thing that i could think it could be is the sponsor blocker api is being flagged as a command and control server ? < code >
code used : yt-dlp -f -- no-part -- restrict-filenames -- user-agent `` mozilla/5.0 ( windows nt 10.0 ; win64 ; x64 ; rv:91.0 ) gecko/20100101 firefox/91.0 '' -- referer `` about : blank '' -- output `` jiovod.wdrm.cdn.jio.com_content_entry_wvdata_96_15_5f6c7660eac611eb901ec5c97a856714_l.mpd. % ( ext ) s '' `` < url > -- verbose gets reply : other link for more info is a json file from the website help me with this please ... thank you ! < code >
if you run yt-dlp -- ap-list-mso | grep att from a command line it shows two entries i am pretty sure that what 's now known as at & t tv is what used to be called directv now , but they changed the name a little while back . my question is whether yt-dlp is still able to get shows from various cable channel sites using an at & t tv login in the same way that it would be able to using a cable system login . does anyone know for certain whether this still works ? < code > att at & t u-verse attott directv now
sup guys , nice job really appreciate your efforts to keep posting this all the time ! well i was wondering if somehow youtube discontinued the `` rtsp '' '3gp ' urls from the mobile useragent requests . since i have build an app which plays youtube videos ( i do n't want to use vlc so i build my own rtsp request ) but after couple of weeks i came back to play with this app again after some time , my request can not find any `` rtsp '' stream url `` m.youtube.com .... only some links like this : can be retrieved but it will be useless for me since my rtsp viewer does n't know to play this url link which is https instead of rtsp . any suggestion i really appreciate ! < code >
i tried last and previous release on two linux mate 18.3 installations with no success : intallation by wget on a system already using youtube-dl . a `` yt-dlp -u '' command returns : file `` usr/local/bin/yt-dlp/yt_dlp/cookies.py , line 44 keyring_unavailable_reason = f'due to unknown reasons { bug_reportsmessage ( ) } ' ^ syntaxerror : invalid syntax any idea ? < code >
hello . first of all , i want to thank the youtube-dl and yt-dlp developers for these great tools . i especially appreciate the -- split-chapters function , which is very convenient way of downloading and splitting obscure music albums from youtube . however , i 'm having trouble with some aspects of the program and would appreciate if someone could help me . -- parse-metadata `` title : % ( artist ) s - % ( album ) s '' the line above successfully fills the artist and album id3 tags . based on the title of the video like `` nucleus - roots ( 1973 ) '' is it possible to add 1973 to the id3 date field and how to fill album artist field based on artist ? -- parse-metadata `` description : ( ? s ) ( ? p < meta_comment > .+ ) '' the line above does not work for audio files and id3 tags . how can i copy the description to the id3 comment field ? -- parse-metadata `` : ( ? p < meta_synopsis > ) '' the line above successfully removes the id3 synopsis field . i would also like to remove the description , language , purl fields and all chapter related fields like chapter * * * , chapter * * * name , etc . how can i achieve this ? -- parse-metadata `` section_title : % ( title ) s '' after splitting the album , i 'm trying to add chapter titles to the id3 title field , but the line above does n't work . < code >
i 've been archiving some channels through various means manually ( including youtube-dl and 4k-downloader ) , and now i 'd like to retroactively grab all comments associated with them . namely , the videos and audios already exist on my local hard drives , and i 'd like to download all comments of given urls ( preferably an entire channel ) without downloading the videos again . is this possible ( my system is windows 10 ) ? maybe it 's like making the video and audio option 'null ' or something ( which would mean one might be able to grab not just comments but other non-video-audio stuff as well ) , but i could n't figure it out by reading the documentation . much appreciated . great project . thanks for maintaining it . < code >
i got a problem after downloading some videos , some of them missed thumbnail even in console it said the thumbnail was already embedded . however i ran youtube-dl , it works fine . so i think i prefer atomicparsely rather than mutagen . but how to do that ? < code >
i have installed yt-dlp on wsl debian using curl ( as recommended for linux ) . but i found this did n't have sponsor block integrated so i am trying to do that with no success . so far i have tried downloading the .exe release . i used the flags -- sponskrub-cut -- sponskrub-location /path/to/binary and it did detect the binary and ran but the output was the full video . i tried for the following videos but got the full video saved : yt-dlp -f 251 -n 16 -- external-downloader aria2c -- sponskrub-cut -- sponskrub-location /mnt/d/software/ `` < url > yt-dlp -f 251 -- sponskrub-cut -- sponskrub-location /mnt/d/software/ `` < url > what is the proper way to add sponsor block support ? is there a similar way to install the repo similar to yt-dlp ? < code >
1. sample : api -o rpc template -o : api -o rpc -o issuepr : # 1684 2. goctl api goctl rpc [ solved ] : , help , missing -o , issuerpc -osample 3. api new rpc new [ solved ] : , api new greet , rpc , .proto new , : 1. , 2. help 3. issuepr : # 1688 # 1687 4. goctl docker without flags [ solved ] goctl model , goctl rpc , goctl template help docker , ,help issuepr : # 1677 5. rpc protoc goctl , , , # 1683 # 1716 6. update api gen go logic [ hold on ] # 1695 < url > return values on exported functions should only be named for documentation purposes . 7. timestamp fields [ wip ] // ...................... create_time - > created_at update_time - > updated_at issuepr : # 1707 solution : see # 1795 : breaking change , , , , breaking changemerge 8. default format for -- style should be go_zero [ hold on ] issuepr : # 1692 , service_context.go shorten_logic.go wire_gen.go greet_handler.go effective go uber go style guide golangkubernetes , golang/go # 36060 ( comment ) < code >
win11 22598.1 , ; after i update windows 11 22598.1 , the taskbar window will be wrong place . ; just like this : ; system version : < code >
win11 , , , , , . ? ( after updating win11 , i put it on the leftmost side of the home screen , but after the recent system update , the leftmost position is a widget , so i put it on the right side - this will cause the taskbar to be unbalanced and unsightly. . so can we add a switch displayed on the secondary screen ? ) < code >
i would prefer to see gpu or cpu ( ideally both ) in the taskbar if it is possible . xmeters did this , but does n't work in windows 11. thanks ! < code >
since the latest update tm keeps closing on its own with no input from me . running win 10 , 64bit ( also fully updated ) . suggestions ? < code >
any idea how to make auto start work on windows 11 as i have enabled option but program does n't start automatically . also app does n't appear on task manager > startup < code >
i can not create barcode type in upc_ean_extension . it shows me error 'no encoder available for format upc_ean_extension ' . i need to test my application to decode barcode in this type . i very appreciate who can send me a sample image with barcode in upc_ean_extension , . < code >
i am embedding the geo tag in vcard but the android zxing scanner app does n't seem to recognize it . no 'show on map ' is shown . i am using < url > the vcard is as per < url > < code >
for those interested , here is an overview of the constants introduced in the latest version : decodetypehint.also_inverted ( see < url > ) encodehinttype.code128_compact ( see < url > ) encodehinttype.data_matrix_compact ( see < url > ) encodehinttype.force_c40 ( see < url > encodehinttype.force_code_set ( see < url > ) encodehinttype.pdf417_auto_eci ( see < url > ) encodehinttype.qr_compact ( see < url > ) resultmetadatatype.symbology_identifier ( see < url > ) < code >
hi , npm version of `` @ zxing/library '' : `` ^0.17.0 '' my project is only using browsermultiformatreader from the library in the following way : import { browsermultiformatreader } from `` @ zxing/library '' ; due to this our bundle size is increasing a lot . i want to import it like following to reduce the bundle size . import { browsermultiformatreader } from `` @ zxing/library/esm5/browser/browsermultiformatreader '' ; or import { browsermultiformatreader } from `` @ zxing/library/esm/browser/browsermultiformatreader '' ; which of the above ways could be useful ? i do n't know by default esm5 or esm is being used ? < code >
if we were to improve the code in order to be able to detect codes slighty inclined ( which is actual in most applications ) , what are the classes needed to change ? in addition with `` bitmatrix.java '' should we change another one ? < code >
does this package only connect to the camera and read the code through the camera , or can it also detect devices which use laser and read these devices as well ? < code >
hello everybody , i have a terminal with a barcode scanner orca mt90 and i would like to use the zxing app on it . the problem is , that the zxing app uses a photo camera to read barcodes , instead of a barcode scanner which is a built-in device . is it possible to add an option to choose the source for scanning ? ( camera or the built-in scanner ) ? i will appreciate an early reply . < code >
hello dear forum , i have implemented a simple angular application as qr scanner . the application starts the camera on my notebook , but not when i start it on my mobile ( iphone ) . i am not using https , the implementation is quite basic . can someone tell me what i am doing wrong ? thanks . < code >
